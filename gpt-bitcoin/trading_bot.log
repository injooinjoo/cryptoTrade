2024-09-19 12:16:49 - INFO - X 샘플:
[[-1.70614245 -1.90455433 -1.45673184 -1.63202086  1.69791641  1.68527929
  -1.63202086 -1.63202086  0.          0.          0.         -1.63202086
  -1.63202086]
 [-1.29540445 -0.69310684 -1.03679356 -0.4741902   0.4515926   0.44718651
  -0.4741902  -0.4741902   0.          0.          0.         -0.4741902
  -0.4741902 ]
 [-0.12638092 -0.75930616 -1.25243754 -1.4694042  -0.74109522 -0.74985743
  -1.4694042  -1.4694042   0.          0.          0.         -1.4694042
  -1.4694042 ]
 [-0.86360297 -0.12379272 -0.65657917 -0.2790502  -0.20065995 -0.20219508
  -0.2790502  -0.2790502   0.          0.          0.         -0.2790502
  -0.2790502 ]
 [-0.18430551 -0.4746491   0.05845087  0.0136598  -1.02170699 -1.02488532
   0.0136598   0.0136598   0.          0.          0.          0.0136598
   0.0136598 ]
 [ 0.28435707 -0.03111368  0.6089105   0.4039398   1.7523729   1.75964673
   0.4039398   0.4039398   0.          0.          0.          0.4039398
   0.4039398 ]
 [ 0.56344828  1.37893176  0.98345005  1.5942938   0.27908244  0.29140736
   1.5942938   1.5942938   0.          0.          0.          1.5942938
   1.5942938 ]
 [ 1.57976153  1.31273244  1.66443104  1.2820698  -0.50707049 -0.49896239
   1.2820698   1.2820698   0.          0.          0.          1.2820698
   1.2820698 ]
 [ 1.18482115  1.2001936   0.76780607  0.70965913 -0.40180338 -0.39660188
   0.70965913  0.70965913  0.          0.          0.          0.70965913
   0.70965913]
 [ 0.56344828  0.09466502  0.31949358 -0.14895687 -1.30862831 -1.31101779
  -0.14895687 -0.14895687  0.          0.          0.         -0.14895687
  -0.14895687]]
2024-09-19 12:16:49 - INFO - y 샘플:
[-0.14895687]
2024-09-19 12:16:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 12:16:49 - INFO - 모델 출력 (스케일링된 예측): [0.36376452]
2024-09-19 12:16:49 - INFO - 스케일러 역변환 후 예측 가격: 83178823.6228424
2024-09-19 12:16:49 - INFO - TransformerPredictor 최종 예측 가격: 83178823.6228424
2024-09-19 12:16:49 - INFO - TRANSFORMER prediction: 83178823.6228424
2024-09-19 12:16:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 12:16:49 - INFO - BITCOIN_FORECAST prediction: 82277149.05128299
2024-09-19 12:16:49 - INFO - BitcoinForecast prediction: 82277149.05128299
2024-09-19 12:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:17:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 12:17:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0036060779584733364, 'ml': 0.22426956923661412, 'xgboost': 0.03815494474704379, 'rl': 0.18359732548786498, 'lstm': 0.1433919609004024, 'arima': 0.06722673703937972, 'prophet': 0.13197164926111005, 'transformer': 0.17107640203083935, 'bitcoin_forecast': 0.03670533333827226}
2024-09-19 12:17:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0036060779584733364, 'ml': 0.22426956923661412, 'xgboost': 0.03815494474704379, 'rl': 0.18359732548786498, 'lstm': 0.1433919609004024, 'arima': 0.06722673703937972, 'prophet': 0.13197164926111005, 'transformer': 0.17107640203083935, 'bitcoin_forecast': 0.03670533333827226}
2024-09-19 12:17:00 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83105721.65005344, 'current_price': 83100000.0, 'predictions': {'gpt': 83100000.0, 'ml': 83116620.0, 'xgboost': 83100000.0, 'lstm': 83172681.16167232, 'rl': 83931000.0, 'arima': 80899000.0, 'prophet': 83127939.50710912, 'transformer': 83178823.6228424, 'bitcoin_forecast': 82277149.05128299}, 'weights': {'gpt': 0.0036060779584733364, 'ml': 0.22426956923661412, 'xgboost': 0.03815494474704379, 'rl': 0.18359732548786498, 'lstm': 0.1433919609004024, 'arima': 0.06722673703937972, 'prophet': 0.13197164926111005, 'transformer': 0.17107640203083935, 'bitcoin_forecast': 0.03670533333827226}}
2024-09-19 12:17:00 - INFO - 모델별 가중치:
2024-09-19 12:17:00 - INFO -   - GPT: 0.0036
2024-09-19 12:17:00 - INFO -   - ML: 0.2243
2024-09-19 12:17:00 - INFO -   - XGBOOST: 0.0382
2024-09-19 12:17:00 - INFO -   - RL: 0.1836
2024-09-19 12:17:00 - INFO -   - LSTM: 0.1434
2024-09-19 12:17:00 - INFO -   - ARIMA: 0.0672
2024-09-19 12:17:00 - INFO -   - PROPHET: 0.1320
2024-09-19 12:17:00 - INFO -   - TRANSFORMER: 0.1711
2024-09-19 12:17:00 - INFO -   - BITCOIN_FORECAST: 0.0367
2024-09-19 12:17:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 12:17:00 - INFO - 6. 거래 실행
2024-09-19 12:17:00 - INFO - Cancelling existing orders.
2024-09-19 12:17:00 - INFO - Cancelled 0 orders.
2024-09-19 12:17:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83105721.65005344, 'current_price': 83100000.0, 'predictions': {'gpt': 83100000.0, 'ml': 83116620.0, 'xgboost': 83100000.0, 'lstm': 83172681.16167232, 'rl': 83931000.0, 'arima': 80899000.0, 'prophet': 83127939.50710912, 'transformer': 83178823.6228424, 'bitcoin_forecast': 82277149.05128299}, 'weights': {'gpt': 0.0036060779584733364, 'ml': 0.22426956923661412, 'xgboost': 0.03815494474704379, 'rl': 0.18359732548786498, 'lstm': 0.1433919609004024, 'arima': 0.06722673703937972, 'prophet': 0.13197164926111005, 'transformer': 0.17107640203083935, 'bitcoin_forecast': 0.03670533333827226}}, 현재 가격=83100000.0
2024-09-19 12:17:00 - INFO - 현재 잔고: KRW=364559.6015433, BTC=0.00135654, 총 자산가치=477288.0755433
2024-09-19 12:17:00 - INFO - 매수 시도: 0.0005743538815202167 BTC (약 47728.80755433001 KRW)
2024-09-19 12:17:00 - INFO - 주문 결과: {'uuid': '474a1d1f-85fd-4688-a7a7-65e43119d050', 'side': 'bid', 'ord_type': 'limit', 'price': '83100000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T12:17:01+09:00', 'volume': '0.00057435', 'remaining_volume': '0.00057435', 'reserved_fee': '23.8642425', 'remaining_fee': '23.8642425', 'paid_fee': '0', 'locked': '47752.3492425', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 12:17:00 - INFO - buy 주문 성공: UUID=474a1d1f-85fd-4688-a7a7-65e43119d050
2024-09-19 12:17:00 - INFO - Trade executed successfully.
2024-09-19 12:17:00 - INFO - 7. summary 리포트 보내기
2024-09-19 12:17:02 - INFO - Message sent to Discord successfully.
2024-09-19 12:17:02 - INFO - Trading cycle completed.
2024-09-19 12:17:02 - INFO - Performing periodic update.
2024-09-19 12:17:02 - INFO - 계산된 시장 변동성: 0.0384915359556945
2024-09-19 12:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:25:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ca-bec1-d503e735be5c "HTTP/1.1 200 OK"
2024-09-19 12:25:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:25:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:25:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-84e0-d21a76b0ac35 "HTTP/1.1 200 OK"
2024-09-19 12:25:50 - INFO - Updated actual price for ml prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:25:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-8078-c1a70c6b32c6 "HTTP/1.1 200 OK"
2024-09-19 12:25:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818b-a037-e8801c14ab4d "HTTP/1.1 200 OK"
2024-09-19 12:26:08 - INFO - Updated actual price for lstm prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e3-a242-f4f3ab39a118 "HTTP/1.1 200 OK"
2024-09-19 12:26:14 - INFO - Updated actual price for rl prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ad-9029-dd73e521b10d "HTTP/1.1 200 OK"
2024-09-19 12:26:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-bc1d-c720a0c15648 "HTTP/1.1 200 OK"
2024-09-19 12:26:28 - INFO - Updated actual price for prophet prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8134-ae2e-ed40eb0e172d "HTTP/1.1 200 OK"
2024-09-19 12:26:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:26:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-a70e-fbb29d43e7c1 "HTTP/1.1 200 OK"
2024-09-19 12:26:51 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 12:15:34.904882
2024-09-19 12:26:51 - INFO - Starting trading cycle.
2024-09-19 12:26:51 - INFO - ##################################################
2024-09-19 12:26:51 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-19 12:26:51 - INFO - ##################################################
2024-09-19 12:26:51 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 12:26:51 - INFO - 데이터베이스 업데이트 시작
2024-09-19 12:26:51 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 12:10:00
2024-09-19 12:26:51 - INFO - 새로운 데이터 범위: 2024-09-18 03:10:00 ~ 2024-09-19 12:20:00
2024-09-19 12:26:51 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 12:26:51 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 12:26:51 - INFO - Index: Index([199], dtype='int64')
2024-09-19 12:26:51 - INFO - Date column data type: datetime64[ns]
2024-09-19 12:26:51 - INFO - Sample date values: [Timestamp('2024-09-19 12:20:00')]
2024-09-19 12:26:51 - INFO - Successfully added 1 new data points
2024-09-19 12:26:51 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 12:26:51 - INFO - Final date range: 2024-09-19 12:20:00 to 2024-09-19 12:20:00
2024-09-19 12:26:51 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 12:26:51 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 12:20:00
2024-09-19 12:26:51 - INFO - 데이터베이스 업데이트 완료
2024-09-19 12:26:51 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 12:26:51 - INFO - GPT | 이전예측가격: 83100000 | 당시BTC가격: 83100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:26:51 - INFO - ML 모델 예측 업데이트: 정확도 57.41%, 적중/전체: 31/54
2024-09-19 12:26:51 - INFO - ML | 이전예측가격: 83116620 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1983 | 반영가중치값: 0.0200 | 새 가중치: 0.2183 | 예측 총 횟수: 54 | 예측 성공 수: 31 | 예측 성공률: 57.41%
2024-09-19 12:26:51 - INFO - XGBOOST | 이전예측가격: 83100000 | 당시BTC가격: 83100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:26:51 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 8/14
2024-09-19 12:26:51 - INFO - LSTM | 이전예측가격: 83172681 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0689 | 반영가중치값: 0.0200 | 새 가중치: 0.0889 | 예측 총 횟수: 14 | 예측 성공 수: 8 | 예측 성공률: 57.14%
2024-09-19 12:26:51 - INFO - RL 모델 예측 업데이트: 정확도 56.76%, 적중/전체: 42/74
2024-09-19 12:26:51 - INFO - RL | 이전예측가격: 83931000 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1539 | 반영가중치값: 0.0200 | 새 가중치: 0.1739 | 예측 총 횟수: 74 | 예측 성공 수: 42 | 예측 성공률: 56.76%
2024-09-19 12:26:51 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.42%, 적중/전체: 92/166
2024-09-19 12:26:51 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83100000 | 예측: 하락 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1046 | 반영가중치값: -0.0200 | 새 가중치: 0.0846 | 예측 총 횟수: 166 | 예측 성공 수: 92 | 예측 성공률: 55.42%
2024-09-19 12:26:51 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 20/34
2024-09-19 12:26:51 - INFO - PROPHET | 이전예측가격: 83127940 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1599 | 반영가중치값: 0.0200 | 새 가중치: 0.1799 | 예측 총 횟수: 34 | 예측 성공 수: 20 | 예측 성공률: 58.82%
2024-09-19 12:26:51 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-19 12:26:51 - INFO - TRANSFORMER | 이전예측가격: 83178824 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1644 | 반영가중치값: 0.0200 | 새 가중치: 0.1844 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-19 12:26:51 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 7/14
2024-09-19 12:26:51 - INFO - BITCOIN_FORECAST | 이전예측가격: 82277149 | 당시BTC가격: 83100000 | 예측: 하락 | 지금 BTC가격: 83229000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1058 | 반영가중치값: -0.0200 | 새 가중치: 0.0858 | 예측 총 횟수: 14 | 예측 성공 수: 7 | 예측 성공률: 50.00%
2024-09-19 12:26:51 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 12:26:51 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 12:26:51 - INFO - 새로운 가중치: {'gpt': 0.003409681752583241, 'ml': 0.2063961302670559, 'xgboost': 0.036076929110510504, 'rl': 0.1643857638822098, 'lstm': 0.08408923089459926, 'arima': 0.08000154620833279, 'prophet': 0.1701403490294302, 'transformer': 0.1743681003329241, 'bitcoin_forecast': 0.08113226852235415}
2024-09-19 12:26:51 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 12:26:51 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 12:26:51 - INFO - Current BTC price: 83229000.0
2024-09-19 12:26:51 - INFO - Analyzing market conditions.
2024-09-19 12:26:51 - INFO - Market analysis: {'current_price': 83229000.0, 'sma_20': 83082200.0, 'rsi_14': 62.478313315000506, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 12:26:51 - INFO - Starting predictions for all models
2024-09-19 12:26:51 - INFO - Attempting prediction for gpt
2024-09-19 12:26:52 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 12:26:52 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:26:52 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:26:52 - INFO - GPT prediction: 83229000.0
2024-09-19 12:26:52 - INFO - Attempting prediction for ml
2024-09-19 12:26:52 - INFO - ML prediction: 82979313.0
2024-09-19 12:26:52 - INFO - Attempting prediction for xgboost
2024-09-19 12:26:52 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 12:26:52 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:26:52 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:26:52 - INFO - XGBOOST prediction: 83229000.0
2024-09-19 12:26:52 - INFO - Attempting prediction for lstm
2024-09-19 12:26:52 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:26:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:26:52 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 12:26:52 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:26:52 - INFO - X 샘플:
[[-1.75328549 -1.18745475 -1.37784511 -0.82828782  0.73972151  0.7297382
  -0.82828782]
 [-0.34201146 -1.27300624 -1.62446835 -1.99521265 -0.69984005 -0.70994952
  -1.99521265]
 [-1.23200409 -0.45171189 -0.94300939 -0.59947903 -0.04754041 -0.05127465
  -0.59947903]
 [-0.41193945 -0.90513481 -0.12525865 -0.25626585 -1.03853548 -1.04072624
  -0.25626585]
 [ 0.15384158 -0.3319398   0.50427963  0.20135174  2.30974954  2.30823735
   0.20135174]
 [ 0.49076737  1.49030704  0.93262526  1.59708536  0.53150357  0.54238223
   1.59708536]
 [ 1.71768579  1.40475554  1.71143549  1.23099129 -0.41737468 -0.40819742
   1.23099129]
 [ 1.24090402  1.259318    0.68600202  0.55981884 -0.29031839 -0.28508819
   0.55981884]
 [ 0.49076737 -0.16939196  0.17328528 -0.44693984 -1.38484647 -1.38485847
  -0.44693984]
 [-0.35472564  0.16425887  0.06295383  0.53693796  0.29748087  0.29973671
   0.53693796]]
2024-09-19 12:26:52 - INFO - y 샘플:
[0.53693796]
2024-09-19 12:26:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 12:26:52 - INFO - 모델 출력 (스케일링된 예측): [[0.3223812]]
2024-09-19 12:26:52 - INFO - 스케일러 역변환 후 예측 가격: 83200868.63804762
2024-09-19 12:26:52 - INFO - LSTMPredictor 최종 예측 가격: 83200868.63804762
2024-09-19 12:26:52 - INFO - LSTM prediction: 83200868.63804762
2024-09-19 12:26:52 - INFO - Attempting prediction for rl
2024-09-19 12:26:52 - INFO - Preparing state for RL agent.
2024-09-19 12:26:52 - INFO - Prepared state: [[8.32290000e+07 2.37020275e+01 1.55234657e-03 8.30822000e+07
  6.24783133e+01]]
2024-09-19 12:26:52 - INFO - RL prediction: 84061290.0
2024-09-19 12:26:52 - INFO - Attempting prediction for arima
2024-09-19 12:26:52 - INFO - ARIMA 예측 시작
2024-09-19 12:26:52 - INFO - 입력 데이터: {'open': 83068000.0, 'high': 83250000.0, 'low': 83066000.0, 'close': 83229000.0, 'volume': 23.70202747, 'value': 1971975887.93667, 'decision': 'sell', 'sma': 83082200.0, 'ema': 82915309.92972821, 'rsi': 62.478313315000506, 'macd': 343768.4301968962, 'signal_line': 392816.2391140539, 'BB_Upper': 83505053.92276958, 'BB_Lower': 82659346.07723042}
2024-09-19 12:26:52 - INFO - Exogenous 변수 예측 시작
2024-09-19 12:26:52 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83082200.0         0         0
2024-09-19 12:26:52 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83082200.0         0         0
2024-09-19 12:26:52 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 12:26:52 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 12:26:52 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 12:26:52 - INFO - ARIMA prediction: 80899000.0
2024-09-19 12:26:52 - INFO - Attempting prediction for prophet
2024-09-19 12:26:52 - INFO - PROPHET prediction: 83275386.44110174
2024-09-19 12:26:52 - INFO - Attempting prediction for transformer
2024-09-19 12:26:52 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:26:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:26:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:26:52 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 12:26:52 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:26:52 - INFO - X 샘플:
[[-1.75328549 -1.18745475 -1.37784511 -0.82828782  0.73972151  0.7297382
  -0.82828782 -0.82828782  0.          0.          0.         -0.82828782
  -0.82828782]
 [-0.34201146 -1.27300624 -1.62446835 -1.99521265 -0.69984005 -0.70994952
  -1.99521265 -1.99521265  0.          0.          0.         -1.99521265
  -1.99521265]
 [-1.23200409 -0.45171189 -0.94300939 -0.59947903 -0.04754041 -0.05127465
  -0.59947903 -0.59947903  0.          0.          0.         -0.59947903
  -0.59947903]
 [-0.41193945 -0.90513481 -0.12525865 -0.25626585 -1.03853548 -1.04072624
  -0.25626585 -0.25626585  0.          0.          0.         -0.25626585
  -0.25626585]
 [ 0.15384158 -0.3319398   0.50427963  0.20135174  2.30974954  2.30823735
   0.20135174  0.20135174  0.          0.          0.          0.20135174
   0.20135174]
 [ 0.49076737  1.49030704  0.93262526  1.59708536  0.53150357  0.54238223
   1.59708536  1.59708536  0.          0.          0.          1.59708536
   1.59708536]
 [ 1.71768579  1.40475554  1.71143549  1.23099129 -0.41737468 -0.40819742
   1.23099129  1.23099129  0.          0.          0.          1.23099129
   1.23099129]
 [ 1.24090402  1.259318    0.68600202  0.55981884 -0.29031839 -0.28508819
   0.55981884  0.55981884  0.          0.          0.          0.55981884
   0.55981884]
 [ 0.49076737 -0.16939196  0.17328528 -0.44693984 -1.38484647 -1.38485847
  -0.44693984 -0.44693984  0.          0.          0.         -0.44693984
  -0.44693984]
 [-0.35472564  0.16425887  0.06295383  0.53693796  0.29748087  0.29973671
   0.53693796  0.53693796  0.          0.          0.          0.53693796
   0.53693796]]
2024-09-19 12:26:52 - INFO - y 샘플:
[0.53693796]
2024-09-19 12:26:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 12:26:52 - INFO - 모델 출력 (스케일링된 예측): [0.36508423]
2024-09-19 12:26:52 - INFO - 스케일러 역변환 후 예측 가격: 83206467.59677391
2024-09-19 12:26:52 - INFO - TransformerPredictor 최종 예측 가격: 83206467.59677391
2024-09-19 12:26:52 - INFO - TRANSFORMER prediction: 83206467.59677391
2024-09-19 12:26:52 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 12:26:52 - INFO - BITCOIN_FORECAST prediction: 82346267.03375074
2024-09-19 12:26:52 - INFO - BitcoinForecast prediction: 82346267.03375074
2024-09-19 12:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:27:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:27:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 12:27:07 - INFO - 조정된 모델 가중치: {'gpt': 0.003409681752583241, 'ml': 0.2063961302670559, 'xgboost': 0.036076929110510504, 'rl': 0.1643857638822098, 'lstm': 0.08408923089459926, 'arima': 0.08000154620833279, 'prophet': 0.1701403490294302, 'transformer': 0.1743681003329241, 'bitcoin_forecast': 0.08113226852235415}
2024-09-19 12:27:07 - INFO - 조정된 모델 가중치: {'gpt': 0.003409681752583241, 'ml': 0.2063961302670559, 'xgboost': 0.036076929110510504, 'rl': 0.1643857638822098, 'lstm': 0.08408923089459926, 'arima': 0.08000154620833279, 'prophet': 0.1701403490294302, 'transformer': 0.1743681003329241, 'bitcoin_forecast': 0.08113226852235415}
2024-09-19 12:27:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83057858.19446906, 'current_price': 83229000.0, 'predictions': {'gpt': 83229000.0, 'ml': 82979313.0, 'xgboost': 83229000.0, 'lstm': 83200868.63804762, 'rl': 84061290.0, 'arima': 80899000.0, 'prophet': 83275386.44110174, 'transformer': 83206467.59677391, 'bitcoin_forecast': 82346267.03375074}, 'weights': {'gpt': 0.003409681752583241, 'ml': 0.2063961302670559, 'xgboost': 0.036076929110510504, 'rl': 0.1643857638822098, 'lstm': 0.08408923089459926, 'arima': 0.08000154620833279, 'prophet': 0.1701403490294302, 'transformer': 0.1743681003329241, 'bitcoin_forecast': 0.08113226852235415}}
2024-09-19 12:27:07 - INFO - 모델별 가중치:
2024-09-19 12:27:07 - INFO -   - GPT: 0.0034
2024-09-19 12:27:07 - INFO -   - ML: 0.2064
2024-09-19 12:27:07 - INFO -   - XGBOOST: 0.0361
2024-09-19 12:27:07 - INFO -   - RL: 0.1644
2024-09-19 12:27:07 - INFO -   - LSTM: 0.0841
2024-09-19 12:27:07 - INFO -   - ARIMA: 0.0800
2024-09-19 12:27:07 - INFO -   - PROPHET: 0.1701
2024-09-19 12:27:07 - INFO -   - TRANSFORMER: 0.1744
2024-09-19 12:27:07 - INFO -   - BITCOIN_FORECAST: 0.0811
2024-09-19 12:27:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 12:27:07 - INFO - 6. 거래 실행
2024-09-19 12:27:07 - INFO - Cancelling existing orders.
2024-09-19 12:27:07 - INFO - Cancelled 0 orders.
2024-09-19 12:27:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83057858.19446906, 'current_price': 83229000.0, 'predictions': {'gpt': 83229000.0, 'ml': 82979313.0, 'xgboost': 83229000.0, 'lstm': 83200868.63804762, 'rl': 84061290.0, 'arima': 80899000.0, 'prophet': 83275386.44110174, 'transformer': 83206467.59677391, 'bitcoin_forecast': 82346267.03375074}, 'weights': {'gpt': 0.003409681752583241, 'ml': 0.2063961302670559, 'xgboost': 0.036076929110510504, 'rl': 0.1643857638822098, 'lstm': 0.08408923089459926, 'arima': 0.08000154620833279, 'prophet': 0.1701403490294302, 'transformer': 0.1743681003329241, 'bitcoin_forecast': 0.08113226852235415}}, 현재 가격=83229000.0
2024-09-19 12:27:07 - INFO - 현재 잔고: KRW=316823.3421417, BTC=0.00193089, 총 자산가치=477529.3859517
2024-09-19 12:27:07 - INFO - 매도 시도: 0.00019308900000000002 BTC (약 16070.604381000001 KRW)
2024-09-19 12:27:07 - INFO - 주문 결과: {'uuid': 'f17a67c6-30f3-46b2-a9b7-a8024fa07734', 'side': 'ask', 'ord_type': 'limit', 'price': '83229000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T12:27:08+09:00', 'volume': '0.00019308', 'remaining_volume': '0.00019308', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00019308', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 12:27:07 - INFO - sell 주문 성공: UUID=f17a67c6-30f3-46b2-a9b7-a8024fa07734
2024-09-19 12:27:07 - INFO - Trade executed successfully.
2024-09-19 12:27:07 - INFO - 7. summary 리포트 보내기
2024-09-19 12:27:08 - INFO - Message sent to Discord successfully.
2024-09-19 12:27:08 - INFO - Trading cycle completed.
2024-09-19 12:27:08 - INFO - Performing periodic update.
2024-09-19 12:27:08 - INFO - 계산된 시장 변동성: 0.03854293327139097
2024-09-19 12:35:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:35:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8190-ad36-df8eafe5071f "HTTP/1.1 200 OK"
2024-09-19 12:35:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:35:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:35:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8141-9e2c-db615f1f679e "HTTP/1.1 200 OK"
2024-09-19 12:35:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:35:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:35:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8155-88c5-cfd0682b6ca4 "HTTP/1.1 200 OK"
2024-09-19 12:35:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-8b02-d3b994ada100 "HTTP/1.1 200 OK"
2024-09-19 12:36:15 - INFO - Updated actual price for lstm prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-9003-cab04dbbcad3 "HTTP/1.1 200 OK"
2024-09-19 12:36:21 - INFO - Updated actual price for rl prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814f-baf6-d0c5ac9b543e "HTTP/1.1 200 OK"
2024-09-19 12:36:30 - INFO - Updated actual price for arima prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811e-807b-c216be84677a "HTTP/1.1 200 OK"
2024-09-19 12:36:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815c-90dd-f09e029115dc "HTTP/1.1 200 OK"
2024-09-19 12:36:43 - INFO - Updated actual price for transformer prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:36:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8141-ac6d-ff6fce1aded4 "HTTP/1.1 200 OK"
2024-09-19 12:36:52 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 12:25:34.905321
2024-09-19 12:36:52 - INFO - Starting trading cycle.
2024-09-19 12:36:52 - INFO - ##################################################
2024-09-19 12:36:52 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-19 12:36:52 - INFO - ##################################################
2024-09-19 12:36:52 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 12:36:52 - INFO - 데이터베이스 업데이트 시작
2024-09-19 12:36:52 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 12:20:00
2024-09-19 12:36:52 - INFO - 새로운 데이터 범위: 2024-09-18 03:20:00 ~ 2024-09-19 12:30:00
2024-09-19 12:36:52 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 12:36:52 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 12:36:52 - INFO - Index: Index([199], dtype='int64')
2024-09-19 12:36:52 - INFO - Date column data type: datetime64[ns]
2024-09-19 12:36:52 - INFO - Sample date values: [Timestamp('2024-09-19 12:30:00')]
2024-09-19 12:36:53 - INFO - Successfully added 1 new data points
2024-09-19 12:36:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 12:36:53 - INFO - Final date range: 2024-09-19 12:30:00 to 2024-09-19 12:30:00
2024-09-19 12:36:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 12:36:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 12:30:00
2024-09-19 12:36:53 - INFO - 데이터베이스 업데이트 완료
2024-09-19 12:36:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 12:36:53 - INFO - GPT | 이전예측가격: 83229000 | 당시BTC가격: 83229000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:36:53 - INFO - ML 모델 예측 업데이트: 정확도 58.18%, 적중/전체: 32/55
2024-09-19 12:36:53 - INFO - ML | 이전예측가격: 82979313 | 당시BTC가격: 83229000 | 예측: 하락 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2243 | 반영가중치값: 0.0200 | 새 가중치: 0.2443 | 예측 총 횟수: 55 | 예측 성공 수: 32 | 예측 성공률: 58.18%
2024-09-19 12:36:53 - INFO - XGBOOST | 이전예측가격: 83229000 | 당시BTC가격: 83229000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:36:53 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 9/15
2024-09-19 12:36:53 - INFO - LSTM | 이전예측가격: 83200869 | 당시BTC가격: 83229000 | 예측: 하락 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1434 | 반영가중치값: 0.0200 | 새 가중치: 0.1634 | 예측 총 횟수: 15 | 예측 성공 수: 9 | 예측 성공률: 60.00%
2024-09-19 12:36:53 - INFO - RL 모델 예측 업데이트: 정확도 56.00%, 적중/전체: 42/75
2024-09-19 12:36:53 - INFO - RL | 이전예측가격: 84061290 | 당시BTC가격: 83229000 | 예측: 상승 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1836 | 반영가중치값: -0.0200 | 새 가중치: 0.1636 | 예측 총 횟수: 75 | 예측 성공 수: 42 | 예측 성공률: 56.00%
2024-09-19 12:36:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.69%, 적중/전체: 93/167
2024-09-19 12:36:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83229000 | 예측: 하락 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0672 | 반영가중치값: 0.0200 | 새 가중치: 0.0872 | 예측 총 횟수: 167 | 예측 성공 수: 93 | 예측 성공률: 55.69%
2024-09-19 12:36:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 20/35
2024-09-19 12:36:53 - INFO - PROPHET | 이전예측가격: 83275386 | 당시BTC가격: 83229000 | 예측: 상승 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1320 | 반영가중치값: -0.0200 | 새 가중치: 0.1120 | 예측 총 횟수: 35 | 예측 성공 수: 20 | 예측 성공률: 57.14%
2024-09-19 12:36:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 9/14
2024-09-19 12:36:53 - INFO - TRANSFORMER | 이전예측가격: 83206468 | 당시BTC가격: 83229000 | 예측: 하락 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1711 | 반영가중치값: 0.0200 | 새 가중치: 0.1911 | 예측 총 횟수: 14 | 예측 성공 수: 9 | 예측 성공률: 64.29%
2024-09-19 12:36:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-19 12:36:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82346267 | 당시BTC가격: 83229000 | 예측: 하락 | 지금 BTC가격: 83061000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0367 | 반영가중치값: 0.0200 | 새 가중치: 0.0567 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-19 12:36:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 12:36:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 12:36:53 - INFO - 새로운 가중치: {'gpt': 0.0032235976804933617, 'ml': 0.2309385080322209, 'xgboost': 0.03410802339891571, 'rl': 0.1546689683217655, 'lstm': 0.1544748115482489, 'arima': 0.0824663202024994, 'prophet': 0.10586077382901402, 'transformer': 0.18064836869803833, 'bitcoin_forecast': 0.053610628288803835}
2024-09-19 12:36:53 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 12:36:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 12:36:53 - INFO - Current BTC price: 83061000.0
2024-09-19 12:36:53 - INFO - Analyzing market conditions.
2024-09-19 12:36:53 - INFO - Market analysis: {'current_price': 83061000.0, 'sma_20': 83090250.0, 'rsi_14': 57.59760356177446, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 12:36:53 - INFO - Starting predictions for all models
2024-09-19 12:36:53 - INFO - Attempting prediction for gpt
2024-09-19 12:36:53 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 12:36:53 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:36:53 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:36:53 - INFO - GPT prediction: 83061000.0
2024-09-19 12:36:53 - INFO - Attempting prediction for ml
2024-09-19 12:36:53 - INFO - ML prediction: 83110836.6
2024-09-19 12:36:53 - INFO - Attempting prediction for xgboost
2024-09-19 12:36:53 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 12:36:53 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:36:53 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:36:53 - INFO - XGBOOST prediction: 83061000.0
2024-09-19 12:36:53 - INFO - Attempting prediction for lstm
2024-09-19 12:36:53 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:36:53 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:36:53 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:36:53 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:36:53 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:36:53 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 12:36:53 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:36:53 - INFO - X 샘플:
[[-0.69328857 -1.47458025 -1.9136188  -2.0170245  -0.47577166 -0.48564086
  -2.0170245 ]
 [-1.78385485 -0.58761469 -1.15795887 -0.61194082  0.15270781  0.14824536
  -0.61194082]
 [-0.77897592 -1.07729359 -0.25116696 -0.26642844 -0.80209887 -0.80396909
  -0.26642844]
 [-0.08568735 -0.45826554  0.44691887  0.19425474  2.42391605  2.41895921
   0.19425474]
 [ 0.32716989  1.50968931  0.92190511  1.59933842  0.71060671  0.71956049
   1.59933842]
 [ 1.83059341  1.41729706  1.78551645  1.23079188 -0.20362114 -0.19524493
   1.23079188]
 [ 1.24636147  1.26023024  0.64842818  0.55512323 -0.08120459 -0.07676881
   0.55512323]
 [ 0.32716989 -0.28272027  0.07988405 -0.45837976 -1.13576353 -1.1351502
  -0.45837976]
 [-0.70886809  0.07760949 -0.04246089  0.53208907  0.48512987  0.48604672
   0.53208907]
 [ 0.31938013 -0.38435175 -0.51744713 -0.75782382 -1.07390065 -1.0760379
  -0.75782382]]
2024-09-19 12:36:53 - INFO - y 샘플:
[-0.75782382]
2024-09-19 12:36:53 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 12:36:53 - INFO - 모델 출력 (스케일링된 예측): [[0.32026297]]
2024-09-19 12:36:53 - INFO - 스케일러 역변환 후 예측 가격: 83201411.48230003
2024-09-19 12:36:53 - INFO - LSTMPredictor 최종 예측 가격: 83201411.48230003
2024-09-19 12:36:53 - INFO - LSTM prediction: 83201411.48230003
2024-09-19 12:36:53 - INFO - Attempting prediction for rl
2024-09-19 12:36:53 - INFO - Preparing state for RL agent.
2024-09-19 12:36:53 - INFO - Prepared state: [[ 8.30610000e+07  1.57240427e+01 -2.01852720e-03  8.30902500e+07
   5.75976036e+01]]
2024-09-19 12:36:53 - INFO - RL prediction: 83891610.0
2024-09-19 12:36:53 - INFO - Attempting prediction for arima
2024-09-19 12:36:53 - INFO - ARIMA 예측 시작
2024-09-19 12:36:53 - INFO - 입력 데이터: {'open': 83200000.0, 'high': 83200000.0, 'low': 83000000.0, 'close': 83061000.0, 'volume': 15.72404271, 'value': 1306100164.33709, 'decision': 'sell', 'sma': 83090250.0, 'ema': 82929185.174516, 'rsi': 57.59760356177446, 'macd': 314916.4139267802, 'signal_line': 377236.27407659916, 'BB_Upper': 83504974.90882707, 'BB_Lower': 82675525.09117293}
2024-09-19 12:36:53 - INFO - Exogenous 변수 예측 시작
2024-09-19 12:36:53 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83090250.0         0         0
2024-09-19 12:36:53 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83090250.0         0         0
2024-09-19 12:36:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 12:36:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 12:36:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 12:36:54 - INFO - ARIMA prediction: 80899000.0
2024-09-19 12:36:54 - INFO - Attempting prediction for prophet
2024-09-19 12:36:54 - INFO - PROPHET prediction: 83075364.0250598
2024-09-19 12:36:54 - INFO - Attempting prediction for transformer
2024-09-19 12:36:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:36:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:36:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:36:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:36:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:36:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 12:36:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:36:54 - INFO - X 샘플:
[[-0.69328857 -1.47458025 -1.9136188  -2.0170245  -0.47577166 -0.48564086
  -2.0170245  -2.0170245   0.          0.          0.         -2.0170245
  -2.0170245 ]
 [-1.78385485 -0.58761469 -1.15795887 -0.61194082  0.15270781  0.14824536
  -0.61194082 -0.61194082  0.          0.          0.         -0.61194082
  -0.61194082]
 [-0.77897592 -1.07729359 -0.25116696 -0.26642844 -0.80209887 -0.80396909
  -0.26642844 -0.26642844  0.          0.          0.         -0.26642844
  -0.26642844]
 [-0.08568735 -0.45826554  0.44691887  0.19425474  2.42391605  2.41895921
   0.19425474  0.19425474  0.          0.          0.          0.19425474
   0.19425474]
 [ 0.32716989  1.50968931  0.92190511  1.59933842  0.71060671  0.71956049
   1.59933842  1.59933842  0.          0.          0.          1.59933842
   1.59933842]
 [ 1.83059341  1.41729706  1.78551645  1.23079188 -0.20362114 -0.19524493
   1.23079188  1.23079188  0.          0.          0.          1.23079188
   1.23079188]
 [ 1.24636147  1.26023024  0.64842818  0.55512323 -0.08120459 -0.07676881
   0.55512323  0.55512323  0.          0.          0.          0.55512323
   0.55512323]
 [ 0.32716989 -0.28272027  0.07988405 -0.45837976 -1.13576353 -1.1351502
  -0.45837976 -0.45837976  0.          0.          0.         -0.45837976
  -0.45837976]
 [-0.70886809  0.07760949 -0.04246089  0.53208907  0.48512987  0.48604672
   0.53208907  0.53208907  0.          0.          0.          0.53208907
   0.53208907]
 [ 0.31938013 -0.38435175 -0.51744713 -0.75782382 -1.07390065 -1.0760379
  -0.75782382 -0.75782382  0.          0.          0.         -0.75782382
  -0.75782382]]
2024-09-19 12:36:54 - INFO - y 샘플:
[-0.75782382]
2024-09-19 12:36:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 12:36:54 - INFO - 모델 출력 (스케일링된 예측): [0.36524004]
2024-09-19 12:36:54 - INFO - 스케일러 역변환 후 예측 가격: 83207269.35660227
2024-09-19 12:36:54 - INFO - TransformerPredictor 최종 예측 가격: 83207269.35660227
2024-09-19 12:36:54 - INFO - TRANSFORMER prediction: 83207269.35660227
2024-09-19 12:36:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 12:36:54 - INFO - BITCOIN_FORECAST prediction: 82284120.07891141
2024-09-19 12:36:54 - INFO - BitcoinForecast prediction: 82284120.07891141
2024-09-19 12:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:36:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:37:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:37:03 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 12:37:03 - INFO - 조정된 모델 가중치: {'gpt': 0.0032235976804933617, 'ml': 0.2309385080322209, 'xgboost': 0.03410802339891571, 'rl': 0.1546689683217655, 'lstm': 0.1544748115482489, 'arima': 0.0824663202024994, 'prophet': 0.10586077382901402, 'transformer': 0.18064836869803833, 'bitcoin_forecast': 0.053610628288803835}
2024-09-19 12:37:03 - INFO - 조정된 모델 가중치: {'gpt': 0.0032235976804933617, 'ml': 0.2309385080322209, 'xgboost': 0.03410802339891571, 'rl': 0.1546689683217655, 'lstm': 0.1544748115482489, 'arima': 0.0824663202024994, 'prophet': 0.10586077382901402, 'transformer': 0.18064836869803833, 'bitcoin_forecast': 0.053610628288803835}
2024-09-19 12:37:03 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83030671.52161117, 'current_price': 83061000.0, 'predictions': {'gpt': 83061000.0, 'ml': 83110836.6, 'xgboost': 83061000.0, 'lstm': 83201411.48230003, 'rl': 83891610.0, 'arima': 80899000.0, 'prophet': 83075364.0250598, 'transformer': 83207269.35660227, 'bitcoin_forecast': 82284120.07891141}, 'weights': {'gpt': 0.0032235976804933617, 'ml': 0.2309385080322209, 'xgboost': 0.03410802339891571, 'rl': 0.1546689683217655, 'lstm': 0.1544748115482489, 'arima': 0.0824663202024994, 'prophet': 0.10586077382901402, 'transformer': 0.18064836869803833, 'bitcoin_forecast': 0.053610628288803835}}
2024-09-19 12:37:03 - INFO - 모델별 가중치:
2024-09-19 12:37:03 - INFO -   - GPT: 0.0032
2024-09-19 12:37:03 - INFO -   - ML: 0.2309
2024-09-19 12:37:03 - INFO -   - XGBOOST: 0.0341
2024-09-19 12:37:03 - INFO -   - RL: 0.1547
2024-09-19 12:37:03 - INFO -   - LSTM: 0.1545
2024-09-19 12:37:03 - INFO -   - ARIMA: 0.0825
2024-09-19 12:37:03 - INFO -   - PROPHET: 0.1059
2024-09-19 12:37:03 - INFO -   - TRANSFORMER: 0.1806
2024-09-19 12:37:03 - INFO -   - BITCOIN_FORECAST: 0.0536
2024-09-19 12:37:03 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 12:37:03 - INFO - 6. 거래 실행
2024-09-19 12:37:03 - INFO - Cancelling existing orders.
2024-09-19 12:37:03 - INFO - Cancelled 1 orders.
2024-09-19 12:37:03 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83030671.52161117, 'current_price': 83061000.0, 'predictions': {'gpt': 83061000.0, 'ml': 83110836.6, 'xgboost': 83061000.0, 'lstm': 83201411.48230003, 'rl': 83891610.0, 'arima': 80899000.0, 'prophet': 83075364.0250598, 'transformer': 83207269.35660227, 'bitcoin_forecast': 82284120.07891141}, 'weights': {'gpt': 0.0032235976804933617, 'ml': 0.2309385080322209, 'xgboost': 0.03410802339891571, 'rl': 0.1546689683217655, 'lstm': 0.1544748115482489, 'arima': 0.0824663202024994, 'prophet': 0.10586077382901402, 'transformer': 0.18064836869803833, 'bitcoin_forecast': 0.053610628288803835}}, 현재 가격=83061000.0
2024-09-19 12:37:03 - INFO - 현재 잔고: KRW=316823.3421417, BTC=0.00193089, 총 자산가치=477204.99643169995
2024-09-19 12:37:03 - INFO - 매도 시도: 0.000193089 BTC (약 16038.165428999999 KRW)
2024-09-19 12:37:04 - INFO - 주문 결과: {'uuid': '9db0a192-11fb-4544-92d5-b256b83b4696', 'side': 'ask', 'ord_type': 'limit', 'price': '83061000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T12:37:05+09:00', 'volume': '0.00019308', 'remaining_volume': '0.00019308', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00019308', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 12:37:04 - INFO - sell 주문 성공: UUID=9db0a192-11fb-4544-92d5-b256b83b4696
2024-09-19 12:37:04 - INFO - Trade executed successfully.
2024-09-19 12:37:04 - INFO - 7. summary 리포트 보내기
2024-09-19 12:37:04 - INFO - Message sent to Discord successfully.
2024-09-19 12:37:04 - INFO - Trading cycle completed.
2024-09-19 12:37:04 - INFO - Performing periodic update.
2024-09-19 12:37:04 - INFO - 계산된 시장 변동성: 0.03871208073049414
2024-09-19 12:45:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:45:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813b-a98a-f3edf1e8013b "HTTP/1.1 200 OK"
2024-09-19 12:45:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:45:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:45:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ff-81b9-e5b9a7f8d75d "HTTP/1.1 200 OK"
2024-09-19 12:45:53 - INFO - Updated actual price for ml prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:45:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-a79d-e4664f9c4bf2 "HTTP/1.1 200 OK"
2024-09-19 12:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a1fe61a3-cfa3-4d30-a211-eb18df3b6058 "HTTP/1.1 200 OK"
2024-09-19 12:46:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8171-8da1-e7247ae13709 "HTTP/1.1 200 OK"
2024-09-19 12:46:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815b-9650-e3a7c35b1a6e "HTTP/1.1 200 OK"
2024-09-19 12:46:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814b-b571-d02f731a0b4e "HTTP/1.1 200 OK"
2024-09-19 12:46:27 - INFO - Updated actual price for prophet prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8175-a85c-cfb6a0eeec4e "HTTP/1.1 200 OK"
2024-09-19 12:46:40 - INFO - Updated actual price for transformer prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:46:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8164-bacf-ed1b5ec66066 "HTTP/1.1 200 OK"
2024-09-19 12:46:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 12:35:34.905695
2024-09-19 12:46:48 - INFO - Starting trading cycle.
2024-09-19 12:46:48 - INFO - ##################################################
2024-09-19 12:46:48 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-19 12:46:48 - INFO - ##################################################
2024-09-19 12:46:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 12:46:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 12:46:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 12:30:00
2024-09-19 12:46:48 - INFO - 새로운 데이터 범위: 2024-09-18 03:30:00 ~ 2024-09-19 12:40:00
2024-09-19 12:46:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 12:46:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 12:46:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 12:46:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 12:46:48 - INFO - Sample date values: [Timestamp('2024-09-19 12:40:00')]
2024-09-19 12:46:48 - INFO - Successfully added 1 new data points
2024-09-19 12:46:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 12:46:48 - INFO - Final date range: 2024-09-19 12:40:00 to 2024-09-19 12:40:00
2024-09-19 12:46:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 12:46:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 12:40:00
2024-09-19 12:46:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 12:46:48 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 12:46:48 - INFO - GPT | 이전예측가격: 83061000 | 당시BTC가격: 83061000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:46:48 - INFO - ML 모델 예측 업데이트: 정확도 58.93%, 적중/전체: 33/56
2024-09-19 12:46:48 - INFO - ML | 이전예측가격: 83110837 | 당시BTC가격: 83061000 | 예측: 상승 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2064 | 반영가중치값: 0.0200 | 새 가중치: 0.2264 | 예측 총 횟수: 56 | 예측 성공 수: 33 | 예측 성공률: 58.93%
2024-09-19 12:46:48 - INFO - XGBOOST | 이전예측가격: 83061000 | 당시BTC가격: 83061000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:46:48 - INFO - LSTM 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 10/16
2024-09-19 12:46:48 - INFO - LSTM | 이전예측가격: 83201411 | 당시BTC가격: 83061000 | 예측: 상승 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0841 | 반영가중치값: 0.0200 | 새 가중치: 0.1041 | 예측 총 횟수: 16 | 예측 성공 수: 10 | 예측 성공률: 62.50%
2024-09-19 12:46:48 - INFO - RL 모델 예측 업데이트: 정확도 56.58%, 적중/전체: 43/76
2024-09-19 12:46:48 - INFO - RL | 이전예측가격: 83891610 | 당시BTC가격: 83061000 | 예측: 상승 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1644 | 반영가중치값: 0.0200 | 새 가중치: 0.1844 | 예측 총 횟수: 76 | 예측 성공 수: 43 | 예측 성공률: 56.58%
2024-09-19 12:46:48 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.36%, 적중/전체: 93/168
2024-09-19 12:46:48 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83061000 | 예측: 하락 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0800 | 반영가중치값: -0.0200 | 새 가중치: 0.0600 | 예측 총 횟수: 168 | 예측 성공 수: 93 | 예측 성공률: 55.36%
2024-09-19 12:46:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 21/36
2024-09-19 12:46:48 - INFO - PROPHET | 이전예측가격: 83075364 | 당시BTC가격: 83061000 | 예측: 상승 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1701 | 반영가중치값: 0.0200 | 새 가중치: 0.1901 | 예측 총 횟수: 36 | 예측 성공 수: 21 | 예측 성공률: 58.33%
2024-09-19 12:46:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 10/15
2024-09-19 12:46:48 - INFO - TRANSFORMER | 이전예측가격: 83207269 | 당시BTC가격: 83061000 | 예측: 상승 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1744 | 반영가중치값: 0.0200 | 새 가중치: 0.1944 | 예측 총 횟수: 15 | 예측 성공 수: 10 | 예측 성공률: 66.67%
2024-09-19 12:46:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 8/16
2024-09-19 12:46:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 82284120 | 당시BTC가격: 83061000 | 예측: 하락 | 지금 BTC가격: 83100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0811 | 반영가중치값: -0.0200 | 새 가중치: 0.0611 | 예측 총 횟수: 16 | 예측 성공 수: 8 | 예측 성공률: 50.00%
2024-09-19 12:46:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 12:46:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 12:46:48 - INFO - 새로운 가중치: {'gpt': 0.0030473251273683078, 'ml': 0.21401635218826703, 'xgboost': 0.03224293074080963, 'rl': 0.17430319385304407, 'lstm': 0.09839743052086089, 'arima': 0.056720545664873216, 'prophet': 0.17974310715947794, 'transformer': 0.18373967684848122, 'bitcoin_forecast': 0.05778943789681762}
2024-09-19 12:46:48 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 12:46:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 12:46:49 - INFO - Current BTC price: 83100000.0
2024-09-19 12:46:49 - INFO - Analyzing market conditions.
2024-09-19 12:46:49 - INFO - Market analysis: {'current_price': 83100000.0, 'sma_20': 83087450.0, 'rsi_14': 58.40984333154271, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 12:46:49 - INFO - Starting predictions for all models
2024-09-19 12:46:49 - INFO - Attempting prediction for gpt
2024-09-19 12:46:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 12:46:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:46:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:46:49 - INFO - GPT prediction: 83100000.0
2024-09-19 12:46:49 - INFO - Attempting prediction for ml
2024-09-19 12:46:49 - INFO - ML prediction: 83116620.0
2024-09-19 12:46:49 - INFO - Attempting prediction for xgboost
2024-09-19 12:46:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 12:46:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:46:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:46:49 - INFO - XGBOOST prediction: 83100000.0
2024-09-19 12:46:49 - INFO - Attempting prediction for lstm
2024-09-19 12:46:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:46:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:46:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 12:46:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:46:49 - INFO - X 샘플:
[[-1.83258689 -0.78604637 -1.72928925 -0.99970013  0.21026431  0.20515898
  -0.99970013]
 [-0.81360539 -1.33857233 -0.55972164 -0.54983507 -0.69698712 -0.69996557
  -0.54983507]
 [-0.11058714 -0.64009612  0.34065977  0.04998501  2.36835242  2.36357911
   0.04998501]
 [ 0.30806418  1.58043275  0.95329043  1.87943625  0.74037642  0.74822084
   1.87943625]
 [ 1.83258689  1.47618257  2.06716434  1.39958019 -0.12831727 -0.12134468
   1.39958019]
 [ 1.24015579  1.29895726  0.60056369  0.51984407 -0.01199781 -0.00872755
   0.51984407]
 [ 0.30806418 -0.44202077 -0.13273664 -0.79976011 -1.01403324 -1.01476876
  -0.79976011]
 [-0.74251366 -0.03544506 -0.29053545  0.48985307  0.52612971  0.52625503
   0.48985307]
 [ 0.30016509 -0.55669597 -0.9031661  -1.18964316 -0.9552515  -0.95857974
  -1.18964316]
 [-0.48974305 -0.55669597 -0.34622914 -0.79976011 -1.03853592 -1.03982765
  -0.79976011]]
2024-09-19 12:46:49 - INFO - y 샘플:
[-0.79976011]
2024-09-19 12:46:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 12:46:49 - INFO - 모델 출력 (스케일링된 예측): [[0.30871204]]
2024-09-19 12:46:49 - INFO - 스케일러 역변환 후 예측 가격: 83210880.46351403
2024-09-19 12:46:49 - INFO - LSTMPredictor 최종 예측 가격: 83210880.46351403
2024-09-19 12:46:49 - INFO - LSTM prediction: 83210880.46351403
2024-09-19 12:46:49 - INFO - Attempting prediction for rl
2024-09-19 12:46:49 - INFO - Preparing state for RL agent.
2024-09-19 12:46:49 - INFO - Prepared state: [[8.31000000e+07 1.52755141e+01 4.69534439e-04 8.30874500e+07
  5.84098433e+01]]
2024-09-19 12:46:49 - INFO - RL prediction: 83931000.0
2024-09-19 12:46:49 - INFO - Attempting prediction for arima
2024-09-19 12:46:49 - INFO - ARIMA 예측 시작
2024-09-19 12:46:49 - INFO - 입력 데이터: {'open': 83100000.0, 'high': 83200000.0, 'low': 83060000.0, 'close': 83100000.0, 'volume': 15.27551413, 'value': 1269664452.03923, 'decision': 'sell', 'sma': 83087450.0, 'ema': 82945453.25313354, 'rsi': 58.40984333154271, 'macd': 291833.8779439032, 'signal_line': 360155.79485005996, 'BB_Upper': 83501116.27854252, 'BB_Lower': 82673783.72145748}
2024-09-19 12:46:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 12:46:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83087450.0         0         0
2024-09-19 12:46:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83087450.0         0         0
2024-09-19 12:46:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 12:46:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 12:46:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 12:46:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 12:46:49 - INFO - Attempting prediction for prophet
2024-09-19 12:46:49 - INFO - PROPHET prediction: 83118453.29293583
2024-09-19 12:46:49 - INFO - Attempting prediction for transformer
2024-09-19 12:46:49 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:46:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:46:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:46:49 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 12:46:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:46:49 - INFO - X 샘플:
[[-1.83258689 -0.78604637 -1.72928925 -0.99970013  0.21026431  0.20515898
  -0.99970013 -0.99970013  0.          0.          0.         -0.99970013
  -0.99970013]
 [-0.81360539 -1.33857233 -0.55972164 -0.54983507 -0.69698712 -0.69996557
  -0.54983507 -0.54983507  0.          0.          0.         -0.54983507
  -0.54983507]
 [-0.11058714 -0.64009612  0.34065977  0.04998501  2.36835242  2.36357911
   0.04998501  0.04998501  0.          0.          0.          0.04998501
   0.04998501]
 [ 0.30806418  1.58043275  0.95329043  1.87943625  0.74037642  0.74822084
   1.87943625  1.87943625  0.          0.          0.          1.87943625
   1.87943625]
 [ 1.83258689  1.47618257  2.06716434  1.39958019 -0.12831727 -0.12134468
   1.39958019  1.39958019  0.          0.          0.          1.39958019
   1.39958019]
 [ 1.24015579  1.29895726  0.60056369  0.51984407 -0.01199781 -0.00872755
   0.51984407  0.51984407  0.          0.          0.          0.51984407
   0.51984407]
 [ 0.30806418 -0.44202077 -0.13273664 -0.79976011 -1.01403324 -1.01476876
  -0.79976011 -0.79976011  0.          0.          0.         -0.79976011
  -0.79976011]
 [-0.74251366 -0.03544506 -0.29053545  0.48985307  0.52612971  0.52625503
   0.48985307  0.48985307  0.          0.          0.          0.48985307
   0.48985307]
 [ 0.30016509 -0.55669597 -0.9031661  -1.18964316 -0.9552515  -0.95857974
  -1.18964316 -1.18964316  0.          0.          0.         -1.18964316
  -1.18964316]
 [-0.48974305 -0.55669597 -0.34622914 -0.79976011 -1.03853592 -1.03982765
  -0.79976011 -0.79976011  0.          0.          0.         -0.79976011
  -0.79976011]]
2024-09-19 12:46:49 - INFO - y 샘플:
[-0.79976011]
2024-09-19 12:46:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 12:46:49 - INFO - 모델 출력 (스케일링된 예측): [0.36514428]
2024-09-19 12:46:49 - INFO - 스케일러 역변환 후 예측 가격: 83216525.38094376
2024-09-19 12:46:49 - INFO - TransformerPredictor 최종 예측 가격: 83216525.38094376
2024-09-19 12:46:49 - INFO - TRANSFORMER prediction: 83216525.38094376
2024-09-19 12:46:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 12:46:49 - INFO - BITCOIN_FORECAST prediction: 82295971.06640512
2024-09-19 12:46:49 - INFO - BitcoinForecast prediction: 82295971.06640512
2024-09-19 12:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:46:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 12:46:58 - INFO - 조정된 모델 가중치: {'gpt': 0.0030473251273683078, 'ml': 0.21401635218826703, 'xgboost': 0.03224293074080963, 'rl': 0.17430319385304407, 'lstm': 0.09839743052086089, 'arima': 0.056720545664873216, 'prophet': 0.17974310715947794, 'transformer': 0.18373967684848122, 'bitcoin_forecast': 0.05778943789681762}
2024-09-19 12:46:58 - INFO - 조정된 모델 가중치: {'gpt': 0.0030473251273683078, 'ml': 0.21401635218826703, 'xgboost': 0.03224293074080963, 'rl': 0.17430319385304407, 'lstm': 0.09839743052086089, 'arima': 0.056720545664873216, 'prophet': 0.17974310715947794, 'transformer': 0.18373967684848122, 'bitcoin_forecast': 0.05778943789681762}
2024-09-19 12:46:58 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83112734.14548524, 'current_price': 83100000.0, 'predictions': {'gpt': 83100000.0, 'ml': 83116620.0, 'xgboost': 83100000.0, 'lstm': 83210880.46351403, 'rl': 83931000.0, 'arima': 80899000.0, 'prophet': 83118453.29293583, 'transformer': 83216525.38094376, 'bitcoin_forecast': 82295971.06640512}, 'weights': {'gpt': 0.0030473251273683078, 'ml': 0.21401635218826703, 'xgboost': 0.03224293074080963, 'rl': 0.17430319385304407, 'lstm': 0.09839743052086089, 'arima': 0.056720545664873216, 'prophet': 0.17974310715947794, 'transformer': 0.18373967684848122, 'bitcoin_forecast': 0.05778943789681762}}
2024-09-19 12:46:58 - INFO - 모델별 가중치:
2024-09-19 12:46:58 - INFO -   - GPT: 0.0030
2024-09-19 12:46:58 - INFO -   - ML: 0.2140
2024-09-19 12:46:58 - INFO -   - XGBOOST: 0.0322
2024-09-19 12:46:58 - INFO -   - RL: 0.1743
2024-09-19 12:46:58 - INFO -   - LSTM: 0.0984
2024-09-19 12:46:58 - INFO -   - ARIMA: 0.0567
2024-09-19 12:46:58 - INFO -   - PROPHET: 0.1797
2024-09-19 12:46:58 - INFO -   - TRANSFORMER: 0.1837
2024-09-19 12:46:58 - INFO -   - BITCOIN_FORECAST: 0.0578
2024-09-19 12:46:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 12:46:58 - INFO - 6. 거래 실행
2024-09-19 12:46:58 - INFO - Cancelling existing orders.
2024-09-19 12:46:58 - INFO - Cancelled 0 orders.
2024-09-19 12:46:58 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83112734.14548524, 'current_price': 83100000.0, 'predictions': {'gpt': 83100000.0, 'ml': 83116620.0, 'xgboost': 83100000.0, 'lstm': 83210880.46351403, 'rl': 83931000.0, 'arima': 80899000.0, 'prophet': 83118453.29293583, 'transformer': 83216525.38094376, 'bitcoin_forecast': 82295971.06640512}, 'weights': {'gpt': 0.0030473251273683078, 'ml': 0.21401635218826703, 'xgboost': 0.03224293074080963, 'rl': 0.17430319385304407, 'lstm': 0.09839743052086089, 'arima': 0.056720545664873216, 'prophet': 0.17974310715947794, 'transformer': 0.18373967684848122, 'bitcoin_forecast': 0.05778943789681762}}, 현재 가격=83100000.0
2024-09-19 12:46:58 - INFO - 현재 잔고: KRW=332859.88170078, BTC=0.00173781, 총 자산가치=477271.89270078
2024-09-19 12:46:58 - INFO - 매수 시도: 0.0005743344075821661 BTC (약 47727.189270078 KRW)
2024-09-19 12:46:58 - INFO - 주문 결과: {'uuid': 'c7ab34ce-69c6-40b2-8077-f588d72e3d45', 'side': 'bid', 'ord_type': 'limit', 'price': '83100000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T12:47:00+09:00', 'volume': '0.00057433', 'remaining_volume': '0.00057433', 'reserved_fee': '23.8634115', 'remaining_fee': '23.8634115', 'paid_fee': '0', 'locked': '47750.6864115', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 12:46:58 - INFO - buy 주문 성공: UUID=c7ab34ce-69c6-40b2-8077-f588d72e3d45
2024-09-19 12:46:58 - INFO - Trade executed successfully.
2024-09-19 12:46:58 - INFO - 7. summary 리포트 보내기
2024-09-19 12:46:59 - INFO - Message sent to Discord successfully.
2024-09-19 12:46:59 - INFO - Trading cycle completed.
2024-09-19 12:46:59 - INFO - Performing periodic update.
2024-09-19 12:46:59 - INFO - 계산된 시장 변동성: 0.03868543397747865
2024-09-19 12:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/33c53e9d-1565-4bcc-a773-8df28d0271dd "HTTP/1.1 200 OK"
2024-09-19 12:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:55:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:55:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/f920ff1a-e45f-41fd-96b6-79f5532baf89 "HTTP/1.1 200 OK"
2024-09-19 12:55:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:55:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:55:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-aaf7-e5dae85163bb "HTTP/1.1 200 OK"
2024-09-19 12:55:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812a-9386-faa44d1c1e5b "HTTP/1.1 200 OK"
2024-09-19 12:56:00 - INFO - Updated actual price for lstm prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-adce-cef7d6007fa9 "HTTP/1.1 200 OK"
2024-09-19 12:56:09 - INFO - Updated actual price for rl prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8133-b942-d3b790a5dbcd "HTTP/1.1 200 OK"
2024-09-19 12:56:20 - INFO - Updated actual price for arima prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f4-9852-e27b025ae48a "HTTP/1.1 200 OK"
2024-09-19 12:56:27 - INFO - Updated actual price for prophet prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8112-b84f-e29273b826ba "HTTP/1.1 200 OK"
2024-09-19 12:56:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 12:56:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/6d2d0228-fb5b-479f-af2c-79c7fcf78e8d "HTTP/1.1 200 OK"
2024-09-19 12:56:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 12:45:34.906349
2024-09-19 12:56:48 - INFO - Starting trading cycle.
2024-09-19 12:56:48 - INFO - ##################################################
2024-09-19 12:56:48 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-19 12:56:48 - INFO - ##################################################
2024-09-19 12:56:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 12:56:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 12:56:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 12:40:00
2024-09-19 12:56:48 - INFO - 새로운 데이터 범위: 2024-09-18 03:40:00 ~ 2024-09-19 12:50:00
2024-09-19 12:56:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 12:56:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 12:56:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 12:56:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 12:56:48 - INFO - Sample date values: [Timestamp('2024-09-19 12:50:00')]
2024-09-19 12:56:49 - INFO - Successfully added 1 new data points
2024-09-19 12:56:49 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 12:56:49 - INFO - Final date range: 2024-09-19 12:50:00 to 2024-09-19 12:50:00
2024-09-19 12:56:49 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 12:56:49 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 12:50:00
2024-09-19 12:56:49 - INFO - 데이터베이스 업데이트 완료
2024-09-19 12:56:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 12:56:49 - INFO - GPT | 이전예측가격: 83100000 | 당시BTC가격: 83100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:56:49 - INFO - ML 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 33/57
2024-09-19 12:56:49 - INFO - ML | 이전예측가격: 83116620 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2309 | 반영가중치값: -0.0200 | 새 가중치: 0.2109 | 예측 총 횟수: 57 | 예측 성공 수: 33 | 예측 성공률: 57.89%
2024-09-19 12:56:49 - INFO - XGBOOST | 이전예측가격: 83100000 | 당시BTC가격: 83100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 12:56:49 - INFO - LSTM 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 10/17
2024-09-19 12:56:49 - INFO - LSTM | 이전예측가격: 83210880 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1545 | 반영가중치값: -0.0200 | 새 가중치: 0.1345 | 예측 총 횟수: 17 | 예측 성공 수: 10 | 예측 성공률: 58.82%
2024-09-19 12:56:49 - INFO - RL 모델 예측 업데이트: 정확도 55.84%, 적중/전체: 43/77
2024-09-19 12:56:49 - INFO - RL | 이전예측가격: 83931000 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1547 | 반영가중치값: -0.0200 | 새 가중치: 0.1347 | 예측 총 횟수: 77 | 예측 성공 수: 43 | 예측 성공률: 55.84%
2024-09-19 12:56:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.62%, 적중/전체: 94/169
2024-09-19 12:56:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83100000 | 예측: 하락 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0825 | 반영가중치값: 0.0200 | 새 가중치: 0.1025 | 예측 총 횟수: 169 | 예측 성공 수: 94 | 예측 성공률: 55.62%
2024-09-19 12:56:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 56.76%, 적중/전체: 21/37
2024-09-19 12:56:49 - INFO - PROPHET | 이전예측가격: 83118453 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1059 | 반영가중치값: -0.0200 | 새 가중치: 0.0859 | 예측 총 횟수: 37 | 예측 성공 수: 21 | 예측 성공률: 56.76%
2024-09-19 12:56:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 10/16
2024-09-19 12:56:49 - INFO - TRANSFORMER | 이전예측가격: 83216525 | 당시BTC가격: 83100000 | 예측: 상승 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1806 | 반영가중치값: -0.0200 | 새 가중치: 0.1606 | 예측 총 횟수: 16 | 예측 성공 수: 10 | 예측 성공률: 62.50%
2024-09-19 12:56:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 9/17
2024-09-19 12:56:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 82295971 | 당시BTC가격: 83100000 | 예측: 하락 | 지금 BTC가격: 83024000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0536 | 반영가중치값: 0.0200 | 새 가중치: 0.0736 | 예측 총 횟수: 17 | 예측 성공 수: 9 | 예측 성공률: 52.94%
2024-09-19 12:56:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 12:56:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 12:56:49 - INFO - 새로운 가중치: {'gpt': 0.003248890744584461, 'ml': 0.22489105618151797, 'xgboost': 0.034375642533607934, 'rl': 0.14357666034184266, 'lstm': 0.14336966104964005, 'arima': 0.10924396492770189, 'prophet': 0.09154004307274181, 'transformer': 0.17127447068517776, 'bitcoin_forecast': 0.0784796104631855}
2024-09-19 12:56:49 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 12:56:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 12:56:49 - INFO - Current BTC price: 83024000.0
2024-09-19 12:56:49 - INFO - Analyzing market conditions.
2024-09-19 12:56:49 - INFO - Market analysis: {'current_price': 83024000.0, 'sma_20': 83082550.0, 'rsi_14': 56.152505022824805, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 12:56:49 - INFO - Starting predictions for all models
2024-09-19 12:56:49 - INFO - Attempting prediction for gpt
2024-09-19 12:56:50 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 12:56:50 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:56:50 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 12:56:50 - INFO - GPT prediction: 83024000.0
2024-09-19 12:56:50 - INFO - Attempting prediction for ml
2024-09-19 12:56:50 - INFO - ML prediction: 83040604.8
2024-09-19 12:56:50 - INFO - Attempting prediction for xgboost
2024-09-19 12:56:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 12:56:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:56:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 12:56:50 - INFO - XGBOOST prediction: 83024000.0
2024-09-19 12:56:50 - INFO - Attempting prediction for lstm
2024-09-19 12:56:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:56:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:56:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 12:56:50 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:56:50 - INFO - X 샘플:
[[-1.0360295  -1.1113562  -0.72931213 -0.46250627 -0.45807513 -0.46079532
  -0.46250627]
 [-0.22577796 -0.48510838  0.29298955  0.09924224  2.29760326  2.29204689
   0.09924224]
 [ 0.25673139  1.50579885  0.98857626  1.81257518  0.83408568  0.84051708
   1.81257518]
 [ 2.01379371  1.41232903  2.25327937  1.36317637  0.05314759  0.05914226
   1.36317637]
 [ 1.33099747  1.25343033  0.58808695  0.53927857  0.15771644  0.16033784
   0.53927857]
 [ 0.25673139 -0.30751572 -0.24450927 -0.69656815 -0.74309319 -0.7436714
  -0.69656815]
 [-0.95409395  0.05701659 -0.42367554  0.51119114  0.64148222  0.64106288
   0.51119114]
 [ 0.24762744 -0.41033252 -1.11926225 -1.06170468 -0.69024959 -0.69318103
  -1.06170468]
 [-0.66276755 -0.41033252 -0.4869107  -0.69656815 -0.7651206  -0.76618884
  -0.69656815]
 [-1.22721244 -1.50392946 -1.11926225 -1.40811625 -1.32749668 -1.32927036
  -1.40811625]]
2024-09-19 12:56:50 - INFO - y 샘플:
[-1.40811625]
2024-09-19 12:56:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 12:56:50 - INFO - 모델 출력 (스케일링된 예측): [[0.29961598]]
2024-09-19 12:56:50 - INFO - 스케일러 역변환 후 예측 가격: 83206401.7918481
2024-09-19 12:56:50 - INFO - LSTMPredictor 최종 예측 가격: 83206401.7918481
2024-09-19 12:56:50 - INFO - LSTM prediction: 83206401.7918481
2024-09-19 12:56:50 - INFO - Attempting prediction for rl
2024-09-19 12:56:50 - INFO - Preparing state for RL agent.
2024-09-19 12:56:50 - INFO - Prepared state: [[ 8.30240000e+07  1.19064966e+01 -9.14560770e-04  8.30825500e+07
   5.61525050e+01]]
2024-09-19 12:56:50 - INFO - RL prediction: 83854240.0
2024-09-19 12:56:50 - INFO - Attempting prediction for arima
2024-09-19 12:56:50 - INFO - ARIMA 예측 시작
2024-09-19 12:56:50 - INFO - 입력 데이터: {'open': 83038000.0, 'high': 83083000.0, 'low': 83000000.0, 'close': 83024000.0, 'volume': 11.90649664, 'value': 988649631.84766, 'decision': 'sell', 'sma': 83082550.0, 'ema': 82952933.89569224, 'rsi': 56.152505022824805, 'macd': 264360.8497186303, 'signal_line': 340996.8058237741, 'BB_Upper': 83496784.4625912, 'BB_Lower': 82668315.5374088}
2024-09-19 12:56:50 - INFO - Exogenous 변수 예측 시작
2024-09-19 12:56:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83082550.0         0         0
2024-09-19 12:56:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83082550.0         0         0
2024-09-19 12:56:50 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 12:56:50 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 12:56:50 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 12:56:50 - INFO - ARIMA prediction: 80899000.0
2024-09-19 12:56:50 - INFO - Attempting prediction for prophet
2024-09-19 12:56:50 - INFO - PROPHET prediction: 83028070.45665486
2024-09-19 12:56:50 - INFO - Attempting prediction for transformer
2024-09-19 12:56:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 12:56:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 12:56:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 12:56:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 12:56:50 - INFO - X dtype: float64, y dtype: float64
2024-09-19 12:56:50 - INFO - X 샘플:
[[-1.0360295  -1.1113562  -0.72931213 -0.46250627 -0.45807513 -0.46079532
  -0.46250627 -0.46250627  0.          0.          0.         -0.46250627
  -0.46250627]
 [-0.22577796 -0.48510838  0.29298955  0.09924224  2.29760326  2.29204689
   0.09924224  0.09924224  0.          0.          0.          0.09924224
   0.09924224]
 [ 0.25673139  1.50579885  0.98857626  1.81257518  0.83408568  0.84051708
   1.81257518  1.81257518  0.          0.          0.          1.81257518
   1.81257518]
 [ 2.01379371  1.41232903  2.25327937  1.36317637  0.05314759  0.05914226
   1.36317637  1.36317637  0.          0.          0.          1.36317637
   1.36317637]
 [ 1.33099747  1.25343033  0.58808695  0.53927857  0.15771644  0.16033784
   0.53927857  0.53927857  0.          0.          0.          0.53927857
   0.53927857]
 [ 0.25673139 -0.30751572 -0.24450927 -0.69656815 -0.74309319 -0.7436714
  -0.69656815 -0.69656815  0.          0.          0.         -0.69656815
  -0.69656815]
 [-0.95409395  0.05701659 -0.42367554  0.51119114  0.64148222  0.64106288
   0.51119114  0.51119114  0.          0.          0.          0.51119114
   0.51119114]
 [ 0.24762744 -0.41033252 -1.11926225 -1.06170468 -0.69024959 -0.69318103
  -1.06170468 -1.06170468  0.          0.          0.         -1.06170468
  -1.06170468]
 [-0.66276755 -0.41033252 -0.4869107  -0.69656815 -0.7651206  -0.76618884
  -0.69656815 -0.69656815  0.          0.          0.         -0.69656815
  -0.69656815]
 [-1.22721244 -1.50392946 -1.11926225 -1.40811625 -1.32749668 -1.32927036
  -1.40811625 -1.40811625  0.          0.          0.         -1.40811625
  -1.40811625]]
2024-09-19 12:56:50 - INFO - y 샘플:
[-1.40811625]
2024-09-19 12:56:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 12:56:50 - INFO - 모델 출력 (스케일링된 예측): [0.36563993]
2024-09-19 12:56:50 - INFO - 스케일러 역변환 후 예측 가격: 83213453.76743507
2024-09-19 12:56:50 - INFO - TransformerPredictor 최종 예측 가격: 83213453.76743507
2024-09-19 12:56:50 - INFO - TRANSFORMER prediction: 83213453.76743507
2024-09-19 12:56:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 12:56:50 - INFO - BITCOIN_FORECAST prediction: 82269671.11635786
2024-09-19 12:56:50 - INFO - BitcoinForecast prediction: 82269671.11635786
2024-09-19 12:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 12:56:57 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 12:56:57 - INFO - 조정된 모델 가중치: {'gpt': 0.003248890744584461, 'ml': 0.22489105618151797, 'xgboost': 0.034375642533607934, 'rl': 0.14357666034184266, 'lstm': 0.14336966104964005, 'arima': 0.10924396492770189, 'prophet': 0.09154004307274181, 'transformer': 0.17127447068517776, 'bitcoin_forecast': 0.0784796104631855}
2024-09-19 12:56:57 - INFO - 조정된 모델 가중치: {'gpt': 0.003248890744584461, 'ml': 0.22489105618151797, 'xgboost': 0.034375642533607934, 'rl': 0.14357666034184266, 'lstm': 0.14336966104964005, 'arima': 0.10924396492770189, 'prophet': 0.09154004307274181, 'transformer': 0.17127447068517776, 'bitcoin_forecast': 0.0784796104631855}
2024-09-19 12:56:57 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82914566.58165754, 'current_price': 83024000.0, 'predictions': {'gpt': 83024000.0, 'ml': 83040604.8, 'xgboost': 83024000.0, 'lstm': 83206401.7918481, 'rl': 83854240.0, 'arima': 80899000.0, 'prophet': 83028070.45665486, 'transformer': 83213453.76743507, 'bitcoin_forecast': 82269671.11635786}, 'weights': {'gpt': 0.003248890744584461, 'ml': 0.22489105618151797, 'xgboost': 0.034375642533607934, 'rl': 0.14357666034184266, 'lstm': 0.14336966104964005, 'arima': 0.10924396492770189, 'prophet': 0.09154004307274181, 'transformer': 0.17127447068517776, 'bitcoin_forecast': 0.0784796104631855}}
2024-09-19 12:56:57 - INFO - 모델별 가중치:
2024-09-19 12:56:57 - INFO -   - GPT: 0.0032
2024-09-19 12:56:57 - INFO -   - ML: 0.2249
2024-09-19 12:56:57 - INFO -   - XGBOOST: 0.0344
2024-09-19 12:56:57 - INFO -   - RL: 0.1436
2024-09-19 12:56:57 - INFO -   - LSTM: 0.1434
2024-09-19 12:56:57 - INFO -   - ARIMA: 0.1092
2024-09-19 12:56:57 - INFO -   - PROPHET: 0.0915
2024-09-19 12:56:57 - INFO -   - TRANSFORMER: 0.1713
2024-09-19 12:56:57 - INFO -   - BITCOIN_FORECAST: 0.0785
2024-09-19 12:56:57 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 12:56:57 - INFO - 6. 거래 실행
2024-09-19 12:56:57 - INFO - Cancelling existing orders.
2024-09-19 12:56:57 - INFO - Cancelled 0 orders.
2024-09-19 12:56:57 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82914566.58165754, 'current_price': 83024000.0, 'predictions': {'gpt': 83024000.0, 'ml': 83040604.8, 'xgboost': 83024000.0, 'lstm': 83206401.7918481, 'rl': 83854240.0, 'arima': 80899000.0, 'prophet': 83028070.45665486, 'transformer': 83213453.76743507, 'bitcoin_forecast': 82269671.11635786}, 'weights': {'gpt': 0.003248890744584461, 'ml': 0.22489105618151797, 'xgboost': 0.034375642533607934, 'rl': 0.14357666034184266, 'lstm': 0.14336966104964005, 'arima': 0.10924396492770189, 'prophet': 0.09154004307274181, 'transformer': 0.17127447068517776, 'bitcoin_forecast': 0.0784796104631855}}, 현재 가격=83024000.0
2024-09-19 12:56:58 - INFO - 현재 잔고: KRW=285109.19528928, BTC=0.00231214, 총 자산가치=477072.30664927996
2024-09-19 12:56:58 - INFO - 매도 시도: 0.000231214 BTC (약 19196.311136 KRW)
2024-09-19 12:56:58 - INFO - 주문 결과: {'uuid': 'eedee38d-d0b0-406d-92d2-051b90dda2e7', 'side': 'ask', 'ord_type': 'limit', 'price': '83024000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T12:56:59+09:00', 'volume': '0.00023121', 'remaining_volume': '0.00023121', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00023121', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 12:56:58 - INFO - sell 주문 성공: UUID=eedee38d-d0b0-406d-92d2-051b90dda2e7
2024-09-19 12:56:58 - INFO - Trade executed successfully.
2024-09-19 12:56:58 - INFO - 7. summary 리포트 보내기
2024-09-19 12:56:58 - INFO - Message sent to Discord successfully.
2024-09-19 12:56:58 - INFO - Trading cycle completed.
2024-09-19 12:56:58 - INFO - Performing periodic update.
2024-09-19 12:56:58 - INFO - 계산된 시장 변동성: 0.03859708444833998
2024-09-19 13:05:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819f-96fb-d6f9227d7eb9 "HTTP/1.1 200 OK"
2024-09-19 13:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:05:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:05:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a17ab8e3-dab7-439b-a312-0b9294c5793d "HTTP/1.1 200 OK"
2024-09-19 13:05:45 - INFO - Updated actual price for ml prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:05:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:05:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-be89-f5549af94b3e "HTTP/1.1 200 OK"
2024-09-19 13:05:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819f-ab24-cdf4a413d287 "HTTP/1.1 200 OK"
2024-09-19 13:06:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812c-8765-f68270d7045d "HTTP/1.1 200 OK"
2024-09-19 13:06:13 - INFO - Updated actual price for rl prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8193-9905-f069979fa43f "HTTP/1.1 200 OK"
2024-09-19 13:06:22 - INFO - Updated actual price for arima prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d8-8180-c98d4ed4bc80 "HTTP/1.1 200 OK"
2024-09-19 13:06:28 - INFO - Updated actual price for prophet prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-943f-fdbd48e5174a "HTTP/1.1 200 OK"
2024-09-19 13:06:33 - INFO - Updated actual price for transformer prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:06:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a4-ab40-d231341c2abc "HTTP/1.1 200 OK"
2024-09-19 13:06:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 12:55:34.906645
2024-09-19 13:06:38 - INFO - Starting trading cycle.
2024-09-19 13:06:38 - INFO - ##################################################
2024-09-19 13:06:38 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-19 13:06:38 - INFO - ##################################################
2024-09-19 13:06:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:06:38 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:06:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 12:50:00
2024-09-19 13:06:38 - INFO - 새로운 데이터 범위: 2024-09-18 03:50:00 ~ 2024-09-19 13:00:00
2024-09-19 13:06:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:06:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:06:38 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:06:38 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:06:38 - INFO - Sample date values: [Timestamp('2024-09-19 13:00:00')]
2024-09-19 13:06:38 - INFO - Successfully added 1 new data points
2024-09-19 13:06:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:06:38 - INFO - Final date range: 2024-09-19 13:00:00 to 2024-09-19 13:00:00
2024-09-19 13:06:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:06:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:00:00
2024-09-19 13:06:38 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:06:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:06:38 - INFO - GPT | 이전예측가격: 83024000 | 당시BTC가격: 83024000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:06:38 - INFO - ML 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 34/58
2024-09-19 13:06:38 - INFO - ML | 이전예측가격: 83040605 | 당시BTC가격: 83024000 | 예측: 상승 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2140 | 반영가중치값: 0.0200 | 새 가중치: 0.2340 | 예측 총 횟수: 58 | 예측 성공 수: 34 | 예측 성공률: 58.62%
2024-09-19 13:06:38 - INFO - XGBOOST | 이전예측가격: 83024000 | 당시BTC가격: 83024000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:06:38 - INFO - LSTM 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 11/18
2024-09-19 13:06:38 - INFO - LSTM | 이전예측가격: 83206402 | 당시BTC가격: 83024000 | 예측: 상승 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0984 | 반영가중치값: 0.0200 | 새 가중치: 0.1184 | 예측 총 횟수: 18 | 예측 성공 수: 11 | 예측 성공률: 61.11%
2024-09-19 13:06:38 - INFO - RL 모델 예측 업데이트: 정확도 56.41%, 적중/전체: 44/78
2024-09-19 13:06:38 - INFO - RL | 이전예측가격: 83854240 | 당시BTC가격: 83024000 | 예측: 상승 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1743 | 반영가중치값: 0.0200 | 새 가중치: 0.1943 | 예측 총 횟수: 78 | 예측 성공 수: 44 | 예측 성공률: 56.41%
2024-09-19 13:06:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.29%, 적중/전체: 94/170
2024-09-19 13:06:38 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83024000 | 예측: 하락 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0567 | 반영가중치값: -0.0200 | 새 가중치: 0.0367 | 예측 총 횟수: 170 | 예측 성공 수: 94 | 예측 성공률: 55.29%
2024-09-19 13:06:39 - INFO - PROPHET | 이전예측가격: 83028070 | 당시BTC가격: 83024000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:06:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 64.71%, 적중/전체: 11/17
2024-09-19 13:06:39 - INFO - TRANSFORMER | 이전예측가격: 83213454 | 당시BTC가격: 83024000 | 예측: 상승 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1837 | 반영가중치값: 0.0200 | 새 가중치: 0.2037 | 예측 총 횟수: 17 | 예측 성공 수: 11 | 예측 성공률: 64.71%
2024-09-19 13:06:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 9/18
2024-09-19 13:06:39 - INFO - BITCOIN_FORECAST | 이전예측가격: 82269671 | 당시BTC가격: 83024000 | 예측: 하락 | 지금 BTC가격: 83068000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0578 | 반영가중치값: -0.0200 | 새 가중치: 0.0378 | 예측 총 횟수: 18 | 예측 성공 수: 9 | 예측 성공률: 50.00%
2024-09-19 13:06:39 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:06:39 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:06:39 - INFO - 새로운 가중치: {'gpt': 0.0034050775189173833, 'ml': 0.2452664255403389, 'xgboost': 0.03602821294764706, 'rl': 0.2036441017124658, 'lstm': 0.1240892540434536, 'arima': 0.03848584466383198, 'prophet': 0.09594072785220398, 'transformer': 0.21353423303158436, 'bitcoin_forecast': 0.039606122689556975}
2024-09-19 13:06:39 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 13:06:39 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:06:39 - INFO - Current BTC price: 83068000.0
2024-09-19 13:06:39 - INFO - Analyzing market conditions.
2024-09-19 13:06:39 - INFO - Market analysis: {'current_price': 83068000.0, 'sma_20': 83078000.0, 'rsi_14': 57.18417013483029, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:06:39 - INFO - Starting predictions for all models
2024-09-19 13:06:39 - INFO - Attempting prediction for gpt
2024-09-19 13:06:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:06:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:06:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:06:39 - INFO - GPT prediction: 83068000.0
2024-09-19 13:06:39 - INFO - Attempting prediction for ml
2024-09-19 13:06:39 - INFO - ML prediction: 82968318.4
2024-09-19 13:06:39 - INFO - Attempting prediction for xgboost
2024-09-19 13:06:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:06:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:06:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:06:39 - INFO - XGBOOST prediction: 83068000.0
2024-09-19 13:06:39 - INFO - Attempting prediction for lstm
2024-09-19 13:06:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:06:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:06:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:06:39 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:06:39 - INFO - X 샘플:
[[-0.2156965  -0.50233821  0.30800098  0.14718885  2.29237331  2.28695724
   0.14718885]
 [ 0.26262629  1.51269076  0.99244761  1.79967711  0.81595476  0.8225517
   1.79967711]
 [ 2.00444325  1.41808846  2.23689603  1.36623756  0.02813266  0.03424574
   1.36623756]
 [ 1.32757137  1.25726455  0.59837228  0.5715984   0.13362328  0.13633897
   0.5715984 ]
 [ 0.26262629 -0.32259384 -0.22088959 -0.62036035 -0.77512703 -0.77568925
  -0.62036035]
 [-0.93769317  0.04635513 -0.39718645  0.54450843  0.62165348  0.62132825
   0.54450843]
 [ 0.25360133 -0.42665637 -1.08163308 -0.97252998 -0.72181761 -0.72475101
  -0.97252998]
 [-0.6488945  -0.42665637 -0.45940887 -0.62036035 -0.79734862 -0.79840643
  -0.62036035]
 [-1.20844192 -1.53350327 -1.08163308 -1.30663962 -1.36468207 -1.36648274
  -1.30663962]
 [-1.10014242 -1.02265085 -0.89496582 -0.90932004 -0.23276216 -0.23609247
  -0.90932004]]
2024-09-19 13:06:39 - INFO - y 샘플:
[-0.90932004]
2024-09-19 13:06:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:06:39 - INFO - 모델 출력 (스케일링된 예측): [[0.28477126]]
2024-09-19 13:06:39 - INFO - 스케일러 역변환 후 예측 가격: 83200236.16426319
2024-09-19 13:06:39 - INFO - LSTMPredictor 최종 예측 가격: 83200236.16426319
2024-09-19 13:06:39 - INFO - LSTM prediction: 83200236.16426319
2024-09-19 13:06:39 - INFO - Attempting prediction for rl
2024-09-19 13:06:39 - INFO - Preparing state for RL agent.
2024-09-19 13:06:39 - INFO - Prepared state: [[8.30680000e+07 1.86282190e+01 5.29967238e-04 8.30780000e+07
  5.71841701e+01]]
2024-09-19 13:06:39 - INFO - RL prediction: 83898680.0
2024-09-19 13:06:39 - INFO - Attempting prediction for arima
2024-09-19 13:06:39 - INFO - ARIMA 예측 시작
2024-09-19 13:06:39 - INFO - 입력 데이터: {'open': 83050000.0, 'high': 83137000.0, 'low': 83018000.0, 'close': 83068000.0, 'volume': 18.62821903, 'value': 1547828764.24842, 'decision': 'sell', 'sma': 83078000.0, 'ema': 82963892.57229298, 'rsi': 57.18417013483029, 'macd': 243333.7096593082, 'signal_line': 321464.18659088097, 'BB_Upper': 83490772.09208183, 'BB_Lower': 82665227.90791817}
2024-09-19 13:06:39 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:06:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83078000.0         0         0
2024-09-19 13:06:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83078000.0         0         0
2024-09-19 13:06:39 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:06:39 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:06:39 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:06:39 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:06:39 - INFO - Attempting prediction for prophet
2024-09-19 13:06:39 - INFO - PROPHET prediction: 83082453.00158198
2024-09-19 13:06:39 - INFO - Attempting prediction for transformer
2024-09-19 13:06:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:06:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:06:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:06:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:06:39 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:06:39 - INFO - X 샘플:
[[-0.2156965  -0.50233821  0.30800098  0.14718885  2.29237331  2.28695724
   0.14718885  0.14718885  0.          0.          0.          0.14718885
   0.14718885]
 [ 0.26262629  1.51269076  0.99244761  1.79967711  0.81595476  0.8225517
   1.79967711  1.79967711  0.          0.          0.          1.79967711
   1.79967711]
 [ 2.00444325  1.41808846  2.23689603  1.36623756  0.02813266  0.03424574
   1.36623756  1.36623756  0.          0.          0.          1.36623756
   1.36623756]
 [ 1.32757137  1.25726455  0.59837228  0.5715984   0.13362328  0.13633897
   0.5715984   0.5715984   0.          0.          0.          0.5715984
   0.5715984 ]
 [ 0.26262629 -0.32259384 -0.22088959 -0.62036035 -0.77512703 -0.77568925
  -0.62036035 -0.62036035  0.          0.          0.         -0.62036035
  -0.62036035]
 [-0.93769317  0.04635513 -0.39718645  0.54450843  0.62165348  0.62132825
   0.54450843  0.54450843  0.          0.          0.          0.54450843
   0.54450843]
 [ 0.25360133 -0.42665637 -1.08163308 -0.97252998 -0.72181761 -0.72475101
  -0.97252998 -0.97252998  0.          0.          0.         -0.97252998
  -0.97252998]
 [-0.6488945  -0.42665637 -0.45940887 -0.62036035 -0.79734862 -0.79840643
  -0.62036035 -0.62036035  0.          0.          0.         -0.62036035
  -0.62036035]
 [-1.20844192 -1.53350327 -1.08163308 -1.30663962 -1.36468207 -1.36648274
  -1.30663962 -1.30663962  0.          0.          0.         -1.30663962
  -1.30663962]
 [-1.10014242 -1.02265085 -0.89496582 -0.90932004 -0.23276216 -0.23609247
  -0.90932004 -0.90932004  0.          0.          0.         -0.90932004
  -0.90932004]]
2024-09-19 13:06:39 - INFO - y 샘플:
[-0.90932004]
2024-09-19 13:06:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:06:39 - INFO - 모델 출력 (스케일링된 예측): [0.36636144]
2024-09-19 13:06:39 - INFO - 스케일러 역변환 후 예측 가격: 83209271.63065249
2024-09-19 13:06:39 - INFO - TransformerPredictor 최종 예측 가격: 83209271.63065249
2024-09-19 13:06:39 - INFO - TRANSFORMER prediction: 83209271.63065249
2024-09-19 13:06:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:06:39 - INFO - BITCOIN_FORECAST prediction: 82319008.89061058
2024-09-19 13:06:39 - INFO - BitcoinForecast prediction: 82319008.89061058
2024-09-19 13:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:06:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:06:51 - INFO - 조정된 모델 가중치: {'gpt': 0.0034050775189173833, 'ml': 0.2452664255403389, 'xgboost': 0.03602821294764706, 'rl': 0.2036441017124658, 'lstm': 0.1240892540434536, 'arima': 0.03848584466383198, 'prophet': 0.09594072785220398, 'transformer': 0.21353423303158436, 'bitcoin_forecast': 0.039606122689556975}
2024-09-19 13:06:51 - INFO - 조정된 모델 가중치: {'gpt': 0.0034050775189173833, 'ml': 0.2452664255403389, 'xgboost': 0.03602821294764706, 'rl': 0.2036441017124658, 'lstm': 0.1240892540434536, 'arima': 0.03848584466383198, 'prophet': 0.09594072785220398, 'transformer': 0.21353423303158436, 'bitcoin_forecast': 0.039606122689556975}
2024-09-19 13:06:51 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83147536.14961156, 'current_price': 83068000.0, 'predictions': {'gpt': 83068000.0, 'ml': 82968318.4, 'xgboost': 83068000.0, 'lstm': 83200236.16426319, 'rl': 83898680.0, 'arima': 80899000.0, 'prophet': 83082453.00158198, 'transformer': 83209271.63065249, 'bitcoin_forecast': 82319008.89061058}, 'weights': {'gpt': 0.0034050775189173833, 'ml': 0.2452664255403389, 'xgboost': 0.03602821294764706, 'rl': 0.2036441017124658, 'lstm': 0.1240892540434536, 'arima': 0.03848584466383198, 'prophet': 0.09594072785220398, 'transformer': 0.21353423303158436, 'bitcoin_forecast': 0.039606122689556975}}
2024-09-19 13:06:51 - INFO - 모델별 가중치:
2024-09-19 13:06:51 - INFO -   - GPT: 0.0034
2024-09-19 13:06:51 - INFO -   - ML: 0.2453
2024-09-19 13:06:51 - INFO -   - XGBOOST: 0.0360
2024-09-19 13:06:51 - INFO -   - RL: 0.2036
2024-09-19 13:06:51 - INFO -   - LSTM: 0.1241
2024-09-19 13:06:51 - INFO -   - ARIMA: 0.0385
2024-09-19 13:06:51 - INFO -   - PROPHET: 0.0959
2024-09-19 13:06:51 - INFO -   - TRANSFORMER: 0.2135
2024-09-19 13:06:51 - INFO -   - BITCOIN_FORECAST: 0.0396
2024-09-19 13:06:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:06:51 - INFO - 6. 거래 실행
2024-09-19 13:06:51 - INFO - Cancelling existing orders.
2024-09-19 13:06:51 - INFO - Cancelled 0 orders.
2024-09-19 13:06:51 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83147536.14961156, 'current_price': 83068000.0, 'predictions': {'gpt': 83068000.0, 'ml': 82968318.4, 'xgboost': 83068000.0, 'lstm': 83200236.16426319, 'rl': 83898680.0, 'arima': 80899000.0, 'prophet': 83082453.00158198, 'transformer': 83209271.63065249, 'bitcoin_forecast': 82319008.89061058}, 'weights': {'gpt': 0.0034050775189173833, 'ml': 0.2452664255403389, 'xgboost': 0.03602821294764706, 'rl': 0.2036441017124658, 'lstm': 0.1240892540434536, 'arima': 0.03848584466383198, 'prophet': 0.09594072785220398, 'transformer': 0.21353423303158436, 'bitcoin_forecast': 0.039606122689556975}}, 현재 가격=83068000.0
2024-09-19 13:06:51 - INFO - 현재 잔고: KRW=304295.57633976, BTC=0.00208093, 총 자산가치=477154.26957976
2024-09-19 13:06:51 - INFO - 매수 시도: 0.0005744140578559252 BTC (약 47715.42695797599 KRW)
2024-09-19 13:06:51 - INFO - 주문 결과: {'uuid': '69648229-620f-4113-ab55-7e0feaf539fb', 'side': 'bid', 'ord_type': 'limit', 'price': '83068000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:06:53+09:00', 'volume': '0.00057441', 'remaining_volume': '0.00057441', 'reserved_fee': '23.85754494', 'remaining_fee': '23.85754494', 'paid_fee': '0', 'locked': '47738.94742494', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:06:51 - INFO - buy 주문 성공: UUID=69648229-620f-4113-ab55-7e0feaf539fb
2024-09-19 13:06:51 - INFO - Trade executed successfully.
2024-09-19 13:06:51 - INFO - 7. summary 리포트 보내기
2024-09-19 13:06:52 - INFO - Message sent to Discord successfully.
2024-09-19 13:06:52 - INFO - Trading cycle completed.
2024-09-19 13:06:52 - INFO - Performing periodic update.
2024-09-19 13:06:52 - INFO - 계산된 시장 변동성: 0.03853960144433083
2024-09-19 13:15:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:15:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8117-ba77-c740dff15eda "HTTP/1.1 200 OK"
2024-09-19 13:15:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:15:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a4-8287-deba504ac838 "HTTP/1.1 200 OK"
2024-09-19 13:15:56 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-b9b7-f2dc2d5d03a9 "HTTP/1.1 200 OK"
2024-09-19 13:16:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8102-a055-da90035c97d3 "HTTP/1.1 200 OK"
2024-09-19 13:16:12 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/61fcc5e5-5034-4007-8cfd-0721afbec2a7 "HTTP/1.1 200 OK"
2024-09-19 13:16:20 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811d-b434-c5a20f2f436b "HTTP/1.1 200 OK"
2024-09-19 13:16:25 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-a36b-e00982368132 "HTTP/1.1 200 OK"
2024-09-19 13:16:44 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-bf06-eb2e46302f9f "HTTP/1.1 200 OK"
2024-09-19 13:16:53 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:16:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8199-af02-d41bf2d913f4 "HTTP/1.1 200 OK"
2024-09-19 13:16:58 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:05:34.907144
2024-09-19 13:16:58 - INFO - Starting trading cycle.
2024-09-19 13:16:58 - INFO - ##################################################
2024-09-19 13:16:58 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-19 13:16:58 - INFO - ##################################################
2024-09-19 13:16:58 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:16:58 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:16:58 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:00:00
2024-09-19 13:16:58 - INFO - 새로운 데이터 범위: 2024-09-18 04:00:00 ~ 2024-09-19 13:10:00
2024-09-19 13:16:58 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:16:58 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:16:58 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:16:58 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:16:58 - INFO - Sample date values: [Timestamp('2024-09-19 13:10:00')]
2024-09-19 13:16:58 - INFO - Successfully added 1 new data points
2024-09-19 13:16:58 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:16:58 - INFO - Final date range: 2024-09-19 13:10:00 to 2024-09-19 13:10:00
2024-09-19 13:16:58 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:16:58 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:10:00
2024-09-19 13:16:58 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:16:58 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:16:58 - INFO - GPT | 이전예측가격: 83068000 | 당시BTC가격: 83068000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:16:58 - INFO - ML 모델 예측 업데이트: 정확도 59.32%, 적중/전체: 35/59
2024-09-19 13:16:58 - INFO - ML | 이전예측가격: 82968318 | 당시BTC가격: 83068000 | 예측: 하락 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2249 | 반영가중치값: 0.0200 | 새 가중치: 0.2449 | 예측 총 횟수: 59 | 예측 성공 수: 35 | 예측 성공률: 59.32%
2024-09-19 13:16:58 - INFO - XGBOOST | 이전예측가격: 83068000 | 당시BTC가격: 83068000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:16:58 - INFO - LSTM 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 11/19
2024-09-19 13:16:58 - INFO - LSTM | 이전예측가격: 83200236 | 당시BTC가격: 83068000 | 예측: 상승 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1434 | 반영가중치값: -0.0200 | 새 가중치: 0.1234 | 예측 총 횟수: 19 | 예측 성공 수: 11 | 예측 성공률: 57.89%
2024-09-19 13:16:58 - INFO - RL 모델 예측 업데이트: 정확도 55.70%, 적중/전체: 44/79
2024-09-19 13:16:58 - INFO - RL | 이전예측가격: 83898680 | 당시BTC가격: 83068000 | 예측: 상승 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1436 | 반영가중치값: -0.0200 | 새 가중치: 0.1236 | 예측 총 횟수: 79 | 예측 성공 수: 44 | 예측 성공률: 55.70%
2024-09-19 13:16:58 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 95/171
2024-09-19 13:16:58 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83068000 | 예측: 하락 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1092 | 반영가중치값: 0.0200 | 새 가중치: 0.1292 | 예측 총 횟수: 171 | 예측 성공 수: 95 | 예측 성공률: 55.56%
2024-09-19 13:16:58 - INFO - PROPHET 모델 예측 업데이트: 정확도 55.26%, 적중/전체: 21/38
2024-09-19 13:16:58 - INFO - PROPHET | 이전예측가격: 83082453 | 당시BTC가격: 83068000 | 예측: 상승 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0915 | 반영가중치값: -0.0200 | 새 가중치: 0.0715 | 예측 총 횟수: 38 | 예측 성공 수: 21 | 예측 성공률: 55.26%
2024-09-19 13:16:58 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 11/18
2024-09-19 13:16:58 - INFO - TRANSFORMER | 이전예측가격: 83209272 | 당시BTC가격: 83068000 | 예측: 상승 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1713 | 반영가중치값: -0.0200 | 새 가중치: 0.1513 | 예측 총 횟수: 18 | 예측 성공 수: 11 | 예측 성공률: 61.11%
2024-09-19 13:16:58 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 10/19
2024-09-19 13:16:58 - INFO - BITCOIN_FORECAST | 이전예측가격: 82319009 | 당시BTC가격: 83068000 | 예측: 하락 | 지금 BTC가격: 83060000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0785 | 반영가중치값: 0.0200 | 새 가중치: 0.0985 | 예측 총 횟수: 19 | 예측 성공 수: 10 | 예측 성공률: 52.63%
2024-09-19 13:16:59 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:16:59 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:16:59 - INFO - 새로운 가중치: {'gpt': 0.0034681678015060498, 'ml': 0.24942847004422533, 'xgboost': 0.03669575432472396, 'rl': 0.12586632522583313, 'lstm': 0.12565549058956912, 'arima': 0.13163863530594364, 'prophet': 0.07286555813335038, 'transformer': 0.15407732878487038, 'bitcoin_forecast': 0.10030426978997803}
2024-09-19 13:16:59 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 13:16:59 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:16:59 - INFO - Current BTC price: 83060000.0
2024-09-19 13:16:59 - INFO - Analyzing market conditions.
2024-09-19 13:16:59 - INFO - Market analysis: {'current_price': 83060000.0, 'sma_20': 83056850.0, 'rsi_14': 56.92193215875417, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:16:59 - INFO - Starting predictions for all models
2024-09-19 13:16:59 - INFO - Attempting prediction for gpt
2024-09-19 13:16:59 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:16:59 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:16:59 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:16:59 - INFO - GPT prediction: 83060000.0
2024-09-19 13:16:59 - INFO - Attempting prediction for ml
2024-09-19 13:16:59 - INFO - ML prediction: 83076612.0
2024-09-19 13:16:59 - INFO - Attempting prediction for xgboost
2024-09-19 13:16:59 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:16:59 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:16:59 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:16:59 - INFO - XGBOOST prediction: 83060000.0
2024-09-19 13:16:59 - INFO - Attempting prediction for lstm
2024-09-19 13:16:59 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:16:59 - INFO - X 샘플:
[[ 0.34960528  1.47302594  1.08394747  1.83912935  1.63571004  1.63923603
   1.83912935]
 [ 1.95995898  1.38693442  2.2872194   1.4223295   0.54075427  0.54706482
   1.4223295 ]
 [ 1.33417386  1.24057883  0.70291135  0.65819643  0.68737057  0.68851153
   0.65819643]
 [ 0.34960528 -0.19714959 -0.08924267 -0.48800316 -0.57565746 -0.57507268
  -0.48800316]
 [-0.76012032  0.13860735 -0.25970619  0.63214644  1.36566011  1.36044776
   0.63214644]
 [ 0.34126148 -0.29185026 -0.92150576 -0.82665304 -0.50156529 -0.50449947
  -0.82665304]
 [-0.49311867 -0.29185026 -0.31986979 -0.48800316 -0.60654217 -0.60654656
  -0.48800316]
 [-1.01043436 -1.29912107 -0.92150576 -1.14793626 -1.39505145 -1.39359705
  -1.14793626]
 [-0.91030875 -0.83422685 -0.74101497 -0.76586973  0.17814919  0.17252038
  -0.76586973]
 [-1.16062279 -1.32494852 -0.82123309 -0.83533637 -1.32882781 -1.32806477
  -0.83533637]]
2024-09-19 13:16:59 - INFO - y 샘플:
[-0.83533637]
2024-09-19 13:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:16:59 - INFO - 모델 출력 (스케일링된 예측): [[0.28411475]]
2024-09-19 13:16:59 - INFO - 스케일러 역변환 후 예측 가격: 83188919.56032504
2024-09-19 13:16:59 - INFO - LSTMPredictor 최종 예측 가격: 83188919.56032504
2024-09-19 13:16:59 - INFO - LSTM prediction: 83188919.56032504
2024-09-19 13:16:59 - INFO - Attempting prediction for rl
2024-09-19 13:16:59 - INFO - Preparing state for RL agent.
2024-09-19 13:16:59 - INFO - Prepared state: [[ 8.30600000e+07  1.21894465e+01 -9.63066403e-05  8.30568500e+07
   5.69219322e+01]]
2024-09-19 13:16:59 - INFO - RL prediction: 83890600.0
2024-09-19 13:16:59 - INFO - Attempting prediction for arima
2024-09-19 13:16:59 - INFO - ARIMA 예측 시작
2024-09-19 13:16:59 - INFO - 입력 데이터: {'open': 83020000.0, 'high': 83080000.0, 'low': 83010000.0, 'close': 83060000.0, 'volume': 12.1894465, 'value': 1012047802.79116, 'decision': 'sell', 'sma': 83056850.0, 'ema': 82973045.66064604, 'rsi': 56.92193215875417, 'macd': 223448.24426059425, 'signal_line': 301860.9981248237, 'BB_Upper': 83425430.12697136, 'BB_Lower': 82688269.87302864}
2024-09-19 13:16:59 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:16:59 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83056850.0         0         0
2024-09-19 13:16:59 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83056850.0         0         0
2024-09-19 13:16:59 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:16:59 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:16:59 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:16:59 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:16:59 - INFO - Attempting prediction for prophet
2024-09-19 13:16:59 - INFO - PROPHET prediction: 83068886.55553918
2024-09-19 13:16:59 - INFO - Attempting prediction for transformer
2024-09-19 13:16:59 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:16:59 - INFO - X 샘플:
[[ 0.34960528  1.47302594  1.08394747  1.83912935  1.63571004  1.63923603
   1.83912935  1.83912935  0.          0.          0.          1.83912935
   1.83912935]
 [ 1.95995898  1.38693442  2.2872194   1.4223295   0.54075427  0.54706482
   1.4223295   1.4223295   0.          0.          0.          1.4223295
   1.4223295 ]
 [ 1.33417386  1.24057883  0.70291135  0.65819643  0.68737057  0.68851153
   0.65819643  0.65819643  0.          0.          0.          0.65819643
   0.65819643]
 [ 0.34960528 -0.19714959 -0.08924267 -0.48800316 -0.57565746 -0.57507268
  -0.48800316 -0.48800316  0.          0.          0.         -0.48800316
  -0.48800316]
 [-0.76012032  0.13860735 -0.25970619  0.63214644  1.36566011  1.36044776
   0.63214644  0.63214644  0.          0.          0.          0.63214644
   0.63214644]
 [ 0.34126148 -0.29185026 -0.92150576 -0.82665304 -0.50156529 -0.50449947
  -0.82665304 -0.82665304  0.          0.          0.         -0.82665304
  -0.82665304]
 [-0.49311867 -0.29185026 -0.31986979 -0.48800316 -0.60654217 -0.60654656
  -0.48800316 -0.48800316  0.          0.          0.         -0.48800316
  -0.48800316]
 [-1.01043436 -1.29912107 -0.92150576 -1.14793626 -1.39505145 -1.39359705
  -1.14793626 -1.14793626  0.          0.          0.         -1.14793626
  -1.14793626]
 [-0.91030875 -0.83422685 -0.74101497 -0.76586973  0.17814919  0.17252038
  -0.76586973 -0.76586973  0.          0.          0.         -0.76586973
  -0.76586973]
 [-1.16062279 -1.32494852 -0.82123309 -0.83533637 -1.32882781 -1.32806477
  -0.83533637 -0.83533637  0.          0.          0.         -0.83533637
  -0.83533637]]
2024-09-19 13:16:59 - INFO - y 샘플:
[-0.83533637]
2024-09-19 13:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:16:59 - INFO - 모델 출력 (스케일링된 예측): [0.36607933]
2024-09-19 13:16:59 - INFO - 스케일러 역변환 후 예측 가격: 83198358.86296098
2024-09-19 13:16:59 - INFO - TransformerPredictor 최종 예측 가격: 83198358.86296098
2024-09-19 13:16:59 - INFO - TRANSFORMER prediction: 83198358.86296098
2024-09-19 13:16:59 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:16:59 - INFO - BITCOIN_FORECAST prediction: 82263082.82478443
2024-09-19 13:16:59 - INFO - BitcoinForecast prediction: 82263082.82478443
2024-09-19 13:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:17:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:17:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0034681678015060498, 'ml': 0.24942847004422533, 'xgboost': 0.03669575432472396, 'rl': 0.12586632522583313, 'lstm': 0.12565549058956912, 'arima': 0.13163863530594364, 'prophet': 0.07286555813335038, 'transformer': 0.15407732878487038, 'bitcoin_forecast': 0.10030426978997803}
2024-09-19 13:17:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0034681678015060498, 'ml': 0.24942847004422533, 'xgboost': 0.03669575432472396, 'rl': 0.12586632522583313, 'lstm': 0.12565549058956912, 'arima': 0.13163863530594364, 'prophet': 0.07286555813335038, 'transformer': 0.15407732878487038, 'bitcoin_forecast': 0.10030426978997803}
2024-09-19 13:17:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82842447.72768493, 'current_price': 83060000.0, 'predictions': {'gpt': 83060000.0, 'ml': 83076612.0, 'xgboost': 83060000.0, 'lstm': 83188919.56032504, 'rl': 83890600.0, 'arima': 80899000.0, 'prophet': 83068886.55553918, 'transformer': 83198358.86296098, 'bitcoin_forecast': 82263082.82478443}, 'weights': {'gpt': 0.0034681678015060498, 'ml': 0.24942847004422533, 'xgboost': 0.03669575432472396, 'rl': 0.12586632522583313, 'lstm': 0.12565549058956912, 'arima': 0.13163863530594364, 'prophet': 0.07286555813335038, 'transformer': 0.15407732878487038, 'bitcoin_forecast': 0.10030426978997803}}
2024-09-19 13:17:07 - INFO - 모델별 가중치:
2024-09-19 13:17:07 - INFO -   - GPT: 0.0035
2024-09-19 13:17:07 - INFO -   - ML: 0.2494
2024-09-19 13:17:07 - INFO -   - XGBOOST: 0.0367
2024-09-19 13:17:07 - INFO -   - RL: 0.1259
2024-09-19 13:17:07 - INFO -   - LSTM: 0.1257
2024-09-19 13:17:07 - INFO -   - ARIMA: 0.1316
2024-09-19 13:17:07 - INFO -   - PROPHET: 0.0729
2024-09-19 13:17:07 - INFO -   - TRANSFORMER: 0.1541
2024-09-19 13:17:07 - INFO -   - BITCOIN_FORECAST: 0.1003
2024-09-19 13:17:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:17:07 - INFO - 6. 거래 실행
2024-09-19 13:17:07 - INFO - Cancelling existing orders.
2024-09-19 13:17:07 - INFO - Cancelled 0 orders.
2024-09-19 13:17:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82842447.72768493, 'current_price': 83060000.0, 'predictions': {'gpt': 83060000.0, 'ml': 83076612.0, 'xgboost': 83060000.0, 'lstm': 83188919.56032504, 'rl': 83890600.0, 'arima': 80899000.0, 'prophet': 83068886.55553918, 'transformer': 83198358.86296098, 'bitcoin_forecast': 82263082.82478443}, 'weights': {'gpt': 0.0034681678015060498, 'ml': 0.24942847004422533, 'xgboost': 0.03669575432472396, 'rl': 0.12586632522583313, 'lstm': 0.12565549058956912, 'arima': 0.13163863530594364, 'prophet': 0.07286555813335038, 'transformer': 0.15407732878487038, 'bitcoin_forecast': 0.10030426978997803}}, 현재 가격=83060000.0
2024-09-19 13:17:07 - INFO - 현재 잔고: KRW=256556.62891482, BTC=0.00265534, 총 자산가치=477109.16931481997
2024-09-19 13:17:07 - INFO - 매도 시도: 0.000265534 BTC (약 22055.25404 KRW)
2024-09-19 13:17:07 - INFO - 주문 결과: {'uuid': '48888e4c-b950-4a0c-a51e-b0dc866e10ef', 'side': 'ask', 'ord_type': 'limit', 'price': '83060000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:17:09+09:00', 'volume': '0.00026553', 'remaining_volume': '0.00026553', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00026553', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:17:07 - INFO - sell 주문 성공: UUID=48888e4c-b950-4a0c-a51e-b0dc866e10ef
2024-09-19 13:17:07 - INFO - Trade executed successfully.
2024-09-19 13:17:07 - INFO - 7. summary 리포트 보내기
2024-09-19 13:17:08 - INFO - Message sent to Discord successfully.
2024-09-19 13:17:08 - INFO - Trading cycle completed.
2024-09-19 13:17:08 - INFO - Performing periodic update.
2024-09-19 13:17:08 - INFO - 계산된 시장 변동성: 0.03854195083719148
2024-09-19 13:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:25:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-b01e-d4e5cc003e6e "HTTP/1.1 200 OK"
2024-09-19 13:25:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:25:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-a423-d596ca99c82d "HTTP/1.1 200 OK"
2024-09-19 13:25:48 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:25:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-a158-ef6a79533f97 "HTTP/1.1 200 OK"
2024-09-19 13:25:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8191-a37c-c631d3b07bee "HTTP/1.1 200 OK"
2024-09-19 13:26:02 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8126-8ce3-ca2f24f54fc5 "HTTP/1.1 200 OK"
2024-09-19 13:26:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816c-816e-ee67d2eae3c3 "HTTP/1.1 200 OK"
2024-09-19 13:26:18 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b0-b7b4-f1d49ec063b6 "HTTP/1.1 200 OK"
2024-09-19 13:26:26 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8100-b2b0-c7fc1783abf6 "HTTP/1.1 200 OK"
2024-09-19 13:26:32 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:26:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-9495-cb2371090cd4 "HTTP/1.1 200 OK"
2024-09-19 13:26:36 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:15:34.907722
2024-09-19 13:26:36 - INFO - Starting trading cycle.
2024-09-19 13:26:36 - INFO - ##################################################
2024-09-19 13:26:36 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-19 13:26:36 - INFO - ##################################################
2024-09-19 13:26:36 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:26:36 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:26:36 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:10:00
2024-09-19 13:26:36 - INFO - 새로운 데이터 범위: 2024-09-18 04:10:00 ~ 2024-09-19 13:20:00
2024-09-19 13:26:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:26:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:26:36 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:26:36 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:26:36 - INFO - Sample date values: [Timestamp('2024-09-19 13:20:00')]
2024-09-19 13:26:37 - INFO - Successfully added 1 new data points
2024-09-19 13:26:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:26:37 - INFO - Final date range: 2024-09-19 13:20:00 to 2024-09-19 13:20:00
2024-09-19 13:26:37 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:26:37 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:20:00
2024-09-19 13:26:37 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:26:37 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:26:37 - INFO - GPT | 이전예측가격: 83060000 | 당시BTC가격: 83060000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:26:37 - INFO - ML 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 35/60
2024-09-19 13:26:37 - INFO - ML | 이전예측가격: 83076612 | 당시BTC가격: 83060000 | 예측: 상승 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2453 | 반영가중치값: -0.0200 | 새 가중치: 0.2253 | 예측 총 횟수: 60 | 예측 성공 수: 35 | 예측 성공률: 58.33%
2024-09-19 13:26:37 - INFO - XGBOOST | 이전예측가격: 83060000 | 당시BTC가격: 83060000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:26:37 - INFO - LSTM 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 11/20
2024-09-19 13:26:37 - INFO - LSTM | 이전예측가격: 83188920 | 당시BTC가격: 83060000 | 예측: 상승 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1241 | 반영가중치값: -0.0200 | 새 가중치: 0.1041 | 예측 총 횟수: 20 | 예측 성공 수: 11 | 예측 성공률: 55.00%
2024-09-19 13:26:37 - INFO - RL 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 44/80
2024-09-19 13:26:37 - INFO - RL | 이전예측가격: 83890600 | 당시BTC가격: 83060000 | 예측: 상승 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2036 | 반영가중치값: -0.0200 | 새 가중치: 0.1836 | 예측 총 횟수: 80 | 예측 성공 수: 44 | 예측 성공률: 55.00%
2024-09-19 13:26:37 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.81%, 적중/전체: 96/172
2024-09-19 13:26:37 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83060000 | 예측: 하락 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0385 | 반영가중치값: 0.0200 | 새 가중치: 0.0585 | 예측 총 횟수: 172 | 예측 성공 수: 96 | 예측 성공률: 55.81%
2024-09-19 13:26:37 - INFO - PROPHET 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 21/39
2024-09-19 13:26:37 - INFO - PROPHET | 이전예측가격: 83068887 | 당시BTC가격: 83060000 | 예측: 상승 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0959 | 반영가중치값: -0.0200 | 새 가중치: 0.0759 | 예측 총 횟수: 39 | 예측 성공 수: 21 | 예측 성공률: 53.85%
2024-09-19 13:26:37 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 11/19
2024-09-19 13:26:37 - INFO - TRANSFORMER | 이전예측가격: 83198359 | 당시BTC가격: 83060000 | 예측: 상승 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2135 | 반영가중치값: -0.0200 | 새 가중치: 0.1935 | 예측 총 횟수: 19 | 예측 성공 수: 11 | 예측 성공률: 57.89%
2024-09-19 13:26:37 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 11/20
2024-09-19 13:26:37 - INFO - BITCOIN_FORECAST | 이전예측가격: 82263083 | 당시BTC가격: 83060000 | 예측: 하락 | 지금 BTC가격: 82834000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0396 | 반영가중치값: 0.0200 | 새 가중치: 0.0596 | 예측 총 횟수: 20 | 예측 성공 수: 11 | 예측 성공률: 55.00%
2024-09-19 13:26:37 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:26:37 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:26:37 - INFO - 새로운 가중치: {'gpt': 0.003686674681133113, 'ml': 0.23945900979424578, 'xgboost': 0.03900771707623062, 'rl': 0.19521433185233406, 'lstm': 0.11064724644908837, 'arima': 0.062170660437249156, 'prophet': 0.08072526321187928, 'transformer': 0.20572757654350574, 'bitcoin_forecast': 0.06336151995433384}
2024-09-19 13:26:37 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 13:26:37 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:26:37 - INFO - Current BTC price: 82834000.0
2024-09-19 13:26:37 - INFO - Analyzing market conditions.
2024-09-19 13:26:37 - INFO - Market analysis: {'current_price': 82834000.0, 'sma_20': 83039000.0, 'rsi_14': 49.95274320035989, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:26:37 - INFO - Starting predictions for all models
2024-09-19 13:26:37 - INFO - Attempting prediction for gpt
2024-09-19 13:26:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:26:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:26:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:26:38 - INFO - GPT prediction: 82834000.0
2024-09-19 13:26:38 - INFO - Attempting prediction for ml
2024-09-19 13:26:38 - INFO - ML prediction: 82651765.2
2024-09-19 13:26:38 - INFO - Attempting prediction for xgboost
2024-09-19 13:26:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:26:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:26:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:26:38 - INFO - XGBOOST prediction: 82834000.0
2024-09-19 13:26:38 - INFO - Attempting prediction for lstm
2024-09-19 13:26:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:26:38 - INFO - X 샘플:
[[ 2.01665673  1.72105584  2.23006122  1.7009099   0.51432284  0.5262327
   1.7009099 ]
 [ 1.41764978  1.57373484  0.89893287  1.01177513  0.65752829  0.665105
   1.01177513]
 [ 0.47521218  0.12652274  0.2333687  -0.02192702 -0.5761169  -0.57548133
  -0.02192702]
 [-0.58702681  0.46449442  0.09014603  0.9882819   1.32003823  1.32481165
   0.9882819 ]
 [ 0.46722542  0.03119739 -0.46589492 -0.32733901 -0.50374839 -0.50619258
  -0.32733901]
 [-0.33145051  0.03119739  0.03959686 -0.02192702 -0.60628311 -0.60638237
  -0.02192702]
 [-0.82662959 -0.98271768 -0.46589492 -0.61708886 -1.37644866 -1.37910813
  -0.61708886]
 [-0.73078848 -0.51475688 -0.31424739 -0.27252148  0.16015334  0.15850516
  -0.27252148]
 [-0.97039126 -1.0087155  -0.38164629 -0.33517009 -1.31176564 -1.31476857
  -0.33517009]
 [-0.93045746 -1.44201254 -1.86442217 -2.10499346  1.72232     1.70727847
  -2.10499346]]
2024-09-19 13:26:38 - INFO - y 샘플:
[-2.10499346]
2024-09-19 13:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:26:38 - INFO - 모델 출력 (스케일링된 예측): [[0.28371465]]
2024-09-19 13:26:38 - INFO - 스케일러 역변환 후 예측 가격: 83139029.32795005
2024-09-19 13:26:38 - INFO - LSTMPredictor 최종 예측 가격: 83139029.32795005
2024-09-19 13:26:38 - INFO - LSTM prediction: 83139029.32795005
2024-09-19 13:26:38 - INFO - Attempting prediction for rl
2024-09-19 13:26:38 - INFO - Preparing state for RL agent.
2024-09-19 13:26:38 - INFO - Prepared state: [[ 8.28340000e+07  2.54617716e+01 -2.72092463e-03  8.30390000e+07
   4.99527432e+01]]
2024-09-19 13:26:38 - INFO - RL prediction: 83662340.0
2024-09-19 13:26:38 - INFO - Attempting prediction for arima
2024-09-19 13:26:38 - INFO - ARIMA 예측 시작
2024-09-19 13:26:38 - INFO - 입력 데이터: {'open': 83025000.0, 'high': 83030000.0, 'low': 82834000.0, 'close': 82834000.0, 'volume': 25.4617716, 'value': 2111066427.59505, 'decision': 'sell', 'sma': 83039000.0, 'ema': 82959803.216775, 'rsi': 49.95274320035989, 'macd': 187293.55491104722, 'signal_line': 278947.50948206836, 'BB_Upper': 83414379.80765703, 'BB_Lower': 82663620.19234297}
2024-09-19 13:26:38 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:26:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83039000.0         0         0
2024-09-19 13:26:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83039000.0         0         0
2024-09-19 13:26:38 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:26:38 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:26:38 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:26:38 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:26:38 - INFO - Attempting prediction for prophet
2024-09-19 13:26:38 - INFO - PROPHET prediction: 82815427.33825976
2024-09-19 13:26:38 - INFO - Attempting prediction for transformer
2024-09-19 13:26:38 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:26:38 - INFO - X 샘플:
[[ 2.01665673  1.72105584  2.23006122  1.7009099   0.51432284  0.5262327
   1.7009099   1.7009099   0.          0.          0.          1.7009099
   1.7009099 ]
 [ 1.41764978  1.57373484  0.89893287  1.01177513  0.65752829  0.665105
   1.01177513  1.01177513  0.          0.          0.          1.01177513
   1.01177513]
 [ 0.47521218  0.12652274  0.2333687  -0.02192702 -0.5761169  -0.57548133
  -0.02192702 -0.02192702  0.          0.          0.         -0.02192702
  -0.02192702]
 [-0.58702681  0.46449442  0.09014603  0.9882819   1.32003823  1.32481165
   0.9882819   0.9882819   0.          0.          0.          0.9882819
   0.9882819 ]
 [ 0.46722542  0.03119739 -0.46589492 -0.32733901 -0.50374839 -0.50619258
  -0.32733901 -0.32733901  0.          0.          0.         -0.32733901
  -0.32733901]
 [-0.33145051  0.03119739  0.03959686 -0.02192702 -0.60628311 -0.60638237
  -0.02192702 -0.02192702  0.          0.          0.         -0.02192702
  -0.02192702]
 [-0.82662959 -0.98271768 -0.46589492 -0.61708886 -1.37644866 -1.37910813
  -0.61708886 -0.61708886  0.          0.          0.         -0.61708886
  -0.61708886]
 [-0.73078848 -0.51475688 -0.31424739 -0.27252148  0.16015334  0.15850516
  -0.27252148 -0.27252148  0.          0.          0.         -0.27252148
  -0.27252148]
 [-0.97039126 -1.0087155  -0.38164629 -0.33517009 -1.31176564 -1.31476857
  -0.33517009 -0.33517009  0.          0.          0.         -0.33517009
  -0.33517009]
 [-0.93045746 -1.44201254 -1.86442217 -2.10499346  1.72232     1.70727847
  -2.10499346 -2.10499346  0.          0.          0.         -2.10499346
  -2.10499346]]
2024-09-19 13:26:38 - INFO - y 샘플:
[-2.10499346]
2024-09-19 13:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:26:38 - INFO - 모델 출력 (스케일링된 예측): [0.35727382]
2024-09-19 13:26:38 - INFO - 스케일러 역변환 후 예측 가격: 83148422.56546241
2024-09-19 13:26:38 - INFO - TransformerPredictor 최종 예측 가격: 83148422.56546241
2024-09-19 13:26:38 - INFO - TRANSFORMER prediction: 83148422.56546241
2024-09-19 13:26:38 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:26:38 - INFO - BITCOIN_FORECAST prediction: 82345066.21065284
2024-09-19 13:26:38 - INFO - BitcoinForecast prediction: 82345066.21065284
2024-09-19 13:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:26:42 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:26:42 - INFO - 조정된 모델 가중치: {'gpt': 0.003686674681133113, 'ml': 0.23945900979424578, 'xgboost': 0.03900771707623062, 'rl': 0.19521433185233406, 'lstm': 0.11064724644908837, 'arima': 0.062170660437249156, 'prophet': 0.08072526321187928, 'transformer': 0.20572757654350574, 'bitcoin_forecast': 0.06336151995433384}
2024-09-19 13:26:42 - INFO - 조정된 모델 가중치: {'gpt': 0.003686674681133113, 'ml': 0.23945900979424578, 'xgboost': 0.03900771707623062, 'rl': 0.19521433185233406, 'lstm': 0.11064724644908837, 'arima': 0.062170660437249156, 'prophet': 0.08072526321187928, 'transformer': 0.20572757654350574, 'bitcoin_forecast': 0.06336151995433384}
2024-09-19 13:26:42 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 82897723.0235119, 'current_price': 82834000.0, 'predictions': {'gpt': 82834000.0, 'ml': 82651765.2, 'xgboost': 82834000.0, 'lstm': 83139029.32795005, 'rl': 83662340.0, 'arima': 80899000.0, 'prophet': 82815427.33825976, 'transformer': 83148422.56546241, 'bitcoin_forecast': 82345066.21065284}, 'weights': {'gpt': 0.003686674681133113, 'ml': 0.23945900979424578, 'xgboost': 0.03900771707623062, 'rl': 0.19521433185233406, 'lstm': 0.11064724644908837, 'arima': 0.062170660437249156, 'prophet': 0.08072526321187928, 'transformer': 0.20572757654350574, 'bitcoin_forecast': 0.06336151995433384}}
2024-09-19 13:26:42 - INFO - 모델별 가중치:
2024-09-19 13:26:42 - INFO -   - GPT: 0.0037
2024-09-19 13:26:42 - INFO -   - ML: 0.2395
2024-09-19 13:26:42 - INFO -   - XGBOOST: 0.0390
2024-09-19 13:26:42 - INFO -   - RL: 0.1952
2024-09-19 13:26:42 - INFO -   - LSTM: 0.1106
2024-09-19 13:26:42 - INFO -   - ARIMA: 0.0622
2024-09-19 13:26:42 - INFO -   - PROPHET: 0.0807
2024-09-19 13:26:42 - INFO -   - TRANSFORMER: 0.2057
2024-09-19 13:26:42 - INFO -   - BITCOIN_FORECAST: 0.0634
2024-09-19 13:26:42 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:26:42 - INFO - 6. 거래 실행
2024-09-19 13:26:42 - INFO - Cancelling existing orders.
2024-09-19 13:26:42 - INFO - Cancelled 0 orders.
2024-09-19 13:26:42 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 82897723.0235119, 'current_price': 82834000.0, 'predictions': {'gpt': 82834000.0, 'ml': 82651765.2, 'xgboost': 82834000.0, 'lstm': 83139029.32795005, 'rl': 83662340.0, 'arima': 80899000.0, 'prophet': 82815427.33825976, 'transformer': 83148422.56546241, 'bitcoin_forecast': 82345066.21065284}, 'weights': {'gpt': 0.003686674681133113, 'ml': 0.23945900979424578, 'xgboost': 0.03900771707623062, 'rl': 0.19521433185233406, 'lstm': 0.11064724644908837, 'arima': 0.062170660437249156, 'prophet': 0.08072526321187928, 'transformer': 0.20572757654350574, 'bitcoin_forecast': 0.06336151995433384}}, 현재 가격=82834000.0
2024-09-19 13:26:43 - INFO - 현재 잔고: KRW=278602.38103457, BTC=0.00238981, 총 자산가치=476559.90257457003
2024-09-19 13:26:43 - INFO - 매수 시도: 0.0005753191957101795 BTC (약 47655.990257457015 KRW)
2024-09-19 13:26:43 - INFO - 주문 결과: {'uuid': '020aa7d6-ac4c-4cfb-9672-403268fa3106', 'side': 'bid', 'ord_type': 'limit', 'price': '82834000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:26:44+09:00', 'volume': '0.00057531', 'remaining_volume': '0.00057531', 'reserved_fee': '23.82761427', 'remaining_fee': '23.82761427', 'paid_fee': '0', 'locked': '47679.05615427', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:26:43 - INFO - buy 주문 성공: UUID=020aa7d6-ac4c-4cfb-9672-403268fa3106
2024-09-19 13:26:43 - INFO - Trade executed successfully.
2024-09-19 13:26:43 - INFO - 7. summary 리포트 보내기
2024-09-19 13:26:43 - INFO - Message sent to Discord successfully.
2024-09-19 13:26:43 - INFO - Trading cycle completed.
2024-09-19 13:26:43 - INFO - Performing periodic update.
2024-09-19 13:26:43 - INFO - 계산된 시장 변동성: 0.038833490406385306
2024-09-19 13:35:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:35:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c6-ae45-e5fbc10a3b23 "HTTP/1.1 200 OK"
2024-09-19 13:35:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:35:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:35:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/6fdab5f3-4914-40c1-9a29-1f9041dd372c "HTTP/1.1 200 OK"
2024-09-19 13:35:51 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-89d5-d779efc09cfb "HTTP/1.1 200 OK"
2024-09-19 13:36:06 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819f-b7ad-c2d3a445a290 "HTTP/1.1 200 OK"
2024-09-19 13:36:13 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-83b0-cfb0e577bde2 "HTTP/1.1 200 OK"
2024-09-19 13:36:18 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8187-a2f1-df22de510d84 "HTTP/1.1 200 OK"
2024-09-19 13:36:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8142-93dd-c5354f4d3eec "HTTP/1.1 200 OK"
2024-09-19 13:36:30 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817d-939f-e9fe171b2fce "HTTP/1.1 200 OK"
2024-09-19 13:36:39 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:36:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8111-b7ac-dc1973d0600d "HTTP/1.1 200 OK"
2024-09-19 13:36:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:25:34.908139
2024-09-19 13:36:47 - INFO - Starting trading cycle.
2024-09-19 13:36:47 - INFO - ##################################################
2024-09-19 13:36:47 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-19 13:36:47 - INFO - ##################################################
2024-09-19 13:36:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:36:47 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:36:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:20:00
2024-09-19 13:36:47 - INFO - 새로운 데이터 범위: 2024-09-18 04:20:00 ~ 2024-09-19 13:30:00
2024-09-19 13:36:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:36:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:36:47 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:36:47 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:36:47 - INFO - Sample date values: [Timestamp('2024-09-19 13:30:00')]
2024-09-19 13:36:47 - INFO - Successfully added 1 new data points
2024-09-19 13:36:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:36:47 - INFO - Final date range: 2024-09-19 13:30:00 to 2024-09-19 13:30:00
2024-09-19 13:36:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:36:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:30:00
2024-09-19 13:36:47 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:36:47 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-19 13:36:47 - INFO - 재학습 대상 모델: ['prophet', 'rl', 'lstm']
2024-09-19 13:36:47 - INFO - prophet 모델 재학습 시작
2024-09-19 13:36:47 - INFO - Prophet 모델 훈련 시작
2024-09-19 13:36:47 - DEBUG - cmd: where.exe tbb.dll
cwd: None
2024-09-19 13:36:47 - DEBUG - TBB already found in load path
2024-09-19 13:36:47 - DEBUG - input tempfile: C:\Users\injoo\AppData\Local\Temp\tmpjz6__58s\chzdwzch.json
2024-09-19 13:36:47 - DEBUG - input tempfile: C:\Users\injoo\AppData\Local\Temp\tmpjz6__58s\ln055xnm.json
2024-09-19 13:36:47 - DEBUG - idx 0
2024-09-19 13:36:47 - DEBUG - running CmdStan, num_threads: None
2024-09-19 13:36:47 - DEBUG - CmdStan args: ['C:\\Dev\\GPT_BTC\\pythonProject\\.venv\\Lib\\site-packages\\prophet\\stan_model\\prophet_model.bin', 'random', 'seed=8290', 'data', 'file=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\chzdwzch.json', 'init=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\ln055xnm.json', 'output', 'file=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\prophet_models38lf1cd\\prophet_model-20240919133647.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2024-09-19 13:36:47 - INFO - Chain [1] start processing
2024-09-19 13:36:47 - INFO - Chain [1] done processing
2024-09-19 13:36:47 - INFO - Prophet 모델 훈련 완료
2024-09-19 13:36:47 - INFO - prophet 모델의 예측 통계가 초기화되었습니다.
2024-09-19 13:36:47 - INFO - prophet 모델 재학습 완료
2024-09-19 13:36:47 - INFO - rl 모델 재학습 시작
2024-09-19 13:36:47 - INFO - RL 에이전트 탐험 비율 조정: epsilon=0.1
2024-09-19 13:40:44 - INFO - rl 모델의 예측 통계가 초기화되었습니다.
2024-09-19 13:40:44 - INFO - rl 모델 재학습 완료
2024-09-19 13:40:44 - INFO - lstm 모델 재학습 시작
2024-09-19 13:40:44 - INFO - LSTM 하이퍼파라미터 랜덤 조정: hidden_dim=111, num_layers=2, learning_rate=0.001111952374693178
2024-09-19 13:40:44 - INFO - LSTM 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 13:40:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 13:40:44 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-19 13:40:44 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:40:44 - INFO - NaN 값 개수:
date           0
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:40:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:40:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:40:44 - INFO - X 샘플:
[[ 0.40255267  0.40163168  0.39755093  0.3972713   0.14291268  0.25792414
   0.38993607]
 [ 0.39550423  0.39166348  0.39282876  0.38938619  0.03048108  0.11069835
   0.39236277]
 [ 0.3875598   0.39399138  0.39181259  0.3970921   0.20329232  0.33621441
   0.3937079 ]
 [ 0.3954445   0.39100689  0.38786749  0.3870565   0.03707658  0.11892115
   0.39419566]
 [ 0.38947124  0.39100689  0.39145395  0.38938619  0.0277318   0.10703119
   0.394026  ]
 [ 0.38576782  0.38402318  0.38786749  0.38484628 -0.04245932  0.01532845
   0.3937291 ]
 [ 0.38648461  0.38724643  0.38894342  0.38747465  0.09758307  0.19780373
   0.39345341]
 [ 0.38469263  0.38384411  0.38846523  0.38699676 -0.03656426  0.02296391
   0.3921719 ]
 [ 0.3849913   0.38085961  0.37794495  0.3734965   0.23995536  0.38160341
   0.39109034]
 [ 0.37208906  0.3738759   0.37531488  0.37385491  0.06554124  0.15462321
   0.3912085 ]]
2024-09-19 13:40:44 - INFO - y 샘플:
[0.37385491]
2024-09-19 13:40:44 - INFO - Epoch [10/50], Loss: 0.0012
2024-09-19 13:40:44 - INFO - Epoch [20/50], Loss: 0.0084
2024-09-19 13:40:44 - INFO - Epoch [30/50], Loss: 0.0014
2024-09-19 13:40:44 - INFO - Epoch [40/50], Loss: 0.0005
2024-09-19 13:40:44 - INFO - Epoch [50/50], Loss: 0.0001
2024-09-19 13:40:44 - INFO - LSTM 훈련 완료. MSE: 0.00018333320622332394
2024-09-19 13:40:44 - INFO - lstm 모델의 예측 통계가 초기화되었습니다.
2024-09-19 13:40:44 - INFO - lstm 모델 재학습 완료
2024-09-19 13:40:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:40:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:40:45 - INFO - GPT | 이전예측가격: 82834000 | 당시BTC가격: 82834000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:40:45 - INFO - ML 모델 예측 업데이트: 정확도 59.02%, 적중/전체: 36/61
2024-09-19 13:40:45 - INFO - ML | 이전예측가격: 82651765 | 당시BTC가격: 82834000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2494 | 반영가중치값: 0.0200 | 새 가중치: 0.2694 | 예측 총 횟수: 61 | 예측 성공 수: 36 | 예측 성공률: 59.02%
2024-09-19 13:40:45 - INFO - XGBOOST | 이전예측가격: 82834000 | 당시BTC가격: 82834000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:40:45 - INFO - LSTM 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 13:40:45 - INFO - LSTM | 이전예측가격: 83139029 | 당시BTC가격: 82834000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1257 | 반영가중치값: -0.0200 | 새 가중치: 0.1057 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 13:40:45 - INFO - RL 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 13:40:45 - INFO - RL | 이전예측가격: 83662340 | 당시BTC가격: 82834000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1259 | 반영가중치값: -0.0200 | 새 가중치: 0.1059 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 13:40:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.07%, 적중/전체: 97/173
2024-09-19 13:40:45 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82834000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1316 | 반영가중치값: 0.0200 | 새 가중치: 0.1516 | 예측 총 횟수: 173 | 예측 성공 수: 97 | 예측 성공률: 56.07%
2024-09-19 13:40:45 - INFO - PROPHET 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-19 13:40:45 - INFO - PROPHET | 이전예측가격: 82815427 | 당시BTC가격: 82834000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0729 | 반영가중치값: 0.0200 | 새 가중치: 0.0929 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-19 13:40:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 11/20
2024-09-19 13:40:45 - INFO - TRANSFORMER | 이전예측가격: 83148423 | 당시BTC가격: 82834000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1541 | 반영가중치값: -0.0200 | 새 가중치: 0.1341 | 예측 총 횟수: 20 | 예측 성공 수: 11 | 예측 성공률: 55.00%
2024-09-19 13:40:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 12/21
2024-09-19 13:40:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 82345066 | 당시BTC가격: 82834000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1003 | 반영가중치값: 0.0200 | 새 가중치: 0.1203 | 예측 총 횟수: 21 | 예측 성공 수: 12 | 예측 성공률: 57.14%
2024-09-19 13:40:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:40:45 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:40:45 - INFO - 새로운 가중치: {'gpt': 0.0036054423712801823, 'ml': 0.2634918743706665, 'xgboost': 0.03814821976923799, 'rl': 0.10353366317193775, 'lstm': 0.10332747407290772, 'arima': 0.1482974246827535, 'prophet': 0.09081935540449038, 'transformer': 0.13112306456084116, 'bitcoin_forecast': 0.1176534815958848}
2024-09-19 13:40:45 - INFO - XGBoost 모델 성능: 정확도 62.83%, 적중/전체: 71/113
2024-09-19 13:40:45 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:40:45 - INFO - Current BTC price: 82800000.0
2024-09-19 13:40:45 - INFO - Analyzing market conditions.
2024-09-19 13:40:45 - INFO - Market analysis: {'current_price': 82840000.0, 'sma_20': 83040950.0, 'rsi_14': 50.127322515587565, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:40:45 - INFO - Starting predictions for all models
2024-09-19 13:40:45 - INFO - Attempting prediction for gpt
2024-09-19 13:40:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:40:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:40:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:40:45 - INFO - GPT prediction: 82800000.0
2024-09-19 13:40:45 - INFO - Attempting prediction for ml
2024-09-19 13:40:45 - INFO - ML prediction: 82856568.0
2024-09-19 13:40:45 - INFO - Attempting prediction for xgboost
2024-09-19 13:40:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:40:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:40:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:40:45 - INFO - XGBOOST prediction: 82840000.0
2024-09-19 13:40:45 - INFO - Attempting prediction for lstm
2024-09-19 13:40:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:40:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:40:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:40:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:40:45 - INFO - X 샘플:
[[ 1.81352911  1.87132806  1.50156005  1.39259469  0.73842783  0.74914028
   1.39259469]
 [ 0.90676456  0.51139862  0.75877205  0.35522167 -0.5127113  -0.50972356
   0.35522167]
 [-0.11526668  0.82898693  0.59893159  1.36901803  1.41033262  1.41856636
   1.36901803]
 [ 0.89908011  0.42182243 -0.02162547  0.0487251  -0.43931655 -0.43941399
   0.0487251 ]
 [ 0.13063557  0.42182243  0.54251731  0.35522167 -0.54330529 -0.54107986
   0.35522167]
 [-0.34580004 -0.53094251 -0.02162547 -0.2420537  -1.32439231 -1.32519017
  -0.2420537 ]
 [-0.2535867  -0.09120485  0.14761736  0.1037373   0.23399976  0.23507672
   0.1037373 ]
 [-0.48412006 -0.55537238  0.07239832  0.04086621 -1.25879204 -1.2599027
   0.04086621]
 [-0.44569783 -0.96253689 -1.58242051 -1.73524214  1.81831901  1.80666805
  -1.73524214]
 [-2.10553804 -1.91530183 -1.99612522 -1.68808882 -0.12256173 -0.13414113
  -1.68808882]]
2024-09-19 13:40:45 - INFO - y 샘플:
[-1.68808882]
2024-09-19 13:40:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:40:45 - INFO - 모델 출력 (스케일링된 예측): [[0.25448424]]
2024-09-19 13:40:45 - INFO - 스케일러 역변환 후 예측 가격: 83087181.71661809
2024-09-19 13:40:45 - INFO - LSTMPredictor 최종 예측 가격: 83087181.71661809
2024-09-19 13:40:45 - INFO - LSTM prediction: 83087181.71661809
2024-09-19 13:40:45 - INFO - Attempting prediction for rl
2024-09-19 13:40:45 - INFO - Preparing state for RL agent.
2024-09-19 13:40:45 - INFO - Prepared state: [[8.28400000e+07 1.70902829e+01 7.24340247e-05 8.30409500e+07
  5.01273225e+01]]
2024-09-19 13:40:45 - INFO - RL prediction: 83628000.0
2024-09-19 13:40:45 - INFO - Attempting prediction for arima
2024-09-19 13:40:45 - INFO - ARIMA 예측 시작
2024-09-19 13:40:45 - INFO - 입력 데이터: {'open': 82809000.0, 'high': 82913000.0, 'low': 82790000.0, 'close': 82840000.0, 'volume': 17.09028295, 'value': 1415505942.11647, 'decision': 'sell', 'sma': 83040950.0, 'ema': 82948393.38660595, 'rsi': 50.127322515587565, 'macd': 157311.46433906257, 'signal_line': 254620.30045346724, 'BB_Upper': 83411741.30248918, 'BB_Lower': 82670158.69751082}
2024-09-19 13:40:45 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:40:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83040950.0         0         0
2024-09-19 13:40:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83040950.0         0         0
2024-09-19 13:40:45 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:40:45 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:40:45 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:40:45 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:40:45 - INFO - Attempting prediction for prophet
2024-09-19 13:40:45 - INFO - PROPHET prediction: 82852018.91507396
2024-09-19 13:40:45 - INFO - Attempting prediction for transformer
2024-09-19 13:40:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:40:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:40:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:40:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:40:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:40:45 - INFO - X 샘플:
[[ 1.81352911  1.87132806  1.50156005  1.39259469  0.73842783  0.74914028
   1.39259469  1.39259469  0.          0.          0.          1.39259469
   1.39259469]
 [ 0.90676456  0.51139862  0.75877205  0.35522167 -0.5127113  -0.50972356
   0.35522167  0.35522167  0.          0.          0.          0.35522167
   0.35522167]
 [-0.11526668  0.82898693  0.59893159  1.36901803  1.41033262  1.41856636
   1.36901803  1.36901803  0.          0.          0.          1.36901803
   1.36901803]
 [ 0.89908011  0.42182243 -0.02162547  0.0487251  -0.43931655 -0.43941399
   0.0487251   0.0487251   0.          0.          0.          0.0487251
   0.0487251 ]
 [ 0.13063557  0.42182243  0.54251731  0.35522167 -0.54330529 -0.54107986
   0.35522167  0.35522167  0.          0.          0.          0.35522167
   0.35522167]
 [-0.34580004 -0.53094251 -0.02162547 -0.2420537  -1.32439231 -1.32519017
  -0.2420537  -0.2420537   0.          0.          0.         -0.2420537
  -0.2420537 ]
 [-0.2535867  -0.09120485  0.14761736  0.1037373   0.23399976  0.23507672
   0.1037373   0.1037373   0.          0.          0.          0.1037373
   0.1037373 ]
 [-0.48412006 -0.55537238  0.07239832  0.04086621 -1.25879204 -1.2599027
   0.04086621  0.04086621  0.          0.          0.          0.04086621
   0.04086621]
 [-0.44569783 -0.96253689 -1.58242051 -1.73524214  1.81831901  1.80666805
  -1.73524214 -1.73524214  0.          0.          0.         -1.73524214
  -1.73524214]
 [-2.10553804 -1.91530183 -1.99612522 -1.68808882 -0.12256173 -0.13414113
  -1.68808882 -1.68808882  0.          0.          0.         -1.68808882
  -1.68808882]]
2024-09-19 13:40:45 - INFO - y 샘플:
[-1.68808882]
2024-09-19 13:40:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:40:45 - INFO - 모델 출력 (스케일링된 예측): [0.35634726]
2024-09-19 13:40:45 - INFO - 스케일러 역변환 후 예측 가격: 83100143.22539587
2024-09-19 13:40:45 - INFO - TransformerPredictor 최종 예측 가격: 83100143.22539587
2024-09-19 13:40:45 - INFO - TRANSFORMER prediction: 83100143.22539587
2024-09-19 13:40:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:40:45 - INFO - BITCOIN_FORECAST prediction: 82260783.10123013
2024-09-19 13:40:45 - INFO - BitcoinForecast prediction: 82260783.10123013
2024-09-19 13:40:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:40:57 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:40:57 - INFO - 조정된 모델 가중치: {'gpt': 0.0036054423712801823, 'ml': 0.2634918743706665, 'xgboost': 0.03814821976923799, 'rl': 0.10353366317193775, 'lstm': 0.10332747407290772, 'arima': 0.1482974246827535, 'prophet': 0.09081935540449038, 'transformer': 0.13112306456084116, 'bitcoin_forecast': 0.1176534815958848}
2024-09-19 13:40:57 - INFO - 조정된 모델 가중치: {'gpt': 0.0036054423712801823, 'ml': 0.2634918743706665, 'xgboost': 0.03814821976923799, 'rl': 0.10353366317193775, 'lstm': 0.10332747407290772, 'arima': 0.1482974246827535, 'prophet': 0.09081935540449038, 'transformer': 0.13112306456084116, 'bitcoin_forecast': 0.1176534815958848}
2024-09-19 13:40:57 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82630556.64568402, 'current_price': 82800000.0, 'predictions': {'gpt': 82800000.0, 'ml': 82856568.0, 'xgboost': 82840000.0, 'lstm': 83087181.71661809, 'rl': 83628000.0, 'arima': 80899000.0, 'prophet': 82852018.91507396, 'transformer': 83100143.22539587, 'bitcoin_forecast': 82260783.10123013}, 'weights': {'gpt': 0.0036054423712801823, 'ml': 0.2634918743706665, 'xgboost': 0.03814821976923799, 'rl': 0.10353366317193775, 'lstm': 0.10332747407290772, 'arima': 0.1482974246827535, 'prophet': 0.09081935540449038, 'transformer': 0.13112306456084116, 'bitcoin_forecast': 0.1176534815958848}}
2024-09-19 13:40:57 - INFO - 모델별 가중치:
2024-09-19 13:40:57 - INFO -   - GPT: 0.0036
2024-09-19 13:40:57 - INFO -   - ML: 0.2635
2024-09-19 13:40:57 - INFO -   - XGBOOST: 0.0381
2024-09-19 13:40:57 - INFO -   - RL: 0.1035
2024-09-19 13:40:57 - INFO -   - LSTM: 0.1033
2024-09-19 13:40:57 - INFO -   - ARIMA: 0.1483
2024-09-19 13:40:57 - INFO -   - PROPHET: 0.0908
2024-09-19 13:40:57 - INFO -   - TRANSFORMER: 0.1311
2024-09-19 13:40:57 - INFO -   - BITCOIN_FORECAST: 0.1177
2024-09-19 13:40:57 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:40:57 - INFO - 6. 거래 실행
2024-09-19 13:40:57 - INFO - Cancelling existing orders.
2024-09-19 13:40:57 - INFO - Cancelled 0 orders.
2024-09-19 13:40:57 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82630556.64568402, 'current_price': 82800000.0, 'predictions': {'gpt': 82800000.0, 'ml': 82856568.0, 'xgboost': 82840000.0, 'lstm': 83087181.71661809, 'rl': 83628000.0, 'arima': 80899000.0, 'prophet': 82852018.91507396, 'transformer': 83100143.22539587, 'bitcoin_forecast': 82260783.10123013}, 'weights': {'gpt': 0.0036054423712801823, 'ml': 0.2634918743706665, 'xgboost': 0.03814821976923799, 'rl': 0.10353366317193775, 'lstm': 0.10332747407290772, 'arima': 0.1482974246827535, 'prophet': 0.09081935540449038, 'transformer': 0.13112306456084116, 'bitcoin_forecast': 0.1176534815958848}}, 현재 가격=82800000.0
2024-09-19 13:40:57 - INFO - 현재 잔고: KRW=230923.3248803, BTC=0.00296512, 총 자산가치=476435.26088029996
2024-09-19 13:40:57 - INFO - 매도 시도: 0.00029651199999999997 BTC (약 24551.1936 KRW)
2024-09-19 13:40:57 - INFO - 주문 결과: {'uuid': 'd280ec84-8522-4242-b55a-934f2aad88e3', 'side': 'ask', 'ord_type': 'limit', 'price': '82800000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:40:59+09:00', 'volume': '0.00029651', 'remaining_volume': '0.00029651', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00029651', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:40:57 - INFO - sell 주문 성공: UUID=d280ec84-8522-4242-b55a-934f2aad88e3
2024-09-19 13:40:57 - INFO - Trade executed successfully.
2024-09-19 13:40:57 - INFO - 7. summary 리포트 보내기
2024-09-19 13:40:58 - INFO - Message sent to Discord successfully.
2024-09-19 13:40:58 - INFO - Trading cycle completed.
2024-09-19 13:40:58 - INFO - Performing periodic update.
2024-09-19 13:40:58 - INFO - 계산된 시장 변동성: 0.03877199474828452
2024-09-19 13:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:45:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-9e17-f48bd06dc8c7 "HTTP/1.1 200 OK"
2024-09-19 13:45:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:45:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:45:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81df-a26f-c46af6dbf453 "HTTP/1.1 200 OK"
2024-09-19 13:45:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:45:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8152-a781-ff26867dc2b1 "HTTP/1.1 200 OK"
2024-09-19 13:45:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-bdfd-d9464fe9419b "HTTP/1.1 200 OK"
2024-09-19 13:46:05 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a7-bd3f-f64a4bd0fedf "HTTP/1.1 200 OK"
2024-09-19 13:46:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-b7b0-c2950dd1b748 "HTTP/1.1 200 OK"
2024-09-19 13:46:20 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-87f8-e82f451b1875 "HTTP/1.1 200 OK"
2024-09-19 13:46:25 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8181-950a-e9b58170fcd7 "HTTP/1.1 200 OK"
2024-09-19 13:46:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:46:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8151-af63-fb73c7cbc2c8 "HTTP/1.1 200 OK"
2024-09-19 13:46:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:35:34.908452
2024-09-19 13:46:43 - INFO - Starting trading cycle.
2024-09-19 13:46:43 - INFO - ##################################################
2024-09-19 13:46:43 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-19 13:46:43 - INFO - ##################################################
2024-09-19 13:46:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:46:43 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:46:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:30:00
2024-09-19 13:46:43 - INFO - 새로운 데이터 범위: 2024-09-18 04:30:00 ~ 2024-09-19 13:40:00
2024-09-19 13:46:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:46:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:46:43 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:46:43 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:46:43 - INFO - Sample date values: [Timestamp('2024-09-19 13:40:00')]
2024-09-19 13:46:43 - INFO - Successfully added 1 new data points
2024-09-19 13:46:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:46:43 - INFO - Final date range: 2024-09-19 13:40:00 to 2024-09-19 13:40:00
2024-09-19 13:46:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:46:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:40:00
2024-09-19 13:46:43 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:46:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:46:43 - INFO - GPT | 이전예측가격: 82800000 | 당시BTC가격: 82800000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:46:43 - INFO - ML 모델 예측 업데이트: 정확도 59.68%, 적중/전체: 37/62
2024-09-19 13:46:43 - INFO - ML | 이전예측가격: 82856568 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2395 | 반영가중치값: 0.0200 | 새 가중치: 0.2595 | 예측 총 횟수: 62 | 예측 성공 수: 37 | 예측 성공률: 59.68%
2024-09-19 13:46:43 - INFO - XGBOOST 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 13:46:43 - INFO - XGBOOST | 이전예측가격: 82840000 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0390 | 반영가중치값: 0.0200 | 새 가중치: 0.0590 | 예측 총 횟수: 114 | 예측 성공 수: 72 | 예측 성공률: 63.16%
2024-09-19 13:46:43 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 13:46:43 - INFO - LSTM | 이전예측가격: 83087182 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 13:46:43 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 13:46:43 - INFO - RL | 이전예측가격: 83628000 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 13:46:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.75%, 적중/전체: 97/174
2024-09-19 13:46:43 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82800000 | 예측: 하락 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0622 | 반영가중치값: -0.0200 | 새 가중치: 0.0422 | 예측 총 횟수: 174 | 예측 성공 수: 97 | 예측 성공률: 55.75%
2024-09-19 13:46:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-19 13:46:43 - INFO - PROPHET | 이전예측가격: 82852019 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-19 13:46:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 12/21
2024-09-19 13:46:43 - INFO - TRANSFORMER | 이전예측가격: 83100143 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2057 | 반영가중치값: 0.0200 | 새 가중치: 0.2257 | 예측 총 횟수: 21 | 예측 성공 수: 12 | 예측 성공률: 57.14%
2024-09-19 13:46:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 12/22
2024-09-19 13:46:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 82260783 | 당시BTC가격: 82800000 | 예측: 하락 | 지금 BTC가격: 82911000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0634 | 반영가중치값: -0.0200 | 새 가중치: 0.0434 | 예측 총 횟수: 22 | 예측 성공 수: 12 | 예측 성공률: 54.55%
2024-09-19 13:46:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:46:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:46:44 - INFO - 새로운 가중치: {'gpt': 0.0033748334978462103, 'ml': 0.2428636675894833, 'xgboost': 0.055233505271528156, 'rl': 0.13572560778830225, 'lstm': 0.13572560778830225, 'arima': 0.03947336909434313, 'prophet': 0.13572560778830225, 'transformer': 0.2112897415237782, 'bitcoin_forecast': 0.040588059658114184}
2024-09-19 13:46:44 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 13:46:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:46:44 - INFO - Current BTC price: 82911000.0
2024-09-19 13:46:44 - INFO - Analyzing market conditions.
2024-09-19 13:46:44 - INFO - Market analysis: {'current_price': 82911000.0, 'sma_20': 83048700.0, 'rsi_14': 52.249970294798636, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:46:44 - INFO - Starting predictions for all models
2024-09-19 13:46:44 - INFO - Attempting prediction for gpt
2024-09-19 13:46:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:46:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:46:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:46:44 - INFO - GPT prediction: 82911000.0
2024-09-19 13:46:44 - INFO - Attempting prediction for ml
2024-09-19 13:46:44 - INFO - ML prediction: 82911000.0
2024-09-19 13:46:44 - INFO - Attempting prediction for xgboost
2024-09-19 13:46:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:46:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:46:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:46:44 - INFO - XGBOOST prediction: 82911000.0
2024-09-19 13:46:44 - INFO - Attempting prediction for lstm
2024-09-19 13:46:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:46:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:46:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:46:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:46:44 - INFO - X 샘플:
[[ 1.31654967  0.97439443  1.08416565  0.65124653 -0.31432826 -0.30978887
   0.65124653]
 [ 0.28532996  1.34155755  0.92730764  1.73806156  1.56546503  1.57572474
   1.73806156]
 [ 1.30879614  0.8708356   0.31832949  0.32267454 -0.24258422 -0.24103901
   0.32267454]
 [ 0.53344298  0.8708356   0.87194599  0.65124653 -0.34423417 -0.34044958
   0.65124653]
 [ 0.05272402 -0.23065375  0.31832949  0.0109524  -1.107754   -1.10716553
   0.0109524 ]
 [ 0.14576639  0.27772595  0.48441444  0.381649    0.41558874  0.4184891
   0.381649  ]
 [-0.08683955 -0.25889707  0.4105989   0.31424962 -1.04362912 -1.04332637
   0.31424962]
 [-0.0480719  -0.72961902 -1.21334283 -1.58978292  1.96427552  1.95521696
  -1.58978292]
 [-1.72283473 -1.83110837 -1.61932826 -1.53923338  0.06704656  0.05746181
  -1.53923338]
 [-1.78486298 -1.28507091 -1.5824205  -0.94106387 -0.95984608 -0.96512326
  -0.94106387]]
2024-09-19 13:46:44 - INFO - y 샘플:
[-0.94106387]
2024-09-19 13:46:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:46:44 - INFO - 모델 출력 (스케일링된 예측): [[0.24165557]]
2024-09-19 13:46:44 - INFO - 스케일러 역변환 후 예측 가격: 83051383.41716376
2024-09-19 13:46:44 - INFO - LSTMPredictor 최종 예측 가격: 83051383.41716376
2024-09-19 13:46:44 - INFO - LSTM prediction: 83051383.41716376
2024-09-19 13:46:44 - INFO - Attempting prediction for rl
2024-09-19 13:46:44 - INFO - Preparing state for RL agent.
2024-09-19 13:46:44 - INFO - Prepared state: [[8.29110000e+07 1.25591377e+01 8.57073877e-04 8.30487000e+07
  5.22499703e+01]]
2024-09-19 13:46:44 - INFO - RL prediction: 83740110.0
2024-09-19 13:46:44 - INFO - Attempting prediction for arima
2024-09-19 13:46:44 - INFO - ARIMA 예측 시작
2024-09-19 13:46:44 - INFO - 입력 데이터: {'open': 82801000.0, 'high': 82971000.0, 'low': 82794000.0, 'close': 82911000.0, 'volume': 12.55913767, 'value': 1040710609.26248, 'decision': 'sell', 'sma': 83048700.0, 'ema': 82944832.1116911, 'rsi': 52.249970294798636, 'macd': 137692.31686142087, 'signal_line': 231234.70373505796, 'BB_Upper': 83401381.21582843, 'BB_Lower': 82696018.78417157}
2024-09-19 13:46:44 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:46:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83048700.0         0         0
2024-09-19 13:46:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83048700.0         0         0
2024-09-19 13:46:44 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:46:44 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:46:44 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:46:44 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:46:44 - INFO - Attempting prediction for prophet
2024-09-19 13:46:44 - INFO - PROPHET prediction: 82932464.49397862
2024-09-19 13:46:44 - INFO - Attempting prediction for transformer
2024-09-19 13:46:44 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:46:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:46:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:46:44 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:46:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:46:44 - INFO - X 샘플:
[[ 1.31654967  0.97439443  1.08416565  0.65124653 -0.31432826 -0.30978887
   0.65124653  0.65124653  0.          0.          0.          0.65124653
   0.65124653]
 [ 0.28532996  1.34155755  0.92730764  1.73806156  1.56546503  1.57572474
   1.73806156  1.73806156  0.          0.          0.          1.73806156
   1.73806156]
 [ 1.30879614  0.8708356   0.31832949  0.32267454 -0.24258422 -0.24103901
   0.32267454  0.32267454  0.          0.          0.          0.32267454
   0.32267454]
 [ 0.53344298  0.8708356   0.87194599  0.65124653 -0.34423417 -0.34044958
   0.65124653  0.65124653  0.          0.          0.          0.65124653
   0.65124653]
 [ 0.05272402 -0.23065375  0.31832949  0.0109524  -1.107754   -1.10716553
   0.0109524   0.0109524   0.          0.          0.          0.0109524
   0.0109524 ]
 [ 0.14576639  0.27772595  0.48441444  0.381649    0.41558874  0.4184891
   0.381649    0.381649    0.          0.          0.          0.381649
   0.381649  ]
 [-0.08683955 -0.25889707  0.4105989   0.31424962 -1.04362912 -1.04332637
   0.31424962  0.31424962  0.          0.          0.          0.31424962
   0.31424962]
 [-0.0480719  -0.72961902 -1.21334283 -1.58978292  1.96427552  1.95521696
  -1.58978292 -1.58978292  0.          0.          0.         -1.58978292
  -1.58978292]
 [-1.72283473 -1.83110837 -1.61932826 -1.53923338  0.06704656  0.05746181
  -1.53923338 -1.53923338  0.          0.          0.         -1.53923338
  -1.53923338]
 [-1.78486298 -1.28507091 -1.5824205  -0.94106387 -0.95984608 -0.96512326
  -0.94106387 -0.94106387  0.          0.          0.         -0.94106387
  -0.94106387]]
2024-09-19 13:46:44 - INFO - y 샘플:
[-0.94106387]
2024-09-19 13:46:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:46:44 - INFO - 모델 출력 (스케일링된 예측): [0.35919702]
2024-09-19 13:46:44 - INFO - 스케일러 역변환 후 예측 가격: 83065335.05221646
2024-09-19 13:46:44 - INFO - TransformerPredictor 최종 예측 가격: 83065335.05221646
2024-09-19 13:46:44 - INFO - TRANSFORMER prediction: 83065335.05221646
2024-09-19 13:46:44 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:46:44 - INFO - BITCOIN_FORECAST prediction: 82236585.9445596
2024-09-19 13:46:44 - INFO - BitcoinForecast prediction: 82236585.9445596
2024-09-19 13:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:46:53 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0033748334978462103, 'ml': 0.2428636675894833, 'xgboost': 0.055233505271528156, 'rl': 0.13572560778830225, 'lstm': 0.13572560778830225, 'arima': 0.03947336909434313, 'prophet': 0.13572560778830225, 'transformer': 0.2112897415237782, 'bitcoin_forecast': 0.040588059658114184}
2024-09-19 13:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0033748334978462103, 'ml': 0.2428636675894833, 'xgboost': 0.055233505271528156, 'rl': 0.13572560778830225, 'lstm': 0.13572560778830225, 'arima': 0.03947336909434313, 'prophet': 0.13572560778830225, 'transformer': 0.2112897415237782, 'bitcoin_forecast': 0.040588059658114184}
2024-09-19 13:46:53 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 82971314.201539, 'current_price': 82911000.0, 'predictions': {'gpt': 82911000.0, 'ml': 82911000.0, 'xgboost': 82911000.0, 'lstm': 83051383.41716376, 'rl': 83740110.0, 'arima': 80899000.0, 'prophet': 82932464.49397862, 'transformer': 83065335.05221646, 'bitcoin_forecast': 82236585.9445596}, 'weights': {'gpt': 0.0033748334978462103, 'ml': 0.2428636675894833, 'xgboost': 0.055233505271528156, 'rl': 0.13572560778830225, 'lstm': 0.13572560778830225, 'arima': 0.03947336909434313, 'prophet': 0.13572560778830225, 'transformer': 0.2112897415237782, 'bitcoin_forecast': 0.040588059658114184}}
2024-09-19 13:46:53 - INFO - 모델별 가중치:
2024-09-19 13:46:53 - INFO -   - GPT: 0.0034
2024-09-19 13:46:53 - INFO -   - ML: 0.2429
2024-09-19 13:46:53 - INFO -   - XGBOOST: 0.0552
2024-09-19 13:46:53 - INFO -   - RL: 0.1357
2024-09-19 13:46:53 - INFO -   - LSTM: 0.1357
2024-09-19 13:46:53 - INFO -   - ARIMA: 0.0395
2024-09-19 13:46:53 - INFO -   - PROPHET: 0.1357
2024-09-19 13:46:53 - INFO -   - TRANSFORMER: 0.2113
2024-09-19 13:46:53 - INFO -   - BITCOIN_FORECAST: 0.0406
2024-09-19 13:46:53 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:46:53 - INFO - 6. 거래 실행
2024-09-19 13:46:53 - INFO - Cancelling existing orders.
2024-09-19 13:46:53 - INFO - Cancelled 0 orders.
2024-09-19 13:46:53 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 82971314.201539, 'current_price': 82911000.0, 'predictions': {'gpt': 82911000.0, 'ml': 82911000.0, 'xgboost': 82911000.0, 'lstm': 83051383.41716376, 'rl': 83740110.0, 'arima': 80899000.0, 'prophet': 82932464.49397862, 'transformer': 83065335.05221646, 'bitcoin_forecast': 82236585.9445596}, 'weights': {'gpt': 0.0033748334978462103, 'ml': 0.2428636675894833, 'xgboost': 0.055233505271528156, 'rl': 0.13572560778830225, 'lstm': 0.13572560778830225, 'arima': 0.03947336909434313, 'prophet': 0.13572560778830225, 'transformer': 0.2112897415237782, 'bitcoin_forecast': 0.040588059658114184}}, 현재 가격=82911000.0
2024-09-19 13:46:53 - INFO - 현재 잔고: KRW=255462.0773663, BTC=0.00266861, 총 자산가치=476719.2010763
2024-09-19 13:46:53 - INFO - 매수 시도: 0.0005749770248535176 BTC (약 47671.92010763 KRW)
2024-09-19 13:46:53 - INFO - 주문 결과: {'uuid': 'bf0f486d-8410-47fe-b31a-7c879b139e81', 'side': 'bid', 'ord_type': 'limit', 'price': '82911000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:46:55+09:00', 'volume': '0.00057497', 'remaining_volume': '0.00057497', 'reserved_fee': '23.835668835', 'remaining_fee': '23.835668835', 'paid_fee': '0', 'locked': '47695.173338835', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:46:53 - INFO - buy 주문 성공: UUID=bf0f486d-8410-47fe-b31a-7c879b139e81
2024-09-19 13:46:53 - INFO - Trade executed successfully.
2024-09-19 13:46:53 - INFO - 7. summary 리포트 보내기
2024-09-19 13:46:54 - INFO - Message sent to Discord successfully.
2024-09-19 13:46:54 - INFO - Trading cycle completed.
2024-09-19 13:46:54 - INFO - Performing periodic update.
2024-09-19 13:46:54 - INFO - 계산된 시장 변동성: 0.03857292492323216
2024-09-19 13:55:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:55:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8106-b540-f06378b99017 "HTTP/1.1 200 OK"
2024-09-19 13:55:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:55:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:55:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c6-9323-c73d37d324c4 "HTTP/1.1 200 OK"
2024-09-19 13:55:45 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-a9f7-e2a3c096a12e "HTTP/1.1 200 OK"
2024-09-19 13:55:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-b6c2-ce8b5aec879f "HTTP/1.1 200 OK"
2024-09-19 13:56:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8106-a497-dc6182bf66b9 "HTTP/1.1 200 OK"
2024-09-19 13:56:13 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8174-a63b-fb214f57baef "HTTP/1.1 200 OK"
2024-09-19 13:56:20 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-ac51-c01a26c630b6 "HTTP/1.1 200 OK"
2024-09-19 13:56:30 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/ed639187-c058-4ef9-8bf2-72c5356ff1f3 "HTTP/1.1 200 OK"
2024-09-19 13:56:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 13:56:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-8086-f0748cb08a55 "HTTP/1.1 200 OK"
2024-09-19 13:56:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:45:34.908835
2024-09-19 13:56:43 - INFO - Starting trading cycle.
2024-09-19 13:56:43 - INFO - ##################################################
2024-09-19 13:56:43 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-19 13:56:43 - INFO - ##################################################
2024-09-19 13:56:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 13:56:43 - INFO - 데이터베이스 업데이트 시작
2024-09-19 13:56:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:40:00
2024-09-19 13:56:43 - INFO - 새로운 데이터 범위: 2024-09-18 04:40:00 ~ 2024-09-19 13:50:00
2024-09-19 13:56:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 13:56:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 13:56:43 - INFO - Index: Index([199], dtype='int64')
2024-09-19 13:56:43 - INFO - Date column data type: datetime64[ns]
2024-09-19 13:56:43 - INFO - Sample date values: [Timestamp('2024-09-19 13:50:00')]
2024-09-19 13:56:44 - INFO - Successfully added 1 new data points
2024-09-19 13:56:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 13:56:44 - INFO - Final date range: 2024-09-19 13:50:00 to 2024-09-19 13:50:00
2024-09-19 13:56:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 13:56:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 13:50:00
2024-09-19 13:56:44 - INFO - 데이터베이스 업데이트 완료
2024-09-19 13:56:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 13:56:44 - INFO - GPT | 이전예측가격: 82911000 | 당시BTC가격: 82911000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:56:44 - INFO - ML | 이전예측가격: 82911000 | 당시BTC가격: 82911000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:56:44 - INFO - XGBOOST | 이전예측가격: 82911000 | 당시BTC가격: 82911000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 13:56:44 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 13:56:44 - INFO - LSTM | 이전예측가격: 83051383 | 당시BTC가격: 82911000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1033 | 반영가중치값: 0.0200 | 새 가중치: 0.1233 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 13:56:44 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 13:56:44 - INFO - RL | 이전예측가격: 83740110 | 당시BTC가격: 82911000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1035 | 반영가중치값: 0.0200 | 새 가중치: 0.1235 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 13:56:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.43%, 적중/전체: 97/175
2024-09-19 13:56:44 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82911000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1483 | 반영가중치값: -0.0200 | 새 가중치: 0.1283 | 예측 총 횟수: 175 | 예측 성공 수: 97 | 예측 성공률: 55.43%
2024-09-19 13:56:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 3/3
2024-09-19 13:56:44 - INFO - PROPHET | 이전예측가격: 82932464 | 당시BTC가격: 82911000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0908 | 반영가중치값: 0.0200 | 새 가중치: 0.1108 | 예측 총 횟수: 3 | 예측 성공 수: 3 | 예측 성공률: 100.00%
2024-09-19 13:56:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-19 13:56:44 - INFO - TRANSFORMER | 이전예측가격: 83065335 | 당시BTC가격: 82911000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1311 | 반영가중치값: 0.0200 | 새 가중치: 0.1511 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-19 13:56:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.17%, 적중/전체: 12/23
2024-09-19 13:56:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 82236586 | 당시BTC가격: 82911000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1177 | 반영가중치값: -0.0200 | 새 가중치: 0.0977 | 예측 총 횟수: 23 | 예측 성공 수: 12 | 예측 성공률: 52.17%
2024-09-19 13:56:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 13:56:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 13:56:44 - INFO - 새로운 가중치: {'gpt': 0.0032568493433122936, 'ml': 0.23437315553730706, 'xgboost': 0.05330254232904084, 'rl': 0.11921492720611296, 'lstm': 0.11901594647648507, 'arima': 0.12381214764916537, 'prophet': 0.1069451115457232, 'transformer': 0.14583980332316399, 'bitcoin_forecast': 0.09423951658968914}
2024-09-19 13:56:44 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 13:56:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 13:56:44 - INFO - Current BTC price: 82960000.0
2024-09-19 13:56:44 - INFO - Analyzing market conditions.
2024-09-19 13:56:44 - INFO - Market analysis: {'current_price': 82960000.0, 'sma_20': 83065800.0, 'rsi_14': 53.71412230869023, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 13:56:44 - INFO - Starting predictions for all models
2024-09-19 13:56:44 - INFO - Attempting prediction for gpt
2024-09-19 13:56:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 13:56:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:56:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 13:56:44 - INFO - GPT prediction: 82960000.0
2024-09-19 13:56:44 - INFO - Attempting prediction for ml
2024-09-19 13:56:44 - INFO - ML prediction: 82976592.0
2024-09-19 13:56:44 - INFO - Attempting prediction for xgboost
2024-09-19 13:56:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 13:56:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:56:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 13:56:44 - INFO - XGBOOST prediction: 82960000.0
2024-09-19 13:56:44 - INFO - Attempting prediction for lstm
2024-09-19 13:56:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:56:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:56:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:56:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:56:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:56:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 13:56:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:56:44 - INFO - X 샘플:
[[ 0.52537548  1.56125022  1.15366452  1.88296032  1.4985744   1.50771137
   1.88296032]
 [ 1.65118006  1.08756993  0.50454382  0.44702145 -0.07418162 -0.07234928
   0.44702145]
 [ 0.7982978   1.08756993  1.09465355  0.7803644  -0.1626032  -0.15880781
   0.7803644 ]
 [ 0.2695108  -0.02084193  0.50454382  0.130773   -0.82676122 -0.82562963
   0.130773  ]
 [ 0.37185667  0.49073277  0.68157674  0.50685223  0.498339    0.50125002
   0.50685223]
 [ 0.11599199 -0.04926275  0.60289544  0.43847419 -0.77098133 -0.77010796
   0.43847419]
 [ 0.1586361  -0.52294303 -1.1280931  -1.49320548  1.84548508  1.83776018
  -1.49320548]
 [-1.68358959 -1.6313549  -1.56084024 -1.44192195  0.19515488  0.18726037
  -1.44192195]
 [-1.75182017 -1.08188577 -1.52149959 -0.83506683 -0.69810152 -0.70209381
  -0.83506683]
 [-0.45543913 -0.92083447 -0.33144497 -0.41625133 -1.50492445 -1.50499345
  -0.41625133]]
2024-09-19 13:56:44 - INFO - y 샘플:
[-0.41625133]
2024-09-19 13:56:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 13:56:44 - INFO - 모델 출력 (스케일링된 예측): [[0.23582987]]
2024-09-19 13:56:44 - INFO - 스케일러 역변환 후 예측 가격: 83036291.2991709
2024-09-19 13:56:44 - INFO - LSTMPredictor 최종 예측 가격: 83036291.2991709
2024-09-19 13:56:44 - INFO - LSTM prediction: 83036291.2991709
2024-09-19 13:56:44 - INFO - Attempting prediction for rl
2024-09-19 13:56:44 - INFO - Preparing state for RL agent.
2024-09-19 13:56:44 - INFO - Prepared state: [[8.29600000e+07 8.46643610e+00 5.90995163e-04 8.30658000e+07
  5.37141223e+01]]
2024-09-19 13:56:44 - INFO - RL prediction: 83789600.0
2024-09-19 13:56:44 - INFO - Attempting prediction for arima
2024-09-19 13:56:44 - INFO - ARIMA 예측 시작
2024-09-19 13:56:44 - INFO - 입력 데이터: {'open': 82953000.0, 'high': 82988000.0, 'low': 82915000.0, 'close': 82960000.0, 'volume': 8.4664361, 'value': 702349310.67134, 'decision': 'sell', 'sma': 83065800.0, 'ema': 82946276.67248243, 'rsi': 53.71412230869023, 'macd': 124660.87861698866, 'signal_line': 209919.93871144412, 'BB_Upper': 83361920.65109211, 'BB_Lower': 82769679.34890789}
2024-09-19 13:56:44 - INFO - Exogenous 변수 예측 시작
2024-09-19 13:56:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83065800.0         0         0
2024-09-19 13:56:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83065800.0         0         0
2024-09-19 13:56:44 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 13:56:44 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 13:56:44 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 13:56:44 - INFO - ARIMA prediction: 80899000.0
2024-09-19 13:56:44 - INFO - Attempting prediction for prophet
2024-09-19 13:56:45 - INFO - PROPHET prediction: 82987436.29657333
2024-09-19 13:56:45 - INFO - Attempting prediction for transformer
2024-09-19 13:56:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:56:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 13:56:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 13:56:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 13:56:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 13:56:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 13:56:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 13:56:45 - INFO - X 샘플:
[[ 0.52537548  1.56125022  1.15366452  1.88296032  1.4985744   1.50771137
   1.88296032  1.88296032  0.          0.          0.          1.88296032
   1.88296032]
 [ 1.65118006  1.08756993  0.50454382  0.44702145 -0.07418162 -0.07234928
   0.44702145  0.44702145  0.          0.          0.          0.44702145
   0.44702145]
 [ 0.7982978   1.08756993  1.09465355  0.7803644  -0.1626032  -0.15880781
   0.7803644   0.7803644   0.          0.          0.          0.7803644
   0.7803644 ]
 [ 0.2695108  -0.02084193  0.50454382  0.130773   -0.82676122 -0.82562963
   0.130773    0.130773    0.          0.          0.          0.130773
   0.130773  ]
 [ 0.37185667  0.49073277  0.68157674  0.50685223  0.498339    0.50125002
   0.50685223  0.50685223  0.          0.          0.          0.50685223
   0.50685223]
 [ 0.11599199 -0.04926275  0.60289544  0.43847419 -0.77098133 -0.77010796
   0.43847419  0.43847419  0.          0.          0.          0.43847419
   0.43847419]
 [ 0.1586361  -0.52294303 -1.1280931  -1.49320548  1.84548508  1.83776018
  -1.49320548 -1.49320548  0.          0.          0.         -1.49320548
  -1.49320548]
 [-1.68358959 -1.6313549  -1.56084024 -1.44192195  0.19515488  0.18726037
  -1.44192195 -1.44192195  0.          0.          0.         -1.44192195
  -1.44192195]
 [-1.75182017 -1.08188577 -1.52149959 -0.83506683 -0.69810152 -0.70209381
  -0.83506683 -0.83506683  0.          0.          0.         -0.83506683
  -0.83506683]
 [-0.45543913 -0.92083447 -0.33144497 -0.41625133 -1.50492445 -1.50499345
  -0.41625133 -0.41625133  0.          0.          0.         -0.41625133
  -0.41625133]]
2024-09-19 13:56:45 - INFO - y 샘플:
[-0.41625133]
2024-09-19 13:56:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 13:56:45 - INFO - 모델 출력 (스케일링된 예측): [0.3609307]
2024-09-19 13:56:45 - INFO - 스케일러 역변환 후 예측 가격: 83050927.67464629
2024-09-19 13:56:45 - INFO - TransformerPredictor 최종 예측 가격: 83050927.67464629
2024-09-19 13:56:45 - INFO - TRANSFORMER prediction: 83050927.67464629
2024-09-19 13:56:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 13:56:45 - INFO - BITCOIN_FORECAST prediction: 82207458.61834493
2024-09-19 13:56:45 - INFO - BitcoinForecast prediction: 82207458.61834493
2024-09-19 13:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 13:56:56 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 13:56:56 - INFO - 조정된 모델 가중치: {'gpt': 0.0032568493433122936, 'ml': 0.23437315553730706, 'xgboost': 0.05330254232904084, 'rl': 0.11921492720611296, 'lstm': 0.11901594647648507, 'arima': 0.12381214764916537, 'prophet': 0.1069451115457232, 'transformer': 0.14583980332316399, 'bitcoin_forecast': 0.09423951658968914}
2024-09-19 13:56:56 - INFO - 조정된 모델 가중치: {'gpt': 0.0032568493433122936, 'ml': 0.23437315553730706, 'xgboost': 0.05330254232904084, 'rl': 0.11921492720611296, 'lstm': 0.11901594647648507, 'arima': 0.12381214764916537, 'prophet': 0.1069451115457232, 'transformer': 0.14583980332316399, 'bitcoin_forecast': 0.09423951658968914}
2024-09-19 13:56:56 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82761968.38384426, 'current_price': 82960000.0, 'predictions': {'gpt': 82960000.0, 'ml': 82976592.0, 'xgboost': 82960000.0, 'lstm': 83036291.2991709, 'rl': 83789600.0, 'arima': 80899000.0, 'prophet': 82987436.29657333, 'transformer': 83050927.67464629, 'bitcoin_forecast': 82207458.61834493}, 'weights': {'gpt': 0.0032568493433122936, 'ml': 0.23437315553730706, 'xgboost': 0.05330254232904084, 'rl': 0.11921492720611296, 'lstm': 0.11901594647648507, 'arima': 0.12381214764916537, 'prophet': 0.1069451115457232, 'transformer': 0.14583980332316399, 'bitcoin_forecast': 0.09423951658968914}}
2024-09-19 13:56:56 - INFO - 모델별 가중치:
2024-09-19 13:56:56 - INFO -   - GPT: 0.0033
2024-09-19 13:56:56 - INFO -   - ML: 0.2344
2024-09-19 13:56:56 - INFO -   - XGBOOST: 0.0533
2024-09-19 13:56:56 - INFO -   - RL: 0.1192
2024-09-19 13:56:56 - INFO -   - LSTM: 0.1190
2024-09-19 13:56:56 - INFO -   - ARIMA: 0.1238
2024-09-19 13:56:56 - INFO -   - PROPHET: 0.1069
2024-09-19 13:56:56 - INFO -   - TRANSFORMER: 0.1458
2024-09-19 13:56:56 - INFO -   - BITCOIN_FORECAST: 0.0942
2024-09-19 13:56:56 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 13:56:56 - INFO - 6. 거래 실행
2024-09-19 13:56:56 - INFO - Cancelling existing orders.
2024-09-19 13:56:56 - INFO - Cancelled 1 orders.
2024-09-19 13:56:56 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82761968.38384426, 'current_price': 82960000.0, 'predictions': {'gpt': 82960000.0, 'ml': 82976592.0, 'xgboost': 82960000.0, 'lstm': 83036291.2991709, 'rl': 83789600.0, 'arima': 80899000.0, 'prophet': 82987436.29657333, 'transformer': 83050927.67464629, 'bitcoin_forecast': 82207458.61834493}, 'weights': {'gpt': 0.0032568493433122936, 'ml': 0.23437315553730706, 'xgboost': 0.05330254232904084, 'rl': 0.11921492720611296, 'lstm': 0.11901594647648507, 'arima': 0.12381214764916537, 'prophet': 0.1069451115457232, 'transformer': 0.14583980332316399, 'bitcoin_forecast': 0.09423951658968914}}, 현재 가격=82960000.0
2024-09-19 13:56:56 - INFO - 현재 잔고: KRW=207766.90402746, BTC=0.00266861, 총 자산가치=429154.78962746
2024-09-19 13:56:56 - INFO - 매도 시도: 0.000266861 BTC (약 22138.78856 KRW)
2024-09-19 13:56:56 - INFO - 주문 결과: {'uuid': '0fa13e42-5bf4-4970-b762-495c2064993f', 'side': 'ask', 'ord_type': 'limit', 'price': '82960000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T13:56:58+09:00', 'volume': '0.00026686', 'remaining_volume': '0.00026686', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00026686', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 13:56:56 - INFO - sell 주문 성공: UUID=0fa13e42-5bf4-4970-b762-495c2064993f
2024-09-19 13:56:56 - INFO - Trade executed successfully.
2024-09-19 13:56:56 - INFO - 7. summary 리포트 보내기
2024-09-19 13:56:57 - INFO - Message sent to Discord successfully.
2024-09-19 13:56:57 - INFO - Trading cycle completed.
2024-09-19 13:56:57 - INFO - Performing periodic update.
2024-09-19 13:56:57 - INFO - 계산된 시장 변동성: 0.03851766058745585
2024-09-19 14:05:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:05:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0a08c2a0-4922-4097-829c-bdf816eaff02 "HTTP/1.1 200 OK"
2024-09-19 14:05:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:05:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d6-b24b-d63d5ca75700 "HTTP/1.1 200 OK"
2024-09-19 14:05:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:05:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:05:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8105-a53a-f3529e529bc2 "HTTP/1.1 200 OK"
2024-09-19 14:05:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-8bf6-dd146acfb129 "HTTP/1.1 200 OK"
2024-09-19 14:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8194-bbc5-ce929e546e21 "HTTP/1.1 200 OK"
2024-09-19 14:06:10 - INFO - Updated actual price for rl prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/23e2ece4-8021-4c4c-a009-f6e90c06ea01 "HTTP/1.1 200 OK"
2024-09-19 14:06:18 - INFO - Updated actual price for arima prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-8a18-d3100a7fd874 "HTTP/1.1 200 OK"
2024-09-19 14:06:39 - INFO - Updated actual price for prophet prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8157-8844-dbdbff39c1cc "HTTP/1.1 200 OK"
2024-09-19 14:06:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:06:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-9307-f1e3f9a2766a "HTTP/1.1 200 OK"
2024-09-19 14:06:56 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 13:55:34.923732
2024-09-19 14:06:56 - INFO - Starting trading cycle.
2024-09-19 14:06:56 - INFO - ##################################################
2024-09-19 14:06:56 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-19 14:06:56 - INFO - ##################################################
2024-09-19 14:06:56 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:06:56 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:06:56 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 13:50:00
2024-09-19 14:06:56 - INFO - 새로운 데이터 범위: 2024-09-18 04:50:00 ~ 2024-09-19 14:00:00
2024-09-19 14:06:56 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:06:56 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:06:56 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:06:56 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:06:56 - INFO - Sample date values: [Timestamp('2024-09-19 14:00:00')]
2024-09-19 14:06:56 - INFO - Successfully added 1 new data points
2024-09-19 14:06:56 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:06:56 - INFO - Final date range: 2024-09-19 14:00:00 to 2024-09-19 14:00:00
2024-09-19 14:06:56 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:06:56 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:00:00
2024-09-19 14:06:56 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:06:56 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:06:56 - INFO - GPT | 이전예측가격: 82960000 | 당시BTC가격: 82960000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:06:56 - INFO - ML 모델 예측 업데이트: 정확도 60.32%, 적중/전체: 38/63
2024-09-19 14:06:56 - INFO - ML | 이전예측가격: 82976592 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2429 | 반영가중치값: 0.0200 | 새 가중치: 0.2629 | 예측 총 횟수: 63 | 예측 성공 수: 38 | 예측 성공률: 60.32%
2024-09-19 14:06:56 - INFO - XGBOOST | 이전예측가격: 82960000 | 당시BTC가격: 82960000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:06:56 - INFO - LSTM 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-19 14:06:56 - INFO - LSTM | 이전예측가격: 83036291 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1357 | 반영가중치값: 0.0200 | 새 가중치: 0.1557 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-19 14:06:56 - INFO - RL 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-19 14:06:56 - INFO - RL | 이전예측가격: 83789600 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1357 | 반영가중치값: 0.0200 | 새 가중치: 0.1557 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-19 14:06:56 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.11%, 적중/전체: 97/176
2024-09-19 14:06:56 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82960000 | 예측: 하락 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0395 | 반영가중치값: -0.0200 | 새 가중치: 0.0195 | 예측 총 횟수: 176 | 예측 성공 수: 97 | 예측 성공률: 55.11%
2024-09-19 14:06:56 - INFO - PROPHET 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 4/4
2024-09-19 14:06:56 - INFO - PROPHET | 이전예측가격: 82987436 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1357 | 반영가중치값: 0.0200 | 새 가중치: 0.1557 | 예측 총 횟수: 4 | 예측 성공 수: 4 | 예측 성공률: 100.00%
2024-09-19 14:06:56 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 14/23
2024-09-19 14:06:56 - INFO - TRANSFORMER | 이전예측가격: 83050928 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2113 | 반영가중치값: 0.0200 | 새 가중치: 0.2313 | 예측 총 횟수: 23 | 예측 성공 수: 14 | 예측 성공률: 60.87%
2024-09-19 14:06:56 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 12/24
2024-09-19 14:06:57 - INFO - BITCOIN_FORECAST | 이전예측가격: 82207459 | 당시BTC가격: 82960000 | 예측: 하락 | 지금 BTC가격: 83063000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0406 | 반영가중치값: -0.0200 | 새 가중치: 0.0206 | 예측 총 횟수: 24 | 예측 성공 수: 12 | 예측 성공률: 50.00%
2024-09-19 14:06:57 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:06:57 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:06:57 - INFO - 새로운 가중치: {'gpt': 0.0030784499286385875, 'ml': 0.24846486694086187, 'xgboost': 0.050382805691038944, 'rl': 0.14719547502788236, 'lstm': 0.14719547502788236, 'arima': 0.018406682465043088, 'prophet': 0.14719547502788236, 'transformer': 0.2186204559172446, 'bitcoin_forecast': 0.019460313973525812}
2024-09-19 14:06:57 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:06:57 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:06:57 - INFO - Current BTC price: 83063000.0
2024-09-19 14:06:57 - INFO - Analyzing market conditions.
2024-09-19 14:06:57 - INFO - Market analysis: {'current_price': 83063000.0, 'sma_20': 83075350.0, 'rsi_14': 56.71841025474996, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:06:57 - INFO - Starting predictions for all models
2024-09-19 14:06:57 - INFO - Attempting prediction for gpt
2024-09-19 14:06:57 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:06:57 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:06:57 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:06:57 - INFO - GPT prediction: 83063000.0
2024-09-19 14:06:57 - INFO - Attempting prediction for ml
2024-09-19 14:06:57 - INFO - ML prediction: 83029774.8
2024-09-19 14:06:57 - INFO - Attempting prediction for xgboost
2024-09-19 14:06:57 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:06:57 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:06:57 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:06:57 - INFO - XGBOOST prediction: 83063000.0
2024-09-19 14:06:57 - INFO - Attempting prediction for lstm
2024-09-19 14:06:57 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:06:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:06:57 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:06:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:06:57 - INFO - X 샘플:
[[ 1.74561223  1.43299556  0.6210502   0.73222129  0.14432808  0.14765373
   0.73222129]
 [ 0.87973315  1.43299556  1.25155802  1.14668617  0.04294176  0.04831024
   1.14668617]
 [ 0.34288812  0.14230672  0.6210502   0.33901102 -0.71859783 -0.7178884
   0.33901102]
 [ 0.44679361  0.73800926  0.81020255  0.80661242  0.80079402  0.80673685
   0.80661242]
 [ 0.18702988  0.10921213  0.72613484  0.72159398 -0.65463927 -0.65409231
   0.72159398]
 [ 0.23032384 -0.44236429 -1.12335476 -1.68017686  2.3454642   2.34242786
  -1.68017686]
 [-1.63997498 -1.73305313 -1.58572717 -1.61641303  0.45315581  0.44595315
  -1.61641303]
 [-1.70924531 -1.09322448 -1.54369331 -0.8618744  -0.57107352 -0.57594197
  -0.8618744 ]
 [-0.3931091  -0.90568849 -0.27216921 -0.34113648 -1.49619614 -1.49849818
  -0.34113648]
 [-0.09005142  0.31881117  0.49494864  0.7534759  -0.3461771  -0.34466097
   0.7534759 ]]
2024-09-19 14:06:57 - INFO - y 샘플:
[0.7534759]
2024-09-19 14:06:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:06:57 - INFO - 모델 출력 (스케일링된 예측): [[0.25680542]]
2024-09-19 14:06:57 - INFO - 스케일러 역변환 후 예측 가격: 83016264.68044622
2024-09-19 14:06:57 - INFO - LSTMPredictor 최종 예측 가격: 83016264.68044622
2024-09-19 14:06:57 - INFO - LSTM prediction: 83016264.68044622
2024-09-19 14:06:57 - INFO - Attempting prediction for rl
2024-09-19 14:06:57 - INFO - Preparing state for RL agent.
2024-09-19 14:06:57 - INFO - Prepared state: [[8.30630000e+07 1.35540695e+01 1.24156220e-03 8.30753500e+07
  5.67184103e+01]]
2024-09-19 14:06:57 - INFO - RL prediction: 83893630.0
2024-09-19 14:06:57 - INFO - Attempting prediction for arima
2024-09-19 14:06:57 - INFO - ARIMA 예측 시작
2024-09-19 14:06:57 - INFO - 입력 데이터: {'open': 82988000.0, 'high': 83099000.0, 'low': 82988000.0, 'close': 83063000.0, 'volume': 13.55406951, 'value': 1125536377.68259, 'decision': 'sell', 'sma': 83075350.0, 'ema': 82957393.17986506, 'rsi': 56.71841025474996, 'macd': 121246.94975176454, 'signal_line': 192185.3409195082, 'BB_Upper': 83357861.07943161, 'BB_Lower': 82792838.92056839}
2024-09-19 14:06:57 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:06:57 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83075350.0         0         0
2024-09-19 14:06:57 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83075350.0         0         0
2024-09-19 14:06:57 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:06:57 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:06:57 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:06:57 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:06:57 - INFO - Attempting prediction for prophet
2024-09-19 14:06:57 - INFO - PROPHET prediction: 83108068.66266575
2024-09-19 14:06:57 - INFO - Attempting prediction for transformer
2024-09-19 14:06:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:06:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:06:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:06:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:06:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:06:57 - INFO - X 샘플:
[[ 1.74561223  1.43299556  0.6210502   0.73222129  0.14432808  0.14765373
   0.73222129  0.73222129  0.          0.          0.          0.73222129
   0.73222129]
 [ 0.87973315  1.43299556  1.25155802  1.14668617  0.04294176  0.04831024
   1.14668617  1.14668617  0.          0.          0.          1.14668617
   1.14668617]
 [ 0.34288812  0.14230672  0.6210502   0.33901102 -0.71859783 -0.7178884
   0.33901102  0.33901102  0.          0.          0.          0.33901102
   0.33901102]
 [ 0.44679361  0.73800926  0.81020255  0.80661242  0.80079402  0.80673685
   0.80661242  0.80661242  0.          0.          0.          0.80661242
   0.80661242]
 [ 0.18702988  0.10921213  0.72613484  0.72159398 -0.65463927 -0.65409231
   0.72159398  0.72159398  0.          0.          0.          0.72159398
   0.72159398]
 [ 0.23032384 -0.44236429 -1.12335476 -1.68017686  2.3454642   2.34242786
  -1.68017686 -1.68017686  0.          0.          0.         -1.68017686
  -1.68017686]
 [-1.63997498 -1.73305313 -1.58572717 -1.61641303  0.45315581  0.44595315
  -1.61641303 -1.61641303  0.          0.          0.         -1.61641303
  -1.61641303]
 [-1.70924531 -1.09322448 -1.54369331 -0.8618744  -0.57107352 -0.57594197
  -0.8618744  -0.8618744   0.          0.          0.         -0.8618744
  -0.8618744 ]
 [-0.3931091  -0.90568849 -0.27216921 -0.34113648 -1.49619614 -1.49849818
  -0.34113648 -0.34113648  0.          0.          0.         -0.34113648
  -0.34113648]
 [-0.09005142  0.31881117  0.49494864  0.7534759  -0.3461771  -0.34466097
   0.7534759   0.7534759   0.          0.          0.          0.7534759
   0.7534759 ]]
2024-09-19 14:06:57 - INFO - y 샘플:
[0.7534759]
2024-09-19 14:06:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:06:57 - INFO - 모델 출력 (스케일링된 예측): [0.36395466]
2024-09-19 14:06:57 - INFO - 스케일러 역변환 후 예측 가격: 83026347.12818626
2024-09-19 14:06:57 - INFO - TransformerPredictor 최종 예측 가격: 83026347.12818626
2024-09-19 14:06:57 - INFO - TRANSFORMER prediction: 83026347.12818626
2024-09-19 14:06:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:06:57 - INFO - BITCOIN_FORECAST prediction: 82252661.15952592
2024-09-19 14:06:57 - INFO - BitcoinForecast prediction: 82252661.15952592
2024-09-19 14:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:07:09 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:07:09 - INFO - 조정된 모델 가중치: {'gpt': 0.0030784499286385875, 'ml': 0.24846486694086187, 'xgboost': 0.050382805691038944, 'rl': 0.14719547502788236, 'lstm': 0.14719547502788236, 'arima': 0.018406682465043088, 'prophet': 0.14719547502788236, 'transformer': 0.2186204559172446, 'bitcoin_forecast': 0.019460313973525812}
2024-09-19 14:07:09 - INFO - 조정된 모델 가중치: {'gpt': 0.0030784499286385875, 'ml': 0.24846486694086187, 'xgboost': 0.050382805691038944, 'rl': 0.14719547502788236, 'lstm': 0.14719547502788236, 'arima': 0.018406682465043088, 'prophet': 0.14719547502788236, 'transformer': 0.2186204559172446, 'bitcoin_forecast': 0.019460313973525812}
2024-09-19 14:07:09 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83113149.78151147, 'current_price': 83063000.0, 'predictions': {'gpt': 83063000.0, 'ml': 83029774.8, 'xgboost': 83063000.0, 'lstm': 83016264.68044622, 'rl': 83893630.0, 'arima': 80899000.0, 'prophet': 83108068.66266575, 'transformer': 83026347.12818626, 'bitcoin_forecast': 82252661.15952592}, 'weights': {'gpt': 0.0030784499286385875, 'ml': 0.24846486694086187, 'xgboost': 0.050382805691038944, 'rl': 0.14719547502788236, 'lstm': 0.14719547502788236, 'arima': 0.018406682465043088, 'prophet': 0.14719547502788236, 'transformer': 0.2186204559172446, 'bitcoin_forecast': 0.019460313973525812}}
2024-09-19 14:07:09 - INFO - 모델별 가중치:
2024-09-19 14:07:09 - INFO -   - GPT: 0.0031
2024-09-19 14:07:09 - INFO -   - ML: 0.2485
2024-09-19 14:07:09 - INFO -   - XGBOOST: 0.0504
2024-09-19 14:07:09 - INFO -   - RL: 0.1472
2024-09-19 14:07:09 - INFO -   - LSTM: 0.1472
2024-09-19 14:07:09 - INFO -   - ARIMA: 0.0184
2024-09-19 14:07:09 - INFO -   - PROPHET: 0.1472
2024-09-19 14:07:09 - INFO -   - TRANSFORMER: 0.2186
2024-09-19 14:07:09 - INFO -   - BITCOIN_FORECAST: 0.0195
2024-09-19 14:07:09 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:07:09 - INFO - 6. 거래 실행
2024-09-19 14:07:09 - INFO - Cancelling existing orders.
2024-09-19 14:07:09 - INFO - Cancelled 0 orders.
2024-09-19 14:07:09 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83113149.78151147, 'current_price': 83063000.0, 'predictions': {'gpt': 83063000.0, 'ml': 83029774.8, 'xgboost': 83063000.0, 'lstm': 83016264.68044622, 'rl': 83893630.0, 'arima': 80899000.0, 'prophet': 83108068.66266575, 'transformer': 83026347.12818626, 'bitcoin_forecast': 82252661.15952592}, 'weights': {'gpt': 0.0030784499286385875, 'ml': 0.24846486694086187, 'xgboost': 0.050382805691038944, 'rl': 0.14719547502788236, 'lstm': 0.14719547502788236, 'arima': 0.018406682465043088, 'prophet': 0.14719547502788236, 'transformer': 0.2186204559172446, 'bitcoin_forecast': 0.019460313973525812}}, 현재 가격=83063000.0
2024-09-19 14:07:09 - INFO - 현재 잔고: KRW=277594.24796519, BTC=0.00240175, 총 자산가치=477090.80821518996
2024-09-19 14:07:09 - INFO - 매수 시도: 0.0005743722333833235 BTC (약 47709.080821519 KRW)
2024-09-19 14:07:09 - INFO - 주문 결과: {'uuid': 'e05f70f6-90bb-473f-b2d2-f35040887634', 'side': 'bid', 'ord_type': 'limit', 'price': '83063000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:07:11+09:00', 'volume': '0.00057437', 'remaining_volume': '0.00057437', 'reserved_fee': '23.854447655', 'remaining_fee': '23.854447655', 'paid_fee': '0', 'locked': '47732.749757655', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:07:09 - INFO - buy 주문 성공: UUID=e05f70f6-90bb-473f-b2d2-f35040887634
2024-09-19 14:07:09 - INFO - Trade executed successfully.
2024-09-19 14:07:09 - INFO - 7. summary 리포트 보내기
2024-09-19 14:07:10 - INFO - Message sent to Discord successfully.
2024-09-19 14:07:10 - INFO - Trading cycle completed.
2024-09-19 14:07:10 - INFO - Performing periodic update.
2024-09-19 14:07:10 - INFO - 계산된 시장 변동성: 0.03849163367329687
2024-09-19 14:15:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:15:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8104-b696-e31c73ec5819 "HTTP/1.1 200 OK"
2024-09-19 14:15:49 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-96f4-c21423051bf5 "HTTP/1.1 200 OK"
2024-09-19 14:15:55 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-b5d5-c1fd515fa1c2 "HTTP/1.1 200 OK"
2024-09-19 14:16:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-b9d2-d1bbc243663c "HTTP/1.1 200 OK"
2024-09-19 14:16:13 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8137-9620-c8546ca3327c "HTTP/1.1 200 OK"
2024-09-19 14:16:18 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-972a-c5aef880e77a "HTTP/1.1 200 OK"
2024-09-19 14:16:25 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/1b5b8c41-94eb-4a21-949e-8a60861b60ae "HTTP/1.1 200 OK"
2024-09-19 14:16:31 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816a-99fc-ea3308a3ec79 "HTTP/1.1 200 OK"
2024-09-19 14:16:42 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:16:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/81178332-471c-45c3-af42-a73aa35ea870 "HTTP/1.1 200 OK"
2024-09-19 14:16:55 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:05:34.924152
2024-09-19 14:16:55 - INFO - Starting trading cycle.
2024-09-19 14:16:55 - INFO - ##################################################
2024-09-19 14:16:55 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-19 14:16:55 - INFO - ##################################################
2024-09-19 14:16:55 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:16:55 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:16:55 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:00:00
2024-09-19 14:16:56 - INFO - 새로운 데이터 범위: 2024-09-18 05:00:00 ~ 2024-09-19 14:10:00
2024-09-19 14:16:56 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:16:56 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:16:56 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:16:56 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:16:56 - INFO - Sample date values: [Timestamp('2024-09-19 14:10:00')]
2024-09-19 14:16:56 - INFO - Successfully added 1 new data points
2024-09-19 14:16:56 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:16:56 - INFO - Final date range: 2024-09-19 14:10:00 to 2024-09-19 14:10:00
2024-09-19 14:16:56 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:16:56 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:10:00
2024-09-19 14:16:56 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:16:56 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:16:56 - INFO - GPT | 이전예측가격: 83063000 | 당시BTC가격: 83063000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:16:56 - INFO - ML 모델 예측 업데이트: 정확도 60.94%, 적중/전체: 39/64
2024-09-19 14:16:56 - INFO - ML | 이전예측가격: 83029775 | 당시BTC가격: 83063000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2344 | 반영가중치값: 0.0200 | 새 가중치: 0.2544 | 예측 총 횟수: 64 | 예측 성공 수: 39 | 예측 성공률: 60.94%
2024-09-19 14:16:56 - INFO - XGBOOST | 이전예측가격: 83063000 | 당시BTC가격: 83063000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:16:56 - INFO - LSTM 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 4/5
2024-09-19 14:16:56 - INFO - LSTM | 이전예측가격: 83016265 | 당시BTC가격: 83063000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1190 | 반영가중치값: 0.0200 | 새 가중치: 0.1390 | 예측 총 횟수: 5 | 예측 성공 수: 4 | 예측 성공률: 80.00%
2024-09-19 14:16:56 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-19 14:16:56 - INFO - RL | 이전예측가격: 83893630 | 당시BTC가격: 83063000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1192 | 반영가중치값: -0.0200 | 새 가중치: 0.0992 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-19 14:16:56 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.37%, 적중/전체: 98/177
2024-09-19 14:16:56 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83063000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1238 | 반영가중치값: 0.0200 | 새 가중치: 0.1438 | 예측 총 횟수: 177 | 예측 성공 수: 98 | 예측 성공률: 55.37%
2024-09-19 14:16:56 - INFO - PROPHET 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 4/5
2024-09-19 14:16:56 - INFO - PROPHET | 이전예측가격: 83108069 | 당시BTC가격: 83063000 | 예측: 상승 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1069 | 반영가중치값: -0.0200 | 새 가중치: 0.0869 | 예측 총 횟수: 5 | 예측 성공 수: 4 | 예측 성공률: 80.00%
2024-09-19 14:16:56 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-19 14:16:56 - INFO - TRANSFORMER | 이전예측가격: 83026347 | 당시BTC가격: 83063000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1458 | 반영가중치값: 0.0200 | 새 가중치: 0.1658 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-19 14:16:56 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.00%, 적중/전체: 13/25
2024-09-19 14:16:56 - INFO - BITCOIN_FORECAST | 이전예측가격: 82252661 | 당시BTC가격: 83063000 | 예측: 하락 | 지금 BTC가격: 82960000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0942 | 반영가중치값: 0.0200 | 새 가중치: 0.1142 | 예측 총 횟수: 25 | 예측 성공 수: 13 | 예측 성공률: 52.00%
2024-09-19 14:16:56 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:16:56 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:16:56 - INFO - 새로운 가중치: {'gpt': 0.0029127112304837576, 'ml': 0.2406781217957857, 'xgboost': 0.047670278016985326, 'rl': 0.09387335815225491, 'lstm': 0.13153155578445797, 'arima': 0.13606953734763488, 'prophet': 0.08226412925510417, 'transformer': 0.1569112601465044, 'bitcoin_forecast': 0.10808904827078895}
2024-09-19 14:16:56 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:16:56 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:16:56 - INFO - Current BTC price: 82960000.0
2024-09-19 14:16:56 - INFO - Analyzing market conditions.
2024-09-19 14:16:56 - INFO - Market analysis: {'current_price': 82960000.0, 'sma_20': 83070850.0, 'rsi_14': 53.012810057719705, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:16:56 - INFO - Starting predictions for all models
2024-09-19 14:16:56 - INFO - Attempting prediction for gpt
2024-09-19 14:16:57 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:16:57 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:16:57 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:16:57 - INFO - GPT prediction: 82960000.0
2024-09-19 14:16:57 - INFO - Attempting prediction for ml
2024-09-19 14:16:57 - INFO - ML prediction: 82976592.0
2024-09-19 14:16:57 - INFO - Attempting prediction for xgboost
2024-09-19 14:16:57 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:16:57 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:16:57 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:16:57 - INFO - XGBOOST prediction: 82960000.0
2024-09-19 14:16:57 - INFO - Attempting prediction for lstm
2024-09-19 14:16:57 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:16:57 - INFO - X 샘플:
[[ 1.28947401  1.8242623   1.32467134  1.28897487  0.22391667  0.22891806
   1.28897487]
 [ 0.63147081  0.35632084  0.681627    0.45878767 -0.42708808 -0.42595645
   0.45878767]
 [ 0.75882627  1.03383228  0.87454031  0.93942236  0.8717693   0.87714977
   0.93942236]
 [ 0.44043762  0.31868131  0.78880106  0.85203424 -0.37241288 -0.37142956
   0.85203424]
 [ 0.4935024  -0.3086441  -1.09746234 -1.61668035  2.19223594  2.18971395
  -1.61668035]
 [-1.79889584 -1.77658557 -1.56902819 -1.55113925  0.57458957  0.56878581
  -1.55113925]
 [-1.88379948 -1.04888809 -1.52615857 -0.77556963 -0.30097642 -0.304634
  -0.77556963]
 [-0.27063035 -0.83559745 -0.22935248 -0.24031735 -1.09182069 -1.09314825
  -0.24031735]
 [ 0.10082307  0.55706497  0.55301813  0.88480478 -0.10872293 -0.10695676
   0.88480478]
 [ 0.23879148 -0.12044648  0.19934375 -0.24031735 -1.56149048 -1.56244257
  -0.24031735]]
2024-09-19 14:16:57 - INFO - y 샘플:
[-0.24031735]
2024-09-19 14:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:16:57 - INFO - 모델 출력 (스케일링된 예측): [[0.28213435]]
2024-09-19 14:16:57 - INFO - 스케일러 역변환 후 예측 가격: 83007828.16353677
2024-09-19 14:16:57 - INFO - LSTMPredictor 최종 예측 가격: 83007828.16353677
2024-09-19 14:16:57 - INFO - LSTM prediction: 83007828.16353677
2024-09-19 14:16:57 - INFO - Attempting prediction for rl
2024-09-19 14:16:57 - INFO - Preparing state for RL agent.
2024-09-19 14:16:57 - INFO - Prepared state: [[ 8.29600000e+07  6.03584594e+00 -1.24002263e-03  8.30708500e+07
   5.30128101e+01]]
2024-09-19 14:16:57 - INFO - RL prediction: 83789600.0
2024-09-19 14:16:57 - INFO - Attempting prediction for arima
2024-09-19 14:16:57 - INFO - ARIMA 예측 시작
2024-09-19 14:16:57 - INFO - 입력 데이터: {'open': 83001000.0, 'high': 83045000.0, 'low': 82955000.0, 'close': 82960000.0, 'volume': 6.03584594, 'value': 500969263.32173, 'decision': 'sell', 'sma': 83070850.0, 'ema': 82957641.44844934, 'rsi': 53.012810057719705, 'macd': 108973.9633217454, 'signal_line': 175543.06539995564, 'BB_Upper': 83357667.20659372, 'BB_Lower': 82784032.79340628}
2024-09-19 14:16:57 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:16:57 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83070850.0         0         0
2024-09-19 14:16:57 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83070850.0         0         0
2024-09-19 14:16:57 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:16:57 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:16:57 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:16:57 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:16:57 - INFO - Attempting prediction for prophet
2024-09-19 14:16:57 - INFO - PROPHET prediction: 82982756.23439576
2024-09-19 14:16:57 - INFO - Attempting prediction for transformer
2024-09-19 14:16:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:16:57 - INFO - X 샘플:
[[ 1.28947401  1.8242623   1.32467134  1.28897487  0.22391667  0.22891806
   1.28897487  1.28897487  0.          0.          0.          1.28897487
   1.28897487]
 [ 0.63147081  0.35632084  0.681627    0.45878767 -0.42708808 -0.42595645
   0.45878767  0.45878767  0.          0.          0.          0.45878767
   0.45878767]
 [ 0.75882627  1.03383228  0.87454031  0.93942236  0.8717693   0.87714977
   0.93942236  0.93942236  0.          0.          0.          0.93942236
   0.93942236]
 [ 0.44043762  0.31868131  0.78880106  0.85203424 -0.37241288 -0.37142956
   0.85203424  0.85203424  0.          0.          0.          0.85203424
   0.85203424]
 [ 0.4935024  -0.3086441  -1.09746234 -1.61668035  2.19223594  2.18971395
  -1.61668035 -1.61668035  0.          0.          0.         -1.61668035
  -1.61668035]
 [-1.79889584 -1.77658557 -1.56902819 -1.55113925  0.57458957  0.56878581
  -1.55113925 -1.55113925  0.          0.          0.         -1.55113925
  -1.55113925]
 [-1.88379948 -1.04888809 -1.52615857 -0.77556963 -0.30097642 -0.304634
  -0.77556963 -0.77556963  0.          0.          0.         -0.77556963
  -0.77556963]
 [-0.27063035 -0.83559745 -0.22935248 -0.24031735 -1.09182069 -1.09314825
  -0.24031735 -0.24031735  0.          0.          0.         -0.24031735
  -0.24031735]
 [ 0.10082307  0.55706497  0.55301813  0.88480478 -0.10872293 -0.10695676
   0.88480478  0.88480478  0.          0.          0.          0.88480478
   0.88480478]
 [ 0.23879148 -0.12044648  0.19934375 -0.24031735 -1.56149048 -1.56244257
  -0.24031735 -0.24031735  0.          0.          0.         -0.24031735
  -0.24031735]]
2024-09-19 14:16:57 - INFO - y 샘플:
[-0.24031735]
2024-09-19 14:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:16:57 - INFO - 모델 출력 (스케일링된 예측): [0.3642421]
2024-09-19 14:16:57 - INFO - 스케일러 역변환 후 예측 가격: 83015344.76840913
2024-09-19 14:16:57 - INFO - TransformerPredictor 최종 예측 가격: 83015344.76840913
2024-09-19 14:16:57 - INFO - TRANSFORMER prediction: 83015344.76840913
2024-09-19 14:16:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:16:57 - INFO - BITCOIN_FORECAST prediction: 82185317.05193989
2024-09-19 14:16:57 - INFO - BitcoinForecast prediction: 82185317.05193989
2024-09-19 14:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:17:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:17:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0029127112304837576, 'ml': 0.2406781217957857, 'xgboost': 0.047670278016985326, 'rl': 0.09387335815225491, 'lstm': 0.13153155578445797, 'arima': 0.13606953734763488, 'prophet': 0.08226412925510417, 'transformer': 0.1569112601465044, 'bitcoin_forecast': 0.10808904827078895}
2024-09-19 14:17:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0029127112304837576, 'ml': 0.2406781217957857, 'xgboost': 0.047670278016985326, 'rl': 0.09387335815225491, 'lstm': 0.13153155578445797, 'arima': 0.13606953734763488, 'prophet': 0.08226412925510417, 'transformer': 0.1569112601465044, 'bitcoin_forecast': 0.10808904827078895}
2024-09-19 14:17:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82694543.76220064, 'current_price': 82960000.0, 'predictions': {'gpt': 82960000.0, 'ml': 82976592.0, 'xgboost': 82960000.0, 'lstm': 83007828.16353677, 'rl': 83789600.0, 'arima': 80899000.0, 'prophet': 82982756.23439576, 'transformer': 83015344.76840913, 'bitcoin_forecast': 82185317.05193989}, 'weights': {'gpt': 0.0029127112304837576, 'ml': 0.2406781217957857, 'xgboost': 0.047670278016985326, 'rl': 0.09387335815225491, 'lstm': 0.13153155578445797, 'arima': 0.13606953734763488, 'prophet': 0.08226412925510417, 'transformer': 0.1569112601465044, 'bitcoin_forecast': 0.10808904827078895}}
2024-09-19 14:17:07 - INFO - 모델별 가중치:
2024-09-19 14:17:07 - INFO -   - GPT: 0.0029
2024-09-19 14:17:07 - INFO -   - ML: 0.2407
2024-09-19 14:17:07 - INFO -   - XGBOOST: 0.0477
2024-09-19 14:17:07 - INFO -   - RL: 0.0939
2024-09-19 14:17:07 - INFO -   - LSTM: 0.1315
2024-09-19 14:17:07 - INFO -   - ARIMA: 0.1361
2024-09-19 14:17:07 - INFO -   - PROPHET: 0.0823
2024-09-19 14:17:07 - INFO -   - TRANSFORMER: 0.1569
2024-09-19 14:17:07 - INFO -   - BITCOIN_FORECAST: 0.1081
2024-09-19 14:17:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:17:07 - INFO - 6. 거래 실행
2024-09-19 14:17:07 - INFO - Cancelling existing orders.
2024-09-19 14:17:07 - INFO - Cancelled 0 orders.
2024-09-19 14:17:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82694543.76220064, 'current_price': 82960000.0, 'predictions': {'gpt': 82960000.0, 'ml': 82976592.0, 'xgboost': 82960000.0, 'lstm': 83007828.16353677, 'rl': 83789600.0, 'arima': 80899000.0, 'prophet': 82982756.23439576, 'transformer': 83015344.76840913, 'bitcoin_forecast': 82185317.05193989}, 'weights': {'gpt': 0.0029127112304837576, 'ml': 0.2406781217957857, 'xgboost': 0.047670278016985326, 'rl': 0.09387335815225491, 'lstm': 0.13153155578445797, 'arima': 0.13606953734763488, 'prophet': 0.08226412925510417, 'transformer': 0.1569112601465044, 'bitcoin_forecast': 0.10808904827078895}}, 현재 가격=82960000.0
2024-09-19 14:17:07 - INFO - 현재 잔고: KRW=229887.93243804, BTC=0.00297612, 총 자산가치=476786.84763804
2024-09-19 14:17:07 - INFO - 매도 시도: 0.00029761200000000005 BTC (약 24689.891520000005 KRW)
2024-09-19 14:17:07 - INFO - 주문 결과: {'uuid': 'fd9c3779-d53f-4971-898f-1a72f5b9fcf1', 'side': 'ask', 'ord_type': 'limit', 'price': '82960000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:17:09+09:00', 'volume': '0.00029761', 'remaining_volume': '0.00029761', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00029761', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:17:07 - INFO - sell 주문 성공: UUID=fd9c3779-d53f-4971-898f-1a72f5b9fcf1
2024-09-19 14:17:07 - INFO - Trade executed successfully.
2024-09-19 14:17:07 - INFO - 7. summary 리포트 보내기
2024-09-19 14:17:08 - INFO - Message sent to Discord successfully.
2024-09-19 14:17:08 - INFO - Trading cycle completed.
2024-09-19 14:17:08 - INFO - Performing periodic update.
2024-09-19 14:17:08 - INFO - 계산된 시장 변동성: 0.03848008960041655
2024-09-19 14:25:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:25:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-abb0-f1da0ad5f76f "HTTP/1.1 200 OK"
2024-09-19 14:25:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ae-979a-d18afaa6ca61 "HTTP/1.1 200 OK"
2024-09-19 14:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810a-ac1d-e478093c95f7 "HTTP/1.1 200 OK"
2024-09-19 14:25:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:25:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:25:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-8569-e997e5ddc43e "HTTP/1.1 200 OK"
2024-09-19 14:25:59 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:26:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-b5c6-c03a39456b50 "HTTP/1.1 200 OK"
2024-09-19 14:26:07 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8158-b186-d69064bd83a3 "HTTP/1.1 200 OK"
2024-09-19 14:26:13 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:26:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e4-9866-d7acc4dd625d "HTTP/1.1 200 OK"
2024-09-19 14:26:21 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:26:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-9ba8-e7129044baac "HTTP/1.1 200 OK"
2024-09-19 14:26:26 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:26:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811e-97d8-f0182d2749d2 "HTTP/1.1 200 OK"
2024-09-19 14:26:33 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:15:34.924550
2024-09-19 14:26:33 - INFO - Starting trading cycle.
2024-09-19 14:26:33 - INFO - ##################################################
2024-09-19 14:26:33 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-19 14:26:33 - INFO - ##################################################
2024-09-19 14:26:33 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:26:33 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:26:33 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:10:00
2024-09-19 14:26:33 - INFO - 새로운 데이터 범위: 2024-09-18 05:10:00 ~ 2024-09-19 14:20:00
2024-09-19 14:26:33 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:26:33 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:26:33 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:26:33 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:26:33 - INFO - Sample date values: [Timestamp('2024-09-19 14:20:00')]
2024-09-19 14:26:33 - INFO - Successfully added 1 new data points
2024-09-19 14:26:33 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:26:33 - INFO - Final date range: 2024-09-19 14:20:00 to 2024-09-19 14:20:00
2024-09-19 14:26:33 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:26:33 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:20:00
2024-09-19 14:26:33 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:26:34 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:26:34 - INFO - GPT | 이전예측가격: 82960000 | 당시BTC가격: 82960000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:26:34 - INFO - ML 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 39/65
2024-09-19 14:26:34 - INFO - ML | 이전예측가격: 82976592 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2485 | 반영가중치값: -0.0200 | 새 가중치: 0.2285 | 예측 총 횟수: 65 | 예측 성공 수: 39 | 예측 성공률: 60.00%
2024-09-19 14:26:34 - INFO - XGBOOST | 이전예측가격: 82960000 | 당시BTC가격: 82960000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:26:34 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-19 14:26:34 - INFO - LSTM | 이전예측가격: 83007828 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1472 | 반영가중치값: -0.0200 | 새 가중치: 0.1272 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-19 14:26:34 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-19 14:26:34 - INFO - RL | 이전예측가격: 83789600 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1472 | 반영가중치값: -0.0200 | 새 가중치: 0.1272 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-19 14:26:34 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.62%, 적중/전체: 99/178
2024-09-19 14:26:34 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82960000 | 예측: 하락 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0184 | 반영가중치값: 0.0200 | 새 가중치: 0.0384 | 예측 총 횟수: 178 | 예측 성공 수: 99 | 예측 성공률: 55.62%
2024-09-19 14:26:34 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-19 14:26:34 - INFO - PROPHET | 이전예측가격: 82982756 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1472 | 반영가중치값: -0.0200 | 새 가중치: 0.1272 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-19 14:26:34 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 15/25
2024-09-19 14:26:34 - INFO - TRANSFORMER | 이전예측가격: 83015345 | 당시BTC가격: 82960000 | 예측: 상승 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2186 | 반영가중치값: -0.0200 | 새 가중치: 0.1986 | 예측 총 횟수: 25 | 예측 성공 수: 15 | 예측 성공률: 60.00%
2024-09-19 14:26:34 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 14/26
2024-09-19 14:26:34 - INFO - BITCOIN_FORECAST | 이전예측가격: 82185317 | 당시BTC가격: 82960000 | 예측: 하락 | 지금 BTC가격: 82934000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0195 | 반영가중치값: 0.0200 | 새 가중치: 0.0395 | 예측 총 횟수: 26 | 예측 성공 수: 14 | 예측 성공률: 53.85%
2024-09-19 14:26:34 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:26:34 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:26:34 - INFO - 새로운 가중치: {'gpt': 0.003108146066795454, 'ml': 0.24379422517118157, 'xgboost': 0.05086882131358094, 'rl': 0.13572993823916818, 'lstm': 0.13572993823916818, 'arima': 0.04098366422082955, 'prophet': 0.13572993823916818, 'transformer': 0.21194733703202448, 'bitcoin_forecast': 0.042107991478083424}
2024-09-19 14:26:34 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:26:34 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:26:34 - INFO - Current BTC price: 82934000.0
2024-09-19 14:26:34 - INFO - Analyzing market conditions.
2024-09-19 14:26:34 - INFO - Market analysis: {'current_price': 82934000.0, 'sma_20': 83072700.0, 'rsi_14': 52.08770607746193, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:26:34 - INFO - Starting predictions for all models
2024-09-19 14:26:34 - INFO - Attempting prediction for gpt
2024-09-19 14:26:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:26:34 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:26:34 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:26:34 - INFO - GPT prediction: 82934000.0
2024-09-19 14:26:34 - INFO - Attempting prediction for ml
2024-09-19 14:26:34 - INFO - ML prediction: 82950586.8
2024-09-19 14:26:34 - INFO - Attempting prediction for xgboost
2024-09-19 14:26:34 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:26:34 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:26:34 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:26:34 - INFO - XGBOOST prediction: 82934000.0
2024-09-19 14:26:34 - INFO - Attempting prediction for lstm
2024-09-19 14:26:34 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:26:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:26:34 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:26:34 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:26:34 - INFO - X 샘플:
[[ 0.85080904  0.76701341  0.93996477  0.70327112 -0.22548258 -0.22383449
   0.70327112]
 [ 0.99182711  1.59044728  1.15467754  1.23132452  0.9559181   0.96139465
   1.23132452]
 [ 0.63928193  0.72126708  1.05924964  1.13531481 -0.1757517  -0.17424002
   1.13531481]
 [ 0.69803946 -0.04117169 -1.04016406 -1.57695947  2.15697389  2.1552262
  -1.57695947]
 [-1.84028585 -1.82527842 -1.56501749 -1.50495219  0.68561257  0.68092484
  -1.50495219]
 [-1.9342979  -0.94084945 -1.51730354 -0.65286602 -0.11077529 -0.11348669
  -0.65286602]
 [-0.14806898 -0.68162026 -0.07395662 -0.06480655 -0.83010289 -0.83067309
  -0.06480655]
 [ 0.26323374  1.01099381  0.79682293  1.17131845  0.06409256  0.06630896
   1.17131845]
 [ 0.41600331  0.18755994  0.40318286 -0.06480655 -1.25730007 -1.25751574
  -0.06480655]
 [ 0.06345813 -0.78836169 -0.15745603 -0.37683811 -1.26318458 -1.26410463
  -0.37683811]]
2024-09-19 14:26:34 - INFO - y 샘플:
[-0.37683811]
2024-09-19 14:26:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:26:34 - INFO - 모델 출력 (스케일링된 예측): [[0.30477512]]
2024-09-19 14:26:34 - INFO - 스케일러 역변환 후 예측 가격: 82990795.35820079
2024-09-19 14:26:34 - INFO - LSTMPredictor 최종 예측 가격: 82990795.35820079
2024-09-19 14:26:34 - INFO - LSTM prediction: 82990795.35820079
2024-09-19 14:26:34 - INFO - Attempting prediction for rl
2024-09-19 14:26:34 - INFO - Preparing state for RL agent.
2024-09-19 14:26:34 - INFO - Prepared state: [[ 8.29340000e+07  6.00236529e+00 -3.13404050e-04  8.30727000e+07
   5.20877061e+01]]
2024-09-19 14:26:34 - INFO - RL prediction: 83763340.0
2024-09-19 14:26:34 - INFO - Attempting prediction for arima
2024-09-19 14:26:34 - INFO - ARIMA 예측 시작
2024-09-19 14:26:34 - INFO - 입력 데이터: {'open': 82971000.0, 'high': 82981000.0, 'low': 82908000.0, 'close': 82934000.0, 'volume': 6.00236529, 'value': 497860688.15969, 'decision': 'sell', 'sma': 83072700.0, 'ema': 82955389.88193037, 'rsi': 52.08770607746193, 'macd': 96042.43306094408, 'signal_line': 159642.9389321533, 'BB_Upper': 83355456.50301668, 'BB_Lower': 82789943.49698332}
2024-09-19 14:26:34 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:26:34 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83072700.0         0         0
2024-09-19 14:26:34 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83072700.0         0         0
2024-09-19 14:26:34 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:26:34 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:26:34 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:26:34 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:26:34 - INFO - Attempting prediction for prophet
2024-09-19 14:26:34 - INFO - PROPHET prediction: 82951815.19786546
2024-09-19 14:26:34 - INFO - Attempting prediction for transformer
2024-09-19 14:26:34 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:26:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:26:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:26:34 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:26:34 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:26:34 - INFO - X 샘플:
[[ 0.85080904  0.76701341  0.93996477  0.70327112 -0.22548258 -0.22383449
   0.70327112  0.70327112  0.          0.          0.          0.70327112
   0.70327112]
 [ 0.99182711  1.59044728  1.15467754  1.23132452  0.9559181   0.96139465
   1.23132452  1.23132452  0.          0.          0.          1.23132452
   1.23132452]
 [ 0.63928193  0.72126708  1.05924964  1.13531481 -0.1757517  -0.17424002
   1.13531481  1.13531481  0.          0.          0.          1.13531481
   1.13531481]
 [ 0.69803946 -0.04117169 -1.04016406 -1.57695947  2.15697389  2.1552262
  -1.57695947 -1.57695947  0.          0.          0.         -1.57695947
  -1.57695947]
 [-1.84028585 -1.82527842 -1.56501749 -1.50495219  0.68561257  0.68092484
  -1.50495219 -1.50495219  0.          0.          0.         -1.50495219
  -1.50495219]
 [-1.9342979  -0.94084945 -1.51730354 -0.65286602 -0.11077529 -0.11348669
  -0.65286602 -0.65286602  0.          0.          0.         -0.65286602
  -0.65286602]
 [-0.14806898 -0.68162026 -0.07395662 -0.06480655 -0.83010289 -0.83067309
  -0.06480655 -0.06480655  0.          0.          0.         -0.06480655
  -0.06480655]
 [ 0.26323374  1.01099381  0.79682293  1.17131845  0.06409256  0.06630896
   1.17131845  1.17131845  0.          0.          0.          1.17131845
   1.17131845]
 [ 0.41600331  0.18755994  0.40318286 -0.06480655 -1.25730007 -1.25751574
  -0.06480655 -0.06480655  0.          0.          0.         -0.06480655
  -0.06480655]
 [ 0.06345813 -0.78836169 -0.15745603 -0.37683811 -1.26318458 -1.26410463
  -0.37683811 -0.37683811  0.          0.          0.         -0.37683811
  -0.37683811]]
2024-09-19 14:26:34 - INFO - y 샘플:
[-0.37683811]
2024-09-19 14:26:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:26:34 - INFO - 모델 출력 (스케일링된 예측): [0.36690256]
2024-09-19 14:26:34 - INFO - 스케일러 역변환 후 예측 가격: 82995972.12141107
2024-09-19 14:26:34 - INFO - TransformerPredictor 최종 예측 가격: 82995972.12141107
2024-09-19 14:26:34 - INFO - TRANSFORMER prediction: 82995972.12141107
2024-09-19 14:26:34 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:26:34 - INFO - BITCOIN_FORECAST prediction: 82185849.2144044
2024-09-19 14:26:34 - INFO - BitcoinForecast prediction: 82185849.2144044
2024-09-19 14:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:26:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:26:41 - INFO - 조정된 모델 가중치: {'gpt': 0.003108146066795454, 'ml': 0.24379422517118157, 'xgboost': 0.05086882131358094, 'rl': 0.13572993823916818, 'lstm': 0.13572993823916818, 'arima': 0.04098366422082955, 'prophet': 0.13572993823916818, 'transformer': 0.21194733703202448, 'bitcoin_forecast': 0.042107991478083424}
2024-09-19 14:26:41 - INFO - 조정된 모델 가중치: {'gpt': 0.003108146066795454, 'ml': 0.24379422517118157, 'xgboost': 0.05086882131358094, 'rl': 0.13572993823916818, 'lstm': 0.13572993823916818, 'arima': 0.04098366422082955, 'prophet': 0.13572993823916818, 'transformer': 0.21194733703202448, 'bitcoin_forecast': 0.042107991478083424}
2024-09-19 14:26:41 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 82958966.86170994, 'current_price': 82934000.0, 'predictions': {'gpt': 82934000.0, 'ml': 82950586.8, 'xgboost': 82934000.0, 'lstm': 82990795.35820079, 'rl': 83763340.0, 'arima': 80899000.0, 'prophet': 82951815.19786546, 'transformer': 82995972.12141107, 'bitcoin_forecast': 82185849.2144044}, 'weights': {'gpt': 0.003108146066795454, 'ml': 0.24379422517118157, 'xgboost': 0.05086882131358094, 'rl': 0.13572993823916818, 'lstm': 0.13572993823916818, 'arima': 0.04098366422082955, 'prophet': 0.13572993823916818, 'transformer': 0.21194733703202448, 'bitcoin_forecast': 0.042107991478083424}}
2024-09-19 14:26:41 - INFO - 모델별 가중치:
2024-09-19 14:26:41 - INFO -   - GPT: 0.0031
2024-09-19 14:26:41 - INFO -   - ML: 0.2438
2024-09-19 14:26:41 - INFO -   - XGBOOST: 0.0509
2024-09-19 14:26:41 - INFO -   - RL: 0.1357
2024-09-19 14:26:41 - INFO -   - LSTM: 0.1357
2024-09-19 14:26:41 - INFO -   - ARIMA: 0.0410
2024-09-19 14:26:41 - INFO -   - PROPHET: 0.1357
2024-09-19 14:26:41 - INFO -   - TRANSFORMER: 0.2119
2024-09-19 14:26:41 - INFO -   - BITCOIN_FORECAST: 0.0421
2024-09-19 14:26:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:26:41 - INFO - 6. 거래 실행
2024-09-19 14:26:41 - INFO - Cancelling existing orders.
2024-09-19 14:26:41 - INFO - Cancelled 0 orders.
2024-09-19 14:26:41 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 82958966.86170994, 'current_price': 82934000.0, 'predictions': {'gpt': 82934000.0, 'ml': 82950586.8, 'xgboost': 82934000.0, 'lstm': 82990795.35820079, 'rl': 83763340.0, 'arima': 80899000.0, 'prophet': 82951815.19786546, 'transformer': 82995972.12141107, 'bitcoin_forecast': 82185849.2144044}, 'weights': {'gpt': 0.003108146066795454, 'ml': 0.24379422517118157, 'xgboost': 0.05086882131358094, 'rl': 0.13572993823916818, 'lstm': 0.13572993823916818, 'arima': 0.04098366422082955, 'prophet': 0.13572993823916818, 'transformer': 0.21194733703202448, 'bitcoin_forecast': 0.042107991478083424}}, 현재 가격=82934000.0
2024-09-19 14:26:41 - INFO - 현재 잔고: KRW=254565.31317524, BTC=0.00267851, 총 자산가치=476704.86151524
2024-09-19 14:26:41 - INFO - 매수 시도: 0.0005748002767444474 BTC (약 47670.486151524005 KRW)
2024-09-19 14:26:41 - INFO - 주문 결과: {'uuid': '06a89ea0-6487-4e5b-83f8-600bacdffb3c', 'side': 'bid', 'ord_type': 'limit', 'price': '82934000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:26:43+09:00', 'volume': '0.0005748', 'remaining_volume': '0.0005748', 'reserved_fee': '23.8352316', 'remaining_fee': '23.8352316', 'paid_fee': '0', 'locked': '47694.2984316', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:26:41 - INFO - buy 주문 성공: UUID=06a89ea0-6487-4e5b-83f8-600bacdffb3c
2024-09-19 14:26:41 - INFO - Trade executed successfully.
2024-09-19 14:26:42 - INFO - 7. summary 리포트 보내기
2024-09-19 14:26:42 - INFO - Message sent to Discord successfully.
2024-09-19 14:26:42 - INFO - Trading cycle completed.
2024-09-19 14:26:42 - INFO - Performing periodic update.
2024-09-19 14:26:42 - INFO - 계산된 시장 변동성: 0.038446683651531165
2024-09-19 14:35:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:35:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e2-a766-ef889fa2c901 "HTTP/1.1 200 OK"
2024-09-19 14:35:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:35:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8194-9b5e-e20dab828b13 "HTTP/1.1 200 OK"
2024-09-19 14:35:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:35:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:35:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-bbea-c50a8f58690d "HTTP/1.1 200 OK"
2024-09-19 14:35:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812b-bc31-ddd184594729 "HTTP/1.1 200 OK"
2024-09-19 14:36:06 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-8886-e45c43f69834 "HTTP/1.1 200 OK"
2024-09-19 14:36:13 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/c53cfeef-1627-4cba-9c2b-66ff4cf75167 "HTTP/1.1 200 OK"
2024-09-19 14:36:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8114-bd65-e75bd9a6ee08 "HTTP/1.1 200 OK"
2024-09-19 14:36:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-b1f3-cea9c211dfa3 "HTTP/1.1 200 OK"
2024-09-19 14:36:39 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:36:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/051d5c5f-cdb0-4982-aeda-e8d2acf358ca "HTTP/1.1 200 OK"
2024-09-19 14:36:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:25:34.925059
2024-09-19 14:36:45 - INFO - Starting trading cycle.
2024-09-19 14:36:45 - INFO - ##################################################
2024-09-19 14:36:45 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-19 14:36:45 - INFO - ##################################################
2024-09-19 14:36:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:36:45 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:36:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:20:00
2024-09-19 14:36:45 - INFO - 새로운 데이터 범위: 2024-09-18 05:20:00 ~ 2024-09-19 14:30:00
2024-09-19 14:36:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:36:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:36:45 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:36:45 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:36:45 - INFO - Sample date values: [Timestamp('2024-09-19 14:30:00')]
2024-09-19 14:36:45 - INFO - Successfully added 1 new data points
2024-09-19 14:36:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:36:45 - INFO - Final date range: 2024-09-19 14:30:00 to 2024-09-19 14:30:00
2024-09-19 14:36:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:36:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:30:00
2024-09-19 14:36:45 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:36:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:36:45 - INFO - GPT | 이전예측가격: 82934000 | 당시BTC가격: 82934000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:36:45 - INFO - ML 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 39/66
2024-09-19 14:36:45 - INFO - ML | 이전예측가격: 82950587 | 당시BTC가격: 82934000 | 예측: 상승 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2407 | 반영가중치값: -0.0200 | 새 가중치: 0.2207 | 예측 총 횟수: 66 | 예측 성공 수: 39 | 예측 성공률: 59.09%
2024-09-19 14:36:45 - INFO - XGBOOST | 이전예측가격: 82934000 | 당시BTC가격: 82934000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:36:45 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-19 14:36:45 - INFO - LSTM | 이전예측가격: 82990795 | 당시BTC가격: 82934000 | 예측: 상승 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1315 | 반영가중치값: -0.0200 | 새 가중치: 0.1115 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-19 14:36:45 - INFO - RL 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 3/7
2024-09-19 14:36:45 - INFO - RL | 이전예측가격: 83763340 | 당시BTC가격: 82934000 | 예측: 상승 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0939 | 반영가중치값: -0.0200 | 새 가중치: 0.0739 | 예측 총 횟수: 7 | 예측 성공 수: 3 | 예측 성공률: 42.86%
2024-09-19 14:36:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.87%, 적중/전체: 100/179
2024-09-19 14:36:45 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82934000 | 예측: 하락 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1361 | 반영가중치값: 0.0200 | 새 가중치: 0.1561 | 예측 총 횟수: 179 | 예측 성공 수: 100 | 예측 성공률: 55.87%
2024-09-19 14:36:45 - INFO - PROPHET 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-19 14:36:45 - INFO - PROPHET | 이전예측가격: 82951815 | 당시BTC가격: 82934000 | 예측: 상승 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0823 | 반영가중치값: -0.0200 | 새 가중치: 0.0623 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-19 14:36:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.69%, 적중/전체: 15/26
2024-09-19 14:36:45 - INFO - TRANSFORMER | 이전예측가격: 82995972 | 당시BTC가격: 82934000 | 예측: 상승 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1569 | 반영가중치값: -0.0200 | 새 가중치: 0.1369 | 예측 총 횟수: 26 | 예측 성공 수: 15 | 예측 성공률: 57.69%
2024-09-19 14:36:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 15/27
2024-09-19 14:36:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 82185849 | 당시BTC가격: 82934000 | 예측: 하락 | 지금 BTC가격: 82801000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1081 | 반영가중치값: 0.0200 | 새 가중치: 0.1281 | 예측 총 횟수: 27 | 예측 성공 수: 15 | 예측 성공률: 55.56%
2024-09-19 14:36:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:36:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:36:46 - INFO - 새로운 가중치: {'gpt': 0.003294642682526824, 'ml': 0.23391936657528262, 'xgboost': 0.05392107909598553, 'rl': 0.07830594625848615, 'lstm': 0.11822373087985215, 'arima': 0.1654341038475947, 'prophet': 0.06600013430055228, 'transformer': 0.14512628161721852, 'bitcoin_forecast': 0.13577471474250125}
2024-09-19 14:36:46 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:36:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:36:46 - INFO - Current BTC price: 82801000.0
2024-09-19 14:36:46 - INFO - Analyzing market conditions.
2024-09-19 14:36:46 - INFO - Market analysis: {'current_price': 82801000.0, 'sma_20': 83058750.0, 'rsi_14': 47.51951079146347, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:36:46 - INFO - Starting predictions for all models
2024-09-19 14:36:46 - INFO - Attempting prediction for gpt
2024-09-19 14:36:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:36:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:36:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:36:46 - INFO - GPT prediction: 82801000.0
2024-09-19 14:36:46 - INFO - Attempting prediction for ml
2024-09-19 14:36:46 - INFO - ML prediction: 82801000.0
2024-09-19 14:36:46 - INFO - Attempting prediction for xgboost
2024-09-19 14:36:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:36:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:36:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:36:46 - INFO - XGBOOST prediction: 82801000.0
2024-09-19 14:36:46 - INFO - Attempting prediction for lstm
2024-09-19 14:36:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:36:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:36:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:36:46 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:36:46 - INFO - X 샘플:
[[ 1.18002084  1.58049187  1.35085694  1.33105358  0.98765893  0.99316836
   1.33105358]
 [ 0.83158949  0.86550745  1.25833249  1.24579795 -0.10965264 -0.10773299
   1.24579795]
 [ 0.88966138  0.23832814 -0.77720536 -1.16267371  2.15224989  2.15048665
  -1.16267371]
 [-1.61904434 -1.22927146 -1.28608983 -1.09873198  0.72556005  0.72127671
  -1.09873198]
 [-1.71195937 -0.50174345 -1.2398276  -0.34208823 -0.04664895 -0.0488378
  -0.34208823]
 [ 0.05342614 -0.28850248  0.15960467  0.18010253 -0.7441373  -0.7440891
   0.18010253]
 [ 0.45992938  1.10383559  1.00389026  1.27776881  0.1229098   0.12545881
   1.27776881]
 [ 0.6109163   0.42648193  0.62222691  0.18010253 -1.1583645  -1.15787679
   0.18010253]
 [ 0.26248495 -0.37630759  0.07864578 -0.09697828 -1.16407035 -1.16426417
  -0.09697828]
 [-0.95702478 -1.81882001 -1.17043427 -1.5143532  -0.76550493 -0.76758969
  -1.5143532 ]]
2024-09-19 14:36:46 - INFO - y 샘플:
[-1.5143532]
2024-09-19 14:36:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:36:46 - INFO - 모델 출력 (스케일링된 예측): [[0.30293113]]
2024-09-19 14:36:46 - INFO - 스케일러 역변환 후 예측 가격: 82971525.67618975
2024-09-19 14:36:46 - INFO - LSTMPredictor 최종 예측 가격: 82971525.67618975
2024-09-19 14:36:46 - INFO - LSTM prediction: 82971525.67618975
2024-09-19 14:36:46 - INFO - Attempting prediction for rl
2024-09-19 14:36:46 - INFO - Preparing state for RL agent.
2024-09-19 14:36:46 - INFO - Prepared state: [[ 8.28010000e+07  8.34105571e+00 -1.60368486e-03  8.30587500e+07
   4.75195108e+01]]
2024-09-19 14:36:46 - INFO - RL prediction: 83629010.0
2024-09-19 14:36:46 - INFO - Attempting prediction for arima
2024-09-19 14:36:46 - INFO - ARIMA 예측 시작
2024-09-19 14:36:46 - INFO - 입력 데이터: {'open': 82866000.0, 'high': 82866000.0, 'low': 82800000.0, 'close': 82801000.0, 'volume': 8.34105571, 'value': 690912164.74105, 'decision': 'sell', 'sma': 83058750.0, 'ema': 82940686.08365129, 'rsi': 47.51951079146347, 'macd': 74206.7049869746, 'signal_line': 142555.69214311757, 'BB_Upper': 83365224.06089523, 'BB_Lower': 82752275.93910477}
2024-09-19 14:36:46 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:36:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83058750.0         0         0
2024-09-19 14:36:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83058750.0         0         0
2024-09-19 14:36:46 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:36:46 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:36:46 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:36:46 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:36:46 - INFO - Attempting prediction for prophet
2024-09-19 14:36:46 - INFO - PROPHET prediction: 82795765.62017682
2024-09-19 14:36:46 - INFO - Attempting prediction for transformer
2024-09-19 14:36:46 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:36:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:36:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:36:46 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:36:46 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:36:46 - INFO - X 샘플:
[[ 1.18002084  1.58049187  1.35085694  1.33105358  0.98765893  0.99316836
   1.33105358  1.33105358  0.          0.          0.          1.33105358
   1.33105358]
 [ 0.83158949  0.86550745  1.25833249  1.24579795 -0.10965264 -0.10773299
   1.24579795  1.24579795  0.          0.          0.          1.24579795
   1.24579795]
 [ 0.88966138  0.23832814 -0.77720536 -1.16267371  2.15224989  2.15048665
  -1.16267371 -1.16267371  0.          0.          0.         -1.16267371
  -1.16267371]
 [-1.61904434 -1.22927146 -1.28608983 -1.09873198  0.72556005  0.72127671
  -1.09873198 -1.09873198  0.          0.          0.         -1.09873198
  -1.09873198]
 [-1.71195937 -0.50174345 -1.2398276  -0.34208823 -0.04664895 -0.0488378
  -0.34208823 -0.34208823  0.          0.          0.         -0.34208823
  -0.34208823]
 [ 0.05342614 -0.28850248  0.15960467  0.18010253 -0.7441373  -0.7440891
   0.18010253  0.18010253  0.          0.          0.          0.18010253
   0.18010253]
 [ 0.45992938  1.10383559  1.00389026  1.27776881  0.1229098   0.12545881
   1.27776881  1.27776881  0.          0.          0.          1.27776881
   1.27776881]
 [ 0.6109163   0.42648193  0.62222691  0.18010253 -1.1583645  -1.15787679
   0.18010253  0.18010253  0.          0.          0.          0.18010253
   0.18010253]
 [ 0.26248495 -0.37630759  0.07864578 -0.09697828 -1.16407035 -1.16426417
  -0.09697828 -0.09697828  0.          0.          0.         -0.09697828
  -0.09697828]
 [-0.95702478 -1.81882001 -1.17043427 -1.5143532  -0.76550493 -0.76758969
  -1.5143532  -1.5143532   0.          0.          0.         -1.5143532
  -1.5143532 ]]
2024-09-19 14:36:46 - INFO - y 샘플:
[-1.5143532]
2024-09-19 14:36:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:36:46 - INFO - 모델 출력 (스케일링된 예측): [0.3627651]
2024-09-19 14:36:46 - INFO - 스케일러 역변환 후 예측 가격: 82977140.22349755
2024-09-19 14:36:46 - INFO - TransformerPredictor 최종 예측 가격: 82977140.22349755
2024-09-19 14:36:46 - INFO - TRANSFORMER prediction: 82977140.22349755
2024-09-19 14:36:46 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:36:46 - INFO - BITCOIN_FORECAST prediction: 82191297.71620214
2024-09-19 14:36:46 - INFO - BitcoinForecast prediction: 82191297.71620214
2024-09-19 14:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:36:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:36:54 - INFO - 조정된 모델 가중치: {'gpt': 0.003294642682526824, 'ml': 0.23391936657528262, 'xgboost': 0.05392107909598553, 'rl': 0.07830594625848615, 'lstm': 0.11822373087985215, 'arima': 0.1654341038475947, 'prophet': 0.06600013430055228, 'transformer': 0.14512628161721852, 'bitcoin_forecast': 0.13577471474250125}
2024-09-19 14:36:54 - INFO - 조정된 모델 가중치: {'gpt': 0.003294642682526824, 'ml': 0.23391936657528262, 'xgboost': 0.05392107909598553, 'rl': 0.07830594625848615, 'lstm': 0.11822373087985215, 'arima': 0.1654341038475947, 'prophet': 0.06600013430055228, 'transformer': 0.14512628161721852, 'bitcoin_forecast': 0.13577471474250125}
2024-09-19 14:36:54 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82513777.57494093, 'current_price': 82801000.0, 'predictions': {'gpt': 82801000.0, 'ml': 82801000.0, 'xgboost': 82801000.0, 'lstm': 82971525.67618975, 'rl': 83629010.0, 'arima': 80899000.0, 'prophet': 82795765.62017682, 'transformer': 82977140.22349755, 'bitcoin_forecast': 82191297.71620214}, 'weights': {'gpt': 0.003294642682526824, 'ml': 0.23391936657528262, 'xgboost': 0.05392107909598553, 'rl': 0.07830594625848615, 'lstm': 0.11822373087985215, 'arima': 0.1654341038475947, 'prophet': 0.06600013430055228, 'transformer': 0.14512628161721852, 'bitcoin_forecast': 0.13577471474250125}}
2024-09-19 14:36:54 - INFO - 모델별 가중치:
2024-09-19 14:36:54 - INFO -   - GPT: 0.0033
2024-09-19 14:36:54 - INFO -   - ML: 0.2339
2024-09-19 14:36:54 - INFO -   - XGBOOST: 0.0539
2024-09-19 14:36:54 - INFO -   - RL: 0.0783
2024-09-19 14:36:54 - INFO -   - LSTM: 0.1182
2024-09-19 14:36:54 - INFO -   - ARIMA: 0.1654
2024-09-19 14:36:54 - INFO -   - PROPHET: 0.0660
2024-09-19 14:36:54 - INFO -   - TRANSFORMER: 0.1451
2024-09-19 14:36:54 - INFO -   - BITCOIN_FORECAST: 0.1358
2024-09-19 14:36:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:36:54 - INFO - 6. 거래 실행
2024-09-19 14:36:54 - INFO - Cancelling existing orders.
2024-09-19 14:36:54 - INFO - Cancelled 0 orders.
2024-09-19 14:36:54 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82513777.57494093, 'current_price': 82801000.0, 'predictions': {'gpt': 82801000.0, 'ml': 82801000.0, 'xgboost': 82801000.0, 'lstm': 82971525.67618975, 'rl': 83629010.0, 'arima': 80899000.0, 'prophet': 82795765.62017682, 'transformer': 82977140.22349755, 'bitcoin_forecast': 82191297.71620214}, 'weights': {'gpt': 0.003294642682526824, 'ml': 0.23391936657528262, 'xgboost': 0.05392107909598553, 'rl': 0.07830594625848615, 'lstm': 0.11822373087985215, 'arima': 0.1654341038475947, 'prophet': 0.06600013430055228, 'transformer': 0.14512628161721852, 'bitcoin_forecast': 0.13577471474250125}}, 현재 가격=82801000.0
2024-09-19 14:36:54 - INFO - 현재 잔고: KRW=206871.01474364, BTC=0.00325331, 총 자산가치=476248.33605364
2024-09-19 14:36:54 - INFO - 매도 시도: 0.00032533100000000005 BTC (약 26937.732131000004 KRW)
2024-09-19 14:36:55 - INFO - 주문 결과: {'uuid': '1f44edcb-0532-4bac-9205-8bc29b5847a6', 'side': 'ask', 'ord_type': 'limit', 'price': '82801000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:36:56+09:00', 'volume': '0.00032533', 'remaining_volume': '0.00032533', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00032533', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:36:55 - INFO - sell 주문 성공: UUID=1f44edcb-0532-4bac-9205-8bc29b5847a6
2024-09-19 14:36:55 - INFO - Trade executed successfully.
2024-09-19 14:36:55 - INFO - 7. summary 리포트 보내기
2024-09-19 14:36:55 - INFO - Message sent to Discord successfully.
2024-09-19 14:36:55 - INFO - Trading cycle completed.
2024-09-19 14:36:55 - INFO - Performing periodic update.
2024-09-19 14:36:55 - INFO - 계산된 시장 변동성: 0.0385620053676779
2024-09-19 14:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:45:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8122-a273-f13ba7b0856f "HTTP/1.1 200 OK"
2024-09-19 14:45:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:45:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:45:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8181-8309-d5827e873d16 "HTTP/1.1 200 OK"
2024-09-19 14:45:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:45:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:45:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814f-9cbf-c1c93fec71bc "HTTP/1.1 200 OK"
2024-09-19 14:45:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f2-baa6-ddd178a73522 "HTTP/1.1 200 OK"
2024-09-19 14:46:01 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d0-a851-ecf5f0a712ae "HTTP/1.1 200 OK"
2024-09-19 14:46:10 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-b2b8-de303331d886 "HTTP/1.1 200 OK"
2024-09-19 14:46:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-939b-ef4fa0543b45 "HTTP/1.1 200 OK"
2024-09-19 14:46:31 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c3-a00f-e19ff8cb934e "HTTP/1.1 200 OK"
2024-09-19 14:46:37 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:46:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8109-a259-db96dfcc6ce7 "HTTP/1.1 200 OK"
2024-09-19 14:46:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:35:34.925194
2024-09-19 14:46:48 - INFO - Starting trading cycle.
2024-09-19 14:46:48 - INFO - ##################################################
2024-09-19 14:46:48 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-19 14:46:48 - INFO - ##################################################
2024-09-19 14:46:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:46:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:46:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:30:00
2024-09-19 14:46:48 - INFO - 새로운 데이터 범위: 2024-09-18 05:30:00 ~ 2024-09-19 14:40:00
2024-09-19 14:46:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:46:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:46:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:46:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:46:48 - INFO - Sample date values: [Timestamp('2024-09-19 14:40:00')]
2024-09-19 14:46:48 - INFO - Successfully added 1 new data points
2024-09-19 14:46:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:46:48 - INFO - Final date range: 2024-09-19 14:40:00 to 2024-09-19 14:40:00
2024-09-19 14:46:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:46:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:40:00
2024-09-19 14:46:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:46:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:46:49 - INFO - GPT | 이전예측가격: 82801000 | 당시BTC가격: 82801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:46:49 - INFO - ML | 이전예측가격: 82801000 | 당시BTC가격: 82801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:46:49 - INFO - XGBOOST | 이전예측가격: 82801000 | 당시BTC가격: 82801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:46:49 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-19 14:46:49 - INFO - LSTM | 이전예측가격: 82971526 | 당시BTC가격: 82801000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1357 | 반영가중치값: -0.0200 | 새 가중치: 0.1157 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-19 14:46:49 - INFO - RL 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-19 14:46:49 - INFO - RL | 이전예측가격: 83629010 | 당시BTC가격: 82801000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1357 | 반영가중치값: -0.0200 | 새 가중치: 0.1157 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-19 14:46:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.11%, 적중/전체: 101/180
2024-09-19 14:46:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82801000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0410 | 반영가중치값: 0.0200 | 새 가중치: 0.0610 | 예측 총 횟수: 180 | 예측 성공 수: 101 | 예측 성공률: 56.11%
2024-09-19 14:46:49 - INFO - PROPHET | 이전예측가격: 82795766 | 당시BTC가격: 82801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:46:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 15/27
2024-09-19 14:46:49 - INFO - TRANSFORMER | 이전예측가격: 82977140 | 당시BTC가격: 82801000 | 예측: 상승 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2119 | 반영가중치값: -0.0200 | 새 가중치: 0.1919 | 예측 총 횟수: 27 | 예측 성공 수: 15 | 예측 성공률: 55.56%
2024-09-19 14:46:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 16/28
2024-09-19 14:46:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 82191298 | 당시BTC가격: 82801000 | 예측: 하락 | 지금 BTC가격: 82800000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0421 | 반영가중치값: 0.0200 | 새 가중치: 0.0621 | 예측 총 횟수: 28 | 예측 성공 수: 16 | 예측 성공률: 57.14%
2024-09-19 14:46:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:46:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:46:49 - INFO - 새로운 가중치: {'gpt': 0.0036459920140154037, 'ml': 0.25886514096967733, 'xgboost': 0.059671364307184026, 'rl': 0.12807168220102352, 'lstm': 0.12807168220102352, 'arima': 0.06748712202198916, 'prophet': 0.07303856162004255, 'transformer': 0.2124171041800332, 'bitcoin_forecast': 0.06873135048501128}
2024-09-19 14:46:49 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:46:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:46:49 - INFO - Current BTC price: 82800000.0
2024-09-19 14:46:49 - INFO - Analyzing market conditions.
2024-09-19 14:46:49 - INFO - Market analysis: {'current_price': 82800000.0, 'sma_20': 83042500.0, 'rsi_14': 47.48578934977854, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:46:49 - INFO - Starting predictions for all models
2024-09-19 14:46:49 - INFO - Attempting prediction for gpt
2024-09-19 14:46:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:46:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:46:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:46:49 - INFO - GPT prediction: 82800000.0
2024-09-19 14:46:49 - INFO - Attempting prediction for ml
2024-09-19 14:46:49 - INFO - ML prediction: 82816560.0
2024-09-19 14:46:49 - INFO - Attempting prediction for xgboost
2024-09-19 14:46:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:46:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:46:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:46:49 - INFO - XGBOOST prediction: 82800000.0
2024-09-19 14:46:49 - INFO - Attempting prediction for lstm
2024-09-19 14:46:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:46:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:46:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:46:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:46:49 - INFO - X 샘플:
[[ 1.08984424  1.16972807  1.59340104  1.55184943  0.07101896  0.07387323
   1.55184943]
 [ 1.14708396  0.58892962 -0.53921176 -0.88877667  2.41160079  2.4118698
  -0.88877667]
 [-1.32567188 -0.77013874 -1.07236496 -0.82398129  0.93528417  0.93216964
  -0.82398129]
 [-1.41725543 -0.09641254 -1.02389648 -0.05723592  0.13621421  0.13484903
  -0.05723592]
 [ 0.32283201  0.10105893  0.44227481  0.47192637 -0.58553597 -0.58496366
   0.47192637]
 [ 0.72351004  1.39043148  1.32682444  1.58424712  0.31167098  0.31530308
   1.58424712]
 [ 0.87233331  0.76316916  0.92695954  0.47192637 -1.01417188 -1.01336938
   0.47192637]
 [ 0.528895    0.01974715  0.35745499  0.19114638 -1.02007621 -1.0199824
   0.19114638]
 [-0.67313909 -1.31608928 -0.95119377 -1.24515128 -0.60764687 -0.60929447
  -1.24515128]
 [-1.26843216 -1.85042384 -1.06024784 -1.25595051 -0.63835819 -0.64045487
  -1.25595051]]
2024-09-19 14:46:49 - INFO - y 샘플:
[-1.25595051]
2024-09-19 14:46:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:46:49 - INFO - 모델 출력 (스케일링된 예측): [[0.29544032]]
2024-09-19 14:46:49 - INFO - 스케일러 역변환 후 예측 가격: 82943657.53399159
2024-09-19 14:46:49 - INFO - LSTMPredictor 최종 예측 가격: 82943657.53399159
2024-09-19 14:46:49 - INFO - LSTM prediction: 82943657.53399159
2024-09-19 14:46:49 - INFO - Attempting prediction for rl
2024-09-19 14:46:49 - INFO - Preparing state for RL agent.
2024-09-19 14:46:49 - INFO - Prepared state: [[ 8.28000000e+07  8.16690640e+00 -1.20771488e-05  8.30425000e+07
   4.74857893e+01]]
2024-09-19 14:46:49 - INFO - RL prediction: 83628000.0
2024-09-19 14:46:49 - INFO - Attempting prediction for arima
2024-09-19 14:46:49 - INFO - ARIMA 예측 시작
2024-09-19 14:46:49 - INFO - 입력 데이터: {'open': 82814000.0, 'high': 82820000.0, 'low': 82791000.0, 'close': 82800000.0, 'volume': 8.1669064, 'value': 676264639.5275, 'decision': 'sell', 'sma': 83042500.0, 'ema': 82927287.40901783, 'rsi': 47.48578934977854, 'macd': 56173.508290976286, 'signal_line': 125279.25537268932, 'BB_Upper': 83367126.86271815, 'BB_Lower': 82717873.13728185}
2024-09-19 14:46:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:46:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83042500.0         0         0
2024-09-19 14:46:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83042500.0         0         0
2024-09-19 14:46:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:46:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:46:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:46:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:46:49 - INFO - Attempting prediction for prophet
2024-09-19 14:46:49 - INFO - PROPHET prediction: 82794801.13185629
2024-09-19 14:46:49 - INFO - Attempting prediction for transformer
2024-09-19 14:46:49 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:46:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:46:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:46:49 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:46:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:46:49 - INFO - X 샘플:
[[ 1.08984424  1.16972807  1.59340104  1.55184943  0.07101896  0.07387323
   1.55184943  1.55184943  0.          0.          0.          1.55184943
   1.55184943]
 [ 1.14708396  0.58892962 -0.53921176 -0.88877667  2.41160079  2.4118698
  -0.88877667 -0.88877667  0.          0.          0.         -0.88877667
  -0.88877667]
 [-1.32567188 -0.77013874 -1.07236496 -0.82398129  0.93528417  0.93216964
  -0.82398129 -0.82398129  0.          0.          0.         -0.82398129
  -0.82398129]
 [-1.41725543 -0.09641254 -1.02389648 -0.05723592  0.13621421  0.13484903
  -0.05723592 -0.05723592  0.          0.          0.         -0.05723592
  -0.05723592]
 [ 0.32283201  0.10105893  0.44227481  0.47192637 -0.58553597 -0.58496366
   0.47192637  0.47192637  0.          0.          0.          0.47192637
   0.47192637]
 [ 0.72351004  1.39043148  1.32682444  1.58424712  0.31167098  0.31530308
   1.58424712  1.58424712  0.          0.          0.          1.58424712
   1.58424712]
 [ 0.87233331  0.76316916  0.92695954  0.47192637 -1.01417188 -1.01336938
   0.47192637  0.47192637  0.          0.          0.          0.47192637
   0.47192637]
 [ 0.528895    0.01974715  0.35745499  0.19114638 -1.02007621 -1.0199824
   0.19114638  0.19114638  0.          0.          0.          0.19114638
   0.19114638]
 [-0.67313909 -1.31608928 -0.95119377 -1.24515128 -0.60764687 -0.60929447
  -1.24515128 -1.24515128  0.          0.          0.         -1.24515128
  -1.24515128]
 [-1.26843216 -1.85042384 -1.06024784 -1.25595051 -0.63835819 -0.64045487
  -1.25595051 -1.25595051  0.          0.          0.         -1.25595051
  -1.25595051]]
2024-09-19 14:46:49 - INFO - y 샘플:
[-1.25595051]
2024-09-19 14:46:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:46:49 - INFO - 모델 출력 (스케일링된 예측): [0.35806376]
2024-09-19 14:46:49 - INFO - 스케일러 역변환 후 예측 가격: 82949456.41392735
2024-09-19 14:46:49 - INFO - TransformerPredictor 최종 예측 가격: 82949456.41392735
2024-09-19 14:46:49 - INFO - TRANSFORMER prediction: 82949456.41392735
2024-09-19 14:46:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:46:49 - INFO - BITCOIN_FORECAST prediction: 82175792.84710883
2024-09-19 14:46:49 - INFO - BitcoinForecast prediction: 82175792.84710883
2024-09-19 14:46:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:46:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:47:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:47:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:47:05 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:47:05 - INFO - 조정된 모델 가중치: {'gpt': 0.0036459920140154037, 'ml': 0.25886514096967733, 'xgboost': 0.059671364307184026, 'rl': 0.12807168220102352, 'lstm': 0.12807168220102352, 'arima': 0.06748712202198916, 'prophet': 0.07303856162004255, 'transformer': 0.2124171041800332, 'bitcoin_forecast': 0.06873135048501128}
2024-09-19 14:47:05 - INFO - 조정된 모델 가중치: {'gpt': 0.0036459920140154037, 'ml': 0.25886514096967733, 'xgboost': 0.059671364307184026, 'rl': 0.12807168220102352, 'lstm': 0.12807168220102352, 'arima': 0.06748712202198916, 'prophet': 0.07303856162004255, 'transformer': 0.2124171041800332, 'bitcoin_forecast': 0.06873135048501128}
2024-09-19 14:47:05 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82788900.38286795, 'current_price': 82800000.0, 'predictions': {'gpt': 82800000.0, 'ml': 82816560.0, 'xgboost': 82800000.0, 'lstm': 82943657.53399159, 'rl': 83628000.0, 'arima': 80899000.0, 'prophet': 82794801.13185629, 'transformer': 82949456.41392735, 'bitcoin_forecast': 82175792.84710883}, 'weights': {'gpt': 0.0036459920140154037, 'ml': 0.25886514096967733, 'xgboost': 0.059671364307184026, 'rl': 0.12807168220102352, 'lstm': 0.12807168220102352, 'arima': 0.06748712202198916, 'prophet': 0.07303856162004255, 'transformer': 0.2124171041800332, 'bitcoin_forecast': 0.06873135048501128}}
2024-09-19 14:47:05 - INFO - 모델별 가중치:
2024-09-19 14:47:05 - INFO -   - GPT: 0.0036
2024-09-19 14:47:05 - INFO -   - ML: 0.2589
2024-09-19 14:47:05 - INFO -   - XGBOOST: 0.0597
2024-09-19 14:47:05 - INFO -   - RL: 0.1281
2024-09-19 14:47:05 - INFO -   - LSTM: 0.1281
2024-09-19 14:47:05 - INFO -   - ARIMA: 0.0675
2024-09-19 14:47:05 - INFO -   - PROPHET: 0.0730
2024-09-19 14:47:05 - INFO -   - TRANSFORMER: 0.2124
2024-09-19 14:47:05 - INFO -   - BITCOIN_FORECAST: 0.0687
2024-09-19 14:47:05 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:47:05 - INFO - 6. 거래 실행
2024-09-19 14:47:05 - INFO - Cancelling existing orders.
2024-09-19 14:47:05 - INFO - Cancelled 0 orders.
2024-09-19 14:47:05 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82788900.38286795, 'current_price': 82800000.0, 'predictions': {'gpt': 82800000.0, 'ml': 82816560.0, 'xgboost': 82800000.0, 'lstm': 82943657.53399159, 'rl': 83628000.0, 'arima': 80899000.0, 'prophet': 82794801.13185629, 'transformer': 82949456.41392735, 'bitcoin_forecast': 82175792.84710883}, 'weights': {'gpt': 0.0036459920140154037, 'ml': 0.25886514096967733, 'xgboost': 0.059671364307184026, 'rl': 0.12807168220102352, 'lstm': 0.12807168220102352, 'arima': 0.06748712202198916, 'prophet': 0.07303856162004255, 'transformer': 0.2124171041800332, 'bitcoin_forecast': 0.06873135048501128}}, 현재 가격=82800000.0
2024-09-19 14:47:05 - INFO - 현재 잔고: KRW=233795.19524898, BTC=0.00292798, 총 자산가치=476231.93924898
2024-09-19 14:47:05 - INFO - 매도 시도: 0.00029279800000000004 BTC (약 24243.674400000004 KRW)
2024-09-19 14:47:05 - INFO - 주문 결과: {'uuid': 'df5da61e-18c7-4f78-9f1e-7aa63ba5d196', 'side': 'ask', 'ord_type': 'limit', 'price': '82800000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:47:07+09:00', 'volume': '0.00029279', 'remaining_volume': '0.00029279', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00029279', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:47:05 - INFO - sell 주문 성공: UUID=df5da61e-18c7-4f78-9f1e-7aa63ba5d196
2024-09-19 14:47:05 - INFO - Trade executed successfully.
2024-09-19 14:47:05 - INFO - 7. summary 리포트 보내기
2024-09-19 14:47:06 - INFO - Message sent to Discord successfully.
2024-09-19 14:47:06 - INFO - Trading cycle completed.
2024-09-19 14:47:06 - INFO - Performing periodic update.
2024-09-19 14:47:06 - INFO - 계산된 시장 변동성: 0.03848886519406886
2024-09-19 14:55:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:55:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8161-a315-fbe235810ca7 "HTTP/1.1 200 OK"
2024-09-19 14:55:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:55:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:55:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8122-8fdb-e6f915c56984 "HTTP/1.1 200 OK"
2024-09-19 14:55:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:55:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-bd8c-f718d64dab14 "HTTP/1.1 200 OK"
2024-09-19 14:55:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10978c56-d3bf-43bc-99ec-c4da90d67847 "HTTP/1.1 200 OK"
2024-09-19 14:56:06 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-b0bf-ef72d8ed4b85 "HTTP/1.1 200 OK"
2024-09-19 14:56:15 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8185-978a-c703926f4007 "HTTP/1.1 200 OK"
2024-09-19 14:56:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817d-9a20-c5a92746c028 "HTTP/1.1 200 OK"
2024-09-19 14:56:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-81fa-e54a420aefd9 "HTTP/1.1 200 OK"
2024-09-19 14:56:37 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 14:56:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810b-90ad-d46dcbf5eefd "HTTP/1.1 200 OK"
2024-09-19 14:56:44 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:45:34.925524
2024-09-19 14:56:44 - INFO - Starting trading cycle.
2024-09-19 14:56:44 - INFO - ##################################################
2024-09-19 14:56:44 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-19 14:56:44 - INFO - ##################################################
2024-09-19 14:56:44 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 14:56:44 - INFO - 데이터베이스 업데이트 시작
2024-09-19 14:56:44 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:40:00
2024-09-19 14:56:44 - INFO - 새로운 데이터 범위: 2024-09-18 05:40:00 ~ 2024-09-19 14:50:00
2024-09-19 14:56:44 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 14:56:44 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 14:56:44 - INFO - Index: Index([199], dtype='int64')
2024-09-19 14:56:44 - INFO - Date column data type: datetime64[ns]
2024-09-19 14:56:44 - INFO - Sample date values: [Timestamp('2024-09-19 14:50:00')]
2024-09-19 14:56:44 - INFO - Successfully added 1 new data points
2024-09-19 14:56:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 14:56:44 - INFO - Final date range: 2024-09-19 14:50:00 to 2024-09-19 14:50:00
2024-09-19 14:56:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 14:56:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 14:50:00
2024-09-19 14:56:44 - INFO - 데이터베이스 업데이트 완료
2024-09-19 14:56:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 14:56:45 - INFO - GPT | 이전예측가격: 82800000 | 당시BTC가격: 82800000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:56:45 - INFO - ML 모델 예측 업데이트: 정확도 58.21%, 적중/전체: 39/67
2024-09-19 14:56:45 - INFO - ML | 이전예측가격: 82816560 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2339 | 반영가중치값: -0.0200 | 새 가중치: 0.2139 | 예측 총 횟수: 67 | 예측 성공 수: 39 | 예측 성공률: 58.21%
2024-09-19 14:56:45 - INFO - XGBOOST | 이전예측가격: 82800000 | 당시BTC가격: 82800000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:56:45 - INFO - LSTM 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 4/9
2024-09-19 14:56:45 - INFO - LSTM | 이전예측가격: 82943658 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1182 | 반영가중치값: -0.0200 | 새 가중치: 0.0982 | 예측 총 횟수: 9 | 예측 성공 수: 4 | 예측 성공률: 44.44%
2024-09-19 14:56:45 - INFO - RL 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 3/9
2024-09-19 14:56:45 - INFO - RL | 이전예측가격: 83628000 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0783 | 반영가중치값: -0.0200 | 새 가중치: 0.0583 | 예측 총 횟수: 9 | 예측 성공 수: 3 | 예측 성공률: 33.33%
2024-09-19 14:56:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.35%, 적중/전체: 102/181
2024-09-19 14:56:45 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82800000 | 예측: 하락 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1654 | 반영가중치값: 0.0200 | 새 가중치: 0.1854 | 예측 총 횟수: 181 | 예측 성공 수: 102 | 예측 성공률: 56.35%
2024-09-19 14:56:45 - INFO - PROPHET | 이전예측가격: 82794801 | 당시BTC가격: 82800000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 14:56:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.57%, 적중/전체: 15/28
2024-09-19 14:56:45 - INFO - TRANSFORMER | 이전예측가격: 82949456 | 당시BTC가격: 82800000 | 예측: 상승 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1451 | 반영가중치값: -0.0200 | 새 가중치: 0.1251 | 예측 총 횟수: 28 | 예측 성공 수: 15 | 예측 성공률: 53.57%
2024-09-19 14:56:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 17/29
2024-09-19 14:56:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 82175793 | 당시BTC가격: 82800000 | 예측: 하락 | 지금 BTC가격: 82730000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1358 | 반영가중치값: 0.0200 | 새 가중치: 0.1558 | 예측 총 횟수: 29 | 예측 성공 수: 17 | 예측 성공률: 58.62%
2024-09-19 14:56:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 14:56:45 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 14:56:45 - INFO - 새로운 가중치: {'gpt': 0.0037466261609233526, 'ml': 0.2198238208032785, 'xgboost': 0.06131837198542452, 'rl': 0.059915266613228615, 'lstm': 0.1009348342846903, 'arima': 0.19055232757836774, 'prophet': 0.07505452142241242, 'transformer': 0.12857993059886969, 'bitcoin_forecast': 0.1600743005528048}
2024-09-19 14:56:45 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 14:56:45 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 14:56:45 - INFO - Current BTC price: 82730000.0
2024-09-19 14:56:45 - INFO - Analyzing market conditions.
2024-09-19 14:56:45 - INFO - Market analysis: {'current_price': 82730000.0, 'sma_20': 83019750.0, 'rsi_14': 45.07450797917664, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 14:56:45 - INFO - Starting predictions for all models
2024-09-19 14:56:45 - INFO - Attempting prediction for gpt
2024-09-19 14:56:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 14:56:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:56:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 14:56:45 - INFO - GPT prediction: 82730000.0
2024-09-19 14:56:45 - INFO - Attempting prediction for ml
2024-09-19 14:56:45 - INFO - ML prediction: 82713454.0
2024-09-19 14:56:45 - INFO - Attempting prediction for xgboost
2024-09-19 14:56:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 14:56:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:56:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 14:56:45 - INFO - XGBOOST prediction: 82730000.0
2024-09-19 14:56:45 - INFO - Attempting prediction for lstm
2024-09-19 14:56:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:56:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:56:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 14:56:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:56:45 - INFO - X 샘플:
[[ 1.383859    0.83761284 -0.20461246 -0.52283133  2.42463173  2.42558181
  -0.52283133]
 [-1.06224202 -0.40763115 -0.75024569 -0.45920074  0.94804822  0.94560252
  -0.45920074]
 [-1.15283835  0.20966929 -0.70064266  0.29376121  0.1488338   0.14813151
   0.29376121]
 [ 0.568492    0.39060217  0.79984871  0.81341101 -0.57304685 -0.57181697
   0.81341101]
 [ 0.96485096  1.5719875   1.70510383  1.90573609  0.3243223   0.32861959
   1.90573609]
 [ 1.11207     0.9972595   1.29587891  0.81341101 -1.00176024 -1.0003035
   0.81341101]
 [ 0.77233375  0.3161004   0.71304342  0.53767846 -1.00766564 -1.00691777
   0.53767846]
 [-0.41674314 -0.90785737 -0.62623813 -0.87279956 -0.59516174 -0.59615236
  -0.87279956]
 [-1.00561931 -1.39744048 -0.73784493 -0.88340465 -0.62587862 -0.62731864
  -0.88340465]
 [-1.16416289 -1.6103027  -1.49429099 -1.62576151 -0.04232295 -0.04542619
  -1.62576151]]
2024-09-19 14:56:45 - INFO - y 샘플:
[-1.62576151]
2024-09-19 14:56:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 14:56:45 - INFO - 모델 출력 (스케일링된 예측): [[0.2867753]]
2024-09-19 14:56:45 - INFO - 스케일러 역변환 후 예측 가격: 82910341.26769675
2024-09-19 14:56:45 - INFO - LSTMPredictor 최종 예측 가격: 82910341.26769675
2024-09-19 14:56:45 - INFO - LSTM prediction: 82910341.26769675
2024-09-19 14:56:45 - INFO - Attempting prediction for rl
2024-09-19 14:56:45 - INFO - Preparing state for RL agent.
2024-09-19 14:56:45 - INFO - Prepared state: [[ 8.27300000e+07  1.14753747e+01 -8.45410628e-04  8.30197500e+07
   4.50745080e+01]]
2024-09-19 14:56:45 - INFO - RL prediction: 83557300.0
2024-09-19 14:56:45 - INFO - Attempting prediction for arima
2024-09-19 14:56:45 - INFO - ARIMA 예측 시작
2024-09-19 14:56:45 - INFO - 입력 데이터: {'open': 82800000.0, 'high': 82800000.0, 'low': 82730000.0, 'close': 82730000.0, 'volume': 11.47537469, 'value': 949742384.95251, 'decision': 'sell', 'sma': 83019750.0, 'ema': 82908498.13196851, 'rsi': 45.07450797917664, 'macd': 35820.735856324434, 'signal_line': 107387.55146941636, 'BB_Upper': 83364398.15391676, 'BB_Lower': 82675101.84608324}
2024-09-19 14:56:45 - INFO - Exogenous 변수 예측 시작
2024-09-19 14:56:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83019750.0         0         0
2024-09-19 14:56:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83019750.0         0         0
2024-09-19 14:56:45 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 14:56:45 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 14:56:45 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 14:56:45 - INFO - ARIMA prediction: 80899000.0
2024-09-19 14:56:45 - INFO - Attempting prediction for prophet
2024-09-19 14:56:45 - INFO - PROPHET prediction: 82713679.8715233
2024-09-19 14:56:45 - INFO - Attempting prediction for transformer
2024-09-19 14:56:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 14:56:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 14:56:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 14:56:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 14:56:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 14:56:45 - INFO - X 샘플:
[[ 1.383859    0.83761284 -0.20461246 -0.52283133  2.42463173  2.42558181
  -0.52283133 -0.52283133  0.          0.          0.         -0.52283133
  -0.52283133]
 [-1.06224202 -0.40763115 -0.75024569 -0.45920074  0.94804822  0.94560252
  -0.45920074 -0.45920074  0.          0.          0.         -0.45920074
  -0.45920074]
 [-1.15283835  0.20966929 -0.70064266  0.29376121  0.1488338   0.14813151
   0.29376121  0.29376121  0.          0.          0.          0.29376121
   0.29376121]
 [ 0.568492    0.39060217  0.79984871  0.81341101 -0.57304685 -0.57181697
   0.81341101  0.81341101  0.          0.          0.          0.81341101
   0.81341101]
 [ 0.96485096  1.5719875   1.70510383  1.90573609  0.3243223   0.32861959
   1.90573609  1.90573609  0.          0.          0.          1.90573609
   1.90573609]
 [ 1.11207     0.9972595   1.29587891  0.81341101 -1.00176024 -1.0003035
   0.81341101  0.81341101  0.          0.          0.          0.81341101
   0.81341101]
 [ 0.77233375  0.3161004   0.71304342  0.53767846 -1.00766564 -1.00691777
   0.53767846  0.53767846  0.          0.          0.          0.53767846
   0.53767846]
 [-0.41674314 -0.90785737 -0.62623813 -0.87279956 -0.59516174 -0.59615236
  -0.87279956 -0.87279956  0.          0.          0.         -0.87279956
  -0.87279956]
 [-1.00561931 -1.39744048 -0.73784493 -0.88340465 -0.62587862 -0.62731864
  -0.88340465 -0.88340465  0.          0.          0.         -0.88340465
  -0.88340465]
 [-1.16416289 -1.6103027  -1.49429099 -1.62576151 -0.04232295 -0.04542619
  -1.62576151 -1.62576151  0.          0.          0.         -1.62576151
  -1.62576151]]
2024-09-19 14:56:45 - INFO - y 샘플:
[-1.62576151]
2024-09-19 14:56:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 14:56:45 - INFO - 모델 출력 (스케일링된 예측): [0.36055663]
2024-09-19 14:56:45 - INFO - 스케일러 역변환 후 예측 가격: 82917298.42566802
2024-09-19 14:56:45 - INFO - TransformerPredictor 최종 예측 가격: 82917298.42566802
2024-09-19 14:56:45 - INFO - TRANSFORMER prediction: 82917298.42566802
2024-09-19 14:56:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 14:56:45 - INFO - BITCOIN_FORECAST prediction: 82191387.3119165
2024-09-19 14:56:45 - INFO - BitcoinForecast prediction: 82191387.3119165
2024-09-19 14:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:56:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:57:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 14:57:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 14:57:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0037466261609233526, 'ml': 0.2198238208032785, 'xgboost': 0.06131837198542452, 'rl': 0.059915266613228615, 'lstm': 0.1009348342846903, 'arima': 0.19055232757836774, 'prophet': 0.07505452142241242, 'transformer': 0.12857993059886969, 'bitcoin_forecast': 0.1600743005528048}
2024-09-19 14:57:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0037466261609233526, 'ml': 0.2198238208032785, 'xgboost': 0.06131837198542452, 'rl': 0.059915266613228615, 'lstm': 0.1009348342846903, 'arima': 0.19055232757836774, 'prophet': 0.07505452142241242, 'transformer': 0.12857993059886969, 'bitcoin_forecast': 0.1600743005528048}
2024-09-19 14:57:00 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82381871.96913125, 'current_price': 82730000.0, 'predictions': {'gpt': 82730000.0, 'ml': 82713454.0, 'xgboost': 82730000.0, 'lstm': 82910341.26769675, 'rl': 83557300.0, 'arima': 80899000.0, 'prophet': 82713679.8715233, 'transformer': 82917298.42566802, 'bitcoin_forecast': 82191387.3119165}, 'weights': {'gpt': 0.0037466261609233526, 'ml': 0.2198238208032785, 'xgboost': 0.06131837198542452, 'rl': 0.059915266613228615, 'lstm': 0.1009348342846903, 'arima': 0.19055232757836774, 'prophet': 0.07505452142241242, 'transformer': 0.12857993059886969, 'bitcoin_forecast': 0.1600743005528048}}
2024-09-19 14:57:00 - INFO - 모델별 가중치:
2024-09-19 14:57:00 - INFO -   - GPT: 0.0037
2024-09-19 14:57:00 - INFO -   - ML: 0.2198
2024-09-19 14:57:00 - INFO -   - XGBOOST: 0.0613
2024-09-19 14:57:00 - INFO -   - RL: 0.0599
2024-09-19 14:57:00 - INFO -   - LSTM: 0.1009
2024-09-19 14:57:00 - INFO -   - ARIMA: 0.1906
2024-09-19 14:57:00 - INFO -   - PROPHET: 0.0751
2024-09-19 14:57:00 - INFO -   - TRANSFORMER: 0.1286
2024-09-19 14:57:00 - INFO -   - BITCOIN_FORECAST: 0.1601
2024-09-19 14:57:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 14:57:00 - INFO - 6. 거래 실행
2024-09-19 14:57:00 - INFO - Cancelling existing orders.
2024-09-19 14:57:00 - INFO - Cancelled 0 orders.
2024-09-19 14:57:00 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82381871.96913125, 'current_price': 82730000.0, 'predictions': {'gpt': 82730000.0, 'ml': 82713454.0, 'xgboost': 82730000.0, 'lstm': 82910341.26769675, 'rl': 83557300.0, 'arima': 80899000.0, 'prophet': 82713679.8715233, 'transformer': 82917298.42566802, 'bitcoin_forecast': 82191387.3119165}, 'weights': {'gpt': 0.0037466261609233526, 'ml': 0.2198238208032785, 'xgboost': 0.06131837198542452, 'rl': 0.059915266613228615, 'lstm': 0.1009348342846903, 'arima': 0.19055232757836774, 'prophet': 0.07505452142241242, 'transformer': 0.12857993059886969, 'bitcoin_forecast': 0.1600743005528048}}, 현재 가격=82730000.0
2024-09-19 14:57:00 - INFO - 현재 잔고: KRW=258026.68425357, BTC=0.00263519, 총 자산가치=476035.95295357
2024-09-19 14:57:00 - INFO - 매도 시도: 0.000263519 BTC (약 21800.92687 KRW)
2024-09-19 14:57:00 - INFO - 주문 결과: {'uuid': 'd6c1010c-a890-4933-8f95-2faeb71056b2', 'side': 'ask', 'ord_type': 'limit', 'price': '82730000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T14:57:01+09:00', 'volume': '0.00026351', 'remaining_volume': '0.00026351', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00026351', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 14:57:00 - INFO - sell 주문 성공: UUID=d6c1010c-a890-4933-8f95-2faeb71056b2
2024-09-19 14:57:00 - INFO - Trade executed successfully.
2024-09-19 14:57:00 - INFO - 7. summary 리포트 보내기
2024-09-19 14:57:00 - INFO - Message sent to Discord successfully.
2024-09-19 14:57:00 - INFO - Trading cycle completed.
2024-09-19 14:57:00 - INFO - Performing periodic update.
2024-09-19 14:57:00 - INFO - 계산된 시장 변동성: 0.03849952424176472
2024-09-19 15:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:05:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8132-ac8a-d695355ae764 "HTTP/1.1 200 OK"
2024-09-19 15:05:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:05:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ab-b5ba-d82a04a10f64 "HTTP/1.1 200 OK"
2024-09-19 15:05:54 - INFO - Updated actual price for ml prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/22ca6d78-f036-4325-90cf-ef7f725003a2 "HTTP/1.1 200 OK"
2024-09-19 15:06:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8126-b771-e45406622d3a "HTTP/1.1 200 OK"
2024-09-19 15:06:12 - INFO - Updated actual price for lstm prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c4-bfab-dec53e1fc066 "HTTP/1.1 200 OK"
2024-09-19 15:06:18 - INFO - Updated actual price for rl prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813d-a4ff-e2e142087152 "HTTP/1.1 200 OK"
2024-09-19 15:06:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ea-b354-f23598f2e8e0 "HTTP/1.1 200 OK"
2024-09-19 15:06:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8116-8a7e-ceb84d27c375 "HTTP/1.1 200 OK"
2024-09-19 15:06:44 - INFO - Updated actual price for transformer prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:06:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-81e6-f97fb0bbfa3f "HTTP/1.1 200 OK"
2024-09-19 15:06:59 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 14:55:34.925958
2024-09-19 15:06:59 - INFO - Starting trading cycle.
2024-09-19 15:06:59 - INFO - ##################################################
2024-09-19 15:06:59 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-19 15:06:59 - INFO - ##################################################
2024-09-19 15:06:59 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:06:59 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:06:59 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 14:50:00
2024-09-19 15:06:59 - INFO - 새로운 데이터 범위: 2024-09-18 05:50:00 ~ 2024-09-19 15:00:00
2024-09-19 15:06:59 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:06:59 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:06:59 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:06:59 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:06:59 - INFO - Sample date values: [Timestamp('2024-09-19 15:00:00')]
2024-09-19 15:06:59 - INFO - Successfully added 1 new data points
2024-09-19 15:06:59 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:06:59 - INFO - Final date range: 2024-09-19 15:00:00 to 2024-09-19 15:00:00
2024-09-19 15:06:59 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:06:59 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:00:00
2024-09-19 15:06:59 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:06:59 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:06:59 - INFO - GPT | 이전예측가격: 82730000 | 당시BTC가격: 82730000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:06:59 - INFO - ML 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 40/68
2024-09-19 15:06:59 - INFO - ML | 이전예측가격: 82713454 | 당시BTC가격: 82730000 | 예측: 하락 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2589 | 반영가중치값: 0.0200 | 새 가중치: 0.2789 | 예측 총 횟수: 68 | 예측 성공 수: 40 | 예측 성공률: 58.82%
2024-09-19 15:06:59 - INFO - XGBOOST | 이전예측가격: 82730000 | 당시BTC가격: 82730000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:06:59 - INFO - LSTM 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-19 15:06:59 - INFO - LSTM | 이전예측가격: 82910341 | 당시BTC가격: 82730000 | 예측: 상승 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1281 | 반영가중치값: -0.0200 | 새 가중치: 0.1081 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-19 15:06:59 - INFO - RL 모델 예측 업데이트: 정확도 30.00%, 적중/전체: 3/10
2024-09-19 15:06:59 - INFO - RL | 이전예측가격: 83557300 | 당시BTC가격: 82730000 | 예측: 상승 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1281 | 반영가중치값: -0.0200 | 새 가중치: 0.1081 | 예측 총 횟수: 10 | 예측 성공 수: 3 | 예측 성공률: 30.00%
2024-09-19 15:06:59 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.59%, 적중/전체: 103/182
2024-09-19 15:07:00 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82730000 | 예측: 하락 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0675 | 반영가중치값: 0.0200 | 새 가중치: 0.0875 | 예측 총 횟수: 182 | 예측 성공 수: 103 | 예측 성공률: 56.59%
2024-09-19 15:07:00 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-19 15:07:00 - INFO - PROPHET | 이전예측가격: 82713680 | 당시BTC가격: 82730000 | 예측: 하락 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0730 | 반영가중치값: 0.0200 | 새 가중치: 0.0930 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-19 15:07:00 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 51.72%, 적중/전체: 15/29
2024-09-19 15:07:00 - INFO - TRANSFORMER | 이전예측가격: 82917298 | 당시BTC가격: 82730000 | 예측: 상승 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2124 | 반영가중치값: -0.0200 | 새 가중치: 0.1924 | 예측 총 횟수: 29 | 예측 성공 수: 15 | 예측 성공률: 51.72%
2024-09-19 15:07:00 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 18/30
2024-09-19 15:07:00 - INFO - BITCOIN_FORECAST | 이전예측가격: 82191387 | 당시BTC가격: 82730000 | 예측: 하락 | 지금 BTC가격: 82585000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0687 | 반영가중치값: 0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 30 | 예측 성공 수: 18 | 예측 성공률: 60.00%
2024-09-19 15:07:00 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:07:00 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:07:00 - INFO - 새로운 가중치: {'gpt': 0.0036668801644902764, 'ml': 0.2729295665136455, 'xgboost': 0.06001322584497623, 'rl': 0.1057714036001835, 'lstm': 0.1057714036001835, 'arima': 0.08562498061234657, 'prophet': 0.09105825921344697, 'transformer': 0.18832155446556098, 'bitcoin_forecast': 0.08684272598516636}
2024-09-19 15:07:00 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:07:00 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:07:00 - INFO - Current BTC price: 82585000.0
2024-09-19 15:07:00 - INFO - Analyzing market conditions.
2024-09-19 15:07:00 - INFO - Market analysis: {'current_price': 82584000.0, 'sma_20': 82980550.0, 'rsi_14': 40.45976913412962, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:07:00 - INFO - Starting predictions for all models
2024-09-19 15:07:00 - INFO - Attempting prediction for gpt
2024-09-19 15:07:00 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:07:00 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:07:00 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:07:00 - INFO - GPT prediction: 82585000.0
2024-09-19 15:07:00 - INFO - Attempting prediction for ml
2024-09-19 15:07:00 - INFO - ML prediction: 82584000.0
2024-09-19 15:07:00 - INFO - Attempting prediction for xgboost
2024-09-19 15:07:00 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:07:00 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:07:00 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:07:00 - INFO - XGBOOST prediction: 82584000.0
2024-09-19 15:07:00 - INFO - Attempting prediction for lstm
2024-09-19 15:07:00 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:07:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:07:00 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:07:00 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:07:00 - INFO - X 샘플:
[[-0.74674616 -0.12968354 -0.30037932 -0.1404314   2.01146876  2.0104384
  -0.1404314 ]
 [-0.83685128  0.4358537  -0.26575346  0.40441173  0.66439724  0.66491772
   0.40441173]
 [ 0.87514595  0.60161461  0.78167874  0.78043022 -0.55232864 -0.54980424
   0.78043022]
 [ 1.26935584  1.68393587  1.41360064  1.57083645  0.96018214  0.96944346
   1.57083645]
 [ 1.41577666  1.1574012   1.12793731  0.78043022 -1.27492272 -1.27276153
   0.78043022]
 [ 1.07788247  0.53336012  0.72108349  0.5809102  -1.28487624 -1.28392136
   0.5809102 ]
 [-0.1047472  -0.58796371 -0.21381467 -0.43971142 -0.58960318 -0.59086376
  -0.43971142]
 [-0.69043046 -1.03649324 -0.29172285 -0.44738527 -0.64137631 -0.64344859
  -0.44738527]
 [-0.84811442 -1.23150608 -0.81976718 -0.98455455  0.34220359  0.33834048
  -0.98455455]
 [-1.4112714  -1.42651892 -2.1528627  -2.10493618  0.36485535  0.35765942
  -2.10493618]]
2024-09-19 15:07:00 - INFO - y 샘플:
[-2.10493618]
2024-09-19 15:07:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:07:00 - INFO - 모델 출력 (스케일링된 예측): [[0.27201748]]
2024-09-19 15:07:00 - INFO - 스케일러 역변환 후 예측 가격: 82893747.34279361
2024-09-19 15:07:00 - INFO - LSTMPredictor 최종 예측 가격: 82893747.34279361
2024-09-19 15:07:00 - INFO - LSTM prediction: 82893747.34279361
2024-09-19 15:07:00 - INFO - Attempting prediction for rl
2024-09-19 15:07:00 - INFO - Preparing state for RL agent.
2024-09-19 15:07:00 - INFO - Prepared state: [[ 8.25840000e+07  1.15515684e+01 -1.76477699e-03  8.29805500e+07
   4.04597691e+01]]
2024-09-19 15:07:00 - INFO - RL prediction: 83410850.0
2024-09-19 15:07:00 - INFO - Attempting prediction for arima
2024-09-19 15:07:00 - INFO - ARIMA 예측 시작
2024-09-19 15:07:00 - INFO - 입력 데이터: {'open': 82750000.0, 'high': 82780000.0, 'low': 82576000.0, 'close': 82584000.0, 'volume': 11.55156842, 'value': 955123682.55599, 'decision': 'sell', 'sma': 82980550.0, 'ema': 82877593.5479715, 'rsi': 40.45976913412962, 'macd': 7819.894366443157, 'signal_line': 87474.02004882172, 'BB_Upper': 83336015.59608942, 'BB_Lower': 82625084.40391058}
2024-09-19 15:07:00 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:07:00 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82980550.0         0         0
2024-09-19 15:07:00 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82980550.0         0         0
2024-09-19 15:07:00 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:07:00 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:07:00 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:07:00 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:07:00 - INFO - Attempting prediction for prophet
2024-09-19 15:07:00 - INFO - PROPHET prediction: 82544111.31891696
2024-09-19 15:07:00 - INFO - Attempting prediction for transformer
2024-09-19 15:07:00 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:07:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:07:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:07:00 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:07:00 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:07:00 - INFO - X 샘플:
[[-0.74674616 -0.12968354 -0.30037932 -0.1404314   2.01146876  2.0104384
  -0.1404314  -0.1404314   0.          0.          0.         -0.1404314
  -0.1404314 ]
 [-0.83685128  0.4358537  -0.26575346  0.40441173  0.66439724  0.66491772
   0.40441173  0.40441173  0.          0.          0.          0.40441173
   0.40441173]
 [ 0.87514595  0.60161461  0.78167874  0.78043022 -0.55232864 -0.54980424
   0.78043022  0.78043022  0.          0.          0.          0.78043022
   0.78043022]
 [ 1.26935584  1.68393587  1.41360064  1.57083645  0.96018214  0.96944346
   1.57083645  1.57083645  0.          0.          0.          1.57083645
   1.57083645]
 [ 1.41577666  1.1574012   1.12793731  0.78043022 -1.27492272 -1.27276153
   0.78043022  0.78043022  0.          0.          0.          0.78043022
   0.78043022]
 [ 1.07788247  0.53336012  0.72108349  0.5809102  -1.28487624 -1.28392136
   0.5809102   0.5809102   0.          0.          0.          0.5809102
   0.5809102 ]
 [-0.1047472  -0.58796371 -0.21381467 -0.43971142 -0.58960318 -0.59086376
  -0.43971142 -0.43971142  0.          0.          0.         -0.43971142
  -0.43971142]
 [-0.69043046 -1.03649324 -0.29172285 -0.44738527 -0.64137631 -0.64344859
  -0.44738527 -0.44738527  0.          0.          0.         -0.44738527
  -0.44738527]
 [-0.84811442 -1.23150608 -0.81976718 -0.98455455  0.34220359  0.33834048
  -0.98455455 -0.98455455  0.          0.          0.         -0.98455455
  -0.98455455]
 [-1.4112714  -1.42651892 -2.1528627  -2.10493618  0.36485535  0.35765942
  -2.10493618 -2.10493618  0.          0.          0.         -2.10493618
  -2.10493618]]
2024-09-19 15:07:00 - INFO - y 샘플:
[-2.10493618]
2024-09-19 15:07:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:07:00 - INFO - 모델 출력 (스케일링된 예측): [0.358009]
2024-09-19 15:07:00 - INFO - 스케일러 역변환 후 예측 가격: 82904953.1348265
2024-09-19 15:07:00 - INFO - TransformerPredictor 최종 예측 가격: 82904953.1348265
2024-09-19 15:07:00 - INFO - TRANSFORMER prediction: 82904953.1348265
2024-09-19 15:07:00 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:07:00 - INFO - BITCOIN_FORECAST prediction: 82173788.66914923
2024-09-19 15:07:00 - INFO - BitcoinForecast prediction: 82173788.66914923
2024-09-19 15:07:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:07:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:07:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0036668801644902764, 'ml': 0.2729295665136455, 'xgboost': 0.06001322584497623, 'rl': 0.1057714036001835, 'lstm': 0.1057714036001835, 'arima': 0.08562498061234657, 'prophet': 0.09105825921344697, 'transformer': 0.18832155446556098, 'bitcoin_forecast': 0.08684272598516636}
2024-09-19 15:07:07 - INFO - 조정된 모델 가중치: {'gpt': 0.0036668801644902764, 'ml': 0.2729295665136455, 'xgboost': 0.06001322584497623, 'rl': 0.1057714036001835, 'lstm': 0.1057714036001835, 'arima': 0.08562498061234657, 'prophet': 0.09105825921344697, 'transformer': 0.18832155446556098, 'bitcoin_forecast': 0.08684272598516636}
2024-09-19 15:07:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82581131.40002218, 'current_price': 82585000.0, 'predictions': {'gpt': 82585000.0, 'ml': 82584000.0, 'xgboost': 82584000.0, 'lstm': 82893747.34279361, 'rl': 83410850.0, 'arima': 80899000.0, 'prophet': 82544111.31891696, 'transformer': 82904953.1348265, 'bitcoin_forecast': 82173788.66914923}, 'weights': {'gpt': 0.0036668801644902764, 'ml': 0.2729295665136455, 'xgboost': 0.06001322584497623, 'rl': 0.1057714036001835, 'lstm': 0.1057714036001835, 'arima': 0.08562498061234657, 'prophet': 0.09105825921344697, 'transformer': 0.18832155446556098, 'bitcoin_forecast': 0.08684272598516636}}
2024-09-19 15:07:07 - INFO - 모델별 가중치:
2024-09-19 15:07:07 - INFO -   - GPT: 0.0037
2024-09-19 15:07:07 - INFO -   - ML: 0.2729
2024-09-19 15:07:07 - INFO -   - XGBOOST: 0.0600
2024-09-19 15:07:07 - INFO -   - RL: 0.1058
2024-09-19 15:07:07 - INFO -   - LSTM: 0.1058
2024-09-19 15:07:07 - INFO -   - ARIMA: 0.0856
2024-09-19 15:07:07 - INFO -   - PROPHET: 0.0911
2024-09-19 15:07:07 - INFO -   - TRANSFORMER: 0.1883
2024-09-19 15:07:07 - INFO -   - BITCOIN_FORECAST: 0.0868
2024-09-19 15:07:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:07:07 - INFO - 6. 거래 실행
2024-09-19 15:07:07 - INFO - Cancelling existing orders.
2024-09-19 15:07:07 - INFO - Cancelled 0 orders.
2024-09-19 15:07:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82581131.40002218, 'current_price': 82585000.0, 'predictions': {'gpt': 82585000.0, 'ml': 82584000.0, 'xgboost': 82584000.0, 'lstm': 82893747.34279361, 'rl': 83410850.0, 'arima': 80899000.0, 'prophet': 82544111.31891696, 'transformer': 82904953.1348265, 'bitcoin_forecast': 82173788.66914923}, 'weights': {'gpt': 0.0036668801644902764, 'ml': 0.2729295665136455, 'xgboost': 0.06001322584497623, 'rl': 0.1057714036001835, 'lstm': 0.1057714036001835, 'arima': 0.08562498061234657, 'prophet': 0.09105825921344697, 'transformer': 0.18832155446556098, 'bitcoin_forecast': 0.08684272598516636}}, 현재 가격=82585000.0
2024-09-19 15:07:07 - INFO - 현재 잔고: KRW=279815.96646242, BTC=0.00237168, 총 자산가치=475681.15926242
2024-09-19 15:07:07 - INFO - 매도 시도: 0.00023716800000000006 BTC (약 19586.519280000004 KRW)
2024-09-19 15:07:07 - INFO - 주문 결과: {'uuid': '104ec244-69c8-4459-8ba5-c6e68914644c', 'side': 'ask', 'ord_type': 'limit', 'price': '82585000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:07:09+09:00', 'volume': '0.00023716', 'remaining_volume': '0.00023716', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00023716', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:07:07 - INFO - sell 주문 성공: UUID=104ec244-69c8-4459-8ba5-c6e68914644c
2024-09-19 15:07:07 - INFO - Trade executed successfully.
2024-09-19 15:07:07 - INFO - 7. summary 리포트 보내기
2024-09-19 15:07:07 - INFO - Message sent to Discord successfully.
2024-09-19 15:07:07 - INFO - Trading cycle completed.
2024-09-19 15:07:07 - INFO - Performing periodic update.
2024-09-19 15:07:07 - INFO - 계산된 시장 변동성: 0.03816047251374848
2024-09-19 15:15:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:15:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d9-bfab-d5d75386f2f2 "HTTP/1.1 200 OK"
2024-09-19 15:15:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:15:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:15:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-bc44-d64c6fc248cf "HTTP/1.1 200 OK"
2024-09-19 15:15:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:15:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-a4ee-d1977616b529 "HTTP/1.1 200 OK"
2024-09-19 15:16:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-8a44-daeeffbcf0dc "HTTP/1.1 200 OK"
2024-09-19 15:16:05 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8153-88cd-e4dba58d6972 "HTTP/1.1 200 OK"
2024-09-19 15:16:15 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f5-ba18-ffdca79d94dc "HTTP/1.1 200 OK"
2024-09-19 15:16:27 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a3-8b52-c90f77bf6b4b "HTTP/1.1 200 OK"
2024-09-19 15:16:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-afd7-ca1ae39ec2a9 "HTTP/1.1 200 OK"
2024-09-19 15:16:39 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:16:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8195-92d0-f7cda4e4d170 "HTTP/1.1 200 OK"
2024-09-19 15:16:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:05:34.926107
2024-09-19 15:16:48 - INFO - Starting trading cycle.
2024-09-19 15:16:48 - INFO - ##################################################
2024-09-19 15:16:48 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-19 15:16:48 - INFO - ##################################################
2024-09-19 15:16:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:16:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:16:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:00:00
2024-09-19 15:16:48 - INFO - 새로운 데이터 범위: 2024-09-18 06:00:00 ~ 2024-09-19 15:10:00
2024-09-19 15:16:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:16:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:16:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:16:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:16:48 - INFO - Sample date values: [Timestamp('2024-09-19 15:10:00')]
2024-09-19 15:16:48 - INFO - Successfully added 1 new data points
2024-09-19 15:16:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:16:48 - INFO - Final date range: 2024-09-19 15:10:00 to 2024-09-19 15:10:00
2024-09-19 15:16:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:16:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:10:00
2024-09-19 15:16:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:16:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:16:49 - INFO - GPT | 이전예측가격: 82585000 | 당시BTC가격: 82585000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:16:49 - INFO - ML | 이전예측가격: 82584000 | 당시BTC가격: 82585000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:16:49 - INFO - XGBOOST | 이전예측가격: 82584000 | 당시BTC가격: 82585000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:16:49 - INFO - LSTM 모델 예측 업데이트: 정확도 36.36%, 적중/전체: 4/11
2024-09-19 15:16:49 - INFO - LSTM | 이전예측가격: 82893747 | 당시BTC가격: 82585000 | 예측: 상승 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1009 | 반영가중치값: -0.0200 | 새 가중치: 0.0809 | 예측 총 횟수: 11 | 예측 성공 수: 4 | 예측 성공률: 36.36%
2024-09-19 15:16:49 - INFO - RL 모델 예측 업데이트: 정확도 27.27%, 적중/전체: 3/11
2024-09-19 15:16:49 - INFO - RL | 이전예측가격: 83410850 | 당시BTC가격: 82585000 | 예측: 상승 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0599 | 반영가중치값: -0.0200 | 새 가중치: 0.0399 | 예측 총 횟수: 11 | 예측 성공 수: 3 | 예측 성공률: 27.27%
2024-09-19 15:16:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.83%, 적중/전체: 104/183
2024-09-19 15:16:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82585000 | 예측: 하락 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1906 | 반영가중치값: 0.0200 | 새 가중치: 0.2106 | 예측 총 횟수: 183 | 예측 성공 수: 104 | 예측 성공률: 56.83%
2024-09-19 15:16:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 6/9
2024-09-19 15:16:49 - INFO - PROPHET | 이전예측가격: 82544111 | 당시BTC가격: 82585000 | 예측: 하락 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0751 | 반영가중치값: 0.0200 | 새 가중치: 0.0951 | 예측 총 횟수: 9 | 예측 성공 수: 6 | 예측 성공률: 66.67%
2024-09-19 15:16:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 15/30
2024-09-19 15:16:49 - INFO - TRANSFORMER | 이전예측가격: 82904953 | 당시BTC가격: 82585000 | 예측: 상승 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1286 | 반영가중치값: -0.0200 | 새 가중치: 0.1086 | 예측 총 횟수: 30 | 예측 성공 수: 15 | 예측 성공률: 50.00%
2024-09-19 15:16:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 61.29%, 적중/전체: 19/31
2024-09-19 15:16:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 82173789 | 당시BTC가격: 82585000 | 예측: 하락 | 지금 BTC가격: 82517000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1601 | 반영가중치값: 0.0200 | 새 가중치: 0.1801 | 예측 총 횟수: 31 | 예측 성공 수: 19 | 예측 성공률: 61.29%
2024-09-19 15:16:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:16:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:16:49 - INFO - 새로운 가중치: {'gpt': 0.0034865526836623333, 'ml': 0.25950761134601336, 'xgboost': 0.057061933916272775, 'rl': 0.037952339232987985, 'lstm': 0.07695467291505524, 'arima': 0.2001979202589388, 'prophet': 0.09037999113494881, 'transformer': 0.10324025641399247, 'bitcoin_forecast': 0.17121872209812816}
2024-09-19 15:16:49 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:16:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:16:49 - INFO - Current BTC price: 82517000.0
2024-09-19 15:16:49 - INFO - Analyzing market conditions.
2024-09-19 15:16:49 - INFO - Market analysis: {'current_price': 82517000.0, 'sma_20': 82940400.0, 'rsi_14': 38.51122563826833, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:16:49 - INFO - Starting predictions for all models
2024-09-19 15:16:49 - INFO - Attempting prediction for gpt
2024-09-19 15:16:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:16:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:16:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:16:49 - INFO - GPT prediction: 82517000.0
2024-09-19 15:16:49 - INFO - Attempting prediction for ml
2024-09-19 15:16:49 - INFO - ML prediction: 82335462.60000001
2024-09-19 15:16:49 - INFO - Attempting prediction for xgboost
2024-09-19 15:16:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:16:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:16:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:16:49 - INFO - XGBOOST prediction: 82517000.0
2024-09-19 15:16:49 - INFO - Attempting prediction for lstm
2024-09-19 15:16:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:16:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:16:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:16:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:16:49 - INFO - X 샘플:
[[-0.31603512  0.53754156 -0.01122739  0.51207421  0.38756608  0.39113206
   0.51207421]
 [ 0.76345562  0.66570715  0.78789895  0.80726993 -0.52337096 -0.52200397
   0.80726993]
 [ 1.01202256  1.50255306  1.2700165   1.42778338  0.60901401  0.62005146
   1.42778338]
 [ 1.10434743  1.09543884  1.05207295  0.80726993 -1.06436194 -1.06546854
   0.80726993]
 [ 0.89129004  0.61293309  0.7416685   0.65063547 -1.07181393 -1.07385766
   0.65063547]
 [ 0.14558921 -0.25406943  0.0283987  -0.15061006 -0.55127763 -0.55286941
  -0.15061006]
 [-0.22371025 -0.60087044 -0.03104044 -0.15663446 -0.59003908 -0.5923987
  -0.15663446]
 [-0.32313703 -0.75165349 -0.43390579 -0.57834264  0.14634648  0.14563601
  -0.57834264]
 [-0.67823266 -0.90243654 -1.45097569 -1.4579054   0.16330537  0.16015852
  -1.4579054 ]
 [-2.3755898  -1.9051438  -1.95290628 -1.86154036  2.4946316   2.48962023
  -1.86154036]]
2024-09-19 15:16:49 - INFO - y 샘플:
[-1.86154036]
2024-09-19 15:16:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:16:49 - INFO - 모델 출력 (스케일링된 예측): [[0.26140654]]
2024-09-19 15:16:49 - INFO - 스케일러 역변환 후 예측 가격: 82869391.28109504
2024-09-19 15:16:49 - INFO - LSTMPredictor 최종 예측 가격: 82869391.28109504
2024-09-19 15:16:49 - INFO - LSTM prediction: 82869391.28109504
2024-09-19 15:16:49 - INFO - Attempting prediction for rl
2024-09-19 15:16:49 - INFO - Preparing state for RL agent.
2024-09-19 15:16:49 - INFO - Prepared state: [[ 8.25170000e+07  2.20258625e+01 -8.11295166e-04  8.29404000e+07
   3.85112256e+01]]
2024-09-19 15:16:49 - INFO - RL prediction: 83342170.0
2024-09-19 15:16:49 - INFO - Attempting prediction for arima
2024-09-19 15:16:49 - INFO - ARIMA 예측 시작
2024-09-19 15:16:49 - INFO - 입력 데이터: {'open': 82511000.0, 'high': 82647000.0, 'low': 82500000.0, 'close': 82517000.0, 'volume': 22.02586251, 'value': 1818302508.19951, 'decision': 'sell', 'sma': 82940400.0, 'ema': 82843251.30530755, 'rsi': 38.51122563826833, 'macd': -19551.931807890534, 'signal_line': 66068.82967747928, 'BB_Upper': 83314349.40834506, 'BB_Lower': 82566450.59165494}
2024-09-19 15:16:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:16:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82940400.0         0         0
2024-09-19 15:16:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82940400.0         0         0
2024-09-19 15:16:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:16:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:16:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:16:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:16:49 - INFO - Attempting prediction for prophet
2024-09-19 15:16:49 - INFO - PROPHET prediction: 82471372.57666643
2024-09-19 15:16:49 - INFO - Attempting prediction for transformer
2024-09-19 15:16:49 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:16:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:16:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:16:49 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:16:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:16:49 - INFO - X 샘플:
[[-0.31603512  0.53754156 -0.01122739  0.51207421  0.38756608  0.39113206
   0.51207421  0.51207421  0.          0.          0.          0.51207421
   0.51207421]
 [ 0.76345562  0.66570715  0.78789895  0.80726993 -0.52337096 -0.52200397
   0.80726993  0.80726993  0.          0.          0.          0.80726993
   0.80726993]
 [ 1.01202256  1.50255306  1.2700165   1.42778338  0.60901401  0.62005146
   1.42778338  1.42778338  0.          0.          0.          1.42778338
   1.42778338]
 [ 1.10434743  1.09543884  1.05207295  0.80726993 -1.06436194 -1.06546854
   0.80726993  0.80726993  0.          0.          0.          0.80726993
   0.80726993]
 [ 0.89129004  0.61293309  0.7416685   0.65063547 -1.07181393 -1.07385766
   0.65063547  0.65063547  0.          0.          0.          0.65063547
   0.65063547]
 [ 0.14558921 -0.25406943  0.0283987  -0.15061006 -0.55127763 -0.55286941
  -0.15061006 -0.15061006  0.          0.          0.         -0.15061006
  -0.15061006]
 [-0.22371025 -0.60087044 -0.03104044 -0.15663446 -0.59003908 -0.5923987
  -0.15663446 -0.15663446  0.          0.          0.         -0.15663446
  -0.15663446]
 [-0.32313703 -0.75165349 -0.43390579 -0.57834264  0.14634648  0.14563601
  -0.57834264 -0.57834264  0.          0.          0.         -0.57834264
  -0.57834264]
 [-0.67823266 -0.90243654 -1.45097569 -1.4579054   0.16330537  0.16015852
  -1.4579054  -1.4579054   0.          0.          0.         -1.4579054
  -1.4579054 ]
 [-2.3755898  -1.9051438  -1.95290628 -1.86154036  2.4946316   2.48962023
  -1.86154036 -1.86154036  0.          0.          0.         -1.86154036
  -1.86154036]]
2024-09-19 15:16:49 - INFO - y 샘플:
[-1.86154036]
2024-09-19 15:16:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:16:49 - INFO - 모델 출력 (스케일링된 예측): [0.3557412]
2024-09-19 15:16:49 - INFO - 스케일러 역변환 후 예측 가격: 82885050.03936677
2024-09-19 15:16:49 - INFO - TransformerPredictor 최종 예측 가격: 82885050.03936677
2024-09-19 15:16:49 - INFO - TRANSFORMER prediction: 82885050.03936677
2024-09-19 15:16:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:16:49 - INFO - BITCOIN_FORECAST prediction: 82221910.58746608
2024-09-19 15:16:49 - INFO - BitcoinForecast prediction: 82221910.58746608
2024-09-19 15:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:17:03 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:17:03 - INFO - 조정된 모델 가중치: {'gpt': 0.0034865526836623333, 'ml': 0.25950761134601336, 'xgboost': 0.057061933916272775, 'rl': 0.037952339232987985, 'lstm': 0.07695467291505524, 'arima': 0.2001979202589388, 'prophet': 0.09037999113494881, 'transformer': 0.10324025641399247, 'bitcoin_forecast': 0.17121872209812816}
2024-09-19 15:17:03 - INFO - 조정된 모델 가중치: {'gpt': 0.0034865526836623333, 'ml': 0.25950761134601336, 'xgboost': 0.057061933916272775, 'rl': 0.037952339232987985, 'lstm': 0.07695467291505524, 'arima': 0.2001979202589388, 'prophet': 0.09037999113494881, 'transformer': 0.10324025641399247, 'bitcoin_forecast': 0.17121872209812816}
2024-09-19 15:17:03 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82187753.657719, 'current_price': 82517000.0, 'predictions': {'gpt': 82517000.0, 'ml': 82335462.60000001, 'xgboost': 82517000.0, 'lstm': 82869391.28109504, 'rl': 83342170.0, 'arima': 80899000.0, 'prophet': 82471372.57666643, 'transformer': 82885050.03936677, 'bitcoin_forecast': 82221910.58746608}, 'weights': {'gpt': 0.0034865526836623333, 'ml': 0.25950761134601336, 'xgboost': 0.057061933916272775, 'rl': 0.037952339232987985, 'lstm': 0.07695467291505524, 'arima': 0.2001979202589388, 'prophet': 0.09037999113494881, 'transformer': 0.10324025641399247, 'bitcoin_forecast': 0.17121872209812816}}
2024-09-19 15:17:03 - INFO - 모델별 가중치:
2024-09-19 15:17:03 - INFO -   - GPT: 0.0035
2024-09-19 15:17:03 - INFO -   - ML: 0.2595
2024-09-19 15:17:03 - INFO -   - XGBOOST: 0.0571
2024-09-19 15:17:03 - INFO -   - RL: 0.0380
2024-09-19 15:17:03 - INFO -   - LSTM: 0.0770
2024-09-19 15:17:03 - INFO -   - ARIMA: 0.2002
2024-09-19 15:17:03 - INFO -   - PROPHET: 0.0904
2024-09-19 15:17:03 - INFO -   - TRANSFORMER: 0.1032
2024-09-19 15:17:03 - INFO -   - BITCOIN_FORECAST: 0.1712
2024-09-19 15:17:03 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:17:03 - INFO - 6. 거래 실행
2024-09-19 15:17:03 - INFO - Cancelling existing orders.
2024-09-19 15:17:03 - INFO - Cancelled 0 orders.
2024-09-19 15:17:03 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82187753.657719, 'current_price': 82517000.0, 'predictions': {'gpt': 82517000.0, 'ml': 82335462.60000001, 'xgboost': 82517000.0, 'lstm': 82869391.28109504, 'rl': 83342170.0, 'arima': 80899000.0, 'prophet': 82471372.57666643, 'transformer': 82885050.03936677, 'bitcoin_forecast': 82221910.58746608}, 'weights': {'gpt': 0.0034865526836623333, 'ml': 0.25950761134601336, 'xgboost': 0.057061933916272775, 'rl': 0.037952339232987985, 'lstm': 0.07695467291505524, 'arima': 0.2001979202589388, 'prophet': 0.09037999113494881, 'transformer': 0.10324025641399247, 'bitcoin_forecast': 0.17121872209812816}}, 현재 가격=82517000.0
2024-09-19 15:17:03 - INFO - 현재 잔고: KRW=299392.03213312, BTC=0.00213452, 총 자산가치=475526.21897312
2024-09-19 15:17:03 - INFO - 매도 시도: 0.00021345200000000002 BTC (약 17613.418684 KRW)
2024-09-19 15:17:03 - INFO - 주문 결과: {'uuid': 'f62734ad-a13a-47b4-86de-0826a2c8c3cf', 'side': 'ask', 'ord_type': 'limit', 'price': '82517000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:17:05+09:00', 'volume': '0.00021345', 'remaining_volume': '0.00021345', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00021345', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:17:03 - INFO - sell 주문 성공: UUID=f62734ad-a13a-47b4-86de-0826a2c8c3cf
2024-09-19 15:17:03 - INFO - Trade executed successfully.
2024-09-19 15:17:03 - INFO - 7. summary 리포트 보내기
2024-09-19 15:17:04 - INFO - Message sent to Discord successfully.
2024-09-19 15:17:04 - INFO - Trading cycle completed.
2024-09-19 15:17:04 - INFO - Performing periodic update.
2024-09-19 15:17:04 - INFO - 계산된 시장 변동성: 0.03799889282565963
2024-09-19 15:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:25:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cc-97a0-e36b70e3f365 "HTTP/1.1 200 OK"
2024-09-19 15:25:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:25:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:25:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ce-bfa1-f6008e1434ea "HTTP/1.1 200 OK"
2024-09-19 15:25:58 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-85a4-fcaa493176bf "HTTP/1.1 200 OK"
2024-09-19 15:26:09 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812f-816b-d38d773e7d6c "HTTP/1.1 200 OK"
2024-09-19 15:26:19 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-8010-c899b31d7420 "HTTP/1.1 200 OK"
2024-09-19 15:26:31 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8136-8b02-d37c16ad54a4 "HTTP/1.1 200 OK"
2024-09-19 15:26:40 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b1-b610-c97238ae8415 "HTTP/1.1 200 OK"
2024-09-19 15:26:46 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:26:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8161-b819-cc580de37c60 "HTTP/1.1 200 OK"
2024-09-19 15:26:52 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:27:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8139-8428-cd95bb5a699f "HTTP/1.1 200 OK"
2024-09-19 15:27:00 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:15:34.926180
2024-09-19 15:27:00 - INFO - Starting trading cycle.
2024-09-19 15:27:00 - INFO - ##################################################
2024-09-19 15:27:00 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-19 15:27:00 - INFO - ##################################################
2024-09-19 15:27:00 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:27:00 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:27:00 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:10:00
2024-09-19 15:27:00 - INFO - 새로운 데이터 범위: 2024-09-18 06:10:00 ~ 2024-09-19 15:20:00
2024-09-19 15:27:00 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:27:00 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:27:00 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:27:00 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:27:00 - INFO - Sample date values: [Timestamp('2024-09-19 15:20:00')]
2024-09-19 15:27:01 - INFO - Successfully added 1 new data points
2024-09-19 15:27:01 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:27:01 - INFO - Final date range: 2024-09-19 15:20:00 to 2024-09-19 15:20:00
2024-09-19 15:27:01 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:27:01 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:20:00
2024-09-19 15:27:01 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:27:01 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:27:01 - INFO - GPT | 이전예측가격: 82517000 | 당시BTC가격: 82517000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:27:01 - INFO - ML 모델 예측 업데이트: 정확도 57.97%, 적중/전체: 40/69
2024-09-19 15:27:01 - INFO - ML | 이전예측가격: 82335463 | 당시BTC가격: 82517000 | 예측: 하락 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2729 | 반영가중치값: -0.0200 | 새 가중치: 0.2529 | 예측 총 횟수: 69 | 예측 성공 수: 40 | 예측 성공률: 57.97%
2024-09-19 15:27:01 - INFO - XGBOOST | 이전예측가격: 82517000 | 당시BTC가격: 82517000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:27:01 - INFO - LSTM 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-19 15:27:01 - INFO - LSTM | 이전예측가격: 82869391 | 당시BTC가격: 82517000 | 예측: 상승 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1058 | 반영가중치값: 0.0200 | 새 가중치: 0.1258 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-19 15:27:01 - INFO - RL 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 4/12
2024-09-19 15:27:01 - INFO - RL | 이전예측가격: 83342170 | 당시BTC가격: 82517000 | 예측: 상승 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1058 | 반영가중치값: 0.0200 | 새 가중치: 0.1258 | 예측 총 횟수: 12 | 예측 성공 수: 4 | 예측 성공률: 33.33%
2024-09-19 15:27:01 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.52%, 적중/전체: 104/184
2024-09-19 15:27:01 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82517000 | 예측: 하락 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0856 | 반영가중치값: -0.0200 | 새 가중치: 0.0656 | 예측 총 횟수: 184 | 예측 성공 수: 104 | 예측 성공률: 56.52%
2024-09-19 15:27:01 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-19 15:27:01 - INFO - PROPHET | 이전예측가격: 82471373 | 당시BTC가격: 82517000 | 예측: 하락 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0911 | 반영가중치값: -0.0200 | 새 가중치: 0.0711 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-19 15:27:01 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 51.61%, 적중/전체: 16/31
2024-09-19 15:27:01 - INFO - TRANSFORMER | 이전예측가격: 82885050 | 당시BTC가격: 82517000 | 예측: 상승 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1883 | 반영가중치값: 0.0200 | 새 가중치: 0.2083 | 예측 총 횟수: 31 | 예측 성공 수: 16 | 예측 성공률: 51.61%
2024-09-19 15:27:01 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 59.38%, 적중/전체: 19/32
2024-09-19 15:27:01 - INFO - BITCOIN_FORECAST | 이전예측가격: 82221911 | 당시BTC가격: 82517000 | 예측: 하락 | 지금 BTC가격: 82744000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0868 | 반영가중치값: -0.0200 | 새 가중치: 0.0668 | 예측 총 횟수: 32 | 예측 성공 수: 19 | 예측 성공률: 59.38%
2024-09-19 15:27:01 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:27:01 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:27:01 - INFO - 새로운 가중치: {'gpt': 0.0035691120246464374, 'ml': 0.2589187771240606, 'xgboost': 0.05841312407080027, 'rl': 0.1287495901179245, 'lstm': 0.1287495901179245, 'arima': 0.06717893824414659, 'prophet': 0.07274087341274756, 'transformer': 0.21325447583802531, 'bitcoin_forecast': 0.06842551904972423}
2024-09-19 15:27:01 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:27:01 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:27:01 - INFO - Current BTC price: 82744000.0
2024-09-19 15:27:01 - INFO - Analyzing market conditions.
2024-09-19 15:27:01 - INFO - Market analysis: {'current_price': 82744000.0, 'sma_20': 82916000.0, 'rsi_14': 47.701197596680316, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:27:01 - INFO - Starting predictions for all models
2024-09-19 15:27:01 - INFO - Attempting prediction for gpt
2024-09-19 15:27:02 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:27:02 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:27:02 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:27:02 - INFO - GPT prediction: 82744000.0
2024-09-19 15:27:02 - INFO - Attempting prediction for ml
2024-09-19 15:27:02 - INFO - ML prediction: 82777097.6
2024-09-19 15:27:02 - INFO - Attempting prediction for xgboost
2024-09-19 15:27:02 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:27:02 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:27:02 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:27:02 - INFO - XGBOOST prediction: 82744000.0
2024-09-19 15:27:02 - INFO - Attempting prediction for lstm
2024-09-19 15:27:02 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:27:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:27:02 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:27:02 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:27:02 - INFO - X 샘플:
[[ 0.80441014  0.805071    0.8542879   0.91334658 -0.57475161 -0.57320254
   0.91334658]
 [ 1.03461745  1.61159519  1.3006946   1.53759807  0.48135916  0.49200531
   1.53759807]
 [ 1.12012303  1.21923207  1.09889431  0.91334658 -1.07930298 -1.08009801
   0.91334658]
 [ 0.92280247  0.75420911  0.81148178  0.75576854 -1.08625302 -1.08792263
   0.75576854]
 [ 0.23218052 -0.08137902  0.15104446 -0.05030376 -0.60077856 -0.60199108
  -0.05030376]
 [-0.10984178 -0.41561427  0.09600802 -0.05636445 -0.63692915 -0.63886049
  -0.05636445]
 [-0.2019247  -0.56093394 -0.27701676 -0.48061303  0.04985559  0.04951272
  -0.48061303]
 [-0.5307923  -0.70625362 -1.21875146 -1.36547436  0.06567218  0.06305803
  -1.36547436]
 [-2.1027794  -1.67262945 -1.68350364 -1.77154085  2.23996696  2.23577297
  -1.77154085]
 [-1.16879543 -0.95329706 -1.13313921 -0.39576332  1.14116143  1.14172574
  -0.39576332]]
2024-09-19 15:27:02 - INFO - y 샘플:
[-0.39576332]
2024-09-19 15:27:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:27:02 - INFO - 모델 출력 (스케일링된 예측): [[0.24853508]]
2024-09-19 15:27:02 - INFO - 스케일러 역변환 후 예측 가격: 82850307.69350556
2024-09-19 15:27:02 - INFO - LSTMPredictor 최종 예측 가격: 82850307.69350556
2024-09-19 15:27:02 - INFO - LSTM prediction: 82850307.69350556
2024-09-19 15:27:02 - INFO - Attempting prediction for rl
2024-09-19 15:27:02 - INFO - Preparing state for RL agent.
2024-09-19 15:27:02 - INFO - Prepared state: [[8.27440000e+07 1.67325544e+01 2.75094829e-03 8.29160000e+07
  4.77011976e+01]]
2024-09-19 15:27:02 - INFO - RL prediction: 82744000.0
2024-09-19 15:27:02 - INFO - Attempting prediction for arima
2024-09-19 15:27:02 - INFO - ARIMA 예측 시작
2024-09-19 15:27:02 - INFO - 입력 데이터: {'open': 82653000.0, 'high': 82746000.0, 'low': 82590000.0, 'close': 82744000.0, 'volume': 16.73255437, 'value': 1383658098.88592, 'decision': 'sell', 'sma': 82916000.0, 'ema': 82833798.80004017, 'rsi': 47.701197596680316, 'macd': -22666.01861900091, 'signal_line': 48321.86001818325, 'BB_Upper': 83274001.67597598, 'BB_Lower': 82557998.32402402}
2024-09-19 15:27:02 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:27:02 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82916000.0         0         0
2024-09-19 15:27:02 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82916000.0         0         0
2024-09-19 15:27:02 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:27:02 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:27:02 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:27:02 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:27:02 - INFO - Attempting prediction for prophet
2024-09-19 15:27:02 - INFO - PROPHET prediction: 82745206.21947573
2024-09-19 15:27:02 - INFO - Attempting prediction for transformer
2024-09-19 15:27:02 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:27:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:27:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:27:02 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:27:02 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:27:02 - INFO - X 샘플:
[[ 0.80441014  0.805071    0.8542879   0.91334658 -0.57475161 -0.57320254
   0.91334658  0.91334658  0.          0.          0.          0.91334658
   0.91334658]
 [ 1.03461745  1.61159519  1.3006946   1.53759807  0.48135916  0.49200531
   1.53759807  1.53759807  0.          0.          0.          1.53759807
   1.53759807]
 [ 1.12012303  1.21923207  1.09889431  0.91334658 -1.07930298 -1.08009801
   0.91334658  0.91334658  0.          0.          0.          0.91334658
   0.91334658]
 [ 0.92280247  0.75420911  0.81148178  0.75576854 -1.08625302 -1.08792263
   0.75576854  0.75576854  0.          0.          0.          0.75576854
   0.75576854]
 [ 0.23218052 -0.08137902  0.15104446 -0.05030376 -0.60077856 -0.60199108
  -0.05030376 -0.05030376  0.          0.          0.         -0.05030376
  -0.05030376]
 [-0.10984178 -0.41561427  0.09600802 -0.05636445 -0.63692915 -0.63886049
  -0.05636445 -0.05636445  0.          0.          0.         -0.05636445
  -0.05636445]
 [-0.2019247  -0.56093394 -0.27701676 -0.48061303  0.04985559  0.04951272
  -0.48061303 -0.48061303  0.          0.          0.         -0.48061303
  -0.48061303]
 [-0.5307923  -0.70625362 -1.21875146 -1.36547436  0.06567218  0.06305803
  -1.36547436 -1.36547436  0.          0.          0.         -1.36547436
  -1.36547436]
 [-2.1027794  -1.67262945 -1.68350364 -1.77154085  2.23996696  2.23577297
  -1.77154085 -1.77154085  0.          0.          0.         -1.77154085
  -1.77154085]
 [-1.16879543 -0.95329706 -1.13313921 -0.39576332  1.14116143  1.14172574
  -0.39576332 -0.39576332  0.          0.          0.         -0.39576332
  -0.39576332]]
2024-09-19 15:27:02 - INFO - y 샘플:
[-0.39576332]
2024-09-19 15:27:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:27:02 - INFO - 모델 출력 (스케일링된 예측): [0.35105035]
2024-09-19 15:27:02 - INFO - 스케일러 역변환 후 예측 가격: 82867222.46687046
2024-09-19 15:27:02 - INFO - TransformerPredictor 최종 예측 가격: 82867222.46687046
2024-09-19 15:27:02 - INFO - TRANSFORMER prediction: 82867222.46687046
2024-09-19 15:27:02 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:27:02 - INFO - BITCOIN_FORECAST prediction: 82171908.36177461
2024-09-19 15:27:02 - INFO - BitcoinForecast prediction: 82171908.36177461
2024-09-19 15:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:27:13 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:27:13 - INFO - 조정된 모델 가중치: {'gpt': 0.0035691120246464374, 'ml': 0.2589187771240606, 'xgboost': 0.05841312407080027, 'rl': 0.1287495901179245, 'lstm': 0.1287495901179245, 'arima': 0.06717893824414659, 'prophet': 0.07274087341274756, 'transformer': 0.21325447583802531, 'bitcoin_forecast': 0.06842551904972423}
2024-09-19 15:27:13 - INFO - 조정된 모델 가중치: {'gpt': 0.0035691120246464374, 'ml': 0.2589187771240606, 'xgboost': 0.05841312407080027, 'rl': 0.1287495901179245, 'lstm': 0.1287495901179245, 'arima': 0.06717893824414659, 'prophet': 0.07274087341274756, 'transformer': 0.21325447583802531, 'bitcoin_forecast': 0.06842551904972423}
2024-09-19 15:27:13 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82629531.33777505, 'current_price': 82744000.0, 'predictions': {'gpt': 82744000.0, 'ml': 82777097.6, 'xgboost': 82744000.0, 'lstm': 82850307.69350556, 'rl': 82744000.0, 'arima': 80899000.0, 'prophet': 82745206.21947573, 'transformer': 82867222.46687046, 'bitcoin_forecast': 82171908.36177461}, 'weights': {'gpt': 0.0035691120246464374, 'ml': 0.2589187771240606, 'xgboost': 0.05841312407080027, 'rl': 0.1287495901179245, 'lstm': 0.1287495901179245, 'arima': 0.06717893824414659, 'prophet': 0.07274087341274756, 'transformer': 0.21325447583802531, 'bitcoin_forecast': 0.06842551904972423}}
2024-09-19 15:27:13 - INFO - 모델별 가중치:
2024-09-19 15:27:13 - INFO -   - GPT: 0.0036
2024-09-19 15:27:13 - INFO -   - ML: 0.2589
2024-09-19 15:27:13 - INFO -   - XGBOOST: 0.0584
2024-09-19 15:27:13 - INFO -   - RL: 0.1287
2024-09-19 15:27:13 - INFO -   - LSTM: 0.1287
2024-09-19 15:27:13 - INFO -   - ARIMA: 0.0672
2024-09-19 15:27:13 - INFO -   - PROPHET: 0.0727
2024-09-19 15:27:13 - INFO -   - TRANSFORMER: 0.2133
2024-09-19 15:27:13 - INFO -   - BITCOIN_FORECAST: 0.0684
2024-09-19 15:27:13 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:27:13 - INFO - 6. 거래 실행
2024-09-19 15:27:13 - INFO - Cancelling existing orders.
2024-09-19 15:27:13 - INFO - Cancelled 0 orders.
2024-09-19 15:27:13 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82629531.33777505, 'current_price': 82744000.0, 'predictions': {'gpt': 82744000.0, 'ml': 82777097.6, 'xgboost': 82744000.0, 'lstm': 82850307.69350556, 'rl': 82744000.0, 'arima': 80899000.0, 'prophet': 82745206.21947573, 'transformer': 82867222.46687046, 'bitcoin_forecast': 82171908.36177461}, 'weights': {'gpt': 0.0035691120246464374, 'ml': 0.2589187771240606, 'xgboost': 0.05841312407080027, 'rl': 0.1287495901179245, 'lstm': 0.1287495901179245, 'arima': 0.06717893824414659, 'prophet': 0.07274087341274756, 'transformer': 0.21325447583802531, 'bitcoin_forecast': 0.06842551904972423}}, 현재 가격=82744000.0
2024-09-19 15:27:14 - INFO - 현재 잔고: KRW=316996.69249957, BTC=0.00192107, 총 자산가치=475953.70857957006
2024-09-19 15:27:14 - INFO - 매도 시도: 0.000192107 BTC (약 15895.701608000001 KRW)
2024-09-19 15:27:14 - INFO - 주문 결과: {'uuid': 'd490508e-4345-42c1-a793-40d23c6f764b', 'side': 'ask', 'ord_type': 'limit', 'price': '82744000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:27:15+09:00', 'volume': '0.0001921', 'remaining_volume': '0.0001921', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0001921', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:27:14 - INFO - sell 주문 성공: UUID=d490508e-4345-42c1-a793-40d23c6f764b
2024-09-19 15:27:14 - INFO - Trade executed successfully.
2024-09-19 15:27:14 - INFO - 7. summary 리포트 보내기
2024-09-19 15:27:14 - INFO - Message sent to Discord successfully.
2024-09-19 15:27:14 - INFO - Trading cycle completed.
2024-09-19 15:27:14 - INFO - Performing periodic update.
2024-09-19 15:27:14 - INFO - 계산된 시장 변동성: 0.03806954731711718
2024-09-19 15:35:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-9020-c796e18ba9e1 "HTTP/1.1 200 OK"
2024-09-19 15:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:35:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:35:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-be9d-ea2257c7aa6a "HTTP/1.1 200 OK"
2024-09-19 15:35:50 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:35:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:35:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-9a17-d05ea2685030 "HTTP/1.1 200 OK"
2024-09-19 15:35:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8149-b5dd-e8249612af88 "HTTP/1.1 200 OK"
2024-09-19 15:36:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8175-9363-f64233251c7b "HTTP/1.1 200 OK"
2024-09-19 15:36:10 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8161-9832-d65edc5d07cf "HTTP/1.1 200 OK"
2024-09-19 15:36:18 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b6-8dea-c67e8ab5fd99 "HTTP/1.1 200 OK"
2024-09-19 15:36:26 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819a-ab95-f01992fb09e2 "HTTP/1.1 200 OK"
2024-09-19 15:36:34 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:36:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c3-a6ae-c77f09b51ff8 "HTTP/1.1 200 OK"
2024-09-19 15:36:41 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:25:34.926534
2024-09-19 15:36:41 - INFO - Starting trading cycle.
2024-09-19 15:36:41 - INFO - ##################################################
2024-09-19 15:36:41 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-19 15:36:41 - INFO - ##################################################
2024-09-19 15:36:41 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:36:41 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:36:41 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:20:00
2024-09-19 15:36:41 - INFO - 새로운 데이터 범위: 2024-09-18 06:20:00 ~ 2024-09-19 15:30:00
2024-09-19 15:36:41 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:36:41 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:36:41 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:36:41 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:36:41 - INFO - Sample date values: [Timestamp('2024-09-19 15:30:00')]
2024-09-19 15:36:41 - INFO - Successfully added 1 new data points
2024-09-19 15:36:41 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:36:41 - INFO - Final date range: 2024-09-19 15:30:00 to 2024-09-19 15:30:00
2024-09-19 15:36:41 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:36:41 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:30:00
2024-09-19 15:36:41 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:36:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:36:42 - INFO - GPT | 이전예측가격: 82744000 | 당시BTC가격: 82744000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:36:42 - INFO - ML 모델 예측 업데이트: 정확도 58.57%, 적중/전체: 41/70
2024-09-19 15:36:42 - INFO - ML | 이전예측가격: 82777098 | 당시BTC가격: 82744000 | 예측: 상승 | 지금 BTC가격: 82890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2595 | 반영가중치값: 0.0200 | 새 가중치: 0.2795 | 예측 총 횟수: 70 | 예측 성공 수: 41 | 예측 성공률: 58.57%
2024-09-19 15:36:42 - INFO - XGBOOST | 이전예측가격: 82744000 | 당시BTC가격: 82744000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:36:42 - INFO - LSTM 모델 예측 업데이트: 정확도 46.15%, 적중/전체: 6/13
2024-09-19 15:36:42 - INFO - LSTM | 이전예측가격: 82850308 | 당시BTC가격: 82744000 | 예측: 상승 | 지금 BTC가격: 82890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0770 | 반영가중치값: 0.0200 | 새 가중치: 0.0970 | 예측 총 횟수: 13 | 예측 성공 수: 6 | 예측 성공률: 46.15%
2024-09-19 15:36:42 - INFO - RL | 이전예측가격: 82744000 | 당시BTC가격: 82744000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:36:42 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.22%, 적중/전체: 104/185
2024-09-19 15:36:42 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82744000 | 예측: 하락 | 지금 BTC가격: 82890000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2002 | 반영가중치값: -0.0200 | 새 가중치: 0.1802 | 예측 총 횟수: 185 | 예측 성공 수: 104 | 예측 성공률: 56.22%
2024-09-19 15:36:42 - INFO - PROPHET | 이전예측가격: 82745206 | 당시BTC가격: 82744000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:36:42 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.12%, 적중/전체: 17/32
2024-09-19 15:36:42 - INFO - TRANSFORMER | 이전예측가격: 82867222 | 당시BTC가격: 82744000 | 예측: 상승 | 지금 BTC가격: 82890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1032 | 반영가중치값: 0.0200 | 새 가중치: 0.1232 | 예측 총 횟수: 32 | 예측 성공 수: 17 | 예측 성공률: 53.12%
2024-09-19 15:36:42 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.58%, 적중/전체: 19/33
2024-09-19 15:36:42 - INFO - BITCOIN_FORECAST | 이전예측가격: 82171908 | 당시BTC가격: 82744000 | 예측: 하락 | 지금 BTC가격: 82890000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1712 | 반영가중치값: -0.0200 | 새 가중치: 0.1512 | 예측 총 횟수: 33 | 예측 성공 수: 19 | 예측 성공률: 57.58%
2024-09-19 15:36:42 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:36:42 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:36:42 - INFO - 새로운 가중치: {'gpt': 0.003260678323302334, 'ml': 0.25535326524368274, 'xgboost': 0.05336520852771389, 'rl': 0.1176233737502717, 'lstm': 0.08857609347476443, 'arima': 0.16462566835533546, 'prophet': 0.06645478973961905, 'transformer': 0.1125901428345148, 'bitcoin_forecast': 0.13815077975079562}
2024-09-19 15:36:42 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:36:42 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:36:42 - INFO - Current BTC price: 82890000.0
2024-09-19 15:36:42 - INFO - Analyzing market conditions.
2024-09-19 15:36:42 - INFO - Market analysis: {'current_price': 82890000.0, 'sma_20': 82905500.0, 'rsi_14': 52.60734989922333, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:36:42 - INFO - Starting predictions for all models
2024-09-19 15:36:42 - INFO - Attempting prediction for gpt
2024-09-19 15:36:42 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:36:42 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:36:42 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:36:42 - INFO - GPT prediction: 82890000.0
2024-09-19 15:36:42 - INFO - Attempting prediction for ml
2024-09-19 15:36:42 - INFO - ML prediction: 82923156.0
2024-09-19 15:36:42 - INFO - Attempting prediction for xgboost
2024-09-19 15:36:42 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:36:42 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:36:42 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:36:42 - INFO - XGBOOST prediction: 82890000.0
2024-09-19 15:36:42 - INFO - Attempting prediction for lstm
2024-09-19 15:36:42 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:36:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:36:42 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:36:42 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:36:42 - INFO - X 샘플:
[[ 1.18862892  1.74406491  1.44412153  1.63079588  0.29895615  0.30863948
   1.63079588]
 [ 1.27712936  1.33741765  1.23371972  0.9864845  -1.21047076 -1.21087688
   0.9864845 ]
 [ 1.07289758  0.85546534  0.93405653  0.8238428  -1.21719264 -1.21843976
   0.8238428 ]
 [ 0.35808638 -0.01054271  0.24546878 -0.00813209 -0.74765589 -0.74876265
  -0.00813209]
 [ 0.00408464 -0.35694593  0.18808647 -0.01438754 -0.78261969 -0.78439878
  -0.01438754]
 [-0.09122353 -0.50755602 -0.20083809 -0.45226905 -0.11838152 -0.1190517
  -0.45226905]
 [-0.43160981 -0.65816612 -1.18271322 -1.36556479 -0.10308418 -0.10595948
  -1.36556479]
 [-2.05865628 -1.65972326 -1.66727497 -1.78467995  1.99983032  1.99407799
  -1.78467995]
 [-1.09195922 -0.91420328 -1.09345184 -0.36469275  0.93709766  0.93662672
  -0.36469275]
 [-0.22737804  0.17018941  0.09882509  0.54860299  0.94352056  0.94814507
   0.54860299]]
2024-09-19 15:36:42 - INFO - y 샘플:
[0.54860299]
2024-09-19 15:36:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:36:42 - INFO - 모델 출력 (스케일링된 예측): [[0.26248157]]
2024-09-19 15:36:42 - INFO - 스케일러 역변환 후 예측 가격: 82844260.4601322
2024-09-19 15:36:42 - INFO - LSTMPredictor 최종 예측 가격: 82844260.4601322
2024-09-19 15:36:42 - INFO - LSTM prediction: 82844260.4601322
2024-09-19 15:36:42 - INFO - Attempting prediction for rl
2024-09-19 15:36:42 - INFO - Preparing state for RL agent.
2024-09-19 15:36:42 - INFO - Prepared state: [[8.28900000e+07 1.67645459e+01 1.76447839e-03 8.29055000e+07
  5.26073499e+01]]
2024-09-19 15:36:42 - INFO - RL prediction: 83718900.0
2024-09-19 15:36:42 - INFO - Attempting prediction for arima
2024-09-19 15:36:42 - INFO - ARIMA 예측 시작
2024-09-19 15:36:42 - INFO - 입력 데이터: {'open': 82780000.0, 'high': 82890000.0, 'low': 82777000.0, 'close': 82890000.0, 'volume': 16.76454585, 'value': 1388392487.71469, 'decision': 'sell', 'sma': 82905500.0, 'ema': 82839151.29527444, 'rsi': 52.60734989922333, 'macd': -13200.804369956255, 'signal_line': 36017.32714055535, 'BB_Upper': 83253477.29810756, 'BB_Lower': 82557522.70189244}
2024-09-19 15:36:42 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:36:42 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82905500.0         0         0
2024-09-19 15:36:42 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82905500.0         0         0
2024-09-19 15:36:42 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:36:42 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:36:42 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:36:42 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:36:42 - INFO - Attempting prediction for prophet
2024-09-19 15:36:42 - INFO - PROPHET prediction: 82917319.45189866
2024-09-19 15:36:42 - INFO - Attempting prediction for transformer
2024-09-19 15:36:42 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:36:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:36:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:36:42 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:36:42 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:36:42 - INFO - X 샘플:
[[ 1.18862892  1.74406491  1.44412153  1.63079588  0.29895615  0.30863948
   1.63079588  1.63079588  0.          0.          0.          1.63079588
   1.63079588]
 [ 1.27712936  1.33741765  1.23371972  0.9864845  -1.21047076 -1.21087688
   0.9864845   0.9864845   0.          0.          0.          0.9864845
   0.9864845 ]
 [ 1.07289758  0.85546534  0.93405653  0.8238428  -1.21719264 -1.21843976
   0.8238428   0.8238428   0.          0.          0.          0.8238428
   0.8238428 ]
 [ 0.35808638 -0.01054271  0.24546878 -0.00813209 -0.74765589 -0.74876265
  -0.00813209 -0.00813209  0.          0.          0.         -0.00813209
  -0.00813209]
 [ 0.00408464 -0.35694593  0.18808647 -0.01438754 -0.78261969 -0.78439878
  -0.01438754 -0.01438754  0.          0.          0.         -0.01438754
  -0.01438754]
 [-0.09122353 -0.50755602 -0.20083809 -0.45226905 -0.11838152 -0.1190517
  -0.45226905 -0.45226905  0.          0.          0.         -0.45226905
  -0.45226905]
 [-0.43160981 -0.65816612 -1.18271322 -1.36556479 -0.10308418 -0.10595948
  -1.36556479 -1.36556479  0.          0.          0.         -1.36556479
  -1.36556479]
 [-2.05865628 -1.65972326 -1.66727497 -1.78467995  1.99983032  1.99407799
  -1.78467995 -1.78467995  0.          0.          0.         -1.78467995
  -1.78467995]
 [-1.09195922 -0.91420328 -1.09345184 -0.36469275  0.93709766  0.93662672
  -0.36469275 -0.36469275  0.          0.          0.         -0.36469275
  -0.36469275]
 [-0.22737804  0.17018941  0.09882509  0.54860299  0.94352056  0.94814507
   0.54860299  0.54860299  0.          0.          0.          0.54860299
   0.54860299]]
2024-09-19 15:36:42 - INFO - y 샘플:
[0.54860299]
2024-09-19 15:36:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:36:42 - INFO - 모델 출력 (스케일링된 예측): [0.35434237]
2024-09-19 15:36:42 - INFO - 스케일러 역변환 후 예측 가격: 82858945.38248205
2024-09-19 15:36:42 - INFO - TransformerPredictor 최종 예측 가격: 82858945.38248205
2024-09-19 15:36:42 - INFO - TRANSFORMER prediction: 82858945.38248205
2024-09-19 15:36:42 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:36:42 - INFO - BITCOIN_FORECAST prediction: 82188207.26537006
2024-09-19 15:36:42 - INFO - BitcoinForecast prediction: 82188207.26537006
2024-09-19 15:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:36:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:36:58 - INFO - 조정된 모델 가중치: {'gpt': 0.003260678323302334, 'ml': 0.25535326524368274, 'xgboost': 0.05336520852771389, 'rl': 0.1176233737502717, 'lstm': 0.08857609347476443, 'arima': 0.16462566835533546, 'prophet': 0.06645478973961905, 'transformer': 0.1125901428345148, 'bitcoin_forecast': 0.13815077975079562}
2024-09-19 15:36:58 - INFO - 조정된 모델 가중치: {'gpt': 0.003260678323302334, 'ml': 0.25535326524368274, 'xgboost': 0.05336520852771389, 'rl': 0.1176233737502717, 'lstm': 0.08857609347476443, 'arima': 0.16462566835533546, 'prophet': 0.06645478973961905, 'transformer': 0.1125901428345148, 'bitcoin_forecast': 0.13815077975079562}
2024-09-19 15:36:58 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82565509.22300686, 'current_price': 82890000.0, 'predictions': {'gpt': 82890000.0, 'ml': 82923156.0, 'xgboost': 82890000.0, 'lstm': 82844260.4601322, 'rl': 83718900.0, 'arima': 80899000.0, 'prophet': 82917319.45189866, 'transformer': 82858945.38248205, 'bitcoin_forecast': 82188207.26537006}, 'weights': {'gpt': 0.003260678323302334, 'ml': 0.25535326524368274, 'xgboost': 0.05336520852771389, 'rl': 0.1176233737502717, 'lstm': 0.08857609347476443, 'arima': 0.16462566835533546, 'prophet': 0.06645478973961905, 'transformer': 0.1125901428345148, 'bitcoin_forecast': 0.13815077975079562}}
2024-09-19 15:36:58 - INFO - 모델별 가중치:
2024-09-19 15:36:58 - INFO -   - GPT: 0.0033
2024-09-19 15:36:58 - INFO -   - ML: 0.2554
2024-09-19 15:36:58 - INFO -   - XGBOOST: 0.0534
2024-09-19 15:36:58 - INFO -   - RL: 0.1176
2024-09-19 15:36:58 - INFO -   - LSTM: 0.0886
2024-09-19 15:36:58 - INFO -   - ARIMA: 0.1646
2024-09-19 15:36:58 - INFO -   - PROPHET: 0.0665
2024-09-19 15:36:58 - INFO -   - TRANSFORMER: 0.1126
2024-09-19 15:36:58 - INFO -   - BITCOIN_FORECAST: 0.1382
2024-09-19 15:36:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:36:58 - INFO - 6. 거래 실행
2024-09-19 15:36:58 - INFO - Cancelling existing orders.
2024-09-19 15:36:58 - INFO - Cancelled 0 orders.
2024-09-19 15:36:58 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82565509.22300686, 'current_price': 82890000.0, 'predictions': {'gpt': 82890000.0, 'ml': 82923156.0, 'xgboost': 82890000.0, 'lstm': 82844260.4601322, 'rl': 83718900.0, 'arima': 80899000.0, 'prophet': 82917319.45189866, 'transformer': 82858945.38248205, 'bitcoin_forecast': 82188207.26537006}, 'weights': {'gpt': 0.003260678323302334, 'ml': 0.25535326524368274, 'xgboost': 0.05336520852771389, 'rl': 0.1176233737502717, 'lstm': 0.08857609347476443, 'arima': 0.16462566835533546, 'prophet': 0.06645478973961905, 'transformer': 0.1125901428345148, 'bitcoin_forecast': 0.13815077975079562}}, 현재 가격=82890000.0
2024-09-19 15:36:58 - INFO - 현재 잔고: KRW=332884.05934232, BTC=0.00172897, 총 자산가치=476198.38264232
2024-09-19 15:36:58 - INFO - 매도 시도: 0.000172897 BTC (약 14331.432330000001 KRW)
2024-09-19 15:36:58 - INFO - 주문 결과: {'uuid': '01791226-6c17-42c7-8880-48c09aac7764', 'side': 'ask', 'ord_type': 'limit', 'price': '82890000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:37:00+09:00', 'volume': '0.00017289', 'remaining_volume': '0.00017289', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00017289', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:36:58 - INFO - sell 주문 성공: UUID=01791226-6c17-42c7-8880-48c09aac7764
2024-09-19 15:36:58 - INFO - Trade executed successfully.
2024-09-19 15:36:58 - INFO - 7. summary 리포트 보내기
2024-09-19 15:36:59 - INFO - Message sent to Discord successfully.
2024-09-19 15:36:59 - INFO - Trading cycle completed.
2024-09-19 15:36:59 - INFO - Performing periodic update.
2024-09-19 15:36:59 - INFO - 계산된 시장 변동성: 0.03813737544995984
2024-09-19 15:45:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:45:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-adc3-e72efee97d68 "HTTP/1.1 200 OK"
2024-09-19 15:45:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:45:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810d-a41c-cc6d40da847d "HTTP/1.1 200 OK"
2024-09-19 15:45:57 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/162bc433-e452-4702-a707-9537c747779b "HTTP/1.1 200 OK"
2024-09-19 15:46:06 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f5-baf1-e040ff74b33c "HTTP/1.1 200 OK"
2024-09-19 15:46:29 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-8443-dcae62b99576 "HTTP/1.1 200 OK"
2024-09-19 15:46:39 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-aaf6-c104f374f3dc "HTTP/1.1 200 OK"
2024-09-19 15:46:46 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8145-8320-f168bc33f8a5 "HTTP/1.1 200 OK"
2024-09-19 15:46:51 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:46:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-bc84-c60a331d56af "HTTP/1.1 200 OK"
2024-09-19 15:46:57 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:47:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:47:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8190-a2f0-fd01033d155e "HTTP/1.1 200 OK"
2024-09-19 15:47:03 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:35:34.927184
2024-09-19 15:47:03 - INFO - Starting trading cycle.
2024-09-19 15:47:03 - INFO - ##################################################
2024-09-19 15:47:03 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-19 15:47:03 - INFO - ##################################################
2024-09-19 15:47:03 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:47:03 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:47:03 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:30:00
2024-09-19 15:47:04 - INFO - 새로운 데이터 범위: 2024-09-18 06:30:00 ~ 2024-09-19 15:40:00
2024-09-19 15:47:04 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:47:04 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:47:04 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:47:04 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:47:04 - INFO - Sample date values: [Timestamp('2024-09-19 15:40:00')]
2024-09-19 15:47:04 - INFO - Successfully added 1 new data points
2024-09-19 15:47:04 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:47:04 - INFO - Final date range: 2024-09-19 15:40:00 to 2024-09-19 15:40:00
2024-09-19 15:47:04 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:47:04 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:40:00
2024-09-19 15:47:04 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:47:04 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:47:04 - INFO - GPT | 이전예측가격: 82890000 | 당시BTC가격: 82890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:47:04 - INFO - ML 모델 예측 업데이트: 정확도 57.75%, 적중/전체: 41/71
2024-09-19 15:47:04 - INFO - ML | 이전예측가격: 82923156 | 당시BTC가격: 82890000 | 예측: 상승 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2589 | 반영가중치값: -0.0200 | 새 가중치: 0.2389 | 예측 총 횟수: 71 | 예측 성공 수: 41 | 예측 성공률: 57.75%
2024-09-19 15:47:04 - INFO - XGBOOST | 이전예측가격: 82890000 | 당시BTC가격: 82890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:47:04 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 7/14
2024-09-19 15:47:04 - INFO - LSTM | 이전예측가격: 82844260 | 당시BTC가격: 82890000 | 예측: 하락 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1287 | 반영가중치값: 0.0200 | 새 가중치: 0.1487 | 예측 총 횟수: 14 | 예측 성공 수: 7 | 예측 성공률: 50.00%
2024-09-19 15:47:04 - INFO - RL 모델 예측 업데이트: 정확도 30.77%, 적중/전체: 4/13
2024-09-19 15:47:04 - INFO - RL | 이전예측가격: 83718900 | 당시BTC가격: 82890000 | 예측: 상승 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1287 | 반영가중치값: -0.0200 | 새 가중치: 0.1087 | 예측 총 횟수: 13 | 예측 성공 수: 4 | 예측 성공률: 30.77%
2024-09-19 15:47:04 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.45%, 적중/전체: 105/186
2024-09-19 15:47:04 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82890000 | 예측: 하락 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0672 | 반영가중치값: 0.0200 | 새 가중치: 0.0872 | 예측 총 횟수: 186 | 예측 성공 수: 105 | 예측 성공률: 56.45%
2024-09-19 15:47:04 - INFO - PROPHET 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 6/11
2024-09-19 15:47:04 - INFO - PROPHET | 이전예측가격: 82917319 | 당시BTC가격: 82890000 | 예측: 상승 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0727 | 반영가중치값: -0.0200 | 새 가중치: 0.0527 | 예측 총 횟수: 11 | 예측 성공 수: 6 | 예측 성공률: 54.55%
2024-09-19 15:47:04 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 18/33
2024-09-19 15:47:04 - INFO - TRANSFORMER | 이전예측가격: 82858945 | 당시BTC가격: 82890000 | 예측: 하락 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2133 | 반영가중치값: 0.0200 | 새 가중치: 0.2333 | 예측 총 횟수: 33 | 예측 성공 수: 18 | 예측 성공률: 54.55%
2024-09-19 15:47:04 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 20/34
2024-09-19 15:47:04 - INFO - BITCOIN_FORECAST | 이전예측가격: 82188207 | 당시BTC가격: 82890000 | 예측: 하락 | 지금 BTC가격: 82876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0684 | 반영가중치값: 0.0200 | 새 가중치: 0.0884 | 예측 총 횟수: 34 | 예측 성공 수: 20 | 예측 성공률: 58.82%
2024-09-19 15:47:04 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:47:04 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:47:04 - INFO - 새로운 가중치: {'gpt': 0.003213619205988449, 'ml': 0.2354706274918748, 'xgboost': 0.05259502534508022, 'rl': 0.10718008242296939, 'lstm': 0.14660279006048665, 'arima': 0.08592074486370413, 'prophet': 0.051979700827451375, 'transformer': 0.22988807515262025, 'bitcoin_forecast': 0.08714933462982483}
2024-09-19 15:47:04 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:47:04 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:47:04 - INFO - Current BTC price: 82876000.0
2024-09-19 15:47:04 - INFO - Analyzing market conditions.
2024-09-19 15:47:04 - INFO - Market analysis: {'current_price': 82876000.0, 'sma_20': 82887850.0, 'rsi_14': 52.10260886310717, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:47:04 - INFO - Starting predictions for all models
2024-09-19 15:47:04 - INFO - Attempting prediction for gpt
2024-09-19 15:47:05 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:47:05 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:47:05 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:47:05 - INFO - GPT prediction: 82876000.0
2024-09-19 15:47:05 - INFO - Attempting prediction for ml
2024-09-19 15:47:05 - INFO - ML prediction: 82842849.60000001
2024-09-19 15:47:05 - INFO - Attempting prediction for xgboost
2024-09-19 15:47:05 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:47:05 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:47:05 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:47:05 - INFO - XGBOOST prediction: 82876000.0
2024-09-19 15:47:05 - INFO - Attempting prediction for lstm
2024-09-19 15:47:05 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:47:05 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:47:05 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:47:05 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:47:05 - INFO - X 샘플:
[[ 1.39692555  1.67010231  1.42898265  1.28134481 -1.21283059 -1.21300504
   1.28134481]
 [ 1.18201393  1.11019373  1.10136224  1.09248447 -1.21954435 -1.22055934
   1.09248447]
 [ 0.42982325  0.104108    0.34853235  0.12639116 -0.75057458 -0.75141582
   0.12639116]
 [ 0.05730977 -0.29832629  0.28579653  0.1191273  -0.78549616 -0.78701146
   0.1191273 ]
 [-0.04298232 -0.47329772 -0.13941294 -0.38934287 -0.12206008 -0.12242027
  -0.38934287]
 [-0.40116836 -0.64826915 -1.21289259 -1.44986635 -0.1067812  -0.10934292
  -1.44986635]
 [-2.11329763 -1.81182917 -1.74266177 -1.93654494  1.99359396  1.98830874
  -1.93654494]
 [-1.09604928 -0.94572059 -1.11530353 -0.28764884  0.93214458  0.93205882
  -0.28764884]
 [-0.18625674  0.31407372  0.18820747  0.77287465  0.93855973  0.94356408
   0.77287465]
 [ 0.77368185  0.97896516  0.85738959  0.67118062  0.33298869  0.33982322
   0.67118062]]
2024-09-19 15:47:05 - INFO - y 샘플:
[0.67118062]
2024-09-19 15:47:05 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:47:05 - INFO - 모델 출력 (스케일링된 예측): [[0.30188483]]
2024-09-19 15:47:05 - INFO - 스케일러 역변환 후 예측 가격: 82825159.83886646
2024-09-19 15:47:05 - INFO - LSTMPredictor 최종 예측 가격: 82825159.83886646
2024-09-19 15:47:05 - INFO - LSTM prediction: 82825159.83886646
2024-09-19 15:47:05 - INFO - Attempting prediction for rl
2024-09-19 15:47:05 - INFO - Preparing state for RL agent.
2024-09-19 15:47:05 - INFO - Prepared state: [[ 8.28760000e+07  1.37446429e+01 -1.68898540e-04  8.28878500e+07
   5.21026089e+01]]
2024-09-19 15:47:05 - INFO - RL prediction: 83704760.0
2024-09-19 15:47:05 - INFO - Attempting prediction for arima
2024-09-19 15:47:05 - INFO - ARIMA 예측 시작
2024-09-19 15:47:05 - INFO - 입력 데이터: {'open': 82914000.0, 'high': 82966000.0, 'low': 82873000.0, 'close': 82876000.0, 'volume': 13.74464289, 'value': 1139954517.13654, 'decision': 'sell', 'sma': 82887850.0, 'ema': 82842660.69572449, 'rsi': 52.10260886310717, 'macd': -6751.4108202159405, 'signal_line': 27463.579548401096, 'BB_Upper': 83202628.82711773, 'BB_Lower': 82573071.17288227}
2024-09-19 15:47:05 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:47:05 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82887850.0         0         0
2024-09-19 15:47:05 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82887850.0         0         0
2024-09-19 15:47:05 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:47:05 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:47:05 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:47:05 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:47:05 - INFO - Attempting prediction for prophet
2024-09-19 15:47:05 - INFO - PROPHET prediction: 82899850.32353179
2024-09-19 15:47:05 - INFO - Attempting prediction for transformer
2024-09-19 15:47:05 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:47:05 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:47:05 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:47:05 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:47:05 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:47:05 - INFO - X 샘플:
[[ 1.39692555  1.67010231  1.42898265  1.28134481 -1.21283059 -1.21300504
   1.28134481  1.28134481  0.          0.          0.          1.28134481
   1.28134481]
 [ 1.18201393  1.11019373  1.10136224  1.09248447 -1.21954435 -1.22055934
   1.09248447  1.09248447  0.          0.          0.          1.09248447
   1.09248447]
 [ 0.42982325  0.104108    0.34853235  0.12639116 -0.75057458 -0.75141582
   0.12639116  0.12639116  0.          0.          0.          0.12639116
   0.12639116]
 [ 0.05730977 -0.29832629  0.28579653  0.1191273  -0.78549616 -0.78701146
   0.1191273   0.1191273   0.          0.          0.          0.1191273
   0.1191273 ]
 [-0.04298232 -0.47329772 -0.13941294 -0.38934287 -0.12206008 -0.12242027
  -0.38934287 -0.38934287  0.          0.          0.         -0.38934287
  -0.38934287]
 [-0.40116836 -0.64826915 -1.21289259 -1.44986635 -0.1067812  -0.10934292
  -1.44986635 -1.44986635  0.          0.          0.         -1.44986635
  -1.44986635]
 [-2.11329763 -1.81182917 -1.74266177 -1.93654494  1.99359396  1.98830874
  -1.93654494 -1.93654494  0.          0.          0.         -1.93654494
  -1.93654494]
 [-1.09604928 -0.94572059 -1.11530353 -0.28764884  0.93214458  0.93205882
  -0.28764884 -0.28764884  0.          0.          0.         -0.28764884
  -0.28764884]
 [-0.18625674  0.31407372  0.18820747  0.77287465  0.93855973  0.94356408
   0.77287465  0.77287465  0.          0.          0.          0.77287465
   0.77287465]
 [ 0.77368185  0.97896516  0.85738959  0.67118062  0.33298869  0.33982322
   0.67118062  0.67118062  0.          0.          0.          0.67118062
   0.67118062]]
2024-09-19 15:47:05 - INFO - y 샘플:
[0.67118062]
2024-09-19 15:47:05 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:47:05 - INFO - 모델 출력 (스케일링된 예측): [0.35889056]
2024-09-19 15:47:05 - INFO - 스케일러 역변환 후 예측 가격: 82833007.69623782
2024-09-19 15:47:05 - INFO - TransformerPredictor 최종 예측 가격: 82833007.69623782
2024-09-19 15:47:05 - INFO - TRANSFORMER prediction: 82833007.69623782
2024-09-19 15:47:05 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:47:05 - INFO - BITCOIN_FORECAST prediction: 82177611.82050449
2024-09-19 15:47:05 - INFO - BitcoinForecast prediction: 82177611.82050449
2024-09-19 15:47:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:47:12 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:47:12 - INFO - 조정된 모델 가중치: {'gpt': 0.003213619205988449, 'ml': 0.2354706274918748, 'xgboost': 0.05259502534508022, 'rl': 0.10718008242296939, 'lstm': 0.14660279006048665, 'arima': 0.08592074486370413, 'prophet': 0.051979700827451375, 'transformer': 0.22988807515262025, 'bitcoin_forecast': 0.08714933462982483}
2024-09-19 15:47:12 - INFO - 조정된 모델 가중치: {'gpt': 0.003213619205988449, 'ml': 0.2354706274918748, 'xgboost': 0.05259502534508022, 'rl': 0.10718008242296939, 'lstm': 0.14660279006048665, 'arima': 0.08592074486370413, 'prophet': 0.051979700827451375, 'transformer': 0.22988807515262025, 'bitcoin_forecast': 0.08714933462982483}
2024-09-19 15:47:12 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82710194.2471216, 'current_price': 82876000.0, 'predictions': {'gpt': 82876000.0, 'ml': 82842849.60000001, 'xgboost': 82876000.0, 'lstm': 82825159.83886646, 'rl': 83704760.0, 'arima': 80899000.0, 'prophet': 82899850.32353179, 'transformer': 82833007.69623782, 'bitcoin_forecast': 82177611.82050449}, 'weights': {'gpt': 0.003213619205988449, 'ml': 0.2354706274918748, 'xgboost': 0.05259502534508022, 'rl': 0.10718008242296939, 'lstm': 0.14660279006048665, 'arima': 0.08592074486370413, 'prophet': 0.051979700827451375, 'transformer': 0.22988807515262025, 'bitcoin_forecast': 0.08714933462982483}}
2024-09-19 15:47:12 - INFO - 모델별 가중치:
2024-09-19 15:47:12 - INFO -   - GPT: 0.0032
2024-09-19 15:47:12 - INFO -   - ML: 0.2355
2024-09-19 15:47:12 - INFO -   - XGBOOST: 0.0526
2024-09-19 15:47:12 - INFO -   - RL: 0.1072
2024-09-19 15:47:12 - INFO -   - LSTM: 0.1466
2024-09-19 15:47:12 - INFO -   - ARIMA: 0.0859
2024-09-19 15:47:12 - INFO -   - PROPHET: 0.0520
2024-09-19 15:47:12 - INFO -   - TRANSFORMER: 0.2299
2024-09-19 15:47:12 - INFO -   - BITCOIN_FORECAST: 0.0871
2024-09-19 15:47:12 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:47:12 - INFO - 6. 거래 실행
2024-09-19 15:47:12 - INFO - Cancelling existing orders.
2024-09-19 15:47:12 - INFO - Cancelled 0 orders.
2024-09-19 15:47:12 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82710194.2471216, 'current_price': 82876000.0, 'predictions': {'gpt': 82876000.0, 'ml': 82842849.60000001, 'xgboost': 82876000.0, 'lstm': 82825159.83886646, 'rl': 83704760.0, 'arima': 80899000.0, 'prophet': 82899850.32353179, 'transformer': 82833007.69623782, 'bitcoin_forecast': 82177611.82050449}, 'weights': {'gpt': 0.003213619205988449, 'ml': 0.2354706274918748, 'xgboost': 0.05259502534508022, 'rl': 0.10718008242296939, 'lstm': 0.14660279006048665, 'arima': 0.08592074486370413, 'prophet': 0.051979700827451375, 'transformer': 0.22988807515262025, 'bitcoin_forecast': 0.08714933462982483}}, 현재 가격=82876000.0
2024-09-19 15:47:12 - INFO - 현재 잔고: KRW=347207.74601627, BTC=0.00155608, 총 자산가치=476169.43209627003
2024-09-19 15:47:12 - INFO - 매도 시도: 0.000155608 BTC (약 12896.168608 KRW)
2024-09-19 15:47:12 - INFO - 주문 결과: {'uuid': '65eeb3f3-a34e-470e-a9be-cbb85c143ce6', 'side': 'ask', 'ord_type': 'limit', 'price': '82876000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:47:14+09:00', 'volume': '0.0001556', 'remaining_volume': '0.0001556', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0001556', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:47:12 - INFO - sell 주문 성공: UUID=65eeb3f3-a34e-470e-a9be-cbb85c143ce6
2024-09-19 15:47:12 - INFO - Trade executed successfully.
2024-09-19 15:47:12 - INFO - 7. summary 리포트 보내기
2024-09-19 15:47:13 - INFO - Message sent to Discord successfully.
2024-09-19 15:47:13 - INFO - Trading cycle completed.
2024-09-19 15:47:13 - INFO - Performing periodic update.
2024-09-19 15:47:13 - INFO - 계산된 시장 변동성: 0.038140562397123566
2024-09-19 15:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:55:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8114-b3df-d268e2052673 "HTTP/1.1 200 OK"
2024-09-19 15:55:58 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8157-88ac-d8c115ac9e5b "HTTP/1.1 200 OK"
2024-09-19 15:56:04 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/652990c6-08d4-4cbe-a567-eb4f9fe09175 "HTTP/1.1 200 OK"
2024-09-19 15:56:13 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-83cc-c2e60b256cad "HTTP/1.1 200 OK"
2024-09-19 15:56:22 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8150-88be-f2936747efdf "HTTP/1.1 200 OK"
2024-09-19 15:56:29 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dc-94ec-febd955b9a7b "HTTP/1.1 200 OK"
2024-09-19 15:56:39 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-9875-c7ac51c9651b "HTTP/1.1 200 OK"
2024-09-19 15:56:47 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:56:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:56:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8175-914c-d0c0f8699fe2 "HTTP/1.1 200 OK"
2024-09-19 15:56:54 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:57:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 15:57:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-af92-d0ef5f37cf9c "HTTP/1.1 200 OK"
2024-09-19 15:57:02 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:45:34.927542
2024-09-19 15:57:02 - INFO - Starting trading cycle.
2024-09-19 15:57:02 - INFO - ##################################################
2024-09-19 15:57:02 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-19 15:57:02 - INFO - ##################################################
2024-09-19 15:57:02 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 15:57:02 - INFO - 데이터베이스 업데이트 시작
2024-09-19 15:57:02 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:40:00
2024-09-19 15:57:02 - INFO - 새로운 데이터 범위: 2024-09-18 06:40:00 ~ 2024-09-19 15:50:00
2024-09-19 15:57:02 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 15:57:02 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 15:57:02 - INFO - Index: Index([199], dtype='int64')
2024-09-19 15:57:02 - INFO - Date column data type: datetime64[ns]
2024-09-19 15:57:02 - INFO - Sample date values: [Timestamp('2024-09-19 15:50:00')]
2024-09-19 15:57:02 - INFO - Successfully added 1 new data points
2024-09-19 15:57:02 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 15:57:02 - INFO - Final date range: 2024-09-19 15:50:00 to 2024-09-19 15:50:00
2024-09-19 15:57:02 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 15:57:02 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 15:50:00
2024-09-19 15:57:02 - INFO - 데이터베이스 업데이트 완료
2024-09-19 15:57:02 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 15:57:03 - INFO - GPT | 이전예측가격: 82876000 | 당시BTC가격: 82876000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:57:03 - INFO - ML 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 42/72
2024-09-19 15:57:03 - INFO - ML | 이전예측가격: 82842850 | 당시BTC가격: 82876000 | 예측: 하락 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2554 | 반영가중치값: 0.0200 | 새 가중치: 0.2754 | 예측 총 횟수: 72 | 예측 성공 수: 42 | 예측 성공률: 58.33%
2024-09-19 15:57:03 - INFO - XGBOOST | 이전예측가격: 82876000 | 당시BTC가격: 82876000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 15:57:03 - INFO - LSTM 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-19 15:57:03 - INFO - LSTM | 이전예측가격: 82825160 | 당시BTC가격: 82876000 | 예측: 하락 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0886 | 반영가중치값: 0.0200 | 새 가중치: 0.1086 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-19 15:57:03 - INFO - RL 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 4/14
2024-09-19 15:57:03 - INFO - RL | 이전예측가격: 83704760 | 당시BTC가격: 82876000 | 예측: 상승 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1176 | 반영가중치값: -0.0200 | 새 가중치: 0.0976 | 예측 총 횟수: 14 | 예측 성공 수: 4 | 예측 성공률: 28.57%
2024-09-19 15:57:03 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.68%, 적중/전체: 106/187
2024-09-19 15:57:03 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82876000 | 예측: 하락 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1646 | 반영가중치값: 0.0200 | 새 가중치: 0.1846 | 예측 총 횟수: 187 | 예측 성공 수: 106 | 예측 성공률: 56.68%
2024-09-19 15:57:03 - INFO - PROPHET 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 6/12
2024-09-19 15:57:03 - INFO - PROPHET | 이전예측가격: 82899850 | 당시BTC가격: 82876000 | 예측: 상승 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0665 | 반영가중치값: -0.0200 | 새 가중치: 0.0465 | 예측 총 횟수: 12 | 예측 성공 수: 6 | 예측 성공률: 50.00%
2024-09-19 15:57:03 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.88%, 적중/전체: 19/34
2024-09-19 15:57:03 - INFO - TRANSFORMER | 이전예측가격: 82833008 | 당시BTC가격: 82876000 | 예측: 하락 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1126 | 반영가중치값: 0.0200 | 새 가중치: 0.1326 | 예측 총 횟수: 34 | 예측 성공 수: 19 | 예측 성공률: 55.88%
2024-09-19 15:57:03 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 21/35
2024-09-19 15:57:03 - INFO - BITCOIN_FORECAST | 이전예측가격: 82177612 | 당시BTC가격: 82876000 | 예측: 하락 | 지금 BTC가격: 82702000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1382 | 반영가중치값: 0.0200 | 새 가중치: 0.1582 | 예측 총 횟수: 35 | 예측 성공 수: 21 | 예측 성공률: 60.00%
2024-09-19 15:57:03 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 15:57:03 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 15:57:03 - INFO - 새로운 가중치: {'gpt': 0.0030340554381442326, 'ml': 0.2599676620884528, 'xgboost': 0.04965623256489461, 'rl': 0.09216858284424362, 'lstm': 0.10250930982914647, 'arima': 0.1743095485770919, 'prophet': 0.04385908796371709, 'transformer': 0.12518155329720984, 'bitcoin_forecast': 0.14931396739709957}
2024-09-19 15:57:03 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 15:57:03 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 15:57:03 - INFO - Current BTC price: 82702000.0
2024-09-19 15:57:03 - INFO - Analyzing market conditions.
2024-09-19 15:57:03 - INFO - Market analysis: {'current_price': 82702000.0, 'sma_20': 82869900.0, 'rsi_14': 46.17311939453422, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 15:57:03 - INFO - Starting predictions for all models
2024-09-19 15:57:03 - INFO - Attempting prediction for gpt
2024-09-19 15:57:03 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 15:57:03 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:57:03 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 15:57:03 - INFO - GPT prediction: 82702000.0
2024-09-19 15:57:03 - INFO - Attempting prediction for ml
2024-09-19 15:57:03 - INFO - ML prediction: 82619298.0
2024-09-19 15:57:03 - INFO - Attempting prediction for xgboost
2024-09-19 15:57:03 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 15:57:03 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:57:03 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 15:57:03 - INFO - XGBOOST prediction: 82702000.0
2024-09-19 15:57:03 - INFO - Attempting prediction for lstm
2024-09-19 15:57:03 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:57:03 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:57:03 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 15:57:03 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:57:03 - INFO - X 샘플:
[[ 1.41147134  1.51038754  1.45113648  1.39995848 -1.4171055  -1.41811107
   1.39995848]
 [ 0.57932934  0.30751658  0.59659591  0.34323613 -0.90973274 -0.91055713
   0.34323613]
 [ 0.16722092 -0.17363181  0.5253842   0.33529085 -0.94751397 -0.94906712
   0.33529085]
 [ 0.05626865 -0.38282676  0.04272703 -0.22087881 -0.22975044 -0.23006353
  -0.22087881]
 [-0.33998945 -0.59202171 -1.17578452 -1.38088981 -0.21322041 -0.21591549
  -1.38088981]
 [-2.23410315 -1.98316812 -1.77712788 -1.91322362  2.05915028  2.05347822
  -1.91322362]
 [-1.10873016 -0.94765312 -1.06501074 -0.10964488  0.91078094  0.91074943
  -0.10964488]
 [-0.10223459  0.55855052  0.41461042  1.05036612  0.9177214   0.92319667
   1.05036612]
 [ 0.95973711  1.35349133  1.17420204  0.93913219  0.26256136  0.27002545
   0.93913219]
 [ 0.61102999  0.34935557 -0.18673294 -0.44334667 -0.43289094 -0.43373544
  -0.44334667]]
2024-09-19 15:57:03 - INFO - y 샘플:
[-0.44334667]
2024-09-19 15:57:03 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 15:57:03 - INFO - 모델 출력 (스케일링된 예측): [[0.33392137]]
2024-09-19 15:57:03 - INFO - 스케일러 역변환 후 예측 가격: 82799827.63636453
2024-09-19 15:57:03 - INFO - LSTMPredictor 최종 예측 가격: 82799827.63636453
2024-09-19 15:57:03 - INFO - LSTM prediction: 82799827.63636453
2024-09-19 15:57:03 - INFO - Attempting prediction for rl
2024-09-19 15:57:03 - INFO - Preparing state for RL agent.
2024-09-19 15:57:03 - INFO - Prepared state: [[ 8.27020000e+07  1.05390163e+01 -2.09952218e-03  8.28699000e+07
   4.61731194e+01]]
2024-09-19 15:57:03 - INFO - RL prediction: 83529020.0
2024-09-19 15:57:03 - INFO - Attempting prediction for arima
2024-09-19 15:57:03 - INFO - ARIMA 예측 시작
2024-09-19 15:57:03 - INFO - 입력 데이터: {'open': 82870000.0, 'high': 82870000.0, 'low': 82701000.0, 'close': 82702000.0, 'volume': 10.5390163, 'value': 872274431.13194, 'decision': 'sell', 'sma': 82869900.0, 'ema': 82829264.43898882, 'rsi': 46.17311939453422, 'macd': -15501.869881555438, 'signal_line': 18870.48966240979, 'BB_Upper': 83184079.50283495, 'BB_Lower': 82555720.49716505}
2024-09-19 15:57:03 - INFO - Exogenous 변수 예측 시작
2024-09-19 15:57:03 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82869900.0         0         0
2024-09-19 15:57:03 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82869900.0         0         0
2024-09-19 15:57:03 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 15:57:03 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 15:57:03 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 15:57:03 - INFO - ARIMA prediction: 80899000.0
2024-09-19 15:57:03 - INFO - Attempting prediction for prophet
2024-09-19 15:57:03 - INFO - PROPHET prediction: 82693685.33815931
2024-09-19 15:57:03 - INFO - Attempting prediction for transformer
2024-09-19 15:57:03 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 15:57:03 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 15:57:03 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 15:57:03 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 15:57:03 - INFO - X dtype: float64, y dtype: float64
2024-09-19 15:57:03 - INFO - X 샘플:
[[ 1.41147134  1.51038754  1.45113648  1.39995848 -1.4171055  -1.41811107
   1.39995848  1.39995848  0.          0.          0.          1.39995848
   1.39995848]
 [ 0.57932934  0.30751658  0.59659591  0.34323613 -0.90973274 -0.91055713
   0.34323613  0.34323613  0.          0.          0.          0.34323613
   0.34323613]
 [ 0.16722092 -0.17363181  0.5253842   0.33529085 -0.94751397 -0.94906712
   0.33529085  0.33529085  0.          0.          0.          0.33529085
   0.33529085]
 [ 0.05626865 -0.38282676  0.04272703 -0.22087881 -0.22975044 -0.23006353
  -0.22087881 -0.22087881  0.          0.          0.         -0.22087881
  -0.22087881]
 [-0.33998945 -0.59202171 -1.17578452 -1.38088981 -0.21322041 -0.21591549
  -1.38088981 -1.38088981  0.          0.          0.         -1.38088981
  -1.38088981]
 [-2.23410315 -1.98316812 -1.77712788 -1.91322362  2.05915028  2.05347822
  -1.91322362 -1.91322362  0.          0.          0.         -1.91322362
  -1.91322362]
 [-1.10873016 -0.94765312 -1.06501074 -0.10964488  0.91078094  0.91074943
  -0.10964488 -0.10964488  0.          0.          0.         -0.10964488
  -0.10964488]
 [-0.10223459  0.55855052  0.41461042  1.05036612  0.9177214   0.92319667
   1.05036612  1.05036612  0.          0.          0.          1.05036612
   1.05036612]
 [ 0.95973711  1.35349133  1.17420204  0.93913219  0.26256136  0.27002545
   0.93913219  0.93913219  0.          0.          0.          0.93913219
   0.93913219]
 [ 0.61102999  0.34935557 -0.18673294 -0.44334667 -0.43289094 -0.43373544
  -0.44334667 -0.44334667  0.          0.          0.         -0.44334667
  -0.44334667]]
2024-09-19 15:57:03 - INFO - y 샘플:
[-0.44334667]
2024-09-19 15:57:03 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 15:57:03 - INFO - 모델 출력 (스케일링된 예측): [0.36145055]
2024-09-19 15:57:03 - INFO - 스케일러 역변환 후 예측 가격: 82803292.48306942
2024-09-19 15:57:03 - INFO - TransformerPredictor 최종 예측 가격: 82803292.48306942
2024-09-19 15:57:03 - INFO - TRANSFORMER prediction: 82803292.48306942
2024-09-19 15:57:03 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 15:57:03 - INFO - BITCOIN_FORECAST prediction: 82159971.38644764
2024-09-19 15:57:03 - INFO - BitcoinForecast prediction: 82159971.38644764
2024-09-19 15:57:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 15:57:15 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 15:57:15 - INFO - 조정된 모델 가중치: {'gpt': 0.0030340554381442326, 'ml': 0.2599676620884528, 'xgboost': 0.04965623256489461, 'rl': 0.09216858284424362, 'lstm': 0.10250930982914647, 'arima': 0.1743095485770919, 'prophet': 0.04385908796371709, 'transformer': 0.12518155329720984, 'bitcoin_forecast': 0.14931396739709957}
2024-09-19 15:57:15 - INFO - 조정된 모델 가중치: {'gpt': 0.0030340554381442326, 'ml': 0.2599676620884528, 'xgboost': 0.04965623256489461, 'rl': 0.09216858284424362, 'lstm': 0.10250930982914647, 'arima': 0.1743095485770919, 'prophet': 0.04385908796371709, 'transformer': 0.12518155329720984, 'bitcoin_forecast': 0.14931396739709957}
2024-09-19 15:57:15 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82383856.3773459, 'current_price': 82702000.0, 'predictions': {'gpt': 82702000.0, 'ml': 82619298.0, 'xgboost': 82702000.0, 'lstm': 82799827.63636453, 'rl': 83529020.0, 'arima': 80899000.0, 'prophet': 82693685.33815931, 'transformer': 82803292.48306942, 'bitcoin_forecast': 82159971.38644764}, 'weights': {'gpt': 0.0030340554381442326, 'ml': 0.2599676620884528, 'xgboost': 0.04965623256489461, 'rl': 0.09216858284424362, 'lstm': 0.10250930982914647, 'arima': 0.1743095485770919, 'prophet': 0.04385908796371709, 'transformer': 0.12518155329720984, 'bitcoin_forecast': 0.14931396739709957}}
2024-09-19 15:57:15 - INFO - 모델별 가중치:
2024-09-19 15:57:15 - INFO -   - GPT: 0.0030
2024-09-19 15:57:15 - INFO -   - ML: 0.2600
2024-09-19 15:57:15 - INFO -   - XGBOOST: 0.0497
2024-09-19 15:57:15 - INFO -   - RL: 0.0922
2024-09-19 15:57:15 - INFO -   - LSTM: 0.1025
2024-09-19 15:57:15 - INFO -   - ARIMA: 0.1743
2024-09-19 15:57:15 - INFO -   - PROPHET: 0.0439
2024-09-19 15:57:15 - INFO -   - TRANSFORMER: 0.1252
2024-09-19 15:57:15 - INFO -   - BITCOIN_FORECAST: 0.1493
2024-09-19 15:57:15 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 15:57:15 - INFO - 6. 거래 실행
2024-09-19 15:57:15 - INFO - Cancelling existing orders.
2024-09-19 15:57:15 - INFO - Cancelled 1 orders.
2024-09-19 15:57:15 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82383856.3773459, 'current_price': 82702000.0, 'predictions': {'gpt': 82702000.0, 'ml': 82619298.0, 'xgboost': 82702000.0, 'lstm': 82799827.63636453, 'rl': 83529020.0, 'arima': 80899000.0, 'prophet': 82693685.33815931, 'transformer': 82803292.48306942, 'bitcoin_forecast': 82159971.38644764}, 'weights': {'gpt': 0.0030340554381442326, 'ml': 0.2599676620884528, 'xgboost': 0.04965623256489461, 'rl': 0.09216858284424362, 'lstm': 0.10250930982914647, 'arima': 0.1743095485770919, 'prophet': 0.04385908796371709, 'transformer': 0.12518155329720984, 'bitcoin_forecast': 0.14931396739709957}}, 현재 가격=82702000.0
2024-09-19 15:57:15 - INFO - 현재 잔고: KRW=347207.74601627, BTC=0.00155608, 총 자산가치=475898.67417627
2024-09-19 15:57:15 - INFO - 매도 시도: 0.00015560800000000003 BTC (약 12869.092816000002 KRW)
2024-09-19 15:57:16 - INFO - 주문 결과: {'uuid': 'dc5de02b-0893-4049-8859-3c39c5a8c78e', 'side': 'ask', 'ord_type': 'limit', 'price': '82702000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T15:57:17+09:00', 'volume': '0.0001556', 'remaining_volume': '0.0001556', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0001556', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 15:57:16 - INFO - sell 주문 성공: UUID=dc5de02b-0893-4049-8859-3c39c5a8c78e
2024-09-19 15:57:16 - INFO - Trade executed successfully.
2024-09-19 15:57:16 - INFO - 7. summary 리포트 보내기
2024-09-19 15:57:16 - INFO - Message sent to Discord successfully.
2024-09-19 15:57:16 - INFO - Trading cycle completed.
2024-09-19 15:57:16 - INFO - Performing periodic update.
2024-09-19 15:57:16 - INFO - 계산된 시장 변동성: 0.038334352039247635
2024-09-19 16:05:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8149-9876-d6df2e41c948 "HTTP/1.1 200 OK"
2024-09-19 16:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:05:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:05:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b1-a0c7-d380da2c4463 "HTTP/1.1 200 OK"
2024-09-19 16:05:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:05:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8125-8cff-e09916ef8ea9 "HTTP/1.1 200 OK"
2024-09-19 16:05:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-ab26-ebf60582274c "HTTP/1.1 200 OK"
2024-09-19 16:06:10 - INFO - Updated actual price for lstm prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81df-8d8d-d406c986c63a "HTTP/1.1 200 OK"
2024-09-19 16:06:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8148-b09b-f1757cef5a0f "HTTP/1.1 200 OK"
2024-09-19 16:06:25 - INFO - Updated actual price for arima prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-8140-df17395c72e3 "HTTP/1.1 200 OK"
2024-09-19 16:06:37 - INFO - Updated actual price for prophet prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dc-bd60-dd11dc443ffd "HTTP/1.1 200 OK"
2024-09-19 16:06:49 - INFO - Updated actual price for transformer prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:06:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-aff2-fd04dcaa08f6 "HTTP/1.1 200 OK"
2024-09-19 16:06:56 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 15:55:34.927693
2024-09-19 16:06:56 - INFO - Starting trading cycle.
2024-09-19 16:06:56 - INFO - ##################################################
2024-09-19 16:06:56 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-19 16:06:56 - INFO - ##################################################
2024-09-19 16:06:56 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:06:56 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:06:56 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 15:50:00
2024-09-19 16:06:56 - INFO - 새로운 데이터 범위: 2024-09-18 06:50:00 ~ 2024-09-19 16:00:00
2024-09-19 16:06:56 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:06:56 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:06:56 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:06:56 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:06:56 - INFO - Sample date values: [Timestamp('2024-09-19 16:00:00')]
2024-09-19 16:06:56 - INFO - Successfully added 1 new data points
2024-09-19 16:06:56 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:06:56 - INFO - Final date range: 2024-09-19 16:00:00 to 2024-09-19 16:00:00
2024-09-19 16:06:56 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:06:56 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:00:00
2024-09-19 16:06:56 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:06:56 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 16:06:56 - INFO - GPT | 이전예측가격: 82702000 | 당시BTC가격: 82702000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:06:56 - INFO - ML 모델 예측 업데이트: 정확도 57.53%, 적중/전체: 42/73
2024-09-19 16:06:56 - INFO - ML | 이전예측가격: 82619298 | 당시BTC가격: 82702000 | 예측: 하락 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2355 | 반영가중치값: -0.0200 | 새 가중치: 0.2155 | 예측 총 횟수: 73 | 예측 성공 수: 42 | 예측 성공률: 57.53%
2024-09-19 16:06:56 - INFO - XGBOOST | 이전예측가격: 82702000 | 당시BTC가격: 82702000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:06:56 - INFO - LSTM 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 9/16
2024-09-19 16:06:56 - INFO - LSTM | 이전예측가격: 82799828 | 당시BTC가격: 82702000 | 예측: 상승 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1466 | 반영가중치값: 0.0200 | 새 가중치: 0.1666 | 예측 총 횟수: 16 | 예측 성공 수: 9 | 예측 성공률: 56.25%
2024-09-19 16:06:56 - INFO - RL 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 5/15
2024-09-19 16:06:56 - INFO - RL | 이전예측가격: 83529020 | 당시BTC가격: 82702000 | 예측: 상승 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1072 | 반영가중치값: 0.0200 | 새 가중치: 0.1272 | 예측 총 횟수: 15 | 예측 성공 수: 5 | 예측 성공률: 33.33%
2024-09-19 16:06:56 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.38%, 적중/전체: 106/188
2024-09-19 16:06:57 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82702000 | 예측: 하락 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0859 | 반영가중치값: -0.0200 | 새 가중치: 0.0659 | 예측 총 횟수: 188 | 예측 성공 수: 106 | 예측 성공률: 56.38%
2024-09-19 16:06:57 - INFO - PROPHET 모델 예측 업데이트: 정확도 46.15%, 적중/전체: 6/13
2024-09-19 16:06:57 - INFO - PROPHET | 이전예측가격: 82693685 | 당시BTC가격: 82702000 | 예측: 하락 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0520 | 반영가중치값: -0.0200 | 새 가중치: 0.0320 | 예측 총 횟수: 13 | 예측 성공 수: 6 | 예측 성공률: 46.15%
2024-09-19 16:06:57 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 20/35
2024-09-19 16:06:57 - INFO - TRANSFORMER | 이전예측가격: 82803292 | 당시BTC가격: 82702000 | 예측: 상승 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2299 | 반영가중치값: 0.0200 | 새 가중치: 0.2499 | 예측 총 횟수: 35 | 예측 성공 수: 20 | 예측 성공률: 57.14%
2024-09-19 16:06:57 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 21/36
2024-09-19 16:06:57 - INFO - BITCOIN_FORECAST | 이전예측가격: 82159971 | 당시BTC가격: 82702000 | 예측: 하락 | 지금 BTC가격: 82845000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0871 | 반영가중치값: -0.0200 | 새 가중치: 0.0671 | 예측 총 횟수: 36 | 예측 성공 수: 21 | 예측 성공률: 58.33%
2024-09-19 16:06:57 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 16:06:57 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 16:06:57 - INFO - 새로운 가중치: {'gpt': 0.003105857765351086, 'ml': 0.22056983968955982, 'xgboost': 0.05083137030748805, 'rl': 0.13018985797865734, 'lstm': 0.17054552225156835, 'arima': 0.0674807898229743, 'prophet': 0.03273651525935721, 'transformer': 0.25580179219009586, 'bitcoin_forecast': 0.06873845473494795}
2024-09-19 16:06:57 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 16:06:57 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 16:06:57 - INFO - Current BTC price: 82845000.0
2024-09-19 16:06:57 - INFO - Analyzing market conditions.
2024-09-19 16:06:57 - INFO - Market analysis: {'current_price': 82842000.0, 'sma_20': 82857000.0, 'rsi_14': 51.00456324366948, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 16:06:57 - INFO - Starting predictions for all models
2024-09-19 16:06:57 - INFO - Attempting prediction for gpt
2024-09-19 16:06:57 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 16:06:57 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:06:57 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:06:57 - INFO - GPT prediction: 82845000.0
2024-09-19 16:06:57 - INFO - Attempting prediction for ml
2024-09-19 16:06:57 - INFO - ML prediction: 82842000.0
2024-09-19 16:06:57 - INFO - Attempting prediction for xgboost
2024-09-19 16:06:57 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 16:06:57 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:06:57 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:06:57 - INFO - XGBOOST prediction: 82842000.0
2024-09-19 16:06:57 - INFO - Attempting prediction for lstm
2024-09-19 16:06:57 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:06:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:06:57 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 16:06:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:06:57 - INFO - X 샘플:
[[ 0.85633247  0.52260509  0.87050423  0.45333334 -1.17719007 -1.17836293
   0.45333334]
 [ 0.39054494 -0.03258738  0.78914869  0.44468194 -1.21989246 -1.22189673
   0.44468194]
 [ 0.2651406  -0.27397542  0.23773895 -0.16091603 -0.40863738 -0.40909568
  -0.16091603]
 [-0.18273203 -0.51536345 -1.15434465 -1.42402036 -0.38995425 -0.39310197
  -1.42402036]
 [-2.32356322 -2.12059387 -1.84134695 -2.00366413  2.17840174  2.17234499
  -2.00366413]
 [-1.05160494 -0.9257231  -1.0277916  -0.03979644  0.88045273  0.88054178
  -0.03979644]
 [ 0.08599155  0.81227073  0.66259564  1.22330789  0.88829722  0.89461282
   1.22330789]
 [ 1.2862902   1.72954525  1.53038802  1.1021883   0.14779998  0.15623229
   1.1021883 ]
 [ 0.89216228  0.5708827  -0.02440666 -0.40315522 -0.63823774 -0.63933757
  -0.40315522]
 [-0.21856184  0.23293945 -0.04248567  0.80804072 -0.26103978 -0.261937
   0.80804072]]
2024-09-19 16:06:57 - INFO - y 샘플:
[0.80804072]
2024-09-19 16:06:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 16:06:57 - INFO - 모델 출력 (스케일링된 예측): [[0.35702395]]
2024-09-19 16:06:57 - INFO - 스케일러 역변환 후 예측 가격: 82789867.76863208
2024-09-19 16:06:57 - INFO - LSTMPredictor 최종 예측 가격: 82789867.76863208
2024-09-19 16:06:57 - INFO - LSTM prediction: 82789867.76863208
2024-09-19 16:06:57 - INFO - Attempting prediction for rl
2024-09-19 16:06:57 - INFO - Preparing state for RL agent.
2024-09-19 16:06:57 - INFO - Prepared state: [[8.28420000e+07 1.20773086e+01 1.69282484e-03 8.28570000e+07
  5.10045632e+01]]
2024-09-19 16:06:57 - INFO - RL prediction: 83673450.0
2024-09-19 16:06:57 - INFO - Attempting prediction for arima
2024-09-19 16:06:57 - INFO - ARIMA 예측 시작
2024-09-19 16:06:57 - INFO - 입력 데이터: {'open': 82746000.0, 'high': 82842000.0, 'low': 82699000.0, 'close': 82842000.0, 'volume': 12.07730863, 'value': 999255884.94277, 'decision': 'sell', 'sma': 82857000.0, 'ema': 82830477.34956132, 'rsi': 51.00456324366948, 'macd': -11012.891996502876, 'signal_line': 12893.813330627258, 'BB_Upper': 83152989.18899448, 'BB_Lower': 82561010.81100552}
2024-09-19 16:06:57 - INFO - Exogenous 변수 예측 시작
2024-09-19 16:06:57 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82857000.0         0         0
2024-09-19 16:06:57 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82857000.0         0         0
2024-09-19 16:06:57 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 16:06:57 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 16:06:57 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 16:06:57 - INFO - ARIMA prediction: 80899000.0
2024-09-19 16:06:57 - INFO - Attempting prediction for prophet
2024-09-19 16:06:57 - INFO - PROPHET prediction: 82859961.685173
2024-09-19 16:06:57 - INFO - Attempting prediction for transformer
2024-09-19 16:06:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:06:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:06:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:06:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 16:06:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:06:57 - INFO - X 샘플:
[[ 0.85633247  0.52260509  0.87050423  0.45333334 -1.17719007 -1.17836293
   0.45333334  0.45333334  0.          0.          0.          0.45333334
   0.45333334]
 [ 0.39054494 -0.03258738  0.78914869  0.44468194 -1.21989246 -1.22189673
   0.44468194  0.44468194  0.          0.          0.          0.44468194
   0.44468194]
 [ 0.2651406  -0.27397542  0.23773895 -0.16091603 -0.40863738 -0.40909568
  -0.16091603 -0.16091603  0.          0.          0.         -0.16091603
  -0.16091603]
 [-0.18273203 -0.51536345 -1.15434465 -1.42402036 -0.38995425 -0.39310197
  -1.42402036 -1.42402036  0.          0.          0.         -1.42402036
  -1.42402036]
 [-2.32356322 -2.12059387 -1.84134695 -2.00366413  2.17840174  2.17234499
  -2.00366413 -2.00366413  0.          0.          0.         -2.00366413
  -2.00366413]
 [-1.05160494 -0.9257231  -1.0277916  -0.03979644  0.88045273  0.88054178
  -0.03979644 -0.03979644  0.          0.          0.         -0.03979644
  -0.03979644]
 [ 0.08599155  0.81227073  0.66259564  1.22330789  0.88829722  0.89461282
   1.22330789  1.22330789  0.          0.          0.          1.22330789
   1.22330789]
 [ 1.2862902   1.72954525  1.53038802  1.1021883   0.14779998  0.15623229
   1.1021883   1.1021883   0.          0.          0.          1.1021883
   1.1021883 ]
 [ 0.89216228  0.5708827  -0.02440666 -0.40315522 -0.63823774 -0.63933757
  -0.40315522 -0.40315522  0.          0.          0.         -0.40315522
  -0.40315522]
 [-0.21856184  0.23293945 -0.04248567  0.80804072 -0.26103978 -0.261937
   0.80804072  0.80804072  0.          0.          0.          0.80804072
   0.80804072]]
2024-09-19 16:06:57 - INFO - y 샘플:
[0.80804072]
2024-09-19 16:06:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 16:06:57 - INFO - 모델 출력 (스케일링된 예측): [0.3666802]
2024-09-19 16:06:57 - INFO - 스케일러 역변환 후 예측 가격: 82790983.91757847
2024-09-19 16:06:57 - INFO - TransformerPredictor 최종 예측 가격: 82790983.91757847
2024-09-19 16:06:57 - INFO - TRANSFORMER prediction: 82790983.91757847
2024-09-19 16:06:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 16:06:57 - INFO - BITCOIN_FORECAST prediction: 82177145.50187032
2024-09-19 16:06:57 - INFO - BitcoinForecast prediction: 82177145.50187032
2024-09-19 16:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:07:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 16:07:07 - INFO - 조정된 모델 가중치: {'gpt': 0.003105857765351086, 'ml': 0.22056983968955982, 'xgboost': 0.05083137030748805, 'rl': 0.13018985797865734, 'lstm': 0.17054552225156835, 'arima': 0.0674807898229743, 'prophet': 0.03273651525935721, 'transformer': 0.25580179219009586, 'bitcoin_forecast': 0.06873845473494795}
2024-09-19 16:07:07 - INFO - 조정된 모델 가중치: {'gpt': 0.003105857765351086, 'ml': 0.22056983968955982, 'xgboost': 0.05083137030748805, 'rl': 0.13018985797865734, 'lstm': 0.17054552225156835, 'arima': 0.0674807898229743, 'prophet': 0.03273651525935721, 'transformer': 0.25580179219009586, 'bitcoin_forecast': 0.06873845473494795}
2024-09-19 16:07:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82752086.50858063, 'current_price': 82845000.0, 'predictions': {'gpt': 82845000.0, 'ml': 82842000.0, 'xgboost': 82842000.0, 'lstm': 82789867.76863208, 'rl': 83673450.0, 'arima': 80899000.0, 'prophet': 82859961.685173, 'transformer': 82790983.91757847, 'bitcoin_forecast': 82177145.50187032}, 'weights': {'gpt': 0.003105857765351086, 'ml': 0.22056983968955982, 'xgboost': 0.05083137030748805, 'rl': 0.13018985797865734, 'lstm': 0.17054552225156835, 'arima': 0.0674807898229743, 'prophet': 0.03273651525935721, 'transformer': 0.25580179219009586, 'bitcoin_forecast': 0.06873845473494795}}
2024-09-19 16:07:07 - INFO - 모델별 가중치:
2024-09-19 16:07:07 - INFO -   - GPT: 0.0031
2024-09-19 16:07:07 - INFO -   - ML: 0.2206
2024-09-19 16:07:07 - INFO -   - XGBOOST: 0.0508
2024-09-19 16:07:07 - INFO -   - RL: 0.1302
2024-09-19 16:07:07 - INFO -   - LSTM: 0.1705
2024-09-19 16:07:07 - INFO -   - ARIMA: 0.0675
2024-09-19 16:07:07 - INFO -   - PROPHET: 0.0327
2024-09-19 16:07:07 - INFO -   - TRANSFORMER: 0.2558
2024-09-19 16:07:07 - INFO -   - BITCOIN_FORECAST: 0.0687
2024-09-19 16:07:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 16:07:07 - INFO - 6. 거래 실행
2024-09-19 16:07:07 - INFO - Cancelling existing orders.
2024-09-19 16:07:07 - INFO - Cancelled 0 orders.
2024-09-19 16:07:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82752086.50858063, 'current_price': 82845000.0, 'predictions': {'gpt': 82845000.0, 'ml': 82842000.0, 'xgboost': 82842000.0, 'lstm': 82789867.76863208, 'rl': 83673450.0, 'arima': 80899000.0, 'prophet': 82859961.685173, 'transformer': 82790983.91757847, 'bitcoin_forecast': 82177145.50187032}, 'weights': {'gpt': 0.003105857765351086, 'ml': 0.22056983968955982, 'xgboost': 0.05083137030748805, 'rl': 0.13018985797865734, 'lstm': 0.17054552225156835, 'arima': 0.0674807898229743, 'prophet': 0.03273651525935721, 'transformer': 0.25580179219009586, 'bitcoin_forecast': 0.06873845473494795}}, 현재 가격=82845000.0
2024-09-19 16:07:07 - INFO - 현재 잔고: KRW=360072.54240027, BTC=0.00140048, 총 자산가치=476095.30800027
2024-09-19 16:07:07 - INFO - 매도 시도: 0.000140048 BTC (약 11602.27656 KRW)
2024-09-19 16:07:07 - INFO - 주문 결과: {'uuid': '1c32e01f-b2bd-4cb4-876f-c625e495ab26', 'side': 'ask', 'ord_type': 'limit', 'price': '82845000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T16:07:09+09:00', 'volume': '0.00014004', 'remaining_volume': '0.00014004', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00014004', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 16:07:07 - INFO - sell 주문 성공: UUID=1c32e01f-b2bd-4cb4-876f-c625e495ab26
2024-09-19 16:07:07 - INFO - Trade executed successfully.
2024-09-19 16:07:07 - INFO - 7. summary 리포트 보내기
2024-09-19 16:07:08 - INFO - Message sent to Discord successfully.
2024-09-19 16:07:08 - INFO - Trading cycle completed.
2024-09-19 16:07:08 - INFO - Performing periodic update.
2024-09-19 16:07:08 - INFO - 계산된 시장 변동성: 0.038355447683956566
2024-09-19 16:15:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:15:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/bb35ee99-14d9-4d36-a11b-a86c8334fb09 "HTTP/1.1 200 OK"
2024-09-19 16:15:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:15:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/43b8e7d6-6dc7-4ed1-a94a-bbd446c94123 "HTTP/1.1 200 OK"
2024-09-19 16:15:57 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/dfa9fe77-0472-435f-8568-c98f64df4972 "HTTP/1.1 200 OK"
2024-09-19 16:16:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8169-929b-e793d748e4b9 "HTTP/1.1 200 OK"
2024-09-19 16:16:15 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8171-a84f-daa924ae14bd "HTTP/1.1 200 OK"
2024-09-19 16:16:25 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8104-b179-cfbc7ae48e0f "HTTP/1.1 200 OK"
2024-09-19 16:16:32 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/944ac19e-0c93-4b4b-8fbc-89c262c6811a "HTTP/1.1 200 OK"
2024-09-19 16:16:41 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d1-aaea-d095df43b492 "HTTP/1.1 200 OK"
2024-09-19 16:16:50 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:16:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8117-8768-f2cb881ebf41 "HTTP/1.1 200 OK"
2024-09-19 16:16:56 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:05:34.928135
2024-09-19 16:16:56 - INFO - Starting trading cycle.
2024-09-19 16:16:56 - INFO - ##################################################
2024-09-19 16:16:56 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-19 16:16:56 - INFO - ##################################################
2024-09-19 16:16:56 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:16:56 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:16:56 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:00:00
2024-09-19 16:16:56 - INFO - 새로운 데이터 범위: 2024-09-18 07:00:00 ~ 2024-09-19 16:10:00
2024-09-19 16:16:56 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:16:56 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:16:56 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:16:56 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:16:56 - INFO - Sample date values: [Timestamp('2024-09-19 16:10:00')]
2024-09-19 16:16:56 - INFO - Successfully added 1 new data points
2024-09-19 16:16:56 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:16:56 - INFO - Final date range: 2024-09-19 16:10:00 to 2024-09-19 16:10:00
2024-09-19 16:16:56 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:16:56 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:10:00
2024-09-19 16:16:56 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:16:57 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 16:16:57 - INFO - GPT | 이전예측가격: 82845000 | 당시BTC가격: 82845000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:16:57 - INFO - ML | 이전예측가격: 82842000 | 당시BTC가격: 82845000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:16:57 - INFO - XGBOOST | 이전예측가격: 82842000 | 당시BTC가격: 82845000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:16:57 - INFO - LSTM 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 10/17
2024-09-19 16:16:57 - INFO - LSTM | 이전예측가격: 82789868 | 당시BTC가격: 82845000 | 예측: 하락 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1025 | 반영가중치값: 0.0200 | 새 가중치: 0.1225 | 예측 총 횟수: 17 | 예측 성공 수: 10 | 예측 성공률: 58.82%
2024-09-19 16:16:57 - INFO - RL 모델 예측 업데이트: 정확도 31.25%, 적중/전체: 5/16
2024-09-19 16:16:57 - INFO - RL | 이전예측가격: 83673450 | 당시BTC가격: 82845000 | 예측: 상승 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0922 | 반영가중치값: -0.0200 | 새 가중치: 0.0722 | 예측 총 횟수: 16 | 예측 성공 수: 5 | 예측 성공률: 31.25%
2024-09-19 16:16:57 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.61%, 적중/전체: 107/189
2024-09-19 16:16:57 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82845000 | 예측: 하락 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1743 | 반영가중치값: 0.0200 | 새 가중치: 0.1943 | 예측 총 횟수: 189 | 예측 성공 수: 107 | 예측 성공률: 56.61%
2024-09-19 16:16:57 - INFO - PROPHET 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 6/14
2024-09-19 16:16:57 - INFO - PROPHET | 이전예측가격: 82859962 | 당시BTC가격: 82845000 | 예측: 상승 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0439 | 반영가중치값: -0.0200 | 새 가중치: 0.0239 | 예측 총 횟수: 14 | 예측 성공 수: 6 | 예측 성공률: 42.86%
2024-09-19 16:16:57 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 21/36
2024-09-19 16:16:57 - INFO - TRANSFORMER | 이전예측가격: 82790984 | 당시BTC가격: 82845000 | 예측: 하락 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1252 | 반영가중치값: 0.0200 | 새 가중치: 0.1452 | 예측 총 횟수: 36 | 예측 성공 수: 21 | 예측 성공률: 58.33%
2024-09-19 16:16:57 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 59.46%, 적중/전체: 22/37
2024-09-19 16:16:57 - INFO - BITCOIN_FORECAST | 이전예측가격: 82177146 | 당시BTC가격: 82845000 | 예측: 하락 | 지금 BTC가격: 82747000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1493 | 반영가중치값: 0.0200 | 새 가중치: 0.1693 | 예측 총 횟수: 37 | 예측 성공 수: 22 | 예측 성공률: 59.46%
2024-09-19 16:16:57 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 16:16:57 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 16:16:57 - INFO - 새로운 가중치: {'gpt': 0.003100125268934273, 'ml': 0.2201627328896982, 'xgboost': 0.05073755060608378, 'rl': 0.07203538094840138, 'lstm': 0.12228319381460888, 'arima': 0.19395091052115865, 'prophet': 0.023815051131835647, 'transformer': 0.14491359101530876, 'bitcoin_forecast': 0.1690014638039704}
2024-09-19 16:16:57 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 16:16:57 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 16:16:57 - INFO - Current BTC price: 82747000.0
2024-09-19 16:16:57 - INFO - Analyzing market conditions.
2024-09-19 16:16:57 - INFO - Market analysis: {'current_price': 82747000.0, 'sma_20': 82843150.0, 'rsi_14': 47.86495383592848, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 16:16:57 - INFO - Starting predictions for all models
2024-09-19 16:16:57 - INFO - Attempting prediction for gpt
2024-09-19 16:16:57 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 16:16:57 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:16:57 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:16:57 - INFO - GPT prediction: 82747000.0
2024-09-19 16:16:57 - INFO - Attempting prediction for ml
2024-09-19 16:16:57 - INFO - ML prediction: 82697351.8
2024-09-19 16:16:57 - INFO - Attempting prediction for xgboost
2024-09-19 16:16:57 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 16:16:57 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:16:57 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:16:57 - INFO - XGBOOST prediction: 82747000.0
2024-09-19 16:16:57 - INFO - Attempting prediction for lstm
2024-09-19 16:16:57 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 16:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:16:57 - INFO - X 샘플:
[[ 0.51482536 -0.10610103  0.91890603  0.49707735 -1.29407186 -1.29646662
   0.49707735]
 [ 0.38401674 -0.33184789  0.342819   -0.11551798 -0.45507517 -0.45574215
  -0.11551798]
 [-0.08315691 -0.55759475 -1.11156464 -1.39321679 -0.43575315 -0.43919898
  -1.39321679]
 [-2.31624693 -2.05881139 -1.82931242 -1.97955803  2.22043012  2.21438279
  -1.97955803]
 [-0.98947378 -0.94136442 -0.97934795  0.00700109  0.87809655  0.87820024
   0.00700109]
 [ 0.19714728  0.684013    0.78668934  1.28469991  0.8862093   0.89275469
   1.28469991]
 [ 1.44917265  1.54185108  1.6933181   1.16218084  0.12039008  0.12900742
   1.16218084]
 [ 1.03805984  0.45826613  0.06894156 -0.3605561  -0.69252692 -0.6938939
  -0.3605561 ]
 [-0.1205308   0.14222052  0.05005346  0.86463454 -0.30243034 -0.3035279
   0.86463454]
 [-0.07381344  1.16936875  0.05949751  0.03325517 -0.92526861 -0.92551559
   0.03325517]]
2024-09-19 16:16:57 - INFO - y 샘플:
[0.03325517]
2024-09-19 16:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 16:16:57 - INFO - 모델 출력 (스케일링된 예측): [[0.3612315]]
2024-09-19 16:16:57 - INFO - 스케일러 역변환 후 예측 가격: 82784477.1767009
2024-09-19 16:16:57 - INFO - LSTMPredictor 최종 예측 가격: 82784477.1767009
2024-09-19 16:16:57 - INFO - LSTM prediction: 82784477.1767009
2024-09-19 16:16:57 - INFO - Attempting prediction for rl
2024-09-19 16:16:57 - INFO - Preparing state for RL agent.
2024-09-19 16:16:57 - INFO - Prepared state: [[ 8.27470000e+07  9.62123139e+00 -1.14676130e-03  8.28431500e+07
   4.78649538e+01]]
2024-09-19 16:16:57 - INFO - RL prediction: 83574470.0
2024-09-19 16:16:57 - INFO - Attempting prediction for arima
2024-09-19 16:16:57 - INFO - ARIMA 예측 시작
2024-09-19 16:16:57 - INFO - 입력 데이터: {'open': 82751000.0, 'high': 82933000.0, 'low': 82700000.0, 'close': 82747000.0, 'volume': 9.62123139, 'value': 796930631.54462, 'decision': 'sell', 'sma': 82843150.0, 'ema': 82822527.12579358, 'rsi': 47.86495383592848, 'macd': -14948.731066644192, 'signal_line': 7325.304451172968, 'BB_Upper': 83132432.75095181, 'BB_Lower': 82553867.24904819}
2024-09-19 16:16:57 - INFO - Exogenous 변수 예측 시작
2024-09-19 16:16:57 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82843150.0         0         0
2024-09-19 16:16:57 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82843150.0         0         0
2024-09-19 16:16:57 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 16:16:57 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 16:16:57 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 16:16:57 - INFO - ARIMA prediction: 80899000.0
2024-09-19 16:16:57 - INFO - Attempting prediction for prophet
2024-09-19 16:16:57 - INFO - PROPHET prediction: 82747725.52560204
2024-09-19 16:16:57 - INFO - Attempting prediction for transformer
2024-09-19 16:16:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 16:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:16:57 - INFO - X 샘플:
[[ 0.51482536 -0.10610103  0.91890603  0.49707735 -1.29407186 -1.29646662
   0.49707735  0.49707735  0.          0.          0.          0.49707735
   0.49707735]
 [ 0.38401674 -0.33184789  0.342819   -0.11551798 -0.45507517 -0.45574215
  -0.11551798 -0.11551798  0.          0.          0.         -0.11551798
  -0.11551798]
 [-0.08315691 -0.55759475 -1.11156464 -1.39321679 -0.43575315 -0.43919898
  -1.39321679 -1.39321679  0.          0.          0.         -1.39321679
  -1.39321679]
 [-2.31624693 -2.05881139 -1.82931242 -1.97955803  2.22043012  2.21438279
  -1.97955803 -1.97955803  0.          0.          0.         -1.97955803
  -1.97955803]
 [-0.98947378 -0.94136442 -0.97934795  0.00700109  0.87809655  0.87820024
   0.00700109  0.00700109  0.          0.          0.          0.00700109
   0.00700109]
 [ 0.19714728  0.684013    0.78668934  1.28469991  0.8862093   0.89275469
   1.28469991  1.28469991  0.          0.          0.          1.28469991
   1.28469991]
 [ 1.44917265  1.54185108  1.6933181   1.16218084  0.12039008  0.12900742
   1.16218084  1.16218084  0.          0.          0.          1.16218084
   1.16218084]
 [ 1.03805984  0.45826613  0.06894156 -0.3605561  -0.69252692 -0.6938939
  -0.3605561  -0.3605561   0.          0.          0.         -0.3605561
  -0.3605561 ]
 [-0.1205308   0.14222052  0.05005346  0.86463454 -0.30243034 -0.3035279
   0.86463454  0.86463454  0.          0.          0.          0.86463454
   0.86463454]
 [-0.07381344  1.16936875  0.05949751  0.03325517 -0.92526861 -0.92551559
   0.03325517  0.03325517  0.          0.          0.          0.03325517
   0.03325517]]
2024-09-19 16:16:57 - INFO - y 샘플:
[0.03325517]
2024-09-19 16:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 16:16:57 - INFO - 모델 출력 (스케일링된 예측): [0.36444893]
2024-09-19 16:16:57 - INFO - 스케일러 역변환 후 예측 가격: 82784844.82564627
2024-09-19 16:16:57 - INFO - TransformerPredictor 최종 예측 가격: 82784844.82564627
2024-09-19 16:16:57 - INFO - TRANSFORMER prediction: 82784844.82564627
2024-09-19 16:16:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 16:16:57 - INFO - BITCOIN_FORECAST prediction: 82157291.63274918
2024-09-19 16:16:57 - INFO - BitcoinForecast prediction: 82157291.63274918
2024-09-19 16:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:17:06 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 16:17:06 - INFO - 조정된 모델 가중치: {'gpt': 0.003100125268934273, 'ml': 0.2201627328896982, 'xgboost': 0.05073755060608378, 'rl': 0.07203538094840138, 'lstm': 0.12228319381460888, 'arima': 0.19395091052115865, 'prophet': 0.023815051131835647, 'transformer': 0.14491359101530876, 'bitcoin_forecast': 0.1690014638039704}
2024-09-19 16:17:06 - INFO - 조정된 모델 가중치: {'gpt': 0.003100125268934273, 'ml': 0.2201627328896982, 'xgboost': 0.05073755060608378, 'rl': 0.07203538094840138, 'lstm': 0.12228319381460888, 'arima': 0.19395091052115865, 'prophet': 0.023815051131835647, 'transformer': 0.14491359101530876, 'bitcoin_forecast': 0.1690014638039704}
2024-09-19 16:17:06 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82347677.91022958, 'current_price': 82747000.0, 'predictions': {'gpt': 82747000.0, 'ml': 82697351.8, 'xgboost': 82747000.0, 'lstm': 82784477.1767009, 'rl': 83574470.0, 'arima': 80899000.0, 'prophet': 82747725.52560204, 'transformer': 82784844.82564627, 'bitcoin_forecast': 82157291.63274918}, 'weights': {'gpt': 0.003100125268934273, 'ml': 0.2201627328896982, 'xgboost': 0.05073755060608378, 'rl': 0.07203538094840138, 'lstm': 0.12228319381460888, 'arima': 0.19395091052115865, 'prophet': 0.023815051131835647, 'transformer': 0.14491359101530876, 'bitcoin_forecast': 0.1690014638039704}}
2024-09-19 16:17:06 - INFO - 모델별 가중치:
2024-09-19 16:17:06 - INFO -   - GPT: 0.0031
2024-09-19 16:17:06 - INFO -   - ML: 0.2202
2024-09-19 16:17:06 - INFO -   - XGBOOST: 0.0507
2024-09-19 16:17:06 - INFO -   - RL: 0.0720
2024-09-19 16:17:06 - INFO -   - LSTM: 0.1223
2024-09-19 16:17:06 - INFO -   - ARIMA: 0.1940
2024-09-19 16:17:06 - INFO -   - PROPHET: 0.0238
2024-09-19 16:17:06 - INFO -   - TRANSFORMER: 0.1449
2024-09-19 16:17:06 - INFO -   - BITCOIN_FORECAST: 0.1690
2024-09-19 16:17:06 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 16:17:06 - INFO - 6. 거래 실행
2024-09-19 16:17:06 - INFO - Cancelling existing orders.
2024-09-19 16:17:06 - INFO - Cancelled 0 orders.
2024-09-19 16:17:06 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82347677.91022958, 'current_price': 82747000.0, 'predictions': {'gpt': 82747000.0, 'ml': 82697351.8, 'xgboost': 82747000.0, 'lstm': 82784477.1767009, 'rl': 83574470.0, 'arima': 80899000.0, 'prophet': 82747725.52560204, 'transformer': 82784844.82564627, 'bitcoin_forecast': 82157291.63274918}, 'weights': {'gpt': 0.003100125268934273, 'ml': 0.2201627328896982, 'xgboost': 0.05073755060608378, 'rl': 0.07203538094840138, 'lstm': 0.12228319381460888, 'arima': 0.19395091052115865, 'prophet': 0.023815051131835647, 'transformer': 0.14491359101530876, 'bitcoin_forecast': 0.1690014638039704}}, 현재 가격=82747000.0
2024-09-19 16:17:06 - INFO - 현재 잔고: KRW=371668.35539337, BTC=0.00126044, 총 자산가치=475965.98407337
2024-09-19 16:17:06 - INFO - 매도 시도: 0.00012604400000000001 BTC (약 10429.762868000002 KRW)
2024-09-19 16:17:06 - INFO - 주문 결과: {'uuid': '3af1ed9c-e281-479d-a6d9-43470ed4b450', 'side': 'ask', 'ord_type': 'limit', 'price': '82747000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T16:17:08+09:00', 'volume': '0.00012604', 'remaining_volume': '0.00012604', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00012604', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 16:17:06 - INFO - sell 주문 성공: UUID=3af1ed9c-e281-479d-a6d9-43470ed4b450
2024-09-19 16:17:06 - INFO - Trade executed successfully.
2024-09-19 16:17:06 - INFO - 7. summary 리포트 보내기
2024-09-19 16:17:07 - INFO - Message sent to Discord successfully.
2024-09-19 16:17:07 - INFO - Trading cycle completed.
2024-09-19 16:17:07 - INFO - Performing periodic update.
2024-09-19 16:17:07 - INFO - 계산된 시장 변동성: 0.0382741348693841
2024-09-19 16:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:25:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-9009-ffd59dd4b4a8 "HTTP/1.1 200 OK"
2024-09-19 16:25:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:25:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:25:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-aa30-d6715aedc83b "HTTP/1.1 200 OK"
2024-09-19 16:25:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:25:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:25:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-ab02-fd40d12b76fb "HTTP/1.1 200 OK"
2024-09-19 16:25:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/129845e7-b80d-48c3-bf0c-6c4e62f48dd3 "HTTP/1.1 200 OK"
2024-09-19 16:26:10 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c9-ae90-ee0cd3cf8306 "HTTP/1.1 200 OK"
2024-09-19 16:26:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-a705-ef41b84652e6 "HTTP/1.1 200 OK"
2024-09-19 16:26:27 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818f-9844-fb5102fe09fa "HTTP/1.1 200 OK"
2024-09-19 16:26:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-b78c-ed44263457a5 "HTTP/1.1 200 OK"
2024-09-19 16:26:38 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:26:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8102-b3d2-ea8482c3a50e "HTTP/1.1 200 OK"
2024-09-19 16:26:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:15:34.928663
2024-09-19 16:26:45 - INFO - Starting trading cycle.
2024-09-19 16:26:45 - INFO - ##################################################
2024-09-19 16:26:45 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-19 16:26:45 - INFO - ##################################################
2024-09-19 16:26:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:26:45 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:26:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:10:00
2024-09-19 16:26:45 - INFO - 새로운 데이터 범위: 2024-09-18 07:10:00 ~ 2024-09-19 16:20:00
2024-09-19 16:26:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:26:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:26:45 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:26:45 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:26:45 - INFO - Sample date values: [Timestamp('2024-09-19 16:20:00')]
2024-09-19 16:26:45 - INFO - Successfully added 1 new data points
2024-09-19 16:26:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:26:45 - INFO - Final date range: 2024-09-19 16:20:00 to 2024-09-19 16:20:00
2024-09-19 16:26:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:26:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:20:00
2024-09-19 16:26:45 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:26:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 16:26:45 - INFO - GPT | 이전예측가격: 82747000 | 당시BTC가격: 82747000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:26:45 - INFO - ML 모델 예측 업데이트: 정확도 56.76%, 적중/전체: 42/74
2024-09-19 16:26:45 - INFO - ML | 이전예측가격: 82697352 | 당시BTC가격: 82747000 | 예측: 하락 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2206 | 반영가중치값: -0.0200 | 새 가중치: 0.2006 | 예측 총 횟수: 74 | 예측 성공 수: 42 | 예측 성공률: 56.76%
2024-09-19 16:26:45 - INFO - XGBOOST | 이전예측가격: 82747000 | 당시BTC가격: 82747000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:26:45 - INFO - LSTM 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 11/18
2024-09-19 16:26:45 - INFO - LSTM | 이전예측가격: 82784477 | 당시BTC가격: 82747000 | 예측: 상승 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1705 | 반영가중치값: 0.0200 | 새 가중치: 0.1905 | 예측 총 횟수: 18 | 예측 성공 수: 11 | 예측 성공률: 61.11%
2024-09-19 16:26:45 - INFO - RL 모델 예측 업데이트: 정확도 35.29%, 적중/전체: 6/17
2024-09-19 16:26:45 - INFO - RL | 이전예측가격: 83574470 | 당시BTC가격: 82747000 | 예측: 상승 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1302 | 반영가중치값: 0.0200 | 새 가중치: 0.1502 | 예측 총 횟수: 17 | 예측 성공 수: 6 | 예측 성공률: 35.29%
2024-09-19 16:26:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.32%, 적중/전체: 107/190
2024-09-19 16:26:45 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82747000 | 예측: 하락 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0675 | 반영가중치값: -0.0200 | 새 가중치: 0.0475 | 예측 총 횟수: 190 | 예측 성공 수: 107 | 예측 성공률: 56.32%
2024-09-19 16:26:45 - INFO - PROPHET | 이전예측가격: 82747726 | 당시BTC가격: 82747000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:26:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.46%, 적중/전체: 22/37
2024-09-19 16:26:45 - INFO - TRANSFORMER | 이전예측가격: 82784845 | 당시BTC가격: 82747000 | 예측: 상승 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2558 | 반영가중치값: 0.0200 | 새 가중치: 0.2758 | 예측 총 횟수: 37 | 예측 성공 수: 22 | 예측 성공률: 59.46%
2024-09-19 16:26:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 22/38
2024-09-19 16:26:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 82157292 | 당시BTC가격: 82747000 | 예측: 하락 | 지금 BTC가격: 82877000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0687 | 반영가중치값: -0.0200 | 새 가중치: 0.0487 | 예측 총 횟수: 38 | 예측 성공 수: 22 | 예측 성공률: 57.89%
2024-09-19 16:26:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 16:26:45 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 16:26:45 - INFO - 새로운 가중치: {'gpt': 0.00312834613044837, 'ml': 0.20239565419018793, 'xgboost': 0.05119942142258502, 'rl': 0.15155705666101726, 'lstm': 0.19228008402862887, 'arima': 0.047913013903594995, 'prophet': 0.024031842777862817, 'transformer': 0.27831245337554283, 'bitcoin_forecast': 0.049182127510131936}
2024-09-19 16:26:45 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 16:26:45 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 16:26:46 - INFO - Current BTC price: 82877000.0
2024-09-19 16:26:46 - INFO - Analyzing market conditions.
2024-09-19 16:26:46 - INFO - Market analysis: {'current_price': 82877000.0, 'sma_20': 82833600.0, 'rsi_14': 52.20096276901155, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 16:26:46 - INFO - Starting predictions for all models
2024-09-19 16:26:46 - INFO - Attempting prediction for gpt
2024-09-19 16:26:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 16:26:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:26:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:26:46 - INFO - GPT prediction: 82877000.0
2024-09-19 16:26:46 - INFO - Attempting prediction for ml
2024-09-19 16:26:46 - INFO - ML prediction: 82943301.6
2024-09-19 16:26:46 - INFO - Attempting prediction for xgboost
2024-09-19 16:26:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 16:26:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:26:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:26:46 - INFO - XGBOOST prediction: 82877000.0
2024-09-19 16:26:46 - INFO - Attempting prediction for lstm
2024-09-19 16:26:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:26:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:26:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 16:26:46 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:26:46 - INFO - X 샘플:
[[ 0.3750077  -0.39340397  0.30679616 -0.17377196 -0.34903676 -0.34935512
  -0.17377196]
 [-0.0902624  -0.61629573 -1.10777294 -1.38768138 -0.33155923 -0.33439705
  -1.38768138]
 [-2.31425349 -2.09852597 -1.80587198 -1.9447494   2.07106298  2.06493065
  -1.9447494 ]
 [-0.9928864  -0.99521173 -0.97917575 -0.05736969  0.85686949  0.85677501
  -0.05736969]
 [ 0.18889966  0.60960898  0.7385153   1.15653973  0.86420778  0.86993491
   1.15653973]
 [ 1.43582354  1.45659769  1.6203246   1.04013745  0.17149419  0.17936641
   1.04013745]
 [ 1.02638585  0.38671721  0.04041626 -0.40657651 -0.5638212  -0.56468827
  -0.40657651]
 [-0.12748401  0.07466874  0.02204523  0.75744622 -0.2109635  -0.21172534
   0.75744622]
 [-0.080957    1.08882627  0.03123075 -0.03242635 -0.77434522 -0.77411702
  -0.03242635]
 [ 0.57972655  0.48701851  1.13349238  1.0484519  -1.73390853 -1.73672419
   1.0484519 ]]
2024-09-19 16:26:46 - INFO - y 샘플:
[1.0484519]
2024-09-19 16:26:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 16:26:46 - INFO - 모델 출력 (스케일링된 예측): [[0.36302674]]
2024-09-19 16:26:46 - INFO - 스케일러 역변환 후 예측 가격: 82794562.15712638
2024-09-19 16:26:46 - INFO - LSTMPredictor 최종 예측 가격: 82794562.15712638
2024-09-19 16:26:46 - INFO - LSTM prediction: 82794562.15712638
2024-09-19 16:26:46 - INFO - Attempting prediction for rl
2024-09-19 16:26:46 - INFO - Preparing state for RL agent.
2024-09-19 16:26:46 - INFO - Prepared state: [[8.28770000e+07 5.43799012e+00 1.57105394e-03 8.28336000e+07
  5.22009628e+01]]
2024-09-19 16:26:46 - INFO - RL prediction: 83705770.0
2024-09-19 16:26:46 - INFO - Attempting prediction for arima
2024-09-19 16:26:46 - INFO - ARIMA 예측 시작
2024-09-19 16:26:46 - INFO - 입력 데이터: {'open': 82822000.0, 'high': 82879000.0, 'low': 82820000.0, 'close': 82877000.0, 'volume': 5.43799012, 'value': 450624403.06467, 'decision': 'sell', 'sma': 82833600.0, 'ema': 82827715.01857513, 'rsi': 52.20096276901155, 'macd': -7491.639385789633, 'signal_line': 4361.915683780448, 'BB_Upper': 83104593.2840526, 'BB_Lower': 82562606.7159474}
2024-09-19 16:26:46 - INFO - Exogenous 변수 예측 시작
2024-09-19 16:26:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82833600.0         0         0
2024-09-19 16:26:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82833600.0         0         0
2024-09-19 16:26:46 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 16:26:46 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 16:26:46 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 16:26:46 - INFO - ARIMA prediction: 80899000.0
2024-09-19 16:26:46 - INFO - Attempting prediction for prophet
2024-09-19 16:26:46 - INFO - PROPHET prediction: 82899271.51217276
2024-09-19 16:26:46 - INFO - Attempting prediction for transformer
2024-09-19 16:26:46 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:26:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:26:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:26:46 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 16:26:46 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:26:46 - INFO - X 샘플:
[[ 0.3750077  -0.39340397  0.30679616 -0.17377196 -0.34903676 -0.34935512
  -0.17377196 -0.17377196  0.          0.          0.         -0.17377196
  -0.17377196]
 [-0.0902624  -0.61629573 -1.10777294 -1.38768138 -0.33155923 -0.33439705
  -1.38768138 -1.38768138  0.          0.          0.         -1.38768138
  -1.38768138]
 [-2.31425349 -2.09852597 -1.80587198 -1.9447494   2.07106298  2.06493065
  -1.9447494  -1.9447494   0.          0.          0.         -1.9447494
  -1.9447494 ]
 [-0.9928864  -0.99521173 -0.97917575 -0.05736969  0.85686949  0.85677501
  -0.05736969 -0.05736969  0.          0.          0.         -0.05736969
  -0.05736969]
 [ 0.18889966  0.60960898  0.7385153   1.15653973  0.86420778  0.86993491
   1.15653973  1.15653973  0.          0.          0.          1.15653973
   1.15653973]
 [ 1.43582354  1.45659769  1.6203246   1.04013745  0.17149419  0.17936641
   1.04013745  1.04013745  0.          0.          0.          1.04013745
   1.04013745]
 [ 1.02638585  0.38671721  0.04041626 -0.40657651 -0.5638212  -0.56468827
  -0.40657651 -0.40657651  0.          0.          0.         -0.40657651
  -0.40657651]
 [-0.12748401  0.07466874  0.02204523  0.75744622 -0.2109635  -0.21172534
   0.75744622  0.75744622  0.          0.          0.          0.75744622
   0.75744622]
 [-0.080957    1.08882627  0.03123075 -0.03242635 -0.77434522 -0.77411702
  -0.03242635 -0.03242635  0.          0.          0.         -0.03242635
  -0.03242635]
 [ 0.57972655  0.48701851  1.13349238  1.0484519  -1.73390853 -1.73672419
   1.0484519   1.0484519   0.          0.          0.          1.0484519
   1.0484519 ]]
2024-09-19 16:26:46 - INFO - y 샘플:
[1.0484519]
2024-09-19 16:26:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 16:26:46 - INFO - 모델 출력 (스케일링된 예측): [0.36238244]
2024-09-19 16:26:46 - INFO - 스케일러 역변환 후 예측 가격: 82794484.66594452
2024-09-19 16:26:46 - INFO - TransformerPredictor 최종 예측 가격: 82794484.66594452
2024-09-19 16:26:46 - INFO - TRANSFORMER prediction: 82794484.66594452
2024-09-19 16:26:46 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 16:26:46 - INFO - BITCOIN_FORECAST prediction: 82125378.12034316
2024-09-19 16:26:46 - INFO - BitcoinForecast prediction: 82125378.12034316
2024-09-19 16:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:27:03 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 16:27:03 - INFO - 조정된 모델 가중치: {'gpt': 0.00312834613044837, 'ml': 0.20239565419018793, 'xgboost': 0.05119942142258502, 'rl': 0.15155705666101726, 'lstm': 0.19228008402862887, 'arima': 0.047913013903594995, 'prophet': 0.024031842777862817, 'transformer': 0.27831245337554283, 'bitcoin_forecast': 0.049182127510131936}
2024-09-19 16:27:03 - INFO - 조정된 모델 가중치: {'gpt': 0.00312834613044837, 'ml': 0.20239565419018793, 'xgboost': 0.05119942142258502, 'rl': 0.15155705666101726, 'lstm': 0.19228008402862887, 'arima': 0.047913013903594995, 'prophet': 0.024031842777862817, 'transformer': 0.27831245337554283, 'bitcoin_forecast': 0.049182127510131936}
2024-09-19 16:27:03 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 82846005.81799081, 'current_price': 82877000.0, 'predictions': {'gpt': 82877000.0, 'ml': 82943301.6, 'xgboost': 82877000.0, 'lstm': 82794562.15712638, 'rl': 83705770.0, 'arima': 80899000.0, 'prophet': 82899271.51217276, 'transformer': 82794484.66594452, 'bitcoin_forecast': 82125378.12034316}, 'weights': {'gpt': 0.00312834613044837, 'ml': 0.20239565419018793, 'xgboost': 0.05119942142258502, 'rl': 0.15155705666101726, 'lstm': 0.19228008402862887, 'arima': 0.047913013903594995, 'prophet': 0.024031842777862817, 'transformer': 0.27831245337554283, 'bitcoin_forecast': 0.049182127510131936}}
2024-09-19 16:27:03 - INFO - 모델별 가중치:
2024-09-19 16:27:03 - INFO -   - GPT: 0.0031
2024-09-19 16:27:03 - INFO -   - ML: 0.2024
2024-09-19 16:27:03 - INFO -   - XGBOOST: 0.0512
2024-09-19 16:27:03 - INFO -   - RL: 0.1516
2024-09-19 16:27:03 - INFO -   - LSTM: 0.1923
2024-09-19 16:27:03 - INFO -   - ARIMA: 0.0479
2024-09-19 16:27:03 - INFO -   - PROPHET: 0.0240
2024-09-19 16:27:03 - INFO -   - TRANSFORMER: 0.2783
2024-09-19 16:27:03 - INFO -   - BITCOIN_FORECAST: 0.0492
2024-09-19 16:27:03 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 16:27:03 - INFO - 6. 거래 실행
2024-09-19 16:27:03 - INFO - Cancelling existing orders.
2024-09-19 16:27:03 - INFO - Cancelled 0 orders.
2024-09-19 16:27:03 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 82846005.81799081, 'current_price': 82877000.0, 'predictions': {'gpt': 82877000.0, 'ml': 82943301.6, 'xgboost': 82877000.0, 'lstm': 82794562.15712638, 'rl': 83705770.0, 'arima': 80899000.0, 'prophet': 82899271.51217276, 'transformer': 82794484.66594452, 'bitcoin_forecast': 82125378.12034316}, 'weights': {'gpt': 0.00312834613044837, 'ml': 0.20239565419018793, 'xgboost': 0.05119942142258502, 'rl': 0.15155705666101726, 'lstm': 0.19228008402862887, 'arima': 0.047913013903594995, 'prophet': 0.024031842777862817, 'transformer': 0.27831245337554283, 'bitcoin_forecast': 0.049182127510131936}}, 현재 가격=82877000.0
2024-09-19 16:27:03 - INFO - 현재 잔고: KRW=382092.82451139, BTC=0.0011344, 총 자산가치=476108.49331139
2024-09-19 16:27:03 - INFO - 매도 시도: 0.00011344 BTC (약 9401.56688 KRW)
2024-09-19 16:27:03 - INFO - 주문 결과: {'uuid': 'f3167436-37b8-45b7-a7da-3d76fc369d80', 'side': 'ask', 'ord_type': 'limit', 'price': '82877000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T16:27:05+09:00', 'volume': '0.00011344', 'remaining_volume': '0.00011344', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00011344', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 16:27:03 - INFO - sell 주문 성공: UUID=f3167436-37b8-45b7-a7da-3d76fc369d80
2024-09-19 16:27:03 - INFO - Trade executed successfully.
2024-09-19 16:27:03 - INFO - 7. summary 리포트 보내기
2024-09-19 16:27:04 - INFO - Message sent to Discord successfully.
2024-09-19 16:27:04 - INFO - Trading cycle completed.
2024-09-19 16:27:04 - INFO - Performing periodic update.
2024-09-19 16:27:04 - INFO - 계산된 시장 변동성: 0.037952658069814176
2024-09-19 16:35:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:35:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8155-9e5d-ca83e241ba50 "HTTP/1.1 200 OK"
2024-09-19 16:35:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:35:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:35:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8193-b66f-d92cf3c5a057 "HTTP/1.1 200 OK"
2024-09-19 16:35:53 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:35:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:35:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-9562-c11fa2d0add6 "HTTP/1.1 200 OK"
2024-09-19 16:35:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815e-9a1f-d8314e4c970e "HTTP/1.1 200 OK"
2024-09-19 16:36:08 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-aa7a-d108c5ab4816 "HTTP/1.1 200 OK"
2024-09-19 16:36:15 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ef-baac-dbf27ae5fd1d "HTTP/1.1 200 OK"
2024-09-19 16:36:22 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/cf4993ed-dc74-4738-8931-427fa971786d "HTTP/1.1 200 OK"
2024-09-19 16:36:28 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-b1d7-ed6a0780ba02 "HTTP/1.1 200 OK"
2024-09-19 16:36:34 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:36:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817e-9b7b-ddccfaf03d97 "HTTP/1.1 200 OK"
2024-09-19 16:36:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:25:34.929172
2024-09-19 16:36:42 - INFO - Starting trading cycle.
2024-09-19 16:36:42 - INFO - ##################################################
2024-09-19 16:36:42 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-19 16:36:42 - INFO - ##################################################
2024-09-19 16:36:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:36:42 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:36:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:20:00
2024-09-19 16:36:42 - INFO - 새로운 데이터 범위: 2024-09-18 07:20:00 ~ 2024-09-19 16:30:00
2024-09-19 16:36:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:36:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:36:42 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:36:42 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:36:42 - INFO - Sample date values: [Timestamp('2024-09-19 16:30:00')]
2024-09-19 16:36:42 - INFO - Successfully added 1 new data points
2024-09-19 16:36:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:36:42 - INFO - Final date range: 2024-09-19 16:30:00 to 2024-09-19 16:30:00
2024-09-19 16:36:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:36:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:30:00
2024-09-19 16:36:42 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:36:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 16:36:43 - INFO - GPT | 이전예측가격: 82877000 | 당시BTC가격: 82877000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:36:43 - INFO - ML 모델 예측 업데이트: 정확도 56.00%, 적중/전체: 42/75
2024-09-19 16:36:43 - INFO - ML | 이전예측가격: 82943302 | 당시BTC가격: 82877000 | 예측: 상승 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2202 | 반영가중치값: -0.0200 | 새 가중치: 0.2002 | 예측 총 횟수: 75 | 예측 성공 수: 42 | 예측 성공률: 56.00%
2024-09-19 16:36:43 - INFO - XGBOOST | 이전예측가격: 82877000 | 당시BTC가격: 82877000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:36:43 - INFO - LSTM 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 12/19
2024-09-19 16:36:43 - INFO - LSTM | 이전예측가격: 82794562 | 당시BTC가격: 82877000 | 예측: 하락 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1223 | 반영가중치값: 0.0200 | 새 가중치: 0.1423 | 예측 총 횟수: 19 | 예측 성공 수: 12 | 예측 성공률: 63.16%
2024-09-19 16:36:43 - INFO - RL 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 6/18
2024-09-19 16:36:43 - INFO - RL | 이전예측가격: 83705770 | 당시BTC가격: 82877000 | 예측: 상승 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0720 | 반영가중치값: -0.0200 | 새 가중치: 0.0520 | 예측 총 횟수: 18 | 예측 성공 수: 6 | 예측 성공률: 33.33%
2024-09-19 16:36:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.54%, 적중/전체: 108/191
2024-09-19 16:36:43 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82877000 | 예측: 하락 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1940 | 반영가중치값: 0.0200 | 새 가중치: 0.2140 | 예측 총 횟수: 191 | 예측 성공 수: 108 | 예측 성공률: 56.54%
2024-09-19 16:36:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 6/15
2024-09-19 16:36:43 - INFO - PROPHET | 이전예측가격: 82899272 | 당시BTC가격: 82877000 | 예측: 상승 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0238 | 반영가중치값: -0.0200 | 새 가중치: 0.0038 | 예측 총 횟수: 15 | 예측 성공 수: 6 | 예측 성공률: 40.00%
2024-09-19 16:36:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.53%, 적중/전체: 23/38
2024-09-19 16:36:43 - INFO - TRANSFORMER | 이전예측가격: 82794485 | 당시BTC가격: 82877000 | 예측: 하락 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1449 | 반영가중치값: 0.0200 | 새 가중치: 0.1649 | 예측 총 횟수: 38 | 예측 성공 수: 23 | 예측 성공률: 60.53%
2024-09-19 16:36:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.97%, 적중/전체: 23/39
2024-09-19 16:36:43 - INFO - BITCOIN_FORECAST | 이전예측가격: 82125378 | 당시BTC가격: 82877000 | 예측: 하락 | 지금 BTC가격: 82791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1690 | 반영가중치값: 0.0200 | 새 가중치: 0.1890 | 예측 총 횟수: 39 | 예측 성공 수: 23 | 예측 성공률: 58.97%
2024-09-19 16:36:43 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 16:36:43 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 16:36:43 - INFO - 새로운 가중치: {'gpt': 0.0030655330766655056, 'ml': 0.19614372988234116, 'xgboost': 0.05017140473985066, 'rl': 0.05099057930375238, 'lstm': 0.13942633541953295, 'arima': 0.20965505913864801, 'prophet': 0.0037384499496339748, 'transformer': 0.16160234416792577, 'bitcoin_forecast': 0.18520656432164956}
2024-09-19 16:36:43 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 16:36:43 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 16:36:43 - INFO - Current BTC price: 82791000.0
2024-09-19 16:36:43 - INFO - Analyzing market conditions.
2024-09-19 16:36:43 - INFO - Market analysis: {'current_price': 82791000.0, 'sma_20': 82820150.0, 'rsi_14': 49.28098485517155, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 16:36:43 - INFO - Starting predictions for all models
2024-09-19 16:36:43 - INFO - Attempting prediction for gpt
2024-09-19 16:36:43 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 16:36:43 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:36:43 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:36:43 - INFO - GPT prediction: 82791000.0
2024-09-19 16:36:43 - INFO - Attempting prediction for ml
2024-09-19 16:36:43 - INFO - ML prediction: 82791000.0
2024-09-19 16:36:43 - INFO - Attempting prediction for xgboost
2024-09-19 16:36:43 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 16:36:43 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:36:43 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:36:43 - INFO - XGBOOST prediction: 82791000.0
2024-09-19 16:36:43 - INFO - Attempting prediction for lstm
2024-09-19 16:36:43 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:36:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:36:43 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 16:36:43 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:36:43 - INFO - X 샘플:
[[-1.49817616e-01 -6.97485832e-01 -1.12403207e+00 -1.43444291e+00
  -3.52953348e-01 -3.56149482e-01 -1.43444291e+00]
 [-2.28115156e+00 -2.18411429e+00 -1.81184558e+00 -1.98997861e+00
   2.06204110e+00  2.05568254e+00 -1.98997861e+00]
 [-1.01483600e+00 -1.07752619e+00 -9.97329584e-01 -1.07790508e-01
   8.41595152e-01  8.41230480e-01 -1.07790508e-01]
 [ 1.17713841e-01  5.32056500e-01  6.95053649e-01  1.10277981e+00
   8.48971234e-01  8.54458968e-01  1.10277981e+00]
 [ 1.31268769e+00  1.38155848e+00  1.56387071e+00  9.86697725e-01
   1.52690528e-01  1.60291507e-01  9.86697725e-01]
 [ 9.20308215e-01  3.08503349e-01  7.24014217e-03 -4.56036764e-01
  -5.86411347e-01 -5.87640885e-01 -4.56036764e-01]
 [-1.85488477e-01 -4.47106303e-03 -1.08602133e-02  7.04784089e-01
  -2.31736617e-01 -2.32838464e-01  7.04784089e-01]
 [-1.40899901e-01  1.01269578e+00 -1.81003554e-03 -8.29157752e-02
  -7.98019446e-01 -7.98161096e-01 -8.29157752e-02]
 [ 4.92257882e-01  4.09102267e-01  1.08421129e+00  9.94989303e-01
  -1.76252401e+00 -1.76578499e+00  9.94989303e-01]
 [ 9.29225930e-01  3.19681007e-01  5.95501694e-01  2.81913636e-01
  -1.73653246e-01 -1.71088584e-01  2.81913636e-01]]
2024-09-19 16:36:43 - INFO - y 샘플:
[0.28191364]
2024-09-19 16:36:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 16:36:43 - INFO - 모델 출력 (스케일링된 예측): [[0.3699497]]
2024-09-19 16:36:43 - INFO - 스케일러 역변환 후 예측 가격: 82801617.528744
2024-09-19 16:36:43 - INFO - LSTMPredictor 최종 예측 가격: 82801617.528744
2024-09-19 16:36:43 - INFO - LSTM prediction: 82801617.528744
2024-09-19 16:36:43 - INFO - Attempting prediction for rl
2024-09-19 16:36:43 - INFO - Preparing state for RL agent.
2024-09-19 16:36:43 - INFO - Prepared state: [[ 8.27910000e+07  1.23292274e+01 -1.03768235e-03  8.28201500e+07
   4.92809849e+01]]
2024-09-19 16:36:43 - INFO - RL prediction: 83618910.0
2024-09-19 16:36:43 - INFO - Attempting prediction for arima
2024-09-19 16:36:43 - INFO - ARIMA 예측 시작
2024-09-19 16:36:43 - INFO - 입력 데이터: {'open': 82871000.0, 'high': 82871000.0, 'low': 82766000.0, 'close': 82791000.0, 'volume': 12.32922735, 'value': 1021355761.04956, 'decision': 'sell', 'sma': 82820150.0, 'ema': 82824218.35013941, 'rsi': 49.28098485517155, 'macd': -8424.212691277266, 'signal_line': 1804.690008768905, 'BB_Upper': 83070799.7755898, 'BB_Lower': 82569500.2244102}
2024-09-19 16:36:43 - INFO - Exogenous 변수 예측 시작
2024-09-19 16:36:43 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82820150.0         0         0
2024-09-19 16:36:43 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82820150.0         0         0
2024-09-19 16:36:43 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 16:36:43 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 16:36:43 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 16:36:43 - INFO - ARIMA prediction: 80899000.0
2024-09-19 16:36:43 - INFO - Attempting prediction for prophet
2024-09-19 16:36:43 - INFO - PROPHET prediction: 82800574.49231413
2024-09-19 16:36:43 - INFO - Attempting prediction for transformer
2024-09-19 16:36:43 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:36:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:36:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:36:43 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 16:36:43 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:36:43 - INFO - X 샘플:
[[-1.49817616e-01 -6.97485832e-01 -1.12403207e+00 -1.43444291e+00
  -3.52953348e-01 -3.56149482e-01 -1.43444291e+00 -1.43444291e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.43444291e+00
  -1.43444291e+00]
 [-2.28115156e+00 -2.18411429e+00 -1.81184558e+00 -1.98997861e+00
   2.06204110e+00  2.05568254e+00 -1.98997861e+00 -1.98997861e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.98997861e+00
  -1.98997861e+00]
 [-1.01483600e+00 -1.07752619e+00 -9.97329584e-01 -1.07790508e-01
   8.41595152e-01  8.41230480e-01 -1.07790508e-01 -1.07790508e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.07790508e-01
  -1.07790508e-01]
 [ 1.17713841e-01  5.32056500e-01  6.95053649e-01  1.10277981e+00
   8.48971234e-01  8.54458968e-01  1.10277981e+00  1.10277981e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.10277981e+00
   1.10277981e+00]
 [ 1.31268769e+00  1.38155848e+00  1.56387071e+00  9.86697725e-01
   1.52690528e-01  1.60291507e-01  9.86697725e-01  9.86697725e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.86697725e-01
   9.86697725e-01]
 [ 9.20308215e-01  3.08503349e-01  7.24014217e-03 -4.56036764e-01
  -5.86411347e-01 -5.87640885e-01 -4.56036764e-01 -4.56036764e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.56036764e-01
  -4.56036764e-01]
 [-1.85488477e-01 -4.47106303e-03 -1.08602133e-02  7.04784089e-01
  -2.31736617e-01 -2.32838464e-01  7.04784089e-01  7.04784089e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.04784089e-01
   7.04784089e-01]
 [-1.40899901e-01  1.01269578e+00 -1.81003554e-03 -8.29157752e-02
  -7.98019446e-01 -7.98161096e-01 -8.29157752e-02 -8.29157752e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -8.29157752e-02
  -8.29157752e-02]
 [ 4.92257882e-01  4.09102267e-01  1.08421129e+00  9.94989303e-01
  -1.76252401e+00 -1.76578499e+00  9.94989303e-01  9.94989303e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.94989303e-01
   9.94989303e-01]
 [ 9.29225930e-01  3.19681007e-01  5.95501694e-01  2.81913636e-01
  -1.73653246e-01 -1.71088584e-01  2.81913636e-01  2.81913636e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.81913636e-01
   2.81913636e-01]]
2024-09-19 16:36:43 - INFO - y 샘플:
[0.28191364]
2024-09-19 16:36:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 16:36:43 - INFO - 모델 출력 (스케일링된 예측): [0.36328802]
2024-09-19 16:36:43 - INFO - 스케일러 역변환 후 예측 가격: 82800814.10101232
2024-09-19 16:36:43 - INFO - TransformerPredictor 최종 예측 가격: 82800814.10101232
2024-09-19 16:36:43 - INFO - TRANSFORMER prediction: 82800814.10101232
2024-09-19 16:36:43 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 16:36:43 - INFO - BITCOIN_FORECAST prediction: 82181659.86311594
2024-09-19 16:36:43 - INFO - BitcoinForecast prediction: 82181659.86311594
2024-09-19 16:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:36:52 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 16:36:52 - INFO - 조정된 모델 가중치: {'gpt': 0.0030655330766655056, 'ml': 0.19614372988234116, 'xgboost': 0.05017140473985066, 'rl': 0.05099057930375238, 'lstm': 0.13942633541953295, 'arima': 0.20965505913864801, 'prophet': 0.0037384499496339748, 'transformer': 0.16160234416792577, 'bitcoin_forecast': 0.18520656432164956}
2024-09-19 16:36:52 - INFO - 조정된 모델 가중치: {'gpt': 0.0030655330766655056, 'ml': 0.19614372988234116, 'xgboost': 0.05017140473985066, 'rl': 0.05099057930375238, 'lstm': 0.13942633541953295, 'arima': 0.20965505913864801, 'prophet': 0.0037384499496339748, 'transformer': 0.16160234416792577, 'bitcoin_forecast': 0.18520656432164956}
2024-09-19 16:36:52 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82326796.58397925, 'current_price': 82791000.0, 'predictions': {'gpt': 82791000.0, 'ml': 82791000.0, 'xgboost': 82791000.0, 'lstm': 82801617.528744, 'rl': 83618910.0, 'arima': 80899000.0, 'prophet': 82800574.49231413, 'transformer': 82800814.10101232, 'bitcoin_forecast': 82181659.86311594}, 'weights': {'gpt': 0.0030655330766655056, 'ml': 0.19614372988234116, 'xgboost': 0.05017140473985066, 'rl': 0.05099057930375238, 'lstm': 0.13942633541953295, 'arima': 0.20965505913864801, 'prophet': 0.0037384499496339748, 'transformer': 0.16160234416792577, 'bitcoin_forecast': 0.18520656432164956}}
2024-09-19 16:36:52 - INFO - 모델별 가중치:
2024-09-19 16:36:52 - INFO -   - GPT: 0.0031
2024-09-19 16:36:52 - INFO -   - ML: 0.1961
2024-09-19 16:36:52 - INFO -   - XGBOOST: 0.0502
2024-09-19 16:36:52 - INFO -   - RL: 0.0510
2024-09-19 16:36:52 - INFO -   - LSTM: 0.1394
2024-09-19 16:36:52 - INFO -   - ARIMA: 0.2097
2024-09-19 16:36:52 - INFO -   - PROPHET: 0.0037
2024-09-19 16:36:52 - INFO -   - TRANSFORMER: 0.1616
2024-09-19 16:36:52 - INFO -   - BITCOIN_FORECAST: 0.1852
2024-09-19 16:36:52 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 16:36:52 - INFO - 6. 거래 실행
2024-09-19 16:36:52 - INFO - Cancelling existing orders.
2024-09-19 16:36:52 - INFO - Cancelled 1 orders.
2024-09-19 16:36:52 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82326796.58397925, 'current_price': 82791000.0, 'predictions': {'gpt': 82791000.0, 'ml': 82791000.0, 'xgboost': 82791000.0, 'lstm': 82801617.528744, 'rl': 83618910.0, 'arima': 80899000.0, 'prophet': 82800574.49231413, 'transformer': 82800814.10101232, 'bitcoin_forecast': 82181659.86311594}, 'weights': {'gpt': 0.0030655330766655056, 'ml': 0.19614372988234116, 'xgboost': 0.05017140473985066, 'rl': 0.05099057930375238, 'lstm': 0.13942633541953295, 'arima': 0.20965505913864801, 'prophet': 0.0037384499496339748, 'transformer': 0.16160234416792577, 'bitcoin_forecast': 0.18520656432164956}}, 현재 가격=82791000.0
2024-09-19 16:36:52 - INFO - 현재 잔고: KRW=382092.82451139, BTC=0.0011344, 총 자산가치=476010.93491139
2024-09-19 16:36:52 - INFO - 매도 시도: 0.00022688000000000002 BTC (약 18783.62208 KRW)
2024-09-19 16:36:52 - INFO - 주문 결과: {'uuid': '0aff9741-1e65-4b83-a67e-470be1d89df7', 'side': 'ask', 'ord_type': 'limit', 'price': '82791000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T16:36:54+09:00', 'volume': '0.00022688', 'remaining_volume': '0.00022688', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00022688', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 16:36:52 - INFO - sell 주문 성공: UUID=0aff9741-1e65-4b83-a67e-470be1d89df7
2024-09-19 16:36:52 - INFO - Trade executed successfully.
2024-09-19 16:36:52 - INFO - 7. summary 리포트 보내기
2024-09-19 16:36:53 - INFO - Message sent to Discord successfully.
2024-09-19 16:36:53 - INFO - Trading cycle completed.
2024-09-19 16:36:53 - INFO - Performing periodic update.
2024-09-19 16:36:53 - INFO - 계산된 시장 변동성: 0.037878426487473
2024-09-19 16:45:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:45:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0f9d9f5a-7abd-4a6c-8bc7-20bbeb6dc505 "HTTP/1.1 200 OK"
2024-09-19 16:45:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:45:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-95cd-ec3af30a8bdc "HTTP/1.1 200 OK"
2024-09-19 16:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:45:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814d-970d-f32ab83991bb "HTTP/1.1 200 OK"
2024-09-19 16:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ef-9b5a-e52dee67d8c2 "HTTP/1.1 200 OK"
2024-09-19 16:46:10 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e8-a38d-e3558ac5b364 "HTTP/1.1 200 OK"
2024-09-19 16:46:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b1-9a5d-e5af1e8fbeb9 "HTTP/1.1 200 OK"
2024-09-19 16:46:22 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-915b-c22e08d9f0aa "HTTP/1.1 200 OK"
2024-09-19 16:46:29 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d948d115-f8e3-4d13-8cee-39281ad1479b "HTTP/1.1 200 OK"
2024-09-19 16:46:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:46:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811f-9df2-ce646f48e4e1 "HTTP/1.1 200 OK"
2024-09-19 16:46:46 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:35:34.929539
2024-09-19 16:46:46 - INFO - Starting trading cycle.
2024-09-19 16:46:46 - INFO - ##################################################
2024-09-19 16:46:46 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-19 16:46:46 - INFO - ##################################################
2024-09-19 16:46:46 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:46:46 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:46:46 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:30:00
2024-09-19 16:46:46 - INFO - 새로운 데이터 범위: 2024-09-18 07:30:00 ~ 2024-09-19 16:40:00
2024-09-19 16:46:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:46:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:46:46 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:46:46 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:46:46 - INFO - Sample date values: [Timestamp('2024-09-19 16:40:00')]
2024-09-19 16:46:46 - INFO - Successfully added 1 new data points
2024-09-19 16:46:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:46:46 - INFO - Final date range: 2024-09-19 16:40:00 to 2024-09-19 16:40:00
2024-09-19 16:46:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:46:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:40:00
2024-09-19 16:46:46 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:46:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 16:46:46 - INFO - GPT | 이전예측가격: 82791000 | 당시BTC가격: 82791000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:46:46 - INFO - ML | 이전예측가격: 82791000 | 당시BTC가격: 82791000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:46:46 - INFO - XGBOOST | 이전예측가격: 82791000 | 당시BTC가격: 82791000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 16:46:46 - INFO - LSTM 모델 예측 업데이트: 정확도 65.00%, 적중/전체: 13/20
2024-09-19 16:46:46 - INFO - LSTM | 이전예측가격: 82801618 | 당시BTC가격: 82791000 | 예측: 상승 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1923 | 반영가중치값: 0.0200 | 새 가중치: 0.2123 | 예측 총 횟수: 20 | 예측 성공 수: 13 | 예측 성공률: 65.00%
2024-09-19 16:46:46 - INFO - RL 모델 예측 업데이트: 정확도 36.84%, 적중/전체: 7/19
2024-09-19 16:46:46 - INFO - RL | 이전예측가격: 83618910 | 당시BTC가격: 82791000 | 예측: 상승 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1516 | 반영가중치값: 0.0200 | 새 가중치: 0.1716 | 예측 총 횟수: 19 | 예측 성공 수: 7 | 예측 성공률: 36.84%
2024-09-19 16:46:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 108/192
2024-09-19 16:46:46 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82791000 | 예측: 하락 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0479 | 반영가중치값: -0.0200 | 새 가중치: 0.0279 | 예측 총 횟수: 192 | 예측 성공 수: 108 | 예측 성공률: 56.25%
2024-09-19 16:46:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 43.75%, 적중/전체: 7/16
2024-09-19 16:46:46 - INFO - PROPHET | 이전예측가격: 82800574 | 당시BTC가격: 82791000 | 예측: 상승 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0240 | 반영가중치값: 0.0200 | 새 가중치: 0.0440 | 예측 총 횟수: 16 | 예측 성공 수: 7 | 예측 성공률: 43.75%
2024-09-19 16:46:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 24/39
2024-09-19 16:46:46 - INFO - TRANSFORMER | 이전예측가격: 82800814 | 당시BTC가격: 82791000 | 예측: 상승 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2783 | 반영가중치값: 0.0200 | 새 가중치: 0.2983 | 예측 총 횟수: 39 | 예측 성공 수: 24 | 예측 성공률: 61.54%
2024-09-19 16:46:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.50%, 적중/전체: 23/40
2024-09-19 16:46:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 82181660 | 당시BTC가격: 82791000 | 예측: 하락 | 지금 BTC가격: 82927000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0492 | 반영가중치값: -0.0200 | 새 가중치: 0.0292 | 예측 총 횟수: 40 | 예측 성공 수: 23 | 예측 성공률: 57.50%
2024-09-19 16:46:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 16:46:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 16:46:46 - INFO - 새로운 가중치: {'gpt': 0.002968587194513526, 'ml': 0.18994078688793484, 'xgboost': 0.0485847602738906, 'rl': 0.16613165436345326, 'lstm': 0.20556683726378328, 'arima': 0.027030279420316165, 'prophet': 0.042639358751717385, 'transformer': 0.288878477872375, 'bitcoin_forecast': 0.02825925797201604}
2024-09-19 16:46:46 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 16:46:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 16:46:46 - INFO - Current BTC price: 82927000.0
2024-09-19 16:46:46 - INFO - Analyzing market conditions.
2024-09-19 16:46:46 - INFO - Market analysis: {'current_price': 82927000.0, 'sma_20': 82824800.0, 'rsi_14': 53.692404984520465, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 16:46:46 - INFO - Starting predictions for all models
2024-09-19 16:46:46 - INFO - Attempting prediction for gpt
2024-09-19 16:46:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 16:46:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:46:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 16:46:47 - INFO - GPT prediction: 82927000.0
2024-09-19 16:46:47 - INFO - Attempting prediction for ml
2024-09-19 16:46:47 - INFO - ML prediction: 82860658.39999999
2024-09-19 16:46:47 - INFO - Attempting prediction for xgboost
2024-09-19 16:46:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 16:46:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:46:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 16:46:47 - INFO - XGBOOST prediction: 82927000.0
2024-09-19 16:46:47 - INFO - Attempting prediction for lstm
2024-09-19 16:46:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:46:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:46:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 16:46:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:46:47 - INFO - X 샘플:
[[-2.31453132 -2.3324167  -2.07927951 -2.38152776  2.05157151  2.04532829
  -2.38152776]
 [-1.08219743 -1.23337218 -1.25197997 -0.41066811  0.86786643  0.86725897
  -0.41066811]
 [ 0.01996034  0.36523803  0.46696463  0.85693325  0.87502045  0.88009116
   0.85693325]
 [ 1.18286696  1.20894897  1.34941747  0.73538243  0.1997009   0.20671967
   0.73538243]
 [ 0.80101703  0.14320883 -0.23164387 -0.77532056 -0.51715071 -0.51880605
  -0.77532056]
 [-0.27510552 -0.16763204 -0.2500283   0.44018759 -0.17315327 -0.17463285
   0.44018759]
 [-0.23171348  0.8426008  -0.24083609 -0.38462151 -0.72238847 -0.72301946
  -0.38462151]
 [ 0.38445346  0.24312197  0.86222996  0.74406463 -1.65785714 -1.66165513
   0.74406463]
 [ 0.80969543  0.15431029  0.36585024 -0.00260466 -0.11681847 -0.11473288
  -0.00260466]
 [ 0.70555454  0.77599204  1.00930544  1.17817469 -0.80679123 -0.80655173
   1.17817469]]
2024-09-19 16:46:47 - INFO - y 샘플:
[1.17817469]
2024-09-19 16:46:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 16:46:47 - INFO - 모델 출력 (스케일링된 예측): [[0.36699778]]
2024-09-19 16:46:47 - INFO - 스케일러 역변환 후 예측 가격: 82833570.13116647
2024-09-19 16:46:47 - INFO - LSTMPredictor 최종 예측 가격: 82833570.13116647
2024-09-19 16:46:47 - INFO - LSTM prediction: 82833570.13116647
2024-09-19 16:46:47 - INFO - Attempting prediction for rl
2024-09-19 16:46:47 - INFO - Preparing state for RL agent.
2024-09-19 16:46:47 - INFO - Prepared state: [[8.29270000e+07 9.24379799e+00 1.64269063e-03 8.28248000e+07
  5.36924050e+01]]
2024-09-19 16:46:47 - INFO - RL prediction: 83756270.0
2024-09-19 16:46:47 - INFO - Attempting prediction for arima
2024-09-19 16:46:47 - INFO - ARIMA 예측 시작
2024-09-19 16:46:47 - INFO - 입력 데이터: {'open': 82859000.0, 'high': 82927000.0, 'low': 82836000.0, 'close': 82927000.0, 'volume': 9.24379799, 'value': 766111702.27427, 'decision': 'sell', 'sma': 82824800.0, 'ema': 82834007.07869756, 'rsi': 53.692404984520465, 'macd': 1790.143980383873, 'signal_line': 1801.7808030918986, 'BB_Upper': 83079719.28134845, 'BB_Lower': 82569880.71865155}
2024-09-19 16:46:47 - INFO - Exogenous 변수 예측 시작
2024-09-19 16:46:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82824800.0         0         0
2024-09-19 16:46:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82824800.0         0         0
2024-09-19 16:46:47 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 16:46:47 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 16:46:47 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 16:46:47 - INFO - ARIMA prediction: 80899000.0
2024-09-19 16:46:47 - INFO - Attempting prediction for prophet
2024-09-19 16:46:47 - INFO - PROPHET prediction: 82958704.27416222
2024-09-19 16:46:47 - INFO - Attempting prediction for transformer
2024-09-19 16:46:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 16:46:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 16:46:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 16:46:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 16:46:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 16:46:47 - INFO - X 샘플:
[[-2.31453132 -2.3324167  -2.07927951 -2.38152776  2.05157151  2.04532829
  -2.38152776 -2.38152776  0.          0.          0.         -2.38152776
  -2.38152776]
 [-1.08219743 -1.23337218 -1.25197997 -0.41066811  0.86786643  0.86725897
  -0.41066811 -0.41066811  0.          0.          0.         -0.41066811
  -0.41066811]
 [ 0.01996034  0.36523803  0.46696463  0.85693325  0.87502045  0.88009116
   0.85693325  0.85693325  0.          0.          0.          0.85693325
   0.85693325]
 [ 1.18286696  1.20894897  1.34941747  0.73538243  0.1997009   0.20671967
   0.73538243  0.73538243  0.          0.          0.          0.73538243
   0.73538243]
 [ 0.80101703  0.14320883 -0.23164387 -0.77532056 -0.51715071 -0.51880605
  -0.77532056 -0.77532056  0.          0.          0.         -0.77532056
  -0.77532056]
 [-0.27510552 -0.16763204 -0.2500283   0.44018759 -0.17315327 -0.17463285
   0.44018759  0.44018759  0.          0.          0.          0.44018759
   0.44018759]
 [-0.23171348  0.8426008  -0.24083609 -0.38462151 -0.72238847 -0.72301946
  -0.38462151 -0.38462151  0.          0.          0.         -0.38462151
  -0.38462151]
 [ 0.38445346  0.24312197  0.86222996  0.74406463 -1.65785714 -1.66165513
   0.74406463  0.74406463  0.          0.          0.          0.74406463
   0.74406463]
 [ 0.80969543  0.15431029  0.36585024 -0.00260466 -0.11681847 -0.11473288
  -0.00260466 -0.00260466  0.          0.          0.         -0.00260466
  -0.00260466]
 [ 0.70555454  0.77599204  1.00930544  1.17817469 -0.80679123 -0.80655173
   1.17817469  1.17817469  0.          0.          0.          1.17817469
   1.17817469]]
2024-09-19 16:46:47 - INFO - y 샘플:
[1.17817469]
2024-09-19 16:46:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 16:46:47 - INFO - 모델 출력 (스케일링된 예측): [0.36441097]
2024-09-19 16:46:47 - INFO - 스케일러 역변환 후 예측 가격: 82833272.1869289
2024-09-19 16:46:47 - INFO - TransformerPredictor 최종 예측 가격: 82833272.1869289
2024-09-19 16:46:47 - INFO - TRANSFORMER prediction: 82833272.1869289
2024-09-19 16:46:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 16:46:47 - INFO - BITCOIN_FORECAST prediction: 82155073.68783352
2024-09-19 16:46:47 - INFO - BitcoinForecast prediction: 82155073.68783352
2024-09-19 16:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 16:47:26 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 16:47:26 - INFO - 조정된 모델 가중치: {'gpt': 0.002968587194513526, 'ml': 0.18994078688793484, 'xgboost': 0.0485847602738906, 'rl': 0.16613165436345326, 'lstm': 0.20556683726378328, 'arima': 0.027030279420316165, 'prophet': 0.042639358751717385, 'transformer': 0.288878477872375, 'bitcoin_forecast': 0.02825925797201604}
2024-09-19 16:47:26 - INFO - 조정된 모델 가중치: {'gpt': 0.002968587194513526, 'ml': 0.18994078688793484, 'xgboost': 0.0485847602738906, 'rl': 0.16613165436345326, 'lstm': 0.20556683726378328, 'arima': 0.027030279420316165, 'prophet': 0.042639358751717385, 'transformer': 0.288878477872375, 'bitcoin_forecast': 0.02825925797201604}
2024-09-19 16:47:26 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 82930605.36915487, 'current_price': 82927000.0, 'predictions': {'gpt': 82927000.0, 'ml': 82860658.39999999, 'xgboost': 82927000.0, 'lstm': 82833570.13116647, 'rl': 83756270.0, 'arima': 80899000.0, 'prophet': 82958704.27416222, 'transformer': 82833272.1869289, 'bitcoin_forecast': 82155073.68783352}, 'weights': {'gpt': 0.002968587194513526, 'ml': 0.18994078688793484, 'xgboost': 0.0485847602738906, 'rl': 0.16613165436345326, 'lstm': 0.20556683726378328, 'arima': 0.027030279420316165, 'prophet': 0.042639358751717385, 'transformer': 0.288878477872375, 'bitcoin_forecast': 0.02825925797201604}}
2024-09-19 16:47:26 - INFO - 모델별 가중치:
2024-09-19 16:47:26 - INFO -   - GPT: 0.0030
2024-09-19 16:47:26 - INFO -   - ML: 0.1899
2024-09-19 16:47:26 - INFO -   - XGBOOST: 0.0486
2024-09-19 16:47:26 - INFO -   - RL: 0.1661
2024-09-19 16:47:26 - INFO -   - LSTM: 0.2056
2024-09-19 16:47:26 - INFO -   - ARIMA: 0.0270
2024-09-19 16:47:26 - INFO -   - PROPHET: 0.0426
2024-09-19 16:47:26 - INFO -   - TRANSFORMER: 0.2889
2024-09-19 16:47:26 - INFO -   - BITCOIN_FORECAST: 0.0283
2024-09-19 16:47:26 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 16:47:26 - INFO - 6. 거래 실행
2024-09-19 16:47:26 - INFO - Cancelling existing orders.
2024-09-19 16:47:26 - INFO - Cancelled 0 orders.
2024-09-19 16:47:26 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 82930605.36915487, 'current_price': 82927000.0, 'predictions': {'gpt': 82927000.0, 'ml': 82860658.39999999, 'xgboost': 82927000.0, 'lstm': 82833570.13116647, 'rl': 83756270.0, 'arima': 80899000.0, 'prophet': 82958704.27416222, 'transformer': 82833272.1869289, 'bitcoin_forecast': 82155073.68783352}, 'weights': {'gpt': 0.002968587194513526, 'ml': 0.18994078688793484, 'xgboost': 0.0485847602738906, 'rl': 0.16613165436345326, 'lstm': 0.20556683726378328, 'arima': 0.027030279420316165, 'prophet': 0.042639358751717385, 'transformer': 0.288878477872375, 'bitcoin_forecast': 0.02825925797201604}}, 현재 가격=82927000.0
2024-09-19 16:47:26 - INFO - 현재 잔고: KRW=400867.05478035, BTC=0.00090752, 총 자산가치=476124.96582035
2024-09-19 16:47:26 - INFO - 매수 시도: 0.0005741495120049563 BTC (약 47612.496582035004 KRW)
2024-09-19 16:47:26 - INFO - 주문 결과: {'uuid': '908e6bbf-bdb7-450c-9f6c-9c73845a521e', 'side': 'bid', 'ord_type': 'limit', 'price': '82927000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T16:47:28+09:00', 'volume': '0.00057414', 'remaining_volume': '0.00057414', 'reserved_fee': '23.80585389', 'remaining_fee': '23.80585389', 'paid_fee': '0', 'locked': '47635.51363389', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 16:47:26 - INFO - buy 주문 성공: UUID=908e6bbf-bdb7-450c-9f6c-9c73845a521e
2024-09-19 16:47:26 - INFO - Trade executed successfully.
2024-09-19 16:47:26 - INFO - 7. summary 리포트 보내기
2024-09-19 16:47:27 - INFO - Message sent to Discord successfully.
2024-09-19 16:47:27 - INFO - Trading cycle completed.
2024-09-19 16:47:27 - INFO - Performing periodic update.
2024-09-19 16:47:27 - INFO - 계산된 시장 변동성: 0.037783146029061486
2024-09-19 16:55:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:55:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-8699-f23e0f226318 "HTTP/1.1 200 OK"
2024-09-19 16:55:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:55:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:55:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/b06ac6f1-c32f-4464-a63d-e9ff14fc0daa "HTTP/1.1 200 OK"
2024-09-19 16:55:50 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:55:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:55:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-87af-f3c5adc62a8f "HTTP/1.1 200 OK"
2024-09-19 16:55:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-bafb-c7ab34c9aeb7 "HTTP/1.1 200 OK"
2024-09-19 16:56:02 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cf-8539-e69467c010f6 "HTTP/1.1 200 OK"
2024-09-19 16:56:08 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810d-b1ae-f02f3eb8c643 "HTTP/1.1 200 OK"
2024-09-19 16:56:16 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8115-a5ed-e31419433332 "HTTP/1.1 200 OK"
2024-09-19 16:56:22 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9816-cc114fe5ce56 "HTTP/1.1 200 OK"
2024-09-19 16:56:32 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 16:56:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8139-be9d-d737ae6b5d77 "HTTP/1.1 200 OK"
2024-09-19 16:56:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:45:34.930226
2024-09-19 16:56:48 - INFO - Starting trading cycle.
2024-09-19 16:56:48 - INFO - ##################################################
2024-09-19 16:56:48 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-19 16:56:48 - INFO - ##################################################
2024-09-19 16:56:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 16:56:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 16:56:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:40:00
2024-09-19 16:56:48 - INFO - 새로운 데이터 범위: 2024-09-18 07:40:00 ~ 2024-09-19 16:50:00
2024-09-19 16:56:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 16:56:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 16:56:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 16:56:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 16:56:48 - INFO - Sample date values: [Timestamp('2024-09-19 16:50:00')]
2024-09-19 16:56:48 - INFO - Successfully added 1 new data points
2024-09-19 16:56:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 16:56:48 - INFO - Final date range: 2024-09-19 16:50:00 to 2024-09-19 16:50:00
2024-09-19 16:56:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 16:56:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 16:50:00
2024-09-19 16:56:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 16:56:49 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-19 16:56:49 - INFO - 재학습 대상 모델: ['rl', 'prophet', 'ml']
2024-09-19 16:56:49 - INFO - rl 모델 재학습 시작
2024-09-19 16:56:49 - INFO - RL 에이전트 탐험 비율 조정: epsilon=0.1
2024-09-19 17:00:44 - INFO - rl 모델의 예측 통계가 초기화되었습니다.
2024-09-19 17:00:44 - INFO - rl 모델 재학습 완료
2024-09-19 17:00:44 - INFO - prophet 모델 재학습 시작
2024-09-19 17:00:44 - INFO - Prophet 모델 훈련 시작
2024-09-19 17:00:44 - DEBUG - cmd: where.exe tbb.dll
cwd: None
2024-09-19 17:00:44 - DEBUG - TBB already found in load path
2024-09-19 17:00:44 - DEBUG - input tempfile: C:\Users\injoo\AppData\Local\Temp\tmpjz6__58s\zrwbdyc7.json
2024-09-19 17:00:45 - DEBUG - input tempfile: C:\Users\injoo\AppData\Local\Temp\tmpjz6__58s\p_v1bxnv.json
2024-09-19 17:00:45 - DEBUG - idx 0
2024-09-19 17:00:45 - DEBUG - running CmdStan, num_threads: None
2024-09-19 17:00:45 - DEBUG - CmdStan args: ['C:\\Dev\\GPT_BTC\\pythonProject\\.venv\\Lib\\site-packages\\prophet\\stan_model\\prophet_model.bin', 'random', 'seed=39493', 'data', 'file=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\zrwbdyc7.json', 'init=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\p_v1bxnv.json', 'output', 'file=C:\\Users\\injoo\\AppData\\Local\\Temp\\tmpjz6__58s\\prophet_modelcdzuozmw\\prophet_model-20240919170045.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2024-09-19 17:00:45 - INFO - Chain [1] start processing
2024-09-19 17:00:45 - INFO - Chain [1] done processing
2024-09-19 17:00:45 - INFO - Prophet 모델 훈련 완료
2024-09-19 17:00:45 - INFO - prophet 모델의 예측 통계가 초기화되었습니다.
2024-09-19 17:00:45 - INFO - prophet 모델 재학습 완료
2024-09-19 17:00:45 - INFO - ml 모델 재학습 시작
2024-09-19 17:00:45 - INFO - prepare_data_for_ml 메서드 시작. 데이터 shape: (5000, 15)
2024-09-19 17:00:45 - INFO - 최종 X shape: (4999, 12), y shape: (4999,)
2024-09-19 17:00:45 - INFO - ML 모델 훈련 시작
2024-09-19 17:00:50 - INFO - ML 모델 학습 완료. MSE: 0.2637, RMSE: 0.5135, MAE: 0.4876, R2: -0.0557
2024-09-19 17:00:50 - INFO - ml 모델의 예측 통계가 초기화되었습니다.
2024-09-19 17:00:50 - INFO - ml 모델 재학습 완료
2024-09-19 17:00:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:00:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:00:50 - INFO - GPT | 이전예측가격: 82927000 | 당시BTC가격: 82927000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:00:50 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-19 17:00:50 - INFO - ML | 이전예측가격: 82860658 | 당시BTC가격: 82927000 | 예측: 하락 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1961 | 반영가중치값: 0.0200 | 새 가중치: 0.2161 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-19 17:00:50 - INFO - XGBOOST | 이전예측가격: 82927000 | 당시BTC가격: 82927000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:00:50 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 14/21
2024-09-19 17:00:50 - INFO - LSTM | 이전예측가격: 82833570 | 당시BTC가격: 82927000 | 예측: 하락 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1394 | 반영가중치값: 0.0200 | 새 가중치: 0.1594 | 예측 총 횟수: 21 | 예측 성공 수: 14 | 예측 성공률: 66.67%
2024-09-19 17:00:50 - INFO - RL 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 17:00:50 - INFO - RL | 이전예측가격: 83756270 | 당시BTC가격: 82927000 | 예측: 상승 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0510 | 반영가중치값: -0.0200 | 새 가중치: 0.0310 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 17:00:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.48%, 적중/전체: 109/193
2024-09-19 17:00:50 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82927000 | 예측: 하락 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2097 | 반영가중치값: 0.0200 | 새 가중치: 0.2297 | 예측 총 횟수: 193 | 예측 성공 수: 109 | 예측 성공률: 56.48%
2024-09-19 17:00:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 17:00:50 - INFO - PROPHET | 이전예측가격: 82958704 | 당시BTC가격: 82927000 | 예측: 상승 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0037 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 17:00:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 25/40
2024-09-19 17:00:50 - INFO - TRANSFORMER | 이전예측가격: 82833272 | 당시BTC가격: 82927000 | 예측: 하락 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1616 | 반영가중치값: 0.0200 | 새 가중치: 0.1816 | 예측 총 횟수: 40 | 예측 성공 수: 25 | 예측 성공률: 62.50%
2024-09-19 17:00:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.54%, 적중/전체: 24/41
2024-09-19 17:00:50 - INFO - BITCOIN_FORECAST | 이전예측가격: 82155074 | 당시BTC가격: 82927000 | 예측: 하락 | 지금 BTC가격: 82858000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1852 | 반영가중치값: 0.0200 | 새 가중치: 0.2052 | 예측 총 횟수: 41 | 예측 성공 수: 24 | 예측 성공률: 58.54%
2024-09-19 17:00:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:00:50 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:00:50 - INFO - 새로운 가중치: {'gpt': 0.002762561029388754, 'ml': 0.20114290259799358, 'xgboost': 0.04521287621360907, 'rl': 0.0288397682308125, 'lstm': 0.14836181403134965, 'arima': 0.21371651732209476, 'prophet': 0.0, 'transformer': 0.16899876135394074, 'bitcoin_forecast': 0.1909647992208109}
2024-09-19 17:00:50 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 17:00:50 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:00:50 - INFO - Current BTC price: 82858000.0
2024-09-19 17:00:50 - INFO - Analyzing market conditions.
2024-09-19 17:00:50 - INFO - Market analysis: {'current_price': 82852000.0, 'sma_20': 82825400.0, 'rsi_14': 51.05513797970297, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:00:50 - INFO - Starting predictions for all models
2024-09-19 17:00:50 - INFO - Attempting prediction for gpt
2024-09-19 17:00:51 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:00:51 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:00:51 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:00:51 - INFO - GPT prediction: 82858000.0
2024-09-19 17:00:51 - INFO - Attempting prediction for ml
2024-09-19 17:00:51 - INFO - ML prediction: 82901711.19999999
2024-09-19 17:00:51 - INFO - Attempting prediction for xgboost
2024-09-19 17:00:51 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:00:51 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:00:51 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:00:51 - INFO - XGBOOST prediction: 82852000.0
2024-09-19 17:00:51 - INFO - Attempting prediction for lstm
2024-09-19 17:00:51 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:00:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:00:51 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:00:51 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:00:51 - INFO - X 샘플:
[[-1.98374376 -2.31643034 -2.04247667 -1.1440399   1.50723718  1.50204057
  -1.1440399 ]
 [-0.49035041  0.02602731  0.1884996   0.92316091  1.51618939  1.51805718
   0.92316091]
 [ 1.08535595  1.2623244   1.33381362  0.72493618  0.67112654  0.67758272
   0.72493618]
 [ 0.56795983 -0.29931403 -0.71820733 -1.73871411 -0.22590757 -0.2279885
  -1.73871411]
 [-0.89015651 -0.75479191 -0.74206804  0.24353325  0.20455451  0.20159426
   0.24353325]
 [-0.83136149  0.72551119 -0.73013769 -1.10156318 -0.48273236 -0.48287925
  -1.10156318]
 [ 0.0035277  -0.15291043  0.70150484  0.73909509 -1.65333349 -1.65444549
   0.73909509]
 [ 0.57971883 -0.28304697  0.0572657  -0.47857115  0.27504921  0.27635892
  -0.47857115]
 [ 0.4386108   0.62790879  0.89239051  1.44704057 -0.58834997 -0.58714078
   1.44704057]
 [ 1.52043905  1.164722    1.05941547  0.38512234 -1.22383344 -1.22317963
   0.38512234]]
2024-09-19 17:00:51 - INFO - y 샘플:
[0.38512234]
2024-09-19 17:00:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:00:51 - INFO - 모델 출력 (스케일링된 예측): [[0.36064088]]
2024-09-19 17:00:51 - INFO - 스케일러 역변환 후 예측 가격: 82850270.95015496
2024-09-19 17:00:51 - INFO - LSTMPredictor 최종 예측 가격: 82850270.95015496
2024-09-19 17:00:51 - INFO - LSTM prediction: 82850270.95015496
2024-09-19 17:00:51 - INFO - Attempting prediction for rl
2024-09-19 17:00:51 - INFO - Preparing state for RL agent.
2024-09-19 17:00:51 - INFO - Prepared state: [[ 8.28520000e+07  6.97284455e+00 -9.04409903e-04  8.28254000e+07
   5.10551380e+01]]
2024-09-19 17:00:51 - INFO - RL prediction: 83686580.0
2024-09-19 17:00:51 - INFO - Attempting prediction for arima
2024-09-19 17:00:51 - INFO - ARIMA 예측 시작
2024-09-19 17:00:51 - INFO - 입력 데이터: {'open': 82951000.0, 'high': 82960000.0, 'low': 82850000.0, 'close': 82852000.0, 'volume': 6.97284455, 'value': 578103370.57055, 'decision': 'sell', 'sma': 82825400.0, 'ema': 82835720.69025019, 'rsi': 51.05513797970297, 'macd': 3789.538592323661, 'signal_line': 2199.3323609382514, 'BB_Upper': 83080515.97363085, 'BB_Lower': 82570284.02636915}
2024-09-19 17:00:51 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:00:51 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82825400.0         0         0
2024-09-19 17:00:51 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82825400.0         0         0
2024-09-19 17:00:51 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:00:51 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:00:51 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:00:51 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:00:51 - INFO - Attempting prediction for prophet
2024-09-19 17:00:51 - INFO - PROPHET prediction: 82855550.85745762
2024-09-19 17:00:51 - INFO - Attempting prediction for transformer
2024-09-19 17:00:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:00:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:00:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:00:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:00:51 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:00:51 - INFO - X 샘플:
[[-1.98374376 -2.31643034 -2.04247667 -1.1440399   1.50723718  1.50204057
  -1.1440399  -1.1440399   0.          0.          0.         -1.1440399
  -1.1440399 ]
 [-0.49035041  0.02602731  0.1884996   0.92316091  1.51618939  1.51805718
   0.92316091  0.92316091  0.          0.          0.          0.92316091
   0.92316091]
 [ 1.08535595  1.2623244   1.33381362  0.72493618  0.67112654  0.67758272
   0.72493618  0.72493618  0.          0.          0.          0.72493618
   0.72493618]
 [ 0.56795983 -0.29931403 -0.71820733 -1.73871411 -0.22590757 -0.2279885
  -1.73871411 -1.73871411  0.          0.          0.         -1.73871411
  -1.73871411]
 [-0.89015651 -0.75479191 -0.74206804  0.24353325  0.20455451  0.20159426
   0.24353325  0.24353325  0.          0.          0.          0.24353325
   0.24353325]
 [-0.83136149  0.72551119 -0.73013769 -1.10156318 -0.48273236 -0.48287925
  -1.10156318 -1.10156318  0.          0.          0.         -1.10156318
  -1.10156318]
 [ 0.0035277  -0.15291043  0.70150484  0.73909509 -1.65333349 -1.65444549
   0.73909509  0.73909509  0.          0.          0.          0.73909509
   0.73909509]
 [ 0.57971883 -0.28304697  0.0572657  -0.47857115  0.27504921  0.27635892
  -0.47857115 -0.47857115  0.          0.          0.         -0.47857115
  -0.47857115]
 [ 0.4386108   0.62790879  0.89239051  1.44704057 -0.58834997 -0.58714078
   1.44704057  1.44704057  0.          0.          0.          1.44704057
   1.44704057]
 [ 1.52043905  1.164722    1.05941547  0.38512234 -1.22383344 -1.22317963
   0.38512234  0.38512234  0.          0.          0.          0.38512234
   0.38512234]]
2024-09-19 17:00:51 - INFO - y 샘플:
[0.38512234]
2024-09-19 17:00:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:00:51 - INFO - 모델 출력 (스케일링된 예측): [0.3656707]
2024-09-19 17:00:51 - INFO - 스케일러 역변환 후 예측 가격: 82850626.19130415
2024-09-19 17:00:51 - INFO - TransformerPredictor 최종 예측 가격: 82850626.19130415
2024-09-19 17:00:51 - INFO - TRANSFORMER prediction: 82850626.19130415
2024-09-19 17:00:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:00:51 - INFO - BITCOIN_FORECAST prediction: 82142554.03970641
2024-09-19 17:00:51 - INFO - BitcoinForecast prediction: 82142554.03970641
2024-09-19 17:00:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:00:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:00:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:00:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:00:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:00:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:01:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:01:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:01:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:01:13 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:01:13 - INFO - 조정된 모델 가중치: {'gpt': 0.002762561029388754, 'ml': 0.20114290259799358, 'xgboost': 0.04521287621360907, 'rl': 0.0288397682308125, 'lstm': 0.14836181403134965, 'arima': 0.21371651732209476, 'prophet': 0.0, 'transformer': 0.16899876135394074, 'bitcoin_forecast': 0.1909647992208109}
2024-09-19 17:01:13 - INFO - 조정된 모델 가중치: {'gpt': 0.002762561029388754, 'ml': 0.20114290259799358, 'xgboost': 0.04521287621360907, 'rl': 0.0288397682308125, 'lstm': 0.14836181403134965, 'arima': 0.21371651732209476, 'prophet': 0.0, 'transformer': 0.16899876135394074, 'bitcoin_forecast': 0.1909647992208109}
2024-09-19 17:01:13 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82332728.46356085, 'current_price': 82858000.0, 'predictions': {'gpt': 82858000.0, 'ml': 82901711.19999999, 'xgboost': 82852000.0, 'lstm': 82850270.95015496, 'rl': 83686580.0, 'arima': 80899000.0, 'prophet': 82855550.85745762, 'transformer': 82850626.19130415, 'bitcoin_forecast': 82142554.03970641}, 'weights': {'gpt': 0.002762561029388754, 'ml': 0.20114290259799358, 'xgboost': 0.04521287621360907, 'rl': 0.0288397682308125, 'lstm': 0.14836181403134965, 'arima': 0.21371651732209476, 'prophet': 0.0, 'transformer': 0.16899876135394074, 'bitcoin_forecast': 0.1909647992208109}}
2024-09-19 17:01:13 - INFO - 모델별 가중치:
2024-09-19 17:01:13 - INFO -   - GPT: 0.0028
2024-09-19 17:01:13 - INFO -   - ML: 0.2011
2024-09-19 17:01:13 - INFO -   - XGBOOST: 0.0452
2024-09-19 17:01:13 - INFO -   - RL: 0.0288
2024-09-19 17:01:13 - INFO -   - LSTM: 0.1484
2024-09-19 17:01:13 - INFO -   - ARIMA: 0.2137
2024-09-19 17:01:13 - INFO -   - PROPHET: 0.0000
2024-09-19 17:01:13 - INFO -   - TRANSFORMER: 0.1690
2024-09-19 17:01:13 - INFO -   - BITCOIN_FORECAST: 0.1910
2024-09-19 17:01:13 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:01:13 - INFO - 6. 거래 실행
2024-09-19 17:01:13 - INFO - Cancelling existing orders.
2024-09-19 17:01:13 - INFO - Cancelled 0 orders.
2024-09-19 17:01:13 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82332728.46356085, 'current_price': 82858000.0, 'predictions': {'gpt': 82858000.0, 'ml': 82901711.19999999, 'xgboost': 82852000.0, 'lstm': 82850270.95015496, 'rl': 83686580.0, 'arima': 80899000.0, 'prophet': 82855550.85745762, 'transformer': 82850626.19130415, 'bitcoin_forecast': 82142554.03970641}, 'weights': {'gpt': 0.002762561029388754, 'ml': 0.20114290259799358, 'xgboost': 0.04521287621360907, 'rl': 0.0288397682308125, 'lstm': 0.14836181403134965, 'arima': 0.21371651732209476, 'prophet': 0.0, 'transformer': 0.16899876135394074, 'bitcoin_forecast': 0.1909647992208109}}, 현재 가격=82858000.0
2024-09-19 17:01:13 - INFO - 현재 잔고: KRW=353231.54114646, BTC=0.00148166, 총 자산가치=475998.92542646
2024-09-19 17:01:13 - INFO - 매도 시도: 0.00029633200000000006 BTC (약 24553.476856000005 KRW)
2024-09-19 17:01:13 - INFO - 주문 결과: {'uuid': '6fded539-b90e-4076-82a0-1f5727dc345a', 'side': 'ask', 'ord_type': 'limit', 'price': '82858000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:01:15+09:00', 'volume': '0.00029633', 'remaining_volume': '0.00029633', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00029633', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:01:13 - INFO - sell 주문 성공: UUID=6fded539-b90e-4076-82a0-1f5727dc345a
2024-09-19 17:01:13 - INFO - Trade executed successfully.
2024-09-19 17:01:13 - INFO - 7. summary 리포트 보내기
2024-09-19 17:01:13 - INFO - Message sent to Discord successfully.
2024-09-19 17:01:13 - INFO - Trading cycle completed.
2024-09-19 17:01:13 - INFO - Performing periodic update.
2024-09-19 17:01:13 - INFO - 계산된 시장 변동성: 0.037807671620850976
2024-09-19 17:05:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:05:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ae-86dd-c170ee4755d1 "HTTP/1.1 200 OK"
2024-09-19 17:05:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:05:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:05:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d8178354-ca32-458a-bd50-c16dc17a8539 "HTTP/1.1 200 OK"
2024-09-19 17:05:56 - INFO - Updated actual price for ml prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811d-8bf0-c257a5ba0983 "HTTP/1.1 200 OK"
2024-09-19 17:06:02 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-8804-fb43d7497dfe "HTTP/1.1 200 OK"
2024-09-19 17:06:13 - INFO - Updated actual price for lstm prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810e-94d2-c3d4772232ce "HTTP/1.1 200 OK"
2024-09-19 17:06:21 - INFO - Updated actual price for rl prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8147-a5d6-e18f83c82127 "HTTP/1.1 200 OK"
2024-09-19 17:06:27 - INFO - Updated actual price for arima prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bf-9ffc-cd94c3167499 "HTTP/1.1 200 OK"
2024-09-19 17:06:35 - INFO - Updated actual price for prophet prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fb-a129-dd75024c8100 "HTTP/1.1 200 OK"
2024-09-19 17:06:40 - INFO - Updated actual price for transformer prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:06:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-b473-f5a9caad3064 "HTTP/1.1 200 OK"
2024-09-19 17:06:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 16:55:34.930541
2024-09-19 17:06:47 - INFO - Starting trading cycle.
2024-09-19 17:06:47 - INFO - ##################################################
2024-09-19 17:06:47 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-19 17:06:47 - INFO - ##################################################
2024-09-19 17:06:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:06:47 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:06:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 16:50:00
2024-09-19 17:06:47 - INFO - 새로운 데이터 범위: 2024-09-18 07:50:00 ~ 2024-09-19 17:00:00
2024-09-19 17:06:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:06:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:06:47 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:06:47 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:06:47 - INFO - Sample date values: [Timestamp('2024-09-19 17:00:00')]
2024-09-19 17:06:47 - INFO - Successfully added 1 new data points
2024-09-19 17:06:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:06:47 - INFO - Final date range: 2024-09-19 17:00:00 to 2024-09-19 17:00:00
2024-09-19 17:06:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:06:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:00:00
2024-09-19 17:06:47 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:06:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:06:47 - INFO - GPT | 이전예측가격: 82858000 | 당시BTC가격: 82858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:06:47 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-19 17:06:47 - INFO - ML | 이전예측가격: 82901711 | 당시BTC가격: 82858000 | 예측: 상승 | 지금 BTC가격: 82915000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-19 17:06:47 - INFO - XGBOOST | 이전예측가격: 82852000 | 당시BTC가격: 82858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:06:47 - INFO - LSTM | 이전예측가격: 82850271 | 당시BTC가격: 82858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:06:47 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 17:06:47 - INFO - RL | 이전예측가격: 83686580 | 당시BTC가격: 82858000 | 예측: 상승 | 지금 BTC가격: 82915000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 17:06:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.19%, 적중/전체: 109/194
2024-09-19 17:06:47 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82858000 | 예측: 하락 | 지금 BTC가격: 82915000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0270 | 반영가중치값: -0.0200 | 새 가중치: 0.0070 | 예측 총 횟수: 194 | 예측 성공 수: 109 | 예측 성공률: 56.19%
2024-09-19 17:06:47 - INFO - PROPHET | 이전예측가격: 82855551 | 당시BTC가격: 82858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:06:47 - INFO - TRANSFORMER | 이전예측가격: 82850626 | 당시BTC가격: 82858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:06:47 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 24/42
2024-09-19 17:06:47 - INFO - BITCOIN_FORECAST | 이전예측가격: 82142554 | 당시BTC가격: 82858000 | 예측: 하락 | 지금 BTC가격: 82915000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0283 | 반영가중치값: -0.0200 | 새 가중치: 0.0083 | 예측 총 횟수: 42 | 예측 성공 수: 24 | 예측 성공률: 57.14%
2024-09-19 17:06:47 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:06:47 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:06:47 - INFO - 새로운 가중치: {'gpt': 0.004119379330691786, 'ml': 0.21621603888420524, 'xgboost': 0.06741895863081694, 'rl': 0.21621603888420524, 'lstm': 0.2212289913898864, 'arima': 0.010483166679378673, 'prophet': 0.0, 'transformer': 0.25200167418128394, 'bitcoin_forecast': 0.01231575201953174}
2024-09-19 17:06:47 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 17:06:47 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:06:47 - INFO - Current BTC price: 82915000.0
2024-09-19 17:06:47 - INFO - Analyzing market conditions.
2024-09-19 17:06:47 - INFO - Market analysis: {'current_price': 82915000.0, 'sma_20': 82825600.0, 'rsi_14': 53.13738262831532, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:06:47 - INFO - Starting predictions for all models
2024-09-19 17:06:47 - INFO - Attempting prediction for gpt
2024-09-19 17:06:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:06:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:06:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:06:48 - INFO - GPT prediction: 82915000.0
2024-09-19 17:06:48 - INFO - Attempting prediction for ml
2024-09-19 17:06:48 - INFO - ML prediction: 82948166.0
2024-09-19 17:06:48 - INFO - Attempting prediction for xgboost
2024-09-19 17:06:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:06:48 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:06:48 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:06:48 - INFO - XGBOOST prediction: 82915000.0
2024-09-19 17:06:48 - INFO - Attempting prediction for lstm
2024-09-19 17:06:48 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:06:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:06:48 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:06:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:06:48 - INFO - X 샘플:
[[-9.68028036e-01 -3.92627251e-01 -1.61141342e-01  6.90214100e-01
   1.97545186e+00  1.97470893e+00  6.90214100e-01]
 [ 1.12754154e+00  1.54501373e+00  1.31215093e+00  4.89320183e-01
   1.01410424e+00  1.01959120e+00  4.89320183e-01]
 [ 4.39444068e-01 -9.02532772e-01 -1.32749772e+00 -2.00750421e+00
  -6.36612402e-03 -9.50268489e-03 -2.00750421e+00]
 [-1.49973972e+00 -1.61640050e+00 -1.35819131e+00  1.43495655e-03
   4.83329633e-01  4.78676467e-01  1.43495655e-03]
 [-1.42154682e+00  7.03669619e-01 -1.34284451e+00 -1.36177376e+00
  -2.98531253e-01 -2.99161301e-01 -1.36177376e+00]
 [-3.11207721e-01 -6.73075287e-01  4.98770820e-01  5.03669749e-01
  -1.63021279e+00 -1.63053274e+00  5.03669749e-01]
 [ 4.55082647e-01 -8.77037496e-01 -3.29956081e-01 -7.30392883e-01
   5.63524747e-01  5.63639259e-01 -7.30392883e-01]
 [ 2.67419700e-01  5.50697962e-01  7.44319531e-01  1.22114802e+00
  -4.18682365e-01 -4.17644421e-01  1.22114802e+00]
 [ 1.70616896e+00  1.39204207e+00  9.59174653e-01  1.44930611e-01
  -1.14161145e+00 -1.14044090e+00  1.44930611e-01]
 [ 2.04865384e-01  2.70249926e-01  1.00521504e+00  1.04895324e+00
  -5.41006502e-01 -5.39333803e-01  1.04895324e+00]]
2024-09-19 17:06:48 - INFO - y 샘플:
[1.04895324]
2024-09-19 17:06:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:06:48 - INFO - 모델 출력 (스케일링된 예측): [[0.3609913]]
2024-09-19 17:06:48 - INFO - 스케일러 역변환 후 예측 가격: 82867056.94983755
2024-09-19 17:06:48 - INFO - LSTMPredictor 최종 예측 가격: 82867056.94983755
2024-09-19 17:06:48 - INFO - LSTM prediction: 82867056.94983755
2024-09-19 17:06:48 - INFO - Attempting prediction for rl
2024-09-19 17:06:48 - INFO - Preparing state for RL agent.
2024-09-19 17:06:48 - INFO - Prepared state: [[8.29150000e+07 8.85953842e+00 7.60392024e-04 8.28256000e+07
  5.31373826e+01]]
2024-09-19 17:06:48 - INFO - RL prediction: 83744150.0
2024-09-19 17:06:48 - INFO - Attempting prediction for arima
2024-09-19 17:06:48 - INFO - ARIMA 예측 시작
2024-09-19 17:06:48 - INFO - 입력 데이터: {'open': 82855000.0, 'high': 82916000.0, 'low': 82853000.0, 'close': 82915000.0, 'volume': 8.85953842, 'value': 734458784.19592, 'decision': 'sell', 'sma': 82825600.0, 'ema': 82843271.10070255, 'rsi': 53.13738262831532, 'macd': 10338.471253037453, 'signal_line': 3827.160139358092, 'BB_Upper': 83080990.21124862, 'BB_Lower': 82570209.78875138}
2024-09-19 17:06:48 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:06:48 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82825600.0         0         0
2024-09-19 17:06:48 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82825600.0         0         0
2024-09-19 17:06:48 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:06:48 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:06:48 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:06:48 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:06:48 - INFO - Attempting prediction for prophet
2024-09-19 17:06:48 - INFO - PROPHET prediction: 82930839.35649787
2024-09-19 17:06:48 - INFO - Attempting prediction for transformer
2024-09-19 17:06:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:06:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:06:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:06:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:06:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:06:48 - INFO - X 샘플:
[[-9.68028036e-01 -3.92627251e-01 -1.61141342e-01  6.90214100e-01
   1.97545186e+00  1.97470893e+00  6.90214100e-01  6.90214100e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  6.90214100e-01
   6.90214100e-01]
 [ 1.12754154e+00  1.54501373e+00  1.31215093e+00  4.89320183e-01
   1.01410424e+00  1.01959120e+00  4.89320183e-01  4.89320183e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  4.89320183e-01
   4.89320183e-01]
 [ 4.39444068e-01 -9.02532772e-01 -1.32749772e+00 -2.00750421e+00
  -6.36612402e-03 -9.50268489e-03 -2.00750421e+00 -2.00750421e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00750421e+00
  -2.00750421e+00]
 [-1.49973972e+00 -1.61640050e+00 -1.35819131e+00  1.43495655e-03
   4.83329633e-01  4.78676467e-01  1.43495655e-03  1.43495655e-03
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.43495655e-03
   1.43495655e-03]
 [-1.42154682e+00  7.03669619e-01 -1.34284451e+00 -1.36177376e+00
  -2.98531253e-01 -2.99161301e-01 -1.36177376e+00 -1.36177376e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.36177376e+00
  -1.36177376e+00]
 [-3.11207721e-01 -6.73075287e-01  4.98770820e-01  5.03669749e-01
  -1.63021279e+00 -1.63053274e+00  5.03669749e-01  5.03669749e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  5.03669749e-01
   5.03669749e-01]
 [ 4.55082647e-01 -8.77037496e-01 -3.29956081e-01 -7.30392883e-01
   5.63524747e-01  5.63639259e-01 -7.30392883e-01 -7.30392883e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -7.30392883e-01
  -7.30392883e-01]
 [ 2.67419700e-01  5.50697962e-01  7.44319531e-01  1.22114802e+00
  -4.18682365e-01 -4.17644421e-01  1.22114802e+00  1.22114802e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.22114802e+00
   1.22114802e+00]
 [ 1.70616896e+00  1.39204207e+00  9.59174653e-01  1.44930611e-01
  -1.14161145e+00 -1.14044090e+00  1.44930611e-01  1.44930611e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.44930611e-01
   1.44930611e-01]
 [ 2.04865384e-01  2.70249926e-01  1.00521504e+00  1.04895324e+00
  -5.41006502e-01 -5.39333803e-01  1.04895324e+00  1.04895324e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.04895324e+00
   1.04895324e+00]]
2024-09-19 17:06:48 - INFO - y 샘플:
[1.04895324]
2024-09-19 17:06:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:06:48 - INFO - 모델 출력 (스케일링된 예측): [0.36625594]
2024-09-19 17:06:48 - INFO - 스케일러 역변환 후 예측 가격: 82867423.83480415
2024-09-19 17:06:48 - INFO - TransformerPredictor 최종 예측 가격: 82867423.83480415
2024-09-19 17:06:48 - INFO - TRANSFORMER prediction: 82867423.83480415
2024-09-19 17:06:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:06:48 - INFO - BITCOIN_FORECAST prediction: 82159831.5810544
2024-09-19 17:06:48 - INFO - BitcoinForecast prediction: 82159831.5810544
2024-09-19 17:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:06:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:06:54 - INFO - 조정된 모델 가중치: {'gpt': 0.004119379330691786, 'ml': 0.21621603888420524, 'xgboost': 0.06741895863081694, 'rl': 0.21621603888420524, 'lstm': 0.2212289913898864, 'arima': 0.010483166679378673, 'prophet': 0.0, 'transformer': 0.25200167418128394, 'bitcoin_forecast': 0.01231575201953174}
2024-09-19 17:06:54 - INFO - 조정된 모델 가중치: {'gpt': 0.004119379330691786, 'ml': 0.21621603888420524, 'xgboost': 0.06741895863081694, 'rl': 0.21621603888420524, 'lstm': 0.2212289913898864, 'arima': 0.010483166679378673, 'prophet': 0.0, 'transformer': 0.25200167418128394, 'bitcoin_forecast': 0.01231575201953174}
2024-09-19 17:06:54 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83048416.35286805, 'current_price': 82915000.0, 'predictions': {'gpt': 82915000.0, 'ml': 82948166.0, 'xgboost': 82915000.0, 'lstm': 82867056.94983755, 'rl': 83744150.0, 'arima': 80899000.0, 'prophet': 82930839.35649787, 'transformer': 82867423.83480415, 'bitcoin_forecast': 82159831.5810544}, 'weights': {'gpt': 0.004119379330691786, 'ml': 0.21621603888420524, 'xgboost': 0.06741895863081694, 'rl': 0.21621603888420524, 'lstm': 0.2212289913898864, 'arima': 0.010483166679378673, 'prophet': 0.0, 'transformer': 0.25200167418128394, 'bitcoin_forecast': 0.01231575201953174}}
2024-09-19 17:06:54 - INFO - 모델별 가중치:
2024-09-19 17:06:54 - INFO -   - GPT: 0.0041
2024-09-19 17:06:54 - INFO -   - ML: 0.2162
2024-09-19 17:06:54 - INFO -   - XGBOOST: 0.0674
2024-09-19 17:06:54 - INFO -   - RL: 0.2162
2024-09-19 17:06:54 - INFO -   - LSTM: 0.2212
2024-09-19 17:06:54 - INFO -   - ARIMA: 0.0105
2024-09-19 17:06:54 - INFO -   - PROPHET: 0.0000
2024-09-19 17:06:54 - INFO -   - TRANSFORMER: 0.2520
2024-09-19 17:06:54 - INFO -   - BITCOIN_FORECAST: 0.0123
2024-09-19 17:06:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:06:54 - INFO - 6. 거래 실행
2024-09-19 17:06:54 - INFO - Cancelling existing orders.
2024-09-19 17:06:54 - INFO - Cancelled 0 orders.
2024-09-19 17:06:54 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83048416.35286805, 'current_price': 82915000.0, 'predictions': {'gpt': 82915000.0, 'ml': 82948166.0, 'xgboost': 82915000.0, 'lstm': 82867056.94983755, 'rl': 83744150.0, 'arima': 80899000.0, 'prophet': 82930839.35649787, 'transformer': 82867423.83480415, 'bitcoin_forecast': 82159831.5810544}, 'weights': {'gpt': 0.004119379330691786, 'ml': 0.21621603888420524, 'xgboost': 0.06741895863081694, 'rl': 0.21621603888420524, 'lstm': 0.2212289913898864, 'arima': 0.010483166679378673, 'prophet': 0.0, 'transformer': 0.25200167418128394, 'bitcoin_forecast': 0.01231575201953174}}, 현재 가격=82915000.0
2024-09-19 17:06:54 - INFO - 현재 잔고: KRW=377782.34963145, BTC=0.00118533, 총 자산가치=476063.98658145004
2024-09-19 17:06:54 - INFO - 매수 시도: 0.0005741590623909426 BTC (약 47606.39865814501 KRW)
2024-09-19 17:06:54 - INFO - 주문 결과: {'uuid': '6a058b4e-08bb-4a30-9863-797db5cc00ec', 'side': 'bid', 'ord_type': 'limit', 'price': '82915000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:06:56+09:00', 'volume': '0.00057415', 'remaining_volume': '0.00057415', 'reserved_fee': '23.802823625', 'remaining_fee': '23.802823625', 'paid_fee': '0', 'locked': '47629.450073625', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:06:54 - INFO - buy 주문 성공: UUID=6a058b4e-08bb-4a30-9863-797db5cc00ec
2024-09-19 17:06:54 - INFO - Trade executed successfully.
2024-09-19 17:06:54 - INFO - 7. summary 리포트 보내기
2024-09-19 17:06:55 - INFO - Message sent to Discord successfully.
2024-09-19 17:06:55 - INFO - Trading cycle completed.
2024-09-19 17:06:55 - INFO - Performing periodic update.
2024-09-19 17:06:55 - INFO - 계산된 시장 변동성: 0.03780144377091047
2024-09-19 17:15:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:15:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-aa2f-c8f6af2178e1 "HTTP/1.1 200 OK"
2024-09-19 17:15:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:15:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:15:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-9f9f-fd76f077f10b "HTTP/1.1 200 OK"
2024-09-19 17:15:54 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:15:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a3-b0a1-fecdd1341709 "HTTP/1.1 200 OK"
2024-09-19 17:16:01 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-afdc-c944822b6a98 "HTTP/1.1 200 OK"
2024-09-19 17:16:14 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-841b-c704d13cc6ea "HTTP/1.1 200 OK"
2024-09-19 17:16:19 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-831e-d69c6ecf43ae "HTTP/1.1 200 OK"
2024-09-19 17:16:30 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-a9c3-d1dbf7eb9cec "HTTP/1.1 200 OK"
2024-09-19 17:16:40 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8102-bb73-f9e373d1a7fc "HTTP/1.1 200 OK"
2024-09-19 17:16:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:16:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8149-9476-dd9ce1e663b5 "HTTP/1.1 200 OK"
2024-09-19 17:16:58 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:05:34.931084
2024-09-19 17:16:58 - INFO - Starting trading cycle.
2024-09-19 17:16:58 - INFO - ##################################################
2024-09-19 17:16:58 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-19 17:16:58 - INFO - ##################################################
2024-09-19 17:16:58 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:16:58 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:16:58 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:00:00
2024-09-19 17:16:58 - INFO - 새로운 데이터 범위: 2024-09-18 08:00:00 ~ 2024-09-19 17:10:00
2024-09-19 17:16:58 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:16:58 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:16:58 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:16:58 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:16:58 - INFO - Sample date values: [Timestamp('2024-09-19 17:10:00')]
2024-09-19 17:16:58 - INFO - Successfully added 1 new data points
2024-09-19 17:16:58 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:16:58 - INFO - Final date range: 2024-09-19 17:10:00 to 2024-09-19 17:10:00
2024-09-19 17:16:58 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:16:58 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:10:00
2024-09-19 17:16:58 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:16:58 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:16:58 - INFO - GPT | 이전예측가격: 82915000 | 당시BTC가격: 82915000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:16:58 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 3/3
2024-09-19 17:16:58 - INFO - ML | 이전예측가격: 82948166 | 당시BTC가격: 82915000 | 예측: 상승 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2011 | 반영가중치값: 0.0200 | 새 가중치: 0.2211 | 예측 총 횟수: 3 | 예측 성공 수: 3 | 예측 성공률: 100.00%
2024-09-19 17:16:58 - INFO - XGBOOST | 이전예측가격: 82915000 | 당시BTC가격: 82915000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:16:58 - INFO - LSTM 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 14/22
2024-09-19 17:16:58 - INFO - LSTM | 이전예측가격: 82867057 | 당시BTC가격: 82915000 | 예측: 하락 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1484 | 반영가중치값: -0.0200 | 새 가중치: 0.1284 | 예측 총 횟수: 22 | 예측 성공 수: 14 | 예측 성공률: 63.64%
2024-09-19 17:16:58 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 17:16:58 - INFO - RL | 이전예측가격: 83744150 | 당시BTC가격: 82915000 | 예측: 상승 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0288 | 반영가중치값: 0.0200 | 새 가중치: 0.0488 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 17:16:58 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.90%, 적중/전체: 109/195
2024-09-19 17:16:58 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82915000 | 예측: 하락 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2137 | 반영가중치값: -0.0200 | 새 가중치: 0.1937 | 예측 총 횟수: 195 | 예측 성공 수: 109 | 예측 성공률: 55.90%
2024-09-19 17:16:58 - INFO - PROPHET 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 17:16:58 - INFO - PROPHET | 이전예측가격: 82930839 | 당시BTC가격: 82915000 | 예측: 상승 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 17:16:58 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.98%, 적중/전체: 25/41
2024-09-19 17:16:59 - INFO - TRANSFORMER | 이전예측가격: 82867424 | 당시BTC가격: 82915000 | 예측: 하락 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1690 | 반영가중치값: -0.0200 | 새 가중치: 0.1490 | 예측 총 횟수: 41 | 예측 성공 수: 25 | 예측 성공률: 60.98%
2024-09-19 17:16:59 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.81%, 적중/전체: 24/43
2024-09-19 17:16:59 - INFO - BITCOIN_FORECAST | 이전예측가격: 82159832 | 당시BTC가격: 82915000 | 예측: 하락 | 지금 BTC가격: 82939000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1910 | 반영가중치값: -0.0200 | 새 가중치: 0.1710 | 예측 총 횟수: 43 | 예측 성공 수: 24 | 예측 성공률: 55.81%
2024-09-19 17:16:59 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:16:59 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:16:59 - INFO - 새로운 가중치: {'gpt': 0.0041047544979417585, 'ml': 0.22035778967084582, 'xgboost': 0.0671796043701373, 'rl': 0.048666374769180065, 'lstm': 0.12790609730535846, 'arima': 0.1930287749610926, 'prophet': 0.019928994969503955, 'transformer': 0.14846977827425026, 'bitcoin_forecast': 0.17035783118168968}
2024-09-19 17:16:59 - INFO - XGBoost 모델 성능: 정확도 63.16%, 적중/전체: 72/114
2024-09-19 17:16:59 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:16:59 - INFO - Current BTC price: 82939000.0
2024-09-19 17:16:59 - INFO - Analyzing market conditions.
2024-09-19 17:16:59 - INFO - Market analysis: {'current_price': 82927000.0, 'sma_20': 82823950.0, 'rsi_14': 53.54280065090594, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:16:59 - INFO - Starting predictions for all models
2024-09-19 17:16:59 - INFO - Attempting prediction for gpt
2024-09-19 17:16:59 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:16:59 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:16:59 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:16:59 - INFO - GPT prediction: 82939000.0
2024-09-19 17:16:59 - INFO - Attempting prediction for ml
2024-09-19 17:16:59 - INFO - ML prediction: 82976756.19999999
2024-09-19 17:16:59 - INFO - Attempting prediction for xgboost
2024-09-19 17:16:59 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:16:59 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:16:59 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:16:59 - INFO - XGBOOST prediction: 82927000.0
2024-09-19 17:16:59 - INFO - Attempting prediction for lstm
2024-09-19 17:16:59 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:16:59 - INFO - X 샘플:
[[ 1.03684072  1.23495364  1.09964626  0.41617915  1.64318117  1.64956183
   0.41617915]
 [ 0.31384561 -1.00617206 -1.37924177 -1.9658989   0.28735187  0.28265136
  -1.9658989 ]
 [-1.72368608 -1.65983372 -1.40806605 -0.04928437  0.93797719  0.93108315
  -0.04928437]
 [-1.64152754  0.46456668 -1.39365391 -1.34984423 -0.10082798 -0.10209235
  -1.34984423]
 [-0.47487634 -0.79606653  0.33580286  0.42986926 -1.87014232 -1.87050783
   0.42986926]
 [ 0.33027731 -0.982827   -0.44245269 -0.74747967  1.04452696  1.04393635
  -0.74747967]
 [ 0.13309683  0.32449633  0.56639709  1.11437445 -0.26046456 -0.25946945
   1.11437445]
 [ 1.64481388  1.09488329  0.76816705  0.08761666 -1.22097107 -1.21953548
   0.08761666]
 [ 0.06737     0.06770067  0.81140347  0.9500932  -0.42298829 -0.42110533
   0.9500932 ]
 [ 0.31384561  1.2582987   1.0419977   1.11437445 -0.03764296 -0.03452226
   1.11437445]]
2024-09-19 17:16:59 - INFO - y 샘플:
[1.11437445]
2024-09-19 17:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:16:59 - INFO - 모델 출력 (스케일링된 예측): [[0.37550753]]
2024-09-19 17:16:59 - INFO - 스케일러 역변환 후 예측 가격: 82873029.12250954
2024-09-19 17:16:59 - INFO - LSTMPredictor 최종 예측 가격: 82873029.12250954
2024-09-19 17:16:59 - INFO - LSTM prediction: 82873029.12250954
2024-09-19 17:16:59 - INFO - Attempting prediction for rl
2024-09-19 17:16:59 - INFO - Preparing state for RL agent.
2024-09-19 17:16:59 - INFO - Prepared state: [[8.29270000e+07 9.77062159e+00 1.44726527e-04 8.28239500e+07
  5.35428007e+01]]
2024-09-19 17:16:59 - INFO - RL prediction: 83768390.0
2024-09-19 17:16:59 - INFO - Attempting prediction for arima
2024-09-19 17:16:59 - INFO - ARIMA 예측 시작
2024-09-19 17:16:59 - INFO - 입력 데이터: {'open': 82870000.0, 'high': 82967000.0, 'low': 82869000.0, 'close': 82927000.0, 'volume': 9.77062159, 'value': 810162782.50198, 'decision': 'sell', 'sma': 82823950.0, 'ema': 82851245.28158802, 'rsi': 53.54280065090594, 'macd': 16308.849021360278, 'signal_line': 6323.497915758529, 'BB_Upper': 83076253.36898904, 'BB_Lower': 82571646.63101096}
2024-09-19 17:16:59 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:16:59 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82823950.0         0         0
2024-09-19 17:16:59 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82823950.0         0         0
2024-09-19 17:16:59 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:16:59 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:16:59 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:16:59 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:16:59 - INFO - Attempting prediction for prophet
2024-09-19 17:16:59 - INFO - PROPHET prediction: 82945554.96250346
2024-09-19 17:16:59 - INFO - Attempting prediction for transformer
2024-09-19 17:16:59 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:16:59 - INFO - X 샘플:
[[ 1.03684072  1.23495364  1.09964626  0.41617915  1.64318117  1.64956183
   0.41617915  0.41617915  0.          0.          0.          0.41617915
   0.41617915]
 [ 0.31384561 -1.00617206 -1.37924177 -1.9658989   0.28735187  0.28265136
  -1.9658989  -1.9658989   0.          0.          0.         -1.9658989
  -1.9658989 ]
 [-1.72368608 -1.65983372 -1.40806605 -0.04928437  0.93797719  0.93108315
  -0.04928437 -0.04928437  0.          0.          0.         -0.04928437
  -0.04928437]
 [-1.64152754  0.46456668 -1.39365391 -1.34984423 -0.10082798 -0.10209235
  -1.34984423 -1.34984423  0.          0.          0.         -1.34984423
  -1.34984423]
 [-0.47487634 -0.79606653  0.33580286  0.42986926 -1.87014232 -1.87050783
   0.42986926  0.42986926  0.          0.          0.          0.42986926
   0.42986926]
 [ 0.33027731 -0.982827   -0.44245269 -0.74747967  1.04452696  1.04393635
  -0.74747967 -0.74747967  0.          0.          0.         -0.74747967
  -0.74747967]
 [ 0.13309683  0.32449633  0.56639709  1.11437445 -0.26046456 -0.25946945
   1.11437445  1.11437445  0.          0.          0.          1.11437445
   1.11437445]
 [ 1.64481388  1.09488329  0.76816705  0.08761666 -1.22097107 -1.21953548
   0.08761666  0.08761666  0.          0.          0.          0.08761666
   0.08761666]
 [ 0.06737     0.06770067  0.81140347  0.9500932  -0.42298829 -0.42110533
   0.9500932   0.9500932   0.          0.          0.          0.9500932
   0.9500932 ]
 [ 0.31384561  1.2582987   1.0419977   1.11437445 -0.03764296 -0.03452226
   1.11437445  1.11437445  0.          0.          0.          1.11437445
   1.11437445]]
2024-09-19 17:16:59 - INFO - y 샘플:
[1.11437445]
2024-09-19 17:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:16:59 - INFO - 모델 출력 (스케일링된 예측): [0.36335683]
2024-09-19 17:16:59 - INFO - 스케일러 역변환 후 예측 가격: 82872141.56861934
2024-09-19 17:16:59 - INFO - TransformerPredictor 최종 예측 가격: 82872141.56861934
2024-09-19 17:16:59 - INFO - TRANSFORMER prediction: 82872141.56861934
2024-09-19 17:16:59 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:16:59 - INFO - BITCOIN_FORECAST prediction: 82168598.73216477
2024-09-19 17:16:59 - INFO - BitcoinForecast prediction: 82168598.73216477
2024-09-19 17:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:17:10 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0041047544979417585, 'ml': 0.22035778967084582, 'xgboost': 0.0671796043701373, 'rl': 0.048666374769180065, 'lstm': 0.12790609730535846, 'arima': 0.1930287749610926, 'prophet': 0.019928994969503955, 'transformer': 0.14846977827425026, 'bitcoin_forecast': 0.17035783118168968}
2024-09-19 17:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0041047544979417585, 'ml': 0.22035778967084582, 'xgboost': 0.0671796043701373, 'rl': 0.048666374769180065, 'lstm': 0.12790609730535846, 'arima': 0.1930287749610926, 'prophet': 0.019928994969503955, 'transformer': 0.14846977827425026, 'bitcoin_forecast': 0.17035783118168968}
2024-09-19 17:17:10 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82443620.63190337, 'current_price': 82939000.0, 'predictions': {'gpt': 82939000.0, 'ml': 82976756.19999999, 'xgboost': 82927000.0, 'lstm': 82873029.12250954, 'rl': 83768390.0, 'arima': 80899000.0, 'prophet': 82945554.96250346, 'transformer': 82872141.56861934, 'bitcoin_forecast': 82168598.73216477}, 'weights': {'gpt': 0.0041047544979417585, 'ml': 0.22035778967084582, 'xgboost': 0.0671796043701373, 'rl': 0.048666374769180065, 'lstm': 0.12790609730535846, 'arima': 0.1930287749610926, 'prophet': 0.019928994969503955, 'transformer': 0.14846977827425026, 'bitcoin_forecast': 0.17035783118168968}}
2024-09-19 17:17:10 - INFO - 모델별 가중치:
2024-09-19 17:17:10 - INFO -   - GPT: 0.0041
2024-09-19 17:17:10 - INFO -   - ML: 0.2204
2024-09-19 17:17:10 - INFO -   - XGBOOST: 0.0672
2024-09-19 17:17:10 - INFO -   - RL: 0.0487
2024-09-19 17:17:10 - INFO -   - LSTM: 0.1279
2024-09-19 17:17:10 - INFO -   - ARIMA: 0.1930
2024-09-19 17:17:10 - INFO -   - PROPHET: 0.0199
2024-09-19 17:17:10 - INFO -   - TRANSFORMER: 0.1485
2024-09-19 17:17:10 - INFO -   - BITCOIN_FORECAST: 0.1704
2024-09-19 17:17:10 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:17:10 - INFO - 6. 거래 실행
2024-09-19 17:17:10 - INFO - Cancelling existing orders.
2024-09-19 17:17:10 - INFO - Cancelled 0 orders.
2024-09-19 17:17:10 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82443620.63190337, 'current_price': 82939000.0, 'predictions': {'gpt': 82939000.0, 'ml': 82976756.19999999, 'xgboost': 82927000.0, 'lstm': 82873029.12250954, 'rl': 83768390.0, 'arima': 80899000.0, 'prophet': 82945554.96250346, 'transformer': 82872141.56861934, 'bitcoin_forecast': 82168598.73216477}, 'weights': {'gpt': 0.0041047544979417585, 'ml': 0.22035778967084582, 'xgboost': 0.0671796043701373, 'rl': 0.048666374769180065, 'lstm': 0.12790609730535846, 'arima': 0.1930287749610926, 'prophet': 0.019928994969503955, 'transformer': 0.14846977827425026, 'bitcoin_forecast': 0.17035783118168968}}, 현재 가격=82939000.0
2024-09-19 17:17:10 - INFO - 현재 잔고: KRW=330152.89955782, BTC=0.00175948, 총 자산가치=476082.41127782
2024-09-19 17:17:10 - INFO - 매도 시도: 0.000351896 BTC (약 29185.902344 KRW)
2024-09-19 17:17:10 - INFO - 주문 결과: {'uuid': '778c7a59-3533-4c0a-8ef0-5ebbf62e5790', 'side': 'ask', 'ord_type': 'limit', 'price': '82939000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:17:12+09:00', 'volume': '0.00035189', 'remaining_volume': '0.00035189', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00035189', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:17:10 - INFO - sell 주문 성공: UUID=778c7a59-3533-4c0a-8ef0-5ebbf62e5790
2024-09-19 17:17:10 - INFO - Trade executed successfully.
2024-09-19 17:17:10 - INFO - 7. summary 리포트 보내기
2024-09-19 17:17:11 - INFO - Message sent to Discord successfully.
2024-09-19 17:17:11 - INFO - Trading cycle completed.
2024-09-19 17:17:11 - INFO - Performing periodic update.
2024-09-19 17:17:11 - INFO - 계산된 시장 변동성: 0.037681285986665994
2024-09-19 17:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:25:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/cd883677-339c-4adf-92ce-ef3d58417319 "HTTP/1.1 200 OK"
2024-09-19 17:25:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:25:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-9d34-d9c7a3f7d980 "HTTP/1.1 200 OK"
2024-09-19 17:26:02 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-bb03-dd6d34d7f13a "HTTP/1.1 200 OK"
2024-09-19 17:26:16 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8188-a6a4-d2428a103a3b "HTTP/1.1 200 OK"
2024-09-19 17:26:24 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/39027978-72e2-44e4-9c31-e36a07ecbd9a "HTTP/1.1 200 OK"
2024-09-19 17:26:30 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8176-82f4-ea0a84721f5c "HTTP/1.1 200 OK"
2024-09-19 17:26:37 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-bbec-cf5977251da8 "HTTP/1.1 200 OK"
2024-09-19 17:26:44 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8155-8233-d4533f3653ab "HTTP/1.1 200 OK"
2024-09-19 17:26:52 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:26:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-9957-c3428ac5511e "HTTP/1.1 200 OK"
2024-09-19 17:26:59 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:15:34.931211
2024-09-19 17:26:59 - INFO - Starting trading cycle.
2024-09-19 17:26:59 - INFO - ##################################################
2024-09-19 17:26:59 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-19 17:26:59 - INFO - ##################################################
2024-09-19 17:26:59 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:26:59 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:26:59 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:10:00
2024-09-19 17:26:59 - INFO - 새로운 데이터 범위: 2024-09-18 08:10:00 ~ 2024-09-19 17:20:00
2024-09-19 17:26:59 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:26:59 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:26:59 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:26:59 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:26:59 - INFO - Sample date values: [Timestamp('2024-09-19 17:20:00')]
2024-09-19 17:26:59 - INFO - Successfully added 1 new data points
2024-09-19 17:26:59 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:26:59 - INFO - Final date range: 2024-09-19 17:20:00 to 2024-09-19 17:20:00
2024-09-19 17:26:59 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:26:59 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:20:00
2024-09-19 17:26:59 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:26:59 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:26:59 - INFO - GPT | 이전예측가격: 82939000 | 당시BTC가격: 82939000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:26:59 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 4/4
2024-09-19 17:26:59 - INFO - ML | 이전예측가격: 82976756 | 당시BTC가격: 82939000 | 예측: 상승 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2162 | 반영가중치값: 0.0200 | 새 가중치: 0.2362 | 예측 총 횟수: 4 | 예측 성공 수: 4 | 예측 성공률: 100.00%
2024-09-19 17:26:59 - INFO - XGBOOST 모델 예측 업데이트: 정확도 62.61%, 적중/전체: 72/115
2024-09-19 17:26:59 - INFO - XGBOOST | 이전예측가격: 82927000 | 당시BTC가격: 82939000 | 예측: 하락 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0674 | 반영가중치값: -0.0200 | 새 가중치: 0.0474 | 예측 총 횟수: 115 | 예측 성공 수: 72 | 예측 성공률: 62.61%
2024-09-19 17:26:59 - INFO - LSTM 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 14/23
2024-09-19 17:26:59 - INFO - LSTM | 이전예측가격: 82873029 | 당시BTC가격: 82939000 | 예측: 하락 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2212 | 반영가중치값: -0.0200 | 새 가중치: 0.2012 | 예측 총 횟수: 23 | 예측 성공 수: 14 | 예측 성공률: 60.87%
2024-09-19 17:26:59 - INFO - RL 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-19 17:26:59 - INFO - RL | 이전예측가격: 83768390 | 당시BTC가격: 82939000 | 예측: 상승 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2162 | 반영가중치값: 0.0200 | 새 가중치: 0.2362 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-19 17:26:59 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.61%, 적중/전체: 109/196
2024-09-19 17:26:59 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82939000 | 예측: 하락 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0105 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 196 | 예측 성공 수: 109 | 예측 성공률: 55.61%
2024-09-19 17:26:59 - INFO - PROPHET | 이전예측가격: 82945555 | 당시BTC가격: 82939000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:26:59 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.52%, 적중/전체: 25/42
2024-09-19 17:26:59 - INFO - TRANSFORMER | 이전예측가격: 82872142 | 당시BTC가격: 82939000 | 예측: 하락 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2520 | 반영가중치값: -0.0200 | 새 가중치: 0.2320 | 예측 총 횟수: 42 | 예측 성공 수: 25 | 예측 성공률: 59.52%
2024-09-19 17:26:59 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 24/44
2024-09-19 17:27:00 - INFO - BITCOIN_FORECAST | 이전예측가격: 82168599 | 당시BTC가격: 82939000 | 예측: 하락 | 지금 BTC가격: 82957000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0123 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 44 | 예측 성공 수: 24 | 예측 성공률: 54.55%
2024-09-19 17:27:00 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:27:00 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:27:00 - INFO - 새로운 가중치: {'gpt': 0.004200889968428538, 'ml': 0.24174834052271815, 'xgboost': 0.048529535134296635, 'rl': 0.24174834052271815, 'lstm': 0.2059418783049375, 'arima': 0.0, 'prophet': 0.020395742325206374, 'transformer': 0.23743527322169475, 'bitcoin_forecast': 0.0}
2024-09-19 17:27:00 - INFO - XGBoost 모델 성능: 정확도 62.61%, 적중/전체: 72/115
2024-09-19 17:27:00 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:27:00 - INFO - Current BTC price: 82957000.0
2024-09-19 17:27:00 - INFO - Analyzing market conditions.
2024-09-19 17:27:00 - INFO - Market analysis: {'current_price': 82946000.0, 'sma_20': 82818100.0, 'rsi_14': 54.218147549109574, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:27:00 - INFO - Starting predictions for all models
2024-09-19 17:27:00 - INFO - Attempting prediction for gpt
2024-09-19 17:27:00 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:27:00 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:27:00 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:27:00 - INFO - GPT prediction: 82957000.0
2024-09-19 17:27:00 - INFO - Attempting prediction for ml
2024-09-19 17:27:00 - INFO - ML prediction: 82995767.6
2024-09-19 17:27:00 - INFO - Attempting prediction for xgboost
2024-09-19 17:27:00 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:27:00 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:27:00 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:27:00 - INFO - XGBOOST prediction: 82946000.0
2024-09-19 17:27:00 - INFO - Attempting prediction for lstm
2024-09-19 17:27:00 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:27:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:27:00 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:27:00 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:27:00 - INFO - X 샘플:
[[ 0.21676465 -1.00361309 -1.32771306 -1.9122765   0.63902905  0.63528331
  -1.9122765 ]
 [-1.63694687 -1.64961692 -1.35418789 -0.13459582  1.37537542  1.37057447
  -0.13459582]
 [-1.56220044  0.44989552 -1.34095048 -1.34087914  0.1997058   0.19900204
  -1.34087914]
 [-0.5008011  -0.795969    0.24753972  0.30982435 -1.80271888 -1.80629796
   0.30982435]
 [ 0.23171394 -0.98054153 -0.46728087 -0.7821795   1.49596332  1.49854469
  -0.7821795 ]
 [ 0.0523225   0.31146613  0.45933842  0.9447103   0.01903681  0.0205438
   0.9447103 ]
 [ 1.42765686  1.07282779  0.64466227 -0.00761863 -1.06801816 -1.06812593
  -0.00761863]
 [-0.00747464  0.05767891  0.68437453  0.79233767 -0.16489971 -0.16274368
   0.79233767]
 [ 0.21676465  1.23432875  0.89617322  0.9447103   0.27121557  0.27562334
   0.9447103 ]
 [ 1.56220044  1.30354344  1.55804414  1.18596697 -0.96468923 -0.96240409
   1.18596697]]
2024-09-19 17:27:00 - INFO - y 샘플:
[1.18596697]
2024-09-19 17:27:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:27:00 - INFO - 모델 출력 (스케일링된 예측): [[0.39960372]]
2024-09-19 17:27:00 - INFO - 스케일러 역변환 후 예측 가격: 82884070.51218614
2024-09-19 17:27:00 - INFO - LSTMPredictor 최종 예측 가격: 82884070.51218614
2024-09-19 17:27:00 - INFO - LSTM prediction: 82884070.51218614
2024-09-19 17:27:00 - INFO - Attempting prediction for rl
2024-09-19 17:27:00 - INFO - Preparing state for RL agent.
2024-09-19 17:27:00 - INFO - Prepared state: [[8.29460000e+07 7.18870776e+00 2.29117175e-04 8.28181000e+07
  5.42181475e+01]]
2024-09-19 17:27:00 - INFO - RL prediction: 83786570.0
2024-09-19 17:27:00 - INFO - Attempting prediction for arima
2024-09-19 17:27:00 - INFO - ARIMA 예측 시작
2024-09-19 17:27:00 - INFO - 입력 데이터: {'open': 82960000.0, 'high': 82970000.0, 'low': 82919000.0, 'close': 82946000.0, 'volume': 7.18870776, 'value': 596361052.28105, 'decision': 'sell', 'sma': 82818100.0, 'ema': 82860269.5404844, 'rsi': 54.218147549109574, 'macd': 22316.309107407928, 'signal_line': 9522.060154088409, 'BB_Upper': 83052770.74807401, 'BB_Lower': 82583429.25192599}
2024-09-19 17:27:00 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:27:00 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82818100.0         0         0
2024-09-19 17:27:00 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82818100.0         0         0
2024-09-19 17:27:00 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:27:00 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:27:00 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:27:00 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:27:00 - INFO - Attempting prediction for prophet
2024-09-19 17:27:00 - INFO - PROPHET prediction: 82966840.24214187
2024-09-19 17:27:00 - INFO - Attempting prediction for transformer
2024-09-19 17:27:00 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:27:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:27:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:27:00 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:27:00 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:27:00 - INFO - X 샘플:
[[ 0.21676465 -1.00361309 -1.32771306 -1.9122765   0.63902905  0.63528331
  -1.9122765  -1.9122765   0.          0.          0.         -1.9122765
  -1.9122765 ]
 [-1.63694687 -1.64961692 -1.35418789 -0.13459582  1.37537542  1.37057447
  -0.13459582 -0.13459582  0.          0.          0.         -0.13459582
  -0.13459582]
 [-1.56220044  0.44989552 -1.34095048 -1.34087914  0.1997058   0.19900204
  -1.34087914 -1.34087914  0.          0.          0.         -1.34087914
  -1.34087914]
 [-0.5008011  -0.795969    0.24753972  0.30982435 -1.80271888 -1.80629796
   0.30982435  0.30982435  0.          0.          0.          0.30982435
   0.30982435]
 [ 0.23171394 -0.98054153 -0.46728087 -0.7821795   1.49596332  1.49854469
  -0.7821795  -0.7821795   0.          0.          0.         -0.7821795
  -0.7821795 ]
 [ 0.0523225   0.31146613  0.45933842  0.9447103   0.01903681  0.0205438
   0.9447103   0.9447103   0.          0.          0.          0.9447103
   0.9447103 ]
 [ 1.42765686  1.07282779  0.64466227 -0.00761863 -1.06801816 -1.06812593
  -0.00761863 -0.00761863  0.          0.          0.         -0.00761863
  -0.00761863]
 [-0.00747464  0.05767891  0.68437453  0.79233767 -0.16489971 -0.16274368
   0.79233767  0.79233767  0.          0.          0.          0.79233767
   0.79233767]
 [ 0.21676465  1.23432875  0.89617322  0.9447103   0.27121557  0.27562334
   0.9447103   0.9447103   0.          0.          0.          0.9447103
   0.9447103 ]
 [ 1.56220044  1.30354344  1.55804414  1.18596697 -0.96468923 -0.96240409
   1.18596697  1.18596697  0.          0.          0.          1.18596697
   1.18596697]]
2024-09-19 17:27:00 - INFO - y 샘플:
[1.18596697]
2024-09-19 17:27:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:27:00 - INFO - 모델 출력 (스케일링된 예측): [0.36357528]
2024-09-19 17:27:00 - INFO - 스케일러 역변환 후 예측 가격: 82881233.11718547
2024-09-19 17:27:00 - INFO - TransformerPredictor 최종 예측 가격: 82881233.11718547
2024-09-19 17:27:00 - INFO - TRANSFORMER prediction: 82881233.11718547
2024-09-19 17:27:00 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:27:00 - INFO - BITCOIN_FORECAST prediction: 82149830.5346026
2024-09-19 17:27:00 - INFO - BitcoinForecast prediction: 82149830.5346026
2024-09-19 17:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:27:22 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:27:22 - INFO - 조정된 모델 가중치: {'gpt': 0.004200889968428538, 'ml': 0.24174834052271815, 'xgboost': 0.048529535134296635, 'rl': 0.24174834052271815, 'lstm': 0.2059418783049375, 'arima': 0.0, 'prophet': 0.020395742325206374, 'transformer': 0.23743527322169475, 'bitcoin_forecast': 0.0}
2024-09-19 17:27:22 - INFO - 조정된 모델 가중치: {'gpt': 0.004200889968428538, 'ml': 0.24174834052271815, 'xgboost': 0.048529535134296635, 'rl': 0.24174834052271815, 'lstm': 0.2059418783049375, 'arima': 0.0, 'prophet': 0.020395742325206374, 'transformer': 0.23743527322169475, 'bitcoin_forecast': 0.0}
2024-09-19 17:27:22 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83133577.08174372, 'current_price': 82957000.0, 'predictions': {'gpt': 82957000.0, 'ml': 82995767.6, 'xgboost': 82946000.0, 'lstm': 82884070.51218614, 'rl': 83786570.0, 'arima': 80899000.0, 'prophet': 82966840.24214187, 'transformer': 82881233.11718547, 'bitcoin_forecast': 82149830.5346026}, 'weights': {'gpt': 0.004200889968428538, 'ml': 0.24174834052271815, 'xgboost': 0.048529535134296635, 'rl': 0.24174834052271815, 'lstm': 0.2059418783049375, 'arima': 0.0, 'prophet': 0.020395742325206374, 'transformer': 0.23743527322169475, 'bitcoin_forecast': 0.0}}
2024-09-19 17:27:22 - INFO - 모델별 가중치:
2024-09-19 17:27:22 - INFO -   - GPT: 0.0042
2024-09-19 17:27:22 - INFO -   - ML: 0.2417
2024-09-19 17:27:22 - INFO -   - XGBOOST: 0.0485
2024-09-19 17:27:22 - INFO -   - RL: 0.2417
2024-09-19 17:27:22 - INFO -   - LSTM: 0.2059
2024-09-19 17:27:22 - INFO -   - ARIMA: 0.0000
2024-09-19 17:27:22 - INFO -   - PROPHET: 0.0204
2024-09-19 17:27:22 - INFO -   - TRANSFORMER: 0.2374
2024-09-19 17:27:22 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 17:27:22 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:27:22 - INFO - 6. 거래 실행
2024-09-19 17:27:22 - INFO - Cancelling existing orders.
2024-09-19 17:27:22 - INFO - Cancelled 0 orders.
2024-09-19 17:27:22 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83133577.08174372, 'current_price': 82957000.0, 'predictions': {'gpt': 82957000.0, 'ml': 82995767.6, 'xgboost': 82946000.0, 'lstm': 82884070.51218614, 'rl': 83786570.0, 'arima': 80899000.0, 'prophet': 82966840.24214187, 'transformer': 82881233.11718547, 'bitcoin_forecast': 82149830.5346026}, 'weights': {'gpt': 0.004200889968428538, 'ml': 0.24174834052271815, 'xgboost': 0.048529535134296635, 'rl': 0.24174834052271815, 'lstm': 0.2059418783049375, 'arima': 0.0, 'prophet': 0.020395742325206374, 'transformer': 0.23743527322169475, 'bitcoin_forecast': 0.0}}, 현재 가격=82957000.0
2024-09-19 17:27:23 - INFO - 현재 잔고: KRW=359323.71156547, BTC=0.00140759, 총 자산가치=476093.15519546997
2024-09-19 17:27:23 - INFO - 매수 시도: 0.0005739035345968032 BTC (약 47609.315519547 KRW)
2024-09-19 17:27:23 - INFO - 주문 결과: {'uuid': 'd0a70bc0-2061-4565-937d-eda91d6242f2', 'side': 'bid', 'ord_type': 'limit', 'price': '82957000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:27:24+09:00', 'volume': '0.0005739', 'remaining_volume': '0.0005739', 'reserved_fee': '23.80451115', 'remaining_fee': '23.80451115', 'paid_fee': '0', 'locked': '47632.82681115', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:27:23 - INFO - buy 주문 성공: UUID=d0a70bc0-2061-4565-937d-eda91d6242f2
2024-09-19 17:27:23 - INFO - Trade executed successfully.
2024-09-19 17:27:23 - INFO - 7. summary 리포트 보내기
2024-09-19 17:27:24 - INFO - Message sent to Discord successfully.
2024-09-19 17:27:24 - INFO - Trading cycle completed.
2024-09-19 17:27:24 - INFO - Performing periodic update.
2024-09-19 17:27:24 - INFO - 계산된 시장 변동성: 0.03759812144725752
2024-09-19 17:35:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:35:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a5-a6a7-d20811ed9541 "HTTP/1.1 200 OK"
2024-09-19 17:35:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:35:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8153-b0f5-e18b055913b4 "HTTP/1.1 200 OK"
2024-09-19 17:35:54 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8139-9a5f-c4bdcd23ff7f "HTTP/1.1 200 OK"
2024-09-19 17:36:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8154-9f02-e3cd18815abb "HTTP/1.1 200 OK"
2024-09-19 17:36:06 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-9669-d113bc0513ba "HTTP/1.1 200 OK"
2024-09-19 17:36:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811a-a129-c22f7ac2037a "HTTP/1.1 200 OK"
2024-09-19 17:36:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814d-abf9-c7dfa04628ab "HTTP/1.1 200 OK"
2024-09-19 17:36:27 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-b55f-d6c3eaf6d2db "HTTP/1.1 200 OK"
2024-09-19 17:36:33 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814f-886c-d0be10ec48b3 "HTTP/1.1 200 OK"
2024-09-19 17:36:40 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:25:34.931349
2024-09-19 17:36:40 - INFO - Starting trading cycle.
2024-09-19 17:36:40 - INFO - ##################################################
2024-09-19 17:36:40 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-19 17:36:40 - INFO - ##################################################
2024-09-19 17:36:40 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:36:40 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:36:40 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:20:00
2024-09-19 17:36:40 - INFO - 새로운 데이터 범위: 2024-09-18 08:20:00 ~ 2024-09-19 17:30:00
2024-09-19 17:36:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:36:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:36:40 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:36:40 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:36:40 - INFO - Sample date values: [Timestamp('2024-09-19 17:30:00')]
2024-09-19 17:36:40 - INFO - Successfully added 1 new data points
2024-09-19 17:36:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:36:40 - INFO - Final date range: 2024-09-19 17:30:00 to 2024-09-19 17:30:00
2024-09-19 17:36:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:36:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:30:00
2024-09-19 17:36:40 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:36:40 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:36:40 - INFO - GPT | 이전예측가격: 82957000 | 당시BTC가격: 82957000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:36:40 - INFO - ML 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 4/5
2024-09-19 17:36:40 - INFO - ML | 이전예측가격: 82995768 | 당시BTC가격: 82957000 | 예측: 상승 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2204 | 반영가중치값: -0.0200 | 새 가중치: 0.2004 | 예측 총 횟수: 5 | 예측 성공 수: 4 | 예측 성공률: 80.00%
2024-09-19 17:36:40 - INFO - XGBOOST 모델 예측 업데이트: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 17:36:41 - INFO - XGBOOST | 이전예측가격: 82946000 | 당시BTC가격: 82957000 | 예측: 하락 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0672 | 반영가중치값: 0.0200 | 새 가중치: 0.0872 | 예측 총 횟수: 116 | 예측 성공 수: 73 | 예측 성공률: 62.93%
2024-09-19 17:36:41 - INFO - LSTM 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-19 17:36:41 - INFO - LSTM | 이전예측가격: 82884071 | 당시BTC가격: 82957000 | 예측: 하락 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1279 | 반영가중치값: 0.0200 | 새 가중치: 0.1479 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-19 17:36:41 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-19 17:36:41 - INFO - RL | 이전예측가격: 83786570 | 당시BTC가격: 82957000 | 예측: 상승 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0487 | 반영가중치값: -0.0200 | 새 가중치: 0.0287 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-19 17:36:41 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.84%, 적중/전체: 110/197
2024-09-19 17:36:41 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82957000 | 예측: 하락 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1930 | 반영가중치값: 0.0200 | 새 가중치: 0.2130 | 예측 총 횟수: 197 | 예측 성공 수: 110 | 예측 성공률: 55.84%
2024-09-19 17:36:41 - INFO - PROPHET 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-19 17:36:41 - INFO - PROPHET | 이전예측가격: 82966840 | 당시BTC가격: 82957000 | 예측: 상승 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0199 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-19 17:36:41 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.47%, 적중/전체: 26/43
2024-09-19 17:36:41 - INFO - TRANSFORMER | 이전예측가격: 82881233 | 당시BTC가격: 82957000 | 예측: 하락 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1485 | 반영가중치값: 0.0200 | 새 가중치: 0.1685 | 예측 총 횟수: 43 | 예측 성공 수: 26 | 예측 성공률: 60.47%
2024-09-19 17:36:41 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 25/45
2024-09-19 17:36:41 - INFO - BITCOIN_FORECAST | 이전예측가격: 82149831 | 당시BTC가격: 82957000 | 예측: 하락 | 지금 BTC가격: 82856000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1704 | 반영가중치값: 0.0200 | 새 가중치: 0.1904 | 예측 총 횟수: 45 | 예측 성공 수: 25 | 예측 성공률: 55.56%
2024-09-19 17:36:41 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:36:41 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:36:41 - INFO - 새로운 가중치: {'gpt': 0.004038668214807512, 'ml': 0.19262076436518286, 'xgboost': 0.08381307289533142, 'rl': 0.02755939276775585, 'lstm': 0.14219454888194358, 'arima': 0.20480244632462635, 'prophet': 0.0, 'transformer': 0.1619641418331183, 'bitcoin_forecast': 0.18300696471723416}
2024-09-19 17:36:41 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 17:36:41 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:36:41 - INFO - Current BTC price: 82856000.0
2024-09-19 17:36:41 - INFO - Analyzing market conditions.
2024-09-19 17:36:41 - INFO - Market analysis: {'current_price': 82856000.0, 'sma_20': 82812900.0, 'rsi_14': 50.47510545381026, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:36:41 - INFO - Starting predictions for all models
2024-09-19 17:36:41 - INFO - Attempting prediction for gpt
2024-09-19 17:36:41 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:36:41 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:36:41 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:36:41 - INFO - GPT prediction: 82856000.0
2024-09-19 17:36:41 - INFO - Attempting prediction for ml
2024-09-19 17:36:41 - INFO - ML prediction: 82872571.2
2024-09-19 17:36:41 - INFO - Attempting prediction for xgboost
2024-09-19 17:36:41 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:36:41 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:36:41 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:36:41 - INFO - XGBOOST prediction: 82856000.0
2024-09-19 17:36:41 - INFO - Attempting prediction for lstm
2024-09-19 17:36:41 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:36:41 - INFO - X 샘플:
[[-1.64178531 -1.88913144 -1.70740988 -0.42754138  1.51740946  1.51179738
  -0.42754138]
 [-1.57040334  0.33194041 -1.69290342 -1.98971179  0.34267763  0.34151699
  -1.98971179]
 [-0.55677936 -0.98605827  0.04787131  0.14799509 -1.65814979 -1.66157151
   0.14799509]
 [ 0.14276394 -1.18131734 -0.73547732 -1.26618023  1.63790117  1.63962647
  -1.26618023]
 [-0.02855279  0.18549611  0.2799746   0.97019005  0.16215276  0.16325556
   0.97019005]
 [ 1.28487546  0.99093975  0.48306499 -0.26310239 -0.92403511 -0.92421355
  -0.26310239]
 [-0.08565836 -0.0829851   0.52658436  0.77286326 -0.02163705 -0.01982978
   0.77286326]
 [ 0.12848755  1.16179143  0.75868765  0.97019005  0.41413036  0.41805379
   0.97019005]
 [ 1.413363    1.23501358  1.48401046  1.28262413 -0.82078861 -0.81860831
   1.28262413]
 [ 0.91368921  0.23431088  0.55559727 -0.19732679 -0.64966082 -0.65002704
  -0.19732679]]
2024-09-19 17:36:41 - INFO - y 샘플:
[-0.19732679]
2024-09-19 17:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:36:41 - INFO - 모델 출력 (스케일링된 예측): [[0.39820397]]
2024-09-19 17:36:41 - INFO - 스케일러 역변환 후 예측 가격: 82892215.90931423
2024-09-19 17:36:41 - INFO - LSTMPredictor 최종 예측 가격: 82892215.90931423
2024-09-19 17:36:41 - INFO - LSTM prediction: 82892215.90931423
2024-09-19 17:36:41 - INFO - Attempting prediction for rl
2024-09-19 17:36:41 - INFO - Preparing state for RL agent.
2024-09-19 17:36:41 - INFO - Prepared state: [[ 8.28560000e+07  7.54649415e+00 -1.08504328e-03  8.28129000e+07
   5.04751055e+01]]
2024-09-19 17:36:41 - INFO - RL prediction: 83684560.0
2024-09-19 17:36:41 - INFO - Attempting prediction for arima
2024-09-19 17:36:41 - INFO - ARIMA 예측 시작
2024-09-19 17:36:41 - INFO - 입력 데이터: {'open': 82925000.0, 'high': 82929000.0, 'low': 82855000.0, 'close': 82856000.0, 'volume': 7.54649415, 'value': 625506415.79876, 'decision': 'sell', 'sma': 82812900.0, 'ema': 82859862.91758111, 'rsi': 50.47510545381026, 'macd': 19589.204512640834, 'signal_line': 11535.489025798895, 'BB_Upper': 83039223.5736763, 'BB_Lower': 82586576.4263237}
2024-09-19 17:36:41 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:36:41 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82812900.0         0         0
2024-09-19 17:36:41 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82812900.0         0         0
2024-09-19 17:36:41 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:36:41 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:36:41 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:36:41 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:36:41 - INFO - Attempting prediction for prophet
2024-09-19 17:36:41 - INFO - PROPHET prediction: 82856881.86870427
2024-09-19 17:36:41 - INFO - Attempting prediction for transformer
2024-09-19 17:36:41 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:36:41 - INFO - X 샘플:
[[-1.64178531 -1.88913144 -1.70740988 -0.42754138  1.51740946  1.51179738
  -0.42754138 -0.42754138  0.          0.          0.         -0.42754138
  -0.42754138]
 [-1.57040334  0.33194041 -1.69290342 -1.98971179  0.34267763  0.34151699
  -1.98971179 -1.98971179  0.          0.          0.         -1.98971179
  -1.98971179]
 [-0.55677936 -0.98605827  0.04787131  0.14799509 -1.65814979 -1.66157151
   0.14799509  0.14799509  0.          0.          0.          0.14799509
   0.14799509]
 [ 0.14276394 -1.18131734 -0.73547732 -1.26618023  1.63790117  1.63962647
  -1.26618023 -1.26618023  0.          0.          0.         -1.26618023
  -1.26618023]
 [-0.02855279  0.18549611  0.2799746   0.97019005  0.16215276  0.16325556
   0.97019005  0.97019005  0.          0.          0.          0.97019005
   0.97019005]
 [ 1.28487546  0.99093975  0.48306499 -0.26310239 -0.92403511 -0.92421355
  -0.26310239 -0.26310239  0.          0.          0.         -0.26310239
  -0.26310239]
 [-0.08565836 -0.0829851   0.52658436  0.77286326 -0.02163705 -0.01982978
   0.77286326  0.77286326  0.          0.          0.          0.77286326
   0.77286326]
 [ 0.12848755  1.16179143  0.75868765  0.97019005  0.41413036  0.41805379
   0.97019005  0.97019005  0.          0.          0.          0.97019005
   0.97019005]
 [ 1.413363    1.23501358  1.48401046  1.28262413 -0.82078861 -0.81860831
   1.28262413  1.28262413  0.          0.          0.          1.28262413
   1.28262413]
 [ 0.91368921  0.23431088  0.55559727 -0.19732679 -0.64966082 -0.65002704
  -0.19732679 -0.19732679  0.          0.          0.         -0.19732679
  -0.19732679]]
2024-09-19 17:36:41 - INFO - y 샘플:
[-0.19732679]
2024-09-19 17:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:36:41 - INFO - 모델 출력 (스케일링된 예측): [0.36073622]
2024-09-19 17:36:41 - INFO - 스케일러 역변환 후 예측 가격: 82889937.38961922
2024-09-19 17:36:41 - INFO - TransformerPredictor 최종 예측 가격: 82889937.38961922
2024-09-19 17:36:41 - INFO - TRANSFORMER prediction: 82889937.38961922
2024-09-19 17:36:41 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:36:41 - INFO - BITCOIN_FORECAST prediction: 82153487.12211303
2024-09-19 17:36:41 - INFO - BitcoinForecast prediction: 82153487.12211303
2024-09-19 17:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:36:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:36:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004038668214807512, 'ml': 0.19262076436518286, 'xgboost': 0.08381307289533142, 'rl': 0.02755939276775585, 'lstm': 0.14219454888194358, 'arima': 0.20480244632462635, 'prophet': 0.0, 'transformer': 0.1619641418331183, 'bitcoin_forecast': 0.18300696471723416}
2024-09-19 17:36:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004038668214807512, 'ml': 0.19262076436518286, 'xgboost': 0.08381307289533142, 'rl': 0.02755939276775585, 'lstm': 0.14219454888194358, 'arima': 0.20480244632462635, 'prophet': 0.0, 'transformer': 0.1619641418331183, 'bitcoin_forecast': 0.18300696471723416}
2024-09-19 17:36:51 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82363309.77584097, 'current_price': 82856000.0, 'predictions': {'gpt': 82856000.0, 'ml': 82872571.2, 'xgboost': 82856000.0, 'lstm': 82892215.90931423, 'rl': 83684560.0, 'arima': 80899000.0, 'prophet': 82856881.86870427, 'transformer': 82889937.38961922, 'bitcoin_forecast': 82153487.12211303}, 'weights': {'gpt': 0.004038668214807512, 'ml': 0.19262076436518286, 'xgboost': 0.08381307289533142, 'rl': 0.02755939276775585, 'lstm': 0.14219454888194358, 'arima': 0.20480244632462635, 'prophet': 0.0, 'transformer': 0.1619641418331183, 'bitcoin_forecast': 0.18300696471723416}}
2024-09-19 17:36:51 - INFO - 모델별 가중치:
2024-09-19 17:36:51 - INFO -   - GPT: 0.0040
2024-09-19 17:36:51 - INFO -   - ML: 0.1926
2024-09-19 17:36:51 - INFO -   - XGBOOST: 0.0838
2024-09-19 17:36:51 - INFO -   - RL: 0.0276
2024-09-19 17:36:51 - INFO -   - LSTM: 0.1422
2024-09-19 17:36:51 - INFO -   - ARIMA: 0.2048
2024-09-19 17:36:51 - INFO -   - PROPHET: 0.0000
2024-09-19 17:36:51 - INFO -   - TRANSFORMER: 0.1620
2024-09-19 17:36:51 - INFO -   - BITCOIN_FORECAST: 0.1830
2024-09-19 17:36:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:36:51 - INFO - 6. 거래 실행
2024-09-19 17:36:51 - INFO - Cancelling existing orders.
2024-09-19 17:36:51 - INFO - Cancelled 0 orders.
2024-09-19 17:36:51 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82363309.77584097, 'current_price': 82856000.0, 'predictions': {'gpt': 82856000.0, 'ml': 82872571.2, 'xgboost': 82856000.0, 'lstm': 82892215.90931423, 'rl': 83684560.0, 'arima': 80899000.0, 'prophet': 82856881.86870427, 'transformer': 82889937.38961922, 'bitcoin_forecast': 82153487.12211303}, 'weights': {'gpt': 0.004038668214807512, 'ml': 0.19262076436518286, 'xgboost': 0.08381307289533142, 'rl': 0.02755939276775585, 'lstm': 0.14219454888194358, 'arima': 0.20480244632462635, 'prophet': 0.0, 'transformer': 0.1619641418331183, 'bitcoin_forecast': 0.18300696471723416}}, 현재 가격=82856000.0
2024-09-19 17:36:52 - INFO - 현재 잔고: KRW=311691.45894127, BTC=0.00198149, 총 자산가치=475869.79438127
2024-09-19 17:36:52 - INFO - 매도 시도: 0.000396298 BTC (약 32835.667088 KRW)
2024-09-19 17:36:52 - INFO - 주문 결과: {'uuid': '928d6d33-c82f-4da7-a836-02d30d5a5b8a', 'side': 'ask', 'ord_type': 'limit', 'price': '82856000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:36:53+09:00', 'volume': '0.00039629', 'remaining_volume': '0.00039629', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00039629', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:36:52 - INFO - sell 주문 성공: UUID=928d6d33-c82f-4da7-a836-02d30d5a5b8a
2024-09-19 17:36:52 - INFO - Trade executed successfully.
2024-09-19 17:36:52 - INFO - 7. summary 리포트 보내기
2024-09-19 17:36:52 - INFO - Message sent to Discord successfully.
2024-09-19 17:36:52 - INFO - Trading cycle completed.
2024-09-19 17:36:52 - INFO - Performing periodic update.
2024-09-19 17:36:52 - INFO - 계산된 시장 변동성: 0.037583221926373374
2024-09-19 17:45:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-a6e6-c85494fc0fce "HTTP/1.1 200 OK"
2024-09-19 17:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:45:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:45:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812a-96a1-c6f36cf1350c "HTTP/1.1 200 OK"
2024-09-19 17:45:53 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-b4ea-f264d75d9333 "HTTP/1.1 200 OK"
2024-09-19 17:46:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815e-8456-eabb9e88fa70 "HTTP/1.1 200 OK"
2024-09-19 17:46:08 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812f-b28d-ef12e37de989 "HTTP/1.1 200 OK"
2024-09-19 17:46:21 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8141-82ea-f0fc40c7908f "HTTP/1.1 200 OK"
2024-09-19 17:46:28 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-bda2-f46857f25174 "HTTP/1.1 200 OK"
2024-09-19 17:46:37 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81aa-b002-ea42ff37da64 "HTTP/1.1 200 OK"
2024-09-19 17:46:46 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:46:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-a109-f6a9f87d544f "HTTP/1.1 200 OK"
2024-09-19 17:46:52 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:35:34.931460
2024-09-19 17:46:52 - INFO - Starting trading cycle.
2024-09-19 17:46:52 - INFO - ##################################################
2024-09-19 17:46:52 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-19 17:46:52 - INFO - ##################################################
2024-09-19 17:46:52 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:46:52 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:46:52 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:30:00
2024-09-19 17:46:52 - INFO - 새로운 데이터 범위: 2024-09-18 08:30:00 ~ 2024-09-19 17:40:00
2024-09-19 17:46:52 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:46:52 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:46:52 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:46:52 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:46:52 - INFO - Sample date values: [Timestamp('2024-09-19 17:40:00')]
2024-09-19 17:46:52 - INFO - Successfully added 1 new data points
2024-09-19 17:46:52 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:46:52 - INFO - Final date range: 2024-09-19 17:40:00 to 2024-09-19 17:40:00
2024-09-19 17:46:52 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:46:52 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:40:00
2024-09-19 17:46:52 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:46:52 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:46:52 - INFO - GPT | 이전예측가격: 82856000 | 당시BTC가격: 82856000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:46:52 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-19 17:46:52 - INFO - ML | 이전예측가격: 82872571 | 당시BTC가격: 82856000 | 예측: 상승 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2417 | 반영가중치값: -0.0200 | 새 가중치: 0.2217 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-19 17:46:52 - INFO - XGBOOST | 이전예측가격: 82856000 | 당시BTC가격: 82856000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:46:52 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 15/25
2024-09-19 17:46:52 - INFO - LSTM | 이전예측가격: 82892216 | 당시BTC가격: 82856000 | 예측: 상승 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2059 | 반영가중치값: -0.0200 | 새 가중치: 0.1859 | 예측 총 횟수: 25 | 예측 성공 수: 15 | 예측 성공률: 60.00%
2024-09-19 17:46:52 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-19 17:46:52 - INFO - RL | 이전예측가격: 83684560 | 당시BTC가격: 82856000 | 예측: 상승 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2417 | 반영가중치값: -0.0200 | 새 가중치: 0.2217 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-19 17:46:52 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.06%, 적중/전체: 111/198
2024-09-19 17:46:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82856000 | 예측: 하락 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 198 | 예측 성공 수: 111 | 예측 성공률: 56.06%
2024-09-19 17:46:53 - INFO - PROPHET | 이전예측가격: 82856882 | 당시BTC가격: 82856000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:46:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 26/44
2024-09-19 17:46:53 - INFO - TRANSFORMER | 이전예측가격: 82889937 | 당시BTC가격: 82856000 | 예측: 상승 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2374 | 반영가중치값: -0.0200 | 새 가중치: 0.2174 | 예측 총 횟수: 44 | 예측 성공 수: 26 | 예측 성공률: 59.09%
2024-09-19 17:46:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.52%, 적중/전체: 26/46
2024-09-19 17:46:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82153487 | 당시BTC가격: 82856000 | 예측: 하락 | 지금 BTC가격: 82772000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 46 | 예측 성공 수: 26 | 예측 성공률: 56.52%
2024-09-19 17:46:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:46:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:46:53 - INFO - 새로운 가중치: {'gpt': 0.004143390020588759, 'ml': 0.22749822771656897, 'xgboost': 0.08598632800687882, 'rl': 0.22749822771656897, 'lstm': 0.19076331156728288, 'arima': 0.020518595736076027, 'prophet': 0.0, 'transformer': 0.2230733234999596, 'bitcoin_forecast': 0.020518595736076027}
2024-09-19 17:46:53 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 17:46:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:46:53 - INFO - Current BTC price: 82772000.0
2024-09-19 17:46:53 - INFO - Analyzing market conditions.
2024-09-19 17:46:53 - INFO - Market analysis: {'current_price': 82773000.0, 'sma_20': 82804850.0, 'rsi_14': 47.236360628429125, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:46:53 - INFO - Starting predictions for all models
2024-09-19 17:46:53 - INFO - Attempting prediction for gpt
2024-09-19 17:46:53 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:46:53 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:46:53 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:46:53 - INFO - GPT prediction: 82772000.0
2024-09-19 17:46:53 - INFO - Attempting prediction for ml
2024-09-19 17:46:53 - INFO - ML prediction: 82872327.60000001
2024-09-19 17:46:53 - INFO - Attempting prediction for xgboost
2024-09-19 17:46:53 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:46:53 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:46:53 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:46:53 - INFO - XGBOOST prediction: 82773000.0
2024-09-19 17:46:53 - INFO - Attempting prediction for lstm
2024-09-19 17:46:53 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:46:53 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:46:53 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:46:53 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:46:53 - INFO - X 샘플:
[[-2.02336142e+00  2.97738788e-01 -1.99567091e+00 -1.70365126e+00
   4.91964525e-01  4.89685632e-01 -1.70365126e+00]
 [-8.25207452e-01 -1.19095515e+00 -3.43235783e-02  2.37406266e-01
  -1.75554179e+00 -1.75805989e+00  2.37406266e-01]
 [ 1.68754080e-03 -1.41150240e+00 -9.16929878e-01 -1.04667794e+00
   1.94687416e+00  1.94634606e+00 -1.04667794e+00]
 [-2.00817355e-01  1.32328350e-01  2.27189399e-01  9.83966852e-01
   2.89183022e-01  2.89651372e-01  9.83966852e-01]
 [ 1.35172018e+00  1.04208576e+00  4.56013255e-01 -1.35874027e-01
  -9.30919253e-01 -9.30641104e-01 -1.35874027e-01]
 [-2.68318987e-01 -1.70924119e-01  5.05046938e-01  8.04792312e-01
   8.27340625e-02  8.42039997e-02  8.04792312e-01]
 [-1.51878672e-02  1.23506460e+00  7.66559916e-01  9.83966852e-01
   5.72226550e-01  5.75570626e-01  9.83966852e-01]
 [ 1.50359885e+00  1.31776982e+00  1.58378797e+00  1.26765987e+00
  -8.14943650e-01 -8.12137251e-01  1.26765987e+00]
 [ 9.12959574e-01  1.87465163e-01  5.37736060e-01 -7.61491798e-02
  -6.22717786e-01 -6.22965487e-01 -7.61491798e-02]
 [-4.37073068e-01 -1.43907081e+00 -1.12940917e+00 -1.31543975e+00
   7.41140161e-01  7.38346038e-01 -1.31543975e+00]]
2024-09-19 17:46:53 - INFO - y 샘플:
[-1.31543975]
2024-09-19 17:46:53 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:46:53 - INFO - 모델 출력 (스케일링된 예측): [[0.3696599]]
2024-09-19 17:46:53 - INFO - 스케일러 역변환 후 예측 가격: 82885857.52856857
2024-09-19 17:46:53 - INFO - LSTMPredictor 최종 예측 가격: 82885857.52856857
2024-09-19 17:46:53 - INFO - LSTM prediction: 82885857.52856857
2024-09-19 17:46:53 - INFO - Attempting prediction for rl
2024-09-19 17:46:53 - INFO - Preparing state for RL agent.
2024-09-19 17:46:53 - INFO - Prepared state: [[ 8.27730000e+07  1.00850173e+01 -1.00173796e-03  8.28048500e+07
   4.72363606e+01]]
2024-09-19 17:46:53 - INFO - RL prediction: 83599720.0
2024-09-19 17:46:53 - INFO - Attempting prediction for arima
2024-09-19 17:46:53 - INFO - ARIMA 예측 시작
2024-09-19 17:46:53 - INFO - 입력 데이터: {'open': 82845000.0, 'high': 82870000.0, 'low': 82753000.0, 'close': 82773000.0, 'volume': 10.08501732, 'value': 835241306.18409, 'decision': 'sell', 'sma': 82804850.0, 'ema': 82851590.25876385, 'rsi': 47.236360628429125, 'macd': 10608.262684687972, 'signal_line': 11350.04375757671, 'BB_Upper': 83024732.94612874, 'BB_Lower': 82584967.05387126}
2024-09-19 17:46:53 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:46:53 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82804850.0         0         0
2024-09-19 17:46:53 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82804850.0         0         0
2024-09-19 17:46:53 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:46:53 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:46:53 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:46:53 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:46:53 - INFO - Attempting prediction for prophet
2024-09-19 17:46:53 - INFO - PROPHET prediction: 82757923.13858509
2024-09-19 17:46:53 - INFO - Attempting prediction for transformer
2024-09-19 17:46:53 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:46:53 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:46:53 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:46:53 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:46:53 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:46:53 - INFO - X 샘플:
[[-2.02336142e+00  2.97738788e-01 -1.99567091e+00 -1.70365126e+00
   4.91964525e-01  4.89685632e-01 -1.70365126e+00 -1.70365126e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.70365126e+00
  -1.70365126e+00]
 [-8.25207452e-01 -1.19095515e+00 -3.43235783e-02  2.37406266e-01
  -1.75554179e+00 -1.75805989e+00  2.37406266e-01  2.37406266e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.37406266e-01
   2.37406266e-01]
 [ 1.68754080e-03 -1.41150240e+00 -9.16929878e-01 -1.04667794e+00
   1.94687416e+00  1.94634606e+00 -1.04667794e+00 -1.04667794e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.04667794e+00
  -1.04667794e+00]
 [-2.00817355e-01  1.32328350e-01  2.27189399e-01  9.83966852e-01
   2.89183022e-01  2.89651372e-01  9.83966852e-01  9.83966852e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.83966852e-01
   9.83966852e-01]
 [ 1.35172018e+00  1.04208576e+00  4.56013255e-01 -1.35874027e-01
  -9.30919253e-01 -9.30641104e-01 -1.35874027e-01 -1.35874027e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.35874027e-01
  -1.35874027e-01]
 [-2.68318987e-01 -1.70924119e-01  5.05046938e-01  8.04792312e-01
   8.27340625e-02  8.42039997e-02  8.04792312e-01  8.04792312e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.04792312e-01
   8.04792312e-01]
 [-1.51878672e-02  1.23506460e+00  7.66559916e-01  9.83966852e-01
   5.72226550e-01  5.75570626e-01  9.83966852e-01  9.83966852e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.83966852e-01
   9.83966852e-01]
 [ 1.50359885e+00  1.31776982e+00  1.58378797e+00  1.26765987e+00
  -8.14943650e-01 -8.12137251e-01  1.26765987e+00  1.26765987e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.26765987e+00
   1.26765987e+00]
 [ 9.12959574e-01  1.87465163e-01  5.37736060e-01 -7.61491798e-02
  -6.22717786e-01 -6.22965487e-01 -7.61491798e-02 -7.61491798e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -7.61491798e-02
  -7.61491798e-02]
 [-4.37073068e-01 -1.43907081e+00 -1.12940917e+00 -1.31543975e+00
   7.41140161e-01  7.38346038e-01 -1.31543975e+00 -1.31543975e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.31543975e+00
  -1.31543975e+00]]
2024-09-19 17:46:53 - INFO - y 샘플:
[-1.31543975]
2024-09-19 17:46:53 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:46:53 - INFO - 모델 출력 (스케일링된 예측): [0.3603955]
2024-09-19 17:46:53 - INFO - 스케일러 역변환 후 예측 가격: 82885237.05584893
2024-09-19 17:46:53 - INFO - TransformerPredictor 최종 예측 가격: 82885237.05584893
2024-09-19 17:46:53 - INFO - TRANSFORMER prediction: 82885237.05584893
2024-09-19 17:46:53 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:46:53 - INFO - BITCOIN_FORECAST prediction: 82167915.33935016
2024-09-19 17:46:53 - INFO - BitcoinForecast prediction: 82167915.33935016
2024-09-19 17:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:46:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:47:05 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:47:05 - INFO - 조정된 모델 가중치: {'gpt': 0.004143390020588759, 'ml': 0.22749822771656897, 'xgboost': 0.08598632800687882, 'rl': 0.22749822771656897, 'lstm': 0.19076331156728288, 'arima': 0.020518595736076027, 'prophet': 0.0, 'transformer': 0.2230733234999596, 'bitcoin_forecast': 0.020518595736076027}
2024-09-19 17:47:05 - INFO - 조정된 모델 가중치: {'gpt': 0.004143390020588759, 'ml': 0.22749822771656897, 'xgboost': 0.08598632800687882, 'rl': 0.22749822771656897, 'lstm': 0.19076331156728288, 'arima': 0.020518595736076027, 'prophet': 0.0, 'transformer': 0.2230733234999596, 'bitcoin_forecast': 0.020518595736076027}
2024-09-19 17:47:05 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 82979368.8773969, 'current_price': 82772000.0, 'predictions': {'gpt': 82772000.0, 'ml': 82872327.60000001, 'xgboost': 82773000.0, 'lstm': 82885857.52856857, 'rl': 83599720.0, 'arima': 80899000.0, 'prophet': 82757923.13858509, 'transformer': 82885237.05584893, 'bitcoin_forecast': 82167915.33935016}, 'weights': {'gpt': 0.004143390020588759, 'ml': 0.22749822771656897, 'xgboost': 0.08598632800687882, 'rl': 0.22749822771656897, 'lstm': 0.19076331156728288, 'arima': 0.020518595736076027, 'prophet': 0.0, 'transformer': 0.2230733234999596, 'bitcoin_forecast': 0.020518595736076027}}
2024-09-19 17:47:05 - INFO - 모델별 가중치:
2024-09-19 17:47:05 - INFO -   - GPT: 0.0041
2024-09-19 17:47:05 - INFO -   - ML: 0.2275
2024-09-19 17:47:05 - INFO -   - XGBOOST: 0.0860
2024-09-19 17:47:05 - INFO -   - RL: 0.2275
2024-09-19 17:47:05 - INFO -   - LSTM: 0.1908
2024-09-19 17:47:05 - INFO -   - ARIMA: 0.0205
2024-09-19 17:47:05 - INFO -   - PROPHET: 0.0000
2024-09-19 17:47:05 - INFO -   - TRANSFORMER: 0.2231
2024-09-19 17:47:05 - INFO -   - BITCOIN_FORECAST: 0.0205
2024-09-19 17:47:05 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:47:05 - INFO - 6. 거래 실행
2024-09-19 17:47:05 - INFO - Cancelling existing orders.
2024-09-19 17:47:05 - INFO - Cancelled 0 orders.
2024-09-19 17:47:05 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 82979368.8773969, 'current_price': 82772000.0, 'predictions': {'gpt': 82772000.0, 'ml': 82872327.60000001, 'xgboost': 82773000.0, 'lstm': 82885857.52856857, 'rl': 83599720.0, 'arima': 80899000.0, 'prophet': 82757923.13858509, 'transformer': 82885237.05584893, 'bitcoin_forecast': 82167915.33935016}, 'weights': {'gpt': 0.004143390020588759, 'ml': 0.22749822771656897, 'xgboost': 0.08598632800687882, 'rl': 0.22749822771656897, 'lstm': 0.19076331156728288, 'arima': 0.020518595736076027, 'prophet': 0.0, 'transformer': 0.2230733234999596, 'bitcoin_forecast': 0.020518595736076027}}, 현재 가격=82772000.0
2024-09-19 17:47:05 - INFO - 현재 잔고: KRW=344515.43609259, BTC=0.0015852, 총 자산가치=475725.61049259
2024-09-19 17:47:05 - INFO - 매수 시도: 0.0005747421960235225 BTC (약 47572.561049259006 KRW)
2024-09-19 17:47:05 - INFO - 주문 결과: {'uuid': '887128fe-6e9a-4637-a3cd-faa26bf1d850', 'side': 'bid', 'ord_type': 'limit', 'price': '82772000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:47:07+09:00', 'volume': '0.00057474', 'remaining_volume': '0.00057474', 'reserved_fee': '23.78618964', 'remaining_fee': '23.78618964', 'paid_fee': '0', 'locked': '47596.16546964', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:47:05 - INFO - buy 주문 성공: UUID=887128fe-6e9a-4637-a3cd-faa26bf1d850
2024-09-19 17:47:05 - INFO - Trade executed successfully.
2024-09-19 17:47:05 - INFO - 7. summary 리포트 보내기
2024-09-19 17:47:06 - INFO - Message sent to Discord successfully.
2024-09-19 17:47:06 - INFO - Trading cycle completed.
2024-09-19 17:47:06 - INFO - Performing periodic update.
2024-09-19 17:47:06 - INFO - 계산된 시장 변동성: 0.037547853415304526
2024-09-19 17:55:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:55:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812d-865f-da2318f6c997 "HTTP/1.1 200 OK"
2024-09-19 17:55:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e2-be2e-df92f843f3c7 "HTTP/1.1 200 OK"
2024-09-19 17:55:57 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e3-b9ae-c8160a9cd577 "HTTP/1.1 200 OK"
2024-09-19 17:56:06 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-955c-e55d7d0fc076 "HTTP/1.1 200 OK"
2024-09-19 17:56:11 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ca-9e25-f17388a6e573 "HTTP/1.1 200 OK"
2024-09-19 17:56:20 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e9-b308-d0d957d10fce "HTTP/1.1 200 OK"
2024-09-19 17:56:30 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c4-8c21-c0fa8df83ffc "HTTP/1.1 200 OK"
2024-09-19 17:56:39 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:56:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8fcdfde3-704a-4f97-8fd7-645e933af105 "HTTP/1.1 200 OK"
2024-09-19 17:56:46 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 17:57:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f8-a93e-cf93befca139 "HTTP/1.1 200 OK"
2024-09-19 17:57:00 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:45:34.931795
2024-09-19 17:57:00 - INFO - Starting trading cycle.
2024-09-19 17:57:00 - INFO - ##################################################
2024-09-19 17:57:00 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-19 17:57:00 - INFO - ##################################################
2024-09-19 17:57:00 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 17:57:00 - INFO - 데이터베이스 업데이트 시작
2024-09-19 17:57:00 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:40:00
2024-09-19 17:57:00 - INFO - 새로운 데이터 범위: 2024-09-18 08:40:00 ~ 2024-09-19 17:50:00
2024-09-19 17:57:00 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 17:57:00 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 17:57:00 - INFO - Index: Index([199], dtype='int64')
2024-09-19 17:57:00 - INFO - Date column data type: datetime64[ns]
2024-09-19 17:57:00 - INFO - Sample date values: [Timestamp('2024-09-19 17:50:00')]
2024-09-19 17:57:00 - INFO - Successfully added 1 new data points
2024-09-19 17:57:00 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 17:57:00 - INFO - Final date range: 2024-09-19 17:50:00 to 2024-09-19 17:50:00
2024-09-19 17:57:00 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 17:57:00 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 17:50:00
2024-09-19 17:57:00 - INFO - 데이터베이스 업데이트 완료
2024-09-19 17:57:00 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 17:57:00 - INFO - GPT | 이전예측가격: 82772000 | 당시BTC가격: 82772000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:57:00 - INFO - ML 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-19 17:57:00 - INFO - ML | 이전예측가격: 82872328 | 당시BTC가격: 82772000 | 예측: 상승 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1926 | 반영가중치값: -0.0200 | 새 가중치: 0.1726 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-19 17:57:00 - INFO - XGBOOST | 이전예측가격: 82773000 | 당시BTC가격: 82772000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 17:57:00 - INFO - LSTM 모델 예측 업데이트: 정확도 57.69%, 적중/전체: 15/26
2024-09-19 17:57:01 - INFO - LSTM | 이전예측가격: 82885858 | 당시BTC가격: 82772000 | 예측: 상승 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1422 | 반영가중치값: -0.0200 | 새 가중치: 0.1222 | 예측 총 횟수: 26 | 예측 성공 수: 15 | 예측 성공률: 57.69%
2024-09-19 17:57:01 - INFO - RL 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 3/7
2024-09-19 17:57:01 - INFO - RL | 이전예측가격: 83599720 | 당시BTC가격: 82772000 | 예측: 상승 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0276 | 반영가중치값: -0.0200 | 새 가중치: 0.0076 | 예측 총 횟수: 7 | 예측 성공 수: 3 | 예측 성공률: 42.86%
2024-09-19 17:57:01 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.28%, 적중/전체: 112/199
2024-09-19 17:57:01 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82772000 | 예측: 하락 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2048 | 반영가중치값: 0.0200 | 새 가중치: 0.2248 | 예측 총 횟수: 199 | 예측 성공 수: 112 | 예측 성공률: 56.28%
2024-09-19 17:57:01 - INFO - PROPHET 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-19 17:57:01 - INFO - PROPHET | 이전예측가격: 82757923 | 당시BTC가격: 82772000 | 예측: 하락 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-19 17:57:01 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.78%, 적중/전체: 26/45
2024-09-19 17:57:01 - INFO - TRANSFORMER | 이전예측가격: 82885237 | 당시BTC가격: 82772000 | 예측: 상승 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1620 | 반영가중치값: -0.0200 | 새 가중치: 0.1420 | 예측 총 횟수: 45 | 예측 성공 수: 26 | 예측 성공률: 57.78%
2024-09-19 17:57:01 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.45%, 적중/전체: 27/47
2024-09-19 17:57:01 - INFO - BITCOIN_FORECAST | 이전예측가격: 82167915 | 당시BTC가격: 82772000 | 예측: 하락 | 지금 BTC가격: 82770000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1830 | 반영가중치값: 0.0200 | 새 가중치: 0.2030 | 예측 총 횟수: 47 | 예측 성공 수: 27 | 예측 성공률: 57.45%
2024-09-19 17:57:01 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 17:57:01 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 17:57:01 - INFO - 새로운 가중치: {'gpt': 0.0042181440671121544, 'ml': 0.1757351466912824, 'xgboost': 0.0875376726624053, 'rl': 0.007695777514507047, 'lstm': 0.12439915355266874, 'arima': 0.2288582780101832, 'prophet': 0.02036083519124165, 'transformer': 0.1445254247465088, 'bitcoin_forecast': 0.20666956756409066}
2024-09-19 17:57:01 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 17:57:01 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 17:57:01 - INFO - Current BTC price: 82767000.0
2024-09-19 17:57:01 - INFO - Analyzing market conditions.
2024-09-19 17:57:01 - INFO - Market analysis: {'current_price': 82767000.0, 'sma_20': 82803150.0, 'rsi_14': 47.00157594668329, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 17:57:01 - INFO - Starting predictions for all models
2024-09-19 17:57:01 - INFO - Attempting prediction for gpt
2024-09-19 17:57:01 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 17:57:01 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:57:01 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 17:57:01 - INFO - GPT prediction: 82767000.0
2024-09-19 17:57:01 - INFO - Attempting prediction for ml
2024-09-19 17:57:01 - INFO - ML prediction: 82882873.80000001
2024-09-19 17:57:01 - INFO - Attempting prediction for xgboost
2024-09-19 17:57:01 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 17:57:01 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:57:01 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 17:57:01 - INFO - XGBOOST prediction: 82767000.0
2024-09-19 17:57:01 - INFO - Attempting prediction for lstm
2024-09-19 17:57:01 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:57:01 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:57:01 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 17:57:01 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:57:01 - INFO - X 샘플:
[[-0.91896271 -0.57972265 -0.05607568  0.21801166 -1.75383063 -1.7562062
   0.21801166]
 [-0.03430313 -0.7353529  -0.97367767 -1.13083745  1.96287756  1.96308976
  -1.13083745]
 [-0.25095445  0.3540588   0.21580639  1.00222625  0.29878732  0.29973592
   1.00222625]
 [ 1.41003906  0.99603355  0.45370321 -0.17409564 -0.92602485 -0.92546157
  -0.17409564]
 [-0.32317156  0.14006722  0.50468109  0.81401475  0.09154142  0.09346274
   0.81401475]
 [-0.0523574   1.13221001  0.77656317  1.00222625  0.58292347  0.58680444
   1.00222625]
 [ 1.57252755  1.19057135  1.62619464  1.3002278  -0.80960155 -0.80648139
   1.3002278 ]
 [ 0.94062785  0.39296636  0.53866635 -0.11135847 -0.61663365 -0.61654924
  -0.11135847]
 [-0.50371434 -0.75480668 -1.19458185 -1.4131547   0.75248913  0.75023413
  -1.4131547 ]
 [-1.83973085 -2.13602508 -1.89127966 -1.50726046  0.41747179  0.4113714
  -1.50726046]]
2024-09-19 17:57:01 - INFO - y 샘플:
[-1.50726046]
2024-09-19 17:57:01 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 17:57:01 - INFO - 모델 출력 (스케일링된 예측): [[0.3124274]]
2024-09-19 17:57:01 - INFO - 스케일러 역변환 후 예측 가격: 82883019.76448652
2024-09-19 17:57:01 - INFO - LSTMPredictor 최종 예측 가격: 82883019.76448652
2024-09-19 17:57:01 - INFO - LSTM prediction: 82883019.76448652
2024-09-19 17:57:01 - INFO - Attempting prediction for rl
2024-09-19 17:57:01 - INFO - Preparing state for RL agent.
2024-09-19 17:57:01 - INFO - Prepared state: [[ 8.27670000e+07  9.46385369e+00 -7.24874053e-05  8.28031500e+07
   4.70015759e+01]]
2024-09-19 17:57:01 - INFO - RL prediction: 83594670.0
2024-09-19 17:57:01 - INFO - Attempting prediction for arima
2024-09-19 17:57:01 - INFO - ARIMA 예측 시작
2024-09-19 17:57:01 - INFO - 입력 데이터: {'open': 82771000.0, 'high': 82799000.0, 'low': 82712000.0, 'close': 82767000.0, 'volume': 9.46385369, 'value': 783242328.67875, 'decision': 'sell', 'sma': 82803150.0, 'ema': 82843534.04364349, 'rsi': 47.00157594668329, 'macd': 2972.3878885805607, 'signal_line': 9674.512583777481, 'BB_Upper': 83023650.58957566, 'BB_Lower': 82582649.41042434}
2024-09-19 17:57:01 - INFO - Exogenous 변수 예측 시작
2024-09-19 17:57:01 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82803150.0         0         0
2024-09-19 17:57:01 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82803150.0         0         0
2024-09-19 17:57:01 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 17:57:01 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 17:57:01 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 17:57:01 - INFO - ARIMA prediction: 80899000.0
2024-09-19 17:57:01 - INFO - Attempting prediction for prophet
2024-09-19 17:57:01 - INFO - PROPHET prediction: 82750334.27640583
2024-09-19 17:57:01 - INFO - Attempting prediction for transformer
2024-09-19 17:57:01 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 17:57:01 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 17:57:01 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 17:57:01 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 17:57:01 - INFO - X dtype: float64, y dtype: float64
2024-09-19 17:57:01 - INFO - X 샘플:
[[-0.91896271 -0.57972265 -0.05607568  0.21801166 -1.75383063 -1.7562062
   0.21801166  0.21801166  0.          0.          0.          0.21801166
   0.21801166]
 [-0.03430313 -0.7353529  -0.97367767 -1.13083745  1.96287756  1.96308976
  -1.13083745 -1.13083745  0.          0.          0.         -1.13083745
  -1.13083745]
 [-0.25095445  0.3540588   0.21580639  1.00222625  0.29878732  0.29973592
   1.00222625  1.00222625  0.          0.          0.          1.00222625
   1.00222625]
 [ 1.41003906  0.99603355  0.45370321 -0.17409564 -0.92602485 -0.92546157
  -0.17409564 -0.17409564  0.          0.          0.         -0.17409564
  -0.17409564]
 [-0.32317156  0.14006722  0.50468109  0.81401475  0.09154142  0.09346274
   0.81401475  0.81401475  0.          0.          0.          0.81401475
   0.81401475]
 [-0.0523574   1.13221001  0.77656317  1.00222625  0.58292347  0.58680444
   1.00222625  1.00222625  0.          0.          0.          1.00222625
   1.00222625]
 [ 1.57252755  1.19057135  1.62619464  1.3002278  -0.80960155 -0.80648139
   1.3002278   1.3002278   0.          0.          0.          1.3002278
   1.3002278 ]
 [ 0.94062785  0.39296636  0.53866635 -0.11135847 -0.61663365 -0.61654924
  -0.11135847 -0.11135847  0.          0.          0.         -0.11135847
  -0.11135847]
 [-0.50371434 -0.75480668 -1.19458185 -1.4131547   0.75248913  0.75023413
  -1.4131547  -1.4131547   0.          0.          0.         -1.4131547
  -1.4131547 ]
 [-1.83973085 -2.13602508 -1.89127966 -1.50726046  0.41747179  0.4113714
  -1.50726046 -1.50726046  0.          0.          0.         -1.50726046
  -1.50726046]]
2024-09-19 17:57:01 - INFO - y 샘플:
[-1.50726046]
2024-09-19 17:57:01 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 17:57:01 - INFO - 모델 출력 (스케일링된 예측): [0.35676476]
2024-09-19 17:57:01 - INFO - 스케일러 역변환 후 예측 가격: 82885846.62860167
2024-09-19 17:57:01 - INFO - TransformerPredictor 최종 예측 가격: 82885846.62860167
2024-09-19 17:57:01 - INFO - TRANSFORMER prediction: 82885846.62860167
2024-09-19 17:57:01 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 17:57:01 - INFO - BITCOIN_FORECAST prediction: 82155687.9295934
2024-09-19 17:57:01 - INFO - BitcoinForecast prediction: 82155687.9295934
2024-09-19 17:57:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 17:57:12 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 17:57:12 - INFO - 조정된 모델 가중치: {'gpt': 0.0042181440671121544, 'ml': 0.1757351466912824, 'xgboost': 0.0875376726624053, 'rl': 0.007695777514507047, 'lstm': 0.12439915355266874, 'arima': 0.2288582780101832, 'prophet': 0.02036083519124165, 'transformer': 0.1445254247465088, 'bitcoin_forecast': 0.20666956756409066}
2024-09-19 17:57:12 - INFO - 조정된 모델 가중치: {'gpt': 0.0042181440671121544, 'ml': 0.1757351466912824, 'xgboost': 0.0875376726624053, 'rl': 0.007695777514507047, 'lstm': 0.12439915355266874, 'arima': 0.2288582780101832, 'prophet': 0.02036083519124165, 'transformer': 0.1445254247465088, 'bitcoin_forecast': 0.20666956756409066}
2024-09-19 17:57:12 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82271155.59077986, 'current_price': 82767000.0, 'predictions': {'gpt': 82767000.0, 'ml': 82882873.80000001, 'xgboost': 82767000.0, 'lstm': 82883019.76448652, 'rl': 83594670.0, 'arima': 80899000.0, 'prophet': 82750334.27640583, 'transformer': 82885846.62860167, 'bitcoin_forecast': 82155687.9295934}, 'weights': {'gpt': 0.0042181440671121544, 'ml': 0.1757351466912824, 'xgboost': 0.0875376726624053, 'rl': 0.007695777514507047, 'lstm': 0.12439915355266874, 'arima': 0.2288582780101832, 'prophet': 0.02036083519124165, 'transformer': 0.1445254247465088, 'bitcoin_forecast': 0.20666956756409066}}
2024-09-19 17:57:12 - INFO - 모델별 가중치:
2024-09-19 17:57:12 - INFO -   - GPT: 0.0042
2024-09-19 17:57:12 - INFO -   - ML: 0.1757
2024-09-19 17:57:12 - INFO -   - XGBOOST: 0.0875
2024-09-19 17:57:12 - INFO -   - RL: 0.0077
2024-09-19 17:57:12 - INFO -   - LSTM: 0.1244
2024-09-19 17:57:12 - INFO -   - ARIMA: 0.2289
2024-09-19 17:57:12 - INFO -   - PROPHET: 0.0204
2024-09-19 17:57:12 - INFO -   - TRANSFORMER: 0.1445
2024-09-19 17:57:12 - INFO -   - BITCOIN_FORECAST: 0.2067
2024-09-19 17:57:12 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 17:57:12 - INFO - 6. 거래 실행
2024-09-19 17:57:12 - INFO - Cancelling existing orders.
2024-09-19 17:57:12 - INFO - Cancelled 0 orders.
2024-09-19 17:57:12 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82271155.59077986, 'current_price': 82767000.0, 'predictions': {'gpt': 82767000.0, 'ml': 82882873.80000001, 'xgboost': 82767000.0, 'lstm': 82883019.76448652, 'rl': 83594670.0, 'arima': 80899000.0, 'prophet': 82750334.27640583, 'transformer': 82885846.62860167, 'bitcoin_forecast': 82155687.9295934}, 'weights': {'gpt': 0.0042181440671121544, 'ml': 0.1757351466912824, 'xgboost': 0.0875376726624053, 'rl': 0.007695777514507047, 'lstm': 0.12439915355266874, 'arima': 0.2288582780101832, 'prophet': 0.02036083519124165, 'transformer': 0.1445254247465088, 'bitcoin_forecast': 0.20666956756409066}}, 현재 가격=82767000.0
2024-09-19 17:57:13 - INFO - 현재 잔고: KRW=296919.27062295, BTC=0.00215994, 총 자산가치=475691.02460294997
2024-09-19 17:57:13 - INFO - 매도 시도: 0.00043198800000000007 BTC (약 35754.350796000006 KRW)
2024-09-19 17:57:13 - INFO - 주문 결과: {'uuid': 'fc926091-3653-4810-8cd6-8d311ffe8f6d', 'side': 'ask', 'ord_type': 'limit', 'price': '82767000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T17:57:14+09:00', 'volume': '0.00043198', 'remaining_volume': '0.00043198', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00043198', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 17:57:13 - INFO - sell 주문 성공: UUID=fc926091-3653-4810-8cd6-8d311ffe8f6d
2024-09-19 17:57:13 - INFO - Trade executed successfully.
2024-09-19 17:57:13 - INFO - 7. summary 리포트 보내기
2024-09-19 17:57:13 - INFO - Message sent to Discord successfully.
2024-09-19 17:57:13 - INFO - Trading cycle completed.
2024-09-19 17:57:13 - INFO - Performing periodic update.
2024-09-19 17:57:13 - INFO - 계산된 시장 변동성: 0.03754863082371095
2024-09-19 18:05:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:05:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8140-84f1-db63ea1d9a14 "HTTP/1.1 200 OK"
2024-09-19 18:05:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:05:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815e-81a3-ea6d0fd2bb46 "HTTP/1.1 200 OK"
2024-09-19 18:05:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:05:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:05:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c4-ad77-f12cd8e5a921 "HTTP/1.1 200 OK"
2024-09-19 18:05:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8122-8fef-db378ca99728 "HTTP/1.1 200 OK"
2024-09-19 18:06:07 - INFO - Updated actual price for lstm prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-a8a2-da8ab1904644 "HTTP/1.1 200 OK"
2024-09-19 18:06:15 - INFO - Updated actual price for rl prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-a011-d7a589a1de8c "HTTP/1.1 200 OK"
2024-09-19 18:06:24 - INFO - Updated actual price for arima prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8176-8a53-ed19ed657e0f "HTTP/1.1 200 OK"
2024-09-19 18:06:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/53eb9cfa-bf35-4f64-91b6-be3a8d652e24 "HTTP/1.1 200 OK"
2024-09-19 18:06:40 - INFO - Updated actual price for transformer prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:06:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-892c-f4722a99d68c "HTTP/1.1 200 OK"
2024-09-19 18:06:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 17:55:34.932199
2024-09-19 18:06:45 - INFO - Starting trading cycle.
2024-09-19 18:06:45 - INFO - ##################################################
2024-09-19 18:06:45 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-19 18:06:45 - INFO - ##################################################
2024-09-19 18:06:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:06:45 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:06:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 17:50:00
2024-09-19 18:06:45 - INFO - 새로운 데이터 범위: 2024-09-18 08:50:00 ~ 2024-09-19 18:00:00
2024-09-19 18:06:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:06:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:06:45 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:06:45 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:06:45 - INFO - Sample date values: [Timestamp('2024-09-19 18:00:00')]
2024-09-19 18:06:46 - INFO - Successfully added 1 new data points
2024-09-19 18:06:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:06:46 - INFO - Final date range: 2024-09-19 18:00:00 to 2024-09-19 18:00:00
2024-09-19 18:06:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:06:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:00:00
2024-09-19 18:06:46 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:06:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:06:46 - INFO - GPT | 이전예측가격: 82767000 | 당시BTC가격: 82767000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:06:46 - INFO - ML 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-19 18:06:46 - INFO - ML | 이전예측가격: 82882874 | 당시BTC가격: 82767000 | 예측: 상승 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2275 | 반영가중치값: 0.0200 | 새 가중치: 0.2475 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-19 18:06:46 - INFO - XGBOOST | 이전예측가격: 82767000 | 당시BTC가격: 82767000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:06:46 - INFO - LSTM 모델 예측 업데이트: 정확도 59.26%, 적중/전체: 16/27
2024-09-19 18:06:46 - INFO - LSTM | 이전예측가격: 82883020 | 당시BTC가격: 82767000 | 예측: 상승 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1908 | 반영가중치값: 0.0200 | 새 가중치: 0.2108 | 예측 총 횟수: 27 | 예측 성공 수: 16 | 예측 성공률: 59.26%
2024-09-19 18:06:46 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-19 18:06:46 - INFO - RL | 이전예측가격: 83594670 | 당시BTC가격: 82767000 | 예측: 상승 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2275 | 반영가중치값: 0.0200 | 새 가중치: 0.2475 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-19 18:06:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.00%, 적중/전체: 112/200
2024-09-19 18:06:46 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82767000 | 예측: 하락 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0205 | 반영가중치값: -0.0200 | 새 가중치: 0.0005 | 예측 총 횟수: 200 | 예측 성공 수: 112 | 예측 성공률: 56.00%
2024-09-19 18:06:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-19 18:06:46 - INFO - PROPHET | 이전예측가격: 82750334 | 당시BTC가격: 82767000 | 예측: 하락 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-19 18:06:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.70%, 적중/전체: 27/46
2024-09-19 18:06:46 - INFO - TRANSFORMER | 이전예측가격: 82885847 | 당시BTC가격: 82767000 | 예측: 상승 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2231 | 반영가중치값: 0.0200 | 새 가중치: 0.2431 | 예측 총 횟수: 46 | 예측 성공 수: 27 | 예측 성공률: 58.70%
2024-09-19 18:06:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 27/48
2024-09-19 18:06:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 82155688 | 당시BTC가격: 82767000 | 예측: 하락 | 지금 BTC가격: 82838000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0205 | 반영가중치값: -0.0200 | 새 가중치: 0.0005 | 예측 총 횟수: 48 | 예측 성공 수: 27 | 예측 성공률: 56.25%
2024-09-19 18:06:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:06:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:06:46 - INFO - 새로운 가중치: {'gpt': 0.004049576016161943, 'ml': 0.23760755229248934, 'xgboost': 0.08403943869252536, 'rl': 0.23760755229248934, 'lstm': 0.20234065931135076, 'arima': 0.0004978712963531145, 'prophet': 0.0, 'transformer': 0.2333594788022771, 'bitcoin_forecast': 0.0004978712963531145}
2024-09-19 18:06:46 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:06:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:06:46 - INFO - Current BTC price: 82838000.0
2024-09-19 18:06:46 - INFO - Analyzing market conditions.
2024-09-19 18:06:46 - INFO - Market analysis: {'current_price': 82838000.0, 'sma_20': 82805050.0, 'rsi_14': 50.15858258495569, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:06:46 - INFO - Starting predictions for all models
2024-09-19 18:06:46 - INFO - Attempting prediction for gpt
2024-09-19 18:06:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:06:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:06:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:06:47 - INFO - GPT prediction: 82838000.0
2024-09-19 18:06:47 - INFO - Attempting prediction for ml
2024-09-19 18:06:47 - INFO - ML prediction: 82838000.0
2024-09-19 18:06:47 - INFO - Attempting prediction for xgboost
2024-09-19 18:06:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:06:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:06:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:06:47 - INFO - XGBOOST prediction: 82838000.0
2024-09-19 18:06:47 - INFO - Attempting prediction for lstm
2024-09-19 18:06:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:06:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:06:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:06:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:06:47 - INFO - X 샘플:
[[ 0.12218028 -0.61772413 -0.69275254 -1.06594254  2.18043351  2.18269566
  -1.06594254]
 [-0.04442919  0.40270511  0.34563457  1.05969068  0.12934388  0.13109449
   1.05969068]
 [ 1.23291007  1.00402948  0.55331199 -0.11253352 -1.38030955 -1.38007922
  -0.11253352]
 [-0.09996568  0.20226365  0.59781429  0.87213481 -0.12609895 -0.12332539
   0.87213481]
 [ 0.10829615  1.13158314  0.83515992  1.05969068  0.47955849  0.48516835
   1.05969068]
 [ 1.35786717  1.18624899  1.57686499  1.35665414 -1.23681095 -1.23332759
   1.35665414]
 [ 0.87192289  0.43914901  0.62748249 -0.0500149  -0.9989666  -0.99906294
  -0.0500149 ]
 [-0.23880691 -0.63594608 -0.88559586 -1.34727635  0.68855819  0.68674455
  -1.34727635]
 [-1.26623196 -1.92970458 -1.49379402 -1.44105428  0.27562951  0.26878707
  -1.44105428]
 [-2.04374282 -1.1826046  -1.46412582 -0.33134871 -0.01133752 -0.01869499
  -0.33134871]]
2024-09-19 18:06:47 - INFO - y 샘플:
[-0.33134871]
2024-09-19 18:06:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:06:47 - INFO - 모델 출력 (스케일링된 예측): [[0.27557653]]
2024-09-19 18:06:47 - INFO - 스케일러 역변환 후 예측 가격: 82876831.64408056
2024-09-19 18:06:47 - INFO - LSTMPredictor 최종 예측 가격: 82876831.64408056
2024-09-19 18:06:47 - INFO - LSTM prediction: 82876831.64408056
2024-09-19 18:06:47 - INFO - Attempting prediction for rl
2024-09-19 18:06:47 - INFO - Preparing state for RL agent.
2024-09-19 18:06:47 - INFO - Prepared state: [[8.28380000e+07 9.03217265e+00 8.57829811e-04 8.28050500e+07
  5.01585826e+01]]
2024-09-19 18:06:47 - INFO - RL prediction: 83666380.0
2024-09-19 18:06:47 - INFO - Attempting prediction for arima
2024-09-19 18:06:47 - INFO - ARIMA 예측 시작
2024-09-19 18:06:47 - INFO - 입력 데이터: {'open': 82715000.0, 'high': 82840000.0, 'low': 82714000.0, 'close': 82838000.0, 'volume': 9.03217265, 'value': 747476074.71882, 'decision': 'sell', 'sma': 82805050.0, 'ema': 82843006.99186791, 'rsi': 50.15858258495569, 'macd': 2619.809197753668, 'signal_line': 8263.571906572719, 'BB_Upper': 83026063.55162436, 'BB_Lower': 82584036.44837564}
2024-09-19 18:06:47 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:06:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82805050.0         0         0
2024-09-19 18:06:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82805050.0         0         0
2024-09-19 18:06:47 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:06:47 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:06:47 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:06:47 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:06:47 - INFO - Attempting prediction for prophet
2024-09-19 18:06:47 - INFO - PROPHET prediction: 82838087.04859623
2024-09-19 18:06:47 - INFO - Attempting prediction for transformer
2024-09-19 18:06:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:06:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:06:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:06:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:06:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:06:47 - INFO - X 샘플:
[[ 0.12218028 -0.61772413 -0.69275254 -1.06594254  2.18043351  2.18269566
  -1.06594254 -1.06594254  0.          0.          0.         -1.06594254
  -1.06594254]
 [-0.04442919  0.40270511  0.34563457  1.05969068  0.12934388  0.13109449
   1.05969068  1.05969068  0.          0.          0.          1.05969068
   1.05969068]
 [ 1.23291007  1.00402948  0.55331199 -0.11253352 -1.38030955 -1.38007922
  -0.11253352 -0.11253352  0.          0.          0.         -0.11253352
  -0.11253352]
 [-0.09996568  0.20226365  0.59781429  0.87213481 -0.12609895 -0.12332539
   0.87213481  0.87213481  0.          0.          0.          0.87213481
   0.87213481]
 [ 0.10829615  1.13158314  0.83515992  1.05969068  0.47955849  0.48516835
   1.05969068  1.05969068  0.          0.          0.          1.05969068
   1.05969068]
 [ 1.35786717  1.18624899  1.57686499  1.35665414 -1.23681095 -1.23332759
   1.35665414  1.35665414  0.          0.          0.          1.35665414
   1.35665414]
 [ 0.87192289  0.43914901  0.62748249 -0.0500149  -0.9989666  -0.99906294
  -0.0500149  -0.0500149   0.          0.          0.         -0.0500149
  -0.0500149 ]
 [-0.23880691 -0.63594608 -0.88559586 -1.34727635  0.68855819  0.68674455
  -1.34727635 -1.34727635  0.          0.          0.         -1.34727635
  -1.34727635]
 [-1.26623196 -1.92970458 -1.49379402 -1.44105428  0.27562951  0.26878707
  -1.44105428 -1.44105428  0.          0.          0.         -1.44105428
  -1.44105428]
 [-2.04374282 -1.1826046  -1.46412582 -0.33134871 -0.01133752 -0.01869499
  -0.33134871 -0.33134871  0.          0.          0.         -0.33134871
  -0.33134871]]
2024-09-19 18:06:47 - INFO - y 샘플:
[-0.33134871]
2024-09-19 18:06:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:06:47 - INFO - 모델 출력 (스케일링된 예측): [0.3579522]
2024-09-19 18:06:47 - INFO - 스케일러 역변환 후 예측 가격: 82882102.11678848
2024-09-19 18:06:47 - INFO - TransformerPredictor 최종 예측 가격: 82882102.11678848
2024-09-19 18:06:47 - INFO - TRANSFORMER prediction: 82882102.11678848
2024-09-19 18:06:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:06:47 - INFO - BITCOIN_FORECAST prediction: 82151325.4000114
2024-09-19 18:06:47 - INFO - BitcoinForecast prediction: 82151325.4000114
2024-09-19 18:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:06:56 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:06:56 - INFO - 조정된 모델 가중치: {'gpt': 0.004049576016161943, 'ml': 0.23760755229248934, 'xgboost': 0.08403943869252536, 'rl': 0.23760755229248934, 'lstm': 0.20234065931135076, 'arima': 0.0004978712963531145, 'prophet': 0.0, 'transformer': 0.2333594788022771, 'bitcoin_forecast': 0.0004978712963531145}
2024-09-19 18:06:56 - INFO - 조정된 모델 가중치: {'gpt': 0.004049576016161943, 'ml': 0.23760755229248934, 'xgboost': 0.08403943869252536, 'rl': 0.23760755229248934, 'lstm': 0.20234065931135076, 'arima': 0.0004978712963531145, 'prophet': 0.0, 'transformer': 0.2333594788022771, 'bitcoin_forecast': 0.0004978712963531145}
2024-09-19 18:06:56 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83051670.96360439, 'current_price': 82838000.0, 'predictions': {'gpt': 82838000.0, 'ml': 82838000.0, 'xgboost': 82838000.0, 'lstm': 82876831.64408056, 'rl': 83666380.0, 'arima': 80899000.0, 'prophet': 82838087.04859623, 'transformer': 82882102.11678848, 'bitcoin_forecast': 82151325.4000114}, 'weights': {'gpt': 0.004049576016161943, 'ml': 0.23760755229248934, 'xgboost': 0.08403943869252536, 'rl': 0.23760755229248934, 'lstm': 0.20234065931135076, 'arima': 0.0004978712963531145, 'prophet': 0.0, 'transformer': 0.2333594788022771, 'bitcoin_forecast': 0.0004978712963531145}}
2024-09-19 18:06:56 - INFO - 모델별 가중치:
2024-09-19 18:06:56 - INFO -   - GPT: 0.0040
2024-09-19 18:06:56 - INFO -   - ML: 0.2376
2024-09-19 18:06:56 - INFO -   - XGBOOST: 0.0840
2024-09-19 18:06:56 - INFO -   - RL: 0.2376
2024-09-19 18:06:56 - INFO -   - LSTM: 0.2023
2024-09-19 18:06:56 - INFO -   - ARIMA: 0.0005
2024-09-19 18:06:56 - INFO -   - PROPHET: 0.0000
2024-09-19 18:06:56 - INFO -   - TRANSFORMER: 0.2334
2024-09-19 18:06:56 - INFO -   - BITCOIN_FORECAST: 0.0005
2024-09-19 18:06:56 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:06:56 - INFO - 6. 거래 실행
2024-09-19 18:06:56 - INFO - Cancelling existing orders.
2024-09-19 18:06:56 - INFO - Cancelled 0 orders.
2024-09-19 18:06:56 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83051670.96360439, 'current_price': 82838000.0, 'predictions': {'gpt': 82838000.0, 'ml': 82838000.0, 'xgboost': 82838000.0, 'lstm': 82876831.64408056, 'rl': 83666380.0, 'arima': 80899000.0, 'prophet': 82838087.04859623, 'transformer': 82882102.11678848, 'bitcoin_forecast': 82151325.4000114}, 'weights': {'gpt': 0.004049576016161943, 'ml': 0.23760755229248934, 'xgboost': 0.08403943869252536, 'rl': 0.23760755229248934, 'lstm': 0.20234065931135076, 'arima': 0.0004978712963531145, 'prophet': 0.0, 'transformer': 0.2333594788022771, 'bitcoin_forecast': 0.0004978712963531145}}, 현재 가격=82838000.0
2024-09-19 18:06:56 - INFO - 현재 잔고: KRW=332655.08243862, BTC=0.00172796, 총 자산가치=475795.83291861997
2024-09-19 18:06:56 - INFO - 매수 시도: 0.0005743690491303749 BTC (약 47579.583291862 KRW)
2024-09-19 18:06:56 - INFO - 주문 결과: {'uuid': '4819c580-89b3-4671-91f9-2dfe6d37e914', 'side': 'bid', 'ord_type': 'limit', 'price': '82838000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:06:58+09:00', 'volume': '0.00057436', 'remaining_volume': '0.00057436', 'reserved_fee': '23.78941684', 'remaining_fee': '23.78941684', 'paid_fee': '0', 'locked': '47602.62309684', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:06:56 - INFO - buy 주문 성공: UUID=4819c580-89b3-4671-91f9-2dfe6d37e914
2024-09-19 18:06:56 - INFO - Trade executed successfully.
2024-09-19 18:06:56 - INFO - 7. summary 리포트 보내기
2024-09-19 18:06:57 - INFO - Message sent to Discord successfully.
2024-09-19 18:06:57 - INFO - Trading cycle completed.
2024-09-19 18:06:57 - INFO - Performing periodic update.
2024-09-19 18:06:57 - INFO - 계산된 시장 변동성: 0.03747150113912823
2024-09-19 18:15:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:15:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819f-b975-dcb4f83564f8 "HTTP/1.1 200 OK"
2024-09-19 18:15:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:15:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:15:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8d76571f-cadc-4ea7-9a6c-5b51204782a9 "HTTP/1.1 200 OK"
2024-09-19 18:15:50 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:15:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:15:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c9-a215-c7485b0826aa "HTTP/1.1 200 OK"
2024-09-19 18:15:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811f-879e-d7ed6a2e1fc9 "HTTP/1.1 200 OK"
2024-09-19 18:16:08 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8168-8c7a-f6031f49b617 "HTTP/1.1 200 OK"
2024-09-19 18:16:18 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-8f49-e1b928fd89f3 "HTTP/1.1 200 OK"
2024-09-19 18:16:26 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e5-bd10-e9cc568778e0 "HTTP/1.1 200 OK"
2024-09-19 18:16:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-9a65-fce12718a2af "HTTP/1.1 200 OK"
2024-09-19 18:16:46 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:16:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-b7dc-e55cc9c187ae "HTTP/1.1 200 OK"
2024-09-19 18:16:55 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:05:34.932573
2024-09-19 18:16:55 - INFO - Starting trading cycle.
2024-09-19 18:16:55 - INFO - ##################################################
2024-09-19 18:16:55 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-19 18:16:55 - INFO - ##################################################
2024-09-19 18:16:55 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:16:55 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:16:55 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:00:00
2024-09-19 18:16:55 - INFO - 새로운 데이터 범위: 2024-09-18 09:00:00 ~ 2024-09-19 18:10:00
2024-09-19 18:16:55 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:16:55 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:16:55 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:16:55 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:16:55 - INFO - Sample date values: [Timestamp('2024-09-19 18:10:00')]
2024-09-19 18:16:55 - INFO - Successfully added 1 new data points
2024-09-19 18:16:55 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:16:55 - INFO - Final date range: 2024-09-19 18:10:00 to 2024-09-19 18:10:00
2024-09-19 18:16:55 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:16:55 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:10:00
2024-09-19 18:16:55 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:16:55 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:16:55 - INFO - GPT | 이전예측가격: 82838000 | 당시BTC가격: 82838000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:16:55 - INFO - ML | 이전예측가격: 82838000 | 당시BTC가격: 82838000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:16:55 - INFO - XGBOOST | 이전예측가격: 82838000 | 당시BTC가격: 82838000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:16:55 - INFO - LSTM 모델 예측 업데이트: 정확도 60.71%, 적중/전체: 17/28
2024-09-19 18:16:55 - INFO - LSTM | 이전예측가격: 82876832 | 당시BTC가격: 82838000 | 예측: 상승 | 지금 BTC가격: 82959000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1244 | 반영가중치값: 0.0200 | 새 가중치: 0.1444 | 예측 총 횟수: 28 | 예측 성공 수: 17 | 예측 성공률: 60.71%
2024-09-19 18:16:55 - INFO - RL 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-19 18:16:55 - INFO - RL | 이전예측가격: 83666380 | 당시BTC가격: 82838000 | 예측: 상승 | 지금 BTC가격: 82959000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0077 | 반영가중치값: 0.0200 | 새 가중치: 0.0277 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-19 18:16:55 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.72%, 적중/전체: 112/201
2024-09-19 18:16:56 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82838000 | 예측: 하락 | 지금 BTC가격: 82959000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2289 | 반영가중치값: -0.0200 | 새 가중치: 0.2089 | 예측 총 횟수: 201 | 예측 성공 수: 112 | 예측 성공률: 55.72%
2024-09-19 18:16:56 - INFO - PROPHET | 이전예측가격: 82838087 | 당시BTC가격: 82838000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:16:56 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.57%, 적중/전체: 28/47
2024-09-19 18:16:56 - INFO - TRANSFORMER | 이전예측가격: 82882102 | 당시BTC가격: 82838000 | 예측: 상승 | 지금 BTC가격: 82959000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1445 | 반영가중치값: 0.0200 | 새 가중치: 0.1645 | 예측 총 횟수: 47 | 예측 성공 수: 28 | 예측 성공률: 59.57%
2024-09-19 18:16:56 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.10%, 적중/전체: 27/49
2024-09-19 18:16:56 - INFO - BITCOIN_FORECAST | 이전예측가격: 82151325 | 당시BTC가격: 82838000 | 예측: 하락 | 지금 BTC가격: 82959000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2067 | 반영가중치값: -0.0200 | 새 가중치: 0.1867 | 예측 총 횟수: 49 | 예측 성공 수: 27 | 예측 성공률: 55.10%
2024-09-19 18:16:56 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:16:56 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:16:56 - INFO - 새로운 가중치: {'gpt': 0.003828138245962644, 'ml': 0.22461476333083666, 'xgboost': 0.07944401787844443, 'rl': 0.026181324842851583, 'lstm': 0.13650315988475029, 'arima': 0.19743754873243682, 'prophet': 0.0, 'transformer': 0.15552889201035122, 'bitcoin_forecast': 0.1764621550743663}
2024-09-19 18:16:56 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:16:56 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:16:56 - INFO - Current BTC price: 82959000.0
2024-09-19 18:16:56 - INFO - Analyzing market conditions.
2024-09-19 18:16:56 - INFO - Market analysis: {'current_price': 82959000.0, 'sma_20': 82816500.0, 'rsi_14': 55.07054866896228, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:16:56 - INFO - Starting predictions for all models
2024-09-19 18:16:56 - INFO - Attempting prediction for gpt
2024-09-19 18:16:56 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:16:56 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:16:56 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:16:56 - INFO - GPT prediction: 82959000.0
2024-09-19 18:16:56 - INFO - Attempting prediction for ml
2024-09-19 18:16:56 - INFO - ML prediction: 83025367.19999999
2024-09-19 18:16:56 - INFO - Attempting prediction for xgboost
2024-09-19 18:16:56 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:16:56 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:16:56 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:16:56 - INFO - XGBOOST prediction: 82959000.0
2024-09-19 18:16:56 - INFO - Attempting prediction for lstm
2024-09-19 18:16:56 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:16:56 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:16:56 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:16:56 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:16:56 - INFO - X 샘플:
[[ 0.00552535  0.21491134  0.24927467  0.77395421  0.63491734  0.63802553
   0.77395421]
 [ 1.27635511  0.79622889  0.46207012 -0.36421374 -1.28367561 -1.28426246
  -0.36421374]
 [-0.04972812  0.02113882  0.50766914  0.59184733  0.31027938  0.3143908
   0.59184733]
 [ 0.15747238  0.91953867  0.75086394  0.77395421  1.07999914  1.08842505
   0.77395421]
 [ 1.40067541  0.97238572  1.51084769  1.06229009 -1.10130567 -1.0975871
   1.06229009]
 [ 0.91720757  0.2501427   0.53806849 -0.30351145 -0.79903332 -0.79959083
  -0.30351145]
 [-0.18786179 -0.78918261 -1.01229835 -1.56308398  1.34561332  1.34483999
  -1.56308398]
 [-1.21005095 -2.03989613 -1.63548502 -1.65413742  0.82082926  0.81317732
  -1.65413742]
 [-1.9835995  -1.31765311 -1.60508567 -0.57667176  0.45612773  0.44748587
  -0.57667176]
 [-0.32599546  0.97238572  0.23407499  1.25957253 -1.46375157 -1.46490416
   1.25957253]]
2024-09-19 18:16:56 - INFO - y 샘플:
[1.25957253]
2024-09-19 18:16:56 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:16:56 - INFO - 모델 출력 (스케일링된 예측): [[0.26269454]]
2024-09-19 18:16:56 - INFO - 스케일러 역변환 후 예측 가격: 82893310.35417844
2024-09-19 18:16:56 - INFO - LSTMPredictor 최종 예측 가격: 82893310.35417844
2024-09-19 18:16:56 - INFO - LSTM prediction: 82893310.35417844
2024-09-19 18:16:56 - INFO - Attempting prediction for rl
2024-09-19 18:16:56 - INFO - Preparing state for RL agent.
2024-09-19 18:16:56 - INFO - Prepared state: [[8.29590000e+07 6.75969662e+00 1.46068230e-03 8.28165000e+07
  5.50705487e+01]]
2024-09-19 18:16:56 - INFO - RL prediction: 83788590.0
2024-09-19 18:16:56 - INFO - Attempting prediction for arima
2024-09-19 18:16:56 - INFO - ARIMA 예측 시작
2024-09-19 18:16:56 - INFO - 입력 데이터: {'open': 82835000.0, 'high': 82970000.0, 'low': 82835000.0, 'close': 82959000.0, 'volume': 6.75969662, 'value': 560435807.39923, 'decision': 'sell', 'sma': 82816500.0, 'ema': 82854053.94502336, 'rsi': 55.07054866896228, 'macd': 11966.138608679175, 'signal_line': 9004.085246994011, 'BB_Upper': 83044395.15133765, 'BB_Lower': 82588604.84866235}
2024-09-19 18:16:56 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:16:56 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82816500.0         0         0
2024-09-19 18:16:56 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82816500.0         0         0
2024-09-19 18:16:56 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:16:56 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:16:56 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:16:56 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:16:56 - INFO - Attempting prediction for prophet
2024-09-19 18:16:56 - INFO - PROPHET prediction: 82984227.88772552
2024-09-19 18:16:56 - INFO - Attempting prediction for transformer
2024-09-19 18:16:56 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:16:56 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:16:56 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:16:56 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:16:56 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:16:56 - INFO - X 샘플:
[[ 0.00552535  0.21491134  0.24927467  0.77395421  0.63491734  0.63802553
   0.77395421  0.77395421  0.          0.          0.          0.77395421
   0.77395421]
 [ 1.27635511  0.79622889  0.46207012 -0.36421374 -1.28367561 -1.28426246
  -0.36421374 -0.36421374  0.          0.          0.         -0.36421374
  -0.36421374]
 [-0.04972812  0.02113882  0.50766914  0.59184733  0.31027938  0.3143908
   0.59184733  0.59184733  0.          0.          0.          0.59184733
   0.59184733]
 [ 0.15747238  0.91953867  0.75086394  0.77395421  1.07999914  1.08842505
   0.77395421  0.77395421  0.          0.          0.          0.77395421
   0.77395421]
 [ 1.40067541  0.97238572  1.51084769  1.06229009 -1.10130567 -1.0975871
   1.06229009  1.06229009  0.          0.          0.          1.06229009
   1.06229009]
 [ 0.91720757  0.2501427   0.53806849 -0.30351145 -0.79903332 -0.79959083
  -0.30351145 -0.30351145  0.          0.          0.         -0.30351145
  -0.30351145]
 [-0.18786179 -0.78918261 -1.01229835 -1.56308398  1.34561332  1.34483999
  -1.56308398 -1.56308398  0.          0.          0.         -1.56308398
  -1.56308398]
 [-1.21005095 -2.03989613 -1.63548502 -1.65413742  0.82082926  0.81317732
  -1.65413742 -1.65413742  0.          0.          0.         -1.65413742
  -1.65413742]
 [-1.9835995  -1.31765311 -1.60508567 -0.57667176  0.45612773  0.44748587
  -0.57667176 -0.57667176  0.          0.          0.         -0.57667176
  -0.57667176]
 [-0.32599546  0.97238572  0.23407499  1.25957253 -1.46375157 -1.46490416
   1.25957253  1.25957253  0.          0.          0.          1.25957253
   1.25957253]]
2024-09-19 18:16:56 - INFO - y 샘플:
[1.25957253]
2024-09-19 18:16:56 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:16:56 - INFO - 모델 출력 (스케일링된 예측): [0.3608963]
2024-09-19 18:16:56 - INFO - 스케일러 역변환 후 예측 가격: 82899781.39510034
2024-09-19 18:16:56 - INFO - TransformerPredictor 최종 예측 가격: 82899781.39510034
2024-09-19 18:16:56 - INFO - TRANSFORMER prediction: 82899781.39510034
2024-09-19 18:16:56 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:16:56 - INFO - BITCOIN_FORECAST prediction: 82134999.13665082
2024-09-19 18:16:56 - INFO - BitcoinForecast prediction: 82134999.13665082
2024-09-19 18:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:17:03 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:17:03 - INFO - 조정된 모델 가중치: {'gpt': 0.003828138245962644, 'ml': 0.22461476333083666, 'xgboost': 0.07944401787844443, 'rl': 0.026181324842851583, 'lstm': 0.13650315988475029, 'arima': 0.19743754873243682, 'prophet': 0.0, 'transformer': 0.15552889201035122, 'bitcoin_forecast': 0.1764621550743663}
2024-09-19 18:17:03 - INFO - 조정된 모델 가중치: {'gpt': 0.003828138245962644, 'ml': 0.22461476333083666, 'xgboost': 0.07944401787844443, 'rl': 0.026181324842851583, 'lstm': 0.13650315988475029, 'arima': 0.19743754873243682, 'prophet': 0.0, 'transformer': 0.15552889201035122, 'bitcoin_forecast': 0.1764621550743663}
2024-09-19 18:17:03 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82425323.45144595, 'current_price': 82959000.0, 'predictions': {'gpt': 82959000.0, 'ml': 83025367.19999999, 'xgboost': 82959000.0, 'lstm': 82893310.35417844, 'rl': 83788590.0, 'arima': 80899000.0, 'prophet': 82984227.88772552, 'transformer': 82899781.39510034, 'bitcoin_forecast': 82134999.13665082}, 'weights': {'gpt': 0.003828138245962644, 'ml': 0.22461476333083666, 'xgboost': 0.07944401787844443, 'rl': 0.026181324842851583, 'lstm': 0.13650315988475029, 'arima': 0.19743754873243682, 'prophet': 0.0, 'transformer': 0.15552889201035122, 'bitcoin_forecast': 0.1764621550743663}}
2024-09-19 18:17:03 - INFO - 모델별 가중치:
2024-09-19 18:17:03 - INFO -   - GPT: 0.0038
2024-09-19 18:17:03 - INFO -   - ML: 0.2246
2024-09-19 18:17:03 - INFO -   - XGBOOST: 0.0794
2024-09-19 18:17:03 - INFO -   - RL: 0.0262
2024-09-19 18:17:03 - INFO -   - LSTM: 0.1365
2024-09-19 18:17:03 - INFO -   - ARIMA: 0.1974
2024-09-19 18:17:03 - INFO -   - PROPHET: 0.0000
2024-09-19 18:17:03 - INFO -   - TRANSFORMER: 0.1555
2024-09-19 18:17:03 - INFO -   - BITCOIN_FORECAST: 0.1765
2024-09-19 18:17:03 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:17:03 - INFO - 6. 거래 실행
2024-09-19 18:17:03 - INFO - Cancelling existing orders.
2024-09-19 18:17:03 - INFO - Cancelled 0 orders.
2024-09-19 18:17:03 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82425323.45144595, 'current_price': 82959000.0, 'predictions': {'gpt': 82959000.0, 'ml': 83025367.19999999, 'xgboost': 82959000.0, 'lstm': 82893310.35417844, 'rl': 83788590.0, 'arima': 80899000.0, 'prophet': 82984227.88772552, 'transformer': 82899781.39510034, 'bitcoin_forecast': 82134999.13665082}, 'weights': {'gpt': 0.003828138245962644, 'ml': 0.22461476333083666, 'xgboost': 0.07944401787844443, 'rl': 0.026181324842851583, 'lstm': 0.13650315988475029, 'arima': 0.19743754873243682, 'prophet': 0.0, 'transformer': 0.15552889201035122, 'bitcoin_forecast': 0.1764621550743663}}, 현재 가격=82959000.0
2024-09-19 18:17:03 - INFO - 현재 잔고: KRW=285052.45934178, BTC=0.00230232, 총 자산가치=476050.62422178
2024-09-19 18:17:03 - INFO - 매도 시도: 0.000460464 BTC (약 38199.632976 KRW)
2024-09-19 18:17:03 - INFO - 주문 결과: {'uuid': '6bf6b62e-5c0b-4cd5-9257-d4a310102cd8', 'side': 'ask', 'ord_type': 'limit', 'price': '82959000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:17:05+09:00', 'volume': '0.00046046', 'remaining_volume': '0.00046046', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00046046', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:17:03 - INFO - sell 주문 성공: UUID=6bf6b62e-5c0b-4cd5-9257-d4a310102cd8
2024-09-19 18:17:03 - INFO - Trade executed successfully.
2024-09-19 18:17:03 - INFO - 7. summary 리포트 보내기
2024-09-19 18:17:04 - INFO - Message sent to Discord successfully.
2024-09-19 18:17:04 - INFO - Trading cycle completed.
2024-09-19 18:17:04 - INFO - Performing periodic update.
2024-09-19 18:17:04 - INFO - 계산된 시장 변동성: 0.037518118547379006
2024-09-19 18:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:25:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812c-b44d-c65601a977d6 "HTTP/1.1 200 OK"
2024-09-19 18:25:39 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:25:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:25:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-b591-daf409f2743b "HTTP/1.1 200 OK"
2024-09-19 18:25:46 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:25:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:25:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-90d4-f59893821ae4 "HTTP/1.1 200 OK"
2024-09-19 18:25:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:25:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:25:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d2-a1c2-e6a93c136cfd "HTTP/1.1 200 OK"
2024-09-19 18:25:58 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:26:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-a283-e181872e3154 "HTTP/1.1 200 OK"
2024-09-19 18:26:04 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:26:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-a87d-cde9aecfda3d "HTTP/1.1 200 OK"
2024-09-19 18:26:09 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812a-9794-ea99b6c87305 "HTTP/1.1 200 OK"
2024-09-19 18:26:19 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:26:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8130-97ba-c09c04a9b2c8 "HTTP/1.1 200 OK"
2024-09-19 18:26:24 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:26:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-a7b0-d94ec79ae2d9 "HTTP/1.1 200 OK"
2024-09-19 18:26:32 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:15:34.932738
2024-09-19 18:26:32 - INFO - Starting trading cycle.
2024-09-19 18:26:32 - INFO - ##################################################
2024-09-19 18:26:32 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-19 18:26:32 - INFO - ##################################################
2024-09-19 18:26:32 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:26:32 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:26:32 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:10:00
2024-09-19 18:26:32 - INFO - 새로운 데이터 범위: 2024-09-18 09:10:00 ~ 2024-09-19 18:20:00
2024-09-19 18:26:32 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:26:32 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:26:32 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:26:32 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:26:32 - INFO - Sample date values: [Timestamp('2024-09-19 18:20:00')]
2024-09-19 18:26:32 - INFO - Successfully added 1 new data points
2024-09-19 18:26:32 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:26:32 - INFO - Final date range: 2024-09-19 18:20:00 to 2024-09-19 18:20:00
2024-09-19 18:26:32 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:26:32 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:20:00
2024-09-19 18:26:32 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:26:32 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:26:32 - INFO - GPT | 이전예측가격: 82959000 | 당시BTC가격: 82959000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:26:32 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 6/9
2024-09-19 18:26:32 - INFO - ML | 이전예측가격: 83025367 | 당시BTC가격: 82959000 | 예측: 상승 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2376 | 반영가중치값: 0.0200 | 새 가중치: 0.2576 | 예측 총 횟수: 9 | 예측 성공 수: 6 | 예측 성공률: 66.67%
2024-09-19 18:26:32 - INFO - XGBOOST | 이전예측가격: 82959000 | 당시BTC가격: 82959000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:26:32 - INFO - LSTM 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 17/29
2024-09-19 18:26:32 - INFO - LSTM | 이전예측가격: 82893310 | 당시BTC가격: 82959000 | 예측: 하락 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2023 | 반영가중치값: -0.0200 | 새 가중치: 0.1823 | 예측 총 횟수: 29 | 예측 성공 수: 17 | 예측 성공률: 58.62%
2024-09-19 18:26:32 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-19 18:26:32 - INFO - RL | 이전예측가격: 83788590 | 당시BTC가격: 82959000 | 예측: 상승 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2376 | 반영가중치값: 0.0200 | 새 가중치: 0.2576 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-19 18:26:32 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.45%, 적중/전체: 112/202
2024-09-19 18:26:32 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82959000 | 예측: 하락 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0005 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 202 | 예측 성공 수: 112 | 예측 성공률: 55.45%
2024-09-19 18:26:32 - INFO - PROPHET 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-19 18:26:32 - INFO - PROPHET | 이전예측가격: 82984228 | 당시BTC가격: 82959000 | 예측: 상승 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-19 18:26:32 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 28/48
2024-09-19 18:26:32 - INFO - TRANSFORMER | 이전예측가격: 82899781 | 당시BTC가격: 82959000 | 예측: 하락 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2334 | 반영가중치값: -0.0200 | 새 가중치: 0.2134 | 예측 총 횟수: 48 | 예측 성공 수: 28 | 예측 성공률: 58.33%
2024-09-19 18:26:32 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 54.00%, 적중/전체: 27/50
2024-09-19 18:26:33 - INFO - BITCOIN_FORECAST | 이전예측가격: 82134999 | 당시BTC가격: 82959000 | 예측: 하락 | 지금 BTC가격: 82988000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0005 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 50 | 예측 성공 수: 27 | 예측 성공률: 54.00%
2024-09-19 18:26:33 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:26:33 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:26:33 - INFO - 새로운 가중치: {'gpt': 0.003774586679350661, 'ml': 0.25400389769331433, 'xgboost': 0.07833268089372923, 'rl': 0.25400389769331433, 'lstm': 0.179789908179653, 'arima': 0.0, 'prophet': 0.019720221354761883, 'transformer': 0.2103748075058765, 'bitcoin_forecast': 0.0}
2024-09-19 18:26:33 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:26:33 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:26:33 - INFO - Current BTC price: 82988000.0
2024-09-19 18:26:33 - INFO - Analyzing market conditions.
2024-09-19 18:26:33 - INFO - Market analysis: {'current_price': 82988000.0, 'sma_20': 82836700.0, 'rsi_14': 56.18506004744937, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:26:33 - INFO - Starting predictions for all models
2024-09-19 18:26:33 - INFO - Attempting prediction for gpt
2024-09-19 18:26:33 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:26:33 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:26:33 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:26:33 - INFO - GPT prediction: 82988000.0
2024-09-19 18:26:33 - INFO - Attempting prediction for ml
2024-09-19 18:26:33 - INFO - ML prediction: 83054390.39999999
2024-09-19 18:26:33 - INFO - Attempting prediction for xgboost
2024-09-19 18:26:33 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:26:33 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:26:33 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:26:33 - INFO - XGBOOST prediction: 82988000.0
2024-09-19 18:26:33 - INFO - Attempting prediction for lstm
2024-09-19 18:26:33 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:26:33 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:26:33 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:26:33 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:26:33 - INFO - X 샘플:
[[ 1.09791778  0.64225436  0.34261251 -0.41348299 -1.28521099 -1.28569688
  -0.41348299]
 [-0.15535341 -0.08048712  0.38543907  0.45194653  0.28789755  0.29093933
   0.45194653]
 [ 0.04047022  0.75723595  0.61384741  0.61679025  1.04755058  1.05431338
   0.61679025]
 [ 1.21541195  0.80651378  1.32762346  0.8777928  -1.10522617 -1.10159247
   0.8777928 ]
 [ 0.75849016  0.13305014  0.41399011 -0.35853509 -0.80690707 -0.80770027
  -0.35853509]
 [-0.28590249 -0.83608048 -1.04211304 -1.49870414  1.30969094  1.3071969
  -1.49870414]
 [-1.25196569 -2.0023224  -1.62740941 -1.581126    0.79177024  0.78285643
  -1.581126  ]
 [-1.98304055 -1.32885876 -1.59885837 -0.60580067  0.43183844  0.42220137
  -0.60580067]
 [-0.41645157  0.80651378  0.12847969  1.0563735  -1.46293184 -1.46385074
   1.0563735 ]
 [ 0.9804236   1.10218075  1.05638856  1.45474582  0.79152832  0.80133295
   1.45474582]]
2024-09-19 18:26:33 - INFO - y 샘플:
[1.45474582]
2024-09-19 18:26:33 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:26:33 - INFO - 모델 출력 (스케일링된 예측): [[0.3045432]]
2024-09-19 18:26:33 - INFO - 스케일러 역변환 후 예측 가격: 82904269.59431948
2024-09-19 18:26:33 - INFO - LSTMPredictor 최종 예측 가격: 82904269.59431948
2024-09-19 18:26:33 - INFO - LSTM prediction: 82904269.59431948
2024-09-19 18:26:33 - INFO - Attempting prediction for rl
2024-09-19 18:26:33 - INFO - Preparing state for RL agent.
2024-09-19 18:26:33 - INFO - Prepared state: [[8.29880000e+07 9.46356354e+00 3.49570270e-04 8.28367000e+07
  5.61850600e+01]]
2024-09-19 18:26:33 - INFO - RL prediction: 83817880.0
2024-09-19 18:26:33 - INFO - Attempting prediction for arima
2024-09-19 18:26:33 - INFO - ARIMA 예측 시작
2024-09-19 18:26:33 - INFO - 입력 데이터: {'open': 82942000.0, 'high': 82988000.0, 'low': 82900000.0, 'close': 82988000.0, 'volume': 9.46356354, 'value': 785074649.56671, 'decision': 'sell', 'sma': 82836700.0, 'ema': 82866810.71216398, 'rsi': 56.18506004744937, 'macd': 21465.785427972674, 'signal_line': 11496.425283189743, 'BB_Upper': 83049714.64738749, 'BB_Lower': 82623685.35261251}
2024-09-19 18:26:33 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:26:33 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82836700.0         0         0
2024-09-19 18:26:33 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82836700.0         0         0
2024-09-19 18:26:33 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:26:33 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:26:33 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:26:33 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:26:33 - INFO - Attempting prediction for prophet
2024-09-19 18:26:33 - INFO - PROPHET prediction: 83020530.35090683
2024-09-19 18:26:33 - INFO - Attempting prediction for transformer
2024-09-19 18:26:33 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:26:33 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:26:33 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:26:33 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:26:33 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:26:33 - INFO - X 샘플:
[[ 1.09791778  0.64225436  0.34261251 -0.41348299 -1.28521099 -1.28569688
  -0.41348299 -0.41348299  0.          0.          0.         -0.41348299
  -0.41348299]
 [-0.15535341 -0.08048712  0.38543907  0.45194653  0.28789755  0.29093933
   0.45194653  0.45194653  0.          0.          0.          0.45194653
   0.45194653]
 [ 0.04047022  0.75723595  0.61384741  0.61679025  1.04755058  1.05431338
   0.61679025  0.61679025  0.          0.          0.          0.61679025
   0.61679025]
 [ 1.21541195  0.80651378  1.32762346  0.8777928  -1.10522617 -1.10159247
   0.8777928   0.8777928   0.          0.          0.          0.8777928
   0.8777928 ]
 [ 0.75849016  0.13305014  0.41399011 -0.35853509 -0.80690707 -0.80770027
  -0.35853509 -0.35853509  0.          0.          0.         -0.35853509
  -0.35853509]
 [-0.28590249 -0.83608048 -1.04211304 -1.49870414  1.30969094  1.3071969
  -1.49870414 -1.49870414  0.          0.          0.         -1.49870414
  -1.49870414]
 [-1.25196569 -2.0023224  -1.62740941 -1.581126    0.79177024  0.78285643
  -1.581126   -1.581126    0.          0.          0.         -1.581126
  -1.581126  ]
 [-1.98304055 -1.32885876 -1.59885837 -0.60580067  0.43183844  0.42220137
  -0.60580067 -0.60580067  0.          0.          0.         -0.60580067
  -0.60580067]
 [-0.41645157  0.80651378  0.12847969  1.0563735  -1.46293184 -1.46385074
   1.0563735   1.0563735   0.          0.          0.          1.0563735
   1.0563735 ]
 [ 0.9804236   1.10218075  1.05638856  1.45474582  0.79152832  0.80133295
   1.45474582  1.45474582  0.          0.          0.          1.45474582
   1.45474582]]
2024-09-19 18:26:33 - INFO - y 샘플:
[1.45474582]
2024-09-19 18:26:33 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:26:33 - INFO - 모델 출력 (스케일링된 예측): [0.36748862]
2024-09-19 18:26:33 - INFO - 스케일러 역변환 후 예측 가격: 82908851.78351584
2024-09-19 18:26:33 - INFO - TransformerPredictor 최종 예측 가격: 82908851.78351584
2024-09-19 18:26:33 - INFO - TRANSFORMER prediction: 82908851.78351584
2024-09-19 18:26:33 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:26:33 - INFO - BITCOIN_FORECAST prediction: 82165179.96415119
2024-09-19 18:26:33 - INFO - BitcoinForecast prediction: 82165179.96415119
2024-09-19 18:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:26:42 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:26:42 - INFO - 조정된 모델 가중치: {'gpt': 0.003774586679350661, 'ml': 0.25400389769331433, 'xgboost': 0.07833268089372923, 'rl': 0.25400389769331433, 'lstm': 0.179789908179653, 'arima': 0.0, 'prophet': 0.019720221354761883, 'transformer': 0.2103748075058765, 'bitcoin_forecast': 0.0}
2024-09-19 18:26:42 - INFO - 조정된 모델 가중치: {'gpt': 0.003774586679350661, 'ml': 0.25400389769331433, 'xgboost': 0.07833268089372923, 'rl': 0.25400389769331433, 'lstm': 0.179789908179653, 'arima': 0.0, 'prophet': 0.019720221354761883, 'transformer': 0.2103748075058765, 'bitcoin_forecast': 0.0}
2024-09-19 18:26:42 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83184593.00795133, 'current_price': 82988000.0, 'predictions': {'gpt': 82988000.0, 'ml': 83054390.39999999, 'xgboost': 82988000.0, 'lstm': 82904269.59431948, 'rl': 83817880.0, 'arima': 80899000.0, 'prophet': 83020530.35090683, 'transformer': 82908851.78351584, 'bitcoin_forecast': 82165179.96415119}, 'weights': {'gpt': 0.003774586679350661, 'ml': 0.25400389769331433, 'xgboost': 0.07833268089372923, 'rl': 0.25400389769331433, 'lstm': 0.179789908179653, 'arima': 0.0, 'prophet': 0.019720221354761883, 'transformer': 0.2103748075058765, 'bitcoin_forecast': 0.0}}
2024-09-19 18:26:42 - INFO - 모델별 가중치:
2024-09-19 18:26:42 - INFO -   - GPT: 0.0038
2024-09-19 18:26:42 - INFO -   - ML: 0.2540
2024-09-19 18:26:42 - INFO -   - XGBOOST: 0.0783
2024-09-19 18:26:42 - INFO -   - RL: 0.2540
2024-09-19 18:26:42 - INFO -   - LSTM: 0.1798
2024-09-19 18:26:42 - INFO -   - ARIMA: 0.0000
2024-09-19 18:26:42 - INFO -   - PROPHET: 0.0197
2024-09-19 18:26:42 - INFO -   - TRANSFORMER: 0.2104
2024-09-19 18:26:42 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 18:26:42 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:26:42 - INFO - 6. 거래 실행
2024-09-19 18:26:42 - INFO - Cancelling existing orders.
2024-09-19 18:26:42 - INFO - Cancelled 0 orders.
2024-09-19 18:26:42 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83184593.00795133, 'current_price': 82988000.0, 'predictions': {'gpt': 82988000.0, 'ml': 83054390.39999999, 'xgboost': 82988000.0, 'lstm': 82904269.59431948, 'rl': 83817880.0, 'arima': 80899000.0, 'prophet': 83020530.35090683, 'transformer': 82908851.78351584, 'bitcoin_forecast': 82165179.96415119}, 'weights': {'gpt': 0.003774586679350661, 'ml': 0.25400389769331433, 'xgboost': 0.07833268089372923, 'rl': 0.25400389769331433, 'lstm': 0.179789908179653, 'arima': 0.0, 'prophet': 0.019720221354761883, 'transformer': 0.2103748075058765, 'bitcoin_forecast': 0.0}}, 현재 가격=82988000.0
2024-09-19 18:26:42 - INFO - 현재 잔고: KRW=323232.66083121, BTC=0.00184186, 총 자산가치=476084.93851121
2024-09-19 18:26:42 - INFO - 매수 시도: 0.0005736792530380417 BTC (약 47608.493851121006 KRW)
2024-09-19 18:26:42 - INFO - 주문 결과: {'uuid': '150c50ea-2bde-4d46-8b52-5cb71241c9cc', 'side': 'bid', 'ord_type': 'limit', 'price': '82988000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:26:44+09:00', 'volume': '0.00057367', 'remaining_volume': '0.00057367', 'reserved_fee': '23.80386298', 'remaining_fee': '23.80386298', 'paid_fee': '0', 'locked': '47631.52982298', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:26:42 - INFO - buy 주문 성공: UUID=150c50ea-2bde-4d46-8b52-5cb71241c9cc
2024-09-19 18:26:42 - INFO - Trade executed successfully.
2024-09-19 18:26:42 - INFO - 7. summary 리포트 보내기
2024-09-19 18:26:42 - INFO - Message sent to Discord successfully.
2024-09-19 18:26:42 - INFO - Trading cycle completed.
2024-09-19 18:26:42 - INFO - Performing periodic update.
2024-09-19 18:26:42 - INFO - 계산된 시장 변동성: 0.03744081150059125
2024-09-19 18:35:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-a585-de6b411bc89c "HTTP/1.1 200 OK"
2024-09-19 18:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:35:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:35:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/e090e394-9755-4d02-ae4d-a7f0c902d14e "HTTP/1.1 200 OK"
2024-09-19 18:35:59 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:36:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-b172-dbd036ad933c "HTTP/1.1 200 OK"
2024-09-19 18:36:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:36:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819d-8278-e2aee9aa7247 "HTTP/1.1 200 OK"
2024-09-19 18:36:11 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:36:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9091-f79db0b05ab8 "HTTP/1.1 200 OK"
2024-09-19 18:36:20 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:36:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819f-8d95-dececc6b4940 "HTTP/1.1 200 OK"
2024-09-19 18:36:29 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e6-83a0-d7ab2f55ac7b "HTTP/1.1 200 OK"
2024-09-19 18:36:40 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:37:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817f-8d33-d06bb4351981 "HTTP/1.1 200 OK"
2024-09-19 18:37:01 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:37:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:37:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fc-8294-d31ee43a1255 "HTTP/1.1 200 OK"
2024-09-19 18:37:10 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:25:34.933180
2024-09-19 18:37:10 - INFO - Starting trading cycle.
2024-09-19 18:37:10 - INFO - ##################################################
2024-09-19 18:37:10 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-19 18:37:10 - INFO - ##################################################
2024-09-19 18:37:10 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:37:10 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:37:10 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:20:00
2024-09-19 18:37:10 - INFO - 새로운 데이터 범위: 2024-09-18 09:20:00 ~ 2024-09-19 18:30:00
2024-09-19 18:37:10 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:37:10 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:37:10 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:37:10 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:37:10 - INFO - Sample date values: [Timestamp('2024-09-19 18:30:00')]
2024-09-19 18:37:11 - INFO - Successfully added 1 new data points
2024-09-19 18:37:11 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:37:11 - INFO - Final date range: 2024-09-19 18:30:00 to 2024-09-19 18:30:00
2024-09-19 18:37:11 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:37:11 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:30:00
2024-09-19 18:37:11 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:37:11 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:37:11 - INFO - GPT | 이전예측가격: 82988000 | 당시BTC가격: 82988000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:37:11 - INFO - ML 모델 예측 업데이트: 정확도 70.00%, 적중/전체: 7/10
2024-09-19 18:37:11 - INFO - ML | 이전예측가격: 83054390 | 당시BTC가격: 82988000 | 예측: 상승 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2246 | 반영가중치값: 0.0200 | 새 가중치: 0.2446 | 예측 총 횟수: 10 | 예측 성공 수: 7 | 예측 성공률: 70.00%
2024-09-19 18:37:11 - INFO - XGBOOST | 이전예측가격: 82988000 | 당시BTC가격: 82988000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:37:11 - INFO - LSTM 모델 예측 업데이트: 정확도 56.67%, 적중/전체: 17/30
2024-09-19 18:37:11 - INFO - LSTM | 이전예측가격: 82904270 | 당시BTC가격: 82988000 | 예측: 하락 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1365 | 반영가중치값: -0.0200 | 새 가중치: 0.1165 | 예측 총 횟수: 30 | 예측 성공 수: 17 | 예측 성공률: 56.67%
2024-09-19 18:37:11 - INFO - RL 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 7/11
2024-09-19 18:37:11 - INFO - RL | 이전예측가격: 83817880 | 당시BTC가격: 82988000 | 예측: 상승 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0262 | 반영가중치값: 0.0200 | 새 가중치: 0.0462 | 예측 총 횟수: 11 | 예측 성공 수: 7 | 예측 성공률: 63.64%
2024-09-19 18:37:11 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.17%, 적중/전체: 112/203
2024-09-19 18:37:11 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 82988000 | 예측: 하락 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1974 | 반영가중치값: -0.0200 | 새 가중치: 0.1774 | 예측 총 횟수: 203 | 예측 성공 수: 112 | 예측 성공률: 55.17%
2024-09-19 18:37:11 - INFO - PROPHET 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-19 18:37:11 - INFO - PROPHET | 이전예측가격: 83020530 | 당시BTC가격: 82988000 | 예측: 상승 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-19 18:37:11 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 28/49
2024-09-19 18:37:11 - INFO - TRANSFORMER | 이전예측가격: 82908852 | 당시BTC가격: 82988000 | 예측: 하락 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1555 | 반영가중치값: -0.0200 | 새 가중치: 0.1355 | 예측 총 횟수: 49 | 예측 성공 수: 28 | 예측 성공률: 57.14%
2024-09-19 18:37:11 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 27/51
2024-09-19 18:37:11 - INFO - BITCOIN_FORECAST | 이전예측가격: 82165180 | 당시BTC가격: 82988000 | 예측: 하락 | 지금 BTC가격: 83030000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1765 | 반영가중치값: -0.0200 | 새 가중치: 0.1565 | 예측 총 횟수: 51 | 예측 성공 수: 27 | 예측 성공률: 52.94%
2024-09-19 18:37:11 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:37:11 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:37:11 - INFO - 새로운 가중치: {'gpt': 0.0038562027814513984, 'ml': 0.24990395263693352, 'xgboost': 0.08002643139537273, 'rl': 0.04717988178264608, 'lstm': 0.11902225259607412, 'arima': 0.18127419690720928, 'prophet': 0.020432450538477382, 'transformer': 0.13845936912680717, 'bitcoin_forecast': 0.15984526223502837}
2024-09-19 18:37:11 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:37:11 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:37:11 - INFO - Current BTC price: 83030000.0
2024-09-19 18:37:11 - INFO - Analyzing market conditions.
2024-09-19 18:37:11 - INFO - Market analysis: {'current_price': 83030000.0, 'sma_20': 82862350.0, 'rsi_14': 57.817081963811845, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:37:11 - INFO - Starting predictions for all models
2024-09-19 18:37:11 - INFO - Attempting prediction for gpt
2024-09-19 18:37:11 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:37:11 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:37:11 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:37:11 - INFO - GPT prediction: 83030000.0
2024-09-19 18:37:11 - INFO - Attempting prediction for ml
2024-09-19 18:37:11 - INFO - ML prediction: 83046606.0
2024-09-19 18:37:11 - INFO - Attempting prediction for xgboost
2024-09-19 18:37:11 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:37:11 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:37:11 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:37:11 - INFO - XGBOOST prediction: 83030000.0
2024-09-19 18:37:11 - INFO - Attempting prediction for lstm
2024-09-19 18:37:11 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:37:11 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:37:11 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:37:11 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:37:11 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:37:11 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:37:11 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:37:11 - INFO - X 샘플:
[[-0.20046847 -0.17367748  0.18061614  0.17946596 -0.27347003 -0.27285737
   0.17946596]
 [-0.01932226  0.57065457  0.37456637  0.32208792 -0.03298069 -0.03225203
   0.32208792]
 [ 1.067555    0.6144388   0.98066081  0.54790602 -0.71450218 -0.71176485
   0.54790602]
 [ 0.64488051  0.01605422  0.20485992 -0.52175866 -0.62006095 -0.61913394
  -0.52175866]
 [-0.32123261 -0.84503579 -1.03157275 -1.50822721  0.05000714  0.04745349
  -1.50822721]
 [-1.21488725 -1.88126275 -1.52857019 -1.57953818 -0.11395509 -0.11781164
  -1.57953818]
 [-1.89116643 -1.28287817 -1.50432641 -0.7356916  -0.22790154 -0.23148532
  -0.7356916 ]
 [-0.44199675  0.6144388  -0.03757786  0.70241314 -0.82774388 -0.82594384
   0.70241314]
 [ 0.85017954  0.87714423  0.75034492  1.04708287 -0.11403168 -0.11198809
   1.04708287]
 [ 1.52645873  1.49012356  1.61099904  1.54625973  2.87463889  2.87578358
   1.54625973]]
2024-09-19 18:37:11 - INFO - y 샘플:
[1.54625973]
2024-09-19 18:37:11 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:37:11 - INFO - 모델 출력 (스케일링된 예측): [[0.3573838]]
2024-09-19 18:37:11 - INFO - 스케일러 역변환 후 예측 가격: 82929969.74179997
2024-09-19 18:37:11 - INFO - LSTMPredictor 최종 예측 가격: 82929969.74179997
2024-09-19 18:37:11 - INFO - LSTM prediction: 82929969.74179997
2024-09-19 18:37:11 - INFO - Attempting prediction for rl
2024-09-19 18:37:11 - INFO - Preparing state for RL agent.
2024-09-19 18:37:11 - INFO - Prepared state: [[8.30300000e+07 2.07860091e+01 5.06097267e-04 8.28623500e+07
  5.78170820e+01]]
2024-09-19 18:37:11 - INFO - RL prediction: 83860300.0
2024-09-19 18:37:11 - INFO - Attempting prediction for arima
2024-09-19 18:37:11 - INFO - ARIMA 예측 시작
2024-09-19 18:37:11 - INFO - 입력 데이터: {'open': 82998000.0, 'high': 83030000.0, 'low': 82971000.0, 'close': 83030000.0, 'volume': 20.78600908, 'value': 1725146313.62328, 'decision': 'sell', 'sma': 82862350.0, 'ema': 82882352.54910074, 'rsi': 57.817081963811845, 'macd': 32014.331677511334, 'signal_line': 15600.006562054063, 'BB_Upper': 83034904.07848908, 'BB_Lower': 82689795.92151092}
2024-09-19 18:37:11 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:37:11 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82862350.0         0         0
2024-09-19 18:37:12 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82862350.0         0         0
2024-09-19 18:37:12 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:37:12 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:37:12 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:37:12 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:37:12 - INFO - Attempting prediction for prophet
2024-09-19 18:37:12 - INFO - PROPHET prediction: 83077367.70526384
2024-09-19 18:37:12 - INFO - Attempting prediction for transformer
2024-09-19 18:37:12 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:37:12 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:37:12 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:37:12 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:37:12 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:37:12 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:37:12 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:37:12 - INFO - X 샘플:
[[-0.20046847 -0.17367748  0.18061614  0.17946596 -0.27347003 -0.27285737
   0.17946596  0.17946596  0.          0.          0.          0.17946596
   0.17946596]
 [-0.01932226  0.57065457  0.37456637  0.32208792 -0.03298069 -0.03225203
   0.32208792  0.32208792  0.          0.          0.          0.32208792
   0.32208792]
 [ 1.067555    0.6144388   0.98066081  0.54790602 -0.71450218 -0.71176485
   0.54790602  0.54790602  0.          0.          0.          0.54790602
   0.54790602]
 [ 0.64488051  0.01605422  0.20485992 -0.52175866 -0.62006095 -0.61913394
  -0.52175866 -0.52175866  0.          0.          0.         -0.52175866
  -0.52175866]
 [-0.32123261 -0.84503579 -1.03157275 -1.50822721  0.05000714  0.04745349
  -1.50822721 -1.50822721  0.          0.          0.         -1.50822721
  -1.50822721]
 [-1.21488725 -1.88126275 -1.52857019 -1.57953818 -0.11395509 -0.11781164
  -1.57953818 -1.57953818  0.          0.          0.         -1.57953818
  -1.57953818]
 [-1.89116643 -1.28287817 -1.50432641 -0.7356916  -0.22790154 -0.23148532
  -0.7356916  -0.7356916   0.          0.          0.         -0.7356916
  -0.7356916 ]
 [-0.44199675  0.6144388  -0.03757786  0.70241314 -0.82774388 -0.82594384
   0.70241314  0.70241314  0.          0.          0.          0.70241314
   0.70241314]
 [ 0.85017954  0.87714423  0.75034492  1.04708287 -0.11403168 -0.11198809
   1.04708287  1.04708287  0.          0.          0.          1.04708287
   1.04708287]
 [ 1.52645873  1.49012356  1.61099904  1.54625973  2.87463889  2.87578358
   1.54625973  1.54625973  0.          0.          0.          1.54625973
   1.54625973]]
2024-09-19 18:37:12 - INFO - y 샘플:
[1.54625973]
2024-09-19 18:37:12 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:37:12 - INFO - 모델 출력 (스케일링된 예측): [0.3755004]
2024-09-19 18:37:12 - INFO - 스케일러 역변환 후 예측 가격: 82931494.04760134
2024-09-19 18:37:12 - INFO - TransformerPredictor 최종 예측 가격: 82931494.04760134
2024-09-19 18:37:12 - INFO - TRANSFORMER prediction: 82931494.04760134
2024-09-19 18:37:12 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:37:12 - INFO - BITCOIN_FORECAST prediction: 82252287.74383047
2024-09-19 18:37:12 - INFO - BitcoinForecast prediction: 82252287.74383047
2024-09-19 18:37:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:37:18 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:37:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0038562027814513984, 'ml': 0.24990395263693352, 'xgboost': 0.08002643139537273, 'rl': 0.04717988178264608, 'lstm': 0.11902225259607412, 'arima': 0.18127419690720928, 'prophet': 0.020432450538477382, 'transformer': 0.13845936912680717, 'bitcoin_forecast': 0.15984526223502837}
2024-09-19 18:37:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0038562027814513984, 'ml': 0.24990395263693352, 'xgboost': 0.08002643139537273, 'rl': 0.04717988178264608, 'lstm': 0.11902225259607412, 'arima': 0.18127419690720928, 'prophet': 0.020432450538477382, 'transformer': 0.13845936912680717, 'bitcoin_forecast': 0.15984526223502837}
2024-09-19 18:37:18 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82538137.36735338, 'current_price': 83030000.0, 'predictions': {'gpt': 83030000.0, 'ml': 83046606.0, 'xgboost': 83030000.0, 'lstm': 82929969.74179997, 'rl': 83860300.0, 'arima': 80899000.0, 'prophet': 83077367.70526384, 'transformer': 82931494.04760134, 'bitcoin_forecast': 82252287.74383047}, 'weights': {'gpt': 0.0038562027814513984, 'ml': 0.24990395263693352, 'xgboost': 0.08002643139537273, 'rl': 0.04717988178264608, 'lstm': 0.11902225259607412, 'arima': 0.18127419690720928, 'prophet': 0.020432450538477382, 'transformer': 0.13845936912680717, 'bitcoin_forecast': 0.15984526223502837}}
2024-09-19 18:37:18 - INFO - 모델별 가중치:
2024-09-19 18:37:18 - INFO -   - GPT: 0.0039
2024-09-19 18:37:18 - INFO -   - ML: 0.2499
2024-09-19 18:37:18 - INFO -   - XGBOOST: 0.0800
2024-09-19 18:37:18 - INFO -   - RL: 0.0472
2024-09-19 18:37:18 - INFO -   - LSTM: 0.1190
2024-09-19 18:37:18 - INFO -   - ARIMA: 0.1813
2024-09-19 18:37:18 - INFO -   - PROPHET: 0.0204
2024-09-19 18:37:18 - INFO -   - TRANSFORMER: 0.1385
2024-09-19 18:37:18 - INFO -   - BITCOIN_FORECAST: 0.1598
2024-09-19 18:37:18 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:37:18 - INFO - 6. 거래 실행
2024-09-19 18:37:18 - INFO - Cancelling existing orders.
2024-09-19 18:37:18 - INFO - Cancelled 0 orders.
2024-09-19 18:37:18 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82538137.36735338, 'current_price': 83030000.0, 'predictions': {'gpt': 83030000.0, 'ml': 83046606.0, 'xgboost': 83030000.0, 'lstm': 82929969.74179997, 'rl': 83860300.0, 'arima': 80899000.0, 'prophet': 83077367.70526384, 'transformer': 82931494.04760134, 'bitcoin_forecast': 82252287.74383047}, 'weights': {'gpt': 0.0038562027814513984, 'ml': 0.24990395263693352, 'xgboost': 0.08002643139537273, 'rl': 0.04717988178264608, 'lstm': 0.11902225259607412, 'arima': 0.18127419690720928, 'prophet': 0.020432450538477382, 'transformer': 0.13845936912680717, 'bitcoin_forecast': 0.15984526223502837}}, 현재 가격=83030000.0
2024-09-19 18:37:18 - INFO - 현재 잔고: KRW=275601.13100823, BTC=0.00241553, 총 자산가치=476162.58690823
2024-09-19 18:37:18 - INFO - 매도 시도: 0.000483106 BTC (약 40112.29118 KRW)
2024-09-19 18:37:18 - INFO - 주문 결과: {'uuid': '7115bdc3-1d7c-4734-86c7-b44e54ff2d5a', 'side': 'ask', 'ord_type': 'limit', 'price': '83030000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:37:20+09:00', 'volume': '0.0004831', 'remaining_volume': '0.0004831', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0004831', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:37:18 - INFO - sell 주문 성공: UUID=7115bdc3-1d7c-4734-86c7-b44e54ff2d5a
2024-09-19 18:37:18 - INFO - Trade executed successfully.
2024-09-19 18:37:18 - INFO - 7. summary 리포트 보내기
2024-09-19 18:37:19 - INFO - Message sent to Discord successfully.
2024-09-19 18:37:19 - INFO - Trading cycle completed.
2024-09-19 18:37:19 - INFO - Performing periodic update.
2024-09-19 18:37:19 - INFO - 계산된 시장 변동성: 0.0373951206119942
2024-09-19 18:45:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e5-b5a3-dafc50a38127 "HTTP/1.1 200 OK"
2024-09-19 18:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:45:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:45:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-a4dc-db4d359fc035 "HTTP/1.1 200 OK"
2024-09-19 18:45:53 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:45:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8138-bee8-ed51c6228ddb "HTTP/1.1 200 OK"
2024-09-19 18:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-8cd8-e0808a3009b0 "HTTP/1.1 200 OK"
2024-09-19 18:46:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ae-bb61-e1639c276b58 "HTTP/1.1 200 OK"
2024-09-19 18:46:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-825a-d5b9e6240cd0 "HTTP/1.1 200 OK"
2024-09-19 18:46:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bd-937c-f6fa85ee4b3b "HTTP/1.1 200 OK"
2024-09-19 18:46:27 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8106-8b02-e8bf1cd07162 "HTTP/1.1 200 OK"
2024-09-19 18:46:32 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:46:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cd-b361-c3f91bb27fb1 "HTTP/1.1 200 OK"
2024-09-19 18:46:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:35:34.933563
2024-09-19 18:46:45 - INFO - Starting trading cycle.
2024-09-19 18:46:45 - INFO - ##################################################
2024-09-19 18:46:45 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-19 18:46:45 - INFO - ##################################################
2024-09-19 18:46:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:46:45 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:46:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:30:00
2024-09-19 18:46:46 - INFO - 새로운 데이터 범위: 2024-09-18 09:30:00 ~ 2024-09-19 18:40:00
2024-09-19 18:46:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:46:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:46:46 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:46:46 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:46:46 - INFO - Sample date values: [Timestamp('2024-09-19 18:40:00')]
2024-09-19 18:46:46 - INFO - Successfully added 1 new data points
2024-09-19 18:46:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:46:46 - INFO - Final date range: 2024-09-19 18:40:00 to 2024-09-19 18:40:00
2024-09-19 18:46:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:46:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:40:00
2024-09-19 18:46:46 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:46:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:46:46 - INFO - GPT | 이전예측가격: 83030000 | 당시BTC가격: 83030000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:46:46 - INFO - ML 모델 예측 업데이트: 정확도 72.73%, 적중/전체: 8/11
2024-09-19 18:46:46 - INFO - ML | 이전예측가격: 83046606 | 당시BTC가격: 83030000 | 예측: 상승 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2540 | 반영가중치값: 0.0200 | 새 가중치: 0.2740 | 예측 총 횟수: 11 | 예측 성공 수: 8 | 예측 성공률: 72.73%
2024-09-19 18:46:46 - INFO - XGBOOST | 이전예측가격: 83030000 | 당시BTC가격: 83030000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:46:46 - INFO - LSTM 모델 예측 업데이트: 정확도 54.84%, 적중/전체: 17/31
2024-09-19 18:46:46 - INFO - LSTM | 이전예측가격: 82929970 | 당시BTC가격: 83030000 | 예측: 하락 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1798 | 반영가중치값: -0.0200 | 새 가중치: 0.1598 | 예측 총 횟수: 31 | 예측 성공 수: 17 | 예측 성공률: 54.84%
2024-09-19 18:46:46 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-19 18:46:46 - INFO - RL | 이전예측가격: 83860300 | 당시BTC가격: 83030000 | 예측: 상승 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2540 | 반영가중치값: 0.0200 | 새 가중치: 0.2740 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-19 18:46:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.90%, 적중/전체: 112/204
2024-09-19 18:46:46 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83030000 | 예측: 하락 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 204 | 예측 성공 수: 112 | 예측 성공률: 54.90%
2024-09-19 18:46:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-19 18:46:46 - INFO - PROPHET | 이전예측가격: 83077368 | 당시BTC가격: 83030000 | 예측: 상승 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0197 | 반영가중치값: 0.0200 | 새 가중치: 0.0397 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-19 18:46:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.00%, 적중/전체: 28/50
2024-09-19 18:46:46 - INFO - TRANSFORMER | 이전예측가격: 82931494 | 당시BTC가격: 83030000 | 예측: 하락 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2104 | 반영가중치값: -0.0200 | 새 가중치: 0.1904 | 예측 총 횟수: 50 | 예측 성공 수: 28 | 예측 성공률: 56.00%
2024-09-19 18:46:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 51.92%, 적중/전체: 27/52
2024-09-19 18:46:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 82252288 | 당시BTC가격: 83030000 | 예측: 하락 | 지금 BTC가격: 83271000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 52 | 예측 성공 수: 27 | 예측 성공률: 51.92%
2024-09-19 18:46:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:46:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:46:46 - INFO - 새로운 가중치: {'gpt': 0.0037740220673639275, 'ml': 0.2681645170249794, 'xgboost': 0.0783209636980883, 'rl': 0.2681645170249794, 'lstm': 0.15638457669103437, 'arima': 0.0, 'prophet': 0.03887373159796073, 'transformer': 0.1863176718955938, 'bitcoin_forecast': 0.0}
2024-09-19 18:46:46 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:46:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:46:46 - INFO - Current BTC price: 83271000.0
2024-09-19 18:46:46 - INFO - Analyzing market conditions.
2024-09-19 18:46:46 - INFO - Market analysis: {'current_price': 83271000.0, 'sma_20': 82888700.0, 'rsi_14': 65.70979455399969, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:46:46 - INFO - Starting predictions for all models
2024-09-19 18:46:46 - INFO - Attempting prediction for gpt
2024-09-19 18:46:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:46:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:46:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:46:47 - INFO - GPT prediction: 83271000.0
2024-09-19 18:46:47 - INFO - Attempting prediction for ml
2024-09-19 18:46:47 - INFO - ML prediction: 83237691.60000001
2024-09-19 18:46:47 - INFO - Attempting prediction for xgboost
2024-09-19 18:46:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:46:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:46:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:46:47 - INFO - XGBOOST prediction: 83271000.0
2024-09-19 18:46:47 - INFO - Attempting prediction for lstm
2024-09-19 18:46:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:46:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:46:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:46:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:46:47 - INFO - X 샘플:
[[-0.23720645  0.01983899  0.07034064 -0.06077532 -0.27705591 -0.27690769
  -0.06077532]
 [ 0.62362342  0.04364578  0.52124218  0.0750754  -0.77000462 -0.76735848
   0.0750754 ]
 [ 0.28885625 -0.28171365 -0.05591179 -0.56842803 -0.70169469 -0.70050043
  -0.56842803]
 [-0.47632586 -0.7499138  -0.97575093 -1.1618812  -0.2170303  -0.21937878
  -1.1618812 ]
 [-1.18411931 -1.3133411  -1.3454902  -1.20478143 -0.3356252  -0.33866191
  -1.20478143]
 [-1.71974679 -0.98798167 -1.32745414 -0.69712872 -0.41804336 -0.42070795
  -0.69712872]
 [-0.57197363  0.04364578 -0.23627241  0.1680259  -0.85191304 -0.84976924
   0.1680259 ]
 [ 0.45145744  0.1864865   0.3498996   0.375377   -0.33568059 -0.33445865
   0.375377  ]
 [ 0.98708492  0.51978152  0.99017978  0.6756786   1.8260433   1.82202008
   0.6756786 ]
 [ 1.83835002  2.51955166  2.00921727  2.3988378   2.08100441  2.08572304
   2.3988378 ]]
2024-09-19 18:46:47 - INFO - y 샘플:
[2.3988378]
2024-09-19 18:46:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:46:47 - INFO - 모델 출력 (스케일링된 예측): [[0.39148474]]
2024-09-19 18:46:47 - INFO - 스케일러 역변환 후 예측 가격: 82990252.81800646
2024-09-19 18:46:47 - INFO - LSTMPredictor 최종 예측 가격: 82990252.81800646
2024-09-19 18:46:47 - INFO - LSTM prediction: 82990252.81800646
2024-09-19 18:46:47 - INFO - Attempting prediction for rl
2024-09-19 18:46:47 - INFO - Preparing state for RL agent.
2024-09-19 18:46:47 - INFO - Prepared state: [[8.32710000e+07 2.21214170e+01 2.90256534e-03 8.28887000e+07
  6.57097946e+01]]
2024-09-19 18:46:47 - INFO - RL prediction: 84103710.0
2024-09-19 18:46:47 - INFO - Attempting prediction for arima
2024-09-19 18:46:47 - INFO - ARIMA 예측 시작
2024-09-19 18:46:47 - INFO - 입력 데이터: {'open': 83087000.0, 'high': 83282000.0, 'low': 83084000.0, 'close': 83271000.0, 'volume': 22.12141702, 'value': 1840102084.44261, 'decision': 'sell', 'sma': 82888700.0, 'ema': 82919366.59204353, 'rsi': 65.70979455399969, 'macd': 59139.09775134921, 'signal_line': 24307.824799913094, 'BB_Upper': 83128690.0831318, 'BB_Lower': 82648709.9168682}
2024-09-19 18:46:47 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:46:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82888700.0         0         0
2024-09-19 18:46:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82888700.0         0         0
2024-09-19 18:46:47 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:46:47 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:46:47 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:46:47 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:46:47 - INFO - Attempting prediction for prophet
2024-09-19 18:46:47 - INFO - PROPHET prediction: 83361741.66024019
2024-09-19 18:46:47 - INFO - Attempting prediction for transformer
2024-09-19 18:46:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:46:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:46:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:46:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:46:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:46:47 - INFO - X 샘플:
[[-0.23720645  0.01983899  0.07034064 -0.06077532 -0.27705591 -0.27690769
  -0.06077532 -0.06077532  0.          0.          0.         -0.06077532
  -0.06077532]
 [ 0.62362342  0.04364578  0.52124218  0.0750754  -0.77000462 -0.76735848
   0.0750754   0.0750754   0.          0.          0.          0.0750754
   0.0750754 ]
 [ 0.28885625 -0.28171365 -0.05591179 -0.56842803 -0.70169469 -0.70050043
  -0.56842803 -0.56842803  0.          0.          0.         -0.56842803
  -0.56842803]
 [-0.47632586 -0.7499138  -0.97575093 -1.1618812  -0.2170303  -0.21937878
  -1.1618812  -1.1618812   0.          0.          0.         -1.1618812
  -1.1618812 ]
 [-1.18411931 -1.3133411  -1.3454902  -1.20478143 -0.3356252  -0.33866191
  -1.20478143 -1.20478143  0.          0.          0.         -1.20478143
  -1.20478143]
 [-1.71974679 -0.98798167 -1.32745414 -0.69712872 -0.41804336 -0.42070795
  -0.69712872 -0.69712872  0.          0.          0.         -0.69712872
  -0.69712872]
 [-0.57197363  0.04364578 -0.23627241  0.1680259  -0.85191304 -0.84976924
   0.1680259   0.1680259   0.          0.          0.          0.1680259
   0.1680259 ]
 [ 0.45145744  0.1864865   0.3498996   0.375377   -0.33568059 -0.33445865
   0.375377    0.375377    0.          0.          0.          0.375377
   0.375377  ]
 [ 0.98708492  0.51978152  0.99017978  0.6756786   1.8260433   1.82202008
   0.6756786   0.6756786   0.          0.          0.          0.6756786
   0.6756786 ]
 [ 1.83835002  2.51955166  2.00921727  2.3988378   2.08100441  2.08572304
   2.3988378   2.3988378   0.          0.          0.          2.3988378
   2.3988378 ]]
2024-09-19 18:46:47 - INFO - y 샘플:
[2.3988378]
2024-09-19 18:46:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:46:47 - INFO - 모델 출력 (스케일링된 예측): [0.37539193]
2024-09-19 18:46:47 - INFO - 스케일러 역변환 후 예측 가격: 82988002.08776924
2024-09-19 18:46:47 - INFO - TransformerPredictor 최종 예측 가격: 82988002.08776924
2024-09-19 18:46:47 - INFO - TRANSFORMER prediction: 82988002.08776924
2024-09-19 18:46:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:46:47 - INFO - BITCOIN_FORECAST prediction: 82269259.8179107
2024-09-19 18:46:47 - INFO - BitcoinForecast prediction: 82269259.8179107
2024-09-19 18:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:46:53 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0037740220673639275, 'ml': 0.2681645170249794, 'xgboost': 0.0783209636980883, 'rl': 0.2681645170249794, 'lstm': 0.15638457669103437, 'arima': 0.0, 'prophet': 0.03887373159796073, 'transformer': 0.1863176718955938, 'bitcoin_forecast': 0.0}
2024-09-19 18:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0037740220673639275, 'ml': 0.2681645170249794, 'xgboost': 0.0783209636980883, 'rl': 0.2681645170249794, 'lstm': 0.15638457669103437, 'arima': 0.0, 'prophet': 0.03887373159796073, 'transformer': 0.1863176718955938, 'bitcoin_forecast': 0.0}
2024-09-19 18:46:53 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83392266.56954652, 'current_price': 83271000.0, 'predictions': {'gpt': 83271000.0, 'ml': 83237691.60000001, 'xgboost': 83271000.0, 'lstm': 82990252.81800646, 'rl': 84103710.0, 'arima': 80899000.0, 'prophet': 83361741.66024019, 'transformer': 82988002.08776924, 'bitcoin_forecast': 82269259.8179107}, 'weights': {'gpt': 0.0037740220673639275, 'ml': 0.2681645170249794, 'xgboost': 0.0783209636980883, 'rl': 0.2681645170249794, 'lstm': 0.15638457669103437, 'arima': 0.0, 'prophet': 0.03887373159796073, 'transformer': 0.1863176718955938, 'bitcoin_forecast': 0.0}}
2024-09-19 18:46:53 - INFO - 모델별 가중치:
2024-09-19 18:46:53 - INFO -   - GPT: 0.0038
2024-09-19 18:46:53 - INFO -   - ML: 0.2682
2024-09-19 18:46:53 - INFO -   - XGBOOST: 0.0783
2024-09-19 18:46:53 - INFO -   - RL: 0.2682
2024-09-19 18:46:53 - INFO -   - LSTM: 0.1564
2024-09-19 18:46:53 - INFO -   - ARIMA: 0.0000
2024-09-19 18:46:53 - INFO -   - PROPHET: 0.0389
2024-09-19 18:46:53 - INFO -   - TRANSFORMER: 0.1863
2024-09-19 18:46:53 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 18:46:53 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:46:53 - INFO - 6. 거래 실행
2024-09-19 18:46:53 - INFO - Cancelling existing orders.
2024-09-19 18:46:53 - INFO - Cancelled 0 orders.
2024-09-19 18:46:53 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83392266.56954652, 'current_price': 83271000.0, 'predictions': {'gpt': 83271000.0, 'ml': 83237691.60000001, 'xgboost': 83271000.0, 'lstm': 82990252.81800646, 'rl': 84103710.0, 'arima': 80899000.0, 'prophet': 83361741.66024019, 'transformer': 82988002.08776924, 'bitcoin_forecast': 82269259.8179107}, 'weights': {'gpt': 0.0037740220673639275, 'ml': 0.2681645170249794, 'xgboost': 0.0783209636980883, 'rl': 0.2681645170249794, 'lstm': 0.15638457669103437, 'arima': 0.0, 'prophet': 0.03887373159796073, 'transformer': 0.1863176718955938, 'bitcoin_forecast': 0.0}}, 현재 가격=83271000.0
2024-09-19 18:46:53 - INFO - 현재 잔고: KRW=315692.86811173, BTC=0.00193243, 총 자산가치=476608.24664172996
2024-09-19 18:46:53 - INFO - 매수 시도: 0.0005723580197688631 BTC (약 47660.824664173 KRW)
2024-09-19 18:46:54 - INFO - 주문 결과: {'uuid': '31e42e9d-9d61-462d-8a58-9f63afe49fa0', 'side': 'bid', 'ord_type': 'limit', 'price': '83271000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:46:55+09:00', 'volume': '0.00057235', 'remaining_volume': '0.00057235', 'reserved_fee': '23.830078425', 'remaining_fee': '23.830078425', 'paid_fee': '0', 'locked': '47683.986928425', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:46:54 - INFO - buy 주문 성공: UUID=31e42e9d-9d61-462d-8a58-9f63afe49fa0
2024-09-19 18:46:54 - INFO - Trade executed successfully.
2024-09-19 18:46:54 - INFO - 7. summary 리포트 보내기
2024-09-19 18:46:54 - INFO - Message sent to Discord successfully.
2024-09-19 18:46:54 - INFO - Trading cycle completed.
2024-09-19 18:46:54 - INFO - Performing periodic update.
2024-09-19 18:46:54 - INFO - 계산된 시장 변동성: 0.03714496551357199
2024-09-19 18:55:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:55:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9ada-ec4fddb21503 "HTTP/1.1 200 OK"
2024-09-19 18:55:46 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:55:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:55:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8149-b13e-cab28936d2a5 "HTTP/1.1 200 OK"
2024-09-19 18:55:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:55:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:55:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/69c187d1-538b-4151-a7fd-1d32389ad4bb "HTTP/1.1 200 OK"
2024-09-19 18:55:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8193-87fd-fcf88556d1eb "HTTP/1.1 200 OK"
2024-09-19 18:56:05 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-b1d9-f4c950048b84 "HTTP/1.1 200 OK"
2024-09-19 18:56:12 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-991b-d17bf3981215 "HTTP/1.1 200 OK"
2024-09-19 18:56:19 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/fa780a91-a1b7-425d-b414-7389cd81ab46 "HTTP/1.1 200 OK"
2024-09-19 18:56:26 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8193-8bab-fe27cdb297a4 "HTTP/1.1 200 OK"
2024-09-19 18:56:32 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 18:56:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b9-863b-e42dc2181c0d "HTTP/1.1 200 OK"
2024-09-19 18:56:37 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:45:34.933937
2024-09-19 18:56:37 - INFO - Starting trading cycle.
2024-09-19 18:56:37 - INFO - ##################################################
2024-09-19 18:56:37 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-19 18:56:37 - INFO - ##################################################
2024-09-19 18:56:37 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 18:56:37 - INFO - 데이터베이스 업데이트 시작
2024-09-19 18:56:37 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:40:00
2024-09-19 18:56:37 - INFO - 새로운 데이터 범위: 2024-09-18 09:40:00 ~ 2024-09-19 18:50:00
2024-09-19 18:56:37 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 18:56:37 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 18:56:37 - INFO - Index: Index([199], dtype='int64')
2024-09-19 18:56:37 - INFO - Date column data type: datetime64[ns]
2024-09-19 18:56:37 - INFO - Sample date values: [Timestamp('2024-09-19 18:50:00')]
2024-09-19 18:56:37 - INFO - Successfully added 1 new data points
2024-09-19 18:56:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 18:56:37 - INFO - Final date range: 2024-09-19 18:50:00 to 2024-09-19 18:50:00
2024-09-19 18:56:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 18:56:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 18:50:00
2024-09-19 18:56:38 - INFO - 데이터베이스 업데이트 완료
2024-09-19 18:56:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 18:56:38 - INFO - GPT | 이전예측가격: 83271000 | 당시BTC가격: 83271000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:56:38 - INFO - ML 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 9/12
2024-09-19 18:56:38 - INFO - ML | 이전예측가격: 83237692 | 당시BTC가격: 83271000 | 예측: 하락 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2499 | 반영가중치값: 0.0200 | 새 가중치: 0.2699 | 예측 총 횟수: 12 | 예측 성공 수: 9 | 예측 성공률: 75.00%
2024-09-19 18:56:38 - INFO - XGBOOST | 이전예측가격: 83271000 | 당시BTC가격: 83271000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 18:56:38 - INFO - LSTM 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 18/32
2024-09-19 18:56:38 - INFO - LSTM | 이전예측가격: 82990253 | 당시BTC가격: 83271000 | 예측: 하락 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1190 | 반영가중치값: 0.0200 | 새 가중치: 0.1390 | 예측 총 횟수: 32 | 예측 성공 수: 18 | 예측 성공률: 56.25%
2024-09-19 18:56:38 - INFO - RL 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-19 18:56:38 - INFO - RL | 이전예측가격: 84103710 | 당시BTC가격: 83271000 | 예측: 상승 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0472 | 반영가중치값: -0.0200 | 새 가중치: 0.0272 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-19 18:56:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.12%, 적중/전체: 113/205
2024-09-19 18:56:38 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83271000 | 예측: 하락 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1813 | 반영가중치값: 0.0200 | 새 가중치: 0.2013 | 예측 총 횟수: 205 | 예측 성공 수: 113 | 예측 성공률: 55.12%
2024-09-19 18:56:38 - INFO - PROPHET 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-19 18:56:38 - INFO - PROPHET | 이전예측가격: 83361742 | 당시BTC가격: 83271000 | 예측: 상승 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0204 | 반영가중치값: -0.0200 | 새 가중치: 0.0004 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-19 18:56:38 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.86%, 적중/전체: 29/51
2024-09-19 18:56:38 - INFO - TRANSFORMER | 이전예측가격: 82988002 | 당시BTC가격: 83271000 | 예측: 하락 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1385 | 반영가중치값: 0.0200 | 새 가중치: 0.1585 | 예측 총 횟수: 51 | 예측 성공 수: 29 | 예측 성공률: 56.86%
2024-09-19 18:56:38 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 52.83%, 적중/전체: 28/53
2024-09-19 18:56:38 - INFO - BITCOIN_FORECAST | 이전예측가격: 82269260 | 당시BTC가격: 83271000 | 예측: 하락 | 지금 BTC가격: 83249000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1598 | 반영가중치값: 0.0200 | 새 가중치: 0.1798 | 예측 총 횟수: 53 | 예측 성공 수: 28 | 예측 성공률: 52.83%
2024-09-19 18:56:38 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 18:56:38 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 18:56:38 - INFO - 새로운 가중치: {'gpt': 0.003566412792005521, 'ml': 0.2550565132147093, 'xgboost': 0.0740125208144754, 'rl': 0.025684714170877535, 'lstm': 0.1313746266402662, 'arima': 0.19020208619285994, 'prophet': 0.0004086613975240136, 'transformer': 0.1497425057351882, 'bitcoin_forecast': 0.16995195904209387}
2024-09-19 18:56:38 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 18:56:38 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 18:56:38 - INFO - Current BTC price: 83249000.0
2024-09-19 18:56:38 - INFO - Analyzing market conditions.
2024-09-19 18:56:38 - INFO - Market analysis: {'current_price': 83249000.0, 'sma_20': 82906650.0, 'rsi_14': 64.52294902098649, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 18:56:38 - INFO - Starting predictions for all models
2024-09-19 18:56:38 - INFO - Attempting prediction for gpt
2024-09-19 18:56:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 18:56:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:56:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 18:56:38 - INFO - GPT prediction: 83249000.0
2024-09-19 18:56:38 - INFO - Attempting prediction for ml
2024-09-19 18:56:38 - INFO - ML prediction: 83282299.6
2024-09-19 18:56:38 - INFO - Attempting prediction for xgboost
2024-09-19 18:56:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 18:56:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:56:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 18:56:38 - INFO - XGBOOST prediction: 83249000.0
2024-09-19 18:56:38 - INFO - Attempting prediction for lstm
2024-09-19 18:56:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:56:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:56:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 18:56:38 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:56:38 - INFO - X 샘플:
[[ 0.13918848 -0.18123861  0.13756276 -0.12889111 -0.82586146 -0.82389159
  -0.12889111]
 [-0.08025282 -0.42893138 -0.27003061 -0.66346253 -0.75743147 -0.75692872
  -0.66346253]
 [-0.58183293 -0.78536732 -0.91963256 -1.15645617 -0.27191519 -0.2750528
  -1.15645617]
 [-1.04579454 -1.2142987  -1.18074706 -1.19209426 -0.39071854 -0.39452294
  -1.19209426]
 [-1.39690062 -0.96660593 -1.16800977 -0.77037681 -0.47328157 -0.47669761
  -0.77037681]
 [-0.64453045 -0.18123861 -0.39740354 -0.05167524 -0.90791385 -0.90643155
  -0.05167524]
 [ 0.02633296 -0.07249544  0.01655848  0.12057555 -0.39077403 -0.39031309
   0.12057555]
 [ 0.37743904  0.18123861  0.46873238  0.37004221  1.7747495   1.76954642
   0.37004221]
 [ 0.93544691  1.70364296  1.18838944  1.80150568  2.03015875  2.03366279
   1.80150568]
 [ 2.27090397  1.94529444  2.12458048  1.67083266  0.21298786  0.2206291
   1.67083266]]
2024-09-19 18:56:38 - INFO - y 샘플:
[1.67083266]
2024-09-19 18:56:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 18:56:38 - INFO - 모델 출력 (스케일링된 예측): [[0.41364127]]
2024-09-19 18:56:38 - INFO - 스케일러 역변환 후 예측 가격: 83037340.30141303
2024-09-19 18:56:38 - INFO - LSTMPredictor 최종 예측 가격: 83037340.30141303
2024-09-19 18:56:38 - INFO - LSTM prediction: 83037340.30141303
2024-09-19 18:56:38 - INFO - Attempting prediction for rl
2024-09-19 18:56:38 - INFO - Preparing state for RL agent.
2024-09-19 18:56:38 - INFO - Prepared state: [[ 8.32490000e+07  1.26203342e+01 -2.64197620e-04  8.29066500e+07
   6.45229490e+01]]
2024-09-19 18:56:38 - INFO - RL prediction: 84081490.0
2024-09-19 18:56:38 - INFO - Attempting prediction for arima
2024-09-19 18:56:38 - INFO - ARIMA 예측 시작
2024-09-19 18:56:38 - INFO - 입력 데이터: {'open': 83300000.0, 'high': 83322000.0, 'low': 83231000.0, 'close': 83249000.0, 'volume': 12.62033422, 'value': 1050985207.19361, 'decision': 'sell', 'sma': 82906650.0, 'ema': 82950760.24994415, 'rsi': 64.52294902098649, 'macd': 77961.75951571763, 'signal_line': 35038.611743074005, 'BB_Upper': 83193476.27145477, 'BB_Lower': 82619823.72854523}
2024-09-19 18:56:38 - INFO - Exogenous 변수 예측 시작
2024-09-19 18:56:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82906650.0         0         0
2024-09-19 18:56:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82906650.0         0         0
2024-09-19 18:56:38 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 18:56:38 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 18:56:38 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 18:56:38 - INFO - ARIMA prediction: 80899000.0
2024-09-19 18:56:38 - INFO - Attempting prediction for prophet
2024-09-19 18:56:38 - INFO - PROPHET prediction: 83327787.51372568
2024-09-19 18:56:38 - INFO - Attempting prediction for transformer
2024-09-19 18:56:38 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 18:56:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 18:56:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 18:56:38 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 18:56:38 - INFO - X dtype: float64, y dtype: float64
2024-09-19 18:56:38 - INFO - X 샘플:
[[ 0.13918848 -0.18123861  0.13756276 -0.12889111 -0.82586146 -0.82389159
  -0.12889111 -0.12889111  0.          0.          0.         -0.12889111
  -0.12889111]
 [-0.08025282 -0.42893138 -0.27003061 -0.66346253 -0.75743147 -0.75692872
  -0.66346253 -0.66346253  0.          0.          0.         -0.66346253
  -0.66346253]
 [-0.58183293 -0.78536732 -0.91963256 -1.15645617 -0.27191519 -0.2750528
  -1.15645617 -1.15645617  0.          0.          0.         -1.15645617
  -1.15645617]
 [-1.04579454 -1.2142987  -1.18074706 -1.19209426 -0.39071854 -0.39452294
  -1.19209426 -1.19209426  0.          0.          0.         -1.19209426
  -1.19209426]
 [-1.39690062 -0.96660593 -1.16800977 -0.77037681 -0.47328157 -0.47669761
  -0.77037681 -0.77037681  0.          0.          0.         -0.77037681
  -0.77037681]
 [-0.64453045 -0.18123861 -0.39740354 -0.05167524 -0.90791385 -0.90643155
  -0.05167524 -0.05167524  0.          0.          0.         -0.05167524
  -0.05167524]
 [ 0.02633296 -0.07249544  0.01655848  0.12057555 -0.39077403 -0.39031309
   0.12057555  0.12057555  0.          0.          0.          0.12057555
   0.12057555]
 [ 0.37743904  0.18123861  0.46873238  0.37004221  1.7747495   1.76954642
   0.37004221  0.37004221  0.          0.          0.          0.37004221
   0.37004221]
 [ 0.93544691  1.70364296  1.18838944  1.80150568  2.03015875  2.03366279
   1.80150568  1.80150568  0.          0.          0.          1.80150568
   1.80150568]
 [ 2.27090397  1.94529444  2.12458048  1.67083266  0.21298786  0.2206291
   1.67083266  1.67083266  0.          0.          0.          1.67083266
   1.67083266]]
2024-09-19 18:56:38 - INFO - y 샘플:
[1.67083266]
2024-09-19 18:56:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 18:56:38 - INFO - 모델 출력 (스케일링된 예측): [0.37145987]
2024-09-19 18:56:38 - INFO - 스케일러 역변환 후 예측 가격: 83030238.6755234
2024-09-19 18:56:38 - INFO - TransformerPredictor 최종 예측 가격: 83030238.6755234
2024-09-19 18:56:38 - INFO - TRANSFORMER prediction: 83030238.6755234
2024-09-19 18:56:38 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 18:56:38 - INFO - BITCOIN_FORECAST prediction: 82224183.55256876
2024-09-19 18:56:38 - INFO - BitcoinForecast prediction: 82224183.55256876
2024-09-19 18:56:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 18:56:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 18:56:47 - INFO - 조정된 모델 가중치: {'gpt': 0.003566412792005521, 'ml': 0.2550565132147093, 'xgboost': 0.0740125208144754, 'rl': 0.025684714170877535, 'lstm': 0.1313746266402662, 'arima': 0.19020208619285994, 'prophet': 0.0004086613975240136, 'transformer': 0.1497425057351882, 'bitcoin_forecast': 0.16995195904209387}
2024-09-19 18:56:47 - INFO - 조정된 모델 가중치: {'gpt': 0.003566412792005521, 'ml': 0.2550565132147093, 'xgboost': 0.0740125208144754, 'rl': 0.025684714170877535, 'lstm': 0.1313746266402662, 'arima': 0.19020208619285994, 'prophet': 0.0004086613975240136, 'transformer': 0.1497425057351882, 'bitcoin_forecast': 0.16995195904209387}
2024-09-19 18:56:47 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82597198.69676858, 'current_price': 83249000.0, 'predictions': {'gpt': 83249000.0, 'ml': 83282299.6, 'xgboost': 83249000.0, 'lstm': 83037340.30141303, 'rl': 84081490.0, 'arima': 80899000.0, 'prophet': 83327787.51372568, 'transformer': 83030238.6755234, 'bitcoin_forecast': 82224183.55256876}, 'weights': {'gpt': 0.003566412792005521, 'ml': 0.2550565132147093, 'xgboost': 0.0740125208144754, 'rl': 0.025684714170877535, 'lstm': 0.1313746266402662, 'arima': 0.19020208619285994, 'prophet': 0.0004086613975240136, 'transformer': 0.1497425057351882, 'bitcoin_forecast': 0.16995195904209387}}
2024-09-19 18:56:47 - INFO - 모델별 가중치:
2024-09-19 18:56:47 - INFO -   - GPT: 0.0036
2024-09-19 18:56:47 - INFO -   - ML: 0.2551
2024-09-19 18:56:47 - INFO -   - XGBOOST: 0.0740
2024-09-19 18:56:47 - INFO -   - RL: 0.0257
2024-09-19 18:56:47 - INFO -   - LSTM: 0.1314
2024-09-19 18:56:47 - INFO -   - ARIMA: 0.1902
2024-09-19 18:56:47 - INFO -   - PROPHET: 0.0004
2024-09-19 18:56:47 - INFO -   - TRANSFORMER: 0.1497
2024-09-19 18:56:47 - INFO -   - BITCOIN_FORECAST: 0.1700
2024-09-19 18:56:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 18:56:47 - INFO - 6. 거래 실행
2024-09-19 18:56:47 - INFO - Cancelling existing orders.
2024-09-19 18:56:47 - INFO - Cancelled 0 orders.
2024-09-19 18:56:47 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82597198.69676858, 'current_price': 83249000.0, 'predictions': {'gpt': 83249000.0, 'ml': 83282299.6, 'xgboost': 83249000.0, 'lstm': 83037340.30141303, 'rl': 84081490.0, 'arima': 80899000.0, 'prophet': 83327787.51372568, 'transformer': 83030238.6755234, 'bitcoin_forecast': 82224183.55256876}, 'weights': {'gpt': 0.003566412792005521, 'ml': 0.2550565132147093, 'xgboost': 0.0740125208144754, 'rl': 0.025684714170877535, 'lstm': 0.1313746266402662, 'arima': 0.19020208619285994, 'prophet': 0.0004086613975240136, 'transformer': 0.1497425057351882, 'bitcoin_forecast': 0.16995195904209387}}, 현재 가격=83249000.0
2024-09-19 18:56:47 - INFO - 현재 잔고: KRW=268012.88963653, BTC=0.00250478, 총 자산가치=476533.31985653
2024-09-19 18:56:47 - INFO - 매도 시도: 0.000500956 BTC (약 41704.086043999996 KRW)
2024-09-19 18:56:47 - INFO - 주문 결과: {'uuid': '1c1f849c-6dfa-479f-8fac-be3b29a167b3', 'side': 'ask', 'ord_type': 'limit', 'price': '83249000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T18:56:49+09:00', 'volume': '0.00050095', 'remaining_volume': '0.00050095', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00050095', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 18:56:47 - INFO - sell 주문 성공: UUID=1c1f849c-6dfa-479f-8fac-be3b29a167b3
2024-09-19 18:56:47 - INFO - Trade executed successfully.
2024-09-19 18:56:47 - INFO - 7. summary 리포트 보내기
2024-09-19 18:56:48 - INFO - Message sent to Discord successfully.
2024-09-19 18:56:48 - INFO - Trading cycle completed.
2024-09-19 18:56:48 - INFO - Performing periodic update.
2024-09-19 18:56:48 - INFO - 계산된 시장 변동성: 0.036984456606213946
2024-09-19 19:05:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-8334-d83efaa9f43e "HTTP/1.1 200 OK"
2024-09-19 19:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:05:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:05:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-aadf-cc9499a5d5ba "HTTP/1.1 200 OK"
2024-09-19 19:05:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:05:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b1-8923-c3a15affd611 "HTTP/1.1 200 OK"
2024-09-19 19:05:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-b53b-edb441af8613 "HTTP/1.1 200 OK"
2024-09-19 19:06:09 - INFO - Updated actual price for lstm prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-b3be-e87ca13ab372 "HTTP/1.1 200 OK"
2024-09-19 19:06:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5be4bc9e-2385-46c1-9f94-9142b6dc6f2b "HTTP/1.1 200 OK"
2024-09-19 19:06:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d1-b19f-f91f68224b0f "HTTP/1.1 200 OK"
2024-09-19 19:06:28 - INFO - Updated actual price for prophet prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-9b51-cdaee810d55b "HTTP/1.1 200 OK"
2024-09-19 19:06:35 - INFO - Updated actual price for transformer prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:06:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-9c0d-c869555eec46 "HTTP/1.1 200 OK"
2024-09-19 19:06:44 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 18:55:34.934171
2024-09-19 19:06:44 - INFO - Starting trading cycle.
2024-09-19 19:06:44 - INFO - ##################################################
2024-09-19 19:06:44 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-19 19:06:44 - INFO - ##################################################
2024-09-19 19:06:44 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:06:44 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:06:44 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 18:50:00
2024-09-19 19:06:44 - INFO - 새로운 데이터 범위: 2024-09-18 09:50:00 ~ 2024-09-19 19:00:00
2024-09-19 19:06:44 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:06:44 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:06:44 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:06:44 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:06:44 - INFO - Sample date values: [Timestamp('2024-09-19 19:00:00')]
2024-09-19 19:06:44 - INFO - Successfully added 1 new data points
2024-09-19 19:06:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:06:44 - INFO - Final date range: 2024-09-19 19:00:00 to 2024-09-19 19:00:00
2024-09-19 19:06:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:06:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:00:00
2024-09-19 19:06:44 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:06:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:06:44 - INFO - GPT | 이전예측가격: 83249000 | 당시BTC가격: 83249000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:06:44 - INFO - ML 모델 예측 업데이트: 정확도 76.92%, 적중/전체: 10/13
2024-09-19 19:06:44 - INFO - ML | 이전예측가격: 83282300 | 당시BTC가격: 83249000 | 예측: 상승 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2682 | 반영가중치값: 0.0200 | 새 가중치: 0.2882 | 예측 총 횟수: 13 | 예측 성공 수: 10 | 예측 성공률: 76.92%
2024-09-19 19:06:44 - INFO - XGBOOST | 이전예측가격: 83249000 | 당시BTC가격: 83249000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:06:44 - INFO - LSTM 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 18/33
2024-09-19 19:06:44 - INFO - LSTM | 이전예측가격: 83037340 | 당시BTC가격: 83249000 | 예측: 하락 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1564 | 반영가중치값: -0.0200 | 새 가중치: 0.1364 | 예측 총 횟수: 33 | 예측 성공 수: 18 | 예측 성공률: 54.55%
2024-09-19 19:06:44 - INFO - RL 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 9/14
2024-09-19 19:06:44 - INFO - RL | 이전예측가격: 84081490 | 당시BTC가격: 83249000 | 예측: 상승 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2682 | 반영가중치값: 0.0200 | 새 가중치: 0.2882 | 예측 총 횟수: 14 | 예측 성공 수: 9 | 예측 성공률: 64.29%
2024-09-19 19:06:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.85%, 적중/전체: 113/206
2024-09-19 19:06:44 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83249000 | 예측: 하락 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 206 | 예측 성공 수: 113 | 예측 성공률: 54.85%
2024-09-19 19:06:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-19 19:06:44 - INFO - PROPHET | 이전예측가격: 83327788 | 당시BTC가격: 83249000 | 예측: 상승 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0389 | 반영가중치값: 0.0200 | 새 가중치: 0.0589 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-19 19:06:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.77%, 적중/전체: 29/52
2024-09-19 19:06:44 - INFO - TRANSFORMER | 이전예측가격: 83030239 | 당시BTC가격: 83249000 | 예측: 하락 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1863 | 반영가중치값: -0.0200 | 새 가중치: 0.1663 | 예측 총 횟수: 52 | 예측 성공 수: 29 | 예측 성공률: 55.77%
2024-09-19 19:06:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 51.85%, 적중/전체: 28/54
2024-09-19 19:06:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 82224184 | 당시BTC가격: 83249000 | 예측: 하락 | 지금 BTC가격: 83273000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 54 | 예측 성공 수: 28 | 예측 성공률: 51.85%
2024-09-19 19:06:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:06:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:06:44 - INFO - 새로운 가중치: {'gpt': 0.003512032661459493, 'ml': 0.2837706274310215, 'xgboost': 0.07288398893141526, 'rl': 0.2837706274310215, 'lstm': 0.13430500499884318, 'arima': 0.0, 'prophet': 0.05797603371587441, 'transformer': 0.16378168483036465, 'bitcoin_forecast': 0.0}
2024-09-19 19:06:44 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:06:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:06:44 - INFO - Current BTC price: 83300000.0
2024-09-19 19:06:44 - INFO - Analyzing market conditions.
2024-09-19 19:06:44 - INFO - Market analysis: {'current_price': 83300000.0, 'sma_20': 82927850.0, 'rsi_14': 66.05364660573998, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 19:06:44 - INFO - Starting predictions for all models
2024-09-19 19:06:44 - INFO - Attempting prediction for gpt
2024-09-19 19:06:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:06:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:06:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:06:45 - INFO - GPT prediction: 83300000.0
2024-09-19 19:06:45 - INFO - Attempting prediction for ml
2024-09-19 19:06:45 - INFO - ML prediction: 83266680.0
2024-09-19 19:06:45 - INFO - Attempting prediction for xgboost
2024-09-19 19:06:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:06:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:06:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:06:45 - INFO - XGBOOST prediction: 83300000.0
2024-09-19 19:06:45 - INFO - Attempting prediction for lstm
2024-09-19 19:06:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:06:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:06:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:06:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:06:45 - INFO - X 샘플:
[[-0.22571339 -0.55992138 -0.3939622  -0.75374582 -0.69427753 -0.69317794
  -0.75374582]
 [-0.65770075 -0.84718539 -0.94292592 -1.17904088 -0.46764532 -0.46876917
  -1.17904088]
 [-1.05728906 -1.19287598 -1.16358781 -1.2097851  -0.52310106 -0.5244062
  -1.2097851 ]
 [-1.35968021 -0.99325184 -1.15282381 -0.84597848 -0.56164033 -0.5626748
  -0.84597848]
 [-0.71169917 -0.36029723 -0.50160214 -0.22597002 -0.7645206  -0.76280115
  -0.22597002]
 [-0.13391608 -0.27265737 -0.15177232 -0.07737296 -0.52312697 -0.52244568
  -0.07737296]
 [ 0.16847507 -0.06816434  0.23034948  0.13783659  0.48770911  0.48339711
   0.13783659]
 [ 0.64906101  1.15879381  0.83851517  1.37272947  0.60693057  0.60639564
   1.37272947]
 [ 1.79922735  1.35354907  1.62966877  1.26000066 -0.24129936 -0.23793097
   1.26000066]
 [ 1.52923525  1.78201065  1.60814078  1.52132654  2.68097149  2.68241316
   1.52132654]]
2024-09-19 19:06:45 - INFO - y 샘플:
[1.52132654]
2024-09-19 19:06:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:06:45 - INFO - 모델 출력 (스케일링된 예측): [[0.43055028]]
2024-09-19 19:06:45 - INFO - 스케일러 역변환 후 예측 가격: 83087125.60129845
2024-09-19 19:06:45 - INFO - LSTMPredictor 최종 예측 가격: 83087125.60129845
2024-09-19 19:06:45 - INFO - LSTM prediction: 83087125.60129845
2024-09-19 19:06:45 - INFO - Attempting prediction for rl
2024-09-19 19:06:45 - INFO - Preparing state for RL agent.
2024-09-19 19:06:45 - INFO - Prepared state: [[8.33000000e+07 4.53528945e+01 6.12619971e-04 8.29278500e+07
  6.60536466e+01]]
2024-09-19 19:06:45 - INFO - RL prediction: 84133000.0
2024-09-19 19:06:45 - INFO - Attempting prediction for arima
2024-09-19 19:06:45 - INFO - ARIMA 예측 시작
2024-09-19 19:06:45 - INFO - 입력 데이터: {'open': 83250000.0, 'high': 83410000.0, 'low': 83227000.0, 'close': 83300000.0, 'volume': 45.35289451, 'value': 3780370727.3703, 'decision': 'sell', 'sma': 82927850.0, 'ema': 82984021.17852089, 'rsi': 66.05364660573998, 'macd': 95888.78215713799, 'signal_line': 47208.64582588681, 'BB_Upper': 83261359.38515872, 'BB_Lower': 82594340.61484128}
2024-09-19 19:06:45 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:06:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82927850.0         0         0
2024-09-19 19:06:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82927850.0         0         0
2024-09-19 19:06:45 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:06:45 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:06:45 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:06:45 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:06:45 - INFO - Attempting prediction for prophet
2024-09-19 19:06:45 - INFO - PROPHET prediction: 83405138.6996296
2024-09-19 19:06:45 - INFO - Attempting prediction for transformer
2024-09-19 19:06:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:06:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:06:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:06:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:06:45 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:06:45 - INFO - X 샘플:
[[-0.22571339 -0.55992138 -0.3939622  -0.75374582 -0.69427753 -0.69317794
  -0.75374582 -0.75374582  0.          0.          0.         -0.75374582
  -0.75374582]
 [-0.65770075 -0.84718539 -0.94292592 -1.17904088 -0.46764532 -0.46876917
  -1.17904088 -1.17904088  0.          0.          0.         -1.17904088
  -1.17904088]
 [-1.05728906 -1.19287598 -1.16358781 -1.2097851  -0.52310106 -0.5244062
  -1.2097851  -1.2097851   0.          0.          0.         -1.2097851
  -1.2097851 ]
 [-1.35968021 -0.99325184 -1.15282381 -0.84597848 -0.56164033 -0.5626748
  -0.84597848 -0.84597848  0.          0.          0.         -0.84597848
  -0.84597848]
 [-0.71169917 -0.36029723 -0.50160214 -0.22597002 -0.7645206  -0.76280115
  -0.22597002 -0.22597002  0.          0.          0.         -0.22597002
  -0.22597002]
 [-0.13391608 -0.27265737 -0.15177232 -0.07737296 -0.52312697 -0.52244568
  -0.07737296 -0.07737296  0.          0.          0.         -0.07737296
  -0.07737296]
 [ 0.16847507 -0.06816434  0.23034948  0.13783659  0.48770911  0.48339711
   0.13783659  0.13783659  0.          0.          0.          0.13783659
   0.13783659]
 [ 0.64906101  1.15879381  0.83851517  1.37272947  0.60693057  0.60639564
   1.37272947  1.37272947  0.          0.          0.          1.37272947
   1.37272947]
 [ 1.79922735  1.35354907  1.62966877  1.26000066 -0.24129936 -0.23793097
   1.26000066  1.26000066  0.          0.          0.          1.26000066
   1.26000066]
 [ 1.52923525  1.78201065  1.60814078  1.52132654  2.68097149  2.68241316
   1.52132654  1.52132654  0.          0.          0.          1.52132654
   1.52132654]]
2024-09-19 19:06:45 - INFO - y 샘플:
[1.52132654]
2024-09-19 19:06:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:06:45 - INFO - 모델 출력 (스케일링된 예측): [0.37330845]
2024-09-19 19:06:45 - INFO - 스케일러 역변환 후 예측 가격: 83075954.36484037
2024-09-19 19:06:45 - INFO - TransformerPredictor 최종 예측 가격: 83075954.36484037
2024-09-19 19:06:45 - INFO - TRANSFORMER prediction: 83075954.36484037
2024-09-19 19:06:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:06:45 - INFO - BITCOIN_FORECAST prediction: 82420482.35092099
2024-09-19 19:06:45 - INFO - BitcoinForecast prediction: 82420482.35092099
2024-09-19 19:06:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:06:52 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:06:52 - INFO - 조정된 모델 가중치: {'gpt': 0.003512032661459493, 'ml': 0.2837706274310215, 'xgboost': 0.07288398893141526, 'rl': 0.2837706274310215, 'lstm': 0.13430500499884318, 'arima': 0.0, 'prophet': 0.05797603371587441, 'transformer': 0.16378168483036465, 'bitcoin_forecast': 0.0}
2024-09-19 19:06:52 - INFO - 조정된 모델 가중치: {'gpt': 0.003512032661459493, 'ml': 0.2837706274310215, 'xgboost': 0.07288398893141526, 'rl': 0.2837706274310215, 'lstm': 0.13430500499884318, 'arima': 0.0, 'prophet': 0.05797603371587441, 'transformer': 0.16378168483036465, 'bitcoin_forecast': 0.0}
2024-09-19 19:06:52 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83467736.55135153, 'current_price': 83300000.0, 'predictions': {'gpt': 83300000.0, 'ml': 83266680.0, 'xgboost': 83300000.0, 'lstm': 83087125.60129845, 'rl': 84133000.0, 'arima': 80899000.0, 'prophet': 83405138.6996296, 'transformer': 83075954.36484037, 'bitcoin_forecast': 82420482.35092099}, 'weights': {'gpt': 0.003512032661459493, 'ml': 0.2837706274310215, 'xgboost': 0.07288398893141526, 'rl': 0.2837706274310215, 'lstm': 0.13430500499884318, 'arima': 0.0, 'prophet': 0.05797603371587441, 'transformer': 0.16378168483036465, 'bitcoin_forecast': 0.0}}
2024-09-19 19:06:52 - INFO - 모델별 가중치:
2024-09-19 19:06:52 - INFO -   - GPT: 0.0035
2024-09-19 19:06:52 - INFO -   - ML: 0.2838
2024-09-19 19:06:52 - INFO -   - XGBOOST: 0.0729
2024-09-19 19:06:52 - INFO -   - RL: 0.2838
2024-09-19 19:06:52 - INFO -   - LSTM: 0.1343
2024-09-19 19:06:52 - INFO -   - ARIMA: 0.0000
2024-09-19 19:06:52 - INFO -   - PROPHET: 0.0580
2024-09-19 19:06:52 - INFO -   - TRANSFORMER: 0.1638
2024-09-19 19:06:52 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 19:06:52 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:06:52 - INFO - 6. 거래 실행
2024-09-19 19:06:52 - INFO - Cancelling existing orders.
2024-09-19 19:06:52 - INFO - Cancelled 0 orders.
2024-09-19 19:06:52 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83467736.55135153, 'current_price': 83300000.0, 'predictions': {'gpt': 83300000.0, 'ml': 83266680.0, 'xgboost': 83300000.0, 'lstm': 83087125.60129845, 'rl': 84133000.0, 'arima': 80899000.0, 'prophet': 83405138.6996296, 'transformer': 83075954.36484037, 'bitcoin_forecast': 82420482.35092099}, 'weights': {'gpt': 0.003512032661459493, 'ml': 0.2837706274310215, 'xgboost': 0.07288398893141526, 'rl': 0.2837706274310215, 'lstm': 0.13430500499884318, 'arima': 0.0, 'prophet': 0.05797603371587441, 'transformer': 0.16378168483036465, 'bitcoin_forecast': 0.0}}, 현재 가격=83300000.0
2024-09-19 19:06:52 - INFO - 현재 잔고: KRW=309695.62439326, BTC=0.00200383, 총 자산가치=476614.66339326
2024-09-19 19:06:52 - INFO - 매수 시도: 0.0005721664626569747 BTC (약 47661.466339326 KRW)
2024-09-19 19:06:52 - INFO - 주문 결과: {'uuid': '2055e9f7-c2f5-4bd3-9c59-f806820786f4', 'side': 'bid', 'ord_type': 'limit', 'price': '83300000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:06:54+09:00', 'volume': '0.00057216', 'remaining_volume': '0.00057216', 'reserved_fee': '23.830464', 'remaining_fee': '23.830464', 'paid_fee': '0', 'locked': '47684.758464', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:06:52 - INFO - buy 주문 성공: UUID=2055e9f7-c2f5-4bd3-9c59-f806820786f4
2024-09-19 19:06:52 - INFO - Trade executed successfully.
2024-09-19 19:06:52 - INFO - 7. summary 리포트 보내기
2024-09-19 19:06:52 - INFO - Message sent to Discord successfully.
2024-09-19 19:06:52 - INFO - Trading cycle completed.
2024-09-19 19:06:52 - INFO - Performing periodic update.
2024-09-19 19:06:52 - INFO - 계산된 시장 변동성: 0.03693481939978607
2024-09-19 19:15:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:15:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-b001-e29d65f72eed "HTTP/1.1 200 OK"
2024-09-19 19:15:44 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:15:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:15:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8176-aa93-f1f49b598723 "HTTP/1.1 200 OK"
2024-09-19 19:15:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:15:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:15:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812d-8dff-e5f1b8305247 "HTTP/1.1 200 OK"
2024-09-19 19:15:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:16:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:16:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/cf3c4082-f681-4f0f-b980-219182bd2795 "HTTP/1.1 200 OK"
2024-09-19 19:16:24 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:16:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:16:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8177-87f6-d23adb0ac1a2 "HTTP/1.1 200 OK"
2024-09-19 19:16:30 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:16:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-a5ca-e4ddade25544 "HTTP/1.1 200 OK"
2024-09-19 19:16:36 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:16:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/9e89e910-bbbd-44b7-8865-99cf2cf20386 "HTTP/1.1 200 OK"
2024-09-19 19:16:43 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:17:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8144-8440-c188e07ba0a9 "HTTP/1.1 200 OK"
2024-09-19 19:17:06 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:17:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:17:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814d-a7f8-c5934bda96ee "HTTP/1.1 200 OK"
2024-09-19 19:17:15 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:05:34.934508
2024-09-19 19:17:15 - INFO - Starting trading cycle.
2024-09-19 19:17:15 - INFO - ##################################################
2024-09-19 19:17:15 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-19 19:17:15 - INFO - ##################################################
2024-09-19 19:17:15 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:17:15 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:17:15 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:00:00
2024-09-19 19:17:15 - INFO - 새로운 데이터 범위: 2024-09-18 10:00:00 ~ 2024-09-19 19:10:00
2024-09-19 19:17:15 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:17:15 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:17:15 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:17:15 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:17:15 - INFO - Sample date values: [Timestamp('2024-09-19 19:10:00')]
2024-09-19 19:17:15 - INFO - Successfully added 1 new data points
2024-09-19 19:17:15 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:17:15 - INFO - Final date range: 2024-09-19 19:10:00 to 2024-09-19 19:10:00
2024-09-19 19:17:15 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:17:15 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:10:00
2024-09-19 19:17:15 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:17:15 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:17:15 - INFO - GPT | 이전예측가격: 83300000 | 당시BTC가격: 83300000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:17:15 - INFO - ML 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 10/14
2024-09-19 19:17:15 - INFO - ML | 이전예측가격: 83266680 | 당시BTC가격: 83300000 | 예측: 하락 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2551 | 반영가중치값: -0.0200 | 새 가중치: 0.2351 | 예측 총 횟수: 14 | 예측 성공 수: 10 | 예측 성공률: 71.43%
2024-09-19 19:17:15 - INFO - XGBOOST | 이전예측가격: 83300000 | 당시BTC가격: 83300000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:17:15 - INFO - LSTM 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 18/34
2024-09-19 19:17:15 - INFO - LSTM | 이전예측가격: 83087126 | 당시BTC가격: 83300000 | 예측: 하락 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1314 | 반영가중치값: -0.0200 | 새 가중치: 0.1114 | 예측 총 횟수: 34 | 예측 성공 수: 18 | 예측 성공률: 52.94%
2024-09-19 19:17:15 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 10/15
2024-09-19 19:17:15 - INFO - RL | 이전예측가격: 84133000 | 당시BTC가격: 83300000 | 예측: 상승 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0257 | 반영가중치값: 0.0200 | 새 가중치: 0.0457 | 예측 총 횟수: 15 | 예측 성공 수: 10 | 예측 성공률: 66.67%
2024-09-19 19:17:15 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.59%, 적중/전체: 113/207
2024-09-19 19:17:15 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83300000 | 예측: 하락 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1902 | 반영가중치값: -0.0200 | 새 가중치: 0.1702 | 예측 총 횟수: 207 | 예측 성공 수: 113 | 예측 성공률: 54.59%
2024-09-19 19:17:15 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 7/11
2024-09-19 19:17:15 - INFO - PROPHET | 이전예측가격: 83405139 | 당시BTC가격: 83300000 | 예측: 상승 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0004 | 반영가중치값: 0.0200 | 새 가중치: 0.0204 | 예측 총 횟수: 11 | 예측 성공 수: 7 | 예측 성공률: 63.64%
2024-09-19 19:17:15 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.72%, 적중/전체: 29/53
2024-09-19 19:17:15 - INFO - TRANSFORMER | 이전예측가격: 83075954 | 당시BTC가격: 83300000 | 예측: 하락 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1497 | 반영가중치값: -0.0200 | 새 가중치: 0.1297 | 예측 총 횟수: 53 | 예측 성공 수: 29 | 예측 성공률: 54.72%
2024-09-19 19:17:15 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.91%, 적중/전체: 28/55
2024-09-19 19:17:15 - INFO - BITCOIN_FORECAST | 이전예측가격: 82420482 | 당시BTC가격: 83300000 | 예측: 하락 | 지금 BTC가격: 83357000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1700 | 반영가중치값: -0.0200 | 새 가중치: 0.1500 | 예측 총 횟수: 55 | 예측 성공 수: 28 | 예측 성공률: 50.91%
2024-09-19 19:17:15 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:17:15 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:17:15 - INFO - 새로운 가중치: {'gpt': 0.0037409125871283593, 'ml': 0.25037519685423104, 'xgboost': 0.07763385420235508, 'rl': 0.04866199684207243, 'lstm': 0.11863293506847665, 'arima': 0.18129419284209564, 'prophet': 0.02173869826048564, 'transformer': 0.1381978528037493, 'bitcoin_forecast': 0.15972436053940586}
2024-09-19 19:17:15 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:17:15 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:17:15 - INFO - Current BTC price: 83357000.0
2024-09-19 19:17:15 - INFO - Analyzing market conditions.
2024-09-19 19:17:15 - INFO - Market analysis: {'current_price': 83357000.0, 'sma_20': 82960600.0, 'rsi_14': 67.72950337093498, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 19:17:15 - INFO - Starting predictions for all models
2024-09-19 19:17:15 - INFO - Attempting prediction for gpt
2024-09-19 19:17:16 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:17:16 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:17:16 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:17:16 - INFO - GPT prediction: 83357000.0
2024-09-19 19:17:16 - INFO - Attempting prediction for ml
2024-09-19 19:17:16 - INFO - ML prediction: 83273643.0
2024-09-19 19:17:16 - INFO - Attempting prediction for xgboost
2024-09-19 19:17:16 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:17:16 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:17:16 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:17:16 - INFO - XGBOOST prediction: 83357000.0
2024-09-19 19:17:16 - INFO - Attempting prediction for lstm
2024-09-19 19:17:16 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:17:16 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:17:16 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:17:16 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:17:16 - INFO - X 샘플:
[[-0.74188609 -0.95682454 -1.01720723 -1.30732681 -0.64466232 -0.64573368
  -1.30732681]
 [-1.05328467 -1.25104083 -1.20431129 -1.33532096 -0.69738662 -0.69858746
  -1.33532096]
 [-1.28893766 -1.08114128 -1.19518426 -1.00405685 -0.73402765 -0.73494167
  -1.00405685]
 [-0.78396698 -0.54243539 -0.64299909 -0.43950816 -0.92691516 -0.92505666
  -0.43950816]
 [-0.33370146 -0.46784534 -0.3463707  -0.3042031  -0.69741124 -0.69672501
  -0.3042031 ]
 [-0.09804847 -0.2938019  -0.02236122 -0.10824405  0.26363667  0.25880034
  -0.10824405]
 [ 0.27647145  0.75045874  0.49331584  1.01618765  0.37698595  0.37564585
   1.01618765]
 [ 1.1727944   0.9162144   1.16415237  0.91354244 -0.4294649  -0.4264432
   0.91354244]
 [ 0.96238995  1.28087685  1.14589832  1.15149271  2.34887116  2.34781026
   1.15149271]
 [ 1.88816953  1.64553929  1.62506726  1.41743714  1.14037412  1.14523122
   1.41743714]]
2024-09-19 19:17:16 - INFO - y 샘플:
[1.41743714]
2024-09-19 19:17:16 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:17:16 - INFO - 모델 출력 (스케일링된 예측): [[0.43495536]]
2024-09-19 19:17:16 - INFO - 스케일러 역변환 후 예측 가격: 83146424.19618842
2024-09-19 19:17:16 - INFO - LSTMPredictor 최종 예측 가격: 83146424.19618842
2024-09-19 19:17:16 - INFO - LSTM prediction: 83146424.19618842
2024-09-19 19:17:16 - INFO - Attempting prediction for rl
2024-09-19 19:17:16 - INFO - Preparing state for RL agent.
2024-09-19 19:17:16 - INFO - Prepared state: [[8.33570000e+07 3.11151632e+01 6.84273709e-04 8.29606000e+07
  6.77295034e+01]]
2024-09-19 19:17:16 - INFO - RL prediction: 84190570.0
2024-09-19 19:17:16 - INFO - Attempting prediction for arima
2024-09-19 19:17:16 - INFO - ARIMA 예측 시작
2024-09-19 19:17:16 - INFO - 입력 데이터: {'open': 83470000.0, 'high': 83498000.0, 'low': 83332000.0, 'close': 83357000.0, 'volume': 31.11516325, 'value': 2597240972.70982, 'decision': 'sell', 'sma': 82960600.0, 'ema': 83019542.97104271, 'rsi': 67.72950337093498, 'macd': 113388.42915931344, 'signal_line': 60444.602492572136, 'BB_Upper': 83326073.0633051, 'BB_Lower': 82595126.9366949}
2024-09-19 19:17:16 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:17:16 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82960600.0         0         0
2024-09-19 19:17:16 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82960600.0         0         0
2024-09-19 19:17:16 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:17:16 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:17:16 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:17:16 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:17:16 - INFO - Attempting prediction for prophet
2024-09-19 19:17:16 - INFO - PROPHET prediction: 83462991.38370553
2024-09-19 19:17:16 - INFO - Attempting prediction for transformer
2024-09-19 19:17:16 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:17:16 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:17:16 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:17:16 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:17:16 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:17:16 - INFO - X 샘플:
[[-0.74188609 -0.95682454 -1.01720723 -1.30732681 -0.64466232 -0.64573368
  -1.30732681 -1.30732681  0.          0.          0.         -1.30732681
  -1.30732681]
 [-1.05328467 -1.25104083 -1.20431129 -1.33532096 -0.69738662 -0.69858746
  -1.33532096 -1.33532096  0.          0.          0.         -1.33532096
  -1.33532096]
 [-1.28893766 -1.08114128 -1.19518426 -1.00405685 -0.73402765 -0.73494167
  -1.00405685 -1.00405685  0.          0.          0.         -1.00405685
  -1.00405685]
 [-0.78396698 -0.54243539 -0.64299909 -0.43950816 -0.92691516 -0.92505666
  -0.43950816 -0.43950816  0.          0.          0.         -0.43950816
  -0.43950816]
 [-0.33370146 -0.46784534 -0.3463707  -0.3042031  -0.69741124 -0.69672501
  -0.3042031  -0.3042031   0.          0.          0.         -0.3042031
  -0.3042031 ]
 [-0.09804847 -0.2938019  -0.02236122 -0.10824405  0.26363667  0.25880034
  -0.10824405 -0.10824405  0.          0.          0.         -0.10824405
  -0.10824405]
 [ 0.27647145  0.75045874  0.49331584  1.01618765  0.37698595  0.37564585
   1.01618765  1.01618765  0.          0.          0.          1.01618765
   1.01618765]
 [ 1.1727944   0.9162144   1.16415237  0.91354244 -0.4294649  -0.4264432
   0.91354244  0.91354244  0.          0.          0.          0.91354244
   0.91354244]
 [ 0.96238995  1.28087685  1.14589832  1.15149271  2.34887116  2.34781026
   1.15149271  1.15149271  0.          0.          0.          1.15149271
   1.15149271]
 [ 1.88816953  1.64553929  1.62506726  1.41743714  1.14037412  1.14523122
   1.41743714  1.41743714  0.          0.          0.          1.41743714
   1.41743714]]
2024-09-19 19:17:16 - INFO - y 샘플:
[1.41743714]
2024-09-19 19:17:16 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:17:16 - INFO - 모델 출력 (스케일링된 예측): [0.3725113]
2024-09-19 19:17:16 - INFO - 스케일러 역변환 후 예측 가격: 83133040.52983406
2024-09-19 19:17:16 - INFO - TransformerPredictor 최종 예측 가격: 83133040.52983406
2024-09-19 19:17:16 - INFO - TRANSFORMER prediction: 83133040.52983406
2024-09-19 19:17:16 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:17:16 - INFO - BITCOIN_FORECAST prediction: 82321389.49083321
2024-09-19 19:17:16 - INFO - BitcoinForecast prediction: 82321389.49083321
2024-09-19 19:17:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:19 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:21 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:21 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:27 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:28 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:17:28 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:17:28 - INFO - 조정된 모델 가중치: {'gpt': 0.0037409125871283593, 'ml': 0.25037519685423104, 'xgboost': 0.07763385420235508, 'rl': 0.04866199684207243, 'lstm': 0.11863293506847665, 'arima': 0.18129419284209564, 'prophet': 0.02173869826048564, 'transformer': 0.1381978528037493, 'bitcoin_forecast': 0.15972436053940586}
2024-09-19 19:17:28 - INFO - 조정된 모델 가중치: {'gpt': 0.0037409125871283593, 'ml': 0.25037519685423104, 'xgboost': 0.07763385420235508, 'rl': 0.04866199684207243, 'lstm': 0.11863293506847665, 'arima': 0.18129419284209564, 'prophet': 0.02173869826048564, 'transformer': 0.1381978528037493, 'bitcoin_forecast': 0.15972436053940586}
2024-09-19 19:17:28 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82712031.47422905, 'current_price': 83357000.0, 'predictions': {'gpt': 83357000.0, 'ml': 83273643.0, 'xgboost': 83357000.0, 'lstm': 83146424.19618842, 'rl': 84190570.0, 'arima': 80899000.0, 'prophet': 83462991.38370553, 'transformer': 83133040.52983406, 'bitcoin_forecast': 82321389.49083321}, 'weights': {'gpt': 0.0037409125871283593, 'ml': 0.25037519685423104, 'xgboost': 0.07763385420235508, 'rl': 0.04866199684207243, 'lstm': 0.11863293506847665, 'arima': 0.18129419284209564, 'prophet': 0.02173869826048564, 'transformer': 0.1381978528037493, 'bitcoin_forecast': 0.15972436053940586}}
2024-09-19 19:17:28 - INFO - 모델별 가중치:
2024-09-19 19:17:28 - INFO -   - GPT: 0.0037
2024-09-19 19:17:28 - INFO -   - ML: 0.2504
2024-09-19 19:17:28 - INFO -   - XGBOOST: 0.0776
2024-09-19 19:17:28 - INFO -   - RL: 0.0487
2024-09-19 19:17:28 - INFO -   - LSTM: 0.1186
2024-09-19 19:17:28 - INFO -   - ARIMA: 0.1813
2024-09-19 19:17:28 - INFO -   - PROPHET: 0.0217
2024-09-19 19:17:28 - INFO -   - TRANSFORMER: 0.1382
2024-09-19 19:17:28 - INFO -   - BITCOIN_FORECAST: 0.1597
2024-09-19 19:17:28 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:17:28 - INFO - 6. 거래 실행
2024-09-19 19:17:28 - INFO - Cancelling existing orders.
2024-09-19 19:17:28 - INFO - Cancelled 0 orders.
2024-09-19 19:17:28 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82712031.47422905, 'current_price': 83357000.0, 'predictions': {'gpt': 83357000.0, 'ml': 83273643.0, 'xgboost': 83357000.0, 'lstm': 83146424.19618842, 'rl': 84190570.0, 'arima': 80899000.0, 'prophet': 83462991.38370553, 'transformer': 83133040.52983406, 'bitcoin_forecast': 82321389.49083321}, 'weights': {'gpt': 0.0037409125871283593, 'ml': 0.25037519685423104, 'xgboost': 0.07763385420235508, 'rl': 0.04866199684207243, 'lstm': 0.11863293506847665, 'arima': 0.18129419284209564, 'prophet': 0.02173869826048564, 'transformer': 0.1381978528037493, 'bitcoin_forecast': 0.15972436053940586}}, 현재 가격=83357000.0
2024-09-19 19:17:28 - INFO - 현재 잔고: KRW=262036.62600286, BTC=0.00257599, 총 자산가치=476763.42443286
2024-09-19 19:17:28 - INFO - 매도 시도: 0.000515198 BTC (약 42945.359686 KRW)
2024-09-19 19:17:28 - INFO - 주문 결과: {'uuid': 'a6ba6d9a-cab8-4446-9aeb-90cc1707c946', 'side': 'ask', 'ord_type': 'limit', 'price': '83357000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:17:28+09:00', 'volume': '0.00051519', 'remaining_volume': '0.00051519', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00051519', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:17:28 - INFO - sell 주문 성공: UUID=a6ba6d9a-cab8-4446-9aeb-90cc1707c946
2024-09-19 19:17:28 - INFO - Trade executed successfully.
2024-09-19 19:17:28 - INFO - 7. summary 리포트 보내기
2024-09-19 19:17:29 - INFO - Message sent to Discord successfully.
2024-09-19 19:17:29 - INFO - Trading cycle completed.
2024-09-19 19:17:29 - INFO - Performing periodic update.
2024-09-19 19:17:29 - INFO - 계산된 시장 변동성: 0.03690900059824102
2024-09-19 19:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-bc34-d1636f3b9ac1 "HTTP/1.1 200 OK"
2024-09-19 19:25:54 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8105-bd9f-f52c11bf3864 "HTTP/1.1 200 OK"
2024-09-19 19:26:04 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811d-a10a-d74feb7be953 "HTTP/1.1 200 OK"
2024-09-19 19:26:11 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e4-bab6-ff0bc5193c1c "HTTP/1.1 200 OK"
2024-09-19 19:26:19 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ad-9544-fb7dae827bcd "HTTP/1.1 200 OK"
2024-09-19 19:26:27 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f2-aeca-e419d08feb0b "HTTP/1.1 200 OK"
2024-09-19 19:26:37 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8143-a4e1-e1208b340d03 "HTTP/1.1 200 OK"
2024-09-19 19:26:44 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:26:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-82dc-c5b9630dcdf2 "HTTP/1.1 200 OK"
2024-09-19 19:26:51 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:27:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8154-862b-e10ae406a4e6 "HTTP/1.1 200 OK"
2024-09-19 19:27:04 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:15:34.934993
2024-09-19 19:27:04 - INFO - Starting trading cycle.
2024-09-19 19:27:04 - INFO - ##################################################
2024-09-19 19:27:04 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-19 19:27:04 - INFO - ##################################################
2024-09-19 19:27:04 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:27:04 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:27:04 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:10:00
2024-09-19 19:27:04 - INFO - 새로운 데이터 범위: 2024-09-18 10:10:00 ~ 2024-09-19 19:20:00
2024-09-19 19:27:04 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:27:04 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:27:04 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:27:04 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:27:04 - INFO - Sample date values: [Timestamp('2024-09-19 19:20:00')]
2024-09-19 19:27:04 - INFO - Successfully added 1 new data points
2024-09-19 19:27:04 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:27:04 - INFO - Final date range: 2024-09-19 19:20:00 to 2024-09-19 19:20:00
2024-09-19 19:27:04 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:27:04 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:20:00
2024-09-19 19:27:04 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:27:04 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:27:04 - INFO - GPT | 이전예측가격: 83357000 | 당시BTC가격: 83357000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:27:04 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 10/15
2024-09-19 19:27:04 - INFO - ML | 이전예측가격: 83273643 | 당시BTC가격: 83357000 | 예측: 하락 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2838 | 반영가중치값: -0.0200 | 새 가중치: 0.2638 | 예측 총 횟수: 15 | 예측 성공 수: 10 | 예측 성공률: 66.67%
2024-09-19 19:27:04 - INFO - XGBOOST | 이전예측가격: 83357000 | 당시BTC가격: 83357000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:27:04 - INFO - LSTM 모델 예측 업데이트: 정확도 51.43%, 적중/전체: 18/35
2024-09-19 19:27:04 - INFO - LSTM | 이전예측가격: 83146424 | 당시BTC가격: 83357000 | 예측: 하락 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1343 | 반영가중치값: -0.0200 | 새 가중치: 0.1143 | 예측 총 횟수: 35 | 예측 성공 수: 18 | 예측 성공률: 51.43%
2024-09-19 19:27:04 - INFO - RL 모델 예측 업데이트: 정확도 68.75%, 적중/전체: 11/16
2024-09-19 19:27:04 - INFO - RL | 이전예측가격: 84190570 | 당시BTC가격: 83357000 | 예측: 상승 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2838 | 반영가중치값: 0.0200 | 새 가중치: 0.3038 | 예측 총 횟수: 16 | 예측 성공 수: 11 | 예측 성공률: 68.75%
2024-09-19 19:27:04 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.33%, 적중/전체: 113/208
2024-09-19 19:27:04 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83357000 | 예측: 하락 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 208 | 예측 성공 수: 113 | 예측 성공률: 54.33%
2024-09-19 19:27:04 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-19 19:27:04 - INFO - PROPHET | 이전예측가격: 83462991 | 당시BTC가격: 83357000 | 예측: 상승 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0580 | 반영가중치값: 0.0200 | 새 가중치: 0.0780 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-19 19:27:04 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.70%, 적중/전체: 29/54
2024-09-19 19:27:04 - INFO - TRANSFORMER | 이전예측가격: 83133041 | 당시BTC가격: 83357000 | 예측: 하락 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1638 | 반영가중치값: -0.0200 | 새 가중치: 0.1438 | 예측 총 횟수: 54 | 예측 성공 수: 29 | 예측 성공률: 53.70%
2024-09-19 19:27:04 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 28/56
2024-09-19 19:27:04 - INFO - BITCOIN_FORECAST | 이전예측가격: 82321389 | 당시BTC가격: 83357000 | 예측: 하락 | 지금 BTC가격: 83475000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 56 | 예측 성공 수: 28 | 예측 성공률: 50.00%
2024-09-19 19:27:05 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:27:05 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:27:05 - INFO - 새로운 가중치: {'gpt': 0.00379796275338068, 'ml': 0.2677932175870161, 'xgboost': 0.0788177964051994, 'rl': 0.3084032309452391, 'lstm': 0.11604819449786918, 'arima': 0.0, 'prophet': 0.07916519427057267, 'transformer': 0.14597440354072294, 'bitcoin_forecast': 0.0}
2024-09-19 19:27:05 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:27:05 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:27:05 - INFO - Current BTC price: 83475000.0
2024-09-19 19:27:05 - INFO - Analyzing market conditions.
2024-09-19 19:27:05 - INFO - Market analysis: {'current_price': 83475000.0, 'sma_20': 82992250.0, 'rsi_14': 70.9290923707815, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 19:27:05 - INFO - Starting predictions for all models
2024-09-19 19:27:05 - INFO - Attempting prediction for gpt
2024-09-19 19:27:07 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:27:07 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:27:07 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:27:07 - INFO - GPT prediction: 83475000.0
2024-09-19 19:27:07 - INFO - Attempting prediction for ml
2024-09-19 19:27:07 - INFO - ML prediction: 83625255.0
2024-09-19 19:27:07 - INFO - Attempting prediction for xgboost
2024-09-19 19:27:07 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:27:07 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:27:07 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:27:07 - INFO - XGBOOST prediction: 83475000.0
2024-09-19 19:27:07 - INFO - Attempting prediction for lstm
2024-09-19 19:27:07 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:27:07 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:27:07 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:27:07 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:27:07 - INFO - X 샘플:
[[-1.2135411  -1.43983491 -1.41435415 -1.57894239 -0.76052188 -0.76237807
  -1.57894239]
 [-1.44044694 -1.27711928 -1.40549783 -1.26439438 -0.79793606 -0.79950548
  -1.26439438]
 [-0.95422013 -0.76119166 -0.86969053 -0.72833369 -0.99489357 -0.99366394
  -0.72833369]
 [-0.52066788 -0.68975553 -0.58186016 -0.59985634 -0.76054703 -0.76047602
  -0.59985634]
 [-0.29376203 -0.52307123 -0.26746083 -0.41378569  0.22077935  0.21537193
  -0.41378569]
 [ 0.06685619  0.47703461  0.23292119  0.65390543  0.33652034  0.33470257
   0.65390543]
 [ 0.92990879  0.63578157  0.88386064  0.55643985 -0.48694692 -0.48444571
   0.55643985]
 [ 0.72731428  0.98502488  0.866148    0.78238279  2.35001307  2.34881198
   0.78238279]
 [ 1.61873011  1.33426818  1.33110475  1.03490724  1.11601629  1.12065588
   1.03490724]
 [ 1.07982872  1.25886338  1.22482892  1.55767717 -0.22248358 -0.21907312
   1.55767717]]
2024-09-19 19:27:07 - INFO - y 샘플:
[1.55767717]
2024-09-19 19:27:07 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:27:07 - INFO - 모델 출력 (스케일링된 예측): [[0.430802]]
2024-09-19 19:27:07 - INFO - 스케일러 역변환 후 예측 가격: 83220640.93154918
2024-09-19 19:27:07 - INFO - LSTMPredictor 최종 예측 가격: 83220640.93154918
2024-09-19 19:27:07 - INFO - LSTM prediction: 83220640.93154918
2024-09-19 19:27:07 - INFO - Attempting prediction for rl
2024-09-19 19:27:07 - INFO - Preparing state for RL agent.
2024-09-19 19:27:07 - INFO - Prepared state: [[8.34750000e+07 1.56716857e+01 1.41559797e-03 8.29922500e+07
  7.09290924e+01]]
2024-09-19 19:27:07 - INFO - RL prediction: 84309750.0
2024-09-19 19:27:07 - INFO - Attempting prediction for arima
2024-09-19 19:27:07 - INFO - ARIMA 예측 시작
2024-09-19 19:27:07 - INFO - 입력 데이터: {'open': 83337000.0, 'high': 83479000.0, 'low': 83308000.0, 'close': 83475000.0, 'volume': 15.67168573, 'value': 1306628776.4501, 'decision': 'sell', 'sma': 82992250.0, 'ema': 83062919.8309434, 'rsi': 70.9290923707815, 'macd': 135219.90838713944, 'signal_line': 75399.6636714856, 'BB_Upper': 83416127.28177105, 'BB_Lower': 82568372.71822895}
2024-09-19 19:27:07 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:27:07 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  82992250.0         0         0
2024-09-19 19:27:07 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  82992250.0         0         0
2024-09-19 19:27:07 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:27:07 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:27:07 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:27:07 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:27:07 - INFO - Attempting prediction for prophet
2024-09-19 19:27:07 - INFO - PROPHET prediction: 83589544.18182033
2024-09-19 19:27:07 - INFO - Attempting prediction for transformer
2024-09-19 19:27:07 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:27:07 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:27:07 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:27:07 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:27:07 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:27:07 - INFO - X 샘플:
[[-1.2135411  -1.43983491 -1.41435415 -1.57894239 -0.76052188 -0.76237807
  -1.57894239 -1.57894239  0.          0.          0.         -1.57894239
  -1.57894239]
 [-1.44044694 -1.27711928 -1.40549783 -1.26439438 -0.79793606 -0.79950548
  -1.26439438 -1.26439438  0.          0.          0.         -1.26439438
  -1.26439438]
 [-0.95422013 -0.76119166 -0.86969053 -0.72833369 -0.99489357 -0.99366394
  -0.72833369 -0.72833369  0.          0.          0.         -0.72833369
  -0.72833369]
 [-0.52066788 -0.68975553 -0.58186016 -0.59985634 -0.76054703 -0.76047602
  -0.59985634 -0.59985634  0.          0.          0.         -0.59985634
  -0.59985634]
 [-0.29376203 -0.52307123 -0.26746083 -0.41378569  0.22077935  0.21537193
  -0.41378569 -0.41378569  0.          0.          0.         -0.41378569
  -0.41378569]
 [ 0.06685619  0.47703461  0.23292119  0.65390543  0.33652034  0.33470257
   0.65390543  0.65390543  0.          0.          0.          0.65390543
   0.65390543]
 [ 0.92990879  0.63578157  0.88386064  0.55643985 -0.48694692 -0.48444571
   0.55643985  0.55643985  0.          0.          0.          0.55643985
   0.55643985]
 [ 0.72731428  0.98502488  0.866148    0.78238279  2.35001307  2.34881198
   0.78238279  0.78238279  0.          0.          0.          0.78238279
   0.78238279]
 [ 1.61873011  1.33426818  1.33110475  1.03490724  1.11601629  1.12065588
   1.03490724  1.03490724  0.          0.          0.          1.03490724
   1.03490724]
 [ 1.07982872  1.25886338  1.22482892  1.55767717 -0.22248358 -0.21907312
   1.55767717  1.55767717  0.          0.          0.          1.55767717
   1.55767717]]
2024-09-19 19:27:07 - INFO - y 샘플:
[1.55767717]
2024-09-19 19:27:07 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:27:07 - INFO - 모델 출력 (스케일링된 예측): [0.37320387]
2024-09-19 19:27:07 - INFO - 스케일러 역변환 후 예측 가격: 83207639.84422192
2024-09-19 19:27:07 - INFO - TransformerPredictor 최종 예측 가격: 83207639.84422192
2024-09-19 19:27:07 - INFO - TRANSFORMER prediction: 83207639.84422192
2024-09-19 19:27:07 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:27:07 - INFO - BITCOIN_FORECAST prediction: 82260706.13309968
2024-09-19 19:27:08 - INFO - BitcoinForecast prediction: 82260706.13309968
2024-09-19 19:27:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:27:15 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:27:15 - INFO - 조정된 모델 가중치: {'gpt': 0.00379796275338068, 'ml': 0.2677932175870161, 'xgboost': 0.0788177964051994, 'rl': 0.3084032309452391, 'lstm': 0.11604819449786918, 'arima': 0.0, 'prophet': 0.07916519427057267, 'transformer': 0.14597440354072294, 'bitcoin_forecast': 0.0}
2024-09-19 19:27:15 - INFO - 조정된 모델 가중치: {'gpt': 0.00379796275338068, 'ml': 0.2677932175870161, 'xgboost': 0.0788177964051994, 'rl': 0.3084032309452391, 'lstm': 0.11604819449786918, 'arima': 0.0, 'prophet': 0.07916519427057267, 'transformer': 0.14597440354072294, 'bitcoin_forecast': 0.0}
2024-09-19 19:27:15 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83713199.12942831, 'current_price': 83475000.0, 'predictions': {'gpt': 83475000.0, 'ml': 83625255.0, 'xgboost': 83475000.0, 'lstm': 83220640.93154918, 'rl': 84309750.0, 'arima': 80899000.0, 'prophet': 83589544.18182033, 'transformer': 83207639.84422192, 'bitcoin_forecast': 82260706.13309968}, 'weights': {'gpt': 0.00379796275338068, 'ml': 0.2677932175870161, 'xgboost': 0.0788177964051994, 'rl': 0.3084032309452391, 'lstm': 0.11604819449786918, 'arima': 0.0, 'prophet': 0.07916519427057267, 'transformer': 0.14597440354072294, 'bitcoin_forecast': 0.0}}
2024-09-19 19:27:15 - INFO - 모델별 가중치:
2024-09-19 19:27:15 - INFO -   - GPT: 0.0038
2024-09-19 19:27:15 - INFO -   - ML: 0.2678
2024-09-19 19:27:15 - INFO -   - XGBOOST: 0.0788
2024-09-19 19:27:15 - INFO -   - RL: 0.3084
2024-09-19 19:27:15 - INFO -   - LSTM: 0.1160
2024-09-19 19:27:15 - INFO -   - ARIMA: 0.0000
2024-09-19 19:27:15 - INFO -   - PROPHET: 0.0792
2024-09-19 19:27:15 - INFO -   - TRANSFORMER: 0.1460
2024-09-19 19:27:15 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 19:27:15 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:27:16 - INFO - 6. 거래 실행
2024-09-19 19:27:16 - INFO - Cancelling existing orders.
2024-09-19 19:27:16 - INFO - Cancelled 0 orders.
2024-09-19 19:27:16 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83713199.12942831, 'current_price': 83475000.0, 'predictions': {'gpt': 83475000.0, 'ml': 83625255.0, 'xgboost': 83475000.0, 'lstm': 83220640.93154918, 'rl': 84309750.0, 'arima': 80899000.0, 'prophet': 83589544.18182033, 'transformer': 83207639.84422192, 'bitcoin_forecast': 82260706.13309968}, 'weights': {'gpt': 0.00379796275338068, 'ml': 0.2677932175870161, 'xgboost': 0.0788177964051994, 'rl': 0.3084032309452391, 'lstm': 0.11604819449786918, 'arima': 0.0, 'prophet': 0.07916519427057267, 'transformer': 0.14597440354072294, 'bitcoin_forecast': 0.0}}, 현재 가격=83475000.0
2024-09-19 19:27:16 - INFO - 현재 잔고: KRW=304966.0256753, BTC=0.0020608, 총 자산가치=476991.30567529995
2024-09-19 19:27:16 - INFO - 매수 시도: 0.000571418155945253 BTC (약 47699.130567529995 KRW)
2024-09-19 19:27:16 - INFO - 주문 결과: {'uuid': '78594591-e040-45e2-9f77-539a372cb001', 'side': 'bid', 'ord_type': 'limit', 'price': '83475000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:27:16+09:00', 'volume': '0.00057141', 'remaining_volume': '0.00057141', 'reserved_fee': '23.849224875', 'remaining_fee': '23.849224875', 'paid_fee': '0', 'locked': '47722.298974875', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:27:16 - INFO - buy 주문 성공: UUID=78594591-e040-45e2-9f77-539a372cb001
2024-09-19 19:27:16 - INFO - Trade executed successfully.
2024-09-19 19:27:16 - INFO - 7. summary 리포트 보내기
2024-09-19 19:27:16 - INFO - Message sent to Discord successfully.
2024-09-19 19:27:16 - INFO - Trading cycle completed.
2024-09-19 19:27:16 - INFO - Performing periodic update.
2024-09-19 19:27:16 - INFO - 계산된 시장 변동성: 0.0369511044130928
2024-09-19 19:35:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:35:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b6-a066-d82035cfd630 "HTTP/1.1 200 OK"
2024-09-19 19:35:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:35:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:35:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-a0ac-d77ac9489b0e "HTTP/1.1 200 OK"
2024-09-19 19:35:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:35:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:35:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ac-a537-ee2d7fe171ed "HTTP/1.1 200 OK"
2024-09-19 19:35:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a05627ce-fc25-4b1f-b084-09285277da02 "HTTP/1.1 200 OK"
2024-09-19 19:36:03 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8dbadffb-8a3a-4f4f-a53d-ca5e5e3d575f "HTTP/1.1 200 OK"
2024-09-19 19:36:08 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813e-a73d-fb3581c5f575 "HTTP/1.1 200 OK"
2024-09-19 19:36:18 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-8e96-e3f4b7697ebb "HTTP/1.1 200 OK"
2024-09-19 19:36:23 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8196-9f85-cecc5a35ae85 "HTTP/1.1 200 OK"
2024-09-19 19:36:31 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:36:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-a239-fb26f45f4245 "HTTP/1.1 200 OK"
2024-09-19 19:36:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:25:34.935185
2024-09-19 19:36:43 - INFO - Starting trading cycle.
2024-09-19 19:36:43 - INFO - ##################################################
2024-09-19 19:36:43 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-19 19:36:43 - INFO - ##################################################
2024-09-19 19:36:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:36:43 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:36:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:20:00
2024-09-19 19:36:43 - INFO - 새로운 데이터 범위: 2024-09-18 10:20:00 ~ 2024-09-19 19:30:00
2024-09-19 19:36:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:36:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:36:43 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:36:43 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:36:43 - INFO - Sample date values: [Timestamp('2024-09-19 19:30:00')]
2024-09-19 19:36:43 - INFO - Successfully added 1 new data points
2024-09-19 19:36:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:36:43 - INFO - Final date range: 2024-09-19 19:30:00 to 2024-09-19 19:30:00
2024-09-19 19:36:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:36:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:30:00
2024-09-19 19:36:43 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:36:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:36:43 - INFO - GPT | 이전예측가격: 83475000 | 당시BTC가격: 83475000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:36:43 - INFO - ML 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 10/16
2024-09-19 19:36:43 - INFO - ML | 이전예측가격: 83625255 | 당시BTC가격: 83475000 | 예측: 상승 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2504 | 반영가중치값: -0.0200 | 새 가중치: 0.2304 | 예측 총 횟수: 16 | 예측 성공 수: 10 | 예측 성공률: 62.50%
2024-09-19 19:36:43 - INFO - XGBOOST | 이전예측가격: 83475000 | 당시BTC가격: 83475000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:36:43 - INFO - LSTM 모델 예측 업데이트: 정확도 52.78%, 적중/전체: 19/36
2024-09-19 19:36:43 - INFO - LSTM | 이전예측가격: 83220641 | 당시BTC가격: 83475000 | 예측: 하락 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1186 | 반영가중치값: 0.0200 | 새 가중치: 0.1386 | 예측 총 횟수: 36 | 예측 성공 수: 19 | 예측 성공률: 52.78%
2024-09-19 19:36:43 - INFO - RL 모델 예측 업데이트: 정확도 64.71%, 적중/전체: 11/17
2024-09-19 19:36:43 - INFO - RL | 이전예측가격: 84309750 | 당시BTC가격: 83475000 | 예측: 상승 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0487 | 반영가중치값: -0.0200 | 새 가중치: 0.0287 | 예측 총 횟수: 17 | 예측 성공 수: 11 | 예측 성공률: 64.71%
2024-09-19 19:36:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 114/209
2024-09-19 19:36:43 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83475000 | 예측: 하락 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1813 | 반영가중치값: 0.0200 | 새 가중치: 0.2013 | 예측 총 횟수: 209 | 예측 성공 수: 114 | 예측 성공률: 54.55%
2024-09-19 19:36:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-19 19:36:43 - INFO - PROPHET | 이전예측가격: 83589544 | 당시BTC가격: 83475000 | 예측: 상승 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0217 | 반영가중치값: -0.0200 | 새 가중치: 0.0017 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-19 19:36:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 30/55
2024-09-19 19:36:43 - INFO - TRANSFORMER | 이전예측가격: 83207640 | 당시BTC가격: 83475000 | 예측: 하락 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1382 | 반영가중치값: 0.0200 | 새 가중치: 0.1582 | 예측 총 횟수: 55 | 예측 성공 수: 30 | 예측 성공률: 54.55%
2024-09-19 19:36:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.88%, 적중/전체: 29/57
2024-09-19 19:36:43 - INFO - BITCOIN_FORECAST | 이전예측가격: 82260706 | 당시BTC가격: 83475000 | 예측: 하락 | 지금 BTC가격: 83319000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1597 | 반영가중치값: 0.0200 | 새 가중치: 0.1797 | 예측 총 횟수: 57 | 예측 성공 수: 29 | 예측 성공률: 50.88%
2024-09-19 19:36:43 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:36:43 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:36:43 - INFO - 새로운 가중치: {'gpt': 0.0037189681786764994, 'ml': 0.2255835777995963, 'xgboost': 0.07717844954730635, 'rl': 0.028065850329393575, 'lstm': 0.13574948137057544, 'arima': 0.19710743531272581, 'prophet': 0.0017025347332094171, 'transformer': 0.15490746453171503, 'bitcoin_forecast': 0.17598623819680156}
2024-09-19 19:36:43 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:36:43 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:36:43 - INFO - Current BTC price: 83319000.0
2024-09-19 19:36:43 - INFO - Analyzing market conditions.
2024-09-19 19:36:43 - INFO - Market analysis: {'current_price': 83319000.0, 'sma_20': 83020850.0, 'rsi_14': 62.15518254415638, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 19:36:43 - INFO - Starting predictions for all models
2024-09-19 19:36:43 - INFO - Attempting prediction for gpt
2024-09-19 19:36:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:36:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:36:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:36:44 - INFO - GPT prediction: 83319000.0
2024-09-19 19:36:44 - INFO - Attempting prediction for ml
2024-09-19 19:36:44 - INFO - ML prediction: 83269008.6
2024-09-19 19:36:44 - INFO - Attempting prediction for xgboost
2024-09-19 19:36:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:36:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:36:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:36:44 - INFO - XGBOOST prediction: 83319000.0
2024-09-19 19:36:44 - INFO - Attempting prediction for lstm
2024-09-19 19:36:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:36:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:36:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:36:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:36:44 - INFO - X 샘플:
[[-1.62143617 -1.59198568 -1.78004262 -1.72410639 -0.96448209 -0.96655607
  -1.72410639]
 [-1.1776124  -1.07895113 -1.20842596 -1.11160823 -1.16261832 -1.16185266
  -1.11160823]
 [-0.78186954 -1.00791558 -0.90135916 -0.96481115 -0.9268693  -0.92729782
  -0.96481115]
 [-0.57475178 -0.84216595 -0.56594773 -0.75220849  0.06032999  0.05427042
  -0.75220849]
 [-0.24558249  0.1523318  -0.03212391  0.46772587  0.17676365  0.17430056
   0.46772587]
 [ 0.5422047   0.31018858  0.66231947  0.35636257 -0.65163178 -0.64964946
   0.35636257]
 [ 0.35727813  0.65747351  0.64342305  0.61452295  2.20230644  2.20021641
   0.61452295]
 [ 1.17095504  1.00475844  1.13945403  0.90305514  0.96092462  0.96486102
   0.90305514]
 [ 0.67905037  0.92977647  1.02607552  1.5003674  -0.38558572 -0.38272129
   1.5003674 ]
 [ 1.65176413  1.46648954  1.01662731  0.71070035  0.69086252  0.69442889
   0.71070035]]
2024-09-19 19:36:44 - INFO - y 샘플:
[0.71070035]
2024-09-19 19:36:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:36:44 - INFO - 모델 출력 (스케일링된 예측): [[0.42801768]]
2024-09-19 19:36:44 - INFO - 스케일러 역변환 후 예측 가격: 83263155.58247979
2024-09-19 19:36:44 - INFO - LSTMPredictor 최종 예측 가격: 83263155.58247979
2024-09-19 19:36:44 - INFO - LSTM prediction: 83263155.58247979
2024-09-19 19:36:44 - INFO - Attempting prediction for rl
2024-09-19 19:36:44 - INFO - Preparing state for RL agent.
2024-09-19 19:36:44 - INFO - Prepared state: [[ 8.33190000e+07  2.80177508e+01 -1.86882300e-03  8.30208500e+07
   6.21551825e+01]]
2024-09-19 19:36:44 - INFO - RL prediction: 84152190.0
2024-09-19 19:36:44 - INFO - Attempting prediction for arima
2024-09-19 19:36:44 - INFO - ARIMA 예측 시작
2024-09-19 19:36:44 - INFO - 입력 데이터: {'open': 83600000.0, 'high': 83615000.0, 'low': 83306000.0, 'close': 83319000.0, 'volume': 28.01775081, 'value': 2338241578.14057, 'decision': 'sell', 'sma': 83020850.0, 'ema': 83087308.4184726, 'rsi': 62.15518254415638, 'macd': 138338.93161819875, 'signal_line': 87987.51726082823, 'BB_Upper': 83451806.73797171, 'BB_Lower': 82589893.26202829}
2024-09-19 19:36:44 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:36:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83020850.0         0         0
2024-09-19 19:36:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83020850.0         0         0
2024-09-19 19:36:44 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:36:44 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:36:44 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:36:44 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:36:44 - INFO - Attempting prediction for prophet
2024-09-19 19:36:44 - INFO - PROPHET prediction: 83392287.27623303
2024-09-19 19:36:44 - INFO - Attempting prediction for transformer
2024-09-19 19:36:44 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:36:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:36:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:36:44 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:36:44 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:36:44 - INFO - X 샘플:
[[-1.62143617 -1.59198568 -1.78004262 -1.72410639 -0.96448209 -0.96655607
  -1.72410639 -1.72410639  0.          0.          0.         -1.72410639
  -1.72410639]
 [-1.1776124  -1.07895113 -1.20842596 -1.11160823 -1.16261832 -1.16185266
  -1.11160823 -1.11160823  0.          0.          0.         -1.11160823
  -1.11160823]
 [-0.78186954 -1.00791558 -0.90135916 -0.96481115 -0.9268693  -0.92729782
  -0.96481115 -0.96481115  0.          0.          0.         -0.96481115
  -0.96481115]
 [-0.57475178 -0.84216595 -0.56594773 -0.75220849  0.06032999  0.05427042
  -0.75220849 -0.75220849  0.          0.          0.         -0.75220849
  -0.75220849]
 [-0.24558249  0.1523318  -0.03212391  0.46772587  0.17676365  0.17430056
   0.46772587  0.46772587  0.          0.          0.          0.46772587
   0.46772587]
 [ 0.5422047   0.31018858  0.66231947  0.35636257 -0.65163178 -0.64964946
   0.35636257  0.35636257  0.          0.          0.          0.35636257
   0.35636257]
 [ 0.35727813  0.65747351  0.64342305  0.61452295  2.20230644  2.20021641
   0.61452295  0.61452295  0.          0.          0.          0.61452295
   0.61452295]
 [ 1.17095504  1.00475844  1.13945403  0.90305514  0.96092462  0.96486102
   0.90305514  0.90305514  0.          0.          0.          0.90305514
   0.90305514]
 [ 0.67905037  0.92977647  1.02607552  1.5003674  -0.38558572 -0.38272129
   1.5003674   1.5003674   0.          0.          0.          1.5003674
   1.5003674 ]
 [ 1.65176413  1.46648954  1.01662731  0.71070035  0.69086252  0.69442889
   0.71070035  0.71070035  0.          0.          0.          0.71070035
   0.71070035]]
2024-09-19 19:36:44 - INFO - y 샘플:
[0.71070035]
2024-09-19 19:36:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:36:44 - INFO - 모델 출력 (스케일링된 예측): [0.3727333]
2024-09-19 19:36:44 - INFO - 스케일러 역변환 후 예측 가격: 83252234.06382862
2024-09-19 19:36:44 - INFO - TransformerPredictor 최종 예측 가격: 83252234.06382862
2024-09-19 19:36:44 - INFO - TRANSFORMER prediction: 83252234.06382862
2024-09-19 19:36:44 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:36:44 - INFO - BITCOIN_FORECAST prediction: 82374802.6674625
2024-09-19 19:36:44 - INFO - BitcoinForecast prediction: 82374802.6674625
2024-09-19 19:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:36:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:36:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0037189681786764994, 'ml': 0.2255835777995963, 'xgboost': 0.07717844954730635, 'rl': 0.028065850329393575, 'lstm': 0.13574948137057544, 'arima': 0.19710743531272581, 'prophet': 0.0017025347332094171, 'transformer': 0.15490746453171503, 'bitcoin_forecast': 0.17598623819680156}
2024-09-19 19:36:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0037189681786764994, 'ml': 0.2255835777995963, 'xgboost': 0.07717844954730635, 'rl': 0.028065850329393575, 'lstm': 0.13574948137057544, 'arima': 0.19710743531272581, 'prophet': 0.0017025347332094171, 'transformer': 0.15490746453171503, 'bitcoin_forecast': 0.17598623819680156}
2024-09-19 19:36:54 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82670142.59836729, 'current_price': 83319000.0, 'predictions': {'gpt': 83319000.0, 'ml': 83269008.6, 'xgboost': 83319000.0, 'lstm': 83263155.58247979, 'rl': 84152190.0, 'arima': 80899000.0, 'prophet': 83392287.27623303, 'transformer': 83252234.06382862, 'bitcoin_forecast': 82374802.6674625}, 'weights': {'gpt': 0.0037189681786764994, 'ml': 0.2255835777995963, 'xgboost': 0.07717844954730635, 'rl': 0.028065850329393575, 'lstm': 0.13574948137057544, 'arima': 0.19710743531272581, 'prophet': 0.0017025347332094171, 'transformer': 0.15490746453171503, 'bitcoin_forecast': 0.17598623819680156}}
2024-09-19 19:36:54 - INFO - 모델별 가중치:
2024-09-19 19:36:54 - INFO -   - GPT: 0.0037
2024-09-19 19:36:54 - INFO -   - ML: 0.2256
2024-09-19 19:36:54 - INFO -   - XGBOOST: 0.0772
2024-09-19 19:36:54 - INFO -   - RL: 0.0281
2024-09-19 19:36:54 - INFO -   - LSTM: 0.1357
2024-09-19 19:36:54 - INFO -   - ARIMA: 0.1971
2024-09-19 19:36:54 - INFO -   - PROPHET: 0.0017
2024-09-19 19:36:54 - INFO -   - TRANSFORMER: 0.1549
2024-09-19 19:36:54 - INFO -   - BITCOIN_FORECAST: 0.1760
2024-09-19 19:36:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:36:54 - INFO - 6. 거래 실행
2024-09-19 19:36:54 - INFO - Cancelling existing orders.
2024-09-19 19:36:54 - INFO - Cancelled 0 orders.
2024-09-19 19:36:54 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82670142.59836729, 'current_price': 83319000.0, 'predictions': {'gpt': 83319000.0, 'ml': 83269008.6, 'xgboost': 83319000.0, 'lstm': 83263155.58247979, 'rl': 84152190.0, 'arima': 80899000.0, 'prophet': 83392287.27623303, 'transformer': 83252234.06382862, 'bitcoin_forecast': 82374802.6674625}, 'weights': {'gpt': 0.0037189681786764994, 'ml': 0.2255835777995963, 'xgboost': 0.07717844954730635, 'rl': 0.028065850329393575, 'lstm': 0.13574948137057544, 'arima': 0.19710743531272581, 'prophet': 0.0017025347332094171, 'transformer': 0.15490746453171503, 'bitcoin_forecast': 0.17598623819680156}}, 현재 가격=83319000.0
2024-09-19 19:36:54 - INFO - 현재 잔고: KRW=257243.72670043, BTC=0.00263221, 총 자산가치=476556.83169043
2024-09-19 19:36:54 - INFO - 매도 시도: 0.000526442 BTC (약 43862.620998 KRW)
2024-09-19 19:36:54 - INFO - 주문 결과: {'uuid': 'a9e3129f-ff42-4ee2-9cf9-81fd916138c8', 'side': 'ask', 'ord_type': 'limit', 'price': '83319000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:36:54+09:00', 'volume': '0.00052644', 'remaining_volume': '0.00052644', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00052644', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:36:54 - INFO - sell 주문 성공: UUID=a9e3129f-ff42-4ee2-9cf9-81fd916138c8
2024-09-19 19:36:54 - INFO - Trade executed successfully.
2024-09-19 19:36:54 - INFO - 7. summary 리포트 보내기
2024-09-19 19:36:54 - INFO - Message sent to Discord successfully.
2024-09-19 19:36:54 - INFO - Trading cycle completed.
2024-09-19 19:36:54 - INFO - Performing periodic update.
2024-09-19 19:36:54 - INFO - 계산된 시장 변동성: 0.03595210849678417
2024-09-19 19:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-b30b-f634e8946589 "HTTP/1.1 200 OK"
2024-09-19 19:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:45:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:45:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813d-8073-e746765cce7e "HTTP/1.1 200 OK"
2024-09-19 19:45:55 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8179-adaf-d26ab613ca41 "HTTP/1.1 200 OK"
2024-09-19 19:46:01 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b1-88e0-dfb5a596c9e7 "HTTP/1.1 200 OK"
2024-09-19 19:46:06 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/63afd3e0-ea4f-4409-89a2-a37cb69bb0bf "HTTP/1.1 200 OK"
2024-09-19 19:46:12 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-a93c-e043a770fd1b "HTTP/1.1 200 OK"
2024-09-19 19:46:17 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8123-8c1e-c2bb622eba86 "HTTP/1.1 200 OK"
2024-09-19 19:46:25 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/b015213a-1683-4aef-815a-a4343a20652b "HTTP/1.1 200 OK"
2024-09-19 19:46:34 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:46:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8180-9dac-c6e95d03d8a8 "HTTP/1.1 200 OK"
2024-09-19 19:46:41 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:35:34.935274
2024-09-19 19:46:41 - INFO - Starting trading cycle.
2024-09-19 19:46:41 - INFO - ##################################################
2024-09-19 19:46:41 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-19 19:46:41 - INFO - ##################################################
2024-09-19 19:46:41 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:46:41 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:46:41 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:30:00
2024-09-19 19:46:41 - INFO - 새로운 데이터 범위: 2024-09-18 10:30:00 ~ 2024-09-19 19:40:00
2024-09-19 19:46:41 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:46:41 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:46:41 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:46:41 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:46:41 - INFO - Sample date values: [Timestamp('2024-09-19 19:40:00')]
2024-09-19 19:46:41 - INFO - Successfully added 1 new data points
2024-09-19 19:46:41 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:46:41 - INFO - Final date range: 2024-09-19 19:40:00 to 2024-09-19 19:40:00
2024-09-19 19:46:41 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:46:41 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:40:00
2024-09-19 19:46:41 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:46:41 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:46:41 - INFO - GPT | 이전예측가격: 83319000 | 당시BTC가격: 83319000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:46:41 - INFO - ML 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 10/17
2024-09-19 19:46:41 - INFO - ML | 이전예측가격: 83269009 | 당시BTC가격: 83319000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2678 | 반영가중치값: -0.0200 | 새 가중치: 0.2478 | 예측 총 횟수: 17 | 예측 성공 수: 10 | 예측 성공률: 58.82%
2024-09-19 19:46:41 - INFO - XGBOOST | 이전예측가격: 83319000 | 당시BTC가격: 83319000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:46:41 - INFO - LSTM 모델 예측 업데이트: 정확도 51.35%, 적중/전체: 19/37
2024-09-19 19:46:41 - INFO - LSTM | 이전예측가격: 83263156 | 당시BTC가격: 83319000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1160 | 반영가중치값: -0.0200 | 새 가중치: 0.0960 | 예측 총 횟수: 37 | 예측 성공 수: 19 | 예측 성공률: 51.35%
2024-09-19 19:46:41 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 12/18
2024-09-19 19:46:41 - INFO - RL | 이전예측가격: 84152190 | 당시BTC가격: 83319000 | 예측: 상승 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3084 | 반영가중치값: 0.0200 | 새 가중치: 0.3284 | 예측 총 횟수: 18 | 예측 성공 수: 12 | 예측 성공률: 66.67%
2024-09-19 19:46:41 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.29%, 적중/전체: 114/210
2024-09-19 19:46:41 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83319000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 210 | 예측 성공 수: 114 | 예측 성공률: 54.29%
2024-09-19 19:46:41 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 9/14
2024-09-19 19:46:41 - INFO - PROPHET | 이전예측가격: 83392287 | 당시BTC가격: 83319000 | 예측: 상승 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0792 | 반영가중치값: 0.0200 | 새 가중치: 0.0992 | 예측 총 횟수: 14 | 예측 성공 수: 9 | 예측 성공률: 64.29%
2024-09-19 19:46:41 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.57%, 적중/전체: 30/56
2024-09-19 19:46:41 - INFO - TRANSFORMER | 이전예측가격: 83252234 | 당시BTC가격: 83319000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1460 | 반영가중치값: -0.0200 | 새 가중치: 0.1260 | 예측 총 횟수: 56 | 예측 성공 수: 30 | 예측 성공률: 53.57%
2024-09-19 19:46:41 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 29/58
2024-09-19 19:46:42 - INFO - BITCOIN_FORECAST | 이전예측가격: 82374803 | 당시BTC가격: 83319000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 58 | 예측 성공 수: 29 | 예측 성공률: 50.00%
2024-09-19 19:46:42 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:46:42 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:46:42 - INFO - 새로운 가중치: {'gpt': 0.00380153112971837, 'ml': 0.2532943507802087, 'xgboost': 0.07889184967479262, 'rl': 0.33569394669644864, 'lstm': 0.09818051238793775, 'arima': 0.0, 'prophet': 0.10136671111241147, 'transformer': 0.12877109821848245, 'bitcoin_forecast': 0.0}
2024-09-19 19:46:42 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:46:42 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:46:42 - INFO - Current BTC price: 83340000.0
2024-09-19 19:46:42 - INFO - Analyzing market conditions.
2024-09-19 19:46:42 - INFO - Market analysis: {'current_price': 83340000.0, 'sma_20': 83044000.0, 'rsi_14': 62.821890211164686, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 19:46:42 - INFO - Starting predictions for all models
2024-09-19 19:46:42 - INFO - Attempting prediction for gpt
2024-09-19 19:46:42 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:46:42 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:46:42 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:46:42 - INFO - GPT prediction: 83340000.0
2024-09-19 19:46:42 - INFO - Attempting prediction for ml
2024-09-19 19:46:42 - INFO - ML prediction: 83406672.0
2024-09-19 19:46:42 - INFO - Attempting prediction for xgboost
2024-09-19 19:46:42 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:46:42 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:46:42 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:46:42 - INFO - XGBOOST prediction: 83340000.0
2024-09-19 19:46:42 - INFO - Attempting prediction for lstm
2024-09-19 19:46:42 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:46:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:46:42 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:46:42 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:46:42 - INFO - X 샘플:
[[-1.64733436 -1.51669267 -1.76523728 -1.62663702 -1.22894008 -1.22922561
  -1.62663702]
 [-1.18445417 -1.43408913 -1.40201973 -1.45179464 -0.98659565 -0.98800297
  -1.45179464]
 [-0.94219912 -1.24134755 -1.00527441 -1.19857464  0.0282219   0.02146879
  -1.19857464]
 [-0.55718662 -0.08489808 -0.37383468  0.2544258   0.14791295  0.14491108
   0.2544258 ]
 [ 0.36424778  0.09866533  0.44759578  0.12178676 -0.70365799 -0.70246177
   0.12178676]
 [ 0.14794862  0.50250483  0.42524393  0.42926818  2.2301231   2.22841862
   0.42926818]
 [ 1.0996649   0.90634433  1.01197997  0.77292389  0.9540119   0.95794519
   0.77292389]
 [ 0.52430915  0.81915171  0.87786887  1.4843515  -0.43016892 -0.4279455
   1.4843515 ]
 [ 1.6620427   1.4432673   0.86669295  0.54382009  0.67639445  0.67982535
   0.54382009]
 [ 0.53296112  0.50709392  0.91698461  0.67043008 -0.68730164 -0.68493318
   0.67043008]]
2024-09-19 19:46:42 - INFO - y 샘플:
[0.67043008]
2024-09-19 19:46:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:46:42 - INFO - 모델 출력 (스케일링된 예측): [[0.41769177]]
2024-09-19 19:46:42 - INFO - 스케일러 역변환 후 예측 가격: 83298079.89318404
2024-09-19 19:46:42 - INFO - LSTMPredictor 최종 예측 가격: 83298079.89318404
2024-09-19 19:46:42 - INFO - LSTM prediction: 83298079.89318404
2024-09-19 19:46:42 - INFO - Attempting prediction for rl
2024-09-19 19:46:42 - INFO - Preparing state for RL agent.
2024-09-19 19:46:42 - INFO - Prepared state: [[8.33400000e+07 1.28028240e+01 2.52043351e-04 8.30440000e+07
  6.28218902e+01]]
2024-09-19 19:46:42 - INFO - RL prediction: 84173400.0
2024-09-19 19:46:42 - INFO - Attempting prediction for arima
2024-09-19 19:46:42 - INFO - ARIMA 예측 시작
2024-09-19 19:46:42 - INFO - 입력 데이터: {'open': 83339000.0, 'high': 83411000.0, 'low': 83315000.0, 'close': 83340000.0, 'volume': 12.80282401, 'value': 1067308724.17628, 'decision': 'sell', 'sma': 83044000.0, 'ema': 83111374.28337997, 'rsi': 62.821890211164686, 'macd': 140881.3124218136, 'signal_line': 98566.27629302531, 'BB_Upper': 83491004.25054088, 'BB_Lower': 82596995.74945912}
2024-09-19 19:46:42 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:46:42 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83044000.0         0         0
2024-09-19 19:46:42 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83044000.0         0         0
2024-09-19 19:46:42 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:46:42 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:46:42 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:46:42 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:46:42 - INFO - Attempting prediction for prophet
2024-09-19 19:46:42 - INFO - PROPHET prediction: 83408175.13616116
2024-09-19 19:46:42 - INFO - Attempting prediction for transformer
2024-09-19 19:46:42 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:46:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:46:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:46:42 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:46:42 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:46:42 - INFO - X 샘플:
[[-1.64733436 -1.51669267 -1.76523728 -1.62663702 -1.22894008 -1.22922561
  -1.62663702 -1.62663702  0.          0.          0.         -1.62663702
  -1.62663702]
 [-1.18445417 -1.43408913 -1.40201973 -1.45179464 -0.98659565 -0.98800297
  -1.45179464 -1.45179464  0.          0.          0.         -1.45179464
  -1.45179464]
 [-0.94219912 -1.24134755 -1.00527441 -1.19857464  0.0282219   0.02146879
  -1.19857464 -1.19857464  0.          0.          0.         -1.19857464
  -1.19857464]
 [-0.55718662 -0.08489808 -0.37383468  0.2544258   0.14791295  0.14491108
   0.2544258   0.2544258   0.          0.          0.          0.2544258
   0.2544258 ]
 [ 0.36424778  0.09866533  0.44759578  0.12178676 -0.70365799 -0.70246177
   0.12178676  0.12178676  0.          0.          0.          0.12178676
   0.12178676]
 [ 0.14794862  0.50250483  0.42524393  0.42926818  2.2301231   2.22841862
   0.42926818  0.42926818  0.          0.          0.          0.42926818
   0.42926818]
 [ 1.0996649   0.90634433  1.01197997  0.77292389  0.9540119   0.95794519
   0.77292389  0.77292389  0.          0.          0.          0.77292389
   0.77292389]
 [ 0.52430915  0.81915171  0.87786887  1.4843515  -0.43016892 -0.4279455
   1.4843515   1.4843515   0.          0.          0.          1.4843515
   1.4843515 ]
 [ 1.6620427   1.4432673   0.86669295  0.54382009  0.67639445  0.67982535
   0.54382009  0.54382009  0.          0.          0.          0.54382009
   0.54382009]
 [ 0.53296112  0.50709392  0.91698461  0.67043008 -0.68730164 -0.68493318
   0.67043008  0.67043008  0.          0.          0.          0.67043008
   0.67043008]]
2024-09-19 19:46:42 - INFO - y 샘플:
[0.67043008]
2024-09-19 19:46:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:46:42 - INFO - 모델 출력 (스케일링된 예측): [0.37196943]
2024-09-19 19:46:42 - INFO - 스케일러 역변환 후 예측 가격: 83290496.21839434
2024-09-19 19:46:42 - INFO - TransformerPredictor 최종 예측 가격: 83290496.21839434
2024-09-19 19:46:42 - INFO - TRANSFORMER prediction: 83290496.21839434
2024-09-19 19:46:42 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:46:42 - INFO - BITCOIN_FORECAST prediction: 82266437.85356496
2024-09-19 19:46:42 - INFO - BitcoinForecast prediction: 82266437.85356496
2024-09-19 19:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:46:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:46:51 - INFO - 조정된 모델 가중치: {'gpt': 0.00380153112971837, 'ml': 0.2532943507802087, 'xgboost': 0.07889184967479262, 'rl': 0.33569394669644864, 'lstm': 0.09818051238793775, 'arima': 0.0, 'prophet': 0.10136671111241147, 'transformer': 0.12877109821848245, 'bitcoin_forecast': 0.0}
2024-09-19 19:46:51 - INFO - 조정된 모델 가중치: {'gpt': 0.00380153112971837, 'ml': 0.2532943507802087, 'xgboost': 0.07889184967479262, 'rl': 0.33569394669644864, 'lstm': 0.09818051238793775, 'arima': 0.0, 'prophet': 0.10136671111241147, 'transformer': 0.12877109821848245, 'bitcoin_forecast': 0.0}
2024-09-19 19:46:51 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83633075.27157445, 'current_price': 83340000.0, 'predictions': {'gpt': 83340000.0, 'ml': 83406672.0, 'xgboost': 83340000.0, 'lstm': 83298079.89318404, 'rl': 84173400.0, 'arima': 80899000.0, 'prophet': 83408175.13616116, 'transformer': 83290496.21839434, 'bitcoin_forecast': 82266437.85356496}, 'weights': {'gpt': 0.00380153112971837, 'ml': 0.2532943507802087, 'xgboost': 0.07889184967479262, 'rl': 0.33569394669644864, 'lstm': 0.09818051238793775, 'arima': 0.0, 'prophet': 0.10136671111241147, 'transformer': 0.12877109821848245, 'bitcoin_forecast': 0.0}}
2024-09-19 19:46:51 - INFO - 모델별 가중치:
2024-09-19 19:46:51 - INFO -   - GPT: 0.0038
2024-09-19 19:46:51 - INFO -   - ML: 0.2533
2024-09-19 19:46:51 - INFO -   - XGBOOST: 0.0789
2024-09-19 19:46:51 - INFO -   - RL: 0.3357
2024-09-19 19:46:51 - INFO -   - LSTM: 0.0982
2024-09-19 19:46:51 - INFO -   - ARIMA: 0.0000
2024-09-19 19:46:51 - INFO -   - PROPHET: 0.1014
2024-09-19 19:46:51 - INFO -   - TRANSFORMER: 0.1288
2024-09-19 19:46:51 - INFO -   - BITCOIN_FORECAST: 0.0000
2024-09-19 19:46:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:46:52 - INFO - 6. 거래 실행
2024-09-19 19:46:52 - INFO - Cancelling existing orders.
2024-09-19 19:46:52 - INFO - Cancelled 0 orders.
2024-09-19 19:46:52 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83633075.27157445, 'current_price': 83340000.0, 'predictions': {'gpt': 83340000.0, 'ml': 83406672.0, 'xgboost': 83340000.0, 'lstm': 83298079.89318404, 'rl': 84173400.0, 'arima': 80899000.0, 'prophet': 83408175.13616116, 'transformer': 83290496.21839434, 'bitcoin_forecast': 82266437.85356496}, 'weights': {'gpt': 0.00380153112971837, 'ml': 0.2532943507802087, 'xgboost': 0.07889184967479262, 'rl': 0.33569394669644864, 'lstm': 0.09818051238793775, 'arima': 0.0, 'prophet': 0.10136671111241147, 'transformer': 0.12877109821848245, 'bitcoin_forecast': 0.0}}, 현재 가격=83340000.0
2024-09-19 19:46:52 - INFO - 현재 잔고: KRW=301086.35454037, BTC=0.00210577, 총 자산가치=476581.22634037
2024-09-19 19:46:52 - INFO - 매수 시도: 0.0005718517234705664 BTC (약 47658.122634037005 KRW)
2024-09-19 19:46:52 - INFO - 주문 결과: {'uuid': '49257302-60f1-4051-8c48-5a8daa694009', 'side': 'bid', 'ord_type': 'limit', 'price': '83340000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:46:52+09:00', 'volume': '0.00057185', 'remaining_volume': '0.00057185', 'reserved_fee': '23.8289895', 'remaining_fee': '23.8289895', 'paid_fee': '0', 'locked': '47681.8079895', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:46:52 - INFO - buy 주문 성공: UUID=49257302-60f1-4051-8c48-5a8daa694009
2024-09-19 19:46:52 - INFO - Trade executed successfully.
2024-09-19 19:46:52 - INFO - 7. summary 리포트 보내기
2024-09-19 19:46:53 - INFO - Message sent to Discord successfully.
2024-09-19 19:46:53 - INFO - Trading cycle completed.
2024-09-19 19:46:53 - INFO - Performing periodic update.
2024-09-19 19:46:53 - INFO - 계산된 시장 변동성: 0.03551988723996988
2024-09-19 19:55:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:55:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b8-afaf-eb7c5c171333 "HTTP/1.1 200 OK"
2024-09-19 19:55:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:55:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:55:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/34317dc1-4f60-4382-9eae-91725bdce876 "HTTP/1.1 200 OK"
2024-09-19 19:55:46 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:55:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:55:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-b1a8-de83a93a3ff4 "HTTP/1.1 200 OK"
2024-09-19 19:55:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:55:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:55:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a4-8226-d1cc5188ac24 "HTTP/1.1 200 OK"
2024-09-19 19:55:58 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:56:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e4-a566-e0ca6116b019 "HTTP/1.1 200 OK"
2024-09-19 19:56:05 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8121-99ad-e6ba258455b1 "HTTP/1.1 200 OK"
2024-09-19 19:56:13 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:56:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7a2a50a8-872c-4eac-8bab-9d99eb01ad07 "HTTP/1.1 200 OK"
2024-09-19 19:56:18 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:56:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817f-a5af-e47383864c97 "HTTP/1.1 200 OK"
2024-09-19 19:56:25 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 19:56:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8102-9714-faef561a28e9 "HTTP/1.1 200 OK"
2024-09-19 19:56:30 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:45:34.935446
2024-09-19 19:56:30 - INFO - Starting trading cycle.
2024-09-19 19:56:30 - INFO - ##################################################
2024-09-19 19:56:30 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-19 19:56:30 - INFO - ##################################################
2024-09-19 19:56:30 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 19:56:30 - INFO - 데이터베이스 업데이트 시작
2024-09-19 19:56:30 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:40:00
2024-09-19 19:56:30 - INFO - 새로운 데이터 범위: 2024-09-18 10:40:00 ~ 2024-09-19 19:50:00
2024-09-19 19:56:30 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 19:56:30 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 19:56:30 - INFO - Index: Index([199], dtype='int64')
2024-09-19 19:56:30 - INFO - Date column data type: datetime64[ns]
2024-09-19 19:56:30 - INFO - Sample date values: [Timestamp('2024-09-19 19:50:00')]
2024-09-19 19:56:30 - INFO - Successfully added 1 new data points
2024-09-19 19:56:30 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 19:56:30 - INFO - Final date range: 2024-09-19 19:50:00 to 2024-09-19 19:50:00
2024-09-19 19:56:30 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 19:56:30 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 19:50:00
2024-09-19 19:56:30 - INFO - 데이터베이스 업데이트 완료
2024-09-19 19:56:30 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 19:56:31 - INFO - GPT | 이전예측가격: 83340000 | 당시BTC가격: 83340000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:56:31 - INFO - ML 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 10/18
2024-09-19 19:56:31 - INFO - ML | 이전예측가격: 83406672 | 당시BTC가격: 83340000 | 예측: 상승 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2256 | 반영가중치값: -0.0200 | 새 가중치: 0.2056 | 예측 총 횟수: 18 | 예측 성공 수: 10 | 예측 성공률: 55.56%
2024-09-19 19:56:31 - INFO - XGBOOST | 이전예측가격: 83340000 | 당시BTC가격: 83340000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 19:56:31 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 19/38
2024-09-19 19:56:31 - INFO - LSTM | 이전예측가격: 83298080 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1357 | 반영가중치값: -0.0200 | 새 가중치: 0.1157 | 예측 총 횟수: 38 | 예측 성공 수: 19 | 예측 성공률: 50.00%
2024-09-19 19:56:31 - INFO - RL 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 12/19
2024-09-19 19:56:31 - INFO - RL | 이전예측가격: 84173400 | 당시BTC가격: 83340000 | 예측: 상승 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0281 | 반영가중치값: -0.0200 | 새 가중치: 0.0081 | 예측 총 횟수: 19 | 예측 성공 수: 12 | 예측 성공률: 63.16%
2024-09-19 19:56:31 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.03%, 적중/전체: 114/211
2024-09-19 19:56:31 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1971 | 반영가중치값: -0.0200 | 새 가중치: 0.1771 | 예측 총 횟수: 211 | 예측 성공 수: 114 | 예측 성공률: 54.03%
2024-09-19 19:56:31 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 9/15
2024-09-19 19:56:31 - INFO - PROPHET | 이전예측가격: 83408175 | 당시BTC가격: 83340000 | 예측: 상승 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0017 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 15 | 예측 성공 수: 9 | 예측 성공률: 60.00%
2024-09-19 19:56:31 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 30/57
2024-09-19 19:56:31 - INFO - TRANSFORMER | 이전예측가격: 83290496 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1549 | 반영가중치값: -0.0200 | 새 가중치: 0.1349 | 예측 총 횟수: 57 | 예측 성공 수: 30 | 예측 성공률: 52.63%
2024-09-19 19:56:31 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 49.15%, 적중/전체: 29/59
2024-09-19 19:56:31 - INFO - BITCOIN_FORECAST | 이전예측가격: 82266438 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83340000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1760 | 반영가중치값: -0.0200 | 새 가중치: 0.1560 | 예측 총 횟수: 59 | 예측 성공 수: 29 | 예측 성공률: 49.15%
2024-09-19 19:56:31 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 19:56:31 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 19:56:31 - INFO - 새로운 가중치: {'gpt': 0.004319463147072583, 'ml': 0.23359290181966033, 'xgboost': 0.08964031219176215, 'rl': 0.009164766000535125, 'lstm': 0.13151953831560625, 'arima': 0.2012370841646995, 'prophet': 0.0, 'transformer': 0.15328766263526958, 'bitcoin_forecast': 0.17723827172539444}
2024-09-19 19:56:31 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 19:56:31 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 19:56:31 - INFO - Current BTC price: 83340000.0
2024-09-19 19:56:31 - INFO - Analyzing market conditions.
2024-09-19 19:56:31 - INFO - Market analysis: {'current_price': 83339000.0, 'sma_20': 83071400.0, 'rsi_14': 62.76518626998574, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 19:56:31 - INFO - Starting predictions for all models
2024-09-19 19:56:31 - INFO - Attempting prediction for gpt
2024-09-19 19:56:31 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 19:56:31 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:56:31 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 19:56:31 - INFO - GPT prediction: 83340000.0
2024-09-19 19:56:31 - INFO - Attempting prediction for ml
2024-09-19 19:56:31 - INFO - ML prediction: 83339000.0
2024-09-19 19:56:31 - INFO - Attempting prediction for xgboost
2024-09-19 19:56:31 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 19:56:31 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:56:31 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 19:56:31 - INFO - XGBOOST prediction: 83339000.0
2024-09-19 19:56:31 - INFO - Attempting prediction for lstm
2024-09-19 19:56:31 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:56:31 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:56:31 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:56:31 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:56:31 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:56:31 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 19:56:31 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:56:31 - INFO - X 샘플:
[[-1.66964303 -1.88212453 -1.99323903 -1.97131711 -1.02336776 -1.02549741
  -1.97131711]
 [-1.38656701 -1.65995132 -1.52071826 -1.67434682  0.01167483  0.00446465
  -1.67434682]
 [-0.93667834 -0.32691202 -0.76867816  0.02969703  0.13375129  0.13041258
   0.02969703]
 [ 0.14002153 -0.11531848  0.2096395  -0.12585884 -0.73479122 -0.73416028
  -0.12585884]
 [-0.11272492  0.35018731  0.18301861  0.23474795  2.25745931  2.25621125
   0.23474795]
 [ 0.99935945  0.8156931   0.88181693  0.63777907  0.95591557  0.95994969
   0.63777907]
 [ 0.3270539   0.71518616  0.7220916   1.47212419 -0.4558516  -0.45407187
   1.47212419]
 [ 1.65650022  1.4346042   0.70878116  0.36909165  0.67276528  0.67618457
   0.36909165]
 [ 0.33716376  0.35547715  0.76867816  0.5175768  -0.7181089  -0.71627589
   0.5175768 ]
 [ 0.64551443  0.31315844  0.80860949  0.51050608 -1.0994468  -1.09721728
   0.51050608]]
2024-09-19 19:56:31 - INFO - y 샘플:
[0.51050608]
2024-09-19 19:56:31 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 19:56:31 - INFO - 모델 출력 (스케일링된 예측): [[0.3985294]]
2024-09-19 19:56:31 - INFO - 스케일러 역변환 후 예측 가격: 83323163.33131415
2024-09-19 19:56:31 - INFO - LSTMPredictor 최종 예측 가격: 83323163.33131415
2024-09-19 19:56:31 - INFO - LSTM prediction: 83323163.33131415
2024-09-19 19:56:31 - INFO - Attempting prediction for rl
2024-09-19 19:56:31 - INFO - Preparing state for RL agent.
2024-09-19 19:56:31 - INFO - Prepared state: [[ 8.33390000e+07  8.63132649e+00 -1.19990401e-05  8.30714000e+07
   6.27651863e+01]]
2024-09-19 19:56:31 - INFO - RL prediction: 84173400.0
2024-09-19 19:56:31 - INFO - Attempting prediction for arima
2024-09-19 19:56:31 - INFO - ARIMA 예측 시작
2024-09-19 19:56:31 - INFO - 입력 데이터: {'open': 83400000.0, 'high': 83403000.0, 'low': 83321000.0, 'close': 83339000.0, 'volume': 8.63132649, 'value': 719614162.59304, 'decision': 'sell', 'sma': 83071400.0, 'ema': 83133052.92305806, 'rsi': 62.76518626998574, 'macd': 141187.94909220934, 'signal_line': 107090.61085286213, 'BB_Upper': 83520190.55248882, 'BB_Lower': 82622609.44751118}
2024-09-19 19:56:31 - INFO - Exogenous 변수 예측 시작
2024-09-19 19:56:31 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83071400.0         0         0
2024-09-19 19:56:31 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83071400.0         0         0
2024-09-19 19:56:31 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 19:56:31 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 19:56:31 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 19:56:31 - INFO - ARIMA prediction: 80899000.0
2024-09-19 19:56:31 - INFO - Attempting prediction for prophet
2024-09-19 19:56:31 - INFO - PROPHET prediction: 83404227.4921068
2024-09-19 19:56:31 - INFO - Attempting prediction for transformer
2024-09-19 19:56:31 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:56:31 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 19:56:32 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 19:56:32 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 19:56:32 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 19:56:32 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 19:56:32 - INFO - X dtype: float64, y dtype: float64
2024-09-19 19:56:32 - INFO - X 샘플:
[[-1.66964303 -1.88212453 -1.99323903 -1.97131711 -1.02336776 -1.02549741
  -1.97131711 -1.97131711  0.          0.          0.         -1.97131711
  -1.97131711]
 [-1.38656701 -1.65995132 -1.52071826 -1.67434682  0.01167483  0.00446465
  -1.67434682 -1.67434682  0.          0.          0.         -1.67434682
  -1.67434682]
 [-0.93667834 -0.32691202 -0.76867816  0.02969703  0.13375129  0.13041258
   0.02969703  0.02969703  0.          0.          0.          0.02969703
   0.02969703]
 [ 0.14002153 -0.11531848  0.2096395  -0.12585884 -0.73479122 -0.73416028
  -0.12585884 -0.12585884  0.          0.          0.         -0.12585884
  -0.12585884]
 [-0.11272492  0.35018731  0.18301861  0.23474795  2.25745931  2.25621125
   0.23474795  0.23474795  0.          0.          0.          0.23474795
   0.23474795]
 [ 0.99935945  0.8156931   0.88181693  0.63777907  0.95591557  0.95994969
   0.63777907  0.63777907  0.          0.          0.          0.63777907
   0.63777907]
 [ 0.3270539   0.71518616  0.7220916   1.47212419 -0.4558516  -0.45407187
   1.47212419  1.47212419  0.          0.          0.          1.47212419
   1.47212419]
 [ 1.65650022  1.4346042   0.70878116  0.36909165  0.67276528  0.67618457
   0.36909165  0.36909165  0.          0.          0.          0.36909165
   0.36909165]
 [ 0.33716376  0.35547715  0.76867816  0.5175768  -0.7181089  -0.71627589
   0.5175768   0.5175768   0.          0.          0.          0.5175768
   0.5175768 ]
 [ 0.64551443  0.31315844  0.80860949  0.51050608 -1.0994468  -1.09721728
   0.51050608  0.51050608  0.          0.          0.          0.51050608
   0.51050608]]
2024-09-19 19:56:32 - INFO - y 샘플:
[0.51050608]
2024-09-19 19:56:32 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 19:56:32 - INFO - 모델 출력 (스케일링된 예측): [0.37064207]
2024-09-19 19:56:32 - INFO - 스케일러 역변환 후 예측 가격: 83319219.27200814
2024-09-19 19:56:32 - INFO - TransformerPredictor 최종 예측 가격: 83319219.27200814
2024-09-19 19:56:32 - INFO - TRANSFORMER prediction: 83319219.27200814
2024-09-19 19:56:32 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 19:56:32 - INFO - BITCOIN_FORECAST prediction: 82270290.46928266
2024-09-19 19:56:32 - INFO - BitcoinForecast prediction: 82270290.46928266
2024-09-19 19:56:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 19:56:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 19:56:41 - INFO - 조정된 모델 가중치: {'gpt': 0.004319463147072583, 'ml': 0.23359290181966033, 'xgboost': 0.08964031219176215, 'rl': 0.009164766000535125, 'lstm': 0.13151953831560625, 'arima': 0.2012370841646995, 'prophet': 0.0, 'transformer': 0.15328766263526958, 'bitcoin_forecast': 0.17723827172539444}
2024-09-19 19:56:41 - INFO - 조정된 모델 가중치: {'gpt': 0.004319463147072583, 'ml': 0.23359290181966033, 'xgboost': 0.08964031219176215, 'rl': 0.009164766000535125, 'lstm': 0.13151953831560625, 'arima': 0.2012370841646995, 'prophet': 0.0, 'transformer': 0.15328766263526958, 'bitcoin_forecast': 0.17723827172539444}
2024-09-19 19:56:41 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82661101.71173821, 'current_price': 83340000.0, 'predictions': {'gpt': 83340000.0, 'ml': 83339000.0, 'xgboost': 83339000.0, 'lstm': 83323163.33131415, 'rl': 84173400.0, 'arima': 80899000.0, 'prophet': 83404227.4921068, 'transformer': 83319219.27200814, 'bitcoin_forecast': 82270290.46928266}, 'weights': {'gpt': 0.004319463147072583, 'ml': 0.23359290181966033, 'xgboost': 0.08964031219176215, 'rl': 0.009164766000535125, 'lstm': 0.13151953831560625, 'arima': 0.2012370841646995, 'prophet': 0.0, 'transformer': 0.15328766263526958, 'bitcoin_forecast': 0.17723827172539444}}
2024-09-19 19:56:41 - INFO - 모델별 가중치:
2024-09-19 19:56:41 - INFO -   - GPT: 0.0043
2024-09-19 19:56:41 - INFO -   - ML: 0.2336
2024-09-19 19:56:41 - INFO -   - XGBOOST: 0.0896
2024-09-19 19:56:41 - INFO -   - RL: 0.0092
2024-09-19 19:56:41 - INFO -   - LSTM: 0.1315
2024-09-19 19:56:41 - INFO -   - ARIMA: 0.2012
2024-09-19 19:56:41 - INFO -   - PROPHET: 0.0000
2024-09-19 19:56:41 - INFO -   - TRANSFORMER: 0.1533
2024-09-19 19:56:41 - INFO -   - BITCOIN_FORECAST: 0.1772
2024-09-19 19:56:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 19:56:41 - INFO - 6. 거래 실행
2024-09-19 19:56:41 - INFO - Cancelling existing orders.
2024-09-19 19:56:41 - INFO - Cancelled 0 orders.
2024-09-19 19:56:41 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82661101.71173821, 'current_price': 83340000.0, 'predictions': {'gpt': 83340000.0, 'ml': 83339000.0, 'xgboost': 83339000.0, 'lstm': 83323163.33131415, 'rl': 84173400.0, 'arima': 80899000.0, 'prophet': 83404227.4921068, 'transformer': 83319219.27200814, 'bitcoin_forecast': 82270290.46928266}, 'weights': {'gpt': 0.004319463147072583, 'ml': 0.23359290181966033, 'xgboost': 0.08964031219176215, 'rl': 0.009164766000535125, 'lstm': 0.13151953831560625, 'arima': 0.2012370841646995, 'prophet': 0.0, 'transformer': 0.15328766263526958, 'bitcoin_forecast': 0.17723827172539444}}, 현재 가격=83340000.0
2024-09-19 19:56:41 - INFO - 현재 잔고: KRW=253404.54655087, BTC=0.00267762, 총 자산가치=476557.39735086996
2024-09-19 19:56:41 - INFO - 매도 시도: 0.000535524 BTC (약 44630.57016 KRW)
2024-09-19 19:56:41 - INFO - 주문 결과: {'uuid': 'bdaa041f-e71a-40b8-bb0a-5ea9280fdb33', 'side': 'ask', 'ord_type': 'limit', 'price': '83340000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T19:56:41+09:00', 'volume': '0.00053552', 'remaining_volume': '0.00053552', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00053552', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 19:56:41 - INFO - sell 주문 성공: UUID=bdaa041f-e71a-40b8-bb0a-5ea9280fdb33
2024-09-19 19:56:41 - INFO - Trade executed successfully.
2024-09-19 19:56:41 - INFO - 7. summary 리포트 보내기
2024-09-19 19:56:42 - INFO - Message sent to Discord successfully.
2024-09-19 19:56:42 - INFO - Trading cycle completed.
2024-09-19 19:56:42 - INFO - Performing periodic update.
2024-09-19 19:56:42 - INFO - 계산된 시장 변동성: 0.035371554291803275
2024-09-19 20:05:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:05:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-b562-d5aae5f29957 "HTTP/1.1 200 OK"
2024-09-19 20:05:44 - INFO - Updated actual price for gpt prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:05:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:05:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8199-ac31-ee55def2796d "HTTP/1.1 200 OK"
2024-09-19 20:05:55 - INFO - Updated actual price for ml prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e5-b069-f5c44b0b1a19 "HTTP/1.1 200 OK"
2024-09-19 20:06:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/4b04a9fe-5976-4935-8e02-cf3882a86b7c "HTTP/1.1 200 OK"
2024-09-19 20:06:10 - INFO - Updated actual price for lstm prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8144-bb91-c1a900415dc0 "HTTP/1.1 200 OK"
2024-09-19 20:06:20 - INFO - Updated actual price for rl prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a4f52cb5-51b6-4a78-bed4-54d058b69a9e "HTTP/1.1 200 OK"
2024-09-19 20:06:27 - INFO - Updated actual price for arima prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-b475-df537b48fc33 "HTTP/1.1 200 OK"
2024-09-19 20:06:33 - INFO - Updated actual price for prophet prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815a-b781-c2253064e187 "HTTP/1.1 200 OK"
2024-09-19 20:06:41 - INFO - Updated actual price for transformer prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:06:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7cc3c951-c4fc-43a3-96f4-7a921b55360e "HTTP/1.1 200 OK"
2024-09-19 20:06:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 19:55:34.935741
2024-09-19 20:06:47 - INFO - Starting trading cycle.
2024-09-19 20:06:47 - INFO - ##################################################
2024-09-19 20:06:47 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-19 20:06:47 - INFO - ##################################################
2024-09-19 20:06:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:06:47 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:06:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 19:50:00
2024-09-19 20:06:47 - INFO - 새로운 데이터 범위: 2024-09-18 10:50:00 ~ 2024-09-19 20:00:00
2024-09-19 20:06:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:06:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:06:47 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:06:47 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:06:47 - INFO - Sample date values: [Timestamp('2024-09-19 20:00:00')]
2024-09-19 20:06:48 - INFO - Successfully added 1 new data points
2024-09-19 20:06:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:06:48 - INFO - Final date range: 2024-09-19 20:00:00 to 2024-09-19 20:00:00
2024-09-19 20:06:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:06:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:00:00
2024-09-19 20:06:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:06:48 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:06:48 - INFO - GPT | 이전예측가격: 83340000 | 당시BTC가격: 83340000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:06:48 - INFO - ML | 이전예측가격: 83339000 | 당시BTC가격: 83340000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:06:48 - INFO - XGBOOST | 이전예측가격: 83339000 | 당시BTC가격: 83340000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:06:48 - INFO - LSTM 모델 예측 업데이트: 정확도 51.28%, 적중/전체: 20/39
2024-09-19 20:06:48 - INFO - LSTM | 이전예측가격: 83323163 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0982 | 반영가중치값: 0.0200 | 새 가중치: 0.1182 | 예측 총 횟수: 39 | 예측 성공 수: 20 | 예측 성공률: 51.28%
2024-09-19 20:06:48 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 12/20
2024-09-19 20:06:48 - INFO - RL | 이전예측가격: 84173400 | 당시BTC가격: 83340000 | 예측: 상승 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3357 | 반영가중치값: -0.0200 | 새 가중치: 0.3157 | 예측 총 횟수: 20 | 예측 성공 수: 12 | 예측 성공률: 60.00%
2024-09-19 20:06:48 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.25%, 적중/전체: 115/212
2024-09-19 20:06:48 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 212 | 예측 성공 수: 115 | 예측 성공률: 54.25%
2024-09-19 20:06:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 9/16
2024-09-19 20:06:48 - INFO - PROPHET | 이전예측가격: 83404227 | 당시BTC가격: 83340000 | 예측: 상승 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1014 | 반영가중치값: -0.0200 | 새 가중치: 0.0814 | 예측 총 횟수: 16 | 예측 성공 수: 9 | 예측 성공률: 56.25%
2024-09-19 20:06:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.45%, 적중/전체: 31/58
2024-09-19 20:06:48 - INFO - TRANSFORMER | 이전예측가격: 83319219 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1288 | 반영가중치값: 0.0200 | 새 가중치: 0.1488 | 예측 총 횟수: 58 | 예측 성공 수: 31 | 예측 성공률: 53.45%
2024-09-19 20:06:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 30/60
2024-09-19 20:06:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 82270290 | 당시BTC가격: 83340000 | 예측: 하락 | 지금 BTC가격: 83130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 60 | 예측 성공 수: 30 | 예측 성공률: 50.00%
2024-09-19 20:06:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:06:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:06:48 - INFO - 새로운 가중치: {'gpt': 0.0041872915181990975, 'ml': 0.2264451722811613, 'xgboost': 0.08689740047525805, 'rl': 0.30603400013835663, 'lstm': 0.11456429660102843, 'arima': 0.01938801825887524, 'prophet': 0.07887696403560301, 'transformer': 0.14421883843264297, 'bitcoin_forecast': 0.01938801825887524}
2024-09-19 20:06:48 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:06:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:06:48 - INFO - Current BTC price: 83130000.0
2024-09-19 20:06:48 - INFO - Analyzing market conditions.
2024-09-19 20:06:48 - INFO - Market analysis: {'current_price': 83130000.0, 'sma_20': 83081550.0, 'rsi_14': 52.16705011223085, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 20:06:48 - INFO - Starting predictions for all models
2024-09-19 20:06:48 - INFO - Attempting prediction for gpt
2024-09-19 20:06:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:06:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:06:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:06:48 - INFO - GPT prediction: 83130000.0
2024-09-19 20:06:48 - INFO - Attempting prediction for ml
2024-09-19 20:06:48 - INFO - ML prediction: 83096748.0
2024-09-19 20:06:48 - INFO - Attempting prediction for xgboost
2024-09-19 20:06:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:06:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:06:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:06:49 - INFO - XGBOOST prediction: 83130000.0
2024-09-19 20:06:49 - INFO - Attempting prediction for lstm
2024-09-19 20:06:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:06:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:06:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:06:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:06:49 - INFO - X 샘플:
[[-1.88648584 -2.31195136 -1.80353735 -2.12904612 -0.13588294 -0.14326811
  -2.12904612]
 [-1.34505649 -0.62371101 -0.94903118 -0.08482255 -0.00646664 -0.00969242
  -0.08482255]
 [-0.04927615 -0.35573636  0.16258303 -0.27143217 -0.92723016 -0.92662619
  -0.27143217]
 [-0.35344994  0.23380789  0.13233503  0.16116285  2.24492905  2.24485047
   0.16116285]
 [ 0.98491473  0.82335213  0.92634518  0.64465141  0.86513016  0.87008374
   0.64465141]
 [ 0.17581245  0.69606417  0.74485714  1.64555756 -0.63151932 -0.62957486
   1.64555756]
 [ 1.77576658  1.60717801  0.72973314  0.32232571  0.56495549  0.56913302
   0.32232571]
 [ 0.1879794   0.24050725  0.79779115  0.50045307 -0.90954481 -0.90765868
   0.50045307]
 [ 0.55907142  0.18691232  0.84316316  0.49197082 -1.3138106  -1.31167093
   0.49197082]
 [-0.04927615 -0.49642305 -1.58423931 -1.28082057  0.24943979  0.24442397
  -1.28082057]]
2024-09-19 20:06:49 - INFO - y 샘플:
[-1.28082057]
2024-09-19 20:06:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:06:49 - INFO - 모델 출력 (스케일링된 예측): [[0.3647024]]
2024-09-19 20:06:49 - INFO - 스케일러 역변환 후 예측 가격: 83323995.92318346
2024-09-19 20:06:49 - INFO - LSTMPredictor 최종 예측 가격: 83323995.92318346
2024-09-19 20:06:49 - INFO - LSTM prediction: 83323995.92318346
2024-09-19 20:06:49 - INFO - Attempting prediction for rl
2024-09-19 20:06:49 - INFO - Preparing state for RL agent.
2024-09-19 20:06:49 - INFO - Prepared state: [[ 8.31300000e+07  2.47620388e+01 -2.50782947e-03  8.30815500e+07
   5.21670501e+01]]
2024-09-19 20:06:49 - INFO - RL prediction: 83961300.0
2024-09-19 20:06:49 - INFO - Attempting prediction for arima
2024-09-19 20:06:49 - INFO - ARIMA 예측 시작
2024-09-19 20:06:49 - INFO - 입력 데이터: {'open': 83300000.0, 'high': 83301000.0, 'low': 83000000.0, 'close': 83130000.0, 'volume': 24.76203879, 'value': 2058795665.29335, 'decision': 'sell', 'sma': 83081550.0, 'ema': 83132762.1684811, 'rsi': 52.16705011223085, 'macd': 123146.84734858572, 'signal_line': 110301.85815200685, 'BB_Upper': 83525979.28571552, 'BB_Lower': 82637120.71428448}
2024-09-19 20:06:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:06:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83081550.0         0         0
2024-09-19 20:06:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83081550.0         0         0
2024-09-19 20:06:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:06:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:06:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:06:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:06:49 - INFO - Attempting prediction for prophet
2024-09-19 20:06:49 - INFO - PROPHET prediction: 83146555.50577524
2024-09-19 20:06:49 - INFO - Attempting prediction for transformer
2024-09-19 20:06:49 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:06:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:06:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:06:49 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:06:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:06:49 - INFO - X 샘플:
[[-1.88648584 -2.31195136 -1.80353735 -2.12904612 -0.13588294 -0.14326811
  -2.12904612 -2.12904612  0.          0.          0.         -2.12904612
  -2.12904612]
 [-1.34505649 -0.62371101 -0.94903118 -0.08482255 -0.00646664 -0.00969242
  -0.08482255 -0.08482255  0.          0.          0.         -0.08482255
  -0.08482255]
 [-0.04927615 -0.35573636  0.16258303 -0.27143217 -0.92723016 -0.92662619
  -0.27143217 -0.27143217  0.          0.          0.         -0.27143217
  -0.27143217]
 [-0.35344994  0.23380789  0.13233503  0.16116285  2.24492905  2.24485047
   0.16116285  0.16116285  0.          0.          0.          0.16116285
   0.16116285]
 [ 0.98491473  0.82335213  0.92634518  0.64465141  0.86513016  0.87008374
   0.64465141  0.64465141  0.          0.          0.          0.64465141
   0.64465141]
 [ 0.17581245  0.69606417  0.74485714  1.64555756 -0.63151932 -0.62957486
   1.64555756  1.64555756  0.          0.          0.          1.64555756
   1.64555756]
 [ 1.77576658  1.60717801  0.72973314  0.32232571  0.56495549  0.56913302
   0.32232571  0.32232571  0.          0.          0.          0.32232571
   0.32232571]
 [ 0.1879794   0.24050725  0.79779115  0.50045307 -0.90954481 -0.90765868
   0.50045307  0.50045307  0.          0.          0.          0.50045307
   0.50045307]
 [ 0.55907142  0.18691232  0.84316316  0.49197082 -1.3138106  -1.31167093
   0.49197082  0.49197082  0.          0.          0.          0.49197082
   0.49197082]
 [-0.04927615 -0.49642305 -1.58423931 -1.28082057  0.24943979  0.24442397
  -1.28082057 -1.28082057  0.          0.          0.         -1.28082057
  -1.28082057]]
2024-09-19 20:06:49 - INFO - y 샘플:
[-1.28082057]
2024-09-19 20:06:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:06:49 - INFO - 모델 출력 (스케일링된 예측): [0.36523736]
2024-09-19 20:06:49 - INFO - 스케일러 역변환 후 예측 가격: 83324058.99033467
2024-09-19 20:06:49 - INFO - TransformerPredictor 최종 예측 가격: 83324058.99033467
2024-09-19 20:06:49 - INFO - TRANSFORMER prediction: 83324058.99033467
2024-09-19 20:06:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:06:49 - INFO - BITCOIN_FORECAST prediction: 82384943.51930752
2024-09-19 20:06:49 - INFO - BitcoinForecast prediction: 82384943.51930752
2024-09-19 20:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:07:08 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:07:08 - INFO - 조정된 모델 가중치: {'gpt': 0.0041872915181990975, 'ml': 0.2264451722811613, 'xgboost': 0.08689740047525805, 'rl': 0.30603400013835663, 'lstm': 0.11456429660102843, 'arima': 0.01938801825887524, 'prophet': 0.07887696403560301, 'transformer': 0.14421883843264297, 'bitcoin_forecast': 0.01938801825887524}
2024-09-19 20:07:08 - INFO - 조정된 모델 가중치: {'gpt': 0.0041872915181990975, 'ml': 0.2264451722811613, 'xgboost': 0.08689740047525805, 'rl': 0.30603400013835663, 'lstm': 0.11456429660102843, 'arima': 0.01938801825887524, 'prophet': 0.07887696403560301, 'transformer': 0.14421883843264297, 'bitcoin_forecast': 0.01938801825887524}
2024-09-19 20:07:08 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83370694.28874929, 'current_price': 83130000.0, 'predictions': {'gpt': 83130000.0, 'ml': 83096748.0, 'xgboost': 83130000.0, 'lstm': 83323995.92318346, 'rl': 83961300.0, 'arima': 80899000.0, 'prophet': 83146555.50577524, 'transformer': 83324058.99033467, 'bitcoin_forecast': 82384943.51930752}, 'weights': {'gpt': 0.0041872915181990975, 'ml': 0.2264451722811613, 'xgboost': 0.08689740047525805, 'rl': 0.30603400013835663, 'lstm': 0.11456429660102843, 'arima': 0.01938801825887524, 'prophet': 0.07887696403560301, 'transformer': 0.14421883843264297, 'bitcoin_forecast': 0.01938801825887524}}
2024-09-19 20:07:08 - INFO - 모델별 가중치:
2024-09-19 20:07:08 - INFO -   - GPT: 0.0042
2024-09-19 20:07:08 - INFO -   - ML: 0.2264
2024-09-19 20:07:08 - INFO -   - XGBOOST: 0.0869
2024-09-19 20:07:08 - INFO -   - RL: 0.3060
2024-09-19 20:07:08 - INFO -   - LSTM: 0.1146
2024-09-19 20:07:08 - INFO -   - ARIMA: 0.0194
2024-09-19 20:07:08 - INFO -   - PROPHET: 0.0789
2024-09-19 20:07:08 - INFO -   - TRANSFORMER: 0.1442
2024-09-19 20:07:08 - INFO -   - BITCOIN_FORECAST: 0.0194
2024-09-19 20:07:08 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:07:08 - INFO - 6. 거래 실행
2024-09-19 20:07:08 - INFO - Cancelling existing orders.
2024-09-19 20:07:08 - INFO - Cancelled 1 orders.
2024-09-19 20:07:08 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83370694.28874929, 'current_price': 83130000.0, 'predictions': {'gpt': 83130000.0, 'ml': 83096748.0, 'xgboost': 83130000.0, 'lstm': 83323995.92318346, 'rl': 83961300.0, 'arima': 80899000.0, 'prophet': 83146555.50577524, 'transformer': 83324058.99033467, 'bitcoin_forecast': 82384943.51930752}, 'weights': {'gpt': 0.0041872915181990975, 'ml': 0.2264451722811613, 'xgboost': 0.08689740047525805, 'rl': 0.30603400013835663, 'lstm': 0.11456429660102843, 'arima': 0.01938801825887524, 'prophet': 0.07887696403560301, 'transformer': 0.14421883843264297, 'bitcoin_forecast': 0.01938801825887524}}, 현재 가격=83130000.0
2024-09-19 20:07:08 - INFO - 현재 잔고: KRW=253404.54655087, BTC=0.00267762, 총 자산가치=475995.09715087
2024-09-19 20:07:08 - INFO - 매수 시도: 0.0005725912392047036 BTC (약 47599.509715087006 KRW)
2024-09-19 20:07:08 - INFO - 주문 결과: {'uuid': '17ca781a-9ba0-4971-b644-53d25c9ed92b', 'side': 'bid', 'ord_type': 'limit', 'price': '83130000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:07:08+09:00', 'volume': '0.00057259', 'remaining_volume': '0.00057259', 'reserved_fee': '23.79970335', 'remaining_fee': '23.79970335', 'paid_fee': '0', 'locked': '47623.20640335', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:07:08 - INFO - buy 주문 성공: UUID=17ca781a-9ba0-4971-b644-53d25c9ed92b
2024-09-19 20:07:08 - INFO - Trade executed successfully.
2024-09-19 20:07:08 - INFO - 7. summary 리포트 보내기
2024-09-19 20:07:09 - INFO - Message sent to Discord successfully.
2024-09-19 20:07:09 - INFO - Trading cycle completed.
2024-09-19 20:07:09 - INFO - Performing periodic update.
2024-09-19 20:07:09 - INFO - 계산된 시장 변동성: 0.03525342978209723
2024-09-19 20:15:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:15:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-99f1-ed33a026b91d "HTTP/1.1 200 OK"
2024-09-19 20:15:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:15:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:15:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-8bec-e9f88c3d4746 "HTTP/1.1 200 OK"
2024-09-19 20:15:58 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-a883-d37dab13853f "HTTP/1.1 200 OK"
2024-09-19 20:16:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-8f6a-d91cda728195 "HTTP/1.1 200 OK"
2024-09-19 20:16:12 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-9cbc-d504344927e1 "HTTP/1.1 200 OK"
2024-09-19 20:16:19 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816d-a497-f4f44984c852 "HTTP/1.1 200 OK"
2024-09-19 20:16:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8142-ad5d-da6106f306dd "HTTP/1.1 200 OK"
2024-09-19 20:16:42 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8177-8d69-da539e477bfd "HTTP/1.1 200 OK"
2024-09-19 20:16:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:16:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8100-a0fc-fa6d02bf0317 "HTTP/1.1 200 OK"
2024-09-19 20:16:59 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:05:34.936337
2024-09-19 20:16:59 - INFO - Starting trading cycle.
2024-09-19 20:16:59 - INFO - ##################################################
2024-09-19 20:16:59 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-19 20:16:59 - INFO - ##################################################
2024-09-19 20:16:59 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:16:59 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:16:59 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:00:00
2024-09-19 20:16:59 - INFO - 새로운 데이터 범위: 2024-09-18 11:00:00 ~ 2024-09-19 20:10:00
2024-09-19 20:16:59 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:16:59 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:16:59 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:16:59 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:16:59 - INFO - Sample date values: [Timestamp('2024-09-19 20:10:00')]
2024-09-19 20:17:00 - INFO - Successfully added 1 new data points
2024-09-19 20:17:00 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:17:00 - INFO - Final date range: 2024-09-19 20:10:00 to 2024-09-19 20:10:00
2024-09-19 20:17:00 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:17:00 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:10:00
2024-09-19 20:17:00 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:17:00 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-19 20:17:00 - INFO - 재학습 대상 모델: ['bitcoin_forecast', 'lstm', 'transformer']
2024-09-19 20:17:00 - INFO - bitcoin_forecast 모델 재학습 시작
2024-09-19 20:17:00 - INFO - BitcoinForecastPredictor 훈련 시작
2024-09-19 20:17:00 - INFO - BitcoinForecastPredictor prepare_data 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 20:17:00 - INFO - 준비된 데이터 shape - X: (2970, 30, 2), y: (2970,)
2024-09-19 20:17:01 - INFO - Epoch [1/30], Loss: 0.9680
2024-09-19 20:17:02 - INFO - Epoch [2/30], Loss: 0.8180
2024-09-19 20:17:03 - INFO - Epoch [3/30], Loss: 0.5663
2024-09-19 20:17:04 - INFO - Epoch [4/30], Loss: 0.2646
2024-09-19 20:17:05 - INFO - Epoch [5/30], Loss: 0.1485
2024-09-19 20:17:06 - INFO - Epoch [6/30], Loss: 0.0871
2024-09-19 20:17:07 - INFO - Epoch [7/30], Loss: 0.0599
2024-09-19 20:17:08 - INFO - Epoch [8/30], Loss: 0.0428
2024-09-19 20:17:09 - INFO - Epoch [9/30], Loss: 0.0325
2024-09-19 20:17:10 - INFO - Epoch [10/30], Loss: 0.0342
2024-09-19 20:17:11 - INFO - Epoch [11/30], Loss: 0.0317
2024-09-19 20:17:12 - INFO - Epoch [12/30], Loss: 0.0254
2024-09-19 20:17:13 - INFO - Epoch [13/30], Loss: 0.0223
2024-09-19 20:17:14 - INFO - Epoch [14/30], Loss: 0.0206
2024-09-19 20:17:15 - INFO - Epoch [15/30], Loss: 0.0190
2024-09-19 20:17:16 - INFO - Epoch [16/30], Loss: 0.0176
2024-09-19 20:17:17 - INFO - Epoch [17/30], Loss: 0.0163
2024-09-19 20:17:18 - INFO - Epoch [18/30], Loss: 0.0152
2024-09-19 20:17:19 - INFO - Epoch [19/30], Loss: 0.0142
2024-09-19 20:17:20 - INFO - Epoch [20/30], Loss: 0.0133
2024-09-19 20:17:21 - INFO - Epoch [21/30], Loss: 0.0125
2024-09-19 20:17:22 - INFO - Epoch [22/30], Loss: 0.0118
2024-09-19 20:17:23 - INFO - Epoch [23/30], Loss: 0.0112
2024-09-19 20:17:24 - INFO - Epoch [24/30], Loss: 0.0107
2024-09-19 20:17:25 - INFO - Epoch [25/30], Loss: 0.0103
2024-09-19 20:17:26 - INFO - Epoch [26/30], Loss: 0.0100
2024-09-19 20:17:27 - INFO - Epoch [27/30], Loss: 0.0097
2024-09-19 20:17:28 - INFO - Epoch [28/30], Loss: 0.0094
2024-09-19 20:17:29 - INFO - Epoch [29/30], Loss: 0.0092
2024-09-19 20:17:30 - INFO - Epoch [30/30], Loss: 0.0090
2024-09-19 20:17:30 - INFO - BitcoinForecastPredictor 훈련 완료
2024-09-19 20:17:30 - INFO - bitcoin_forecast 모델의 예측 통계가 초기화되었습니다.
2024-09-19 20:17:30 - INFO - bitcoin_forecast 모델 재학습 완료
2024-09-19 20:17:30 - INFO - lstm 모델 재학습 시작
2024-09-19 20:17:30 - INFO - LSTM 하이퍼파라미터 랜덤 조정: hidden_dim=111, num_layers=2, learning_rate=0.004367056948291179
2024-09-19 20:17:30 - INFO - LSTM 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:17:30 - INFO - NaN 값 개수:
date           0
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:17:30 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:17:30 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:17:30 - INFO - X 샘플:
[[ 0.38970601  0.39700619  0.39381821  0.4006325   0.1726752   0.29686233
   0.38295343]
 [ 0.40243385  0.39939478  0.40260806  0.39931781 -0.02560457  0.03853758
   0.38404144]
 [ 0.39944609  0.40464966  0.40236888  0.4023655   0.65749698  0.93202731
   0.38532644]
 [ 0.41259222  0.40990454  0.40864734  0.40577174  0.36036727  0.54471879
   0.38731154]
 [ 0.40464479  0.40876997  0.40721226  0.41282326  0.03807462  0.12222488
   0.38922995]
 [ 0.42036038  0.41689115  0.40709267  0.40350091  0.29572682  0.45993293
   0.3909635 ]
 [ 0.4047643   0.40470938  0.40763083  0.40475585 -0.02179616  0.04388124
   0.3923667 ]
 [ 0.40840936  0.40423166  0.4079896   0.40469609 -0.10885187 -0.06993981
   0.39402751]
 [ 0.40243385  0.39814077  0.38879543  0.39220653  0.2277828   0.36845371
   0.39464274]
 [ 0.39645834  0.40423166  0.40063482  0.40852064 -0.0284088   0.03489782
   0.39631264]]
2024-09-19 20:17:30 - INFO - y 샘플:
[0.40852064]
2024-09-19 20:17:30 - INFO - Epoch [10/50], Loss: 0.0335
2024-09-19 20:17:30 - INFO - Epoch [20/50], Loss: 0.0019
2024-09-19 20:17:30 - INFO - Epoch [30/50], Loss: 0.0005
2024-09-19 20:17:30 - INFO - Epoch [40/50], Loss: 0.0001
2024-09-19 20:17:30 - INFO - Epoch [50/50], Loss: 0.0000
2024-09-19 20:17:30 - INFO - LSTM 훈련 완료. MSE: 3.8744562402825977e-07
2024-09-19 20:17:30 - INFO - lstm 모델의 예측 통계가 초기화되었습니다.
2024-09-19 20:17:30 - INFO - lstm 모델 재학습 완료
2024-09-19 20:17:30 - INFO - transformer 모델 재학습 시작
2024-09-19 20:17:30 - INFO - Transformer 학습률 조정: learning_rate=0.0003486784401
2024-09-19 20:17:30 - INFO - Transformer 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-19 20:17:30 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:17:30 - INFO - NaN 값 개수:
date            0
open            0
high            0
low             0
close           0
volume          0
value           0
decision        0
sma            19
ema            19
rsi            14
macd           25
signal_line    33
BB_Upper       19
BB_Lower       19
dtype: int64
2024-09-19 20:17:30 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:17:30 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:17:30 - INFO - X 샘플:
[[ 0.38970601  0.39700619  0.39381821  0.4006325   0.1726752   0.29686233
   0.38295343  0.38772147  1.21261439  0.03483775  0.01614505  0.34505017
   0.38054141]
 [ 0.40243385  0.39939478  0.40260806  0.39931781 -0.02560457  0.03853758
   0.38404144  0.38963879  1.12100232  0.04540856  0.02253303  0.34908787
   0.37899307]
 [ 0.39944609  0.40464966  0.40236888  0.4023655   0.65749698  0.93202731
   0.38532644  0.39167015  1.23915618  0.05547638  0.02977778  0.35331858
   0.37762714]
 [ 0.41259222  0.40990454  0.40864734  0.40577174  0.36036727  0.54471879
   0.38731154  0.39383958  1.36851482  0.06530418  0.03765707  0.35735175
   0.37766928]
 [ 0.40464479  0.40876997  0.40721226  0.41282326  0.03807462  0.12222488
   0.38922995  0.39648875  1.61548967  0.07756474  0.04655974  0.36296424
   0.37623522]
 [ 0.42036038  0.41689115  0.40709267  0.40350091  0.29572682  0.45993293
   0.3909635   0.39797825  0.93823547  0.07931639  0.05405322  0.3651879
   0.37738875]
 [ 0.4047643   0.40470938  0.40763083  0.40475585 -0.02179616  0.04388124
   0.3923667   0.39944803  0.98969834  0.08074419  0.06035069  0.36763083
   0.37776945]
 [ 0.40840936  0.40423166  0.4079896   0.40469609 -0.10885187 -0.06993981
   0.39402751  0.40077202  0.98532139  0.0809164   0.06542518  0.36944982
   0.37914239]
 [ 0.40243385  0.39814077  0.38879543  0.39220653  0.2277828   0.36845371
   0.39464274  0.40075426  0.16725598  0.07078451  0.06733682  0.36981059
   0.37992021]
 [ 0.39645834  0.40423166  0.40063482  0.40852064 -0.0284088   0.03489782
   0.39631264  0.4023261   0.87592423  0.07428869  0.06960901  0.37202043
   0.38097306]]
2024-09-19 20:17:30 - INFO - y 샘플:
[0.40852064]
2024-09-19 20:17:30 - INFO - Epoch [1/50], Loss: 0.0027
2024-09-19 20:17:30 - INFO - Epoch [2/50], Loss: 0.0001
2024-09-19 20:17:30 - INFO - Epoch [3/50], Loss: 0.0006
2024-09-19 20:17:30 - INFO - Epoch [4/50], Loss: 0.0045
2024-09-19 20:17:30 - INFO - Epoch [5/50], Loss: 0.0059
2024-09-19 20:17:30 - INFO - 조기 종료: 3 에폭 동안 개선 없음
2024-09-19 20:17:30 - INFO - Transformer 훈련 완료. MSE: 0.004207494203001261
2024-09-19 20:17:31 - INFO - transformer 모델의 예측 통계가 초기화되었습니다.
2024-09-19 20:17:31 - INFO - transformer 모델 재학습 완료
2024-09-19 20:17:31 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:17:31 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:17:31 - INFO - GPT | 이전예측가격: 83130000 | 당시BTC가격: 83130000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:17:31 - INFO - ML 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 10/19
2024-09-19 20:17:31 - INFO - ML | 이전예측가격: 83096748 | 당시BTC가격: 83130000 | 예측: 하락 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2336 | 반영가중치값: -0.0200 | 새 가중치: 0.2136 | 예측 총 횟수: 19 | 예측 성공 수: 10 | 예측 성공률: 52.63%
2024-09-19 20:17:31 - INFO - XGBOOST | 이전예측가격: 83130000 | 당시BTC가격: 83130000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:17:31 - INFO - LSTM 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-19 20:17:31 - INFO - LSTM | 이전예측가격: 83323996 | 당시BTC가격: 83130000 | 예측: 상승 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1315 | 반영가중치값: 0.0200 | 새 가중치: 0.1515 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-19 20:17:31 - INFO - RL 모델 예측 업데이트: 정확도 61.90%, 적중/전체: 13/21
2024-09-19 20:17:31 - INFO - RL | 이전예측가격: 83961300 | 당시BTC가격: 83130000 | 예측: 상승 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0092 | 반영가중치값: 0.0200 | 새 가중치: 0.0292 | 예측 총 횟수: 21 | 예측 성공 수: 13 | 예측 성공률: 61.90%
2024-09-19 20:17:31 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.99%, 적중/전체: 115/213
2024-09-19 20:17:31 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83130000 | 예측: 하락 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2012 | 반영가중치값: -0.0200 | 새 가중치: 0.1812 | 예측 총 횟수: 213 | 예측 성공 수: 115 | 예측 성공률: 53.99%
2024-09-19 20:17:31 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 10/17
2024-09-19 20:17:31 - INFO - PROPHET | 이전예측가격: 83146556 | 당시BTC가격: 83130000 | 예측: 상승 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 17 | 예측 성공 수: 10 | 예측 성공률: 58.82%
2024-09-19 20:17:31 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-19 20:17:31 - INFO - TRANSFORMER | 이전예측가격: 83324059 | 당시BTC가격: 83130000 | 예측: 상승 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1533 | 반영가중치값: 0.0200 | 새 가중치: 0.1733 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-19 20:17:31 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 20:17:31 - INFO - BITCOIN_FORECAST | 이전예측가격: 82384944 | 당시BTC가격: 83130000 | 예측: 하락 | 지금 BTC가격: 83405000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1772 | 반영가중치값: -0.0200 | 새 가중치: 0.1572 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 20:17:31 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:17:31 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:17:31 - INFO - 새로운 가중치: {'gpt': 0.004116791801710375, 'ml': 0.20999672539945113, 'xgboost': 0.08543434444715817, 'rl': 0.028673730751243007, 'lstm': 0.14896846575537842, 'arima': 0.17818566942671885, 'prophet': 0.019663268171407164, 'transformer': 0.17037008905968193, 'bitcoin_forecast': 0.154590915187251}
2024-09-19 20:17:31 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:17:31 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:17:31 - INFO - Current BTC price: 83405000.0
2024-09-19 20:17:31 - INFO - Analyzing market conditions.
2024-09-19 20:17:31 - INFO - Market analysis: {'current_price': 83403000.0, 'sma_20': 83109100.0, 'rsi_14': 61.34793288323214, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 20:17:31 - INFO - Starting predictions for all models
2024-09-19 20:17:31 - INFO - Attempting prediction for gpt
2024-09-19 20:17:31 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:17:31 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:17:31 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:17:31 - INFO - GPT prediction: 83405000.0
2024-09-19 20:17:31 - INFO - Attempting prediction for ml
2024-09-19 20:17:31 - INFO - ML prediction: 83486402.99999999
2024-09-19 20:17:31 - INFO - Attempting prediction for xgboost
2024-09-19 20:17:31 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:17:31 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:17:31 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:17:31 - INFO - XGBOOST prediction: 83403000.0
2024-09-19 20:17:31 - INFO - Attempting prediction for lstm
2024-09-19 20:17:31 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:17:31 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:17:31 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:17:31 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:17:31 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:17:31 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:17:31 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:17:31 - INFO - X 샘플:
[[-1.79035643 -1.37012589 -1.39432355 -0.53918025  0.07117495  0.067299
  -0.53918025]
 [-0.2099755  -0.94984188 -0.01129007 -0.78996176 -0.81479286 -0.81506936
  -0.78996176]
 [-0.58095694 -0.02521704 -0.04892363 -0.20860462  2.23749028  2.23685298
  -0.20860462]
 [ 1.0513614   0.8994078   0.93895743  0.44114747  0.90983406  0.91391047
   0.44114747]
 [ 0.06455077  0.69977289  0.71315604  1.7862483  -0.53025695 -0.52921589
   1.7862483 ]
 [ 2.01591315  2.12873854  0.69433926  0.00797941  0.62100301  0.62430461
   0.00797941]
 [ 0.07939003 -0.01470994  0.77901478  0.24736176 -0.79777584 -0.79681686
   0.24736176]
 [ 0.53198739 -0.09876674  0.83546513  0.2359626  -1.1867644  -1.18559917
   0.2359626 ]
 [-0.2099755  -1.17049099 -2.1846284  -2.14646174  0.31741066  0.31183603
  -2.14646174]
 [-0.95193838 -0.09876674 -0.32176697  0.96550881 -0.82732291 -0.82750182
   0.96550881]]
2024-09-19 20:17:31 - INFO - y 샘플:
[0.96550881]
2024-09-19 20:17:31 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:17:31 - INFO - 모델 출력 (스케일링된 예측): [[0.34932613]]
2024-09-19 20:17:31 - INFO - 스케일러 역변환 후 예측 가격: 83348944.90262471
2024-09-19 20:17:31 - INFO - LSTMPredictor 최종 예측 가격: 83348944.90262471
2024-09-19 20:17:31 - INFO - LSTM prediction: 83348944.90262471
2024-09-19 20:17:31 - INFO - Attempting prediction for rl
2024-09-19 20:17:31 - INFO - Preparing state for RL agent.
2024-09-19 20:17:31 - INFO - Prepared state: [[8.34030000e+07 1.24859625e+01 3.28401299e-03 8.31091000e+07
  6.13479329e+01]]
2024-09-19 20:17:31 - INFO - RL prediction: 84239050.0
2024-09-19 20:17:31 - INFO - Attempting prediction for arima
2024-09-19 20:17:31 - INFO - ARIMA 예측 시작
2024-09-19 20:17:31 - INFO - 입력 데이터: {'open': 83200000.0, 'high': 83403000.0, 'low': 83198000.0, 'close': 83403000.0, 'volume': 12.48596246, 'value': 1039866652.7722, 'decision': 'sell', 'sma': 83109100.0, 'ema': 83158499.10481623, 'rsi': 61.34793288323214, 'macd': 129386.4759272337, 'signal_line': 114118.78170705223, 'BB_Upper': 83561436.99826193, 'BB_Lower': 82656763.00173807}
2024-09-19 20:17:31 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:17:31 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83109100.0         0         0
2024-09-19 20:17:31 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83109100.0         0         0
2024-09-19 20:17:31 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:17:31 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:17:31 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:17:31 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:17:31 - INFO - Attempting prediction for prophet
2024-09-19 20:17:32 - INFO - PROPHET prediction: 83462301.02307977
2024-09-19 20:17:32 - INFO - Attempting prediction for transformer
2024-09-19 20:17:32 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:17:32 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:17:32 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:17:32 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:17:32 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:17:32 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:17:32 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:17:32 - INFO - X 샘플:
[[-1.79035643 -1.37012589 -1.39432355 -0.53918025  0.07117495  0.067299
  -0.53918025 -0.53918025  0.          0.          0.         -0.53918025
  -0.53918025]
 [-0.2099755  -0.94984188 -0.01129007 -0.78996176 -0.81479286 -0.81506936
  -0.78996176 -0.78996176  0.          0.          0.         -0.78996176
  -0.78996176]
 [-0.58095694 -0.02521704 -0.04892363 -0.20860462  2.23749028  2.23685298
  -0.20860462 -0.20860462  0.          0.          0.         -0.20860462
  -0.20860462]
 [ 1.0513614   0.8994078   0.93895743  0.44114747  0.90983406  0.91391047
   0.44114747  0.44114747  0.          0.          0.          0.44114747
   0.44114747]
 [ 0.06455077  0.69977289  0.71315604  1.7862483  -0.53025695 -0.52921589
   1.7862483   1.7862483   0.          0.          0.          1.7862483
   1.7862483 ]
 [ 2.01591315  2.12873854  0.69433926  0.00797941  0.62100301  0.62430461
   0.00797941  0.00797941  0.          0.          0.          0.00797941
   0.00797941]
 [ 0.07939003 -0.01470994  0.77901478  0.24736176 -0.79777584 -0.79681686
   0.24736176  0.24736176  0.          0.          0.          0.24736176
   0.24736176]
 [ 0.53198739 -0.09876674  0.83546513  0.2359626  -1.1867644  -1.18559917
   0.2359626   0.2359626   0.          0.          0.          0.2359626
   0.2359626 ]
 [-0.2099755  -1.17049099 -2.1846284  -2.14646174  0.31741066  0.31183603
  -2.14646174 -2.14646174  0.          0.          0.         -2.14646174
  -2.14646174]
 [-0.95193838 -0.09876674 -0.32176697  0.96550881 -0.82732291 -0.82750182
   0.96550881  0.96550881  0.          0.          0.          0.96550881
   0.96550881]]
2024-09-19 20:17:32 - INFO - y 샘플:
[0.96550881]
2024-09-19 20:17:32 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:17:32 - INFO - 모델 출력 (스케일링된 예측): [0.28734]
2024-09-19 20:17:32 - INFO - 스케일러 역변환 후 예측 가격: 83343507.12028584
2024-09-19 20:17:32 - INFO - TransformerPredictor 최종 예측 가격: 83343507.12028584
2024-09-19 20:17:32 - INFO - TRANSFORMER prediction: 83343507.12028584
2024-09-19 20:17:32 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:17:32 - INFO - BITCOIN_FORECAST prediction: 82549090.68510012
2024-09-19 20:17:32 - INFO - BitcoinForecast prediction: 82549090.68510012
2024-09-19 20:17:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:17:40 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:17:40 - INFO - 조정된 모델 가중치: {'gpt': 0.004116791801710375, 'ml': 0.20999672539945113, 'xgboost': 0.08543434444715817, 'rl': 0.028673730751243007, 'lstm': 0.14896846575537842, 'arima': 0.17818566942671885, 'prophet': 0.019663268171407164, 'transformer': 0.17037008905968193, 'bitcoin_forecast': 0.154590915187251}
2024-09-19 20:17:40 - INFO - 조정된 모델 가중치: {'gpt': 0.004116791801710375, 'ml': 0.20999672539945113, 'xgboost': 0.08543434444715817, 'rl': 0.028673730751243007, 'lstm': 0.14896846575537842, 'arima': 0.17818566942671885, 'prophet': 0.019663268171407164, 'transformer': 0.17037008905968193, 'bitcoin_forecast': 0.154590915187251}
2024-09-19 20:17:40 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 82849289.46412696, 'current_price': 83405000.0, 'predictions': {'gpt': 83405000.0, 'ml': 83486402.99999999, 'xgboost': 83403000.0, 'lstm': 83348944.90262471, 'rl': 84239050.0, 'arima': 80899000.0, 'prophet': 83462301.02307977, 'transformer': 83343507.12028584, 'bitcoin_forecast': 82549090.68510012}, 'weights': {'gpt': 0.004116791801710375, 'ml': 0.20999672539945113, 'xgboost': 0.08543434444715817, 'rl': 0.028673730751243007, 'lstm': 0.14896846575537842, 'arima': 0.17818566942671885, 'prophet': 0.019663268171407164, 'transformer': 0.17037008905968193, 'bitcoin_forecast': 0.154590915187251}}
2024-09-19 20:17:40 - INFO - 모델별 가중치:
2024-09-19 20:17:40 - INFO -   - GPT: 0.0041
2024-09-19 20:17:40 - INFO -   - ML: 0.2100
2024-09-19 20:17:40 - INFO -   - XGBOOST: 0.0854
2024-09-19 20:17:40 - INFO -   - RL: 0.0287
2024-09-19 20:17:40 - INFO -   - LSTM: 0.1490
2024-09-19 20:17:40 - INFO -   - ARIMA: 0.1782
2024-09-19 20:17:40 - INFO -   - PROPHET: 0.0197
2024-09-19 20:17:40 - INFO -   - TRANSFORMER: 0.1704
2024-09-19 20:17:40 - INFO -   - BITCOIN_FORECAST: 0.1546
2024-09-19 20:17:40 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:17:40 - INFO - 6. 거래 실행
2024-09-19 20:17:40 - INFO - Cancelling existing orders.
2024-09-19 20:17:40 - INFO - Cancelled 1 orders.
2024-09-19 20:17:40 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 82849289.46412696, 'current_price': 83405000.0, 'predictions': {'gpt': 83405000.0, 'ml': 83486402.99999999, 'xgboost': 83403000.0, 'lstm': 83348944.90262471, 'rl': 84239050.0, 'arima': 80899000.0, 'prophet': 83462301.02307977, 'transformer': 83343507.12028584, 'bitcoin_forecast': 82549090.68510012}, 'weights': {'gpt': 0.004116791801710375, 'ml': 0.20999672539945113, 'xgboost': 0.08543434444715817, 'rl': 0.028673730751243007, 'lstm': 0.14896846575537842, 'arima': 0.17818566942671885, 'prophet': 0.019663268171407164, 'transformer': 0.17037008905968193, 'bitcoin_forecast': 0.154590915187251}}, 현재 가격=83405000.0
2024-09-19 20:17:40 - INFO - 현재 잔고: KRW=253404.54655087, BTC=0.00267762, 총 자산가치=476731.44265086995
2024-09-19 20:17:40 - INFO - 매도 시도: 0.000535524 BTC (약 44665.37922 KRW)
2024-09-19 20:17:40 - INFO - 주문 결과: {'uuid': '8360100b-f98d-44ed-8941-11a404f89cf1', 'side': 'ask', 'ord_type': 'limit', 'price': '83405000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:17:40+09:00', 'volume': '0.00053552', 'remaining_volume': '0.00053552', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00053552', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:17:40 - INFO - sell 주문 성공: UUID=8360100b-f98d-44ed-8941-11a404f89cf1
2024-09-19 20:17:40 - INFO - Trade executed successfully.
2024-09-19 20:17:40 - INFO - 7. summary 리포트 보내기
2024-09-19 20:17:40 - INFO - Message sent to Discord successfully.
2024-09-19 20:17:40 - INFO - Trading cycle completed.
2024-09-19 20:17:40 - INFO - Performing periodic update.
2024-09-19 20:17:40 - INFO - 계산된 시장 변동성: 0.03546122890869918
2024-09-19 20:25:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:25:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8158-9c28-d5e7daa6d376 "HTTP/1.1 200 OK"
2024-09-19 20:25:50 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:25:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8152-a62e-e443a5391282 "HTTP/1.1 200 OK"
2024-09-19 20:25:57 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8146-93d2-d11eaaf0f7c5 "HTTP/1.1 200 OK"
2024-09-19 20:26:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/2222bbb4-a7eb-43a5-874e-a1e10a4942d3 "HTTP/1.1 200 OK"
2024-09-19 20:26:09 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cd-8f03-f94403c7848e "HTTP/1.1 200 OK"
2024-09-19 20:26:22 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bf-abfa-e1507b0c3a3d "HTTP/1.1 200 OK"
2024-09-19 20:26:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8156-9b20-fe830a070044 "HTTP/1.1 200 OK"
2024-09-19 20:26:43 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d4-9e2e-e24d1642bab3 "HTTP/1.1 200 OK"
2024-09-19 20:26:49 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:26:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/1583d692-e725-4f89-8de7-257585ba9634 "HTTP/1.1 200 OK"
2024-09-19 20:26:57 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:15:34.936454
2024-09-19 20:26:57 - INFO - Starting trading cycle.
2024-09-19 20:26:57 - INFO - ##################################################
2024-09-19 20:26:57 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-19 20:26:57 - INFO - ##################################################
2024-09-19 20:26:57 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:26:57 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:26:57 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:10:00
2024-09-19 20:26:57 - INFO - 새로운 데이터 범위: 2024-09-18 11:10:00 ~ 2024-09-19 20:20:00
2024-09-19 20:26:57 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:26:57 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:26:57 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:26:57 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:26:57 - INFO - Sample date values: [Timestamp('2024-09-19 20:20:00')]
2024-09-19 20:26:57 - INFO - Successfully added 1 new data points
2024-09-19 20:26:57 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:26:57 - INFO - Final date range: 2024-09-19 20:20:00 to 2024-09-19 20:20:00
2024-09-19 20:26:57 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:26:57 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:20:00
2024-09-19 20:26:57 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:26:57 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:26:57 - INFO - GPT | 이전예측가격: 83405000 | 당시BTC가격: 83405000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:26:57 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 10/20
2024-09-19 20:26:57 - INFO - ML | 이전예측가격: 83486403 | 당시BTC가격: 83405000 | 예측: 상승 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2264 | 반영가중치값: -0.0200 | 새 가중치: 0.2064 | 예측 총 횟수: 20 | 예측 성공 수: 10 | 예측 성공률: 50.00%
2024-09-19 20:26:57 - INFO - XGBOOST | 이전예측가격: 83403000 | 당시BTC가격: 83405000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:26:57 - INFO - LSTM 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-19 20:26:57 - INFO - LSTM | 이전예측가격: 83348945 | 당시BTC가격: 83405000 | 예측: 하락 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-19 20:26:57 - INFO - RL 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-19 20:26:57 - INFO - RL | 이전예측가격: 84239050 | 당시BTC가격: 83405000 | 예측: 상승 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3060 | 반영가중치값: -0.0200 | 새 가중치: 0.2860 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-19 20:26:57 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.21%, 적중/전체: 116/214
2024-09-19 20:26:57 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83405000 | 예측: 하락 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0194 | 반영가중치값: 0.0200 | 새 가중치: 0.0394 | 예측 총 횟수: 214 | 예측 성공 수: 116 | 예측 성공률: 54.21%
2024-09-19 20:26:57 - INFO - PROPHET 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 10/18
2024-09-19 20:26:57 - INFO - PROPHET | 이전예측가격: 83462301 | 당시BTC가격: 83405000 | 예측: 상승 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0789 | 반영가중치값: -0.0200 | 새 가중치: 0.0589 | 예측 총 횟수: 18 | 예측 성공 수: 10 | 예측 성공률: 55.56%
2024-09-19 20:26:57 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-19 20:26:58 - INFO - TRANSFORMER | 이전예측가격: 83343507 | 당시BTC가격: 83405000 | 예측: 하락 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-19 20:26:58 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 20:26:58 - INFO - BITCOIN_FORECAST | 이전예측가격: 82549091 | 당시BTC가격: 83405000 | 예측: 하락 | 지금 BTC가격: 83391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 20:26:58 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:26:58 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:26:58 - INFO - 새로운 가중치: {'gpt': 0.0036912123946620783, 'ml': 0.185103598978645, 'xgboost': 0.0766024434420416, 'rl': 0.2564648147051851, 'lstm': 0.13001041174917682, 'arima': 0.03531622394358941, 'prophet': 0.052790471288346366, 'transformer': 0.13001041174917682, 'bitcoin_forecast': 0.13001041174917682}
2024-09-19 20:26:58 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:26:58 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:26:58 - INFO - Current BTC price: 83391000.0
2024-09-19 20:26:58 - INFO - Analyzing market conditions.
2024-09-19 20:26:58 - INFO - Market analysis: {'current_price': 83391000.0, 'sma_20': 83132900.0, 'rsi_14': 60.7955599087935, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 20:26:58 - INFO - Starting predictions for all models
2024-09-19 20:26:58 - INFO - Attempting prediction for gpt
2024-09-19 20:26:58 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:26:58 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:26:58 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:26:58 - INFO - GPT prediction: 83391000.0
2024-09-19 20:26:58 - INFO - Attempting prediction for ml
2024-09-19 20:26:58 - INFO - ML prediction: 83457712.8
2024-09-19 20:26:58 - INFO - Attempting prediction for xgboost
2024-09-19 20:26:58 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:26:58 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:26:58 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:26:58 - INFO - XGBOOST prediction: 83391000.0
2024-09-19 20:26:58 - INFO - Attempting prediction for lstm
2024-09-19 20:26:58 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:26:58 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:26:58 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:26:58 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:26:58 - INFO - X 샘플:
[[-0.5122555  -1.20629565 -0.28552247 -0.9172188  -0.71107035 -0.71188142
  -0.9172188 ]
 [-0.97457996 -0.1706467  -0.3257369  -0.34184169  2.26331595  2.26226208
  -0.34184169]
 [ 1.05964766  0.86500225  0.72989194  0.30122684  0.96954264  0.97303502
   0.30122684]
 [-0.1701354   0.64139623  0.48860535  1.63249152 -0.43379604 -0.43331298
   1.63249152]
 [ 2.26169125  2.2419446   0.46849813 -0.12748552  0.6880828   0.69080983
  -0.12748552]
 [-0.15164242 -0.15887796  0.55898061  0.10943447 -0.69448763 -0.69409409
   0.10943447]
 [ 0.41239342 -0.25302787  0.61930225  0.09815257 -1.07354887 -1.0729682
   0.09815257]
 [-0.5122555  -1.45343915 -2.60790592 -2.25976538  0.39223838  0.38630457
  -2.25976538]
 [-1.43690441 -0.25302787 -0.61729153  0.82019443 -0.72328063 -0.72399703
   0.82019443]
 [ 0.02404087 -0.25302787  0.97117853  0.68481158 -0.67699626 -0.67615778
   0.68481158]]
2024-09-19 20:26:58 - INFO - y 샘플:
[0.68481158]
2024-09-19 20:26:58 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:26:58 - INFO - 모델 출력 (스케일링된 예측): [[0.35137534]]
2024-09-19 20:26:58 - INFO - 스케일러 역변환 후 예측 가격: 83361445.03894785
2024-09-19 20:26:58 - INFO - LSTMPredictor 최종 예측 가격: 83361445.03894785
2024-09-19 20:26:58 - INFO - LSTM prediction: 83361445.03894785
2024-09-19 20:26:58 - INFO - Attempting prediction for rl
2024-09-19 20:26:58 - INFO - Preparing state for RL agent.
2024-09-19 20:26:58 - INFO - Prepared state: [[ 8.33910000e+07  1.29953132e+01 -1.43879717e-04  8.31329000e+07
   6.07955599e+01]]
2024-09-19 20:26:58 - INFO - RL prediction: 84224910.0
2024-09-19 20:26:58 - INFO - Attempting prediction for arima
2024-09-19 20:26:58 - INFO - ARIMA 예측 시작
2024-09-19 20:26:58 - INFO - 입력 데이터: {'open': 83358000.0, 'high': 83403000.0, 'low': 83356000.0, 'close': 83391000.0, 'volume': 12.99531321, 'value': 1083768954.97774, 'decision': 'sell', 'sma': 83132900.0, 'ema': 83180642.04721469, 'rsi': 60.7955599087935, 'macd': 131843.3191050887, 'signal_line': 117663.68918665954, 'BB_Upper': 83591922.39597128, 'BB_Lower': 82673877.60402872}
2024-09-19 20:26:58 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:26:58 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83132900.0         0         0
2024-09-19 20:26:58 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83132900.0         0         0
2024-09-19 20:26:58 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:26:58 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:26:58 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:26:58 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:26:58 - INFO - Attempting prediction for prophet
2024-09-19 20:26:58 - INFO - PROPHET prediction: 83447305.30271006
2024-09-19 20:26:58 - INFO - Attempting prediction for transformer
2024-09-19 20:26:58 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:26:58 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:26:58 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:26:58 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:26:58 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:26:58 - INFO - X 샘플:
[[-0.5122555  -1.20629565 -0.28552247 -0.9172188  -0.71107035 -0.71188142
  -0.9172188  -0.9172188   0.          0.          0.         -0.9172188
  -0.9172188 ]
 [-0.97457996 -0.1706467  -0.3257369  -0.34184169  2.26331595  2.26226208
  -0.34184169 -0.34184169  0.          0.          0.         -0.34184169
  -0.34184169]
 [ 1.05964766  0.86500225  0.72989194  0.30122684  0.96954264  0.97303502
   0.30122684  0.30122684  0.          0.          0.          0.30122684
   0.30122684]
 [-0.1701354   0.64139623  0.48860535  1.63249152 -0.43379604 -0.43331298
   1.63249152  1.63249152  0.          0.          0.          1.63249152
   1.63249152]
 [ 2.26169125  2.2419446   0.46849813 -0.12748552  0.6880828   0.69080983
  -0.12748552 -0.12748552  0.          0.          0.         -0.12748552
  -0.12748552]
 [-0.15164242 -0.15887796  0.55898061  0.10943447 -0.69448763 -0.69409409
   0.10943447  0.10943447  0.          0.          0.          0.10943447
   0.10943447]
 [ 0.41239342 -0.25302787  0.61930225  0.09815257 -1.07354887 -1.0729682
   0.09815257  0.09815257  0.          0.          0.          0.09815257
   0.09815257]
 [-0.5122555  -1.45343915 -2.60790592 -2.25976538  0.39223838  0.38630457
  -2.25976538 -2.25976538  0.          0.          0.         -2.25976538
  -2.25976538]
 [-1.43690441 -0.25302787 -0.61729153  0.82019443 -0.72328063 -0.72399703
   0.82019443  0.82019443  0.          0.          0.          0.82019443
   0.82019443]
 [ 0.02404087 -0.25302787  0.97117853  0.68481158 -0.67699626 -0.67615778
   0.68481158  0.68481158  0.          0.          0.          0.68481158
   0.68481158]]
2024-09-19 20:26:58 - INFO - y 샘플:
[0.68481158]
2024-09-19 20:26:58 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:26:58 - INFO - 모델 출력 (스케일링된 예측): [0.28997508]
2024-09-19 20:26:58 - INFO - 스케일러 역변환 후 예측 가격: 83356002.67175837
2024-09-19 20:26:58 - INFO - TransformerPredictor 최종 예측 가격: 83356002.67175837
2024-09-19 20:26:58 - INFO - TRANSFORMER prediction: 83356002.67175837
2024-09-19 20:26:58 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:26:58 - INFO - BITCOIN_FORECAST prediction: 82546122.6015692
2024-09-19 20:26:58 - INFO - BitcoinForecast prediction: 82546122.6015692
2024-09-19 20:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:27:12 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:27:12 - INFO - 조정된 모델 가중치: {'gpt': 0.0036912123946620783, 'ml': 0.185103598978645, 'xgboost': 0.0766024434420416, 'rl': 0.2564648147051851, 'lstm': 0.13001041174917682, 'arima': 0.03531622394358941, 'prophet': 0.052790471288346366, 'transformer': 0.13001041174917682, 'bitcoin_forecast': 0.13001041174917682}
2024-09-19 20:27:12 - INFO - 조정된 모델 가중치: {'gpt': 0.0036912123946620783, 'ml': 0.185103598978645, 'xgboost': 0.0766024434420416, 'rl': 0.2564648147051851, 'lstm': 0.13001041174917682, 'arima': 0.03531622394358941, 'prophet': 0.052790471288346366, 'transformer': 0.13001041174917682, 'bitcoin_forecast': 0.13001041174917682}
2024-09-19 20:27:12 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83413946.37824942, 'current_price': 83391000.0, 'predictions': {'gpt': 83391000.0, 'ml': 83457712.8, 'xgboost': 83391000.0, 'lstm': 83361445.03894785, 'rl': 84224910.0, 'arima': 80899000.0, 'prophet': 83447305.30271006, 'transformer': 83356002.67175837, 'bitcoin_forecast': 82546122.6015692}, 'weights': {'gpt': 0.0036912123946620783, 'ml': 0.185103598978645, 'xgboost': 0.0766024434420416, 'rl': 0.2564648147051851, 'lstm': 0.13001041174917682, 'arima': 0.03531622394358941, 'prophet': 0.052790471288346366, 'transformer': 0.13001041174917682, 'bitcoin_forecast': 0.13001041174917682}}
2024-09-19 20:27:12 - INFO - 모델별 가중치:
2024-09-19 20:27:12 - INFO -   - GPT: 0.0037
2024-09-19 20:27:12 - INFO -   - ML: 0.1851
2024-09-19 20:27:12 - INFO -   - XGBOOST: 0.0766
2024-09-19 20:27:12 - INFO -   - RL: 0.2565
2024-09-19 20:27:12 - INFO -   - LSTM: 0.1300
2024-09-19 20:27:12 - INFO -   - ARIMA: 0.0353
2024-09-19 20:27:12 - INFO -   - PROPHET: 0.0528
2024-09-19 20:27:12 - INFO -   - TRANSFORMER: 0.1300
2024-09-19 20:27:12 - INFO -   - BITCOIN_FORECAST: 0.1300
2024-09-19 20:27:12 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:27:12 - INFO - 6. 거래 실행
2024-09-19 20:27:12 - INFO - Cancelling existing orders.
2024-09-19 20:27:12 - INFO - Cancelled 0 orders.
2024-09-19 20:27:12 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83413946.37824942, 'current_price': 83391000.0, 'predictions': {'gpt': 83391000.0, 'ml': 83457712.8, 'xgboost': 83391000.0, 'lstm': 83361445.03894785, 'rl': 84224910.0, 'arima': 80899000.0, 'prophet': 83447305.30271006, 'transformer': 83356002.67175837, 'bitcoin_forecast': 82546122.6015692}, 'weights': {'gpt': 0.0036912123946620783, 'ml': 0.185103598978645, 'xgboost': 0.0766024434420416, 'rl': 0.2564648147051851, 'lstm': 0.13001041174917682, 'arima': 0.03531622394358941, 'prophet': 0.052790471288346366, 'transformer': 0.13001041174917682, 'bitcoin_forecast': 0.13001041174917682}}, 현재 가격=83391000.0
2024-09-19 20:27:12 - INFO - 현재 잔고: KRW=298047.25962807, BTC=0.0021421, 총 자산가치=476679.12072807003
2024-09-19 20:27:12 - INFO - 매수 시도: 0.0005716193842597763 BTC (약 47667.912072807005 KRW)
2024-09-19 20:27:12 - INFO - 주문 결과: {'uuid': '3c78f921-b1a5-4a3d-a65d-db69bd53aaa7', 'side': 'bid', 'ord_type': 'limit', 'price': '83391000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:27:12+09:00', 'volume': '0.00057161', 'remaining_volume': '0.00057161', 'reserved_fee': '23.833564755', 'remaining_fee': '23.833564755', 'paid_fee': '0', 'locked': '47690.963074755', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:27:12 - INFO - buy 주문 성공: UUID=3c78f921-b1a5-4a3d-a65d-db69bd53aaa7
2024-09-19 20:27:12 - INFO - Trade executed successfully.
2024-09-19 20:27:12 - INFO - 7. summary 리포트 보내기
2024-09-19 20:27:13 - INFO - Message sent to Discord successfully.
2024-09-19 20:27:13 - INFO - Trading cycle completed.
2024-09-19 20:27:13 - INFO - Performing periodic update.
2024-09-19 20:27:13 - INFO - 계산된 시장 변동성: 0.034943920053881125
2024-09-19 20:35:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f8-a2c5-e81220c44d7d "HTTP/1.1 200 OK"
2024-09-19 20:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:35:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:35:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ff-89e8-ed57330345f1 "HTTP/1.1 200 OK"
2024-09-19 20:35:50 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:35:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:35:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811e-a20c-f67780850440 "HTTP/1.1 200 OK"
2024-09-19 20:35:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-9afb-f34faa9e214e "HTTP/1.1 200 OK"
2024-09-19 20:36:04 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-94b5-e5b7c844f192 "HTTP/1.1 200 OK"
2024-09-19 20:36:10 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a8-8865-df05020b17bf "HTTP/1.1 200 OK"
2024-09-19 20:36:24 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-8aaf-e589f54b5d4c "HTTP/1.1 200 OK"
2024-09-19 20:36:33 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-8405-fbc1b7f9301e "HTTP/1.1 200 OK"
2024-09-19 20:36:41 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:36:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-8ca7-d0532fe1ad24 "HTTP/1.1 200 OK"
2024-09-19 20:36:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:25:34.936516
2024-09-19 20:36:48 - INFO - Starting trading cycle.
2024-09-19 20:36:48 - INFO - ##################################################
2024-09-19 20:36:48 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-19 20:36:48 - INFO - ##################################################
2024-09-19 20:36:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:36:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:36:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:20:00
2024-09-19 20:36:48 - INFO - 새로운 데이터 범위: 2024-09-18 11:20:00 ~ 2024-09-19 20:30:00
2024-09-19 20:36:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:36:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:36:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:36:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:36:48 - INFO - Sample date values: [Timestamp('2024-09-19 20:30:00')]
2024-09-19 20:36:48 - INFO - Successfully added 1 new data points
2024-09-19 20:36:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:36:48 - INFO - Final date range: 2024-09-19 20:30:00 to 2024-09-19 20:30:00
2024-09-19 20:36:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:36:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:30:00
2024-09-19 20:36:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:36:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:36:49 - INFO - GPT | 이전예측가격: 83391000 | 당시BTC가격: 83391000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:36:49 - INFO - ML 모델 예측 업데이트: 정확도 52.38%, 적중/전체: 11/21
2024-09-19 20:36:49 - INFO - ML | 이전예측가격: 83457713 | 당시BTC가격: 83391000 | 예측: 상승 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2100 | 반영가중치값: 0.0200 | 새 가중치: 0.2300 | 예측 총 횟수: 21 | 예측 성공 수: 11 | 예측 성공률: 52.38%
2024-09-19 20:36:49 - INFO - XGBOOST | 이전예측가격: 83391000 | 당시BTC가격: 83391000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:36:49 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 20:36:49 - INFO - LSTM | 이전예측가격: 83361445 | 당시BTC가격: 83391000 | 예측: 하락 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1490 | 반영가중치값: -0.0200 | 새 가중치: 0.1290 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 20:36:49 - INFO - RL 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 14/23
2024-09-19 20:36:49 - INFO - RL | 이전예측가격: 84224910 | 당시BTC가격: 83391000 | 예측: 상승 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0287 | 반영가중치값: 0.0200 | 새 가중치: 0.0487 | 예측 총 횟수: 23 | 예측 성공 수: 14 | 예측 성공률: 60.87%
2024-09-19 20:36:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.95%, 적중/전체: 116/215
2024-09-19 20:36:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83391000 | 예측: 하락 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1782 | 반영가중치값: -0.0200 | 새 가중치: 0.1582 | 예측 총 횟수: 215 | 예측 성공 수: 116 | 예측 성공률: 53.95%
2024-09-19 20:36:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 11/19
2024-09-19 20:36:49 - INFO - PROPHET | 이전예측가격: 83447305 | 당시BTC가격: 83391000 | 예측: 상승 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0197 | 반영가중치값: 0.0200 | 새 가중치: 0.0397 | 예측 총 횟수: 19 | 예측 성공 수: 11 | 예측 성공률: 57.89%
2024-09-19 20:36:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 20:36:49 - INFO - TRANSFORMER | 이전예측가격: 83356003 | 당시BTC가격: 83391000 | 예측: 하락 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1704 | 반영가중치값: -0.0200 | 새 가중치: 0.1504 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 20:36:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-19 20:36:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 82546123 | 당시BTC가격: 83391000 | 예측: 하락 | 지금 BTC가격: 83544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1546 | 반영가중치값: -0.0200 | 새 가중치: 0.1346 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-19 20:36:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:36:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:36:49 - INFO - 새로운 가중치: {'gpt': 0.0038024628778281183, 'ml': 0.23692866105947927, 'xgboost': 0.07891118591834838, 'rl': 0.05014072194129217, 'lstm': 0.13285548243022957, 'arima': 0.16295327157801068, 'prophet': 0.04085869050863012, 'transformer': 0.1549021352474878, 'bitcoin_forecast': 0.1386473884386939}
2024-09-19 20:36:49 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:36:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:36:49 - INFO - Current BTC price: 83544000.0
2024-09-19 20:36:49 - INFO - Analyzing market conditions.
2024-09-19 20:36:49 - INFO - Market analysis: {'current_price': 83544000.0, 'sma_20': 83163750.0, 'rsi_14': 65.10915029351747, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 20:36:49 - INFO - Starting predictions for all models
2024-09-19 20:36:49 - INFO - Attempting prediction for gpt
2024-09-19 20:36:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:36:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:36:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:36:49 - INFO - GPT prediction: 83544000.0
2024-09-19 20:36:49 - INFO - Attempting prediction for ml
2024-09-19 20:36:49 - INFO - ML prediction: 83627543.99999999
2024-09-19 20:36:49 - INFO - Attempting prediction for xgboost
2024-09-19 20:36:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:36:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:36:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:36:49 - INFO - XGBOOST prediction: 83544000.0
2024-09-19 20:36:49 - INFO - Attempting prediction for lstm
2024-09-19 20:36:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:36:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:36:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:36:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:36:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:36:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:36:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:36:49 - INFO - X 샘플:
[[-1.07218693 -0.43599448 -0.45360192 -0.57298622  2.26140698  2.26025701
  -0.57298622]
 [ 0.98431808  0.60660101  0.53865228 -0.02682879  0.93111481  0.93451575
  -0.02682879]
 [-0.25893268  0.38149517  0.31185132  1.10381292 -0.51183539 -0.51166363
   1.10381292]
 [ 2.19952558  1.9927791   0.29295124 -0.39093374  0.64171031  0.64429721
  -0.39093374]
 [-0.24023718 -0.4241468   0.3780016  -0.18971785 -0.77988542 -0.77983072
  -0.18971785]
 [ 0.32997558 -0.51892821  0.43470184 -0.19929955 -1.16964628 -1.16943552
  -0.19929955]
 [-0.60479943 -1.72739116 -2.598761   -2.20187681  0.3375152   0.33116758
  -2.20187681]
 [-1.53957443 -0.51892821 -0.72765308  0.41392984 -0.80949115 -0.81058059
   0.41392984]
 [-0.06262993 -0.51892821  0.76545324  0.29894933 -0.76190033 -0.76138641
   0.29894933]
 [ 0.26454133  1.16344178  1.05840448  1.76495087 -0.13898873 -0.13734069
   1.76495087]]
2024-09-19 20:36:49 - INFO - y 샘플:
[1.76495087]
2024-09-19 20:36:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:36:49 - INFO - 모델 출력 (스케일링된 예측): [[0.3789456]]
2024-09-19 20:36:49 - INFO - 스케일러 역변환 후 예측 가격: 83399348.85025045
2024-09-19 20:36:49 - INFO - LSTMPredictor 최종 예측 가격: 83399348.85025045
2024-09-19 20:36:49 - INFO - LSTM prediction: 83399348.85025045
2024-09-19 20:36:49 - INFO - Attempting prediction for rl
2024-09-19 20:36:49 - INFO - Preparing state for RL agent.
2024-09-19 20:36:49 - INFO - Prepared state: [[8.35440000e+07 1.96621554e+01 1.83473037e-03 8.31637500e+07
  6.51091503e+01]]
2024-09-19 20:36:49 - INFO - RL prediction: 84379440.0
2024-09-19 20:36:49 - INFO - Attempting prediction for arima
2024-09-19 20:36:49 - INFO - ARIMA 예측 시작
2024-09-19 20:36:49 - INFO - 입력 데이터: {'open': 83393000.0, 'high': 83545000.0, 'low': 83387000.0, 'close': 83544000.0, 'volume': 19.66215536, 'value': 1640685367.7422, 'decision': 'sell', 'sma': 83163750.0, 'ema': 83215247.56652758, 'rsi': 65.10915029351747, 'macd': 144470.83647683263, 'signal_line': 123025.11864469416, 'BB_Upper': 83645638.31693475, 'BB_Lower': 82681861.68306525}
2024-09-19 20:36:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:36:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83163750.0         0         0
2024-09-19 20:36:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83163750.0         0         0
2024-09-19 20:36:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:36:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:36:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:36:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:36:49 - INFO - Attempting prediction for prophet
2024-09-19 20:36:50 - INFO - PROPHET prediction: 83627246.1639916
2024-09-19 20:36:50 - INFO - Attempting prediction for transformer
2024-09-19 20:36:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:36:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:36:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:36:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:36:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:36:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:36:50 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:36:50 - INFO - X 샘플:
[[-1.07218693 -0.43599448 -0.45360192 -0.57298622  2.26140698  2.26025701
  -0.57298622 -0.57298622  0.          0.          0.         -0.57298622
  -0.57298622]
 [ 0.98431808  0.60660101  0.53865228 -0.02682879  0.93111481  0.93451575
  -0.02682879 -0.02682879  0.          0.          0.         -0.02682879
  -0.02682879]
 [-0.25893268  0.38149517  0.31185132  1.10381292 -0.51183539 -0.51166363
   1.10381292  1.10381292  0.          0.          0.          1.10381292
   1.10381292]
 [ 2.19952558  1.9927791   0.29295124 -0.39093374  0.64171031  0.64429721
  -0.39093374 -0.39093374  0.          0.          0.         -0.39093374
  -0.39093374]
 [-0.24023718 -0.4241468   0.3780016  -0.18971785 -0.77988542 -0.77983072
  -0.18971785 -0.18971785  0.          0.          0.         -0.18971785
  -0.18971785]
 [ 0.32997558 -0.51892821  0.43470184 -0.19929955 -1.16964628 -1.16943552
  -0.19929955 -0.19929955  0.          0.          0.         -0.19929955
  -0.19929955]
 [-0.60479943 -1.72739116 -2.598761   -2.20187681  0.3375152   0.33116758
  -2.20187681 -2.20187681  0.          0.          0.         -2.20187681
  -2.20187681]
 [-1.53957443 -0.51892821 -0.72765308  0.41392984 -0.80949115 -0.81058059
   0.41392984  0.41392984  0.          0.          0.          0.41392984
   0.41392984]
 [-0.06262993 -0.51892821  0.76545324  0.29894933 -0.76190033 -0.76138641
   0.29894933  0.29894933  0.          0.          0.          0.29894933
   0.29894933]
 [ 0.26454133  1.16344178  1.05840448  1.76495087 -0.13898873 -0.13734069
   1.76495087  1.76495087  0.          0.          0.          1.76495087
   1.76495087]]
2024-09-19 20:36:50 - INFO - y 샘플:
[1.76495087]
2024-09-19 20:36:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:36:50 - INFO - 모델 출력 (스케일링된 예측): [0.2929838]
2024-09-19 20:36:50 - INFO - 스케일러 역변환 후 예측 가격: 83390377.40417936
2024-09-19 20:36:50 - INFO - TransformerPredictor 최종 예측 가격: 83390377.40417936
2024-09-19 20:36:50 - INFO - TRANSFORMER prediction: 83390377.40417936
2024-09-19 20:36:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:36:50 - INFO - BITCOIN_FORECAST prediction: 82622861.3309229
2024-09-19 20:36:50 - INFO - BitcoinForecast prediction: 82622861.3309229
2024-09-19 20:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:37:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:37:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0038024628778281183, 'ml': 0.23692866105947927, 'xgboost': 0.07891118591834838, 'rl': 0.05014072194129217, 'lstm': 0.13285548243022957, 'arima': 0.16295327157801068, 'prophet': 0.04085869050863012, 'transformer': 0.1549021352474878, 'bitcoin_forecast': 0.1386473884386939}
2024-09-19 20:37:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0038024628778281183, 'ml': 0.23692866105947927, 'xgboost': 0.07891118591834838, 'rl': 0.05014072194129217, 'lstm': 0.13285548243022957, 'arima': 0.16295327157801068, 'prophet': 0.04085869050863012, 'transformer': 0.1549021352474878, 'bitcoin_forecast': 0.1386473884386939}
2024-09-19 20:37:00 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 83007345.82146853, 'current_price': 83544000.0, 'predictions': {'gpt': 83544000.0, 'ml': 83627543.99999999, 'xgboost': 83544000.0, 'lstm': 83399348.85025045, 'rl': 84379440.0, 'arima': 80899000.0, 'prophet': 83627246.1639916, 'transformer': 83390377.40417936, 'bitcoin_forecast': 82622861.3309229}, 'weights': {'gpt': 0.0038024628778281183, 'ml': 0.23692866105947927, 'xgboost': 0.07891118591834838, 'rl': 0.05014072194129217, 'lstm': 0.13285548243022957, 'arima': 0.16295327157801068, 'prophet': 0.04085869050863012, 'transformer': 0.1549021352474878, 'bitcoin_forecast': 0.1386473884386939}}
2024-09-19 20:37:00 - INFO - 모델별 가중치:
2024-09-19 20:37:00 - INFO -   - GPT: 0.0038
2024-09-19 20:37:00 - INFO -   - ML: 0.2369
2024-09-19 20:37:00 - INFO -   - XGBOOST: 0.0789
2024-09-19 20:37:00 - INFO -   - RL: 0.0501
2024-09-19 20:37:00 - INFO -   - LSTM: 0.1329
2024-09-19 20:37:00 - INFO -   - ARIMA: 0.1630
2024-09-19 20:37:00 - INFO -   - PROPHET: 0.0409
2024-09-19 20:37:00 - INFO -   - TRANSFORMER: 0.1549
2024-09-19 20:37:00 - INFO -   - BITCOIN_FORECAST: 0.1386
2024-09-19 20:37:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:37:00 - INFO - 6. 거래 실행
2024-09-19 20:37:00 - INFO - Cancelling existing orders.
2024-09-19 20:37:00 - INFO - Cancelled 0 orders.
2024-09-19 20:37:00 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 83007345.82146853, 'current_price': 83544000.0, 'predictions': {'gpt': 83544000.0, 'ml': 83627543.99999999, 'xgboost': 83544000.0, 'lstm': 83399348.85025045, 'rl': 84379440.0, 'arima': 80899000.0, 'prophet': 83627246.1639916, 'transformer': 83390377.40417936, 'bitcoin_forecast': 82622861.3309229}, 'weights': {'gpt': 0.0038024628778281183, 'ml': 0.23692866105947927, 'xgboost': 0.07891118591834838, 'rl': 0.05014072194129217, 'lstm': 0.13285548243022957, 'arima': 0.16295327157801068, 'prophet': 0.04085869050863012, 'transformer': 0.1549021352474878, 'bitcoin_forecast': 0.1386473884386939}}, 현재 가격=83544000.0
2024-09-19 20:37:01 - INFO - 현재 잔고: KRW=250356.29655331, BTC=0.00271371, 총 자산가치=477070.48479331
2024-09-19 20:37:01 - INFO - 매도 시도: 0.000542742 BTC (약 45342.837648 KRW)
2024-09-19 20:37:01 - INFO - 주문 결과: {'uuid': '88863af3-ba49-41df-a983-cf1b82705add', 'side': 'ask', 'ord_type': 'limit', 'price': '83544000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:37:01+09:00', 'volume': '0.00054274', 'remaining_volume': '0.00054274', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00054274', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:37:01 - INFO - sell 주문 성공: UUID=88863af3-ba49-41df-a983-cf1b82705add
2024-09-19 20:37:01 - INFO - Trade executed successfully.
2024-09-19 20:37:01 - INFO - 7. summary 리포트 보내기
2024-09-19 20:37:01 - INFO - Message sent to Discord successfully.
2024-09-19 20:37:01 - INFO - Trading cycle completed.
2024-09-19 20:37:01 - INFO - Performing periodic update.
2024-09-19 20:37:01 - INFO - 계산된 시장 변동성: 0.03140406154256306
2024-09-19 20:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:45:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ed-ba1e-cb4113fb807a "HTTP/1.1 200 OK"
2024-09-19 20:45:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:45:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:45:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cd-8935-fe265e09e601 "HTTP/1.1 200 OK"
2024-09-19 20:45:48 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:45:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:45:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/4bb9f33e-0f5b-42ea-b4e7-d68a99a3ad34 "HTTP/1.1 200 OK"
2024-09-19 20:45:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8147-9e0f-d45de2ff6c0b "HTTP/1.1 200 OK"
2024-09-19 20:46:03 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-987e-c8bc77fae693 "HTTP/1.1 200 OK"
2024-09-19 20:46:10 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8147-b1d3-c4f3b285d80c "HTTP/1.1 200 OK"
2024-09-19 20:46:16 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8159-a179-e91b2e739fc4 "HTTP/1.1 200 OK"
2024-09-19 20:46:28 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8131-9082-c46d41494044 "HTTP/1.1 200 OK"
2024-09-19 20:46:39 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:46:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a9907fef-c590-489b-9530-314a812756f8 "HTTP/1.1 200 OK"
2024-09-19 20:46:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:35:34.936773
2024-09-19 20:46:45 - INFO - Starting trading cycle.
2024-09-19 20:46:45 - INFO - ##################################################
2024-09-19 20:46:45 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-19 20:46:45 - INFO - ##################################################
2024-09-19 20:46:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:46:45 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:46:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:30:00
2024-09-19 20:46:45 - INFO - 새로운 데이터 범위: 2024-09-18 11:30:00 ~ 2024-09-19 20:40:00
2024-09-19 20:46:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:46:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:46:45 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:46:45 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:46:45 - INFO - Sample date values: [Timestamp('2024-09-19 20:40:00')]
2024-09-19 20:46:45 - INFO - Successfully added 1 new data points
2024-09-19 20:46:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:46:45 - INFO - Final date range: 2024-09-19 20:40:00 to 2024-09-19 20:40:00
2024-09-19 20:46:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:46:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:40:00
2024-09-19 20:46:45 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:46:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:46:46 - INFO - GPT | 이전예측가격: 83544000 | 당시BTC가격: 83544000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:46:46 - INFO - ML 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 12/22
2024-09-19 20:46:46 - INFO - ML | 이전예측가격: 83627544 | 당시BTC가격: 83544000 | 예측: 상승 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1851 | 반영가중치값: 0.0200 | 새 가중치: 0.2051 | 예측 총 횟수: 22 | 예측 성공 수: 12 | 예측 성공률: 54.55%
2024-09-19 20:46:46 - INFO - XGBOOST | 이전예측가격: 83544000 | 당시BTC가격: 83544000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:46:46 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-19 20:46:46 - INFO - LSTM | 이전예측가격: 83399349 | 당시BTC가격: 83544000 | 예측: 하락 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1300 | 반영가중치값: -0.0200 | 새 가중치: 0.1100 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-19 20:46:46 - INFO - RL 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-19 20:46:46 - INFO - RL | 이전예측가격: 84379440 | 당시BTC가격: 83544000 | 예측: 상승 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2565 | 반영가중치값: 0.0200 | 새 가중치: 0.2765 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-19 20:46:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.70%, 적중/전체: 116/216
2024-09-19 20:46:46 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83544000 | 예측: 하락 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0353 | 반영가중치값: -0.0200 | 새 가중치: 0.0153 | 예측 총 횟수: 216 | 예측 성공 수: 116 | 예측 성공률: 53.70%
2024-09-19 20:46:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 12/20
2024-09-19 20:46:46 - INFO - PROPHET | 이전예측가격: 83627246 | 당시BTC가격: 83544000 | 예측: 상승 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0528 | 반영가중치값: 0.0200 | 새 가중치: 0.0728 | 예측 총 횟수: 20 | 예측 성공 수: 12 | 예측 성공률: 60.00%
2024-09-19 20:46:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-19 20:46:46 - INFO - TRANSFORMER | 이전예측가격: 83390377 | 당시BTC가격: 83544000 | 예측: 하락 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1300 | 반영가중치값: -0.0200 | 새 가중치: 0.1100 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-19 20:46:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 1/4
2024-09-19 20:46:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 82622861 | 당시BTC가격: 83544000 | 예측: 하락 | 지금 BTC가격: 83565000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1300 | 반영가중치값: -0.0200 | 새 가중치: 0.1100 | 예측 총 횟수: 4 | 예측 성공 수: 1 | 예측 성공률: 25.00%
2024-09-19 20:46:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:46:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:46:46 - INFO - 새로운 가중치: {'gpt': 0.003870506407726353, 'ml': 0.2087738446372457, 'xgboost': 0.08032326956278021, 'rl': 0.2814120403559315, 'lstm': 0.11197900341765032, 'arima': 0.015590301554684705, 'prophet': 0.07409302722868054, 'transformer': 0.11197900341765032, 'bitcoin_forecast': 0.11197900341765032}
2024-09-19 20:46:46 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:46:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:46:46 - INFO - Current BTC price: 83565000.0
2024-09-19 20:46:46 - INFO - Analyzing market conditions.
2024-09-19 20:46:46 - INFO - Market analysis: {'current_price': 83565000.0, 'sma_20': 83194700.0, 'rsi_14': 65.6675193946122, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 20:46:46 - INFO - Starting predictions for all models
2024-09-19 20:46:46 - INFO - Attempting prediction for gpt
2024-09-19 20:46:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:46:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:46:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:46:46 - INFO - GPT prediction: 83565000.0
2024-09-19 20:46:46 - INFO - Attempting prediction for ml
2024-09-19 20:46:46 - INFO - ML prediction: 83531574.0
2024-09-19 20:46:46 - INFO - Attempting prediction for xgboost
2024-09-19 20:46:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:46:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:46:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:46:46 - INFO - XGBOOST prediction: 83565000.0
2024-09-19 20:46:46 - INFO - Attempting prediction for lstm
2024-09-19 20:46:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:46:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:46:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:46:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:46:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:46:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:46:46 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:46:46 - INFO - X 샘플:
[[ 0.70339582  0.33989474  0.21178669 -0.24725069  1.48228572  1.4834274
  -0.24725069]
 [-0.50684537  0.13933573  0.02422652  0.74850295 -0.50121149 -0.50118678
   0.74850295]
 [ 1.88633833  1.57491602  0.00859651 -0.56791712  1.08446671  1.08515604
  -0.56791712]
 [-0.48864625 -0.57845441  0.07893157 -0.39070673 -0.86967638 -0.86919661
  -0.39070673]
 [ 0.06642677 -0.66290031  0.12582161 -0.39914532 -1.40544649 -1.40385726
  -0.39914532]
 [-0.84352901 -1.73958553 -2.38279563 -2.16281067  0.66631635  0.65544344
  -2.16281067]
 [-1.75348478 -0.66290031 -0.83542425  0.14092446 -0.91037278 -0.91139513
   0.14092446]
 [-0.31575465 -0.66290031  0.39934686  0.03966137 -0.84495385 -0.8438852
   0.03966137]
 [ 0.00272987  0.8360144   0.64161207  1.33076568  0.01130814  0.01250234
   1.33076568]
 [ 1.24936928  1.41657996  1.72789804  1.50797607  1.28728406  1.29299175
   1.50797607]]
2024-09-19 20:46:46 - INFO - y 샘플:
[1.50797607]
2024-09-19 20:46:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:46:46 - INFO - 모델 출력 (스케일링된 예측): [[0.3971387]]
2024-09-19 20:46:46 - INFO - 스케일러 역변환 후 예측 가격: 83433362.21121041
2024-09-19 20:46:46 - INFO - LSTMPredictor 최종 예측 가격: 83433362.21121041
2024-09-19 20:46:46 - INFO - LSTM prediction: 83433362.21121041
2024-09-19 20:46:46 - INFO - Attempting prediction for rl
2024-09-19 20:46:46 - INFO - Preparing state for RL agent.
2024-09-19 20:46:46 - INFO - Prepared state: [[8.35650000e+07 2.95968834e+01 2.51364550e-04 8.31947000e+07
  6.56675194e+01]]
2024-09-19 20:46:46 - INFO - RL prediction: 84400650.0
2024-09-19 20:46:46 - INFO - Attempting prediction for arima
2024-09-19 20:46:46 - INFO - ARIMA 예측 시작
2024-09-19 20:46:46 - INFO - 입력 데이터: {'open': 83530000.0, 'high': 83600000.0, 'low': 83526000.0, 'close': 83565000.0, 'volume': 29.59688341, 'value': 2473398978.30667, 'decision': 'sell', 'sma': 83194700.0, 'ema': 83248557.32209638, 'rsi': 65.6675193946122, 'macd': 154393.01291935146, 'signal_line': 129298.69749962562, 'BB_Upper': 83695800.82817893, 'BB_Lower': 82693599.17182107}
2024-09-19 20:46:46 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:46:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83194700.0         0         0
2024-09-19 20:46:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83194700.0         0         0
2024-09-19 20:46:46 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:46:46 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:46:46 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:46:46 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:46:46 - INFO - Attempting prediction for prophet
2024-09-19 20:46:47 - INFO - PROPHET prediction: 83656505.09303159
2024-09-19 20:46:47 - INFO - Attempting prediction for transformer
2024-09-19 20:46:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:46:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:46:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:46:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:46:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:46:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:46:47 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:46:47 - INFO - X 샘플:
[[ 0.70339582  0.33989474  0.21178669 -0.24725069  1.48228572  1.4834274
  -0.24725069 -0.24725069  0.          0.          0.         -0.24725069
  -0.24725069]
 [-0.50684537  0.13933573  0.02422652  0.74850295 -0.50121149 -0.50118678
   0.74850295  0.74850295  0.          0.          0.          0.74850295
   0.74850295]
 [ 1.88633833  1.57491602  0.00859651 -0.56791712  1.08446671  1.08515604
  -0.56791712 -0.56791712  0.          0.          0.         -0.56791712
  -0.56791712]
 [-0.48864625 -0.57845441  0.07893157 -0.39070673 -0.86967638 -0.86919661
  -0.39070673 -0.39070673  0.          0.          0.         -0.39070673
  -0.39070673]
 [ 0.06642677 -0.66290031  0.12582161 -0.39914532 -1.40544649 -1.40385726
  -0.39914532 -0.39914532  0.          0.          0.         -0.39914532
  -0.39914532]
 [-0.84352901 -1.73958553 -2.38279563 -2.16281067  0.66631635  0.65544344
  -2.16281067 -2.16281067  0.          0.          0.         -2.16281067
  -2.16281067]
 [-1.75348478 -0.66290031 -0.83542425  0.14092446 -0.91037278 -0.91139513
   0.14092446  0.14092446  0.          0.          0.          0.14092446
   0.14092446]
 [-0.31575465 -0.66290031  0.39934686  0.03966137 -0.84495385 -0.8438852
   0.03966137  0.03966137  0.          0.          0.          0.03966137
   0.03966137]
 [ 0.00272987  0.8360144   0.64161207  1.33076568  0.01130814  0.01250234
   1.33076568  1.33076568  0.          0.          0.          1.33076568
   1.33076568]
 [ 1.24936928  1.41657996  1.72789804  1.50797607  1.28728406  1.29299175
   1.50797607  1.50797607  0.          0.          0.          1.50797607
   1.50797607]]
2024-09-19 20:46:47 - INFO - y 샘플:
[1.50797607]
2024-09-19 20:46:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:46:47 - INFO - 모델 출력 (스케일링된 예측): [0.29656327]
2024-09-19 20:46:47 - INFO - 스케일러 역변환 후 예측 가격: 83421443.69821508
2024-09-19 20:46:47 - INFO - TransformerPredictor 최종 예측 가격: 83421443.69821508
2024-09-19 20:46:47 - INFO - TRANSFORMER prediction: 83421443.69821508
2024-09-19 20:46:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:46:47 - INFO - BITCOIN_FORECAST prediction: 82748847.33684468
2024-09-19 20:46:47 - INFO - BitcoinForecast prediction: 82748847.33684468
2024-09-19 20:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:46:53 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.003870506407726353, 'ml': 0.2087738446372457, 'xgboost': 0.08032326956278021, 'rl': 0.2814120403559315, 'lstm': 0.11197900341765032, 'arima': 0.015590301554684705, 'prophet': 0.07409302722868054, 'transformer': 0.11197900341765032, 'bitcoin_forecast': 0.11197900341765032}
2024-09-19 20:46:53 - INFO - 조정된 모델 가중치: {'gpt': 0.003870506407726353, 'ml': 0.2087738446372457, 'xgboost': 0.08032326956278021, 'rl': 0.2814120403559315, 'lstm': 0.11197900341765032, 'arima': 0.015590301554684705, 'prophet': 0.07409302722868054, 'transformer': 0.11197900341765032, 'bitcoin_forecast': 0.11197900341765032}
2024-09-19 20:46:53 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83636191.7205316, 'current_price': 83565000.0, 'predictions': {'gpt': 83565000.0, 'ml': 83531574.0, 'xgboost': 83565000.0, 'lstm': 83433362.21121041, 'rl': 84400650.0, 'arima': 80899000.0, 'prophet': 83656505.09303159, 'transformer': 83421443.69821508, 'bitcoin_forecast': 82748847.33684468}, 'weights': {'gpt': 0.003870506407726353, 'ml': 0.2087738446372457, 'xgboost': 0.08032326956278021, 'rl': 0.2814120403559315, 'lstm': 0.11197900341765032, 'arima': 0.015590301554684705, 'prophet': 0.07409302722868054, 'transformer': 0.11197900341765032, 'bitcoin_forecast': 0.11197900341765032}}
2024-09-19 20:46:53 - INFO - 모델별 가중치:
2024-09-19 20:46:53 - INFO -   - GPT: 0.0039
2024-09-19 20:46:53 - INFO -   - ML: 0.2088
2024-09-19 20:46:53 - INFO -   - XGBOOST: 0.0803
2024-09-19 20:46:53 - INFO -   - RL: 0.2814
2024-09-19 20:46:53 - INFO -   - LSTM: 0.1120
2024-09-19 20:46:53 - INFO -   - ARIMA: 0.0156
2024-09-19 20:46:53 - INFO -   - PROPHET: 0.0741
2024-09-19 20:46:53 - INFO -   - TRANSFORMER: 0.1120
2024-09-19 20:46:53 - INFO -   - BITCOIN_FORECAST: 0.1120
2024-09-19 20:46:53 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:46:53 - INFO - 6. 거래 실행
2024-09-19 20:46:53 - INFO - Cancelling existing orders.
2024-09-19 20:46:53 - INFO - Cancelled 0 orders.
2024-09-19 20:46:53 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83636191.7205316, 'current_price': 83565000.0, 'predictions': {'gpt': 83565000.0, 'ml': 83531574.0, 'xgboost': 83565000.0, 'lstm': 83433362.21121041, 'rl': 84400650.0, 'arima': 80899000.0, 'prophet': 83656505.09303159, 'transformer': 83421443.69821508, 'bitcoin_forecast': 82748847.33684468}, 'weights': {'gpt': 0.003870506407726353, 'ml': 0.2087738446372457, 'xgboost': 0.08032326956278021, 'rl': 0.2814120403559315, 'lstm': 0.11197900341765032, 'arima': 0.015590301554684705, 'prophet': 0.07409302722868054, 'transformer': 0.11197900341765032, 'bitcoin_forecast': 0.11197900341765032}}, 현재 가격=83565000.0
2024-09-19 20:46:53 - INFO - 현재 잔고: KRW=295676.29577803, BTC=0.00217097, 총 자산가치=477093.40382803
2024-09-19 20:46:53 - INFO - 매수 시도: 0.0005709249133345659 BTC (약 47709.340382803 KRW)
2024-09-19 20:46:53 - INFO - 주문 결과: {'uuid': '12a5b27f-eba4-404b-a136-0ee45cd058f5', 'side': 'bid', 'ord_type': 'limit', 'price': '83565000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:46:53+09:00', 'volume': '0.00057092', 'remaining_volume': '0.00057092', 'reserved_fee': '23.8544649', 'remaining_fee': '23.8544649', 'paid_fee': '0', 'locked': '47732.7842649', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:46:53 - INFO - buy 주문 성공: UUID=12a5b27f-eba4-404b-a136-0ee45cd058f5
2024-09-19 20:46:53 - INFO - Trade executed successfully.
2024-09-19 20:46:53 - INFO - 7. summary 리포트 보내기
2024-09-19 20:46:54 - INFO - Message sent to Discord successfully.
2024-09-19 20:46:54 - INFO - Trading cycle completed.
2024-09-19 20:46:54 - INFO - Performing periodic update.
2024-09-19 20:46:54 - INFO - 계산된 시장 변동성: 0.03047261755482416
2024-09-19 20:55:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818b-94e4-e793ac30891b "HTTP/1.1 200 OK"
2024-09-19 20:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:55:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:55:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8193-b879-e53939b0e1d1 "HTTP/1.1 200 OK"
2024-09-19 20:55:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:55:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:55:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8129-8d13-e8ef7703d54b "HTTP/1.1 200 OK"
2024-09-19 20:55:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8145-9540-d10069de3a69 "HTTP/1.1 200 OK"
2024-09-19 20:56:11 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8178-b61a-c63e5656fac3 "HTTP/1.1 200 OK"
2024-09-19 20:56:21 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813d-8a70-e7a0b5359d70 "HTTP/1.1 200 OK"
2024-09-19 20:56:27 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d1-8749-ebb3b29caa5c "HTTP/1.1 200 OK"
2024-09-19 20:56:33 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-838d-df44f7c57b12 "HTTP/1.1 200 OK"
2024-09-19 20:56:38 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 20:56:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bb-a1f6-e37220953b10 "HTTP/1.1 200 OK"
2024-09-19 20:56:52 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:45:34.937273
2024-09-19 20:56:52 - INFO - Starting trading cycle.
2024-09-19 20:56:52 - INFO - ##################################################
2024-09-19 20:56:52 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-19 20:56:52 - INFO - ##################################################
2024-09-19 20:56:52 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 20:56:52 - INFO - 데이터베이스 업데이트 시작
2024-09-19 20:56:52 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:40:00
2024-09-19 20:56:52 - INFO - 새로운 데이터 범위: 2024-09-18 11:40:00 ~ 2024-09-19 20:50:00
2024-09-19 20:56:52 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 20:56:52 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 20:56:52 - INFO - Index: Index([199], dtype='int64')
2024-09-19 20:56:52 - INFO - Date column data type: datetime64[ns]
2024-09-19 20:56:52 - INFO - Sample date values: [Timestamp('2024-09-19 20:50:00')]
2024-09-19 20:56:53 - INFO - Successfully added 1 new data points
2024-09-19 20:56:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 20:56:53 - INFO - Final date range: 2024-09-19 20:50:00 to 2024-09-19 20:50:00
2024-09-19 20:56:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 20:56:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 20:50:00
2024-09-19 20:56:53 - INFO - 데이터베이스 업데이트 완료
2024-09-19 20:56:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 20:56:53 - INFO - GPT | 이전예측가격: 83565000 | 당시BTC가격: 83565000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:56:53 - INFO - ML 모델 예측 업데이트: 정확도 52.17%, 적중/전체: 12/23
2024-09-19 20:56:53 - INFO - ML | 이전예측가격: 83531574 | 당시BTC가격: 83565000 | 예측: 하락 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2369 | 반영가중치값: -0.0200 | 새 가중치: 0.2169 | 예측 총 횟수: 23 | 예측 성공 수: 12 | 예측 성공률: 52.17%
2024-09-19 20:56:53 - INFO - XGBOOST | 이전예측가격: 83565000 | 당시BTC가격: 83565000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 20:56:53 - INFO - LSTM 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-19 20:56:53 - INFO - LSTM | 이전예측가격: 83433362 | 당시BTC가격: 83565000 | 예측: 하락 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1329 | 반영가중치값: -0.0200 | 새 가중치: 0.1129 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-19 20:56:53 - INFO - RL 모델 예측 업데이트: 정확도 64.00%, 적중/전체: 16/25
2024-09-19 20:56:53 - INFO - RL | 이전예측가격: 84400650 | 당시BTC가격: 83565000 | 예측: 상승 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0501 | 반영가중치값: 0.0200 | 새 가중치: 0.0701 | 예측 총 횟수: 25 | 예측 성공 수: 16 | 예측 성공률: 64.00%
2024-09-19 20:56:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.46%, 적중/전체: 116/217
2024-09-19 20:56:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83565000 | 예측: 하락 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1630 | 반영가중치값: -0.0200 | 새 가중치: 0.1430 | 예측 총 횟수: 217 | 예측 성공 수: 116 | 예측 성공률: 53.46%
2024-09-19 20:56:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.90%, 적중/전체: 13/21
2024-09-19 20:56:53 - INFO - PROPHET | 이전예측가격: 83656505 | 당시BTC가격: 83565000 | 예측: 상승 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0409 | 반영가중치값: 0.0200 | 새 가중치: 0.0609 | 예측 총 횟수: 21 | 예측 성공 수: 13 | 예측 성공률: 61.90%
2024-09-19 20:56:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-19 20:56:53 - INFO - TRANSFORMER | 이전예측가격: 83421444 | 당시BTC가격: 83565000 | 예측: 하락 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1549 | 반영가중치값: -0.0200 | 새 가중치: 0.1349 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-19 20:56:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 20.00%, 적중/전체: 1/5
2024-09-19 20:56:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82748847 | 당시BTC가격: 83565000 | 예측: 하락 | 지금 BTC가격: 83750000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1386 | 반영가중치값: -0.0200 | 새 가중치: 0.1186 | 예측 총 횟수: 5 | 예측 성공 수: 1 | 예측 성공률: 20.00%
2024-09-19 20:56:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 20:56:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 20:56:53 - INFO - 새로운 가중치: {'gpt': 0.004111086677254598, 'ml': 0.23041236325460057, 'xgboost': 0.08531594798910405, 'rl': 0.07450048059092436, 'lstm': 0.11987027572100051, 'arima': 0.15183886250159861, 'prophet': 0.06464150304615103, 'transformer': 0.1432872891883235, 'bitcoin_forecast': 0.1260221910310428}
2024-09-19 20:56:53 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 20:56:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 20:56:53 - INFO - Current BTC price: 83750000.0
2024-09-19 20:56:53 - INFO - Analyzing market conditions.
2024-09-19 20:56:53 - INFO - Market analysis: {'current_price': 83750000.0, 'sma_20': 83239400.0, 'rsi_14': 70.19300459517925, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 20:56:53 - INFO - Starting predictions for all models
2024-09-19 20:56:53 - INFO - Attempting prediction for gpt
2024-09-19 20:56:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 20:56:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:56:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 20:56:54 - INFO - GPT prediction: 83750000.0
2024-09-19 20:56:54 - INFO - Attempting prediction for ml
2024-09-19 20:56:54 - INFO - ML prediction: 83716500.0
2024-09-19 20:56:54 - INFO - Attempting prediction for xgboost
2024-09-19 20:56:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 20:56:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:56:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 20:56:54 - INFO - XGBOOST prediction: 83750000.0
2024-09-19 20:56:54 - INFO - Attempting prediction for lstm
2024-09-19 20:56:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 20:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:56:54 - INFO - X 샘플:
[[-0.55158224 -0.0939538  -0.14129685  0.30850642 -0.50683638 -0.50663091
   0.30850642]
 [ 1.50609335  0.97085588 -0.15444074 -0.66572439  0.71626176  0.71404789
  -0.66572439]
 [-0.53593452 -0.62635863 -0.09529322 -0.53457793 -0.79104835 -0.78981168
  -0.53457793]
 [-0.05867896 -0.6889945  -0.05586155 -0.540823   -1.20430965 -1.20122901
  -0.540823  ]
 [-0.84106512 -1.48760176 -2.16545637 -1.84604249  0.39372537  0.3833873
  -1.84604249]
 [-1.62345127 -0.6889945  -0.86421096 -0.14113857 -0.82243914 -0.82228312
  -0.14113857]
 [-0.38728115 -0.6889945   0.17415658 -0.2160794  -0.77197886 -0.77033475
  -0.2160794 ]
 [-0.11344599  0.42279208  0.37788692  0.73941621 -0.11150913 -0.11135101
   0.73941621]
 [ 0.95842304  0.85341364  1.29138749  0.87056266  0.87270304  0.87397589
   0.87056266]
 [ 1.64692285  2.02783608  1.63312871  2.02590049  2.22543135  2.23022941
   2.02590049]]
2024-09-19 20:56:54 - INFO - y 샘플:
[2.02590049]
2024-09-19 20:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 20:56:54 - INFO - 모델 출력 (스케일링된 예측): [[0.415213]]
2024-09-19 20:56:54 - INFO - 스케일러 역변환 후 예측 가격: 83492086.53005181
2024-09-19 20:56:54 - INFO - LSTMPredictor 최종 예측 가격: 83492086.53005181
2024-09-19 20:56:54 - INFO - LSTM prediction: 83492086.53005181
2024-09-19 20:56:54 - INFO - Attempting prediction for rl
2024-09-19 20:56:54 - INFO - Preparing state for RL agent.
2024-09-19 20:56:54 - INFO - Prepared state: [[8.37500000e+07 4.32514473e+01 2.21384551e-03 8.32394000e+07
  7.01930046e+01]]
2024-09-19 20:56:54 - INFO - RL prediction: 84587500.0
2024-09-19 20:56:54 - INFO - Attempting prediction for arima
2024-09-19 20:56:54 - INFO - ARIMA 예측 시작
2024-09-19 20:56:54 - INFO - 입력 데이터: {'open': 83618000.0, 'high': 83750000.0, 'low': 83578000.0, 'close': 83750000.0, 'volume': 43.25144734, 'value': 3619587886.53671, 'decision': 'sell', 'sma': 83239400.0, 'ema': 83296313.76761101, 'rsi': 70.19300459517925, 'macd': 175165.16810458899, 'signal_line': 138471.9916206183, 'BB_Upper': 83770283.94211748, 'BB_Lower': 82708516.05788252}
2024-09-19 20:56:54 - INFO - Exogenous 변수 예측 시작
2024-09-19 20:56:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83239400.0         0         0
2024-09-19 20:56:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83239400.0         0         0
2024-09-19 20:56:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 20:56:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 20:56:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 20:56:54 - INFO - ARIMA prediction: 80899000.0
2024-09-19 20:56:54 - INFO - Attempting prediction for prophet
2024-09-19 20:56:54 - INFO - PROPHET prediction: 83873523.34487036
2024-09-19 20:56:54 - INFO - Attempting prediction for transformer
2024-09-19 20:56:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 20:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 20:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 20:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 20:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 20:56:54 - INFO - X 샘플:
[[-0.55158224 -0.0939538  -0.14129685  0.30850642 -0.50683638 -0.50663091
   0.30850642  0.30850642  0.          0.          0.          0.30850642
   0.30850642]
 [ 1.50609335  0.97085588 -0.15444074 -0.66572439  0.71626176  0.71404789
  -0.66572439 -0.66572439  0.          0.          0.         -0.66572439
  -0.66572439]
 [-0.53593452 -0.62635863 -0.09529322 -0.53457793 -0.79104835 -0.78981168
  -0.53457793 -0.53457793  0.          0.          0.         -0.53457793
  -0.53457793]
 [-0.05867896 -0.6889945  -0.05586155 -0.540823   -1.20430965 -1.20122901
  -0.540823   -0.540823    0.          0.          0.         -0.540823
  -0.540823  ]
 [-0.84106512 -1.48760176 -2.16545637 -1.84604249  0.39372537  0.3833873
  -1.84604249 -1.84604249  0.          0.          0.         -1.84604249
  -1.84604249]
 [-1.62345127 -0.6889945  -0.86421096 -0.14113857 -0.82243914 -0.82228312
  -0.14113857 -0.14113857  0.          0.          0.         -0.14113857
  -0.14113857]
 [-0.38728115 -0.6889945   0.17415658 -0.2160794  -0.77197886 -0.77033475
  -0.2160794  -0.2160794   0.          0.          0.         -0.2160794
  -0.2160794 ]
 [-0.11344599  0.42279208  0.37788692  0.73941621 -0.11150913 -0.11135101
   0.73941621  0.73941621  0.          0.          0.          0.73941621
   0.73941621]
 [ 0.95842304  0.85341364  1.29138749  0.87056266  0.87270304  0.87397589
   0.87056266  0.87056266  0.          0.          0.          0.87056266
   0.87056266]
 [ 1.64692285  2.02783608  1.63312871  2.02590049  2.22543135  2.23022941
   2.02590049  2.02590049  0.          0.          0.          2.02590049
   2.02590049]]
2024-09-19 20:56:54 - INFO - y 샘플:
[2.02590049]
2024-09-19 20:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 20:56:54 - INFO - 모델 출력 (스케일링된 예측): [0.2968519]
2024-09-19 20:56:54 - INFO - 스케일러 역변환 후 예측 가격: 83473133.80436762
2024-09-19 20:56:54 - INFO - TransformerPredictor 최종 예측 가격: 83473133.80436762
2024-09-19 20:56:54 - INFO - TRANSFORMER prediction: 83473133.80436762
2024-09-19 20:56:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 20:56:54 - INFO - BITCOIN_FORECAST prediction: 82913901.28342427
2024-09-19 20:56:54 - INFO - BitcoinForecast prediction: 82913901.28342427
2024-09-19 20:56:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:20 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 20:57:20 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 20:57:20 - INFO - 조정된 모델 가중치: {'gpt': 0.004111086677254598, 'ml': 0.23041236325460057, 'xgboost': 0.08531594798910405, 'rl': 0.07450048059092436, 'lstm': 0.11987027572100051, 'arima': 0.15183886250159861, 'prophet': 0.06464150304615103, 'transformer': 0.1432872891883235, 'bitcoin_forecast': 0.1260221910310428}
2024-09-19 20:57:20 - INFO - 조정된 모델 가중치: {'gpt': 0.004111086677254598, 'ml': 0.23041236325460057, 'xgboost': 0.08531594798910405, 'rl': 0.07450048059092436, 'lstm': 0.11987027572100051, 'arima': 0.15183886250159861, 'prophet': 0.06464150304615103, 'transformer': 0.1432872891883235, 'bitcoin_forecast': 0.1260221910310428}
2024-09-19 20:57:20 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 83203812.9184315, 'current_price': 83750000.0, 'predictions': {'gpt': 83750000.0, 'ml': 83716500.0, 'xgboost': 83750000.0, 'lstm': 83492086.53005181, 'rl': 84587500.0, 'arima': 80899000.0, 'prophet': 83873523.34487036, 'transformer': 83473133.80436762, 'bitcoin_forecast': 82913901.28342427}, 'weights': {'gpt': 0.004111086677254598, 'ml': 0.23041236325460057, 'xgboost': 0.08531594798910405, 'rl': 0.07450048059092436, 'lstm': 0.11987027572100051, 'arima': 0.15183886250159861, 'prophet': 0.06464150304615103, 'transformer': 0.1432872891883235, 'bitcoin_forecast': 0.1260221910310428}}
2024-09-19 20:57:20 - INFO - 모델별 가중치:
2024-09-19 20:57:20 - INFO -   - GPT: 0.0041
2024-09-19 20:57:20 - INFO -   - ML: 0.2304
2024-09-19 20:57:20 - INFO -   - XGBOOST: 0.0853
2024-09-19 20:57:20 - INFO -   - RL: 0.0745
2024-09-19 20:57:20 - INFO -   - LSTM: 0.1199
2024-09-19 20:57:20 - INFO -   - ARIMA: 0.1518
2024-09-19 20:57:20 - INFO -   - PROPHET: 0.0646
2024-09-19 20:57:20 - INFO -   - TRANSFORMER: 0.1433
2024-09-19 20:57:20 - INFO -   - BITCOIN_FORECAST: 0.1260
2024-09-19 20:57:20 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 20:57:20 - INFO - 6. 거래 실행
2024-09-19 20:57:20 - INFO - Cancelling existing orders.
2024-09-19 20:57:20 - INFO - Cancelled 0 orders.
2024-09-19 20:57:20 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 83203812.9184315, 'current_price': 83750000.0, 'predictions': {'gpt': 83750000.0, 'ml': 83716500.0, 'xgboost': 83750000.0, 'lstm': 83492086.53005181, 'rl': 84587500.0, 'arima': 80899000.0, 'prophet': 83873523.34487036, 'transformer': 83473133.80436762, 'bitcoin_forecast': 82913901.28342427}, 'weights': {'gpt': 0.004111086677254598, 'ml': 0.23041236325460057, 'xgboost': 0.08531594798910405, 'rl': 0.07450048059092436, 'lstm': 0.11987027572100051, 'arima': 0.15183886250159861, 'prophet': 0.06464150304615103, 'transformer': 0.1432872891883235, 'bitcoin_forecast': 0.1260221910310428}}, 현재 가격=83750000.0
2024-09-19 20:57:20 - INFO - 현재 잔고: KRW=247943.51151313, BTC=0.00274189, 총 자산가치=477576.79901313
2024-09-19 20:57:20 - INFO - 매도 시도: 0.000548378 BTC (약 45926.6575 KRW)
2024-09-19 20:57:20 - INFO - 주문 결과: {'uuid': '0e2addd6-37df-4eaa-8754-d559c7f6268a', 'side': 'ask', 'ord_type': 'limit', 'price': '83750000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T20:57:21+09:00', 'volume': '0.00054837', 'remaining_volume': '0.00054837', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00054837', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 20:57:20 - INFO - sell 주문 성공: UUID=0e2addd6-37df-4eaa-8754-d559c7f6268a
2024-09-19 20:57:20 - INFO - Trade executed successfully.
2024-09-19 20:57:20 - INFO - 7. summary 리포트 보내기
2024-09-19 20:57:21 - INFO - Message sent to Discord successfully.
2024-09-19 20:57:21 - INFO - Trading cycle completed.
2024-09-19 20:57:21 - INFO - Performing periodic update.
2024-09-19 20:57:21 - INFO - 계산된 시장 변동성: 0.03049162952428855
2024-09-19 21:05:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:05:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e3-b233-d5856a71a876 "HTTP/1.1 200 OK"
2024-09-19 21:05:44 - INFO - Updated actual price for gpt prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:05:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:05:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8195-85f7-cd147465a1dd "HTTP/1.1 200 OK"
2024-09-19 21:05:58 - INFO - Updated actual price for ml prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10d39a9c-f800-4036-b9ea-d747a9702d9b "HTTP/1.1 200 OK"
2024-09-19 21:06:06 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d7-bf4f-fe0d00122041 "HTTP/1.1 200 OK"
2024-09-19 21:06:16 - INFO - Updated actual price for lstm prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/39095f52-17f3-4391-838c-3c520a655542 "HTTP/1.1 200 OK"
2024-09-19 21:06:27 - INFO - Updated actual price for rl prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818f-be53-c618c7744501 "HTTP/1.1 200 OK"
2024-09-19 21:06:33 - INFO - Updated actual price for arima prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811a-a551-e3f2ea457e2f "HTTP/1.1 200 OK"
2024-09-19 21:06:39 - INFO - Updated actual price for prophet prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/29481186-b081-4292-aeb0-e99246cd1f50 "HTTP/1.1 200 OK"
2024-09-19 21:06:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:06:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-93e9-f95646ef24cb "HTTP/1.1 200 OK"
2024-09-19 21:06:52 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 20:55:34.937459
2024-09-19 21:06:52 - INFO - Starting trading cycle.
2024-09-19 21:06:52 - INFO - ##################################################
2024-09-19 21:06:52 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-19 21:06:52 - INFO - ##################################################
2024-09-19 21:06:52 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:06:52 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:06:52 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 20:50:00
2024-09-19 21:06:52 - INFO - 새로운 데이터 범위: 2024-09-18 11:50:00 ~ 2024-09-19 21:00:00
2024-09-19 21:06:52 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:06:52 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:06:52 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:06:52 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:06:52 - INFO - Sample date values: [Timestamp('2024-09-19 21:00:00')]
2024-09-19 21:06:53 - INFO - Successfully added 1 new data points
2024-09-19 21:06:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:06:53 - INFO - Final date range: 2024-09-19 21:00:00 to 2024-09-19 21:00:00
2024-09-19 21:06:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:06:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:00:00
2024-09-19 21:06:53 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:06:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:06:53 - INFO - GPT | 이전예측가격: 83750000 | 당시BTC가격: 83750000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:06:53 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 12/24
2024-09-19 21:06:53 - INFO - ML | 이전예측가격: 83716500 | 당시BTC가격: 83750000 | 예측: 하락 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2088 | 반영가중치값: -0.0200 | 새 가중치: 0.1888 | 예측 총 횟수: 24 | 예측 성공 수: 12 | 예측 성공률: 50.00%
2024-09-19 21:06:53 - INFO - XGBOOST | 이전예측가격: 83750000 | 당시BTC가격: 83750000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:06:53 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 2/6
2024-09-19 21:06:53 - INFO - LSTM | 이전예측가격: 83492087 | 당시BTC가격: 83750000 | 예측: 하락 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1120 | 반영가중치값: -0.0200 | 새 가중치: 0.0920 | 예측 총 횟수: 6 | 예측 성공 수: 2 | 예측 성공률: 33.33%
2024-09-19 21:06:53 - INFO - RL 모델 예측 업데이트: 정확도 65.38%, 적중/전체: 17/26
2024-09-19 21:06:53 - INFO - RL | 이전예측가격: 84587500 | 당시BTC가격: 83750000 | 예측: 상승 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2814 | 반영가중치값: 0.0200 | 새 가중치: 0.3014 | 예측 총 횟수: 26 | 예측 성공 수: 17 | 예측 성공률: 65.38%
2024-09-19 21:06:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.21%, 적중/전체: 116/218
2024-09-19 21:06:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83750000 | 예측: 하락 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0156 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 218 | 예측 성공 수: 116 | 예측 성공률: 53.21%
2024-09-19 21:06:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 14/22
2024-09-19 21:06:53 - INFO - PROPHET | 이전예측가격: 83873523 | 당시BTC가격: 83750000 | 예측: 상승 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0741 | 반영가중치값: 0.0200 | 새 가중치: 0.0941 | 예측 총 횟수: 22 | 예측 성공 수: 14 | 예측 성공률: 63.64%
2024-09-19 21:06:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 2/6
2024-09-19 21:06:53 - INFO - TRANSFORMER | 이전예측가격: 83473134 | 당시BTC가격: 83750000 | 예측: 하락 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1120 | 반영가중치값: -0.0200 | 새 가중치: 0.0920 | 예측 총 횟수: 6 | 예측 성공 수: 2 | 예측 성공률: 33.33%
2024-09-19 21:06:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 16.67%, 적중/전체: 1/6
2024-09-19 21:06:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82913901 | 당시BTC가격: 83750000 | 예측: 하락 | 지금 BTC가격: 84103000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1120 | 반영가중치값: -0.0200 | 새 가중치: 0.0920 | 예측 총 횟수: 6 | 예측 성공 수: 1 | 예측 성공률: 16.67%
2024-09-19 21:06:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:06:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:06:53 - INFO - 새로운 가중치: {'gpt': 0.004329086680778144, 'ml': 0.19878402005479612, 'xgboost': 0.0898400260303532, 'rl': 0.31739512001785497, 'lstm': 0.09685640558483852, 'arima': 0.0, 'prophet': 0.09908253046170207, 'transformer': 0.09685640558483852, 'bitcoin_forecast': 0.09685640558483852}
2024-09-19 21:06:53 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 21:06:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:06:53 - INFO - Current BTC price: 84103000.0
2024-09-19 21:06:53 - INFO - Analyzing market conditions.
2024-09-19 21:06:53 - INFO - Market analysis: {'current_price': 84100000.0, 'sma_20': 83305750.0, 'rsi_14': 76.50327876963274, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 21:06:53 - INFO - Starting predictions for all models
2024-09-19 21:06:53 - INFO - Attempting prediction for gpt
2024-09-19 21:06:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:06:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:06:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:06:54 - INFO - GPT prediction: 84103000.0
2024-09-19 21:06:54 - INFO - Attempting prediction for ml
2024-09-19 21:06:54 - INFO - ML prediction: 83999080.0
2024-09-19 21:06:54 - INFO - Attempting prediction for xgboost
2024-09-19 21:06:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:06:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:06:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:06:54 - INFO - XGBOOST prediction: 84100000.0
2024-09-19 21:06:54 - INFO - Attempting prediction for lstm
2024-09-19 21:06:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:06:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:06:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:06:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:06:54 - INFO - X 샘플:
[[ 0.93160018  0.27064504 -0.33284678 -0.65342836 -0.03756308 -0.03948127
  -0.65342836]
 [-0.68185468 -0.63594919 -0.28476298 -0.57228113 -0.64949307 -0.64807765
  -0.57228113]
 [-0.30476369 -0.6715019  -0.25270711 -0.57614529 -0.81726677 -0.81457398
  -0.57614529]
 [-0.92294563 -1.12479902 -1.96769614 -1.38375337 -0.16850474 -0.17329618
  -1.38375337]
 [-1.54112757 -0.6715019  -0.90985244 -0.32883946 -0.66223695 -0.66121851
  -0.32883946]
 [-0.56440011 -0.6715019  -0.06571453 -0.37520931 -0.64175134 -0.64019554
  -0.37520931]
 [-0.34803643 -0.04044121  0.09990746  0.21600618 -0.37361724 -0.37351165
   0.21600618]
 [ 0.49887282  0.2039837   0.84253511  0.2971534   0.02594814  0.02523994
   0.2971534 ]
 [ 1.04287293  0.87059711  1.12035265  1.0120218   0.57512182  0.57410169
   1.0120218 ]
 [ 1.88978218  2.47046928  1.75078475  2.36447553  2.74936322  2.75101314
   2.36447553]]
2024-09-19 21:06:54 - INFO - y 샘플:
[2.36447553]
2024-09-19 21:06:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:06:54 - INFO - 모델 출력 (스케일링된 예측): [[0.4261598]]
2024-09-19 21:06:54 - INFO - 스케일러 역변환 후 예측 가격: 83598385.42171115
2024-09-19 21:06:54 - INFO - LSTMPredictor 최종 예측 가격: 83598385.42171115
2024-09-19 21:06:54 - INFO - LSTM prediction: 83598385.42171115
2024-09-19 21:06:54 - INFO - Attempting prediction for rl
2024-09-19 21:06:54 - INFO - Preparing state for RL agent.
2024-09-19 21:06:54 - INFO - Prepared state: [[8.41000000e+07 9.73114283e+01 4.17910448e-03 8.33057500e+07
  7.65032788e+01]]
2024-09-19 21:06:54 - INFO - RL prediction: 84944030.0
2024-09-19 21:06:54 - INFO - Attempting prediction for arima
2024-09-19 21:06:54 - INFO - ARIMA 예측 시작
2024-09-19 21:06:54 - INFO - 입력 데이터: {'open': 83755000.0, 'high': 84110000.0, 'low': 83696000.0, 'close': 84100000.0, 'volume': 97.31142827, 'value': 8165635733.12978, 'decision': 'sell', 'sma': 83305750.0, 'ema': 83372855.31355281, 'rsi': 76.50327876963274, 'macd': 217363.69233115017, 'signal_line': 154250.33176272467, 'BB_Upper': 83913079.52340686, 'BB_Lower': 82698420.47659314}
2024-09-19 21:06:54 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:06:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83305750.0         0         0
2024-09-19 21:06:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83305750.0         0         0
2024-09-19 21:06:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:06:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:06:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:06:54 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:06:54 - INFO - Attempting prediction for prophet
2024-09-19 21:06:54 - INFO - PROPHET prediction: 84288247.30817942
2024-09-19 21:06:54 - INFO - Attempting prediction for transformer
2024-09-19 21:06:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:06:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:06:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:06:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:06:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:06:54 - INFO - X 샘플:
[[ 0.93160018  0.27064504 -0.33284678 -0.65342836 -0.03756308 -0.03948127
  -0.65342836 -0.65342836  0.          0.          0.         -0.65342836
  -0.65342836]
 [-0.68185468 -0.63594919 -0.28476298 -0.57228113 -0.64949307 -0.64807765
  -0.57228113 -0.57228113  0.          0.          0.         -0.57228113
  -0.57228113]
 [-0.30476369 -0.6715019  -0.25270711 -0.57614529 -0.81726677 -0.81457398
  -0.57614529 -0.57614529  0.          0.          0.         -0.57614529
  -0.57614529]
 [-0.92294563 -1.12479902 -1.96769614 -1.38375337 -0.16850474 -0.17329618
  -1.38375337 -1.38375337  0.          0.          0.         -1.38375337
  -1.38375337]
 [-1.54112757 -0.6715019  -0.90985244 -0.32883946 -0.66223695 -0.66121851
  -0.32883946 -0.32883946  0.          0.          0.         -0.32883946
  -0.32883946]
 [-0.56440011 -0.6715019  -0.06571453 -0.37520931 -0.64175134 -0.64019554
  -0.37520931 -0.37520931  0.          0.          0.         -0.37520931
  -0.37520931]
 [-0.34803643 -0.04044121  0.09990746  0.21600618 -0.37361724 -0.37351165
   0.21600618  0.21600618  0.          0.          0.          0.21600618
   0.21600618]
 [ 0.49887282  0.2039837   0.84253511  0.2971534   0.02594814  0.02523994
   0.2971534   0.2971534   0.          0.          0.          0.2971534
   0.2971534 ]
 [ 1.04287293  0.87059711  1.12035265  1.0120218   0.57512182  0.57410169
   1.0120218   1.0120218   0.          0.          0.          1.0120218
   1.0120218 ]
 [ 1.88978218  2.47046928  1.75078475  2.36447553  2.74936322  2.75101314
   2.36447553  2.36447553  0.          0.          0.          2.36447553
   2.36447553]]
2024-09-19 21:06:54 - INFO - y 샘플:
[2.36447553]
2024-09-19 21:06:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:06:54 - INFO - 모델 출력 (스케일링된 예측): [0.29877552]
2024-09-19 21:06:54 - INFO - 스케일러 역변환 후 예측 가격: 83565419.78642766
2024-09-19 21:06:54 - INFO - TransformerPredictor 최종 예측 가격: 83565419.78642766
2024-09-19 21:06:54 - INFO - TRANSFORMER prediction: 83565419.78642766
2024-09-19 21:06:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:06:54 - INFO - BITCOIN_FORECAST prediction: 83197365.88821039
2024-09-19 21:06:54 - INFO - BitcoinForecast prediction: 83197365.88821039
2024-09-19 21:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:06:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:06:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004329086680778144, 'ml': 0.19878402005479612, 'xgboost': 0.0898400260303532, 'rl': 0.31739512001785497, 'lstm': 0.09685640558483852, 'arima': 0.0, 'prophet': 0.09908253046170207, 'transformer': 0.09685640558483852, 'bitcoin_forecast': 0.09685640558483852}
2024-09-19 21:06:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004329086680778144, 'ml': 0.19878402005479612, 'xgboost': 0.0898400260303532, 'rl': 0.31739512001785497, 'lstm': 0.09685640558483852, 'arima': 0.0, 'prophet': 0.09908253046170207, 'transformer': 0.09685640558483852, 'bitcoin_forecast': 0.09685640558483852}
2024-09-19 21:06:59 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84178706.7281002, 'current_price': 84103000.0, 'predictions': {'gpt': 84103000.0, 'ml': 83999080.0, 'xgboost': 84100000.0, 'lstm': 83598385.42171115, 'rl': 84944030.0, 'arima': 80899000.0, 'prophet': 84288247.30817942, 'transformer': 83565419.78642766, 'bitcoin_forecast': 83197365.88821039}, 'weights': {'gpt': 0.004329086680778144, 'ml': 0.19878402005479612, 'xgboost': 0.0898400260303532, 'rl': 0.31739512001785497, 'lstm': 0.09685640558483852, 'arima': 0.0, 'prophet': 0.09908253046170207, 'transformer': 0.09685640558483852, 'bitcoin_forecast': 0.09685640558483852}}
2024-09-19 21:06:59 - INFO - 모델별 가중치:
2024-09-19 21:06:59 - INFO -   - GPT: 0.0043
2024-09-19 21:06:59 - INFO -   - ML: 0.1988
2024-09-19 21:06:59 - INFO -   - XGBOOST: 0.0898
2024-09-19 21:06:59 - INFO -   - RL: 0.3174
2024-09-19 21:06:59 - INFO -   - LSTM: 0.0969
2024-09-19 21:06:59 - INFO -   - ARIMA: 0.0000
2024-09-19 21:06:59 - INFO -   - PROPHET: 0.0991
2024-09-19 21:06:59 - INFO -   - TRANSFORMER: 0.0969
2024-09-19 21:06:59 - INFO -   - BITCOIN_FORECAST: 0.0969
2024-09-19 21:06:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:06:59 - INFO - 6. 거래 실행
2024-09-19 21:06:59 - INFO - Cancelling existing orders.
2024-09-19 21:07:00 - INFO - Cancelled 0 orders.
2024-09-19 21:07:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84178706.7281002, 'current_price': 84103000.0, 'predictions': {'gpt': 84103000.0, 'ml': 83999080.0, 'xgboost': 84100000.0, 'lstm': 83598385.42171115, 'rl': 84944030.0, 'arima': 80899000.0, 'prophet': 84288247.30817942, 'transformer': 83565419.78642766, 'bitcoin_forecast': 83197365.88821039}, 'weights': {'gpt': 0.004329086680778144, 'ml': 0.19878402005479612, 'xgboost': 0.0898400260303532, 'rl': 0.31739512001785497, 'lstm': 0.09685640558483852, 'arima': 0.0, 'prophet': 0.09908253046170207, 'transformer': 0.09685640558483852, 'bitcoin_forecast': 0.09685640558483852}}, 현재 가격=84103000.0
2024-09-19 21:07:00 - INFO - 현재 잔고: KRW=293860.65455658, BTC=0.00219352, 총 자산가치=478342.26711658004
2024-09-19 21:07:00 - INFO - 매수 시도: 0.0005687576746567661 BTC (약 47834.226711658004 KRW)
2024-09-19 21:07:00 - INFO - 주문 결과: {'uuid': '32baf6b9-cc8d-4183-83ce-4bc24ef1e97b', 'side': 'bid', 'ord_type': 'limit', 'price': '84103000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:07:00+09:00', 'volume': '0.00056875', 'remaining_volume': '0.00056875', 'reserved_fee': '23.916790625', 'remaining_fee': '23.916790625', 'paid_fee': '0', 'locked': '47857.498040625', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:07:00 - INFO - buy 주문 성공: UUID=32baf6b9-cc8d-4183-83ce-4bc24ef1e97b
2024-09-19 21:07:00 - INFO - Trade executed successfully.
2024-09-19 21:07:00 - INFO - 7. summary 리포트 보내기
2024-09-19 21:07:00 - INFO - Message sent to Discord successfully.
2024-09-19 21:07:00 - INFO - Trading cycle completed.
2024-09-19 21:07:00 - INFO - Performing periodic update.
2024-09-19 21:07:00 - INFO - 계산된 시장 변동성: 0.030523322471925404
2024-09-19 21:15:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:15:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8160-aea0-d83e8fdff98f "HTTP/1.1 200 OK"
2024-09-19 21:15:49 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:15:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:15:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-953c-d95545e9cafe "HTTP/1.1 200 OK"
2024-09-19 21:15:56 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8c533b56-d429-48fe-b5f1-27fbb9a8158b "HTTP/1.1 200 OK"
2024-09-19 21:16:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c3-8774-f3433c81ea22 "HTTP/1.1 200 OK"
2024-09-19 21:16:10 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8175-91fe-eb358e5dee18 "HTTP/1.1 200 OK"
2024-09-19 21:16:23 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816c-a682-d05de36596e1 "HTTP/1.1 200 OK"
2024-09-19 21:16:32 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-9103-fc3c4a1ed67d "HTTP/1.1 200 OK"
2024-09-19 21:16:40 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-8678-e4e452d932db "HTTP/1.1 200 OK"
2024-09-19 21:16:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:16:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8103-afee-ecad45a42013 "HTTP/1.1 200 OK"
2024-09-19 21:16:54 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:05:34.937642
2024-09-19 21:16:54 - INFO - Starting trading cycle.
2024-09-19 21:16:54 - INFO - ##################################################
2024-09-19 21:16:54 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-19 21:16:54 - INFO - ##################################################
2024-09-19 21:16:54 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:16:54 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:16:54 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:00:00
2024-09-19 21:16:54 - INFO - 새로운 데이터 범위: 2024-09-18 12:00:00 ~ 2024-09-19 21:10:00
2024-09-19 21:16:54 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:16:54 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:16:54 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:16:54 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:16:54 - INFO - Sample date values: [Timestamp('2024-09-19 21:10:00')]
2024-09-19 21:16:54 - INFO - Successfully added 1 new data points
2024-09-19 21:16:54 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:16:54 - INFO - Final date range: 2024-09-19 21:10:00 to 2024-09-19 21:10:00
2024-09-19 21:16:54 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:16:54 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:10:00
2024-09-19 21:16:54 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:16:54 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:16:54 - INFO - GPT | 이전예측가격: 84103000 | 당시BTC가격: 84103000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:16:54 - INFO - ML 모델 예측 업데이트: 정확도 48.00%, 적중/전체: 12/25
2024-09-19 21:16:54 - INFO - ML | 이전예측가격: 83999080 | 당시BTC가격: 84103000 | 예측: 하락 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2304 | 반영가중치값: -0.0200 | 새 가중치: 0.2104 | 예측 총 횟수: 25 | 예측 성공 수: 12 | 예측 성공률: 48.00%
2024-09-19 21:16:54 - INFO - XGBOOST | 이전예측가격: 84100000 | 당시BTC가격: 84103000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:16:54 - INFO - LSTM 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 2/7
2024-09-19 21:16:54 - INFO - LSTM | 이전예측가격: 83598385 | 당시BTC가격: 84103000 | 예측: 하락 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1199 | 반영가중치값: -0.0200 | 새 가중치: 0.0999 | 예측 총 횟수: 7 | 예측 성공 수: 2 | 예측 성공률: 28.57%
2024-09-19 21:16:54 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 18/27
2024-09-19 21:16:54 - INFO - RL | 이전예측가격: 84944030 | 당시BTC가격: 84103000 | 예측: 상승 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0745 | 반영가중치값: 0.0200 | 새 가중치: 0.0945 | 예측 총 횟수: 27 | 예측 성공 수: 18 | 예측 성공률: 66.67%
2024-09-19 21:16:54 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.97%, 적중/전체: 116/219
2024-09-19 21:16:54 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84103000 | 예측: 하락 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1518 | 반영가중치값: -0.0200 | 새 가중치: 0.1318 | 예측 총 횟수: 219 | 예측 성공 수: 116 | 예측 성공률: 52.97%
2024-09-19 21:16:54 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.22%, 적중/전체: 15/23
2024-09-19 21:16:54 - INFO - PROPHET | 이전예측가격: 84288247 | 당시BTC가격: 84103000 | 예측: 상승 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0646 | 반영가중치값: 0.0200 | 새 가중치: 0.0846 | 예측 총 횟수: 23 | 예측 성공 수: 15 | 예측 성공률: 65.22%
2024-09-19 21:16:54 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 2/7
2024-09-19 21:16:55 - INFO - TRANSFORMER | 이전예측가격: 83565420 | 당시BTC가격: 84103000 | 예측: 하락 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1433 | 반영가중치값: -0.0200 | 새 가중치: 0.1233 | 예측 총 횟수: 7 | 예측 성공 수: 2 | 예측 성공률: 28.57%
2024-09-19 21:16:55 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 14.29%, 적중/전체: 1/7
2024-09-19 21:16:55 - INFO - BITCOIN_FORECAST | 이전예측가격: 83197366 | 당시BTC가격: 84103000 | 예측: 하락 | 지금 BTC가격: 84178000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1260 | 반영가중치값: -0.0200 | 새 가중치: 0.1060 | 예측 총 횟수: 7 | 예측 성공 수: 1 | 예측 성공률: 14.29%
2024-09-19 21:16:55 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:16:55 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:16:55 - INFO - 새로운 가중치: {'gpt': 0.004582294767411622, 'ml': 0.22271937298491834, 'xgboost': 0.09509476514085737, 'rl': 0.1000278094805531, 'lstm': 0.10571168368798696, 'arima': 0.13955011168175213, 'prophet': 0.08959218077946111, 'transformer': 0.13049835722727354, 'bitcoin_forecast': 0.11222342424978583}
2024-09-19 21:16:55 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 21:16:55 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:16:55 - INFO - Current BTC price: 84178000.0
2024-09-19 21:16:55 - INFO - Analyzing market conditions.
2024-09-19 21:16:55 - INFO - Market analysis: {'current_price': 84178000.0, 'sma_20': 83376300.0, 'rsi_14': 77.63940011865321, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 21:16:55 - INFO - Starting predictions for all models
2024-09-19 21:16:55 - INFO - Attempting prediction for gpt
2024-09-19 21:16:55 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:16:55 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:16:55 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:16:55 - INFO - GPT prediction: 84178000.0
2024-09-19 21:16:55 - INFO - Attempting prediction for ml
2024-09-19 21:16:55 - INFO - ML prediction: 84110657.6
2024-09-19 21:16:55 - INFO - Attempting prediction for xgboost
2024-09-19 21:16:55 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:16:55 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:16:55 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:16:55 - INFO - XGBOOST prediction: 84178000.0
2024-09-19 21:16:55 - INFO - Attempting prediction for lstm
2024-09-19 21:16:55 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:16:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:16:55 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:16:55 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:16:55 - INFO - X 샘플:
[[-0.61530406 -0.67285884 -0.46464671 -0.72445612 -0.73114892 -0.73019036
  -0.72445612]
 [-0.39477793 -0.69905285 -0.4419256  -0.72755209 -0.88655534 -0.884262
  -0.72755209]
 [-0.75629618 -1.03302658 -1.65750501 -1.37460905 -0.28561618 -0.29083917
  -1.37460905]
 [-1.11781443 -0.69905285 -0.90770836 -0.52941024 -0.74295339 -0.74235059
  -0.52941024]
 [-0.5466156  -0.69905285 -0.30938579 -0.56656184 -0.72397786 -0.72289645
  -0.56656184]
 [-0.42008421 -0.23410904 -0.19199338 -0.09287899 -0.47560901 -0.47611368
  -0.09287899]
 [ 0.0751958  -0.05402516  0.33437901 -0.0278637  -0.1054972  -0.10711869
  -0.0278637 ]
 [ 0.39333186  0.43711267  0.5312953   0.54489007  0.40319467  0.40078458
   0.54489007]
 [ 0.88861186  1.61584348  0.97814381  1.62847829  2.41716399  2.41524535
   1.62847829]
 [ 2.4937529   2.03822202  2.12934674  1.86996366  1.13099925  1.13774102
   1.86996366]]
2024-09-19 21:16:55 - INFO - y 샘플:
[1.86996366]
2024-09-19 21:16:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:16:55 - INFO - 모델 출력 (스케일링된 예측): [[0.43822253]]
2024-09-19 21:16:55 - INFO - 스케일러 역변환 후 예측 가격: 83715546.28340103
2024-09-19 21:16:55 - INFO - LSTMPredictor 최종 예측 가격: 83715546.28340103
2024-09-19 21:16:55 - INFO - LSTM prediction: 83715546.28340103
2024-09-19 21:16:55 - INFO - Attempting prediction for rl
2024-09-19 21:16:55 - INFO - Preparing state for RL agent.
2024-09-19 21:16:55 - INFO - Prepared state: [[8.41780000e+07 6.27875451e+01 9.27467301e-04 8.33763000e+07
  7.76394001e+01]]
2024-09-19 21:16:55 - INFO - RL prediction: 85019780.0
2024-09-19 21:16:55 - INFO - Attempting prediction for arima
2024-09-19 21:16:55 - INFO - ARIMA 예측 시작
2024-09-19 21:16:55 - INFO - 입력 데이터: {'open': 84199000.0, 'high': 84239000.0, 'low': 84000000.0, 'close': 84178000.0, 'volume': 62.78754512, 'value': 5282682687.28286, 'decision': 'sell', 'sma': 83376300.0, 'ema': 83449535.75988111, 'rsi': 77.63940011865321, 'macd': 254170.35726840794, 'signal_line': 174234.33686386133, 'BB_Upper': 84041922.74600421, 'BB_Lower': 82710677.25399579}
2024-09-19 21:16:55 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:16:55 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83376300.0         0         0
2024-09-19 21:16:55 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83376300.0         0         0
2024-09-19 21:16:55 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:16:55 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:16:55 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:16:55 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:16:55 - INFO - Attempting prediction for prophet
2024-09-19 21:16:55 - INFO - PROPHET prediction: 84352390.4333975
2024-09-19 21:16:55 - INFO - Attempting prediction for transformer
2024-09-19 21:16:55 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:16:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:16:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:16:55 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:16:55 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:16:55 - INFO - X 샘플:
[[-0.61530406 -0.67285884 -0.46464671 -0.72445612 -0.73114892 -0.73019036
  -0.72445612 -0.72445612  0.          0.          0.         -0.72445612
  -0.72445612]
 [-0.39477793 -0.69905285 -0.4419256  -0.72755209 -0.88655534 -0.884262
  -0.72755209 -0.72755209  0.          0.          0.         -0.72755209
  -0.72755209]
 [-0.75629618 -1.03302658 -1.65750501 -1.37460905 -0.28561618 -0.29083917
  -1.37460905 -1.37460905  0.          0.          0.         -1.37460905
  -1.37460905]
 [-1.11781443 -0.69905285 -0.90770836 -0.52941024 -0.74295339 -0.74235059
  -0.52941024 -0.52941024  0.          0.          0.         -0.52941024
  -0.52941024]
 [-0.5466156  -0.69905285 -0.30938579 -0.56656184 -0.72397786 -0.72289645
  -0.56656184 -0.56656184  0.          0.          0.         -0.56656184
  -0.56656184]
 [-0.42008421 -0.23410904 -0.19199338 -0.09287899 -0.47560901 -0.47611368
  -0.09287899 -0.09287899  0.          0.          0.         -0.09287899
  -0.09287899]
 [ 0.0751958  -0.05402516  0.33437901 -0.0278637  -0.1054972  -0.10711869
  -0.0278637  -0.0278637   0.          0.          0.         -0.0278637
  -0.0278637 ]
 [ 0.39333186  0.43711267  0.5312953   0.54489007  0.40319467  0.40078458
   0.54489007  0.54489007  0.          0.          0.          0.54489007
   0.54489007]
 [ 0.88861186  1.61584348  0.97814381  1.62847829  2.41716399  2.41524535
   1.62847829  1.62847829  0.          0.          0.          1.62847829
   1.62847829]
 [ 2.4937529   2.03822202  2.12934674  1.86996366  1.13099925  1.13774102
   1.86996366  1.86996366  0.          0.          0.          1.86996366
   1.86996366]]
2024-09-19 21:16:55 - INFO - y 샘플:
[1.86996366]
2024-09-19 21:16:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:16:55 - INFO - 모델 출력 (스케일링된 예측): [0.2971185]
2024-09-19 21:16:55 - INFO - 스케일러 역변환 후 예측 가격: 83669969.5562338
2024-09-19 21:16:55 - INFO - TransformerPredictor 최종 예측 가격: 83669969.5562338
2024-09-19 21:16:55 - INFO - TRANSFORMER prediction: 83669969.5562338
2024-09-19 21:16:55 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:16:55 - INFO - BITCOIN_FORECAST prediction: 83013011.58160412
2024-09-19 21:16:55 - INFO - BitcoinForecast prediction: 83013011.58160412
2024-09-19 21:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:16:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:17:10 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.004582294767411622, 'ml': 0.22271937298491834, 'xgboost': 0.09509476514085737, 'rl': 0.1000278094805531, 'lstm': 0.10571168368798696, 'arima': 0.13955011168175213, 'prophet': 0.08959218077946111, 'transformer': 0.13049835722727354, 'bitcoin_forecast': 0.11222342424978583}
2024-09-19 21:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.004582294767411622, 'ml': 0.22271937298491834, 'xgboost': 0.09509476514085737, 'rl': 0.1000278094805531, 'lstm': 0.10571168368798696, 'arima': 0.13955011168175213, 'prophet': 0.08959218077946111, 'transformer': 0.13049835722727354, 'bitcoin_forecast': 0.11222342424978583}
2024-09-19 21:17:10 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 83559319.26652582, 'current_price': 84178000.0, 'predictions': {'gpt': 84178000.0, 'ml': 84110657.6, 'xgboost': 84178000.0, 'lstm': 83715546.28340103, 'rl': 85019780.0, 'arima': 80899000.0, 'prophet': 84352390.4333975, 'transformer': 83669969.5562338, 'bitcoin_forecast': 83013011.58160412}, 'weights': {'gpt': 0.004582294767411622, 'ml': 0.22271937298491834, 'xgboost': 0.09509476514085737, 'rl': 0.1000278094805531, 'lstm': 0.10571168368798696, 'arima': 0.13955011168175213, 'prophet': 0.08959218077946111, 'transformer': 0.13049835722727354, 'bitcoin_forecast': 0.11222342424978583}}
2024-09-19 21:17:10 - INFO - 모델별 가중치:
2024-09-19 21:17:10 - INFO -   - GPT: 0.0046
2024-09-19 21:17:10 - INFO -   - ML: 0.2227
2024-09-19 21:17:10 - INFO -   - XGBOOST: 0.0951
2024-09-19 21:17:10 - INFO -   - RL: 0.1000
2024-09-19 21:17:10 - INFO -   - LSTM: 0.1057
2024-09-19 21:17:10 - INFO -   - ARIMA: 0.1396
2024-09-19 21:17:10 - INFO -   - PROPHET: 0.0896
2024-09-19 21:17:10 - INFO -   - TRANSFORMER: 0.1305
2024-09-19 21:17:10 - INFO -   - BITCOIN_FORECAST: 0.1122
2024-09-19 21:17:10 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:17:10 - INFO - 6. 거래 실행
2024-09-19 21:17:10 - INFO - Cancelling existing orders.
2024-09-19 21:17:10 - INFO - Cancelled 0 orders.
2024-09-19 21:17:10 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 83559319.26652582, 'current_price': 84178000.0, 'predictions': {'gpt': 84178000.0, 'ml': 84110657.6, 'xgboost': 84178000.0, 'lstm': 83715546.28340103, 'rl': 85019780.0, 'arima': 80899000.0, 'prophet': 84352390.4333975, 'transformer': 83669969.5562338, 'bitcoin_forecast': 83013011.58160412}, 'weights': {'gpt': 0.004582294767411622, 'ml': 0.22271937298491834, 'xgboost': 0.09509476514085737, 'rl': 0.1000278094805531, 'lstm': 0.10571168368798696, 'arima': 0.13955011168175213, 'prophet': 0.08959218077946111, 'transformer': 0.13049835722727354, 'bitcoin_forecast': 0.11222342424978583}}, 현재 가격=84178000.0
2024-09-19 21:17:10 - INFO - 현재 잔고: KRW=246003.15651596, BTC=0.00276227, 총 자산가치=478525.52057596
2024-09-19 21:17:10 - INFO - 매도 시도: 0.000552454 BTC (약 46504.472812 KRW)
2024-09-19 21:17:10 - INFO - 주문 결과: {'uuid': '4f9323fb-2975-4f65-b9d2-762d4c557f6a', 'side': 'ask', 'ord_type': 'limit', 'price': '84178000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:17:10+09:00', 'volume': '0.00055245', 'remaining_volume': '0.00055245', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00055245', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:17:10 - INFO - sell 주문 성공: UUID=4f9323fb-2975-4f65-b9d2-762d4c557f6a
2024-09-19 21:17:10 - INFO - Trade executed successfully.
2024-09-19 21:17:10 - INFO - 7. summary 리포트 보내기
2024-09-19 21:17:11 - INFO - Message sent to Discord successfully.
2024-09-19 21:17:11 - INFO - Trading cycle completed.
2024-09-19 21:17:11 - INFO - Performing periodic update.
2024-09-19 21:17:11 - INFO - 계산된 시장 변동성: 0.03051600420390428
2024-09-19 21:25:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:25:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813b-bc86-fb5a86f4da65 "HTTP/1.1 200 OK"
2024-09-19 21:25:44 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:25:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:25:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ea-912a-d017968e0dd1 "HTTP/1.1 200 OK"
2024-09-19 21:25:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:25:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:25:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dd-aed3-d5d3b0c4e59e "HTTP/1.1 200 OK"
2024-09-19 21:25:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8195-8eaf-f97502c67cd2 "HTTP/1.1 200 OK"
2024-09-19 21:26:05 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8132-bca7-cdea4b55e388 "HTTP/1.1 200 OK"
2024-09-19 21:26:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812d-84f1-d68c0f27134c "HTTP/1.1 200 OK"
2024-09-19 21:26:30 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815b-9354-e9809fa8dbaa "HTTP/1.1 200 OK"
2024-09-19 21:26:35 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8117-928d-cb53de3f5252 "HTTP/1.1 200 OK"
2024-09-19 21:26:44 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:26:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-be64-eaae3eea7574 "HTTP/1.1 200 OK"
2024-09-19 21:26:50 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:15:34.937914
2024-09-19 21:26:50 - INFO - Starting trading cycle.
2024-09-19 21:26:50 - INFO - ##################################################
2024-09-19 21:26:50 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-19 21:26:50 - INFO - ##################################################
2024-09-19 21:26:50 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:26:50 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:26:50 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:10:00
2024-09-19 21:26:50 - INFO - 새로운 데이터 범위: 2024-09-18 12:10:00 ~ 2024-09-19 21:20:00
2024-09-19 21:26:50 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:26:50 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:26:50 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:26:50 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:26:50 - INFO - Sample date values: [Timestamp('2024-09-19 21:20:00')]
2024-09-19 21:26:50 - INFO - Successfully added 1 new data points
2024-09-19 21:26:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:26:50 - INFO - Final date range: 2024-09-19 21:20:00 to 2024-09-19 21:20:00
2024-09-19 21:26:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:26:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:20:00
2024-09-19 21:26:50 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:26:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:26:50 - INFO - GPT | 이전예측가격: 84178000 | 당시BTC가격: 84178000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:26:50 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 13/26
2024-09-19 21:26:50 - INFO - ML | 이전예측가격: 84110658 | 당시BTC가격: 84178000 | 예측: 하락 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1988 | 반영가중치값: 0.0200 | 새 가중치: 0.2188 | 예측 총 횟수: 26 | 예측 성공 수: 13 | 예측 성공률: 50.00%
2024-09-19 21:26:50 - INFO - XGBOOST | 이전예측가격: 84178000 | 당시BTC가격: 84178000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:26:50 - INFO - LSTM 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-19 21:26:50 - INFO - LSTM | 이전예측가격: 83715546 | 당시BTC가격: 84178000 | 예측: 하락 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0969 | 반영가중치값: 0.0200 | 새 가중치: 0.1169 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-19 21:26:50 - INFO - RL 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 18/28
2024-09-19 21:26:50 - INFO - RL | 이전예측가격: 85019780 | 당시BTC가격: 84178000 | 예측: 상승 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3174 | 반영가중치값: -0.0200 | 새 가중치: 0.2974 | 예측 총 횟수: 28 | 예측 성공 수: 18 | 예측 성공률: 64.29%
2024-09-19 21:26:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.18%, 적중/전체: 117/220
2024-09-19 21:26:50 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84178000 | 예측: 하락 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 220 | 예측 성공 수: 117 | 예측 성공률: 53.18%
2024-09-19 21:26:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-19 21:26:51 - INFO - PROPHET | 이전예측가격: 84352390 | 당시BTC가격: 84178000 | 예측: 상승 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0991 | 반영가중치값: -0.0200 | 새 가중치: 0.0791 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-19 21:26:51 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-19 21:26:51 - INFO - TRANSFORMER | 이전예측가격: 83669970 | 당시BTC가격: 84178000 | 예측: 하락 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0969 | 반영가중치값: 0.0200 | 새 가중치: 0.1169 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-19 21:26:51 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 2/8
2024-09-19 21:26:51 - INFO - BITCOIN_FORECAST | 이전예측가격: 83013012 | 당시BTC가격: 84178000 | 예측: 하락 | 지금 BTC가격: 83981000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0969 | 반영가중치값: 0.0200 | 새 가중치: 0.1169 | 예측 총 횟수: 8 | 예측 성공 수: 2 | 예측 성공률: 25.00%
2024-09-19 21:26:51 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:26:51 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:26:51 - INFO - 새로운 가중치: {'gpt': 0.004300573054819099, 'ml': 0.20533307201538614, 'xgboost': 0.08924829269552428, 'rl': 0.27911112329116367, 'lstm': 0.10967201689319549, 'arima': 0.01877039026561071, 'prophet': 0.07422049799790974, 'transformer': 0.10967201689319549, 'bitcoin_forecast': 0.10967201689319549}
2024-09-19 21:26:51 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 21:26:51 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:26:51 - INFO - Current BTC price: 83981000.0
2024-09-19 21:26:51 - INFO - Analyzing market conditions.
2024-09-19 21:26:51 - INFO - Market analysis: {'current_price': 83981000.0, 'sma_20': 83433450.0, 'rsi_14': 68.61546848837634, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 21:26:51 - INFO - Starting predictions for all models
2024-09-19 21:26:51 - INFO - Attempting prediction for gpt
2024-09-19 21:26:51 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:26:51 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:26:51 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:26:51 - INFO - GPT prediction: 83981000.0
2024-09-19 21:26:51 - INFO - Attempting prediction for ml
2024-09-19 21:26:51 - INFO - ML prediction: 83897019.0
2024-09-19 21:26:51 - INFO - Attempting prediction for xgboost
2024-09-19 21:26:51 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:26:51 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:26:51 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:26:51 - INFO - XGBOOST prediction: 83981000.0
2024-09-19 21:26:51 - INFO - Attempting prediction for lstm
2024-09-19 21:26:51 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:26:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:26:51 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:26:51 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:26:51 - INFO - X 샘플:
[[-0.57880802 -0.85667036 -0.5956917  -0.89649763 -1.02652086 -1.02428471
  -0.89649763]
 [-0.87933139 -1.15746339 -1.69780717 -1.52293696 -0.41008632 -0.41569406
  -1.52293696]
 [-1.17985476 -0.85667036 -1.01799762 -0.70466932 -0.8792161  -0.87874606
  -0.70466932]
 [-0.70502783 -0.85667036 -0.47552334 -0.74063713 -0.85975128 -0.85879467
  -0.74063713]
 [-0.59984465 -0.43791927 -0.36908851 -0.28204757 -0.60497816 -0.60570416
  -0.28204757]
 [-0.18812763 -0.27572695  0.10815152 -0.2191039  -0.22532292 -0.2272777
  -0.2191039 ]
 [ 0.07633294  0.16661575  0.28668736  0.33539982  0.29648571  0.29360753
   0.33539982]
 [ 0.48804996  1.22823822  0.69182638  1.3844609   2.36238576  2.3595577
   1.3844609 ]
 [ 1.82237373  1.60865294  1.73557436  1.61825166  1.04305692  1.0494005
   1.61825166]
 [ 1.74423765  1.43761377  1.33386873  1.02778013  0.30394725  0.30793563
   1.02778013]]
2024-09-19 21:26:51 - INFO - y 샘플:
[1.02778013]
2024-09-19 21:26:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:26:51 - INFO - 모델 출력 (스케일링된 예측): [[0.4477753]]
2024-09-19 21:26:51 - INFO - 스케일러 역변환 후 예측 가격: 83787492.02174081
2024-09-19 21:26:51 - INFO - LSTMPredictor 최종 예측 가격: 83787492.02174081
2024-09-19 21:26:51 - INFO - LSTM prediction: 83787492.02174081
2024-09-19 21:26:51 - INFO - Attempting prediction for rl
2024-09-19 21:26:51 - INFO - Preparing state for RL agent.
2024-09-19 21:26:51 - INFO - Prepared state: [[ 8.39810000e+07  4.34466991e+01 -2.34027893e-03  8.34334500e+07
   6.86154685e+01]]
2024-09-19 21:26:51 - INFO - RL prediction: 84820810.0
2024-09-19 21:26:51 - INFO - Attempting prediction for arima
2024-09-19 21:26:51 - INFO - ARIMA 예측 시작
2024-09-19 21:26:51 - INFO - 입력 데이터: {'open': 84173000.0, 'high': 84181000.0, 'low': 83883000.0, 'close': 83981000.0, 'volume': 43.44669911, 'value': 3651116347.91938, 'decision': 'sell', 'sma': 83433450.0, 'ema': 83500151.40179719, 'rsi': 68.61546848837634, 'macd': 264395.8599141836, 'signal_line': 192266.64147392582, 'BB_Upper': 84100659.25503294, 'BB_Lower': 82766240.74496706}
2024-09-19 21:26:51 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:26:51 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83433450.0         0         0
2024-09-19 21:26:51 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83433450.0         0         0
2024-09-19 21:26:51 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:26:51 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:26:51 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:26:51 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:26:51 - INFO - Attempting prediction for prophet
2024-09-19 21:26:51 - INFO - PROPHET prediction: 84094112.89913483
2024-09-19 21:26:51 - INFO - Attempting prediction for transformer
2024-09-19 21:26:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:26:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:26:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:26:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:26:51 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:26:51 - INFO - X 샘플:
[[-0.57880802 -0.85667036 -0.5956917  -0.89649763 -1.02652086 -1.02428471
  -0.89649763 -0.89649763  0.          0.          0.         -0.89649763
  -0.89649763]
 [-0.87933139 -1.15746339 -1.69780717 -1.52293696 -0.41008632 -0.41569406
  -1.52293696 -1.52293696  0.          0.          0.         -1.52293696
  -1.52293696]
 [-1.17985476 -0.85667036 -1.01799762 -0.70466932 -0.8792161  -0.87874606
  -0.70466932 -0.70466932  0.          0.          0.         -0.70466932
  -0.70466932]
 [-0.70502783 -0.85667036 -0.47552334 -0.74063713 -0.85975128 -0.85879467
  -0.74063713 -0.74063713  0.          0.          0.         -0.74063713
  -0.74063713]
 [-0.59984465 -0.43791927 -0.36908851 -0.28204757 -0.60497816 -0.60570416
  -0.28204757 -0.28204757  0.          0.          0.         -0.28204757
  -0.28204757]
 [-0.18812763 -0.27572695  0.10815152 -0.2191039  -0.22532292 -0.2272777
  -0.2191039  -0.2191039   0.          0.          0.         -0.2191039
  -0.2191039 ]
 [ 0.07633294  0.16661575  0.28668736  0.33539982  0.29648571  0.29360753
   0.33539982  0.33539982  0.          0.          0.          0.33539982
   0.33539982]
 [ 0.48804996  1.22823822  0.69182638  1.3844609   2.36238576  2.3595577
   1.3844609   1.3844609   0.          0.          0.          1.3844609
   1.3844609 ]
 [ 1.82237373  1.60865294  1.73557436  1.61825166  1.04305692  1.0494005
   1.61825166  1.61825166  0.          0.          0.          1.61825166
   1.61825166]
 [ 1.74423765  1.43761377  1.33386873  1.02778013  0.30394725  0.30793563
   1.02778013  1.02778013  0.          0.          0.          1.02778013
   1.02778013]]
2024-09-19 21:26:51 - INFO - y 샘플:
[1.02778013]
2024-09-19 21:26:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:26:51 - INFO - 모델 출력 (스케일링된 예측): [0.2972042]
2024-09-19 21:26:51 - INFO - 스케일러 역변환 후 예측 가격: 83737256.73184714
2024-09-19 21:26:51 - INFO - TransformerPredictor 최종 예측 가격: 83737256.73184714
2024-09-19 21:26:51 - INFO - TRANSFORMER prediction: 83737256.73184714
2024-09-19 21:26:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:26:51 - INFO - BITCOIN_FORECAST prediction: 82917734.05579583
2024-09-19 21:26:51 - INFO - BitcoinForecast prediction: 82917734.05579583
2024-09-19 21:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:26:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:26:58 - INFO - 조정된 모델 가중치: {'gpt': 0.004300573054819099, 'ml': 0.20533307201538614, 'xgboost': 0.08924829269552428, 'rl': 0.27911112329116367, 'lstm': 0.10967201689319549, 'arima': 0.01877039026561071, 'prophet': 0.07422049799790974, 'transformer': 0.10967201689319549, 'bitcoin_forecast': 0.10967201689319549}
2024-09-19 21:26:58 - INFO - 조정된 모델 가중치: {'gpt': 0.004300573054819099, 'ml': 0.20533307201538614, 'xgboost': 0.08924829269552428, 'rl': 0.27911112329116367, 'lstm': 0.10967201689319549, 'arima': 0.01877039026561071, 'prophet': 0.07422049799790974, 'transformer': 0.10967201689319549, 'bitcoin_forecast': 0.10967201689319549}
2024-09-19 21:26:58 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83984136.4419576, 'current_price': 83981000.0, 'predictions': {'gpt': 83981000.0, 'ml': 83897019.0, 'xgboost': 83981000.0, 'lstm': 83787492.02174081, 'rl': 84820810.0, 'arima': 80899000.0, 'prophet': 84094112.89913483, 'transformer': 83737256.73184714, 'bitcoin_forecast': 82917734.05579583}, 'weights': {'gpt': 0.004300573054819099, 'ml': 0.20533307201538614, 'xgboost': 0.08924829269552428, 'rl': 0.27911112329116367, 'lstm': 0.10967201689319549, 'arima': 0.01877039026561071, 'prophet': 0.07422049799790974, 'transformer': 0.10967201689319549, 'bitcoin_forecast': 0.10967201689319549}}
2024-09-19 21:26:58 - INFO - 모델별 가중치:
2024-09-19 21:26:58 - INFO -   - GPT: 0.0043
2024-09-19 21:26:58 - INFO -   - ML: 0.2053
2024-09-19 21:26:58 - INFO -   - XGBOOST: 0.0892
2024-09-19 21:26:58 - INFO -   - RL: 0.2791
2024-09-19 21:26:58 - INFO -   - LSTM: 0.1097
2024-09-19 21:26:58 - INFO -   - ARIMA: 0.0188
2024-09-19 21:26:58 - INFO -   - PROPHET: 0.0742
2024-09-19 21:26:58 - INFO -   - TRANSFORMER: 0.1097
2024-09-19 21:26:58 - INFO -   - BITCOIN_FORECAST: 0.1097
2024-09-19 21:26:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:26:58 - INFO - 6. 거래 실행
2024-09-19 21:26:58 - INFO - Cancelling existing orders.
2024-09-19 21:26:58 - INFO - Cancelled 0 orders.
2024-09-19 21:26:58 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83984136.4419576, 'current_price': 83981000.0, 'predictions': {'gpt': 83981000.0, 'ml': 83897019.0, 'xgboost': 83981000.0, 'lstm': 83787492.02174081, 'rl': 84820810.0, 'arima': 80899000.0, 'prophet': 84094112.89913483, 'transformer': 83737256.73184714, 'bitcoin_forecast': 82917734.05579583}, 'weights': {'gpt': 0.004300573054819099, 'ml': 0.20533307201538614, 'xgboost': 0.08924829269552428, 'rl': 0.27911112329116367, 'lstm': 0.10967201689319549, 'arima': 0.01877039026561071, 'prophet': 0.07422049799790974, 'transformer': 0.10967201689319549, 'bitcoin_forecast': 0.10967201689319549}}, 현재 가격=83981000.0
2024-09-19 21:26:58 - INFO - 현재 잔고: KRW=292484.04054791, BTC=0.00220982, 총 자산가치=478066.93396791
2024-09-19 21:26:58 - INFO - 매수 시도: 0.0005692560626426335 BTC (약 47806.693396791 KRW)
2024-09-19 21:26:58 - INFO - 주문 결과: {'uuid': '494cfbfb-f57c-443e-91f2-f86830376809', 'side': 'bid', 'ord_type': 'limit', 'price': '83981000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:26:58+09:00', 'volume': '0.00056925', 'remaining_volume': '0.00056925', 'reserved_fee': '23.903092125', 'remaining_fee': '23.903092125', 'paid_fee': '0', 'locked': '47830.087342125', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:26:58 - INFO - buy 주문 성공: UUID=494cfbfb-f57c-443e-91f2-f86830376809
2024-09-19 21:26:58 - INFO - Trade executed successfully.
2024-09-19 21:26:58 - INFO - 7. summary 리포트 보내기
2024-09-19 21:26:58 - INFO - Message sent to Discord successfully.
2024-09-19 21:26:58 - INFO - Trading cycle completed.
2024-09-19 21:26:58 - INFO - Performing periodic update.
2024-09-19 21:26:58 - INFO - 계산된 시장 변동성: 0.030741517303706205
2024-09-19 21:35:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:35:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8190-8354-da27a169716b "HTTP/1.1 200 OK"
2024-09-19 21:35:43 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:35:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810a-b551-d04b3428224c "HTTP/1.1 200 OK"
2024-09-19 21:35:54 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cc-a4bf-fec77724c743 "HTTP/1.1 200 OK"
2024-09-19 21:36:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c8-bbe9-f48dfb3cc089 "HTTP/1.1 200 OK"
2024-09-19 21:36:11 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-87b3-e6afa141fb2b "HTTP/1.1 200 OK"
2024-09-19 21:36:19 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a7-a498-e6b2af8fd78f "HTTP/1.1 200 OK"
2024-09-19 21:36:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-807d-f7afa26d0207 "HTTP/1.1 200 OK"
2024-09-19 21:36:40 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/09f4680d-f948-410e-95bd-33ee536cb2f6 "HTTP/1.1 200 OK"
2024-09-19 21:36:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:36:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/da7a829f-a784-487f-98be-29bd2d1e7e41 "HTTP/1.1 200 OK"
2024-09-19 21:36:52 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:25:34.938271
2024-09-19 21:36:52 - INFO - Starting trading cycle.
2024-09-19 21:36:52 - INFO - ##################################################
2024-09-19 21:36:52 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-19 21:36:52 - INFO - ##################################################
2024-09-19 21:36:52 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:36:52 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:36:52 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:20:00
2024-09-19 21:36:52 - INFO - 새로운 데이터 범위: 2024-09-18 12:20:00 ~ 2024-09-19 21:30:00
2024-09-19 21:36:52 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:36:52 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:36:52 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:36:52 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:36:52 - INFO - Sample date values: [Timestamp('2024-09-19 21:30:00')]
2024-09-19 21:36:52 - INFO - Successfully added 1 new data points
2024-09-19 21:36:52 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:36:52 - INFO - Final date range: 2024-09-19 21:30:00 to 2024-09-19 21:30:00
2024-09-19 21:36:52 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:36:52 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:30:00
2024-09-19 21:36:52 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:36:52 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:36:52 - INFO - GPT | 이전예측가격: 83981000 | 당시BTC가격: 83981000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:36:52 - INFO - ML 모델 예측 업데이트: 정확도 48.15%, 적중/전체: 13/27
2024-09-19 21:36:52 - INFO - ML | 이전예측가격: 83897019 | 당시BTC가격: 83981000 | 예측: 하락 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2227 | 반영가중치값: -0.0200 | 새 가중치: 0.2027 | 예측 총 횟수: 27 | 예측 성공 수: 13 | 예측 성공률: 48.15%
2024-09-19 21:36:52 - INFO - XGBOOST | 이전예측가격: 83981000 | 당시BTC가격: 83981000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:36:52 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 3/9
2024-09-19 21:36:52 - INFO - LSTM | 이전예측가격: 83787492 | 당시BTC가격: 83981000 | 예측: 하락 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1057 | 반영가중치값: -0.0200 | 새 가중치: 0.0857 | 예측 총 횟수: 9 | 예측 성공 수: 3 | 예측 성공률: 33.33%
2024-09-19 21:36:52 - INFO - RL 모델 예측 업데이트: 정확도 65.52%, 적중/전체: 19/29
2024-09-19 21:36:53 - INFO - RL | 이전예측가격: 84820810 | 당시BTC가격: 83981000 | 예측: 상승 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1000 | 반영가중치값: 0.0200 | 새 가중치: 0.1200 | 예측 총 횟수: 29 | 예측 성공 수: 19 | 예측 성공률: 65.52%
2024-09-19 21:36:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 117/221
2024-09-19 21:36:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83981000 | 예측: 하락 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1396 | 반영가중치값: -0.0200 | 새 가중치: 0.1196 | 예측 총 횟수: 221 | 예측 성공 수: 117 | 예측 성공률: 52.94%
2024-09-19 21:36:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.00%, 적중/전체: 16/25
2024-09-19 21:36:53 - INFO - PROPHET | 이전예측가격: 84094113 | 당시BTC가격: 83981000 | 예측: 상승 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0896 | 반영가중치값: 0.0200 | 새 가중치: 0.1096 | 예측 총 횟수: 25 | 예측 성공 수: 16 | 예측 성공률: 64.00%
2024-09-19 21:36:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 3/9
2024-09-19 21:36:53 - INFO - TRANSFORMER | 이전예측가격: 83737257 | 당시BTC가격: 83981000 | 예측: 하락 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1305 | 반영가중치값: -0.0200 | 새 가중치: 0.1105 | 예측 총 횟수: 9 | 예측 성공 수: 3 | 예측 성공률: 33.33%
2024-09-19 21:36:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 22.22%, 적중/전체: 2/9
2024-09-19 21:36:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82917734 | 당시BTC가격: 83981000 | 예측: 하락 | 지금 BTC가격: 84186000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1122 | 반영가중치값: -0.0200 | 새 가중치: 0.0922 | 예측 총 횟수: 9 | 예측 성공 수: 2 | 예측 성공률: 22.22%
2024-09-19 21:36:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:36:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:36:53 - INFO - 새로운 가중치: {'gpt': 0.004605100001858673, 'ml': 0.21707409059439997, 'xgboost': 0.09556803421755397, 'rl': 0.12852707269851, 'lstm': 0.09178099515564722, 'arima': 0.12801554874435203, 'prophet': 0.11735248895392188, 'transformer': 0.11832283246589387, 'bitcoin_forecast': 0.0987538371678624}
2024-09-19 21:36:53 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 21:36:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:36:53 - INFO - Current BTC price: 84186000.0
2024-09-19 21:36:53 - INFO - Analyzing market conditions.
2024-09-19 21:36:53 - INFO - Market analysis: {'current_price': 84186000.0, 'sma_20': 83494800.0, 'rsi_14': 72.2322821253503, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 21:36:53 - INFO - Starting predictions for all models
2024-09-19 21:36:53 - INFO - Attempting prediction for gpt
2024-09-19 21:36:53 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:36:53 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:36:53 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:36:53 - INFO - GPT prediction: 84186000.0
2024-09-19 21:36:53 - INFO - Attempting prediction for ml
2024-09-19 21:36:53 - INFO - ML prediction: 84101814.0
2024-09-19 21:36:53 - INFO - Attempting prediction for xgboost
2024-09-19 21:36:53 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:36:53 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:36:53 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:36:53 - INFO - XGBOOST prediction: 84186000.0
2024-09-19 21:36:53 - INFO - Attempting prediction for lstm
2024-09-19 21:36:53 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:36:53 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:36:53 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:36:53 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:36:53 - INFO - X 샘플:
[[-1.01784033 -1.32527791 -1.76581539 -1.67528923 -0.5409428  -0.5472261
  -1.67528923]
 [-1.30741084 -1.04093137 -1.14113887 -0.90377445 -1.03961906 -1.03934864
  -0.90377445]
 [-0.84988944 -1.04093137 -0.64265963 -0.93768719 -1.01892832 -1.0181447
  -0.93768719]
 [-0.74853976 -0.64507637 -0.54485674 -0.50529979 -0.74810922 -0.7491651
  -0.50529979]
 [-0.35182817 -0.49175226 -0.10632121 -0.4459525  -0.34454273 -0.34698091
  -0.4459525 ]
 [-0.09700612 -0.07359558  0.05773525  0.07686887  0.21013018  0.20660564
   0.07686887]
 [ 0.29970548  0.92998046  0.43001722  1.06599038  2.40614368  2.40225676
   1.06599038]
 [ 1.58539853  1.28959521  1.38911652  1.28642318  1.00372155  1.00984751
   1.28642318]
 [ 1.5101102   1.12790796  1.01998949  0.72968907  0.21806166  0.22183327
   0.72968907]
 [ 0.97730046  1.27008123  1.30393336  1.30903167 -0.14591493 -0.13967774
   1.30903167]]
2024-09-19 21:36:53 - INFO - y 샘플:
[1.30903167]
2024-09-19 21:36:53 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:36:53 - INFO - 모델 출력 (스케일링된 예측): [[0.45293182]]
2024-09-19 21:36:53 - INFO - 스케일러 역변환 후 예측 가격: 83883069.6289806
2024-09-19 21:36:53 - INFO - LSTMPredictor 최종 예측 가격: 83883069.6289806
2024-09-19 21:36:53 - INFO - LSTM prediction: 83883069.6289806
2024-09-19 21:36:53 - INFO - Attempting prediction for rl
2024-09-19 21:36:53 - INFO - Preparing state for RL agent.
2024-09-19 21:36:53 - INFO - Prepared state: [[8.41860000e+07 3.44865687e+01 2.44102833e-03 8.34948000e+07
  7.22322821e+01]]
2024-09-19 21:36:53 - INFO - RL prediction: 85027860.0
2024-09-19 21:36:53 - INFO - Attempting prediction for arima
2024-09-19 21:36:53 - INFO - ARIMA 예측 시작
2024-09-19 21:36:53 - INFO - 입력 데이터: {'open': 83989000.0, 'high': 84232000.0, 'low': 83973000.0, 'close': 84186000.0, 'volume': 34.48656866, 'value': 2902615678.08861, 'decision': 'sell', 'sma': 83494800.0, 'ema': 83565470.31591174, 'rsi': 72.2322821253503, 'macd': 285747.5117316544, 'signal_line': 210962.81552547152, 'BB_Upper': 84200745.21033974, 'BB_Lower': 82788854.78966026}
2024-09-19 21:36:53 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:36:53 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83494800.0         0         0
2024-09-19 21:36:53 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83494800.0         0         0
2024-09-19 21:36:53 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:36:53 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:36:53 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:36:53 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:36:53 - INFO - Attempting prediction for prophet
2024-09-19 21:36:53 - INFO - PROPHET prediction: 84313459.28709754
2024-09-19 21:36:53 - INFO - Attempting prediction for transformer
2024-09-19 21:36:53 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:36:53 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:36:53 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:36:53 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:36:53 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:36:53 - INFO - X 샘플:
[[-1.01784033 -1.32527791 -1.76581539 -1.67528923 -0.5409428  -0.5472261
  -1.67528923 -1.67528923  0.          0.          0.         -1.67528923
  -1.67528923]
 [-1.30741084 -1.04093137 -1.14113887 -0.90377445 -1.03961906 -1.03934864
  -0.90377445 -0.90377445  0.          0.          0.         -0.90377445
  -0.90377445]
 [-0.84988944 -1.04093137 -0.64265963 -0.93768719 -1.01892832 -1.0181447
  -0.93768719 -0.93768719  0.          0.          0.         -0.93768719
  -0.93768719]
 [-0.74853976 -0.64507637 -0.54485674 -0.50529979 -0.74810922 -0.7491651
  -0.50529979 -0.50529979  0.          0.          0.         -0.50529979
  -0.50529979]
 [-0.35182817 -0.49175226 -0.10632121 -0.4459525  -0.34454273 -0.34698091
  -0.4459525  -0.4459525   0.          0.          0.         -0.4459525
  -0.4459525 ]
 [-0.09700612 -0.07359558  0.05773525  0.07686887  0.21013018  0.20660564
   0.07686887  0.07686887  0.          0.          0.          0.07686887
   0.07686887]
 [ 0.29970548  0.92998046  0.43001722  1.06599038  2.40614368  2.40225676
   1.06599038  1.06599038  0.          0.          0.          1.06599038
   1.06599038]
 [ 1.58539853  1.28959521  1.38911652  1.28642318  1.00372155  1.00984751
   1.28642318  1.28642318  0.          0.          0.          1.28642318
   1.28642318]
 [ 1.5101102   1.12790796  1.01998949  0.72968907  0.21806166  0.22183327
   0.72968907  0.72968907  0.          0.          0.          0.72968907
   0.72968907]
 [ 0.97730046  1.27008123  1.30393336  1.30903167 -0.14591493 -0.13967774
   1.30903167  1.30903167  0.          0.          0.          1.30903167
   1.30903167]]
2024-09-19 21:36:53 - INFO - y 샘플:
[1.30903167]
2024-09-19 21:36:53 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:36:53 - INFO - 모델 출력 (스케일링된 예측): [0.29800782]
2024-09-19 21:36:53 - INFO - 스케일러 역변환 후 예측 가격: 83828249.87096271
2024-09-19 21:36:53 - INFO - TransformerPredictor 최종 예측 가격: 83828249.87096271
2024-09-19 21:36:53 - INFO - TRANSFORMER prediction: 83828249.87096271
2024-09-19 21:36:53 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:36:53 - INFO - BITCOIN_FORECAST prediction: 82892245.87899953
2024-09-19 21:36:53 - INFO - BitcoinForecast prediction: 82892245.87899953
2024-09-19 21:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:37:08 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:37:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004605100001858673, 'ml': 0.21707409059439997, 'xgboost': 0.09556803421755397, 'rl': 0.12852707269851, 'lstm': 0.09178099515564722, 'arima': 0.12801554874435203, 'prophet': 0.11735248895392188, 'transformer': 0.11832283246589387, 'bitcoin_forecast': 0.0987538371678624}
2024-09-19 21:37:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004605100001858673, 'ml': 0.21707409059439997, 'xgboost': 0.09556803421755397, 'rl': 0.12852707269851, 'lstm': 0.09178099515564722, 'arima': 0.12801554874435203, 'prophet': 0.11735248895392188, 'transformer': 0.11832283246589387, 'bitcoin_forecast': 0.0987538371678624}
2024-09-19 21:37:08 - INFO - Decision: {'decision': 'sell', 'percentage': 20.0, 'target_price': 83672201.3145914, 'current_price': 84186000.0, 'predictions': {'gpt': 84186000.0, 'ml': 84101814.0, 'xgboost': 84186000.0, 'lstm': 83883069.6289806, 'rl': 85027860.0, 'arima': 80899000.0, 'prophet': 84313459.28709754, 'transformer': 83828249.87096271, 'bitcoin_forecast': 82892245.87899953}, 'weights': {'gpt': 0.004605100001858673, 'ml': 0.21707409059439997, 'xgboost': 0.09556803421755397, 'rl': 0.12852707269851, 'lstm': 0.09178099515564722, 'arima': 0.12801554874435203, 'prophet': 0.11735248895392188, 'transformer': 0.11832283246589387, 'bitcoin_forecast': 0.0987538371678624}}
2024-09-19 21:37:08 - INFO - 모델별 가중치:
2024-09-19 21:37:08 - INFO -   - GPT: 0.0046
2024-09-19 21:37:08 - INFO -   - ML: 0.2171
2024-09-19 21:37:08 - INFO -   - XGBOOST: 0.0956
2024-09-19 21:37:08 - INFO -   - RL: 0.1285
2024-09-19 21:37:08 - INFO -   - LSTM: 0.0918
2024-09-19 21:37:08 - INFO -   - ARIMA: 0.1280
2024-09-19 21:37:08 - INFO -   - PROPHET: 0.1174
2024-09-19 21:37:08 - INFO -   - TRANSFORMER: 0.1183
2024-09-19 21:37:08 - INFO -   - BITCOIN_FORECAST: 0.0988
2024-09-19 21:37:08 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:37:08 - INFO - 6. 거래 실행
2024-09-19 21:37:08 - INFO - Cancelling existing orders.
2024-09-19 21:37:08 - INFO - Cancelled 0 orders.
2024-09-19 21:37:08 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 20.0, 'target_price': 83672201.3145914, 'current_price': 84186000.0, 'predictions': {'gpt': 84186000.0, 'ml': 84101814.0, 'xgboost': 84186000.0, 'lstm': 83883069.6289806, 'rl': 85027860.0, 'arima': 80899000.0, 'prophet': 84313459.28709754, 'transformer': 83828249.87096271, 'bitcoin_forecast': 82892245.87899953}, 'weights': {'gpt': 0.004605100001858673, 'ml': 0.21707409059439997, 'xgboost': 0.09556803421755397, 'rl': 0.12852707269851, 'lstm': 0.09178099515564722, 'arima': 0.12801554874435203, 'prophet': 0.11735248895392188, 'transformer': 0.11832283246589387, 'bitcoin_forecast': 0.0987538371678624}}, 현재 가격=84186000.0
2024-09-19 21:37:08 - INFO - 현재 잔고: KRW=244653.95320578, BTC=0.00277907, 총 자산가치=478612.74022578
2024-09-19 21:37:08 - INFO - 매도 시도: 0.0005558140000000001 BTC (약 46791.757404 KRW)
2024-09-19 21:37:08 - INFO - 주문 결과: {'uuid': '2d97a51b-5a68-4246-86a5-eaf0cb325bdd', 'side': 'ask', 'ord_type': 'limit', 'price': '84186000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:37:08+09:00', 'volume': '0.00055581', 'remaining_volume': '0.00055581', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00055581', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:37:08 - INFO - sell 주문 성공: UUID=2d97a51b-5a68-4246-86a5-eaf0cb325bdd
2024-09-19 21:37:08 - INFO - Trade executed successfully.
2024-09-19 21:37:08 - INFO - 7. summary 리포트 보내기
2024-09-19 21:37:09 - INFO - Message sent to Discord successfully.
2024-09-19 21:37:09 - INFO - Trading cycle completed.
2024-09-19 21:37:09 - INFO - Performing periodic update.
2024-09-19 21:37:09 - INFO - 계산된 시장 변동성: 0.029332839763413703
2024-09-19 21:45:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:45:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814f-a8fe-fc790f054458 "HTTP/1.1 200 OK"
2024-09-19 21:45:48 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:45:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d7ad593a-0e65-4c9e-be2d-5cd3d95ebc33 "HTTP/1.1 200 OK"
2024-09-19 21:45:57 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-a72e-c7963eb15f95 "HTTP/1.1 200 OK"
2024-09-19 21:46:06 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812c-90fc-dc03363e5763 "HTTP/1.1 200 OK"
2024-09-19 21:46:15 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815e-b76f-efc0575610bc "HTTP/1.1 200 OK"
2024-09-19 21:46:25 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-a108-c3d975f1129a "HTTP/1.1 200 OK"
2024-09-19 21:46:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816d-b326-d0612b23ceda "HTTP/1.1 200 OK"
2024-09-19 21:46:43 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:46:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-bcb6-f022962dc8c0 "HTTP/1.1 200 OK"
2024-09-19 21:46:48 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:47:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:47:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-9deb-d654922d32cb "HTTP/1.1 200 OK"
2024-09-19 21:47:01 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:35:34.938840
2024-09-19 21:47:01 - INFO - Starting trading cycle.
2024-09-19 21:47:01 - INFO - ##################################################
2024-09-19 21:47:01 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-19 21:47:01 - INFO - ##################################################
2024-09-19 21:47:01 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:47:01 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:47:01 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:30:00
2024-09-19 21:47:01 - INFO - 새로운 데이터 범위: 2024-09-18 12:30:00 ~ 2024-09-19 21:40:00
2024-09-19 21:47:01 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:47:01 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:47:01 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:47:01 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:47:01 - INFO - Sample date values: [Timestamp('2024-09-19 21:40:00')]
2024-09-19 21:47:01 - INFO - Successfully added 1 new data points
2024-09-19 21:47:01 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:47:01 - INFO - Final date range: 2024-09-19 21:40:00 to 2024-09-19 21:40:00
2024-09-19 21:47:01 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:47:01 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:40:00
2024-09-19 21:47:01 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:47:02 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:47:02 - INFO - GPT | 이전예측가격: 84186000 | 당시BTC가격: 84186000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:47:02 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 14/28
2024-09-19 21:47:02 - INFO - ML | 이전예측가격: 84101814 | 당시BTC가격: 84186000 | 예측: 하락 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2053 | 반영가중치값: 0.0200 | 새 가중치: 0.2253 | 예측 총 횟수: 28 | 예측 성공 수: 14 | 예측 성공률: 50.00%
2024-09-19 21:47:02 - INFO - XGBOOST | 이전예측가격: 84186000 | 당시BTC가격: 84186000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:47:02 - INFO - LSTM 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-19 21:47:02 - INFO - LSTM | 이전예측가격: 83883070 | 당시BTC가격: 84186000 | 예측: 하락 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1097 | 반영가중치값: 0.0200 | 새 가중치: 0.1297 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-19 21:47:02 - INFO - RL 모델 예측 업데이트: 정확도 63.33%, 적중/전체: 19/30
2024-09-19 21:47:02 - INFO - RL | 이전예측가격: 85027860 | 당시BTC가격: 84186000 | 예측: 상승 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2791 | 반영가중치값: -0.0200 | 새 가중치: 0.2591 | 예측 총 횟수: 30 | 예측 성공 수: 19 | 예측 성공률: 63.33%
2024-09-19 21:47:02 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.15%, 적중/전체: 118/222
2024-09-19 21:47:02 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84186000 | 예측: 하락 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0188 | 반영가중치값: 0.0200 | 새 가중치: 0.0388 | 예측 총 횟수: 222 | 예측 성공 수: 118 | 예측 성공률: 53.15%
2024-09-19 21:47:02 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 16/26
2024-09-19 21:47:02 - INFO - PROPHET | 이전예측가격: 84313459 | 당시BTC가격: 84186000 | 예측: 상승 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0742 | 반영가중치값: -0.0200 | 새 가중치: 0.0542 | 예측 총 횟수: 26 | 예측 성공 수: 16 | 예측 성공률: 61.54%
2024-09-19 21:47:02 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-19 21:47:02 - INFO - TRANSFORMER | 이전예측가격: 83828250 | 당시BTC가격: 84186000 | 예측: 하락 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1097 | 반영가중치값: 0.0200 | 새 가중치: 0.1297 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-19 21:47:02 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 30.00%, 적중/전체: 3/10
2024-09-19 21:47:02 - INFO - BITCOIN_FORECAST | 이전예측가격: 82892246 | 당시BTC가격: 84186000 | 예측: 하락 | 지금 BTC가격: 83998000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1097 | 반영가중치값: 0.0200 | 새 가중치: 0.1297 | 예측 총 횟수: 10 | 예측 성공 수: 3 | 예측 성공률: 30.00%
2024-09-19 21:47:02 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:47:02 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:47:02 - INFO - 새로운 가중치: {'gpt': 0.004317452863198391, 'ml': 0.2112581521689992, 'xgboost': 0.08959859347164789, 'rl': 0.2429263339967569, 'lstm': 0.12157234813278187, 'arima': 0.03634868567284525, 'prophet': 0.0508337374282067, 'transformer': 0.12157234813278187, 'bitcoin_forecast': 0.12157234813278187}
2024-09-19 21:47:02 - INFO - XGBoost 모델 성능: 정확도 62.93%, 적중/전체: 73/116
2024-09-19 21:47:02 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:47:02 - INFO - Current BTC price: 83998000.0
2024-09-19 21:47:02 - INFO - Analyzing market conditions.
2024-09-19 21:47:02 - INFO - Market analysis: {'current_price': 83976000.0, 'sma_20': 83544200.0, 'rsi_14': 64.08492956864828, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 21:47:02 - INFO - Starting predictions for all models
2024-09-19 21:47:02 - INFO - Attempting prediction for gpt
2024-09-19 21:47:02 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:47:02 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:47:02 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:47:02 - INFO - GPT prediction: 83998000.0
2024-09-19 21:47:02 - INFO - Attempting prediction for ml
2024-09-19 21:47:02 - INFO - ML prediction: 83875228.8
2024-09-19 21:47:02 - INFO - Attempting prediction for xgboost
2024-09-19 21:47:02 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:47:02 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:47:02 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:47:02 - INFO - XGBOOST prediction: 83976000.0
2024-09-19 21:47:02 - INFO - Attempting prediction for lstm
2024-09-19 21:47:02 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:47:02 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:47:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:47:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:47:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:47:02 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:47:02 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:47:02 - INFO - X 샘플:
[[-1.54140342 -1.36552228 -1.65579796 -1.35310603 -1.04068367 -1.04208053
  -1.35310603]
 [-1.07645164 -1.36552228 -1.08620058 -1.39325755 -1.01998533 -1.02085656
  -1.39325755]
 [-0.973456   -0.93954652 -0.97444413 -0.88132574 -0.74906676 -0.75162292
  -0.88132574]
 [-0.57030161 -0.77455591 -0.47334264 -0.81106059 -0.34535204 -0.34905888
  -0.81106059]
 [-0.31134113 -0.32458153 -0.28588021 -0.19205808  0.2095246   0.20505051
  -0.19205808]
 [ 0.09181326  0.75535701  0.13951531  0.97902776  2.4063447   2.40277534
   0.97902776]
 [ 1.39838661  1.14233498  1.23544951  1.2400126   1.00340746  1.00905101
   1.2400126 ]
 [ 1.32187556  0.96834488  0.81365905  0.58085857  0.21745899  0.22029252
   0.58085857]
 [ 0.78041273  1.12133618  1.13811325  1.26678028 -0.14665129 -0.14155992
   1.26678028]
 [ 0.88046564  0.78235547  1.14892839  0.56412878 -0.53499667 -0.53199057
   0.56412878]]
2024-09-19 21:47:02 - INFO - y 샘플:
[0.56412878]
2024-09-19 21:47:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:47:02 - INFO - 모델 출력 (스케일링된 예측): [[0.45199168]]
2024-09-19 21:47:02 - INFO - 스케일러 역변환 후 예측 가격: 83942485.81728289
2024-09-19 21:47:02 - INFO - LSTMPredictor 최종 예측 가격: 83942485.81728289
2024-09-19 21:47:02 - INFO - LSTM prediction: 83942485.81728289
2024-09-19 21:47:02 - INFO - Attempting prediction for rl
2024-09-19 21:47:02 - INFO - Preparing state for RL agent.
2024-09-19 21:47:02 - INFO - Prepared state: [[ 8.39760000e+07  2.49300538e+01 -2.49447652e-03  8.35442000e+07
   6.40849296e+01]]
2024-09-19 21:47:02 - INFO - RL prediction: 84837980.0
2024-09-19 21:47:02 - INFO - Attempting prediction for arima
2024-09-19 21:47:02 - INFO - ARIMA 예측 시작
2024-09-19 21:47:02 - INFO - 입력 데이터: {'open': 84023000.0, 'high': 84119000.0, 'low': 83976000.0, 'close': 83976000.0, 'volume': 24.9300538, 'value': 2095000285.54436, 'decision': 'sell', 'sma': 83544200.0, 'ema': 83604568.381063, 'rsi': 64.08492956864828, 'macd': 282467.49521562457, 'signal_line': 225263.75146350212, 'BB_Upper': 84239569.42699663, 'BB_Lower': 82848830.57300337}
2024-09-19 21:47:02 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:47:02 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83544200.0         0         0
2024-09-19 21:47:02 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83544200.0         0         0
2024-09-19 21:47:02 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:47:02 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:47:02 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:47:02 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:47:02 - INFO - Attempting prediction for prophet
2024-09-19 21:47:03 - INFO - PROPHET prediction: 84052655.1284141
2024-09-19 21:47:03 - INFO - Attempting prediction for transformer
2024-09-19 21:47:03 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:47:03 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:47:03 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:47:03 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:47:03 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:47:03 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:47:03 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:47:03 - INFO - X 샘플:
[[-1.54140342 -1.36552228 -1.65579796 -1.35310603 -1.04068367 -1.04208053
  -1.35310603 -1.35310603  0.          0.          0.         -1.35310603
  -1.35310603]
 [-1.07645164 -1.36552228 -1.08620058 -1.39325755 -1.01998533 -1.02085656
  -1.39325755 -1.39325755  0.          0.          0.         -1.39325755
  -1.39325755]
 [-0.973456   -0.93954652 -0.97444413 -0.88132574 -0.74906676 -0.75162292
  -0.88132574 -0.88132574  0.          0.          0.         -0.88132574
  -0.88132574]
 [-0.57030161 -0.77455591 -0.47334264 -0.81106059 -0.34535204 -0.34905888
  -0.81106059 -0.81106059  0.          0.          0.         -0.81106059
  -0.81106059]
 [-0.31134113 -0.32458153 -0.28588021 -0.19205808  0.2095246   0.20505051
  -0.19205808 -0.19205808  0.          0.          0.         -0.19205808
  -0.19205808]
 [ 0.09181326  0.75535701  0.13951531  0.97902776  2.4063447   2.40277534
   0.97902776  0.97902776  0.          0.          0.          0.97902776
   0.97902776]
 [ 1.39838661  1.14233498  1.23544951  1.2400126   1.00340746  1.00905101
   1.2400126   1.2400126   0.          0.          0.          1.2400126
   1.2400126 ]
 [ 1.32187556  0.96834488  0.81365905  0.58085857  0.21745899  0.22029252
   0.58085857  0.58085857  0.          0.          0.          0.58085857
   0.58085857]
 [ 0.78041273  1.12133618  1.13811325  1.26678028 -0.14665129 -0.14155992
   1.26678028  1.26678028  0.          0.          0.          1.26678028
   1.26678028]
 [ 0.88046564  0.78235547  1.14892839  0.56412878 -0.53499667 -0.53199057
   0.56412878  0.56412878  0.          0.          0.          0.56412878
   0.56412878]]
2024-09-19 21:47:03 - INFO - y 샘플:
[0.56412878]
2024-09-19 21:47:03 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:47:03 - INFO - 모델 출력 (스케일링된 예측): [0.2966589]
2024-09-19 21:47:03 - INFO - 스케일러 역변환 후 예측 가격: 83896061.8325706
2024-09-19 21:47:03 - INFO - TransformerPredictor 최종 예측 가격: 83896061.8325706
2024-09-19 21:47:03 - INFO - TRANSFORMER prediction: 83896061.8325706
2024-09-19 21:47:03 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:47:03 - INFO - BITCOIN_FORECAST prediction: 82840884.38409784
2024-09-19 21:47:03 - INFO - BitcoinForecast prediction: 82840884.38409784
2024-09-19 21:47:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:47:18 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:47:18 - INFO - 조정된 모델 가중치: {'gpt': 0.004317452863198391, 'ml': 0.2112581521689992, 'xgboost': 0.08959859347164789, 'rl': 0.2429263339967569, 'lstm': 0.12157234813278187, 'arima': 0.03634868567284525, 'prophet': 0.0508337374282067, 'transformer': 0.12157234813278187, 'bitcoin_forecast': 0.12157234813278187}
2024-09-19 21:47:18 - INFO - 조정된 모델 가중치: {'gpt': 0.004317452863198391, 'ml': 0.2112581521689992, 'xgboost': 0.08959859347164789, 'rl': 0.2429263339967569, 'lstm': 0.12157234813278187, 'arima': 0.03634868567284525, 'prophet': 0.0508337374282067, 'transformer': 0.12157234813278187, 'bitcoin_forecast': 0.12157234813278187}
2024-09-19 21:47:18 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83904464.30925673, 'current_price': 83998000.0, 'predictions': {'gpt': 83998000.0, 'ml': 83875228.8, 'xgboost': 83976000.0, 'lstm': 83942485.81728289, 'rl': 84837980.0, 'arima': 80899000.0, 'prophet': 84052655.1284141, 'transformer': 83896061.8325706, 'bitcoin_forecast': 82840884.38409784}, 'weights': {'gpt': 0.004317452863198391, 'ml': 0.2112581521689992, 'xgboost': 0.08959859347164789, 'rl': 0.2429263339967569, 'lstm': 0.12157234813278187, 'arima': 0.03634868567284525, 'prophet': 0.0508337374282067, 'transformer': 0.12157234813278187, 'bitcoin_forecast': 0.12157234813278187}}
2024-09-19 21:47:18 - INFO - 모델별 가중치:
2024-09-19 21:47:18 - INFO -   - GPT: 0.0043
2024-09-19 21:47:18 - INFO -   - ML: 0.2113
2024-09-19 21:47:18 - INFO -   - XGBOOST: 0.0896
2024-09-19 21:47:18 - INFO -   - RL: 0.2429
2024-09-19 21:47:18 - INFO -   - LSTM: 0.1216
2024-09-19 21:47:18 - INFO -   - ARIMA: 0.0363
2024-09-19 21:47:18 - INFO -   - PROPHET: 0.0508
2024-09-19 21:47:18 - INFO -   - TRANSFORMER: 0.1216
2024-09-19 21:47:18 - INFO -   - BITCOIN_FORECAST: 0.1216
2024-09-19 21:47:18 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:47:18 - INFO - 6. 거래 실행
2024-09-19 21:47:18 - INFO - Cancelling existing orders.
2024-09-19 21:47:18 - INFO - Cancelled 0 orders.
2024-09-19 21:47:18 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83904464.30925673, 'current_price': 83998000.0, 'predictions': {'gpt': 83998000.0, 'ml': 83875228.8, 'xgboost': 83976000.0, 'lstm': 83942485.81728289, 'rl': 84837980.0, 'arima': 80899000.0, 'prophet': 84052655.1284141, 'transformer': 83896061.8325706, 'bitcoin_forecast': 82840884.38409784}, 'weights': {'gpt': 0.004317452863198391, 'ml': 0.2112581521689992, 'xgboost': 0.08959859347164789, 'rl': 0.2429263339967569, 'lstm': 0.12157234813278187, 'arima': 0.03634868567284525, 'prophet': 0.0508337374282067, 'transformer': 0.12157234813278187, 'bitcoin_forecast': 0.12157234813278187}}, 현재 가격=83998000.0
2024-09-19 21:47:18 - INFO - 현재 잔고: KRW=291422.53368755, BTC=0.00222326, 총 자산가치=478171.92716754996
2024-09-19 21:47:18 - INFO - 매도 시도: 0.00022232599999999999 BTC (약 18674.939348 KRW)
2024-09-19 21:47:18 - INFO - 주문 결과: {'uuid': 'ba74d929-15d3-487c-a086-c5c2dcd01448', 'side': 'ask', 'ord_type': 'limit', 'price': '83998000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:47:18+09:00', 'volume': '0.00022232', 'remaining_volume': '0.00022232', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00022232', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:47:18 - INFO - sell 주문 성공: UUID=ba74d929-15d3-487c-a086-c5c2dcd01448
2024-09-19 21:47:18 - INFO - Trade executed successfully.
2024-09-19 21:47:18 - INFO - 7. summary 리포트 보내기
2024-09-19 21:47:19 - INFO - Message sent to Discord successfully.
2024-09-19 21:47:19 - INFO - Trading cycle completed.
2024-09-19 21:47:19 - INFO - Performing periodic update.
2024-09-19 21:47:19 - INFO - 계산된 시장 변동성: 0.029620510968829342
2024-09-19 21:55:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:55:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f8-b90e-fb5fe198d4d7 "HTTP/1.1 200 OK"
2024-09-19 21:55:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:55:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:55:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818a-81f3-d393de2088b0 "HTTP/1.1 200 OK"
2024-09-19 21:55:51 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-9627-db8f7dcb3408 "HTTP/1.1 200 OK"
2024-09-19 21:55:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-aa23-ef0acda48c6b "HTTP/1.1 200 OK"
2024-09-19 21:56:14 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8125-ab8e-f227cc6a95ec "HTTP/1.1 200 OK"
2024-09-19 21:56:22 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8131-bf99-e43de44b6102 "HTTP/1.1 200 OK"
2024-09-19 21:56:30 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-8640-faea28a0dbc5 "HTTP/1.1 200 OK"
2024-09-19 21:56:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-a832-f5f2b18b987a "HTTP/1.1 200 OK"
2024-09-19 21:56:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 21:56:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/4aa14bc7-e144-42c9-8e19-bc7bf99d7872 "HTTP/1.1 200 OK"
2024-09-19 21:56:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:45:34.939127
2024-09-19 21:56:53 - INFO - Starting trading cycle.
2024-09-19 21:56:53 - INFO - ##################################################
2024-09-19 21:56:53 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-19 21:56:53 - INFO - ##################################################
2024-09-19 21:56:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 21:56:53 - INFO - 데이터베이스 업데이트 시작
2024-09-19 21:56:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:40:00
2024-09-19 21:56:53 - INFO - 새로운 데이터 범위: 2024-09-18 12:40:00 ~ 2024-09-19 21:50:00
2024-09-19 21:56:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 21:56:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 21:56:53 - INFO - Index: Index([199], dtype='int64')
2024-09-19 21:56:53 - INFO - Date column data type: datetime64[ns]
2024-09-19 21:56:53 - INFO - Sample date values: [Timestamp('2024-09-19 21:50:00')]
2024-09-19 21:56:53 - INFO - Successfully added 1 new data points
2024-09-19 21:56:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 21:56:53 - INFO - Final date range: 2024-09-19 21:50:00 to 2024-09-19 21:50:00
2024-09-19 21:56:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 21:56:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 21:50:00
2024-09-19 21:56:53 - INFO - 데이터베이스 업데이트 완료
2024-09-19 21:56:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 21:56:53 - INFO - GPT | 이전예측가격: 83998000 | 당시BTC가격: 83998000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 21:56:53 - INFO - ML 모델 예측 업데이트: 정확도 48.28%, 적중/전체: 14/29
2024-09-19 21:56:53 - INFO - ML | 이전예측가격: 83875229 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2171 | 반영가중치값: -0.0200 | 새 가중치: 0.1971 | 예측 총 횟수: 29 | 예측 성공 수: 14 | 예측 성공률: 48.28%
2024-09-19 21:56:53 - INFO - XGBOOST 모델 예측 업데이트: 정확도 62.39%, 적중/전체: 73/117
2024-09-19 21:56:53 - INFO - XGBOOST | 이전예측가격: 83976000 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0956 | 반영가중치값: -0.0200 | 새 가중치: 0.0756 | 예측 총 횟수: 117 | 예측 성공 수: 73 | 예측 성공률: 62.39%
2024-09-19 21:56:53 - INFO - LSTM 모델 예측 업데이트: 정확도 36.36%, 적중/전체: 4/11
2024-09-19 21:56:53 - INFO - LSTM | 이전예측가격: 83942486 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0918 | 반영가중치값: -0.0200 | 새 가중치: 0.0718 | 예측 총 횟수: 11 | 예측 성공 수: 4 | 예측 성공률: 36.36%
2024-09-19 21:56:53 - INFO - RL 모델 예측 업데이트: 정확도 64.52%, 적중/전체: 20/31
2024-09-19 21:56:53 - INFO - RL | 이전예측가격: 84837980 | 당시BTC가격: 83998000 | 예측: 상승 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1285 | 반영가중치값: 0.0200 | 새 가중치: 0.1485 | 예측 총 횟수: 31 | 예측 성공 수: 20 | 예측 성공률: 64.52%
2024-09-19 21:56:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.91%, 적중/전체: 118/223
2024-09-19 21:56:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1280 | 반영가중치값: -0.0200 | 새 가중치: 0.1080 | 예측 총 횟수: 223 | 예측 성공 수: 118 | 예측 성공률: 52.91%
2024-09-19 21:56:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.96%, 적중/전체: 17/27
2024-09-19 21:56:53 - INFO - PROPHET | 이전예측가격: 84052655 | 당시BTC가격: 83998000 | 예측: 상승 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1174 | 반영가중치값: 0.0200 | 새 가중치: 0.1374 | 예측 총 횟수: 27 | 예측 성공 수: 17 | 예측 성공률: 62.96%
2024-09-19 21:56:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 36.36%, 적중/전체: 4/11
2024-09-19 21:56:53 - INFO - TRANSFORMER | 이전예측가격: 83896062 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1183 | 반영가중치값: -0.0200 | 새 가중치: 0.0983 | 예측 총 횟수: 11 | 예측 성공 수: 4 | 예측 성공률: 36.36%
2024-09-19 21:56:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 27.27%, 적중/전체: 3/11
2024-09-19 21:56:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 82840884 | 당시BTC가격: 83998000 | 예측: 하락 | 지금 BTC가격: 84138000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0988 | 반영가중치값: -0.0200 | 새 가중치: 0.0788 | 예측 총 횟수: 11 | 예측 성공 수: 3 | 예측 성공률: 27.27%
2024-09-19 21:56:54 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 21:56:54 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 21:56:54 - INFO - 새로운 가중치: {'gpt': 0.004694351282513774, 'ml': 0.21427796417138242, 'xgboost': 0.08216485728657705, 'rl': 0.16149296270341892, 'lstm': 0.07804722306091422, 'arima': 0.11744492547947431, 'prophet': 0.14934287717958902, 'transformer': 0.10690606922914463, 'bitcoin_forecast': 0.0856287696069857}
2024-09-19 21:56:54 - INFO - XGBoost 모델 성능: 정확도 62.39%, 적중/전체: 73/117
2024-09-19 21:56:54 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 21:56:54 - INFO - Current BTC price: 84138000.0
2024-09-19 21:56:54 - INFO - Analyzing market conditions.
2024-09-19 21:56:54 - INFO - Market analysis: {'current_price': 84138000.0, 'sma_20': 83599600.0, 'rsi_14': 67.16203134285067, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 21:56:54 - INFO - Starting predictions for all models
2024-09-19 21:56:54 - INFO - Attempting prediction for gpt
2024-09-19 21:56:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 21:56:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:56:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 21:56:54 - INFO - GPT prediction: 84138000.0
2024-09-19 21:56:54 - INFO - Attempting prediction for ml
2024-09-19 21:56:54 - INFO - ML prediction: 84037034.4
2024-09-19 21:56:54 - INFO - Attempting prediction for xgboost
2024-09-19 21:56:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 21:56:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:56:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 21:56:54 - INFO - XGBOOST prediction: 84138000.0
2024-09-19 21:56:54 - INFO - Attempting prediction for lstm
2024-09-19 21:56:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 21:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:56:54 - INFO - X 샘플:
[[-1.48558795 -1.73526596 -1.55845361 -1.74857831 -1.12926506 -1.13099779
  -1.74857831]
 [-1.3665777  -1.26920247 -1.42851261 -1.20248221 -0.84529642 -0.84870154
  -1.20248221]
 [-0.90073758 -1.08868492 -0.84587396 -1.12752784 -0.42213488 -0.42660602
  -1.12752784]
 [-0.60151181 -0.59636434 -0.62790842 -0.46721556  0.15946999  0.1543875
  -0.46721556]
 [-0.13567169  0.58520507 -0.13329431  0.7820239   2.46211023  2.45874092
   0.7820239 ]
 [ 1.37405834  1.00860077  1.14096577  1.06042583  0.99159394  0.99739627
   1.06042583]
 [ 1.28565073  0.81823681  0.6505433   0.35728248  0.16778658  0.17036901
   0.35728248]
 [ 0.65999684  0.98562581  1.02779135  1.08897988 -0.21386278 -0.20903968
   1.08897988]
 [ 0.7756068   0.61474431  1.04036629  0.33943621 -0.62091464 -0.61841313
   0.33943621]
 [ 0.394774    0.67710491  0.7343762   0.91765561 -0.54948696 -0.54713553
   0.91765561]]
2024-09-19 21:56:54 - INFO - y 샘플:
[0.91765561]
2024-09-19 21:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 21:56:54 - INFO - 모델 출력 (스케일링된 예측): [[0.4451234]]
2024-09-19 21:56:54 - INFO - 스케일러 역변환 후 예측 가격: 84005610.43158546
2024-09-19 21:56:54 - INFO - LSTMPredictor 최종 예측 가격: 84005610.43158546
2024-09-19 21:56:54 - INFO - LSTM prediction: 84005610.43158546
2024-09-19 21:56:54 - INFO - Attempting prediction for rl
2024-09-19 21:56:54 - INFO - Preparing state for RL agent.
2024-09-19 21:56:54 - INFO - Prepared state: [[8.41380000e+07 2.66069893e+01 1.92912261e-03 8.35996000e+07
  6.71620313e+01]]
2024-09-19 21:56:54 - INFO - RL prediction: 84979380.0
2024-09-19 21:56:54 - INFO - Attempting prediction for arima
2024-09-19 21:56:54 - INFO - ARIMA 예측 시작
2024-09-19 21:56:54 - INFO - 입력 데이터: {'open': 83911000.0, 'high': 84138000.0, 'low': 83903000.0, 'close': 84138000.0, 'volume': 26.60698927, 'value': 2235617351.02561, 'decision': 'sell', 'sma': 83599600.0, 'ema': 83655371.39239033, 'rsi': 67.16203134285067, 'macd': 289601.75583451986, 'signal_line': 238131.35233770567, 'BB_Upper': 84298814.81677894, 'BB_Lower': 82900385.18322106}
2024-09-19 21:56:54 - INFO - Exogenous 변수 예측 시작
2024-09-19 21:56:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83599600.0         0         0
2024-09-19 21:56:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83599600.0         0         0
2024-09-19 21:56:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 21:56:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 21:56:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 21:56:54 - INFO - ARIMA prediction: 80899000.0
2024-09-19 21:56:54 - INFO - Attempting prediction for prophet
2024-09-19 21:56:54 - INFO - PROPHET prediction: 84231965.21450019
2024-09-19 21:56:54 - INFO - Attempting prediction for transformer
2024-09-19 21:56:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 21:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 21:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 21:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 21:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-19 21:56:54 - INFO - X 샘플:
[[-1.48558795 -1.73526596 -1.55845361 -1.74857831 -1.12926506 -1.13099779
  -1.74857831 -1.74857831  0.          0.          0.         -1.74857831
  -1.74857831]
 [-1.3665777  -1.26920247 -1.42851261 -1.20248221 -0.84529642 -0.84870154
  -1.20248221 -1.20248221  0.          0.          0.         -1.20248221
  -1.20248221]
 [-0.90073758 -1.08868492 -0.84587396 -1.12752784 -0.42213488 -0.42660602
  -1.12752784 -1.12752784  0.          0.          0.         -1.12752784
  -1.12752784]
 [-0.60151181 -0.59636434 -0.62790842 -0.46721556  0.15946999  0.1543875
  -0.46721556 -0.46721556  0.          0.          0.         -0.46721556
  -0.46721556]
 [-0.13567169  0.58520507 -0.13329431  0.7820239   2.46211023  2.45874092
   0.7820239   0.7820239   0.          0.          0.          0.7820239
   0.7820239 ]
 [ 1.37405834  1.00860077  1.14096577  1.06042583  0.99159394  0.99739627
   1.06042583  1.06042583  0.          0.          0.          1.06042583
   1.06042583]
 [ 1.28565073  0.81823681  0.6505433   0.35728248  0.16778658  0.17036901
   0.35728248  0.35728248  0.          0.          0.          0.35728248
   0.35728248]
 [ 0.65999684  0.98562581  1.02779135  1.08897988 -0.21386278 -0.20903968
   1.08897988  1.08897988  0.          0.          0.          1.08897988
   1.08897988]
 [ 0.7756068   0.61474431  1.04036629  0.33943621 -0.62091464 -0.61841313
   0.33943621  0.33943621  0.          0.          0.          0.33943621
   0.33943621]
 [ 0.394774    0.67710491  0.7343762   0.91765561 -0.54948696 -0.54713553
   0.91765561  0.91765561  0.          0.          0.          0.91765561
   0.91765561]]
2024-09-19 21:56:54 - INFO - y 샘플:
[0.91765561]
2024-09-19 21:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 21:56:54 - INFO - 모델 출력 (스케일링된 예측): [0.29595244]
2024-09-19 21:56:54 - INFO - 스케일러 역변환 후 예측 가격: 83963817.13282496
2024-09-19 21:56:54 - INFO - TransformerPredictor 최종 예측 가격: 83963817.13282496
2024-09-19 21:56:54 - INFO - TRANSFORMER prediction: 83963817.13282496
2024-09-19 21:56:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 21:56:54 - INFO - BITCOIN_FORECAST prediction: 82873065.78167668
2024-09-19 21:56:54 - INFO - BitcoinForecast prediction: 82873065.78167668
2024-09-19 21:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:56:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 21:57:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 21:57:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004694351282513774, 'ml': 0.21427796417138242, 'xgboost': 0.08216485728657705, 'rl': 0.16149296270341892, 'lstm': 0.07804722306091422, 'arima': 0.11744492547947431, 'prophet': 0.14934287717958902, 'transformer': 0.10690606922914463, 'bitcoin_forecast': 0.0856287696069857}
2024-09-19 21:57:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004694351282513774, 'ml': 0.21427796417138242, 'xgboost': 0.08216485728657705, 'rl': 0.16149296270341892, 'lstm': 0.07804722306091422, 'arima': 0.11744492547947431, 'prophet': 0.14934287717958902, 'transformer': 0.10690606922914463, 'bitcoin_forecast': 0.0856287696069857}
2024-09-19 21:57:07 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83748602.56301777, 'current_price': 84138000.0, 'predictions': {'gpt': 84138000.0, 'ml': 84037034.4, 'xgboost': 84138000.0, 'lstm': 84005610.43158546, 'rl': 84979380.0, 'arima': 80899000.0, 'prophet': 84231965.21450019, 'transformer': 83963817.13282496, 'bitcoin_forecast': 82873065.78167668}, 'weights': {'gpt': 0.004694351282513774, 'ml': 0.21427796417138242, 'xgboost': 0.08216485728657705, 'rl': 0.16149296270341892, 'lstm': 0.07804722306091422, 'arima': 0.11744492547947431, 'prophet': 0.14934287717958902, 'transformer': 0.10690606922914463, 'bitcoin_forecast': 0.0856287696069857}}
2024-09-19 21:57:07 - INFO - 모델별 가중치:
2024-09-19 21:57:07 - INFO -   - GPT: 0.0047
2024-09-19 21:57:07 - INFO -   - ML: 0.2143
2024-09-19 21:57:07 - INFO -   - XGBOOST: 0.0822
2024-09-19 21:57:07 - INFO -   - RL: 0.1615
2024-09-19 21:57:07 - INFO -   - LSTM: 0.0780
2024-09-19 21:57:07 - INFO -   - ARIMA: 0.1174
2024-09-19 21:57:07 - INFO -   - PROPHET: 0.1493
2024-09-19 21:57:07 - INFO -   - TRANSFORMER: 0.1069
2024-09-19 21:57:07 - INFO -   - BITCOIN_FORECAST: 0.0856
2024-09-19 21:57:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 21:57:07 - INFO - 6. 거래 실행
2024-09-19 21:57:07 - INFO - Cancelling existing orders.
2024-09-19 21:57:07 - INFO - Cancelled 0 orders.
2024-09-19 21:57:07 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83748602.56301777, 'current_price': 84138000.0, 'predictions': {'gpt': 84138000.0, 'ml': 84037034.4, 'xgboost': 84138000.0, 'lstm': 84005610.43158546, 'rl': 84979380.0, 'arima': 80899000.0, 'prophet': 84231965.21450019, 'transformer': 83963817.13282496, 'bitcoin_forecast': 82873065.78167668}, 'weights': {'gpt': 0.004694351282513774, 'ml': 0.21427796417138242, 'xgboost': 0.08216485728657705, 'rl': 0.16149296270341892, 'lstm': 0.07804722306091422, 'arima': 0.11744492547947431, 'prophet': 0.14934287717958902, 'transformer': 0.10690606922914463, 'bitcoin_forecast': 0.0856287696069857}}, 현재 가격=84138000.0
2024-09-19 21:57:07 - INFO - 현재 잔고: KRW=310087.63182987, BTC=0.00200094, 총 자산가치=478442.72154987
2024-09-19 21:57:07 - INFO - 매도 시도: 0.00020009400000000003 BTC (약 16835.508972000003 KRW)
2024-09-19 21:57:07 - INFO - 주문 결과: {'uuid': '2d7cf0a7-6f5f-4589-9cbf-09ed7d8f1f20', 'side': 'ask', 'ord_type': 'limit', 'price': '84138000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T21:57:07+09:00', 'volume': '0.00020009', 'remaining_volume': '0.00020009', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00020009', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 21:57:07 - INFO - sell 주문 성공: UUID=2d7cf0a7-6f5f-4589-9cbf-09ed7d8f1f20
2024-09-19 21:57:07 - INFO - Trade executed successfully.
2024-09-19 21:57:07 - INFO - 7. summary 리포트 보내기
2024-09-19 21:57:07 - INFO - Message sent to Discord successfully.
2024-09-19 21:57:07 - INFO - Trading cycle completed.
2024-09-19 21:57:07 - INFO - Performing periodic update.
2024-09-19 21:57:07 - INFO - 계산된 시장 변동성: 0.029605583264974006
2024-09-19 22:05:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8157-a9d5-dd87d1446eba "HTTP/1.1 200 OK"
2024-09-19 22:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:05:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:05:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/3975d32b-c3c5-4643-9832-00cd992961bd "HTTP/1.1 200 OK"
2024-09-19 22:05:49 - INFO - Updated actual price for ml prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:05:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:05:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-9711-cc1525c312dc "HTTP/1.1 200 OK"
2024-09-19 22:05:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-be3b-cada96d2811b "HTTP/1.1 200 OK"
2024-09-19 22:06:05 - INFO - Updated actual price for lstm prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b9-b69f-ca07650e05e9 "HTTP/1.1 200 OK"
2024-09-19 22:06:12 - INFO - Updated actual price for rl prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-a772-d8d54696b3f6 "HTTP/1.1 200 OK"
2024-09-19 22:06:20 - INFO - Updated actual price for arima prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fc-86ea-fa831f76453c "HTTP/1.1 200 OK"
2024-09-19 22:06:26 - INFO - Updated actual price for prophet prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c1-ada2-cccb5b5e55b7 "HTTP/1.1 200 OK"
2024-09-19 22:06:36 - INFO - Updated actual price for transformer prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:06:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fa-817f-c75533eae182 "HTTP/1.1 200 OK"
2024-09-19 22:06:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 21:55:34.939449
2024-09-19 22:06:47 - INFO - Starting trading cycle.
2024-09-19 22:06:47 - INFO - ##################################################
2024-09-19 22:06:47 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-19 22:06:47 - INFO - ##################################################
2024-09-19 22:06:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:06:47 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:06:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 21:50:00
2024-09-19 22:06:47 - INFO - 새로운 데이터 범위: 2024-09-18 12:50:00 ~ 2024-09-19 22:00:00
2024-09-19 22:06:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:06:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:06:47 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:06:47 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:06:47 - INFO - Sample date values: [Timestamp('2024-09-19 22:00:00')]
2024-09-19 22:06:47 - INFO - Successfully added 1 new data points
2024-09-19 22:06:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:06:47 - INFO - Final date range: 2024-09-19 22:00:00 to 2024-09-19 22:00:00
2024-09-19 22:06:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:06:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:00:00
2024-09-19 22:06:47 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:06:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:06:47 - INFO - GPT | 이전예측가격: 84138000 | 당시BTC가격: 84138000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:06:47 - INFO - ML 모델 예측 업데이트: 정확도 46.67%, 적중/전체: 14/30
2024-09-19 22:06:47 - INFO - ML | 이전예측가격: 84037034 | 당시BTC가격: 84138000 | 예측: 하락 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2113 | 반영가중치값: -0.0200 | 새 가중치: 0.1913 | 예측 총 횟수: 30 | 예측 성공 수: 14 | 예측 성공률: 46.67%
2024-09-19 22:06:47 - INFO - XGBOOST | 이전예측가격: 84138000 | 당시BTC가격: 84138000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:06:47 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 4/12
2024-09-19 22:06:47 - INFO - LSTM | 이전예측가격: 84005610 | 당시BTC가격: 84138000 | 예측: 하락 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1216 | 반영가중치값: -0.0200 | 새 가중치: 0.1016 | 예측 총 횟수: 12 | 예측 성공 수: 4 | 예측 성공률: 33.33%
2024-09-19 22:06:47 - INFO - RL 모델 예측 업데이트: 정확도 65.62%, 적중/전체: 21/32
2024-09-19 22:06:48 - INFO - RL | 이전예측가격: 84979380 | 당시BTC가격: 84138000 | 예측: 상승 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2429 | 반영가중치값: 0.0200 | 새 가중치: 0.2629 | 예측 총 횟수: 32 | 예측 성공 수: 21 | 예측 성공률: 65.62%
2024-09-19 22:06:48 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.68%, 적중/전체: 118/224
2024-09-19 22:06:48 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84138000 | 예측: 하락 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0363 | 반영가중치값: -0.0200 | 새 가중치: 0.0163 | 예측 총 횟수: 224 | 예측 성공 수: 118 | 예측 성공률: 52.68%
2024-09-19 22:06:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 18/28
2024-09-19 22:06:48 - INFO - PROPHET | 이전예측가격: 84231965 | 당시BTC가격: 84138000 | 예측: 상승 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0508 | 반영가중치값: 0.0200 | 새 가중치: 0.0708 | 예측 총 횟수: 28 | 예측 성공 수: 18 | 예측 성공률: 64.29%
2024-09-19 22:06:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 4/12
2024-09-19 22:06:48 - INFO - TRANSFORMER | 이전예측가격: 83963817 | 당시BTC가격: 84138000 | 예측: 하락 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1216 | 반영가중치값: -0.0200 | 새 가중치: 0.1016 | 예측 총 횟수: 12 | 예측 성공 수: 4 | 예측 성공률: 33.33%
2024-09-19 22:06:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 3/12
2024-09-19 22:06:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 82873066 | 당시BTC가격: 84138000 | 예측: 하락 | 지금 BTC가격: 84139000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1216 | 반영가중치값: -0.0200 | 새 가중치: 0.1016 | 예측 총 횟수: 12 | 예측 성공 수: 3 | 예측 성공률: 25.00%
2024-09-19 22:06:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:06:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:06:48 - INFO - 새로운 가중치: {'gpt': 0.00503176557001777, 'ml': 0.20500514920005158, 'xgboost': 0.08807059273558082, 'rl': 0.28182460051166663, 'lstm': 0.1088730291881157, 'arima': 0.017523774582036546, 'prophet': 0.07592502983629959, 'transformer': 0.1088730291881157, 'bitcoin_forecast': 0.1088730291881157}
2024-09-19 22:06:48 - INFO - XGBoost 모델 성능: 정확도 62.39%, 적중/전체: 73/117
2024-09-19 22:06:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:06:48 - INFO - Current BTC price: 84166000.0
2024-09-19 22:06:48 - INFO - Analyzing market conditions.
2024-09-19 22:06:48 - INFO - Market analysis: {'current_price': 84139000.0, 'sma_20': 83643000.0, 'rsi_14': 67.18072368867924, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 22:06:48 - INFO - Starting predictions for all models
2024-09-19 22:06:48 - INFO - Attempting prediction for gpt
2024-09-19 22:06:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:06:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:06:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:06:48 - INFO - GPT prediction: 84166000.0
2024-09-19 22:06:48 - INFO - Attempting prediction for ml
2024-09-19 22:06:48 - INFO - ML prediction: 84038033.2
2024-09-19 22:06:48 - INFO - Attempting prediction for xgboost
2024-09-19 22:06:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:06:48 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:06:48 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:06:48 - INFO - XGBOOST prediction: 84139000.0
2024-09-19 22:06:48 - INFO - Attempting prediction for lstm
2024-09-19 22:06:48 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:06:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:06:48 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:06:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:06:48 - INFO - X 샘플:
[[-1.76210633 -1.82036804 -1.84435292 -1.74659686 -0.93794021 -0.94256371
  -1.74659686]
 [-1.26343133 -1.60528696 -1.22361429 -1.65750642 -0.49439521 -0.49991166
  -1.65750642]
 [-0.94311454 -1.0187022  -0.99139552 -0.87266207  0.11522526  0.10937689
  -0.87266207]
 [-0.44443954  0.38910122 -0.46443754  0.61217859  2.52878246  2.5259549
   0.61217859]
 [ 1.17170425  0.89356412  0.89314912  0.94308594  0.98743218  0.99344113
   0.94308594]
 [ 1.0770652   0.66675134  0.37065688  0.10733277  0.12394246  0.12613672
   0.10733277]
 [ 0.40731192  0.86619016  0.77257399  0.97702516 -0.27609075 -0.2717496
   0.97702516]
 [ 0.53107068  0.42429631  0.78597122  0.08612076 -0.70275008 -0.70106
   0.08612076]
 [ 0.12339476  0.49859705  0.45997179  0.77338986 -0.62788176 -0.62631109
   0.77338986]
 [ 1.10254495  0.70585699  1.24147727  0.77763227 -0.71632437 -0.71331358
   0.77763227]]
2024-09-19 22:06:48 - INFO - y 샘플:
[0.77763227]
2024-09-19 22:06:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:06:48 - INFO - 모델 출력 (스케일링된 예측): [[0.44271106]]
2024-09-19 22:06:48 - INFO - 스케일러 역변환 후 예측 가격: 84060053.8700147
2024-09-19 22:06:48 - INFO - LSTMPredictor 최종 예측 가격: 84060053.8700147
2024-09-19 22:06:48 - INFO - LSTM prediction: 84060053.8700147
2024-09-19 22:06:48 - INFO - Attempting prediction for rl
2024-09-19 22:06:48 - INFO - Preparing state for RL agent.
2024-09-19 22:06:48 - INFO - Prepared state: [[8.41390000e+07 2.46260104e+01 1.18852362e-05 8.36430000e+07
  6.71807237e+01]]
2024-09-19 22:06:48 - INFO - RL prediction: 85007660.0
2024-09-19 22:06:48 - INFO - Attempting prediction for arima
2024-09-19 22:06:48 - INFO - ARIMA 예측 시작
2024-09-19 22:06:48 - INFO - 입력 데이터: {'open': 84180000.0, 'high': 84191000.0, 'low': 84078000.0, 'close': 84139000.0, 'volume': 24.62601041, 'value': 2071948944.23416, 'decision': 'sell', 'sma': 83643000.0, 'ema': 83701431.25978172, 'rsi': 67.18072368867924, 'macd': 291970.7434324026, 'signal_line': 248899.23055664508, 'BB_Upper': 84362695.76906024, 'BB_Lower': 82923304.23093976}
2024-09-19 22:06:48 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:06:48 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83643000.0         0         0
2024-09-19 22:06:48 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83643000.0         0         0
2024-09-19 22:06:48 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:06:48 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:06:48 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:06:48 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:06:48 - INFO - Attempting prediction for prophet
2024-09-19 22:06:48 - INFO - PROPHET prediction: 84231452.80718422
2024-09-19 22:06:48 - INFO - Attempting prediction for transformer
2024-09-19 22:06:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:06:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:06:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:06:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:06:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:06:48 - INFO - X 샘플:
[[-1.76210633 -1.82036804 -1.84435292 -1.74659686 -0.93794021 -0.94256371
  -1.74659686 -1.74659686  0.          0.          0.         -1.74659686
  -1.74659686]
 [-1.26343133 -1.60528696 -1.22361429 -1.65750642 -0.49439521 -0.49991166
  -1.65750642 -1.65750642  0.          0.          0.         -1.65750642
  -1.65750642]
 [-0.94311454 -1.0187022  -0.99139552 -0.87266207  0.11522526  0.10937689
  -0.87266207 -0.87266207  0.          0.          0.         -0.87266207
  -0.87266207]
 [-0.44443954  0.38910122 -0.46443754  0.61217859  2.52878246  2.5259549
   0.61217859  0.61217859  0.          0.          0.          0.61217859
   0.61217859]
 [ 1.17170425  0.89356412  0.89314912  0.94308594  0.98743218  0.99344113
   0.94308594  0.94308594  0.          0.          0.          0.94308594
   0.94308594]
 [ 1.0770652   0.66675134  0.37065688  0.10733277  0.12394246  0.12613672
   0.10733277  0.10733277  0.          0.          0.          0.10733277
   0.10733277]
 [ 0.40731192  0.86619016  0.77257399  0.97702516 -0.27609075 -0.2717496
   0.97702516  0.97702516  0.          0.          0.          0.97702516
   0.97702516]
 [ 0.53107068  0.42429631  0.78597122  0.08612076 -0.70275008 -0.70106
   0.08612076  0.08612076  0.          0.          0.          0.08612076
   0.08612076]
 [ 0.12339476  0.49859705  0.45997179  0.77338986 -0.62788176 -0.62631109
   0.77338986  0.77338986  0.          0.          0.          0.77338986
   0.77338986]
 [ 1.10254495  0.70585699  1.24147727  0.77763227 -0.71632437 -0.71331358
   0.77763227  0.77763227  0.          0.          0.          0.77763227
   0.77763227]]
2024-09-19 22:06:48 - INFO - y 샘플:
[0.77763227]
2024-09-19 22:06:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:06:48 - INFO - 모델 출력 (스케일링된 예측): [0.29295507]
2024-09-19 22:06:48 - INFO - 스케일러 역변환 후 예측 가격: 84024754.05909115
2024-09-19 22:06:48 - INFO - TransformerPredictor 최종 예측 가격: 84024754.05909115
2024-09-19 22:06:48 - INFO - TRANSFORMER prediction: 84024754.05909115
2024-09-19 22:06:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:06:48 - INFO - BITCOIN_FORECAST prediction: 82864823.57726862
2024-09-19 22:06:48 - INFO - BitcoinForecast prediction: 82864823.57726862
2024-09-19 22:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:06:56 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:06:56 - INFO - 조정된 모델 가중치: {'gpt': 0.00503176557001777, 'ml': 0.20500514920005158, 'xgboost': 0.08807059273558082, 'rl': 0.28182460051166663, 'lstm': 0.1088730291881157, 'arima': 0.017523774582036546, 'prophet': 0.07592502983629959, 'transformer': 0.1088730291881157, 'bitcoin_forecast': 0.1088730291881157}
2024-09-19 22:06:56 - INFO - 조정된 모델 가중치: {'gpt': 0.00503176557001777, 'ml': 0.20500514920005158, 'xgboost': 0.08807059273558082, 'rl': 0.28182460051166663, 'lstm': 0.1088730291881157, 'arima': 0.017523774582036546, 'prophet': 0.07592502983629959, 'transformer': 0.1088730291881157, 'bitcoin_forecast': 0.1088730291881157}
2024-09-19 22:06:56 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84153732.5009145, 'current_price': 84166000.0, 'predictions': {'gpt': 84166000.0, 'ml': 84038033.2, 'xgboost': 84139000.0, 'lstm': 84060053.8700147, 'rl': 85007660.0, 'arima': 80899000.0, 'prophet': 84231452.80718422, 'transformer': 84024754.05909115, 'bitcoin_forecast': 82864823.57726862}, 'weights': {'gpt': 0.00503176557001777, 'ml': 0.20500514920005158, 'xgboost': 0.08807059273558082, 'rl': 0.28182460051166663, 'lstm': 0.1088730291881157, 'arima': 0.017523774582036546, 'prophet': 0.07592502983629959, 'transformer': 0.1088730291881157, 'bitcoin_forecast': 0.1088730291881157}}
2024-09-19 22:06:56 - INFO - 모델별 가중치:
2024-09-19 22:06:56 - INFO -   - GPT: 0.0050
2024-09-19 22:06:56 - INFO -   - ML: 0.2050
2024-09-19 22:06:56 - INFO -   - XGBOOST: 0.0881
2024-09-19 22:06:56 - INFO -   - RL: 0.2818
2024-09-19 22:06:56 - INFO -   - LSTM: 0.1089
2024-09-19 22:06:56 - INFO -   - ARIMA: 0.0175
2024-09-19 22:06:56 - INFO -   - PROPHET: 0.0759
2024-09-19 22:06:56 - INFO -   - TRANSFORMER: 0.1089
2024-09-19 22:06:56 - INFO -   - BITCOIN_FORECAST: 0.1089
2024-09-19 22:06:56 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:06:56 - INFO - 6. 거래 실행
2024-09-19 22:06:56 - INFO - Cancelling existing orders.
2024-09-19 22:06:56 - INFO - Cancelled 0 orders.
2024-09-19 22:06:56 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84153732.5009145, 'current_price': 84166000.0, 'predictions': {'gpt': 84166000.0, 'ml': 84038033.2, 'xgboost': 84139000.0, 'lstm': 84060053.8700147, 'rl': 85007660.0, 'arima': 80899000.0, 'prophet': 84231452.80718422, 'transformer': 84024754.05909115, 'bitcoin_forecast': 82864823.57726862}, 'weights': {'gpt': 0.00503176557001777, 'ml': 0.20500514920005158, 'xgboost': 0.08807059273558082, 'rl': 0.28182460051166663, 'lstm': 0.1088730291881157, 'arima': 0.017523774582036546, 'prophet': 0.07592502983629959, 'transformer': 0.1088730291881157, 'bitcoin_forecast': 0.1088730291881157}}, 현재 가격=84166000.0
2024-09-19 22:06:57 - INFO - 현재 잔고: KRW=326914.98663352, BTC=0.00180085, 총 자산가치=478485.32773352
2024-09-19 22:06:57 - INFO - 매도 시도: 0.00018008500000000002 BTC (약 15157.034110000002 KRW)
2024-09-19 22:06:57 - INFO - 주문 결과: {'uuid': 'd489a5a2-e80c-4a31-bb5d-3199b20f2707', 'side': 'ask', 'ord_type': 'limit', 'price': '84166000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:06:57+09:00', 'volume': '0.00018008', 'remaining_volume': '0.00018008', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00018008', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:06:57 - INFO - sell 주문 성공: UUID=d489a5a2-e80c-4a31-bb5d-3199b20f2707
2024-09-19 22:06:57 - INFO - Trade executed successfully.
2024-09-19 22:06:57 - INFO - 7. summary 리포트 보내기
2024-09-19 22:06:57 - INFO - Message sent to Discord successfully.
2024-09-19 22:06:57 - INFO - Trading cycle completed.
2024-09-19 22:06:57 - INFO - Performing periodic update.
2024-09-19 22:06:57 - INFO - 계산된 시장 변동성: 0.028936985045091367
2024-09-19 22:15:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:15:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8180-8e16-c5aab893a090 "HTTP/1.1 200 OK"
2024-09-19 22:15:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:15:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:15:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8146-81f9-ca0895720144 "HTTP/1.1 200 OK"
2024-09-19 22:15:48 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:15:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:15:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b6-88f4-d6d2e559220b "HTTP/1.1 200 OK"
2024-09-19 22:15:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:16:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:16:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8121-8650-c84caab8c26d "HTTP/1.1 200 OK"
2024-09-19 22:16:09 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:16:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:16:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ea-9158-cb28176fc3a0 "HTTP/1.1 200 OK"
2024-09-19 22:16:17 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:16:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dc-87df-f4a0c6d58f5c "HTTP/1.1 200 OK"
2024-09-19 22:16:25 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:16:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813b-8ae4-d01585ef5f2b "HTTP/1.1 200 OK"
2024-09-19 22:16:32 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:16:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-8230-e25d1a8f6ba2 "HTTP/1.1 200 OK"
2024-09-19 22:16:40 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:17:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-a4d2-d1dd944a199a "HTTP/1.1 200 OK"
2024-09-19 22:17:01 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:05:34.939645
2024-09-19 22:17:01 - INFO - Starting trading cycle.
2024-09-19 22:17:01 - INFO - ##################################################
2024-09-19 22:17:01 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-19 22:17:01 - INFO - ##################################################
2024-09-19 22:17:01 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:17:01 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:17:01 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:00:00
2024-09-19 22:17:01 - INFO - 새로운 데이터 범위: 2024-09-18 13:00:00 ~ 2024-09-19 22:10:00
2024-09-19 22:17:01 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:17:01 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:17:01 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:17:01 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:17:01 - INFO - Sample date values: [Timestamp('2024-09-19 22:10:00')]
2024-09-19 22:17:02 - INFO - Successfully added 1 new data points
2024-09-19 22:17:02 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:17:02 - INFO - Final date range: 2024-09-19 22:10:00 to 2024-09-19 22:10:00
2024-09-19 22:17:02 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:17:02 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:10:00
2024-09-19 22:17:02 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:17:02 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:17:02 - INFO - GPT | 이전예측가격: 84166000 | 당시BTC가격: 84166000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:17:02 - INFO - ML 모델 예측 업데이트: 정확도 45.16%, 적중/전체: 14/31
2024-09-19 22:17:02 - INFO - ML | 이전예측가격: 84038033 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2143 | 반영가중치값: -0.0200 | 새 가중치: 0.1943 | 예측 총 횟수: 31 | 예측 성공 수: 14 | 예측 성공률: 45.16%
2024-09-19 22:17:02 - INFO - XGBOOST 모델 예측 업데이트: 정확도 61.86%, 적중/전체: 73/118
2024-09-19 22:17:02 - INFO - XGBOOST | 이전예측가격: 84139000 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0822 | 반영가중치값: -0.0200 | 새 가중치: 0.0622 | 예측 총 횟수: 118 | 예측 성공 수: 73 | 예측 성공률: 61.86%
2024-09-19 22:17:02 - INFO - LSTM 모델 예측 업데이트: 정확도 30.77%, 적중/전체: 4/13
2024-09-19 22:17:02 - INFO - LSTM | 이전예측가격: 84060054 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0780 | 반영가중치값: -0.0200 | 새 가중치: 0.0580 | 예측 총 횟수: 13 | 예측 성공 수: 4 | 예측 성공률: 30.77%
2024-09-19 22:17:02 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 22/33
2024-09-19 22:17:02 - INFO - RL | 이전예측가격: 85007660 | 당시BTC가격: 84166000 | 예측: 상승 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1615 | 반영가중치값: 0.0200 | 새 가중치: 0.1815 | 예측 총 횟수: 33 | 예측 성공 수: 22 | 예측 성공률: 66.67%
2024-09-19 22:17:02 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.44%, 적중/전체: 118/225
2024-09-19 22:17:02 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1174 | 반영가중치값: -0.0200 | 새 가중치: 0.0974 | 예측 총 횟수: 225 | 예측 성공 수: 118 | 예측 성공률: 52.44%
2024-09-19 22:17:02 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.52%, 적중/전체: 19/29
2024-09-19 22:17:02 - INFO - PROPHET | 이전예측가격: 84231453 | 당시BTC가격: 84166000 | 예측: 상승 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1493 | 반영가중치값: 0.0200 | 새 가중치: 0.1693 | 예측 총 횟수: 29 | 예측 성공 수: 19 | 예측 성공률: 65.52%
2024-09-19 22:17:02 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 30.77%, 적중/전체: 4/13
2024-09-19 22:17:02 - INFO - TRANSFORMER | 이전예측가격: 84024754 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1069 | 반영가중치값: -0.0200 | 새 가중치: 0.0869 | 예측 총 횟수: 13 | 예측 성공 수: 4 | 예측 성공률: 30.77%
2024-09-19 22:17:02 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 23.08%, 적중/전체: 3/13
2024-09-19 22:17:02 - INFO - BITCOIN_FORECAST | 이전예측가격: 82864824 | 당시BTC가격: 84166000 | 예측: 하락 | 지금 BTC가격: 84331000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0856 | 반영가중치값: -0.0200 | 새 가중치: 0.0656 | 예측 총 횟수: 13 | 예측 성공 수: 3 | 예측 성공률: 23.08%
2024-09-19 22:17:02 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:17:02 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:17:02 - INFO - 새로운 가중치: {'gpt': 0.005467305242516086, 'ml': 0.21109428037518854, 'xgboost': 0.0675457243414396, 'rl': 0.1972026344750148, 'lstm': 0.06307167584385616, 'arima': 0.10587956543624065, 'prophet': 0.18400086158693102, 'transformer': 0.09442848663978802, 'bitcoin_forecast': 0.0713094660590251}
2024-09-19 22:17:02 - INFO - XGBoost 모델 성능: 정확도 61.86%, 적중/전체: 73/118
2024-09-19 22:17:02 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:17:02 - INFO - Current BTC price: 84331000.0
2024-09-19 22:17:02 - INFO - Analyzing market conditions.
2024-09-19 22:17:02 - INFO - Market analysis: {'current_price': 84331000.0, 'sma_20': 83697100.0, 'rsi_14': 70.63675368783964, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 22:17:02 - INFO - Starting predictions for all models
2024-09-19 22:17:02 - INFO - Attempting prediction for gpt
2024-09-19 22:17:03 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:17:03 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:17:03 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:17:03 - INFO - GPT prediction: 84331000.0
2024-09-19 22:17:03 - INFO - Attempting prediction for ml
2024-09-19 22:17:03 - INFO - ML prediction: 84263535.2
2024-09-19 22:17:03 - INFO - Attempting prediction for xgboost
2024-09-19 22:17:03 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:17:03 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:17:03 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:17:03 - INFO - XGBOOST prediction: 84331000.0
2024-09-19 22:17:03 - INFO - Attempting prediction for lstm
2024-09-19 22:17:03 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:17:03 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:17:03 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:17:03 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:17:03 - INFO - X 샘플:
[[-1.81619404 -2.13075996 -1.74210671 -2.17670986 -0.679245   -0.68652729
  -2.17670986]
 [-1.44057694 -1.49395184 -1.48547909 -1.31882464 -0.04758033 -0.05524186
  -1.31882464]
 [-0.85580941  0.03438764 -0.9031318   0.30420146  2.45325237  2.44858078
   0.30420146]
 [ 1.03934959  0.58204262  0.59715272  0.66590442  0.85616605  0.86073935
   0.66590442]
 [ 0.92837181  0.33581015  0.01974059 -0.24762741 -0.03854792 -0.03787696
  -0.24762741]
 [ 0.1429906   0.55232491  0.46390377  0.70300216 -0.45304653 -0.450128
   0.70300216]
 [ 0.28811539  0.07259613  0.47870921 -0.2708135  -0.89513409 -0.89493759
  -0.2708135 ]
 [-0.18994274  0.15325849  0.11844352  0.48041573 -0.8175585  -0.81749006
   0.48041573]
 [ 0.95825044  0.37826402  0.98209415  0.48505294 -0.90919924 -0.90763356
   0.48505294]
 [ 0.94544531  1.51602786  1.47067365  1.37539869  0.53089318  0.5405152
   1.37539869]]
2024-09-19 22:17:03 - INFO - y 샘플:
[1.37539869]
2024-09-19 22:17:03 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:17:03 - INFO - 모델 출력 (스케일링된 예측): [[0.43593875]]
2024-09-19 22:17:03 - INFO - 스케일러 역변환 후 예측 가격: 84128408.69206157
2024-09-19 22:17:03 - INFO - LSTMPredictor 최종 예측 가격: 84128408.69206157
2024-09-19 22:17:03 - INFO - LSTM prediction: 84128408.69206157
2024-09-19 22:17:03 - INFO - Attempting prediction for rl
2024-09-19 22:17:03 - INFO - Preparing state for RL agent.
2024-09-19 22:17:03 - INFO - Prepared state: [[8.43310000e+07 5.57561890e+01 2.28193822e-03 8.36971000e+07
  7.06367537e+01]]
2024-09-19 22:17:03 - INFO - RL prediction: 85174310.0
2024-09-19 22:17:03 - INFO - Attempting prediction for arima
2024-09-19 22:17:03 - INFO - ARIMA 예측 시작
2024-09-19 22:17:03 - INFO - 입력 데이터: {'open': 84177000.0, 'high': 84459000.0, 'low': 84177000.0, 'close': 84331000.0, 'volume': 55.75618902, 'value': 4701269972.68109, 'decision': 'sell', 'sma': 83697100.0, 'ema': 83761390.18742155, 'rsi': 70.63675368783964, 'macd': 305815.725243479, 'signal_line': 260282.5294940119, 'BB_Upper': 84452001.55649808, 'BB_Lower': 82942198.44350192}
2024-09-19 22:17:03 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:17:03 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83697100.0         0         0
2024-09-19 22:17:03 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83697100.0         0         0
2024-09-19 22:17:03 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:17:03 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:17:03 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:17:03 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:17:03 - INFO - Attempting prediction for prophet
2024-09-19 22:17:03 - INFO - PROPHET prediction: 84459579.47753575
2024-09-19 22:17:03 - INFO - Attempting prediction for transformer
2024-09-19 22:17:03 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:17:03 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:17:03 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:17:03 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:17:03 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:17:03 - INFO - X 샘플:
[[-1.81619404 -2.13075996 -1.74210671 -2.17670986 -0.679245   -0.68652729
  -2.17670986 -2.17670986  0.          0.          0.         -2.17670986
  -2.17670986]
 [-1.44057694 -1.49395184 -1.48547909 -1.31882464 -0.04758033 -0.05524186
  -1.31882464 -1.31882464  0.          0.          0.         -1.31882464
  -1.31882464]
 [-0.85580941  0.03438764 -0.9031318   0.30420146  2.45325237  2.44858078
   0.30420146  0.30420146  0.          0.          0.          0.30420146
   0.30420146]
 [ 1.03934959  0.58204262  0.59715272  0.66590442  0.85616605  0.86073935
   0.66590442  0.66590442  0.          0.          0.          0.66590442
   0.66590442]
 [ 0.92837181  0.33581015  0.01974059 -0.24762741 -0.03854792 -0.03787696
  -0.24762741 -0.24762741  0.          0.          0.         -0.24762741
  -0.24762741]
 [ 0.1429906   0.55232491  0.46390377  0.70300216 -0.45304653 -0.450128
   0.70300216  0.70300216  0.          0.          0.          0.70300216
   0.70300216]
 [ 0.28811539  0.07259613  0.47870921 -0.2708135  -0.89513409 -0.89493759
  -0.2708135  -0.2708135   0.          0.          0.         -0.2708135
  -0.2708135 ]
 [-0.18994274  0.15325849  0.11844352  0.48041573 -0.8175585  -0.81749006
   0.48041573  0.48041573  0.          0.          0.          0.48041573
   0.48041573]
 [ 0.95825044  0.37826402  0.98209415  0.48505294 -0.90919924 -0.90763356
   0.48505294  0.48505294  0.          0.          0.          0.48505294
   0.48505294]
 [ 0.94544531  1.51602786  1.47067365  1.37539869  0.53089318  0.5405152
   1.37539869  1.37539869  0.          0.          0.          1.37539869
   1.37539869]]
2024-09-19 22:17:03 - INFO - y 샘플:
[1.37539869]
2024-09-19 22:17:03 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:17:03 - INFO - 모델 출력 (스케일링된 예측): [0.29295173]
2024-09-19 22:17:03 - INFO - 스케일러 역변환 후 예측 가격: 84097574.03422832
2024-09-19 22:17:03 - INFO - TransformerPredictor 최종 예측 가격: 84097574.03422832
2024-09-19 22:17:03 - INFO - TRANSFORMER prediction: 84097574.03422832
2024-09-19 22:17:03 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:17:03 - INFO - BITCOIN_FORECAST prediction: 83133982.93343228
2024-09-19 22:17:03 - INFO - BitcoinForecast prediction: 83133982.93343228
2024-09-19 22:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:19 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:20 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:17:20 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:17:20 - INFO - 조정된 모델 가중치: {'gpt': 0.005467305242516086, 'ml': 0.21109428037518854, 'xgboost': 0.0675457243414396, 'rl': 0.1972026344750148, 'lstm': 0.06307167584385616, 'arima': 0.10587956543624065, 'prophet': 0.18400086158693102, 'transformer': 0.09442848663978802, 'bitcoin_forecast': 0.0713094660590251}
2024-09-19 22:17:20 - INFO - 조정된 모델 가중치: {'gpt': 0.005467305242516086, 'ml': 0.21109428037518854, 'xgboost': 0.0675457243414396, 'rl': 0.1972026344750148, 'lstm': 0.06307167584385616, 'arima': 0.10587956543624065, 'prophet': 0.18400086158693102, 'transformer': 0.09442848663978802, 'bitcoin_forecast': 0.0713094660590251}
2024-09-19 22:17:20 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84023163.10447046, 'current_price': 84331000.0, 'predictions': {'gpt': 84331000.0, 'ml': 84263535.2, 'xgboost': 84331000.0, 'lstm': 84128408.69206157, 'rl': 85174310.0, 'arima': 80899000.0, 'prophet': 84459579.47753575, 'transformer': 84097574.03422832, 'bitcoin_forecast': 83133982.93343228}, 'weights': {'gpt': 0.005467305242516086, 'ml': 0.21109428037518854, 'xgboost': 0.0675457243414396, 'rl': 0.1972026344750148, 'lstm': 0.06307167584385616, 'arima': 0.10587956543624065, 'prophet': 0.18400086158693102, 'transformer': 0.09442848663978802, 'bitcoin_forecast': 0.0713094660590251}}
2024-09-19 22:17:20 - INFO - 모델별 가중치:
2024-09-19 22:17:20 - INFO -   - GPT: 0.0055
2024-09-19 22:17:20 - INFO -   - ML: 0.2111
2024-09-19 22:17:20 - INFO -   - XGBOOST: 0.0675
2024-09-19 22:17:20 - INFO -   - RL: 0.1972
2024-09-19 22:17:20 - INFO -   - LSTM: 0.0631
2024-09-19 22:17:20 - INFO -   - ARIMA: 0.1059
2024-09-19 22:17:20 - INFO -   - PROPHET: 0.1840
2024-09-19 22:17:20 - INFO -   - TRANSFORMER: 0.0944
2024-09-19 22:17:20 - INFO -   - BITCOIN_FORECAST: 0.0713
2024-09-19 22:17:20 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:17:20 - INFO - 6. 거래 실행
2024-09-19 22:17:20 - INFO - Cancelling existing orders.
2024-09-19 22:17:20 - INFO - Cancelled 0 orders.
2024-09-19 22:17:20 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84023163.10447046, 'current_price': 84331000.0, 'predictions': {'gpt': 84331000.0, 'ml': 84263535.2, 'xgboost': 84331000.0, 'lstm': 84128408.69206157, 'rl': 85174310.0, 'arima': 80899000.0, 'prophet': 84459579.47753575, 'transformer': 84097574.03422832, 'bitcoin_forecast': 83133982.93343228}, 'weights': {'gpt': 0.005467305242516086, 'ml': 0.21109428037518854, 'xgboost': 0.0675457243414396, 'rl': 0.1972026344750148, 'lstm': 0.06307167584385616, 'arima': 0.10587956543624065, 'prophet': 0.18400086158693102, 'transformer': 0.09442848663978802, 'bitcoin_forecast': 0.0713094660590251}}, 현재 가격=84331000.0
2024-09-19 22:17:20 - INFO - 현재 잔고: KRW=342064.02160688, BTC=0.00162077, 총 자산가치=478745.17647688
2024-09-19 22:17:20 - INFO - 매도 시도: 0.000162077 BTC (약 13668.115487 KRW)
2024-09-19 22:17:20 - INFO - 주문 결과: {'uuid': '68c8177c-caad-4075-ab7d-8199070bd118', 'side': 'ask', 'ord_type': 'limit', 'price': '84331000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:17:21+09:00', 'volume': '0.00016207', 'remaining_volume': '0.00016207', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00016207', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:17:20 - INFO - sell 주문 성공: UUID=68c8177c-caad-4075-ab7d-8199070bd118
2024-09-19 22:17:20 - INFO - Trade executed successfully.
2024-09-19 22:17:20 - INFO - 7. summary 리포트 보내기
2024-09-19 22:17:21 - INFO - Message sent to Discord successfully.
2024-09-19 22:17:21 - INFO - Trading cycle completed.
2024-09-19 22:17:21 - INFO - Performing periodic update.
2024-09-19 22:17:21 - INFO - 계산된 시장 변동성: 0.02905572417001041
2024-09-19 22:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:25:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-8497-d3e9d23a4c76 "HTTP/1.1 200 OK"
2024-09-19 22:25:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:25:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b0-b02e-f0ee83ce837b "HTTP/1.1 200 OK"
2024-09-19 22:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-9916-dba4ce22cd13 "HTTP/1.1 200 OK"
2024-09-19 22:25:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/6d503e22-86ce-4d77-8df8-5f120c0acc6d "HTTP/1.1 200 OK"
2024-09-19 22:26:01 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819d-81c3-f4dee736fea4 "HTTP/1.1 200 OK"
2024-09-19 22:26:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ef-a7f1-f086f9b6cbbe "HTTP/1.1 200 OK"
2024-09-19 22:26:22 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819b-8d46-cf3e0951fa8a "HTTP/1.1 200 OK"
2024-09-19 22:26:34 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-b48b-e8347bd33bff "HTTP/1.1 200 OK"
2024-09-19 22:26:41 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:26:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81eb-8356-fa5dd1ca97c6 "HTTP/1.1 200 OK"
2024-09-19 22:26:55 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:15:34.940204
2024-09-19 22:26:55 - INFO - Starting trading cycle.
2024-09-19 22:26:55 - INFO - ##################################################
2024-09-19 22:26:55 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-19 22:26:55 - INFO - ##################################################
2024-09-19 22:26:55 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:26:55 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:26:55 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:10:00
2024-09-19 22:26:55 - INFO - 새로운 데이터 범위: 2024-09-18 13:10:00 ~ 2024-09-19 22:20:00
2024-09-19 22:26:55 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:26:55 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:26:55 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:26:55 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:26:55 - INFO - Sample date values: [Timestamp('2024-09-19 22:20:00')]
2024-09-19 22:26:55 - INFO - Successfully added 1 new data points
2024-09-19 22:26:55 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:26:55 - INFO - Final date range: 2024-09-19 22:20:00 to 2024-09-19 22:20:00
2024-09-19 22:26:55 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:26:55 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:20:00
2024-09-19 22:26:55 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:26:56 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:26:56 - INFO - GPT | 이전예측가격: 84331000 | 당시BTC가격: 84331000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:26:56 - INFO - ML 모델 예측 업데이트: 정확도 43.75%, 적중/전체: 14/32
2024-09-19 22:26:56 - INFO - ML | 이전예측가격: 84263535 | 당시BTC가격: 84331000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2050 | 반영가중치값: -0.0200 | 새 가중치: 0.1850 | 예측 총 횟수: 32 | 예측 성공 수: 14 | 예측 성공률: 43.75%
2024-09-19 22:26:56 - INFO - XGBOOST | 이전예측가격: 84331000 | 당시BTC가격: 84331000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:26:56 - INFO - LSTM 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 4/14
2024-09-19 22:26:56 - INFO - LSTM | 이전예측가격: 84128409 | 당시BTC가격: 84331000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1089 | 반영가중치값: -0.0200 | 새 가중치: 0.0889 | 예측 총 횟수: 14 | 예측 성공 수: 4 | 예측 성공률: 28.57%
2024-09-19 22:26:56 - INFO - RL 모델 예측 업데이트: 정확도 67.65%, 적중/전체: 23/34
2024-09-19 22:26:56 - INFO - RL | 이전예측가격: 85174310 | 당시BTC가격: 84331000 | 예측: 상승 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2818 | 반영가중치값: 0.0200 | 새 가중치: 0.3018 | 예측 총 횟수: 34 | 예측 성공 수: 23 | 예측 성공률: 67.65%
2024-09-19 22:26:56 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.21%, 적중/전체: 118/226
2024-09-19 22:26:56 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84331000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0175 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 226 | 예측 성공 수: 118 | 예측 성공률: 52.21%
2024-09-19 22:26:56 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 20/30
2024-09-19 22:26:56 - INFO - PROPHET | 이전예측가격: 84459579 | 당시BTC가격: 84331000 | 예측: 상승 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0759 | 반영가중치값: 0.0200 | 새 가중치: 0.0959 | 예측 총 횟수: 30 | 예측 성공 수: 20 | 예측 성공률: 66.67%
2024-09-19 22:26:56 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 4/14
2024-09-19 22:26:56 - INFO - TRANSFORMER | 이전예측가격: 84097574 | 당시BTC가격: 84331000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1089 | 반영가중치값: -0.0200 | 새 가중치: 0.0889 | 예측 총 횟수: 14 | 예측 성공 수: 4 | 예측 성공률: 28.57%
2024-09-19 22:26:56 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 21.43%, 적중/전체: 3/14
2024-09-19 22:26:56 - INFO - BITCOIN_FORECAST | 이전예측가격: 83133983 | 당시BTC가격: 84331000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1089 | 반영가중치값: -0.0200 | 새 가중치: 0.0889 | 예측 총 횟수: 14 | 예측 성공 수: 3 | 예측 성공률: 21.43%
2024-09-19 22:26:56 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:26:56 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:26:56 - INFO - 새로운 가중치: {'gpt': 0.005927344872415396, 'ml': 0.2005721784022277, 'xgboost': 0.0732292756796152, 'rl': 0.32722125779615996, 'lstm': 0.09635114018469795, 'arima': 0.0, 'prophet': 0.10399652269548794, 'transformer': 0.09635114018469795, 'bitcoin_forecast': 0.09635114018469795}
2024-09-19 22:26:56 - INFO - XGBoost 모델 성능: 정확도 61.86%, 적중/전체: 73/118
2024-09-19 22:26:56 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:26:56 - INFO - Current BTC price: 84362000.0
2024-09-19 22:26:56 - INFO - Analyzing market conditions.
2024-09-19 22:26:56 - INFO - Market analysis: {'current_price': 84363000.0, 'sma_20': 83750250.0, 'rsi_14': 71.18144954078593, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 22:26:56 - INFO - Starting predictions for all models
2024-09-19 22:26:56 - INFO - Attempting prediction for gpt
2024-09-19 22:26:56 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:26:56 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:26:56 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:26:56 - INFO - GPT prediction: 84362000.0
2024-09-19 22:26:56 - INFO - Attempting prediction for ml
2024-09-19 22:26:56 - INFO - ML prediction: 84228019.2
2024-09-19 22:26:56 - INFO - Attempting prediction for xgboost
2024-09-19 22:26:56 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:26:56 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:26:56 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:26:56 - INFO - XGBOOST prediction: 84363000.0
2024-09-19 22:26:56 - INFO - Attempting prediction for lstm
2024-09-19 22:26:56 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:26:56 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:26:56 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:26:56 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:26:56 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:26:56 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:26:56 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:26:56 - INFO - X 샘플:
[[-2.02246597 -2.41901745 -1.98840092 -2.14236925 -0.03808518 -0.04686106
  -2.14236925]
 [-1.35027325 -0.38622968 -1.35133519 -0.08353005  2.44625127  2.44241351
  -0.08353005]
 [ 0.82821993  0.34218594  0.2899189   0.37529697  0.85969982  0.86379799
   0.37529697]
 [ 0.70065051  0.01468125 -0.34174797 -0.78353538 -0.02911235 -0.02959706
  -0.78353538]
 [-0.20214847  0.30265951  0.14414962  0.42235616 -0.4408768  -0.43945277
   0.42235616]
 [-0.03532692 -0.33540998  0.1603462  -0.81294737 -0.88004821 -0.88167787
  -0.81294737]
 [-0.58485673 -0.22812396 -0.23377073  0.14000107 -0.80298433 -0.80468033
   0.14000107]
 [ 0.73499612  0.07114757  0.71103014  0.14588346 -0.89402059 -0.89430007
   0.14588346]
 [ 0.72027658  1.58444514  1.24551749  1.27530383  0.53657255  0.54543445
   1.27530383]
 [ 1.2109282   1.05366166  1.36429246  1.46354055 -0.75739618 -0.75507679
   1.46354055]]
2024-09-19 22:26:56 - INFO - y 샘플:
[1.46354055]
2024-09-19 22:26:56 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:26:56 - INFO - 모델 출력 (스케일링된 예측): [[0.44564328]]
2024-09-19 22:26:56 - INFO - 스케일러 역변환 후 예측 가격: 84189958.78019893
2024-09-19 22:26:56 - INFO - LSTMPredictor 최종 예측 가격: 84189958.78019893
2024-09-19 22:26:56 - INFO - LSTM prediction: 84189958.78019893
2024-09-19 22:26:56 - INFO - Attempting prediction for rl
2024-09-19 22:26:56 - INFO - Preparing state for RL agent.
2024-09-19 22:26:56 - INFO - Prepared state: [[8.43630000e+07 2.75990026e+01 3.79457139e-04 8.37502500e+07
  7.11814495e+01]]
2024-09-19 22:26:56 - INFO - RL prediction: 85205620.0
2024-09-19 22:26:56 - INFO - Attempting prediction for arima
2024-09-19 22:26:56 - INFO - ARIMA 예측 시작
2024-09-19 22:26:56 - INFO - 입력 데이터: {'open': 84277000.0, 'high': 84365000.0, 'low': 84199000.0, 'close': 84363000.0, 'volume': 27.59900261, 'value': 2326206021.32007, 'decision': 'sell', 'sma': 83750250.0, 'ema': 83818686.36004807, 'rsi': 71.18144954078593, 'macd': 315730.56027787924, 'signal_line': 271372.1356507854, 'BB_Upper': 84534930.54009362, 'BB_Lower': 82965569.45990638}
2024-09-19 22:26:56 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:26:56 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83750250.0         0         0
2024-09-19 22:26:56 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83750250.0         0         0
2024-09-19 22:26:56 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:26:56 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:26:56 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:26:56 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:26:56 - INFO - Attempting prediction for prophet
2024-09-19 22:26:57 - INFO - PROPHET prediction: 84478112.2169395
2024-09-19 22:26:57 - INFO - Attempting prediction for transformer
2024-09-19 22:26:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:26:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:26:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:26:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:26:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:26:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:26:57 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:26:57 - INFO - X 샘플:
[[-2.02246597 -2.41901745 -1.98840092 -2.14236925 -0.03808518 -0.04686106
  -2.14236925 -2.14236925  0.          0.          0.         -2.14236925
  -2.14236925]
 [-1.35027325 -0.38622968 -1.35133519 -0.08353005  2.44625127  2.44241351
  -0.08353005 -0.08353005  0.          0.          0.         -0.08353005
  -0.08353005]
 [ 0.82821993  0.34218594  0.2899189   0.37529697  0.85969982  0.86379799
   0.37529697  0.37529697  0.          0.          0.          0.37529697
   0.37529697]
 [ 0.70065051  0.01468125 -0.34174797 -0.78353538 -0.02911235 -0.02959706
  -0.78353538 -0.78353538  0.          0.          0.         -0.78353538
  -0.78353538]
 [-0.20214847  0.30265951  0.14414962  0.42235616 -0.4408768  -0.43945277
   0.42235616  0.42235616  0.          0.          0.          0.42235616
   0.42235616]
 [-0.03532692 -0.33540998  0.1603462  -0.81294737 -0.88004821 -0.88167787
  -0.81294737 -0.81294737  0.          0.          0.         -0.81294737
  -0.81294737]
 [-0.58485673 -0.22812396 -0.23377073  0.14000107 -0.80298433 -0.80468033
   0.14000107  0.14000107  0.          0.          0.          0.14000107
   0.14000107]
 [ 0.73499612  0.07114757  0.71103014  0.14588346 -0.89402059 -0.89430007
   0.14588346  0.14588346  0.          0.          0.          0.14588346
   0.14588346]
 [ 0.72027658  1.58444514  1.24551749  1.27530383  0.53657255  0.54543445
   1.27530383  1.27530383  0.          0.          0.          1.27530383
   1.27530383]
 [ 1.2109282   1.05366166  1.36429246  1.46354055 -0.75739618 -0.75507679
   1.46354055  1.46354055  0.          0.          0.          1.46354055
   1.46354055]]
2024-09-19 22:26:57 - INFO - y 샘플:
[1.46354055]
2024-09-19 22:26:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:26:57 - INFO - 모델 출력 (스케일링된 예측): [0.29148924]
2024-09-19 22:26:57 - INFO - 스케일러 역변환 후 예측 가격: 84163752.79417345
2024-09-19 22:26:57 - INFO - TransformerPredictor 최종 예측 가격: 84163752.79417345
2024-09-19 22:26:57 - INFO - TRANSFORMER prediction: 84163752.79417345
2024-09-19 22:26:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:26:57 - INFO - BITCOIN_FORECAST prediction: 82908664.44398531
2024-09-19 22:26:57 - INFO - BitcoinForecast prediction: 82908664.44398531
2024-09-19 22:26:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:27:04 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:27:04 - INFO - 조정된 모델 가중치: {'gpt': 0.005927344872415396, 'ml': 0.2005721784022277, 'xgboost': 0.0732292756796152, 'rl': 0.32722125779615996, 'lstm': 0.09635114018469795, 'arima': 0.0, 'prophet': 0.10399652269548794, 'transformer': 0.09635114018469795, 'bitcoin_forecast': 0.09635114018469795}
2024-09-19 22:27:04 - INFO - 조정된 모델 가중치: {'gpt': 0.005927344872415396, 'ml': 0.2005721784022277, 'xgboost': 0.0732292756796152, 'rl': 0.32722125779615996, 'lstm': 0.09635114018469795, 'arima': 0.0, 'prophet': 0.10399652269548794, 'transformer': 0.09635114018469795, 'bitcoin_forecast': 0.09635114018469795}
2024-09-19 22:27:04 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84447617.82276239, 'current_price': 84362000.0, 'predictions': {'gpt': 84362000.0, 'ml': 84228019.2, 'xgboost': 84363000.0, 'lstm': 84189958.78019893, 'rl': 85205620.0, 'arima': 80899000.0, 'prophet': 84478112.2169395, 'transformer': 84163752.79417345, 'bitcoin_forecast': 82908664.44398531}, 'weights': {'gpt': 0.005927344872415396, 'ml': 0.2005721784022277, 'xgboost': 0.0732292756796152, 'rl': 0.32722125779615996, 'lstm': 0.09635114018469795, 'arima': 0.0, 'prophet': 0.10399652269548794, 'transformer': 0.09635114018469795, 'bitcoin_forecast': 0.09635114018469795}}
2024-09-19 22:27:04 - INFO - 모델별 가중치:
2024-09-19 22:27:04 - INFO -   - GPT: 0.0059
2024-09-19 22:27:04 - INFO -   - ML: 0.2006
2024-09-19 22:27:04 - INFO -   - XGBOOST: 0.0732
2024-09-19 22:27:04 - INFO -   - RL: 0.3272
2024-09-19 22:27:04 - INFO -   - LSTM: 0.0964
2024-09-19 22:27:04 - INFO -   - ARIMA: 0.0000
2024-09-19 22:27:04 - INFO -   - PROPHET: 0.1040
2024-09-19 22:27:04 - INFO -   - TRANSFORMER: 0.0964
2024-09-19 22:27:04 - INFO -   - BITCOIN_FORECAST: 0.0964
2024-09-19 22:27:04 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:27:04 - INFO - 6. 거래 실행
2024-09-19 22:27:04 - INFO - Cancelling existing orders.
2024-09-19 22:27:04 - INFO - Cancelled 0 orders.
2024-09-19 22:27:04 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84447617.82276239, 'current_price': 84362000.0, 'predictions': {'gpt': 84362000.0, 'ml': 84228019.2, 'xgboost': 84363000.0, 'lstm': 84189958.78019893, 'rl': 85205620.0, 'arima': 80899000.0, 'prophet': 84478112.2169395, 'transformer': 84163752.79417345, 'bitcoin_forecast': 82908664.44398531}, 'weights': {'gpt': 0.005927344872415396, 'ml': 0.2005721784022277, 'xgboost': 0.0732292756796152, 'rl': 0.32722125779615996, 'lstm': 0.09635114018469795, 'arima': 0.0, 'prophet': 0.10399652269548794, 'transformer': 0.09635114018469795, 'bitcoin_forecast': 0.09635114018469795}}, 현재 가격=84362000.0
2024-09-19 22:27:04 - INFO - 현재 잔고: KRW=355724.7130143, BTC=0.0014587, 총 자산가치=478783.5624143
2024-09-19 22:27:04 - INFO - 매수 시도: 0.0005675346274558451 BTC (약 47878.35624143 KRW)
2024-09-19 22:27:04 - INFO - 주문 결과: {'uuid': '20f78aab-a800-4857-aaf4-91db36f83d35', 'side': 'bid', 'ord_type': 'limit', 'price': '84362000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:27:04+09:00', 'volume': '0.00056753', 'remaining_volume': '0.00056753', 'reserved_fee': '23.93898293', 'remaining_fee': '23.93898293', 'paid_fee': '0', 'locked': '47901.90484293', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:27:04 - INFO - buy 주문 성공: UUID=20f78aab-a800-4857-aaf4-91db36f83d35
2024-09-19 22:27:04 - INFO - Trade executed successfully.
2024-09-19 22:27:04 - INFO - 7. summary 리포트 보내기
2024-09-19 22:27:04 - INFO - Message sent to Discord successfully.
2024-09-19 22:27:04 - INFO - Trading cycle completed.
2024-09-19 22:27:04 - INFO - Performing periodic update.
2024-09-19 22:27:04 - INFO - 계산된 시장 변동성: 0.029031746726376092
2024-09-19 22:35:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8106-bbd8-ca9995a5e118 "HTTP/1.1 200 OK"
2024-09-19 22:35:47 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0705166f-f861-4197-9ce9-0e409d054ac4 "HTTP/1.1 200 OK"
2024-09-19 22:36:04 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-8164-d50a0b367736 "HTTP/1.1 200 OK"
2024-09-19 22:36:24 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-b40a-cd704f77d940 "HTTP/1.1 200 OK"
2024-09-19 22:36:35 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-9838-e30221e93664 "HTTP/1.1 200 OK"
2024-09-19 22:36:40 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-820e-e11ca4e2717c "HTTP/1.1 200 OK"
2024-09-19 22:36:46 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:36:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ff-bef9-dd13ab07ac6b "HTTP/1.1 200 OK"
2024-09-19 22:36:52 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:36:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:37:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8120-8b7b-fe72f7b0aaeb "HTTP/1.1 200 OK"
2024-09-19 22:37:00 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:37:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:37:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-a56a-e8ea2713d880 "HTTP/1.1 200 OK"
2024-09-19 22:37:06 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:25:34.940628
2024-09-19 22:37:06 - INFO - Starting trading cycle.
2024-09-19 22:37:06 - INFO - ##################################################
2024-09-19 22:37:06 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-19 22:37:06 - INFO - ##################################################
2024-09-19 22:37:06 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:37:06 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:37:06 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:20:00
2024-09-19 22:37:06 - INFO - 새로운 데이터 범위: 2024-09-18 13:20:00 ~ 2024-09-19 22:30:00
2024-09-19 22:37:06 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:37:06 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:37:06 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:37:06 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:37:06 - INFO - Sample date values: [Timestamp('2024-09-19 22:30:00')]
2024-09-19 22:37:06 - INFO - Successfully added 1 new data points
2024-09-19 22:37:06 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:37:06 - INFO - Final date range: 2024-09-19 22:30:00 to 2024-09-19 22:30:00
2024-09-19 22:37:06 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:37:06 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:30:00
2024-09-19 22:37:06 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:37:06 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:37:06 - INFO - GPT | 이전예측가격: 84362000 | 당시BTC가격: 84362000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:37:06 - INFO - ML 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 15/33
2024-09-19 22:37:06 - INFO - ML | 이전예측가격: 84228019 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2111 | 반영가중치값: 0.0200 | 새 가중치: 0.2311 | 예측 총 횟수: 33 | 예측 성공 수: 15 | 예측 성공률: 45.45%
2024-09-19 22:37:06 - INFO - XGBOOST | 이전예측가격: 84363000 | 당시BTC가격: 84362000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:37:06 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 5/15
2024-09-19 22:37:06 - INFO - LSTM | 이전예측가격: 84189959 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0631 | 반영가중치값: 0.0200 | 새 가중치: 0.0831 | 예측 총 횟수: 15 | 예측 성공 수: 5 | 예측 성공률: 33.33%
2024-09-19 22:37:06 - INFO - RL 모델 예측 업데이트: 정확도 65.71%, 적중/전체: 23/35
2024-09-19 22:37:06 - INFO - RL | 이전예측가격: 85205620 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1972 | 반영가중치값: -0.0200 | 새 가중치: 0.1772 | 예측 총 횟수: 35 | 예측 성공 수: 23 | 예측 성공률: 65.71%
2024-09-19 22:37:06 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.42%, 적중/전체: 119/227
2024-09-19 22:37:06 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1059 | 반영가중치값: 0.0200 | 새 가중치: 0.1259 | 예측 총 횟수: 227 | 예측 성공 수: 119 | 예측 성공률: 52.42%
2024-09-19 22:37:06 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.52%, 적중/전체: 20/31
2024-09-19 22:37:06 - INFO - PROPHET | 이전예측가격: 84478112 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1840 | 반영가중치값: -0.0200 | 새 가중치: 0.1640 | 예측 총 횟수: 31 | 예측 성공 수: 20 | 예측 성공률: 64.52%
2024-09-19 22:37:06 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 5/15
2024-09-19 22:37:06 - INFO - TRANSFORMER | 이전예측가격: 84163753 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0944 | 반영가중치값: 0.0200 | 새 가중치: 0.1144 | 예측 총 횟수: 15 | 예측 성공 수: 5 | 예측 성공률: 33.33%
2024-09-19 22:37:06 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 26.67%, 적중/전체: 4/15
2024-09-19 22:37:06 - INFO - BITCOIN_FORECAST | 이전예측가격: 82908664 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84250000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0713 | 반영가중치값: 0.0200 | 새 가중치: 0.0913 | 예측 총 횟수: 15 | 예측 성공 수: 4 | 예측 성공률: 26.67%
2024-09-19 22:37:06 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:37:06 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:37:06 - INFO - 새로운 가중치: {'gpt': 0.00555961215977791, 'ml': 0.21675718199023392, 'xgboost': 0.06868612849149322, 'rl': 0.16620897595427278, 'lstm': 0.07791790575641484, 'arima': 0.11806999216863466, 'prophet': 0.1538262415834772, 'transformer': 0.1073293387580984, 'bitcoin_forecast': 0.08564462313759696}
2024-09-19 22:37:06 - INFO - XGBoost 모델 성능: 정확도 61.86%, 적중/전체: 73/118
2024-09-19 22:37:06 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:37:06 - INFO - Current BTC price: 84250000.0
2024-09-19 22:37:06 - INFO - Analyzing market conditions.
2024-09-19 22:37:06 - INFO - Market analysis: {'current_price': 84250000.0, 'sma_20': 83794900.0, 'rsi_14': 66.49088352192662, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 22:37:06 - INFO - Starting predictions for all models
2024-09-19 22:37:06 - INFO - Attempting prediction for gpt
2024-09-19 22:37:07 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:37:07 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:37:07 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:37:07 - INFO - GPT prediction: 84250000.0
2024-09-19 22:37:07 - INFO - Attempting prediction for ml
2024-09-19 22:37:07 - INFO - ML prediction: 84199450.0
2024-09-19 22:37:07 - INFO - Attempting prediction for xgboost
2024-09-19 22:37:07 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:37:07 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:37:07 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:37:07 - INFO - XGBOOST prediction: 84250000.0
2024-09-19 22:37:07 - INFO - Attempting prediction for lstm
2024-09-19 22:37:07 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:37:07 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:37:07 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:37:07 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:37:07 - INFO - X 샘플:
[[-1.84654617 -1.07774799 -2.05872871 -0.52454832  2.45898068  2.45403656
  -0.52454832]
 [ 0.41079551 -0.10754917 -0.04827729  0.11275338  0.87581586  0.87857925
   0.11275338]
 [ 0.27860884 -0.54376259 -0.82203655 -1.49684193 -0.01109906 -0.01302844
  -1.49684193]
 [-0.65686609 -0.16019562 -0.22683712  0.17811765 -0.42198457 -0.42206419
   0.17811765]
 [-0.48400659 -1.0100597  -0.20699714 -1.53769461 -0.86021853 -0.86340456
  -1.53769461]
 [-1.05342612 -0.8671622  -0.68977001 -0.21406801 -0.78331915 -0.78656107
  -0.21406801]
 [ 0.31419756 -0.46855338  0.46756222 -0.20589747 -0.87416108 -0.87600151
  -0.20589747]
 [ 0.29894525  1.54705346  1.1222816   1.36284517  0.55337833  0.56085264
   1.36284517]
 [ 0.80735554  0.84008688  1.2677748   1.62430227 -0.73782831 -0.73705676
   1.62430227]
 [ 1.93094227  1.8478903   1.1950282   0.70103187 -0.19956417 -0.19535194
   0.70103187]]
2024-09-19 22:37:07 - INFO - y 샘플:
[0.70103187]
2024-09-19 22:37:07 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:37:07 - INFO - 모델 출력 (스케일링된 예측): [[0.45133436]]
2024-09-19 22:37:07 - INFO - 스케일러 역변환 후 예측 가격: 84219439.26907049
2024-09-19 22:37:07 - INFO - LSTMPredictor 최종 예측 가격: 84219439.26907049
2024-09-19 22:37:07 - INFO - LSTM prediction: 84219439.26907049
2024-09-19 22:37:07 - INFO - Attempting prediction for rl
2024-09-19 22:37:07 - INFO - Preparing state for RL agent.
2024-09-19 22:37:07 - INFO - Prepared state: [[ 8.42500000e+07  3.93368632e+01 -1.33944976e-03  8.37949000e+07
   6.64908835e+01]]
2024-09-19 22:37:07 - INFO - RL prediction: 85092500.0
2024-09-19 22:37:07 - INFO - Attempting prediction for arima
2024-09-19 22:37:07 - INFO - ARIMA 예측 시작
2024-09-19 22:37:07 - INFO - 입력 데이터: {'open': 84498000.0, 'high': 84499000.0, 'low': 84188000.0, 'close': 84250000.0, 'volume': 39.33686323, 'value': 3317479822.11854, 'decision': 'sell', 'sma': 83794900.0, 'ema': 83859763.8495673, 'rsi': 66.49088352192662, 'macd': 310886.2793472409, 'signal_line': 279274.9643900765, 'BB_Upper': 84586588.04462466, 'BB_Lower': 83003211.95537534}
2024-09-19 22:37:07 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:37:07 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83794900.0         0         0
2024-09-19 22:37:07 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83794900.0         0         0
2024-09-19 22:37:07 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:37:07 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:37:07 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:37:07 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:37:07 - INFO - Attempting prediction for prophet
2024-09-19 22:37:07 - INFO - PROPHET prediction: 84345328.00363027
2024-09-19 22:37:07 - INFO - Attempting prediction for transformer
2024-09-19 22:37:07 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:37:07 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:37:07 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:37:07 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:37:07 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:37:07 - INFO - X 샘플:
[[-1.84654617 -1.07774799 -2.05872871 -0.52454832  2.45898068  2.45403656
  -0.52454832 -0.52454832  0.          0.          0.         -0.52454832
  -0.52454832]
 [ 0.41079551 -0.10754917 -0.04827729  0.11275338  0.87581586  0.87857925
   0.11275338  0.11275338  0.          0.          0.          0.11275338
   0.11275338]
 [ 0.27860884 -0.54376259 -0.82203655 -1.49684193 -0.01109906 -0.01302844
  -1.49684193 -1.49684193  0.          0.          0.         -1.49684193
  -1.49684193]
 [-0.65686609 -0.16019562 -0.22683712  0.17811765 -0.42198457 -0.42206419
   0.17811765  0.17811765  0.          0.          0.          0.17811765
   0.17811765]
 [-0.48400659 -1.0100597  -0.20699714 -1.53769461 -0.86021853 -0.86340456
  -1.53769461 -1.53769461  0.          0.          0.         -1.53769461
  -1.53769461]
 [-1.05342612 -0.8671622  -0.68977001 -0.21406801 -0.78331915 -0.78656107
  -0.21406801 -0.21406801  0.          0.          0.         -0.21406801
  -0.21406801]
 [ 0.31419756 -0.46855338  0.46756222 -0.20589747 -0.87416108 -0.87600151
  -0.20589747 -0.20589747  0.          0.          0.         -0.20589747
  -0.20589747]
 [ 0.29894525  1.54705346  1.1222816   1.36284517  0.55337833  0.56085264
   1.36284517  1.36284517  0.          0.          0.          1.36284517
   1.36284517]
 [ 0.80735554  0.84008688  1.2677748   1.62430227 -0.73782831 -0.73705676
   1.62430227  1.62430227  0.          0.          0.          1.62430227
   1.62430227]
 [ 1.93094227  1.8478903   1.1950282   0.70103187 -0.19956417 -0.19535194
   0.70103187  0.70103187  0.          0.          0.          0.70103187
   0.70103187]]
2024-09-19 22:37:07 - INFO - y 샘플:
[0.70103187]
2024-09-19 22:37:07 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:37:07 - INFO - 모델 출력 (스케일링된 예측): [0.2891831]
2024-09-19 22:37:07 - INFO - 스케일러 역변환 후 예측 가격: 84199593.41370061
2024-09-19 22:37:07 - INFO - TransformerPredictor 최종 예측 가격: 84199593.41370061
2024-09-19 22:37:07 - INFO - TRANSFORMER prediction: 84199593.41370061
2024-09-19 22:37:07 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:37:07 - INFO - BITCOIN_FORECAST prediction: 83031921.0878433
2024-09-19 22:37:07 - INFO - BitcoinForecast prediction: 83031921.0878433
2024-09-19 22:37:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:37:15 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:37:15 - INFO - 조정된 모델 가중치: {'gpt': 0.00555961215977791, 'ml': 0.21675718199023392, 'xgboost': 0.06868612849149322, 'rl': 0.16620897595427278, 'lstm': 0.07791790575641484, 'arima': 0.11806999216863466, 'prophet': 0.1538262415834772, 'transformer': 0.1073293387580984, 'bitcoin_forecast': 0.08564462313759696}
2024-09-19 22:37:15 - INFO - 조정된 모델 가중치: {'gpt': 0.00555961215977791, 'ml': 0.21675718199023392, 'xgboost': 0.06868612849149322, 'rl': 0.16620897595427278, 'lstm': 0.07791790575641484, 'arima': 0.11806999216863466, 'prophet': 0.1538262415834772, 'transformer': 0.1073293387580984, 'bitcoin_forecast': 0.08564462313759696}
2024-09-19 22:37:15 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83885972.14833838, 'current_price': 84250000.0, 'predictions': {'gpt': 84250000.0, 'ml': 84199450.0, 'xgboost': 84250000.0, 'lstm': 84219439.26907049, 'rl': 85092500.0, 'arima': 80899000.0, 'prophet': 84345328.00363027, 'transformer': 84199593.41370061, 'bitcoin_forecast': 83031921.0878433}, 'weights': {'gpt': 0.00555961215977791, 'ml': 0.21675718199023392, 'xgboost': 0.06868612849149322, 'rl': 0.16620897595427278, 'lstm': 0.07791790575641484, 'arima': 0.11806999216863466, 'prophet': 0.1538262415834772, 'transformer': 0.1073293387580984, 'bitcoin_forecast': 0.08564462313759696}}
2024-09-19 22:37:15 - INFO - 모델별 가중치:
2024-09-19 22:37:15 - INFO -   - GPT: 0.0056
2024-09-19 22:37:15 - INFO -   - ML: 0.2168
2024-09-19 22:37:15 - INFO -   - XGBOOST: 0.0687
2024-09-19 22:37:15 - INFO -   - RL: 0.1662
2024-09-19 22:37:15 - INFO -   - LSTM: 0.0779
2024-09-19 22:37:15 - INFO -   - ARIMA: 0.1181
2024-09-19 22:37:15 - INFO -   - PROPHET: 0.1538
2024-09-19 22:37:15 - INFO -   - TRANSFORMER: 0.1073
2024-09-19 22:37:15 - INFO -   - BITCOIN_FORECAST: 0.0856
2024-09-19 22:37:15 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:37:15 - INFO - 6. 거래 실행
2024-09-19 22:37:15 - INFO - Cancelling existing orders.
2024-09-19 22:37:15 - INFO - Cancelled 0 orders.
2024-09-19 22:37:15 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83885972.14833838, 'current_price': 84250000.0, 'predictions': {'gpt': 84250000.0, 'ml': 84199450.0, 'xgboost': 84250000.0, 'lstm': 84219439.26907049, 'rl': 85092500.0, 'arima': 80899000.0, 'prophet': 84345328.00363027, 'transformer': 84199593.41370061, 'bitcoin_forecast': 83031921.0878433}, 'weights': {'gpt': 0.00555961215977791, 'ml': 0.21675718199023392, 'xgboost': 0.06868612849149322, 'rl': 0.16620897595427278, 'lstm': 0.07791790575641484, 'arima': 0.11806999216863466, 'prophet': 0.1538262415834772, 'transformer': 0.1073293387580984, 'bitcoin_forecast': 0.08564462313759696}}, 현재 가격=84250000.0
2024-09-19 22:37:15 - INFO - 현재 잔고: KRW=307822.80817137, BTC=0.00202623, 총 자산가치=478532.68567137
2024-09-19 22:37:15 - INFO - 매도 시도: 0.000202623 BTC (약 17070.98775 KRW)
2024-09-19 22:37:15 - INFO - 주문 결과: {'uuid': '4ac556a8-943e-45eb-9320-81f28e41be41', 'side': 'ask', 'ord_type': 'limit', 'price': '84250000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:37:16+09:00', 'volume': '0.00020262', 'remaining_volume': '0.00020262', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00020262', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:37:15 - INFO - sell 주문 성공: UUID=4ac556a8-943e-45eb-9320-81f28e41be41
2024-09-19 22:37:15 - INFO - Trade executed successfully.
2024-09-19 22:37:15 - INFO - 7. summary 리포트 보내기
2024-09-19 22:37:16 - INFO - Message sent to Discord successfully.
2024-09-19 22:37:16 - INFO - Trading cycle completed.
2024-09-19 22:37:16 - INFO - Performing periodic update.
2024-09-19 22:37:16 - INFO - 계산된 시장 변동성: 0.029166182705707686
2024-09-19 22:45:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b3-bdd0-c83ae850e851 "HTTP/1.1 200 OK"
2024-09-19 22:45:58 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:46:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:46:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-9eb0-c0544e5df9b2 "HTTP/1.1 200 OK"
2024-09-19 22:46:10 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:46:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8199-9041-d557427e14f8 "HTTP/1.1 200 OK"
2024-09-19 22:46:16 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:46:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:46:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/382f4df3-a3ad-4766-9a2a-8d4c153bf9c2 "HTTP/1.1 200 OK"
2024-09-19 22:46:40 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:47:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:47:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fb-bd46-f6da79288d8d "HTTP/1.1 200 OK"
2024-09-19 22:47:13 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:47:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:47:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-9a86-c3b45c4f0758 "HTTP/1.1 200 OK"
2024-09-19 22:47:25 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:47:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:47:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ca-aed4-c63458fd91dd "HTTP/1.1 200 OK"
2024-09-19 22:47:45 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:47:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:47:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-a8d0-dbbd5da9ad01 "HTTP/1.1 200 OK"
2024-09-19 22:47:57 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:48:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:48:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-bd3b-d6220530eb1f "HTTP/1.1 200 OK"
2024-09-19 22:48:02 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:35:34.940785
2024-09-19 22:48:02 - INFO - Starting trading cycle.
2024-09-19 22:48:02 - INFO - ##################################################
2024-09-19 22:48:02 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-19 22:48:02 - INFO - ##################################################
2024-09-19 22:48:02 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:48:02 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:48:02 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:30:00
2024-09-19 22:48:02 - INFO - 새로운 데이터 범위: 2024-09-18 13:30:00 ~ 2024-09-19 22:40:00
2024-09-19 22:48:02 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:48:02 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:48:02 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:48:02 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:48:02 - INFO - Sample date values: [Timestamp('2024-09-19 22:40:00')]
2024-09-19 22:48:03 - INFO - Successfully added 1 new data points
2024-09-19 22:48:03 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:48:03 - INFO - Final date range: 2024-09-19 22:40:00 to 2024-09-19 22:40:00
2024-09-19 22:48:03 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:48:03 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:40:00
2024-09-19 22:48:03 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:48:03 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:48:03 - INFO - GPT | 이전예측가격: 84250000 | 당시BTC가격: 84250000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:48:03 - INFO - ML 모델 예측 업데이트: 정확도 47.06%, 적중/전체: 16/34
2024-09-19 22:48:03 - INFO - ML | 이전예측가격: 84199450 | 당시BTC가격: 84250000 | 예측: 하락 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2006 | 반영가중치값: 0.0200 | 새 가중치: 0.2206 | 예측 총 횟수: 34 | 예측 성공 수: 16 | 예측 성공률: 47.06%
2024-09-19 22:48:03 - INFO - XGBOOST | 이전예측가격: 84250000 | 당시BTC가격: 84250000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:48:03 - INFO - LSTM 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 6/16
2024-09-19 22:48:03 - INFO - LSTM | 이전예측가격: 84219439 | 당시BTC가격: 84250000 | 예측: 하락 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0964 | 반영가중치값: 0.0200 | 새 가중치: 0.1164 | 예측 총 횟수: 16 | 예측 성공 수: 6 | 예측 성공률: 37.50%
2024-09-19 22:48:03 - INFO - RL 모델 예측 업데이트: 정확도 63.89%, 적중/전체: 23/36
2024-09-19 22:48:03 - INFO - RL | 이전예측가격: 85092500 | 당시BTC가격: 84250000 | 예측: 상승 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3272 | 반영가중치값: -0.0200 | 새 가중치: 0.3072 | 예측 총 횟수: 36 | 예측 성공 수: 23 | 예측 성공률: 63.89%
2024-09-19 22:48:03 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 120/228
2024-09-19 22:48:03 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84250000 | 예측: 하락 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 228 | 예측 성공 수: 120 | 예측 성공률: 52.63%
2024-09-19 22:48:03 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 20/32
2024-09-19 22:48:03 - INFO - PROPHET | 이전예측가격: 84345328 | 당시BTC가격: 84250000 | 예측: 상승 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1040 | 반영가중치값: -0.0200 | 새 가중치: 0.0840 | 예측 총 횟수: 32 | 예측 성공 수: 20 | 예측 성공률: 62.50%
2024-09-19 22:48:03 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 6/16
2024-09-19 22:48:03 - INFO - TRANSFORMER | 이전예측가격: 84199593 | 당시BTC가격: 84250000 | 예측: 하락 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0964 | 반영가중치값: 0.0200 | 새 가중치: 0.1164 | 예측 총 횟수: 16 | 예측 성공 수: 6 | 예측 성공률: 37.50%
2024-09-19 22:48:03 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 31.25%, 적중/전체: 5/16
2024-09-19 22:48:03 - INFO - BITCOIN_FORECAST | 이전예측가격: 83031921 | 당시BTC가격: 84250000 | 예측: 하락 | 지금 BTC가격: 84086000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0964 | 반영가중치값: 0.0200 | 새 가중치: 0.1164 | 예측 총 횟수: 16 | 예측 성공 수: 5 | 예측 성공률: 31.25%
2024-09-19 22:48:03 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:48:03 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:48:03 - INFO - 새로운 가중치: {'gpt': 0.005269329437550241, 'ml': 0.20905549512393884, 'xgboost': 0.06509983581769158, 'rl': 0.29118038651300193, 'lstm': 0.11027612546488405, 'arima': 0.018955744703460523, 'prophet': 0.07961083200970484, 'transformer': 0.11027612546488405, 'bitcoin_forecast': 0.11027612546488405}
2024-09-19 22:48:03 - INFO - XGBoost 모델 성능: 정확도 61.86%, 적중/전체: 73/118
2024-09-19 22:48:03 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:48:03 - INFO - Current BTC price: 84086000.0
2024-09-19 22:48:03 - INFO - Analyzing market conditions.
2024-09-19 22:48:03 - INFO - Market analysis: {'current_price': 84149000.0, 'sma_20': 83828600.0, 'rsi_14': 62.52500185078582, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 22:48:03 - INFO - Starting predictions for all models
2024-09-19 22:48:03 - INFO - Attempting prediction for gpt
2024-09-19 22:48:03 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:48:03 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:48:03 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:48:03 - INFO - GPT prediction: 84086000.0
2024-09-19 22:48:03 - INFO - Attempting prediction for ml
2024-09-19 22:48:03 - INFO - ML prediction: 84081680.8
2024-09-19 22:48:03 - INFO - Attempting prediction for xgboost
2024-09-19 22:48:03 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:48:03 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:48:03 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:48:03 - INFO - XGBOOST prediction: 84149000.0
2024-09-19 22:48:03 - INFO - Attempting prediction for lstm
2024-09-19 22:48:03 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:48:03 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:48:04 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:48:04 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:48:04 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:48:04 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:48:04 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:48:04 - INFO - X 샘플:
[[ 0.0823115  -0.35322039 -0.35447611  0.0737416   2.02392266  2.01947317
   0.0737416 ]
 [-0.06734577 -0.78452107 -1.41518466 -1.55851626  0.47929717  0.47296165
  -1.55851626]
 [-1.12645879 -0.40527392 -0.599255    0.14002618 -0.2362892  -0.2365191
   0.14002618]
 [-0.93075312 -1.24556662 -0.57205735 -1.59994413 -0.99950486 -1.00203287
  -1.59994413]
 [-1.57543061 -1.10427847 -1.23386696 -0.25768132 -0.86557911 -0.86874628
  -0.25768132]
 [-0.02705343 -0.71015888  0.35266293 -0.24939574 -1.02378679 -1.02388253
  -0.24939574]
 [-0.04432158  1.28274772  1.25018555  1.34143425  1.46237474  1.46836995
   1.34143425]
 [ 0.53128332  0.58374316  1.44963502  1.60657258 -0.78635356 -0.78288007
   1.60657258]
 [ 1.80337015  1.58019646  1.34991029  0.67030285  0.15107175  0.15671786
   0.67030285]
 [ 1.35439833  1.156332   -0.22755372 -0.16654002 -0.2051528  -0.2034618
  -0.16654002]]
2024-09-19 22:48:04 - INFO - y 샘플:
[-0.16654002]
2024-09-19 22:48:04 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:48:04 - INFO - 모델 출력 (스케일링된 예측): [[0.43917954]]
2024-09-19 22:48:04 - INFO - 스케일러 역변환 후 예측 가격: 84222105.33171023
2024-09-19 22:48:04 - INFO - LSTMPredictor 최종 예측 가격: 84222105.33171023
2024-09-19 22:48:04 - INFO - LSTM prediction: 84222105.33171023
2024-09-19 22:48:04 - INFO - Attempting prediction for rl
2024-09-19 22:48:04 - INFO - Preparing state for RL agent.
2024-09-19 22:48:04 - INFO - Prepared state: [[ 8.41490000e+07  3.48764394e+01 -1.19881306e-03  8.38286000e+07
   6.25250019e+01]]
2024-09-19 22:48:04 - INFO - RL prediction: 84926860.0
2024-09-19 22:48:04 - INFO - Attempting prediction for arima
2024-09-19 22:48:04 - INFO - ARIMA 예측 시작
2024-09-19 22:48:04 - INFO - 입력 데이터: {'open': 84420000.0, 'high': 84442000.0, 'low': 84014000.0, 'close': 84149000.0, 'volume': 34.87643941, 'value': 2937491058.33898, 'decision': 'sell', 'sma': 83828600.0, 'ema': 83887310.14960851, 'rsi': 62.52500185078582, 'macd': 295491.0589104593, 'signal_line': 282518.1832941531, 'BB_Upper': 84620330.61075294, 'BB_Lower': 83036869.38924706}
2024-09-19 22:48:04 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:48:04 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83828600.0         0         0
2024-09-19 22:48:04 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83828600.0         0         0
2024-09-19 22:48:04 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:48:04 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:48:04 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:48:04 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:48:04 - INFO - Attempting prediction for prophet
2024-09-19 22:48:04 - INFO - PROPHET prediction: 84219584.3155769
2024-09-19 22:48:04 - INFO - Attempting prediction for transformer
2024-09-19 22:48:04 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:48:04 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:48:04 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:48:04 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:48:04 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:48:04 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:48:04 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:48:04 - INFO - X 샘플:
[[ 0.0823115  -0.35322039 -0.35447611  0.0737416   2.02392266  2.01947317
   0.0737416   0.0737416   0.          0.          0.          0.0737416
   0.0737416 ]
 [-0.06734577 -0.78452107 -1.41518466 -1.55851626  0.47929717  0.47296165
  -1.55851626 -1.55851626  0.          0.          0.         -1.55851626
  -1.55851626]
 [-1.12645879 -0.40527392 -0.599255    0.14002618 -0.2362892  -0.2365191
   0.14002618  0.14002618  0.          0.          0.          0.14002618
   0.14002618]
 [-0.93075312 -1.24556662 -0.57205735 -1.59994413 -0.99950486 -1.00203287
  -1.59994413 -1.59994413  0.          0.          0.         -1.59994413
  -1.59994413]
 [-1.57543061 -1.10427847 -1.23386696 -0.25768132 -0.86557911 -0.86874628
  -0.25768132 -0.25768132  0.          0.          0.         -0.25768132
  -0.25768132]
 [-0.02705343 -0.71015888  0.35266293 -0.24939574 -1.02378679 -1.02388253
  -0.24939574 -0.24939574  0.          0.          0.         -0.24939574
  -0.24939574]
 [-0.04432158  1.28274772  1.25018555  1.34143425  1.46237474  1.46836995
   1.34143425  1.34143425  0.          0.          0.          1.34143425
   1.34143425]
 [ 0.53128332  0.58374316  1.44963502  1.60657258 -0.78635356 -0.78288007
   1.60657258  1.60657258  0.          0.          0.          1.60657258
   1.60657258]
 [ 1.80337015  1.58019646  1.34991029  0.67030285  0.15107175  0.15671786
   0.67030285  0.67030285  0.          0.          0.          0.67030285
   0.67030285]
 [ 1.35439833  1.156332   -0.22755372 -0.16654002 -0.2051528  -0.2034618
  -0.16654002 -0.16654002  0.          0.          0.         -0.16654002
  -0.16654002]]
2024-09-19 22:48:04 - INFO - y 샘플:
[-0.16654002]
2024-09-19 22:48:04 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:48:04 - INFO - 모델 출력 (스케일링된 예측): [0.29165187]
2024-09-19 22:48:04 - INFO - 스케일러 역변환 후 예측 가격: 84204299.9648661
2024-09-19 22:48:04 - INFO - TransformerPredictor 최종 예측 가격: 84204299.9648661
2024-09-19 22:48:04 - INFO - TRANSFORMER prediction: 84204299.9648661
2024-09-19 22:48:04 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:48:04 - INFO - BITCOIN_FORECAST prediction: 82996587.00348315
2024-09-19 22:48:04 - INFO - BitcoinForecast prediction: 82996587.00348315
2024-09-19 22:48:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:48:17 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:48:17 - INFO - 조정된 모델 가중치: {'gpt': 0.005269329437550241, 'ml': 0.20905549512393884, 'xgboost': 0.06509983581769158, 'rl': 0.29118038651300193, 'lstm': 0.11027612546488405, 'arima': 0.018955744703460523, 'prophet': 0.07961083200970484, 'transformer': 0.11027612546488405, 'bitcoin_forecast': 0.11027612546488405}
2024-09-19 22:48:17 - INFO - 조정된 모델 가중치: {'gpt': 0.005269329437550241, 'ml': 0.20905549512393884, 'xgboost': 0.06509983581769158, 'rl': 0.29118038651300193, 'lstm': 0.11027612546488405, 'arima': 0.018955744703460523, 'prophet': 0.07961083200970484, 'transformer': 0.11027612546488405, 'bitcoin_forecast': 0.11027612546488405}
2024-09-19 22:48:17 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84192181.66321911, 'current_price': 84086000.0, 'predictions': {'gpt': 84086000.0, 'ml': 84081680.8, 'xgboost': 84149000.0, 'lstm': 84222105.33171023, 'rl': 84926860.0, 'arima': 80899000.0, 'prophet': 84219584.3155769, 'transformer': 84204299.9648661, 'bitcoin_forecast': 82996587.00348315}, 'weights': {'gpt': 0.005269329437550241, 'ml': 0.20905549512393884, 'xgboost': 0.06509983581769158, 'rl': 0.29118038651300193, 'lstm': 0.11027612546488405, 'arima': 0.018955744703460523, 'prophet': 0.07961083200970484, 'transformer': 0.11027612546488405, 'bitcoin_forecast': 0.11027612546488405}}
2024-09-19 22:48:17 - INFO - 모델별 가중치:
2024-09-19 22:48:17 - INFO -   - GPT: 0.0053
2024-09-19 22:48:17 - INFO -   - ML: 0.2091
2024-09-19 22:48:17 - INFO -   - XGBOOST: 0.0651
2024-09-19 22:48:17 - INFO -   - RL: 0.2912
2024-09-19 22:48:17 - INFO -   - LSTM: 0.1103
2024-09-19 22:48:17 - INFO -   - ARIMA: 0.0190
2024-09-19 22:48:17 - INFO -   - PROPHET: 0.0796
2024-09-19 22:48:17 - INFO -   - TRANSFORMER: 0.1103
2024-09-19 22:48:17 - INFO -   - BITCOIN_FORECAST: 0.1103
2024-09-19 22:48:17 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:48:17 - INFO - 6. 거래 실행
2024-09-19 22:48:17 - INFO - Cancelling existing orders.
2024-09-19 22:48:17 - INFO - Cancelled 0 orders.
2024-09-19 22:48:17 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84192181.66321911, 'current_price': 84086000.0, 'predictions': {'gpt': 84086000.0, 'ml': 84081680.8, 'xgboost': 84149000.0, 'lstm': 84222105.33171023, 'rl': 84926860.0, 'arima': 80899000.0, 'prophet': 84219584.3155769, 'transformer': 84204299.9648661, 'bitcoin_forecast': 82996587.00348315}, 'weights': {'gpt': 0.005269329437550241, 'ml': 0.20905549512393884, 'xgboost': 0.06509983581769158, 'rl': 0.29118038651300193, 'lstm': 0.11027612546488405, 'arima': 0.018955744703460523, 'prophet': 0.07961083200970484, 'transformer': 0.11027612546488405, 'bitcoin_forecast': 0.11027612546488405}}, 현재 가격=84086000.0
2024-09-19 22:48:17 - INFO - 현재 잔고: KRW=324885.00780387, BTC=0.00182361, 총 자산가치=478225.07826387
2024-09-19 22:48:17 - INFO - 매수 시도: 0.0005687332947980282 BTC (약 47822.507826387 KRW)
2024-09-19 22:48:17 - INFO - 주문 결과: {'uuid': '9fe0b562-e9ed-47fa-a922-b08d1c03be18', 'side': 'bid', 'ord_type': 'limit', 'price': '84086000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:48:17+09:00', 'volume': '0.00056873', 'remaining_volume': '0.00056873', 'reserved_fee': '23.91111539', 'remaining_fee': '23.91111539', 'paid_fee': '0', 'locked': '47846.14189539', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:48:17 - INFO - buy 주문 성공: UUID=9fe0b562-e9ed-47fa-a922-b08d1c03be18
2024-09-19 22:48:17 - INFO - Trade executed successfully.
2024-09-19 22:48:17 - INFO - 7. summary 리포트 보내기
2024-09-19 22:48:17 - INFO - Message sent to Discord successfully.
2024-09-19 22:48:17 - INFO - Trading cycle completed.
2024-09-19 22:48:17 - INFO - Performing periodic update.
2024-09-19 22:48:17 - INFO - 계산된 시장 변동성: 0.029277744011568234
2024-09-19 22:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:55:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8144-a802-ea82b6955a84 "HTTP/1.1 200 OK"
2024-09-19 22:55:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:55:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817d-9b3e-c1046df48e73 "HTTP/1.1 200 OK"
2024-09-19 22:55:48 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:55:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:55:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-81f0-cb192ccf79f3 "HTTP/1.1 200 OK"
2024-09-19 22:55:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fa-a09e-ca8e377b3755 "HTTP/1.1 200 OK"
2024-09-19 22:56:14 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8191-aeec-ccb4c90d9c15 "HTTP/1.1 200 OK"
2024-09-19 22:56:27 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-950e-d0a2cfb94527 "HTTP/1.1 200 OK"
2024-09-19 22:56:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/2cdb9612-fce6-4211-813a-7fb0ce49c921 "HTTP/1.1 200 OK"
2024-09-19 22:56:42 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-b884-daca3316a441 "HTTP/1.1 200 OK"
2024-09-19 22:56:52 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 22:56:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-ae1d-e8701eb84344 "HTTP/1.1 200 OK"
2024-09-19 22:56:57 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:45:34.941287
2024-09-19 22:56:57 - INFO - Starting trading cycle.
2024-09-19 22:56:57 - INFO - ##################################################
2024-09-19 22:56:57 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-19 22:56:57 - INFO - ##################################################
2024-09-19 22:56:57 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 22:56:57 - INFO - 데이터베이스 업데이트 시작
2024-09-19 22:56:57 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:40:00
2024-09-19 22:56:57 - INFO - 새로운 데이터 범위: 2024-09-18 13:40:00 ~ 2024-09-19 22:50:00
2024-09-19 22:56:57 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 22:56:57 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 22:56:57 - INFO - Index: Index([199], dtype='int64')
2024-09-19 22:56:57 - INFO - Date column data type: datetime64[ns]
2024-09-19 22:56:57 - INFO - Sample date values: [Timestamp('2024-09-19 22:50:00')]
2024-09-19 22:56:58 - INFO - Successfully added 1 new data points
2024-09-19 22:56:58 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 22:56:58 - INFO - Final date range: 2024-09-19 22:50:00 to 2024-09-19 22:50:00
2024-09-19 22:56:58 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 22:56:58 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 22:50:00
2024-09-19 22:56:58 - INFO - 데이터베이스 업데이트 완료
2024-09-19 22:56:58 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 22:56:58 - INFO - GPT | 이전예측가격: 84086000 | 당시BTC가격: 84086000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:56:58 - INFO - ML | 이전예측가격: 84081681 | 당시BTC가격: 84086000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 22:56:58 - INFO - XGBOOST 모델 예측 업데이트: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 22:56:58 - INFO - XGBOOST | 이전예측가격: 84149000 | 당시BTC가격: 84086000 | 예측: 상승 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0687 | 반영가중치값: 0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 119 | 예측 성공 수: 74 | 예측 성공률: 62.18%
2024-09-19 22:56:58 - INFO - LSTM 모델 예측 업데이트: 정확도 41.18%, 적중/전체: 7/17
2024-09-19 22:56:58 - INFO - LSTM | 이전예측가격: 84222105 | 당시BTC가격: 84086000 | 예측: 상승 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0779 | 반영가중치값: 0.0200 | 새 가중치: 0.0979 | 예측 총 횟수: 17 | 예측 성공 수: 7 | 예측 성공률: 41.18%
2024-09-19 22:56:58 - INFO - RL 모델 예측 업데이트: 정확도 64.86%, 적중/전체: 24/37
2024-09-19 22:56:58 - INFO - RL | 이전예측가격: 84926860 | 당시BTC가격: 84086000 | 예측: 상승 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1662 | 반영가중치값: 0.0200 | 새 가중치: 0.1862 | 예측 총 횟수: 37 | 예측 성공 수: 24 | 예측 성공률: 64.86%
2024-09-19 22:56:58 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.40%, 적중/전체: 120/229
2024-09-19 22:56:58 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84086000 | 예측: 하락 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1181 | 반영가중치값: -0.0200 | 새 가중치: 0.0981 | 예측 총 횟수: 229 | 예측 성공 수: 120 | 예측 성공률: 52.40%
2024-09-19 22:56:58 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 21/33
2024-09-19 22:56:58 - INFO - PROPHET | 이전예측가격: 84219584 | 당시BTC가격: 84086000 | 예측: 상승 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1538 | 반영가중치값: 0.0200 | 새 가중치: 0.1738 | 예측 총 횟수: 33 | 예측 성공 수: 21 | 예측 성공률: 63.64%
2024-09-19 22:56:58 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 41.18%, 적중/전체: 7/17
2024-09-19 22:56:58 - INFO - TRANSFORMER | 이전예측가격: 84204300 | 당시BTC가격: 84086000 | 예측: 상승 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1073 | 반영가중치값: 0.0200 | 새 가중치: 0.1273 | 예측 총 횟수: 17 | 예측 성공 수: 7 | 예측 성공률: 41.18%
2024-09-19 22:56:58 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 29.41%, 적중/전체: 5/17
2024-09-19 22:56:58 - INFO - BITCOIN_FORECAST | 이전예측가격: 82996587 | 당시BTC가격: 84086000 | 예측: 하락 | 지금 BTC가격: 84182000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0856 | 반영가중치값: -0.0200 | 새 가중치: 0.0656 | 예측 총 횟수: 17 | 예측 성공 수: 5 | 예측 성공률: 29.41%
2024-09-19 22:56:58 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 22:56:58 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 22:56:58 - INFO - 새로운 가중치: {'gpt': 0.005008830051885842, 'ml': 0.19872043661317862, 'xgboost': 0.08430175999398501, 'rl': 0.17700337884439904, 'lstm': 0.0930771466812052, 'arima': 0.09322171441056021, 'prophet': 0.1652328086464204, 'transformer': 0.12103456920219083, 'bitcoin_forecast': 0.062399355556174846}
2024-09-19 22:56:58 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 22:56:58 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 22:56:58 - INFO - Current BTC price: 84182000.0
2024-09-19 22:56:58 - INFO - Analyzing market conditions.
2024-09-19 22:56:58 - INFO - Market analysis: {'current_price': 84182000.0, 'sma_20': 83871750.0, 'rsi_14': 63.29533078789752, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 22:56:58 - INFO - Starting predictions for all models
2024-09-19 22:56:58 - INFO - Attempting prediction for gpt
2024-09-19 22:56:59 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 22:56:59 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:56:59 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 22:56:59 - INFO - GPT prediction: 84182000.0
2024-09-19 22:56:59 - INFO - Attempting prediction for ml
2024-09-19 22:56:59 - INFO - ML prediction: 84131490.8
2024-09-19 22:56:59 - INFO - Attempting prediction for xgboost
2024-09-19 22:56:59 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 22:56:59 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:56:59 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 22:56:59 - INFO - XGBOOST prediction: 84182000.0
2024-09-19 22:56:59 - INFO - Attempting prediction for lstm
2024-09-19 22:56:59 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:56:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:56:59 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 22:56:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:56:59 - INFO - X 샘플:
[[ 0.01684792 -0.73870762 -1.08587748 -1.56137179  0.67686439  0.67069368
  -1.56137179]
 [-1.01649147 -0.36569684 -0.38076223  0.1366718  -0.17357182 -0.17307932
   0.1366718 ]
 [-0.82554832 -1.1921717  -0.35725839 -1.60278749 -1.08061288 -1.08349141
  -1.60278749]
 [-1.45453752 -1.0532069  -0.92918521 -0.26091889 -0.92144928 -0.92497601
  -0.26091889]
 [ 0.05615975 -0.66556825  0.44187222 -0.25263575 -1.10947067 -1.10947682
  -0.25263575]
 [ 0.03931182  1.29456682  1.217499    1.33772702  1.8451996   1.8545153
   1.33772702]
 [ 0.60090932  0.60705676  1.3898605   1.60278749 -0.82729395 -0.82285683
   1.60278749]
 [ 1.84203979  1.58712429  1.30367975  0.66679273  0.286786    0.29459049
   0.66679273]
 [ 1.40399374  1.17022989 -0.05954307 -0.16980436 -0.13656787 -0.13376485
  -0.16980436]
 [-0.66268505 -0.64362644 -1.54028509  0.10353924  1.44011648  1.42784577
   0.10353924]]
2024-09-19 22:56:59 - INFO - y 샘플:
[0.10353924]
2024-09-19 22:56:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 22:56:59 - INFO - 모델 출력 (스케일링된 예측): [[0.38015616]]
2024-09-19 22:56:59 - INFO - 스케일러 역변환 후 예측 가격: 84215395.17794979
2024-09-19 22:56:59 - INFO - LSTMPredictor 최종 예측 가격: 84215395.17794979
2024-09-19 22:56:59 - INFO - LSTM prediction: 84215395.17794979
2024-09-19 22:56:59 - INFO - Attempting prediction for rl
2024-09-19 22:56:59 - INFO - Preparing state for RL agent.
2024-09-19 22:56:59 - INFO - Prepared state: [[8.41820000e+07 5.14882644e+01 3.92161523e-04 8.38717500e+07
  6.32953308e+01]]
2024-09-19 22:56:59 - INFO - RL prediction: 85023820.0
2024-09-19 22:56:59 - INFO - Attempting prediction for arima
2024-09-19 22:56:59 - INFO - ARIMA 예측 시작
2024-09-19 22:56:59 - INFO - 입력 데이터: {'open': 84052000.0, 'high': 84194000.0, 'low': 83825000.0, 'close': 84182000.0, 'volume': 51.4882644, 'value': 4322776670.5824, 'decision': 'sell', 'sma': 83871750.0, 'ema': 83915375.8496458, 'rsi': 63.29533078789752, 'macd': 282694.3356746882, 'signal_line': 282553.4137702601, 'BB_Upper': 84641444.45236614, 'BB_Lower': 83102055.54763386}
2024-09-19 22:56:59 - INFO - Exogenous 변수 예측 시작
2024-09-19 22:56:59 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83871750.0         0         0
2024-09-19 22:56:59 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83871750.0         0         0
2024-09-19 22:56:59 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 22:56:59 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 22:56:59 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 22:56:59 - INFO - ARIMA prediction: 80899000.0
2024-09-19 22:56:59 - INFO - Attempting prediction for prophet
2024-09-19 22:56:59 - INFO - PROPHET prediction: 84265692.55326633
2024-09-19 22:56:59 - INFO - Attempting prediction for transformer
2024-09-19 22:56:59 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 22:56:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 22:56:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 22:56:59 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 22:56:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 22:56:59 - INFO - X 샘플:
[[ 0.01684792 -0.73870762 -1.08587748 -1.56137179  0.67686439  0.67069368
  -1.56137179 -1.56137179  0.          0.          0.         -1.56137179
  -1.56137179]
 [-1.01649147 -0.36569684 -0.38076223  0.1366718  -0.17357182 -0.17307932
   0.1366718   0.1366718   0.          0.          0.          0.1366718
   0.1366718 ]
 [-0.82554832 -1.1921717  -0.35725839 -1.60278749 -1.08061288 -1.08349141
  -1.60278749 -1.60278749  0.          0.          0.         -1.60278749
  -1.60278749]
 [-1.45453752 -1.0532069  -0.92918521 -0.26091889 -0.92144928 -0.92497601
  -0.26091889 -0.26091889  0.          0.          0.         -0.26091889
  -0.26091889]
 [ 0.05615975 -0.66556825  0.44187222 -0.25263575 -1.10947067 -1.10947682
  -0.25263575 -0.25263575  0.          0.          0.         -0.25263575
  -0.25263575]
 [ 0.03931182  1.29456682  1.217499    1.33772702  1.8451996   1.8545153
   1.33772702  1.33772702  0.          0.          0.          1.33772702
   1.33772702]
 [ 0.60090932  0.60705676  1.3898605   1.60278749 -0.82729395 -0.82285683
   1.60278749  1.60278749  0.          0.          0.          1.60278749
   1.60278749]
 [ 1.84203979  1.58712429  1.30367975  0.66679273  0.286786    0.29459049
   0.66679273  0.66679273  0.          0.          0.          0.66679273
   0.66679273]
 [ 1.40399374  1.17022989 -0.05954307 -0.16980436 -0.13656787 -0.13376485
  -0.16980436 -0.16980436  0.          0.          0.         -0.16980436
  -0.16980436]
 [-0.66268505 -0.64362644 -1.54028509  0.10353924  1.44011648  1.42784577
   0.10353924  0.10353924  0.          0.          0.          0.10353924
   0.10353924]]
2024-09-19 22:56:59 - INFO - y 샘플:
[0.10353924]
2024-09-19 22:56:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 22:56:59 - INFO - 모델 출력 (스케일링된 예측): [0.29139403]
2024-09-19 22:56:59 - INFO - 스케일러 역변환 후 예측 가격: 84204679.17651515
2024-09-19 22:56:59 - INFO - TransformerPredictor 최종 예측 가격: 84204679.17651515
2024-09-19 22:56:59 - INFO - TRANSFORMER prediction: 84204679.17651515
2024-09-19 22:56:59 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 22:56:59 - INFO - BITCOIN_FORECAST prediction: 83135609.4865018
2024-09-19 22:56:59 - INFO - BitcoinForecast prediction: 83135609.4865018
2024-09-19 22:57:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 22:57:09 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 22:57:09 - INFO - 조정된 모델 가중치: {'gpt': 0.005008830051885842, 'ml': 0.19872043661317862, 'xgboost': 0.08430175999398501, 'rl': 0.17700337884439904, 'lstm': 0.0930771466812052, 'arima': 0.09322171441056021, 'prophet': 0.1652328086464204, 'transformer': 0.12103456920219083, 'bitcoin_forecast': 0.062399355556174846}
2024-09-19 22:57:09 - INFO - 조정된 모델 가중치: {'gpt': 0.005008830051885842, 'ml': 0.19872043661317862, 'xgboost': 0.08430175999398501, 'rl': 0.17700337884439904, 'lstm': 0.0930771466812052, 'arima': 0.09322171441056021, 'prophet': 0.1652328086464204, 'transformer': 0.12103456920219083, 'bitcoin_forecast': 0.062399355556174846}
2024-09-19 22:57:09 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83969308.83986439, 'current_price': 84182000.0, 'predictions': {'gpt': 84182000.0, 'ml': 84131490.8, 'xgboost': 84182000.0, 'lstm': 84215395.17794979, 'rl': 85023820.0, 'arima': 80899000.0, 'prophet': 84265692.55326633, 'transformer': 84204679.17651515, 'bitcoin_forecast': 83135609.4865018}, 'weights': {'gpt': 0.005008830051885842, 'ml': 0.19872043661317862, 'xgboost': 0.08430175999398501, 'rl': 0.17700337884439904, 'lstm': 0.0930771466812052, 'arima': 0.09322171441056021, 'prophet': 0.1652328086464204, 'transformer': 0.12103456920219083, 'bitcoin_forecast': 0.062399355556174846}}
2024-09-19 22:57:09 - INFO - 모델별 가중치:
2024-09-19 22:57:09 - INFO -   - GPT: 0.0050
2024-09-19 22:57:09 - INFO -   - ML: 0.1987
2024-09-19 22:57:09 - INFO -   - XGBOOST: 0.0843
2024-09-19 22:57:09 - INFO -   - RL: 0.1770
2024-09-19 22:57:09 - INFO -   - LSTM: 0.0931
2024-09-19 22:57:09 - INFO -   - ARIMA: 0.0932
2024-09-19 22:57:09 - INFO -   - PROPHET: 0.1652
2024-09-19 22:57:09 - INFO -   - TRANSFORMER: 0.1210
2024-09-19 22:57:09 - INFO -   - BITCOIN_FORECAST: 0.0624
2024-09-19 22:57:09 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 22:57:09 - INFO - 6. 거래 실행
2024-09-19 22:57:09 - INFO - Cancelling existing orders.
2024-09-19 22:57:09 - INFO - Cancelled 0 orders.
2024-09-19 22:57:09 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83969308.83986439, 'current_price': 84182000.0, 'predictions': {'gpt': 84182000.0, 'ml': 84131490.8, 'xgboost': 84182000.0, 'lstm': 84215395.17794979, 'rl': 85023820.0, 'arima': 80899000.0, 'prophet': 84265692.55326633, 'transformer': 84204679.17651515, 'bitcoin_forecast': 83135609.4865018}, 'weights': {'gpt': 0.005008830051885842, 'ml': 0.19872043661317862, 'xgboost': 0.08430175999398501, 'rl': 0.17700337884439904, 'lstm': 0.0930771466812052, 'arima': 0.09322171441056021, 'prophet': 0.1652328086464204, 'transformer': 0.12103456920219083, 'bitcoin_forecast': 0.062399355556174846}}, 현재 가격=84182000.0
2024-09-19 22:57:09 - INFO - 현재 잔고: KRW=277038.86590848, BTC=0.00239234, 총 자산가치=478430.83178848005
2024-09-19 22:57:09 - INFO - 매도 시도: 0.00023923400000000003 BTC (약 20139.196588000003 KRW)
2024-09-19 22:57:09 - INFO - 주문 결과: {'uuid': 'da8d39fc-301b-41e1-ae23-45d48607298d', 'side': 'ask', 'ord_type': 'limit', 'price': '84182000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T22:57:10+09:00', 'volume': '0.00023923', 'remaining_volume': '0.00023923', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00023923', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 22:57:09 - INFO - sell 주문 성공: UUID=da8d39fc-301b-41e1-ae23-45d48607298d
2024-09-19 22:57:09 - INFO - Trade executed successfully.
2024-09-19 22:57:09 - INFO - 7. summary 리포트 보내기
2024-09-19 22:57:10 - INFO - Message sent to Discord successfully.
2024-09-19 22:57:10 - INFO - Trading cycle completed.
2024-09-19 22:57:10 - INFO - Performing periodic update.
2024-09-19 22:57:10 - INFO - 계산된 시장 변동성: 0.029192446756829478
2024-09-19 23:05:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:05:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-a067-f9db13d210ce "HTTP/1.1 200 OK"
2024-09-19 23:05:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:05:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:05:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-b9f7-c457d6369e54 "HTTP/1.1 200 OK"
2024-09-19 23:05:51 - INFO - Updated actual price for ml prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:05:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:05:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ea-9ad4-cafd5e596ba9 "HTTP/1.1 200 OK"
2024-09-19 23:05:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f4-9d5c-c2a45b633e6d "HTTP/1.1 200 OK"
2024-09-19 23:06:08 - INFO - Updated actual price for lstm prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d8-9c31-dcbb740b63b5 "HTTP/1.1 200 OK"
2024-09-19 23:06:15 - INFO - Updated actual price for rl prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e6-9fbe-df2419da2a7d "HTTP/1.1 200 OK"
2024-09-19 23:06:23 - INFO - Updated actual price for arima prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b3-a0a0-d5b946d1d236 "HTTP/1.1 200 OK"
2024-09-19 23:06:33 - INFO - Updated actual price for prophet prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8191-951c-ede8ba6eec67 "HTTP/1.1 200 OK"
2024-09-19 23:06:44 - INFO - Updated actual price for transformer prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:06:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-be1f-d5cfe7047cc0 "HTTP/1.1 200 OK"
2024-09-19 23:06:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 22:55:34.941652
2024-09-19 23:06:53 - INFO - Starting trading cycle.
2024-09-19 23:06:53 - INFO - ##################################################
2024-09-19 23:06:53 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-19 23:06:53 - INFO - ##################################################
2024-09-19 23:06:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:06:53 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:06:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 22:50:00
2024-09-19 23:06:53 - INFO - 새로운 데이터 범위: 2024-09-18 13:50:00 ~ 2024-09-19 23:00:00
2024-09-19 23:06:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:06:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:06:53 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:06:53 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:06:53 - INFO - Sample date values: [Timestamp('2024-09-19 23:00:00')]
2024-09-19 23:06:54 - INFO - Successfully added 1 new data points
2024-09-19 23:06:54 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:06:54 - INFO - Final date range: 2024-09-19 23:00:00 to 2024-09-19 23:00:00
2024-09-19 23:06:54 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:06:54 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:00:00
2024-09-19 23:06:54 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:06:54 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:06:54 - INFO - GPT | 이전예측가격: 84182000 | 당시BTC가격: 84182000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:06:54 - INFO - ML 모델 예측 업데이트: 정확도 45.71%, 적중/전체: 16/35
2024-09-19 23:06:54 - INFO - ML | 이전예측가격: 84131491 | 당시BTC가격: 84182000 | 예측: 하락 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2091 | 반영가중치값: -0.0200 | 새 가중치: 0.1891 | 예측 총 횟수: 35 | 예측 성공 수: 16 | 예측 성공률: 45.71%
2024-09-19 23:06:54 - INFO - XGBOOST | 이전예측가격: 84182000 | 당시BTC가격: 84182000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:06:54 - INFO - LSTM 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 8/18
2024-09-19 23:06:54 - INFO - LSTM | 이전예측가격: 84215395 | 당시BTC가격: 84182000 | 예측: 상승 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1103 | 반영가중치값: 0.0200 | 새 가중치: 0.1303 | 예측 총 횟수: 18 | 예측 성공 수: 8 | 예측 성공률: 44.44%
2024-09-19 23:06:54 - INFO - RL 모델 예측 업데이트: 정확도 65.79%, 적중/전체: 25/38
2024-09-19 23:06:54 - INFO - RL | 이전예측가격: 85023820 | 당시BTC가격: 84182000 | 예측: 상승 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2912 | 반영가중치값: 0.0200 | 새 가중치: 0.3112 | 예측 총 횟수: 38 | 예측 성공 수: 25 | 예측 성공률: 65.79%
2024-09-19 23:06:54 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.17%, 적중/전체: 120/230
2024-09-19 23:06:54 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84182000 | 예측: 하락 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0190 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 230 | 예측 성공 수: 120 | 예측 성공률: 52.17%
2024-09-19 23:06:54 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.71%, 적중/전체: 22/34
2024-09-19 23:06:54 - INFO - PROPHET | 이전예측가격: 84265693 | 당시BTC가격: 84182000 | 예측: 상승 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0796 | 반영가중치값: 0.0200 | 새 가중치: 0.0996 | 예측 총 횟수: 34 | 예측 성공 수: 22 | 예측 성공률: 64.71%
2024-09-19 23:06:54 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 8/18
2024-09-19 23:06:54 - INFO - TRANSFORMER | 이전예측가격: 84204679 | 당시BTC가격: 84182000 | 예측: 상승 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1103 | 반영가중치값: 0.0200 | 새 가중치: 0.1303 | 예측 총 횟수: 18 | 예측 성공 수: 8 | 예측 성공률: 44.44%
2024-09-19 23:06:54 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 27.78%, 적중/전체: 5/18
2024-09-19 23:06:54 - INFO - BITCOIN_FORECAST | 이전예측가격: 83135609 | 당시BTC가격: 84182000 | 예측: 하락 | 지금 BTC가격: 84470000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1103 | 반영가중치값: -0.0200 | 새 가중치: 0.0903 | 예측 총 횟수: 18 | 예측 성공 수: 5 | 예측 성공률: 27.78%
2024-09-19 23:06:54 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:06:54 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:06:54 - INFO - 새로운 가중치: {'gpt': 0.004816249057838966, 'ml': 0.18178663297372785, 'xgboost': 0.08106050074354781, 'rl': 0.2992160300581444, 'lstm': 0.12526723007759558, 'arima': 0.0, 'prophet': 0.09578096498535996, 'transformer': 0.12526723007759558, 'bitcoin_forecast': 0.08680516202618999}
2024-09-19 23:06:54 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:06:54 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:06:54 - INFO - Current BTC price: 84470000.0
2024-09-19 23:06:54 - INFO - Analyzing market conditions.
2024-09-19 23:06:54 - INFO - Market analysis: {'current_price': 84470000.0, 'sma_20': 83928250.0, 'rsi_14': 69.238353621536, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 23:06:54 - INFO - Starting predictions for all models
2024-09-19 23:06:54 - INFO - Attempting prediction for gpt
2024-09-19 23:06:55 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:06:55 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:06:55 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:06:55 - INFO - GPT prediction: 84470000.0
2024-09-19 23:06:55 - INFO - Attempting prediction for ml
2024-09-19 23:06:55 - INFO - ML prediction: 84419318.0
2024-09-19 23:06:55 - INFO - Attempting prediction for xgboost
2024-09-19 23:06:55 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:06:55 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:06:55 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:06:55 - INFO - XGBOOST prediction: 84470000.0
2024-09-19 23:06:55 - INFO - Attempting prediction for lstm
2024-09-19 23:06:55 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:06:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:06:55 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:06:55 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:06:55 - INFO - X 샘플:
[[-1.06234142 -0.56032629 -0.63253235 -0.24380454 -0.16087089 -0.16204717
  -0.24380454]
 [-0.8757732  -1.33060452 -0.61149469 -1.82401916 -1.07585945 -1.07940808
  -1.82401916]
 [-1.49035088 -1.20108871 -1.12341111 -0.60499645 -0.91530125 -0.9196828
  -0.60499645]
 [-0.01426698 -0.83980777  0.1037858  -0.59747162 -1.10497008 -1.10559183
  -0.59747162]
 [-0.03072888  0.98704679  0.79802862  0.84729603  1.87558902  1.88102329
   0.84729603]
 [ 0.51800119  0.34628437  0.9523048   1.08809064 -0.82032093 -0.81678418
   1.08809064]
 [ 1.73069465  1.25971165  0.87516671  0.23778468  0.30352059  0.30919218
   0.23778468]
 [ 1.30268519  0.87116423 -0.34501764 -0.52222331 -0.12354271 -0.12243263
  -0.52222331]
 [-0.71664148 -0.8193579  -1.6703903  -0.27390387  1.46695655  1.45109716
  -0.27390387]
 [ 0.6387218   1.28697814  1.65356017  1.89324761  0.55479914  0.56463407
   1.89324761]]
2024-09-19 23:06:55 - INFO - y 샘플:
[1.89324761]
2024-09-19 23:06:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:06:55 - INFO - 모델 출력 (스케일링된 예측): [[0.3932498]]
2024-09-19 23:06:55 - INFO - 스케일러 역변환 후 예측 가격: 84270660.2809427
2024-09-19 23:06:55 - INFO - LSTMPredictor 최종 예측 가격: 84270660.2809427
2024-09-19 23:06:55 - INFO - LSTM prediction: 84270660.2809427
2024-09-19 23:06:55 - INFO - Attempting prediction for rl
2024-09-19 23:06:55 - INFO - Preparing state for RL agent.
2024-09-19 23:06:55 - INFO - Prepared state: [[8.44700000e+07 4.19613193e+01 3.42115892e-03 8.39282500e+07
  6.92383536e+01]]
2024-09-19 23:06:55 - INFO - RL prediction: 85314700.0
2024-09-19 23:06:55 - INFO - Attempting prediction for arima
2024-09-19 23:06:55 - INFO - ARIMA 예측 시작
2024-09-19 23:06:55 - INFO - 입력 데이터: {'open': 84299000.0, 'high': 84503000.0, 'low': 84299000.0, 'close': 84470000.0, 'volume': 41.96131925, 'value': 3542362746.44828, 'decision': 'sell', 'sma': 83928250.0, 'ema': 83968197.19729859, 'rsi': 69.238353621536, 'macd': 292421.18401505053, 'signal_line': 284526.9678192182, 'BB_Upper': 84699411.16992599, 'BB_Lower': 83157088.83007401}
2024-09-19 23:06:55 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:06:55 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83928250.0         0         0
2024-09-19 23:06:55 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83928250.0         0         0
2024-09-19 23:06:55 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:06:55 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:06:55 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:06:55 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:06:55 - INFO - Attempting prediction for prophet
2024-09-19 23:06:55 - INFO - PROPHET prediction: 84580626.49015886
2024-09-19 23:06:55 - INFO - Attempting prediction for transformer
2024-09-19 23:06:55 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:06:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:06:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:06:55 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:06:55 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:06:55 - INFO - X 샘플:
[[-1.06234142 -0.56032629 -0.63253235 -0.24380454 -0.16087089 -0.16204717
  -0.24380454 -0.24380454  0.          0.          0.         -0.24380454
  -0.24380454]
 [-0.8757732  -1.33060452 -0.61149469 -1.82401916 -1.07585945 -1.07940808
  -1.82401916 -1.82401916  0.          0.          0.         -1.82401916
  -1.82401916]
 [-1.49035088 -1.20108871 -1.12341111 -0.60499645 -0.91530125 -0.9196828
  -0.60499645 -0.60499645  0.          0.          0.         -0.60499645
  -0.60499645]
 [-0.01426698 -0.83980777  0.1037858  -0.59747162 -1.10497008 -1.10559183
  -0.59747162 -0.59747162  0.          0.          0.         -0.59747162
  -0.59747162]
 [-0.03072888  0.98704679  0.79802862  0.84729603  1.87558902  1.88102329
   0.84729603  0.84729603  0.          0.          0.          0.84729603
   0.84729603]
 [ 0.51800119  0.34628437  0.9523048   1.08809064 -0.82032093 -0.81678418
   1.08809064  1.08809064  0.          0.          0.          1.08809064
   1.08809064]
 [ 1.73069465  1.25971165  0.87516671  0.23778468  0.30352059  0.30919218
   0.23778468  0.23778468  0.          0.          0.          0.23778468
   0.23778468]
 [ 1.30268519  0.87116423 -0.34501764 -0.52222331 -0.12354271 -0.12243263
  -0.52222331 -0.52222331  0.          0.          0.         -0.52222331
  -0.52222331]
 [-0.71664148 -0.8193579  -1.6703903  -0.27390387  1.46695655  1.45109716
  -0.27390387 -0.27390387  0.          0.          0.         -0.27390387
  -0.27390387]
 [ 0.6387218   1.28697814  1.65356017  1.89324761  0.55479914  0.56463407
   1.89324761  1.89324761  0.          0.          0.          1.89324761
   1.89324761]]
2024-09-19 23:06:55 - INFO - y 샘플:
[1.89324761]
2024-09-19 23:06:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:06:55 - INFO - 모델 출력 (스케일링된 예측): [0.29188964]
2024-09-19 23:06:55 - INFO - 스케일러 역변환 후 예측 가격: 84257190.18906817
2024-09-19 23:06:55 - INFO - TransformerPredictor 최종 예측 가격: 84257190.18906817
2024-09-19 23:06:55 - INFO - TRANSFORMER prediction: 84257190.18906817
2024-09-19 23:06:55 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:06:55 - INFO - BITCOIN_FORECAST prediction: 83059655.4712907
2024-09-19 23:06:55 - INFO - BitcoinForecast prediction: 83059655.4712907
2024-09-19 23:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:07:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:07:04 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:07:04 - INFO - 조정된 모델 가중치: {'gpt': 0.004816249057838966, 'ml': 0.18178663297372785, 'xgboost': 0.08106050074354781, 'rl': 0.2992160300581444, 'lstm': 0.12526723007759558, 'arima': 0.0, 'prophet': 0.09578096498535996, 'transformer': 0.12526723007759558, 'bitcoin_forecast': 0.08680516202618999}
2024-09-19 23:07:04 - INFO - 조정된 모델 가중치: {'gpt': 0.004816249057838966, 'ml': 0.18178663297372785, 'xgboost': 0.08106050074354781, 'rl': 0.2992160300581444, 'lstm': 0.12526723007759558, 'arima': 0.0, 'prophet': 0.09578096498535996, 'transformer': 0.12526723007759558, 'bitcoin_forecast': 0.08680516202618999}
2024-09-19 23:07:04 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84550076.36711122, 'current_price': 84470000.0, 'predictions': {'gpt': 84470000.0, 'ml': 84419318.0, 'xgboost': 84470000.0, 'lstm': 84270660.2809427, 'rl': 85314700.0, 'arima': 80899000.0, 'prophet': 84580626.49015886, 'transformer': 84257190.18906817, 'bitcoin_forecast': 83059655.4712907}, 'weights': {'gpt': 0.004816249057838966, 'ml': 0.18178663297372785, 'xgboost': 0.08106050074354781, 'rl': 0.2992160300581444, 'lstm': 0.12526723007759558, 'arima': 0.0, 'prophet': 0.09578096498535996, 'transformer': 0.12526723007759558, 'bitcoin_forecast': 0.08680516202618999}}
2024-09-19 23:07:04 - INFO - 모델별 가중치:
2024-09-19 23:07:04 - INFO -   - GPT: 0.0048
2024-09-19 23:07:04 - INFO -   - ML: 0.1818
2024-09-19 23:07:04 - INFO -   - XGBOOST: 0.0811
2024-09-19 23:07:04 - INFO -   - RL: 0.2992
2024-09-19 23:07:04 - INFO -   - LSTM: 0.1253
2024-09-19 23:07:04 - INFO -   - ARIMA: 0.0000
2024-09-19 23:07:04 - INFO -   - PROPHET: 0.0958
2024-09-19 23:07:04 - INFO -   - TRANSFORMER: 0.1253
2024-09-19 23:07:04 - INFO -   - BITCOIN_FORECAST: 0.0868
2024-09-19 23:07:04 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:07:04 - INFO - 6. 거래 실행
2024-09-19 23:07:04 - INFO - Cancelling existing orders.
2024-09-19 23:07:04 - INFO - Cancelled 0 orders.
2024-09-19 23:07:04 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84550076.36711122, 'current_price': 84470000.0, 'predictions': {'gpt': 84470000.0, 'ml': 84419318.0, 'xgboost': 84470000.0, 'lstm': 84270660.2809427, 'rl': 85314700.0, 'arima': 80899000.0, 'prophet': 84580626.49015886, 'transformer': 84257190.18906817, 'bitcoin_forecast': 83059655.4712907}, 'weights': {'gpt': 0.004816249057838966, 'ml': 0.18178663297372785, 'xgboost': 0.08106050074354781, 'rl': 0.2992160300581444, 'lstm': 0.12526723007759558, 'arima': 0.0, 'prophet': 0.09578096498535996, 'transformer': 0.12526723007759558, 'bitcoin_forecast': 0.08680516202618999}}, 현재 가격=84470000.0
2024-09-19 23:07:04 - INFO - 현재 잔고: KRW=297167.65633855, BTC=0.00215311, 총 자산가치=479040.85803855
2024-09-19 23:07:04 - INFO - 매수 시도: 0.0005671136001403458 BTC (약 47904.08580385501 KRW)
2024-09-19 23:07:04 - INFO - 주문 결과: {'uuid': '7c4db396-fc38-424c-8b78-04bf63b4494a', 'side': 'bid', 'ord_type': 'limit', 'price': '84470000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:07:05+09:00', 'volume': '0.00056711', 'remaining_volume': '0.00056711', 'reserved_fee': '23.95189085', 'remaining_fee': '23.95189085', 'paid_fee': '0', 'locked': '47927.73359085', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:07:04 - INFO - buy 주문 성공: UUID=7c4db396-fc38-424c-8b78-04bf63b4494a
2024-09-19 23:07:04 - INFO - Trade executed successfully.
2024-09-19 23:07:04 - INFO - 7. summary 리포트 보내기
2024-09-19 23:07:05 - INFO - Message sent to Discord successfully.
2024-09-19 23:07:05 - INFO - Trading cycle completed.
2024-09-19 23:07:05 - INFO - Performing periodic update.
2024-09-19 23:07:05 - INFO - 계산된 시장 변동성: 0.029565084777080787
2024-09-19 23:15:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:15:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8102-aade-cbcdf05b995a "HTTP/1.1 200 OK"
2024-09-19 23:15:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:15:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:15:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-84d6-f2bc10e03c8f "HTTP/1.1 200 OK"
2024-09-19 23:15:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-8368-e5189c7135d6 "HTTP/1.1 200 OK"
2024-09-19 23:16:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/43882b3c-45ea-4b60-bd5b-b36bf6a00685 "HTTP/1.1 200 OK"
2024-09-19 23:16:16 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e9-8c90-db351b0afe22 "HTTP/1.1 200 OK"
2024-09-19 23:16:24 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bb-8af2-c403f279dc4e "HTTP/1.1 200 OK"
2024-09-19 23:16:34 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8133-a8fd-d677c78ece4c "HTTP/1.1 200 OK"
2024-09-19 23:16:44 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:16:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814c-a505-ceb1a3edbee3 "HTTP/1.1 200 OK"
2024-09-19 23:16:54 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:17:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-912c-e8edcc4e0be9 "HTTP/1.1 200 OK"
2024-09-19 23:17:00 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:05:34.941769
2024-09-19 23:17:00 - INFO - Starting trading cycle.
2024-09-19 23:17:00 - INFO - ##################################################
2024-09-19 23:17:00 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-19 23:17:00 - INFO - ##################################################
2024-09-19 23:17:00 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:17:00 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:17:00 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:00:00
2024-09-19 23:17:00 - INFO - 새로운 데이터 범위: 2024-09-18 14:00:00 ~ 2024-09-19 23:10:00
2024-09-19 23:17:00 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:17:00 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:17:00 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:17:00 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:17:00 - INFO - Sample date values: [Timestamp('2024-09-19 23:10:00')]
2024-09-19 23:17:01 - INFO - Successfully added 1 new data points
2024-09-19 23:17:01 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:17:01 - INFO - Final date range: 2024-09-19 23:10:00 to 2024-09-19 23:10:00
2024-09-19 23:17:01 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:17:01 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:10:00
2024-09-19 23:17:01 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:17:01 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:17:01 - INFO - GPT | 이전예측가격: 84470000 | 당시BTC가격: 84470000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:17:01 - INFO - ML 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 16/36
2024-09-19 23:17:01 - INFO - ML | 이전예측가격: 84419318 | 당시BTC가격: 84470000 | 예측: 하락 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1987 | 반영가중치값: -0.0200 | 새 가중치: 0.1787 | 예측 총 횟수: 36 | 예측 성공 수: 16 | 예측 성공률: 44.44%
2024-09-19 23:17:01 - INFO - XGBOOST | 이전예측가격: 84470000 | 당시BTC가격: 84470000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:17:01 - INFO - LSTM 모델 예측 업데이트: 정확도 42.11%, 적중/전체: 8/19
2024-09-19 23:17:01 - INFO - LSTM | 이전예측가격: 84270660 | 당시BTC가격: 84470000 | 예측: 하락 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0931 | 반영가중치값: -0.0200 | 새 가중치: 0.0731 | 예측 총 횟수: 19 | 예측 성공 수: 8 | 예측 성공률: 42.11%
2024-09-19 23:17:01 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 26/39
2024-09-19 23:17:01 - INFO - RL | 이전예측가격: 85314700 | 당시BTC가격: 84470000 | 예측: 상승 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1770 | 반영가중치값: 0.0200 | 새 가중치: 0.1970 | 예측 총 횟수: 39 | 예측 성공 수: 26 | 예측 성공률: 66.67%
2024-09-19 23:17:01 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.95%, 적중/전체: 120/231
2024-09-19 23:17:01 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84470000 | 예측: 하락 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0932 | 반영가중치값: -0.0200 | 새 가중치: 0.0732 | 예측 총 횟수: 231 | 예측 성공 수: 120 | 예측 성공률: 51.95%
2024-09-19 23:17:01 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.71%, 적중/전체: 23/35
2024-09-19 23:17:01 - INFO - PROPHET | 이전예측가격: 84580626 | 당시BTC가격: 84470000 | 예측: 상승 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1652 | 반영가중치값: 0.0200 | 새 가중치: 0.1852 | 예측 총 횟수: 35 | 예측 성공 수: 23 | 예측 성공률: 65.71%
2024-09-19 23:17:01 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 42.11%, 적중/전체: 8/19
2024-09-19 23:17:01 - INFO - TRANSFORMER | 이전예측가격: 84257190 | 당시BTC가격: 84470000 | 예측: 하락 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1210 | 반영가중치값: -0.0200 | 새 가중치: 0.1010 | 예측 총 횟수: 19 | 예측 성공 수: 8 | 예측 성공률: 42.11%
2024-09-19 23:17:01 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 26.32%, 적중/전체: 5/19
2024-09-19 23:17:01 - INFO - BITCOIN_FORECAST | 이전예측가격: 83059655 | 당시BTC가격: 84470000 | 예측: 하락 | 지금 BTC가격: 84544000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0624 | 반영가중치값: -0.0200 | 새 가중치: 0.0424 | 예측 총 횟수: 19 | 예측 성공 수: 5 | 예측 성공률: 26.32%
2024-09-19 23:17:01 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:17:01 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:17:01 - INFO - 새로운 가중치: {'gpt': 0.005142454708267716, 'ml': 0.19082521266819244, 'xgboost': 0.08655074700190758, 'rl': 0.21034646275904886, 'lstm': 0.07802667854268991, 'arima': 0.07818103787742472, 'prophet': 0.19777866914898368, 'transformer': 0.1078776636864236, 'bitcoin_forecast': 0.04527107360706146}
2024-09-19 23:17:01 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:17:01 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:17:01 - INFO - Current BTC price: 84544000.0
2024-09-19 23:17:01 - INFO - Analyzing market conditions.
2024-09-19 23:17:01 - INFO - Market analysis: {'current_price': 84539000.0, 'sma_20': 83988250.0, 'rsi_14': 70.47192015158393, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 23:17:01 - INFO - Starting predictions for all models
2024-09-19 23:17:01 - INFO - Attempting prediction for gpt
2024-09-19 23:17:02 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:17:02 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:17:02 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:17:02 - INFO - GPT prediction: 84544000.0
2024-09-19 23:17:02 - INFO - Attempting prediction for ml
2024-09-19 23:17:02 - INFO - ML prediction: 84437553.2
2024-09-19 23:17:02 - INFO - Attempting prediction for xgboost
2024-09-19 23:17:02 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:17:02 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:17:02 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:17:02 - INFO - XGBOOST prediction: 84539000.0
2024-09-19 23:17:02 - INFO - Attempting prediction for lstm
2024-09-19 23:17:02 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:17:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:17:02 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:17:02 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:17:02 - INFO - X 샘플:
[[-1.11023296 -1.30311942 -0.7704006  -1.70307182 -1.14239162 -1.14545802
  -1.70307182]
 [-1.75086198 -1.20177161 -1.25986312 -0.70956215 -0.99200791 -0.99613709
  -0.70956215]
 [-0.21220836 -0.91906458 -0.08649406 -0.70342938 -1.16965753 -1.16993618
  -0.70342938]
 [-0.22936807  0.5104729   0.57729758  0.47406356  1.62202513  1.62213367
   0.47406356]
 [ 0.34262212  0.00906796  0.72480683  0.67031239 -0.90304644 -0.89994119
   0.67031239]
 [ 1.60672045  0.7238367   0.6510522  -0.02269127  0.14957784  0.15269015
  -0.02269127]
 [ 1.1605681   0.41979328 -0.51561189 -0.64210162 -0.25042268 -0.25081904
  -0.64210162]
 [-0.94435581 -0.90306229 -1.78285047 -0.43972002  1.23928749  1.22021252
  -0.43972002]
 [ 0.46845997  0.74517308  1.39530343  1.32651939  0.38493301  0.3914928
   1.32651939]
 [ 0.66865653  1.91867399  1.0667601   1.74968092  1.0617027   1.07576238
   1.74968092]]
2024-09-19 23:17:02 - INFO - y 샘플:
[1.74968092]
2024-09-19 23:17:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:17:02 - INFO - 모델 출력 (스케일링된 예측): [[0.40826774]]
2024-09-19 23:17:02 - INFO - 스케일러 역변환 후 예측 가격: 84320271.44405085
2024-09-19 23:17:02 - INFO - LSTMPredictor 최종 예측 가격: 84320271.44405085
2024-09-19 23:17:02 - INFO - LSTM prediction: 84320271.44405085
2024-09-19 23:17:02 - INFO - Attempting prediction for rl
2024-09-19 23:17:02 - INFO - Preparing state for RL agent.
2024-09-19 23:17:02 - INFO - Prepared state: [[8.45390000e+07 4.95080085e+01 8.16858056e-04 8.39882500e+07
  7.04719202e+01]]
2024-09-19 23:17:02 - INFO - RL prediction: 85389440.0
2024-09-19 23:17:02 - INFO - Attempting prediction for arima
2024-09-19 23:17:02 - INFO - ARIMA 예측 시작
2024-09-19 23:17:02 - INFO - 입력 데이터: {'open': 84334000.0, 'high': 84723000.0, 'low': 84250000.0, 'close': 84539000.0, 'volume': 49.50800849, 'value': 4186746478.87108, 'decision': 'sell', 'sma': 83988250.0, 'ema': 84022559.36898443, 'rsi': 70.47192015158393, 'macd': 302213.7724980563, 'signal_line': 288064.3287549858, 'BB_Upper': 84753396.75063129, 'BB_Lower': 83223103.24936871}
2024-09-19 23:17:02 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:17:02 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83988250.0         0         0
2024-09-19 23:17:02 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83988250.0         0         0
2024-09-19 23:17:02 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:17:02 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:17:02 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:17:02 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:17:02 - INFO - Attempting prediction for prophet
2024-09-19 23:17:02 - INFO - PROPHET prediction: 84660079.96674699
2024-09-19 23:17:02 - INFO - Attempting prediction for transformer
2024-09-19 23:17:02 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:17:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:17:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:17:02 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:17:02 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:17:02 - INFO - X 샘플:
[[-1.11023296 -1.30311942 -0.7704006  -1.70307182 -1.14239162 -1.14545802
  -1.70307182 -1.70307182  0.          0.          0.         -1.70307182
  -1.70307182]
 [-1.75086198 -1.20177161 -1.25986312 -0.70956215 -0.99200791 -0.99613709
  -0.70956215 -0.70956215  0.          0.          0.         -0.70956215
  -0.70956215]
 [-0.21220836 -0.91906458 -0.08649406 -0.70342938 -1.16965753 -1.16993618
  -0.70342938 -0.70342938  0.          0.          0.         -0.70342938
  -0.70342938]
 [-0.22936807  0.5104729   0.57729758  0.47406356  1.62202513  1.62213367
   0.47406356  0.47406356  0.          0.          0.          0.47406356
   0.47406356]
 [ 0.34262212  0.00906796  0.72480683  0.67031239 -0.90304644 -0.89994119
   0.67031239  0.67031239  0.          0.          0.          0.67031239
   0.67031239]
 [ 1.60672045  0.7238367   0.6510522  -0.02269127  0.14957784  0.15269015
  -0.02269127 -0.02269127  0.          0.          0.         -0.02269127
  -0.02269127]
 [ 1.1605681   0.41979328 -0.51561189 -0.64210162 -0.25042268 -0.25081904
  -0.64210162 -0.64210162  0.          0.          0.         -0.64210162
  -0.64210162]
 [-0.94435581 -0.90306229 -1.78285047 -0.43972002  1.23928749  1.22021252
  -0.43972002 -0.43972002  0.          0.          0.         -0.43972002
  -0.43972002]
 [ 0.46845997  0.74517308  1.39530343  1.32651939  0.38493301  0.3914928
   1.32651939  1.32651939  0.          0.          0.          1.32651939
   1.32651939]
 [ 0.66865653  1.91867399  1.0667601   1.74968092  1.0617027   1.07576238
   1.74968092  1.74968092  0.          0.          0.          1.74968092
   1.74968092]]
2024-09-19 23:17:02 - INFO - y 샘플:
[1.74968092]
2024-09-19 23:17:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:17:02 - INFO - 모델 출력 (스케일링된 예측): [0.29625908]
2024-09-19 23:17:02 - INFO - 스케일러 역변환 후 예측 가격: 84302007.50192258
2024-09-19 23:17:02 - INFO - TransformerPredictor 최종 예측 가격: 84302007.50192258
2024-09-19 23:17:02 - INFO - TRANSFORMER prediction: 84302007.50192258
2024-09-19 23:17:02 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:17:02 - INFO - BITCOIN_FORECAST prediction: 83129111.39195625
2024-09-19 23:17:02 - INFO - BitcoinForecast prediction: 83129111.39195625
2024-09-19 23:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:17:09 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:17:09 - INFO - 조정된 모델 가중치: {'gpt': 0.005142454708267716, 'ml': 0.19082521266819244, 'xgboost': 0.08655074700190758, 'rl': 0.21034646275904886, 'lstm': 0.07802667854268991, 'arima': 0.07818103787742472, 'prophet': 0.19777866914898368, 'transformer': 0.1078776636864236, 'bitcoin_forecast': 0.04527107360706146}
2024-09-19 23:17:09 - INFO - 조정된 모델 가중치: {'gpt': 0.005142454708267716, 'ml': 0.19082521266819244, 'xgboost': 0.08655074700190758, 'rl': 0.21034646275904886, 'lstm': 0.07802667854268991, 'arima': 0.07818103787742472, 'prophet': 0.19777866914898368, 'transformer': 0.1078776636864236, 'bitcoin_forecast': 0.04527107360706146}
2024-09-19 23:17:09 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84331462.17700838, 'current_price': 84544000.0, 'predictions': {'gpt': 84544000.0, 'ml': 84437553.2, 'xgboost': 84539000.0, 'lstm': 84320271.44405085, 'rl': 85389440.0, 'arima': 80899000.0, 'prophet': 84660079.96674699, 'transformer': 84302007.50192258, 'bitcoin_forecast': 83129111.39195625}, 'weights': {'gpt': 0.005142454708267716, 'ml': 0.19082521266819244, 'xgboost': 0.08655074700190758, 'rl': 0.21034646275904886, 'lstm': 0.07802667854268991, 'arima': 0.07818103787742472, 'prophet': 0.19777866914898368, 'transformer': 0.1078776636864236, 'bitcoin_forecast': 0.04527107360706146}}
2024-09-19 23:17:09 - INFO - 모델별 가중치:
2024-09-19 23:17:09 - INFO -   - GPT: 0.0051
2024-09-19 23:17:09 - INFO -   - ML: 0.1908
2024-09-19 23:17:09 - INFO -   - XGBOOST: 0.0866
2024-09-19 23:17:09 - INFO -   - RL: 0.2103
2024-09-19 23:17:09 - INFO -   - LSTM: 0.0780
2024-09-19 23:17:09 - INFO -   - ARIMA: 0.0782
2024-09-19 23:17:09 - INFO -   - PROPHET: 0.1978
2024-09-19 23:17:09 - INFO -   - TRANSFORMER: 0.1079
2024-09-19 23:17:09 - INFO -   - BITCOIN_FORECAST: 0.0453
2024-09-19 23:17:09 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:17:09 - INFO - 6. 거래 실행
2024-09-19 23:17:09 - INFO - Cancelling existing orders.
2024-09-19 23:17:09 - INFO - Cancelled 0 orders.
2024-09-19 23:17:09 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84331462.17700838, 'current_price': 84544000.0, 'predictions': {'gpt': 84544000.0, 'ml': 84437553.2, 'xgboost': 84539000.0, 'lstm': 84320271.44405085, 'rl': 85389440.0, 'arima': 80899000.0, 'prophet': 84660079.96674699, 'transformer': 84302007.50192258, 'bitcoin_forecast': 83129111.39195625}, 'weights': {'gpt': 0.005142454708267716, 'ml': 0.19082521266819244, 'xgboost': 0.08655074700190758, 'rl': 0.21034646275904886, 'lstm': 0.07802667854268991, 'arima': 0.07818103787742472, 'prophet': 0.19777866914898368, 'transformer': 0.1078776636864236, 'bitcoin_forecast': 0.04527107360706146}}, 현재 가격=84544000.0
2024-09-19 23:17:09 - INFO - 현재 잔고: KRW=249257.5119479, BTC=0.00272022, 총 자산가치=479235.7916279
2024-09-19 23:17:09 - INFO - 매도 시도: 0.000272022 BTC (약 22997.827968 KRW)
2024-09-19 23:17:09 - INFO - 주문 결과: {'uuid': '95fefe50-dd7f-40ed-8b20-a577f8e3c9ee', 'side': 'ask', 'ord_type': 'limit', 'price': '84544000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:17:09+09:00', 'volume': '0.00027202', 'remaining_volume': '0.00027202', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00027202', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:17:09 - INFO - sell 주문 성공: UUID=95fefe50-dd7f-40ed-8b20-a577f8e3c9ee
2024-09-19 23:17:09 - INFO - Trade executed successfully.
2024-09-19 23:17:09 - INFO - 7. summary 리포트 보내기
2024-09-19 23:17:10 - INFO - Message sent to Discord successfully.
2024-09-19 23:17:10 - INFO - Trading cycle completed.
2024-09-19 23:17:10 - INFO - Performing periodic update.
2024-09-19 23:17:10 - INFO - 계산된 시장 변동성: 0.029571730886969842
2024-09-19 23:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:25:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8161-bb1e-e9a6d864e98d "HTTP/1.1 200 OK"
2024-09-19 23:25:40 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:25:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-819a-c7e6717cdd40 "HTTP/1.1 200 OK"
2024-09-19 23:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:25:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-ab0f-c6e299697313 "HTTP/1.1 200 OK"
2024-09-19 23:25:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810d-b5c8-f37afee35ac8 "HTTP/1.1 200 OK"
2024-09-19 23:26:03 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8168-8fb6-e0fda4c86c7d "HTTP/1.1 200 OK"
2024-09-19 23:26:11 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-9914-c40fdcd05209 "HTTP/1.1 200 OK"
2024-09-19 23:26:21 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8145-9bec-cf0a61024e6b "HTTP/1.1 200 OK"
2024-09-19 23:26:40 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8109-8c95-d6782e9587eb "HTTP/1.1 200 OK"
2024-09-19 23:26:51 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:26:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8156-a33c-e69855b54dbf "HTTP/1.1 200 OK"
2024-09-19 23:26:57 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:15:34.942171
2024-09-19 23:26:57 - INFO - Starting trading cycle.
2024-09-19 23:26:57 - INFO - ##################################################
2024-09-19 23:26:57 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-19 23:26:57 - INFO - ##################################################
2024-09-19 23:26:57 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:26:57 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:26:57 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:10:00
2024-09-19 23:26:57 - INFO - 새로운 데이터 범위: 2024-09-18 14:10:00 ~ 2024-09-19 23:20:00
2024-09-19 23:26:57 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:26:57 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:26:57 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:26:57 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:26:57 - INFO - Sample date values: [Timestamp('2024-09-19 23:20:00')]
2024-09-19 23:26:57 - INFO - Successfully added 1 new data points
2024-09-19 23:26:57 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:26:57 - INFO - Final date range: 2024-09-19 23:20:00 to 2024-09-19 23:20:00
2024-09-19 23:26:57 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:26:57 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:20:00
2024-09-19 23:26:57 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:26:58 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:26:58 - INFO - GPT | 이전예측가격: 84544000 | 당시BTC가격: 84544000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:26:58 - INFO - ML 모델 예측 업데이트: 정확도 43.24%, 적중/전체: 16/37
2024-09-19 23:26:58 - INFO - ML | 이전예측가격: 84437553 | 당시BTC가격: 84544000 | 예측: 하락 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1818 | 반영가중치값: -0.0200 | 새 가중치: 0.1618 | 예측 총 횟수: 37 | 예측 성공 수: 16 | 예측 성공률: 43.24%
2024-09-19 23:26:58 - INFO - XGBOOST | 이전예측가격: 84539000 | 당시BTC가격: 84544000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:26:58 - INFO - LSTM 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 8/20
2024-09-19 23:26:58 - INFO - LSTM | 이전예측가격: 84320271 | 당시BTC가격: 84544000 | 예측: 하락 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1253 | 반영가중치값: -0.0200 | 새 가중치: 0.1053 | 예측 총 횟수: 20 | 예측 성공 수: 8 | 예측 성공률: 40.00%
2024-09-19 23:26:58 - INFO - RL 모델 예측 업데이트: 정확도 67.50%, 적중/전체: 27/40
2024-09-19 23:26:58 - INFO - RL | 이전예측가격: 85389440 | 당시BTC가격: 84544000 | 예측: 상승 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2992 | 반영가중치값: 0.0200 | 새 가중치: 0.3192 | 예측 총 횟수: 40 | 예측 성공 수: 27 | 예측 성공률: 67.50%
2024-09-19 23:26:58 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.72%, 적중/전체: 120/232
2024-09-19 23:26:58 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84544000 | 예측: 하락 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 232 | 예측 성공 수: 120 | 예측 성공률: 51.72%
2024-09-19 23:26:58 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 24/36
2024-09-19 23:26:58 - INFO - PROPHET | 이전예측가격: 84660080 | 당시BTC가격: 84544000 | 예측: 상승 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0958 | 반영가중치값: 0.0200 | 새 가중치: 0.1158 | 예측 총 횟수: 36 | 예측 성공 수: 24 | 예측 성공률: 66.67%
2024-09-19 23:26:58 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 8/20
2024-09-19 23:26:58 - INFO - TRANSFORMER | 이전예측가격: 84302008 | 당시BTC가격: 84544000 | 예측: 하락 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1253 | 반영가중치값: -0.0200 | 새 가중치: 0.1053 | 예측 총 횟수: 20 | 예측 성공 수: 8 | 예측 성공률: 40.00%
2024-09-19 23:26:58 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 5/20
2024-09-19 23:26:58 - INFO - BITCOIN_FORECAST | 이전예측가격: 83129111 | 당시BTC가격: 84544000 | 예측: 하락 | 지금 BTC가격: 84608000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0868 | 반영가중치값: -0.0200 | 새 가중치: 0.0668 | 예측 총 횟수: 20 | 예측 성공 수: 5 | 예측 성공률: 25.00%
2024-09-19 23:26:58 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:26:58 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:26:58 - INFO - 새로운 가중치: {'gpt': 0.005324463771666386, 'ml': 0.16751281535324988, 'xgboost': 0.0896140740104947, 'rl': 0.33051417733386373, 'lstm': 0.1089929974474456, 'arima': 0.0, 'prophet': 0.11987884939890657, 'transformer': 0.1089929974474456, 'bitcoin_forecast': 0.06916962523692756}
2024-09-19 23:26:58 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:26:58 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:26:58 - INFO - Current BTC price: 84608000.0
2024-09-19 23:26:58 - INFO - Analyzing market conditions.
2024-09-19 23:26:58 - INFO - Market analysis: {'current_price': 84608000.0, 'sma_20': 84062150.0, 'rsi_14': 71.69431457801822, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 23:26:58 - INFO - Starting predictions for all models
2024-09-19 23:26:58 - INFO - Attempting prediction for gpt
2024-09-19 23:26:58 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:26:58 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:26:58 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:26:58 - INFO - GPT prediction: 84608000.0
2024-09-19 23:26:58 - INFO - Attempting prediction for ml
2024-09-19 23:26:58 - INFO - ML prediction: 84557235.2
2024-09-19 23:26:58 - INFO - Attempting prediction for xgboost
2024-09-19 23:26:58 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:26:58 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:26:58 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:26:58 - INFO - XGBOOST prediction: 84608000.0
2024-09-19 23:26:58 - INFO - Attempting prediction for lstm
2024-09-19 23:26:58 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:26:58 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:26:58 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:26:58 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:26:58 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:26:58 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:26:58 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:26:58 - INFO - X 샘플:
[[-1.7810957  -1.48294499 -1.27823395 -1.08008698 -1.00138711 -1.00873686
  -1.08008698]
 [-0.4903771  -1.20344255 -0.35120974 -1.0740496  -1.17992271 -1.18369649
  -1.0740496 ]
 [-0.50477173  0.20989051  0.17322109  0.08512703  1.62568282  1.6270171
   0.08512703]
 [-0.02495069 -0.28583079  0.28976128  0.27832314 -0.91198197 -0.91189863
   0.27832314]
 [ 1.0354538   0.42083574  0.23149119 -0.40390061  0.14589204  0.14776153
  -0.40390061]
 [ 0.66119339  0.12023878 -0.69023574 -1.01367581 -0.2561034  -0.25844204
  -1.01367581]
 [-1.10454803 -1.18762166 -1.69142188 -0.81444233  1.24103636  1.22241216
  -0.81444233]
 [ 0.08060993  0.44193026  0.8194894   0.92432262  0.38242098  0.38815876
   0.92432262]
 [ 0.2485473   1.60212905  0.55992262  1.34090172  1.06256591  1.07699747
   1.34090172]
 [ 1.87993883  1.36481566  1.93721573  1.75748082 -1.10820292 -1.099573
   1.75748082]]
2024-09-19 23:26:58 - INFO - y 샘플:
[1.75748082]
2024-09-19 23:26:58 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:26:58 - INFO - 모델 출력 (스케일링된 예측): [[0.44175774]]
2024-09-19 23:26:58 - INFO - 스케일러 역변환 후 예측 가격: 84390070.45871906
2024-09-19 23:26:58 - INFO - LSTMPredictor 최종 예측 가격: 84390070.45871906
2024-09-19 23:26:58 - INFO - LSTM prediction: 84390070.45871906
2024-09-19 23:26:58 - INFO - Attempting prediction for rl
2024-09-19 23:26:58 - INFO - Preparing state for RL agent.
2024-09-19 23:26:58 - INFO - Prepared state: [[8.46080000e+07 2.54217923e+01 8.16191344e-04 8.40621500e+07
  7.16943146e+01]]
2024-09-19 23:26:58 - INFO - RL prediction: 85454080.0
2024-09-19 23:26:58 - INFO - Attempting prediction for arima
2024-09-19 23:26:58 - INFO - ARIMA 예측 시작
2024-09-19 23:26:58 - INFO - 입력 데이터: {'open': 84674000.0, 'high': 84678000.0, 'low': 84510000.0, 'close': 84608000.0, 'volume': 25.42179231, 'value': 2150643427.52533, 'decision': 'sell', 'sma': 84062150.0, 'ema': 84078315.61955734, 'rsi': 71.69431457801822, 'macd': 311946.2703409046, 'signal_line': 292840.7170721696, 'BB_Upper': 84764363.72102916, 'BB_Lower': 83359936.27897084}
2024-09-19 23:26:58 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:26:58 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84062150.0         0         0
2024-09-19 23:26:58 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84062150.0         0         0
2024-09-19 23:26:58 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:26:58 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:26:58 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:26:58 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:26:58 - INFO - Attempting prediction for prophet
2024-09-19 23:26:59 - INFO - PROPHET prediction: 84721420.65212107
2024-09-19 23:26:59 - INFO - Attempting prediction for transformer
2024-09-19 23:26:59 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:26:59 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:26:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:26:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:26:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:26:59 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:26:59 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:26:59 - INFO - X 샘플:
[[-1.7810957  -1.48294499 -1.27823395 -1.08008698 -1.00138711 -1.00873686
  -1.08008698 -1.08008698  0.          0.          0.         -1.08008698
  -1.08008698]
 [-0.4903771  -1.20344255 -0.35120974 -1.0740496  -1.17992271 -1.18369649
  -1.0740496  -1.0740496   0.          0.          0.         -1.0740496
  -1.0740496 ]
 [-0.50477173  0.20989051  0.17322109  0.08512703  1.62568282  1.6270171
   0.08512703  0.08512703  0.          0.          0.          0.08512703
   0.08512703]
 [-0.02495069 -0.28583079  0.28976128  0.27832314 -0.91198197 -0.91189863
   0.27832314  0.27832314  0.          0.          0.          0.27832314
   0.27832314]
 [ 1.0354538   0.42083574  0.23149119 -0.40390061  0.14589204  0.14776153
  -0.40390061 -0.40390061  0.          0.          0.         -0.40390061
  -0.40390061]
 [ 0.66119339  0.12023878 -0.69023574 -1.01367581 -0.2561034  -0.25844204
  -1.01367581 -1.01367581  0.          0.          0.         -1.01367581
  -1.01367581]
 [-1.10454803 -1.18762166 -1.69142188 -0.81444233  1.24103636  1.22241216
  -0.81444233 -0.81444233  0.          0.          0.         -0.81444233
  -0.81444233]
 [ 0.08060993  0.44193026  0.8194894   0.92432262  0.38242098  0.38815876
   0.92432262  0.92432262  0.          0.          0.          0.92432262
   0.92432262]
 [ 0.2485473   1.60212905  0.55992262  1.34090172  1.06256591  1.07699747
   1.34090172  1.34090172  0.          0.          0.          1.34090172
   1.34090172]
 [ 1.87993883  1.36481566  1.93721573  1.75748082 -1.10820292 -1.099573
   1.75748082  1.75748082  0.          0.          0.          1.75748082
   1.75748082]]
2024-09-19 23:26:59 - INFO - y 샘플:
[1.75748082]
2024-09-19 23:26:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:26:59 - INFO - 모델 출력 (스케일링된 예측): [0.2945407]
2024-09-19 23:26:59 - INFO - 스케일러 역변환 후 예측 가격: 84365686.19317552
2024-09-19 23:26:59 - INFO - TransformerPredictor 최종 예측 가격: 84365686.19317552
2024-09-19 23:26:59 - INFO - TRANSFORMER prediction: 84365686.19317552
2024-09-19 23:26:59 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:26:59 - INFO - BITCOIN_FORECAST prediction: 82919753.86790693
2024-09-19 23:26:59 - INFO - BitcoinForecast prediction: 82919753.86790693
2024-09-19 23:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:27:06 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:27:06 - INFO - 조정된 모델 가중치: {'gpt': 0.005324463771666386, 'ml': 0.16751281535324988, 'xgboost': 0.0896140740104947, 'rl': 0.33051417733386373, 'lstm': 0.1089929974474456, 'arima': 0.0, 'prophet': 0.11987884939890657, 'transformer': 0.1089929974474456, 'bitcoin_forecast': 0.06916962523692756}
2024-09-19 23:27:06 - INFO - 조정된 모델 가중치: {'gpt': 0.005324463771666386, 'ml': 0.16751281535324988, 'xgboost': 0.0896140740104947, 'rl': 0.33051417733386373, 'lstm': 0.1089929974474456, 'arima': 0.0, 'prophet': 0.11987884939890657, 'transformer': 0.1089929974474456, 'bitcoin_forecast': 0.06916962523692756}
2024-09-19 23:27:06 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84725795.76353431, 'current_price': 84608000.0, 'predictions': {'gpt': 84608000.0, 'ml': 84557235.2, 'xgboost': 84608000.0, 'lstm': 84390070.45871906, 'rl': 85454080.0, 'arima': 80899000.0, 'prophet': 84721420.65212107, 'transformer': 84365686.19317552, 'bitcoin_forecast': 82919753.86790693}, 'weights': {'gpt': 0.005324463771666386, 'ml': 0.16751281535324988, 'xgboost': 0.0896140740104947, 'rl': 0.33051417733386373, 'lstm': 0.1089929974474456, 'arima': 0.0, 'prophet': 0.11987884939890657, 'transformer': 0.1089929974474456, 'bitcoin_forecast': 0.06916962523692756}}
2024-09-19 23:27:06 - INFO - 모델별 가중치:
2024-09-19 23:27:06 - INFO -   - GPT: 0.0053
2024-09-19 23:27:06 - INFO -   - ML: 0.1675
2024-09-19 23:27:06 - INFO -   - XGBOOST: 0.0896
2024-09-19 23:27:06 - INFO -   - RL: 0.3305
2024-09-19 23:27:06 - INFO -   - LSTM: 0.1090
2024-09-19 23:27:06 - INFO -   - ARIMA: 0.0000
2024-09-19 23:27:06 - INFO -   - PROPHET: 0.1199
2024-09-19 23:27:06 - INFO -   - TRANSFORMER: 0.1090
2024-09-19 23:27:06 - INFO -   - BITCOIN_FORECAST: 0.0692
2024-09-19 23:27:06 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:27:06 - INFO - 6. 거래 실행
2024-09-19 23:27:06 - INFO - Cancelling existing orders.
2024-09-19 23:27:06 - INFO - Cancelled 0 orders.
2024-09-19 23:27:06 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84725795.76353431, 'current_price': 84608000.0, 'predictions': {'gpt': 84608000.0, 'ml': 84557235.2, 'xgboost': 84608000.0, 'lstm': 84390070.45871906, 'rl': 85454080.0, 'arima': 80899000.0, 'prophet': 84721420.65212107, 'transformer': 84365686.19317552, 'bitcoin_forecast': 82919753.86790693}, 'weights': {'gpt': 0.005324463771666386, 'ml': 0.16751281535324988, 'xgboost': 0.0896140740104947, 'rl': 0.33051417733386373, 'lstm': 0.1089929974474456, 'arima': 0.0, 'prophet': 0.11987884939890657, 'transformer': 0.1089929974474456, 'bitcoin_forecast': 0.06916962523692756}}, 현재 가격=84608000.0
2024-09-19 23:27:07 - INFO - 현재 잔고: KRW=272243.67199846, BTC=0.0024482, 총 자산가치=479380.97759846004
2024-09-19 23:27:07 - INFO - 매수 시도: 0.0005665906032508275 BTC (약 47938.097759846016 KRW)
2024-09-19 23:27:07 - INFO - 주문 결과: {'uuid': '0cd5c258-ee25-4651-9b89-61641fea423e', 'side': 'bid', 'ord_type': 'limit', 'price': '84608000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:27:07+09:00', 'volume': '0.00056659', 'remaining_volume': '0.00056659', 'reserved_fee': '23.96902336', 'remaining_fee': '23.96902336', 'paid_fee': '0', 'locked': '47962.01574336', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:27:07 - INFO - buy 주문 성공: UUID=0cd5c258-ee25-4651-9b89-61641fea423e
2024-09-19 23:27:07 - INFO - Trade executed successfully.
2024-09-19 23:27:07 - INFO - 7. summary 리포트 보내기
2024-09-19 23:27:07 - INFO - Message sent to Discord successfully.
2024-09-19 23:27:07 - INFO - Trading cycle completed.
2024-09-19 23:27:07 - INFO - Performing periodic update.
2024-09-19 23:27:07 - INFO - 계산된 시장 변동성: 0.028995394788838627
2024-09-19 23:35:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:35:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e6-a2ac-eef860453f07 "HTTP/1.1 200 OK"
2024-09-19 23:35:45 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:35:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:35:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d8-b7d4-c2fc7a339a7b "HTTP/1.1 200 OK"
2024-09-19 23:35:52 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:35:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8188-8054-fa2734dbf578 "HTTP/1.1 200 OK"
2024-09-19 23:36:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/18506b49-0438-4358-892d-3e391570d90b "HTTP/1.1 200 OK"
2024-09-19 23:36:11 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8140-ac1b-e070fc895461 "HTTP/1.1 200 OK"
2024-09-19 23:36:22 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d53c1896-6c31-45e7-bf4c-34f15b788d4a "HTTP/1.1 200 OK"
2024-09-19 23:36:31 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8152-95e1-d284d26d18ec "HTTP/1.1 200 OK"
2024-09-19 23:36:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-8d2e-cab8274a42a7 "HTTP/1.1 200 OK"
2024-09-19 23:36:47 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:36:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8164-b539-c379664da93b "HTTP/1.1 200 OK"
2024-09-19 23:36:54 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:25:34.942485
2024-09-19 23:36:54 - INFO - Starting trading cycle.
2024-09-19 23:36:54 - INFO - ##################################################
2024-09-19 23:36:54 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-19 23:36:54 - INFO - ##################################################
2024-09-19 23:36:54 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:36:54 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:36:54 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:20:00
2024-09-19 23:36:54 - INFO - 새로운 데이터 범위: 2024-09-18 14:20:00 ~ 2024-09-19 23:30:00
2024-09-19 23:36:54 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:36:54 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:36:54 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:36:54 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:36:54 - INFO - Sample date values: [Timestamp('2024-09-19 23:30:00')]
2024-09-19 23:36:54 - INFO - Successfully added 1 new data points
2024-09-19 23:36:54 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:36:54 - INFO - Final date range: 2024-09-19 23:30:00 to 2024-09-19 23:30:00
2024-09-19 23:36:54 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:36:54 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:30:00
2024-09-19 23:36:54 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:36:54 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-19 23:36:54 - INFO - 재학습 대상 모델: ['bitcoin_forecast', 'lstm', 'transformer']
2024-09-19 23:36:54 - INFO - bitcoin_forecast 모델 재학습 시작
2024-09-19 23:36:54 - INFO - BitcoinForecastPredictor 훈련 시작
2024-09-19 23:36:54 - INFO - BitcoinForecastPredictor prepare_data 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 23:36:54 - INFO - 준비된 데이터 shape - X: (2970, 30, 2), y: (2970,)
2024-09-19 23:36:55 - INFO - Epoch [1/30], Loss: 0.8982
2024-09-19 23:36:56 - INFO - Epoch [2/30], Loss: 0.6935
2024-09-19 23:36:57 - INFO - Epoch [3/30], Loss: 0.4094
2024-09-19 23:36:58 - INFO - Epoch [4/30], Loss: 0.1715
2024-09-19 23:36:59 - INFO - Epoch [5/30], Loss: 0.1030
2024-09-19 23:37:00 - INFO - Epoch [6/30], Loss: 0.0668
2024-09-19 23:37:01 - INFO - Epoch [7/30], Loss: 0.0463
2024-09-19 23:37:02 - INFO - Epoch [8/30], Loss: 0.0358
2024-09-19 23:37:03 - INFO - Epoch [9/30], Loss: 0.0292
2024-09-19 23:37:04 - INFO - Epoch [10/30], Loss: 0.0263
2024-09-19 23:37:05 - INFO - Epoch [11/30], Loss: 0.0223
2024-09-19 23:37:06 - INFO - Epoch [12/30], Loss: 0.0224
2024-09-19 23:37:07 - INFO - Epoch [13/30], Loss: 0.0179
2024-09-19 23:37:08 - INFO - Epoch [14/30], Loss: 0.0176
2024-09-19 23:37:08 - INFO - Epoch [15/30], Loss: 0.0145
2024-09-19 23:37:09 - INFO - Epoch [16/30], Loss: 0.0151
2024-09-19 23:37:10 - INFO - Epoch [17/30], Loss: 0.0126
2024-09-19 23:37:11 - INFO - Epoch [18/30], Loss: 0.0132
2024-09-19 23:37:12 - INFO - Epoch [19/30], Loss: 0.0112
2024-09-19 23:37:13 - INFO - Epoch [20/30], Loss: 0.0118
2024-09-19 23:37:13 - INFO - Epoch [21/30], Loss: 0.0101
2024-09-19 23:37:14 - INFO - Epoch [22/30], Loss: 0.0107
2024-09-19 23:37:14 - INFO - Epoch [23/30], Loss: 0.0094
2024-09-19 23:37:15 - INFO - Epoch [24/30], Loss: 0.0099
2024-09-19 23:37:16 - INFO - Epoch [25/30], Loss: 0.0088
2024-09-19 23:37:17 - INFO - Epoch [26/30], Loss: 0.0092
2024-09-19 23:37:18 - INFO - Epoch [27/30], Loss: 0.0084
2024-09-19 23:37:19 - INFO - Epoch [28/30], Loss: 0.0087
2024-09-19 23:37:20 - INFO - Epoch [29/30], Loss: 0.0080
2024-09-19 23:37:21 - INFO - Epoch [30/30], Loss: 0.0083
2024-09-19 23:37:21 - INFO - BitcoinForecastPredictor 훈련 완료
2024-09-19 23:37:21 - INFO - bitcoin_forecast 모델의 예측 통계가 초기화되었습니다.
2024-09-19 23:37:21 - INFO - bitcoin_forecast 모델 재학습 완료
2024-09-19 23:37:21 - INFO - lstm 모델 재학습 시작
2024-09-19 23:37:21 - INFO - LSTM 하이퍼파라미터 랜덤 조정: hidden_dim=91, num_layers=1, learning_rate=0.00166502511182169
2024-09-19 23:37:21 - INFO - LSTM 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:37:21 - INFO - NaN 값 개수:
date           0
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:37:21 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:37:21 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:37:21 - INFO - X 샘플:
[[0.45537258 0.45166422 0.45358428 0.4528478  0.2225361  0.3692299
  0.42914419]
 [0.45519329 0.46767015 0.45950475 0.46432304 0.87165575 1.22852663
  0.43242399]
 [0.46116964 0.46205613 0.46082041 0.46623558 0.28452828 0.45232446
  0.43564619]
 [0.47437738 0.4700591  0.46016258 0.45948192 0.52928358 0.77628579
  0.43835309]
 [0.46971583 0.46665485 0.44975691 0.45344547 0.4362758  0.65210046
  0.44039614]
 [0.44772286 0.45184339 0.4384542  0.45541778 0.78266192 1.10483003
  0.4430121 ]
 [0.46248444 0.47029799 0.46680068 0.47263063 0.58400816 0.84978049
  0.44643739]
 [0.46457616 0.48343719 0.46387034 0.47675454 0.74137006 1.06037358
  0.45007488]
 [0.48489576 0.48074963 0.47941904 0.48087845 0.23912957 0.39494829
  0.45455504]
 [0.48585197 0.48558724 0.49018353 0.48912628 0.77935266 1.11349894
  0.45862599]]
2024-09-19 23:37:21 - INFO - y 샘플:
[0.48912628]
2024-09-19 23:37:21 - INFO - Epoch [10/50], Loss: 0.0203
2024-09-19 23:37:21 - INFO - Epoch [20/50], Loss: 0.0054
2024-09-19 23:37:21 - INFO - Epoch [30/50], Loss: 0.0006
2024-09-19 23:37:21 - INFO - Epoch [40/50], Loss: 0.0000
2024-09-19 23:37:21 - INFO - Epoch [50/50], Loss: 0.0001
2024-09-19 23:37:21 - INFO - LSTM 훈련 완료. MSE: 1.1603598068177234e-05
2024-09-19 23:37:21 - INFO - lstm 모델의 예측 통계가 초기화되었습니다.
2024-09-19 23:37:21 - INFO - lstm 모델 재학습 완료
2024-09-19 23:37:21 - INFO - transformer 모델 재학습 시작
2024-09-19 23:37:21 - INFO - Transformer 학습률 조정: learning_rate=0.00031381059609000004
2024-09-19 23:37:21 - INFO - Transformer 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-19 23:37:21 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:37:21 - INFO - NaN 값 개수:
date            0
open            0
high            0
low             0
close           0
volume          0
value           0
decision        0
sma            19
ema            19
rsi            14
macd           25
signal_line    33
BB_Upper       19
BB_Lower       19
dtype: int64
2024-09-19 23:37:21 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:37:21 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:37:21 - INFO - X 샘플:
[[0.45537258 0.45166422 0.45358428 0.4528478  0.2225361  0.3692299
  0.42914419 0.43594777 1.31833112 0.16556762 0.15020212 0.42246617
  0.39564142]
 [0.45519329 0.46767015 0.45950475 0.46432304 0.87165575 1.22852663
  0.43242399 0.43961033 1.58398838 0.17334258 0.1569782  0.42803311
  0.39665432]
 [0.46116964 0.46205613 0.46082041 0.46623558 0.28452828 0.45232446
  0.43564619 0.44311025 1.62585792 0.17891049 0.16357946 0.43320256
  0.39790722]
 [0.47437738 0.4700591  0.46016258 0.45948192 0.52928358 0.77628579
  0.43835309 0.44561945 1.26530465 0.17619007 0.16828374 0.43642267
  0.39992519]
 [0.46971583 0.46665485 0.44975691 0.45344547 0.4362758  0.65210046
  0.44039614 0.4473021  0.96045624 0.16754453 0.17021431 0.43852604
  0.40172953]
 [0.44772286 0.45184339 0.4384542  0.45541778 0.78266192 1.10483003
  0.4430121  0.44901648 1.01966969 0.16035824 0.17023528 0.43984218
  0.4052241 ]
 [0.46248444 0.47029799 0.46680068 0.47263063 0.58400816 0.84978049
  0.44643739 0.45224305 1.47649651 0.16582057 0.17141007 0.44345558
  0.40817437]
 [0.46457616 0.48343719 0.46387034 0.47675454 0.74137006 1.06037358
  0.45007488 0.45556374 1.57131799 0.17131983 0.17351574 0.44682082
  0.41171334]
 [0.48489576 0.48074963 0.47941904 0.48087845 0.23912957 0.39494829
  0.45455504 0.45896959 1.66528071 0.17678533 0.17635896 0.44750445
  0.41904881]
 [0.48585197 0.48558724 0.49018353 0.48912628 0.77935266 1.11349894
  0.45862599 0.46285389 1.84340178 0.18525317 0.18042871 0.45118126
  0.42308643]]
2024-09-19 23:37:21 - INFO - y 샘플:
[0.48912628]
2024-09-19 23:37:21 - INFO - Epoch [1/50], Loss: 0.0040
2024-09-19 23:37:21 - INFO - Epoch [2/50], Loss: 0.0594
2024-09-19 23:37:21 - INFO - Epoch [3/50], Loss: 0.0000
2024-09-19 23:37:21 - INFO - Epoch [4/50], Loss: 0.0061
2024-09-19 23:37:21 - INFO - Epoch [5/50], Loss: 0.0007
2024-09-19 23:37:21 - INFO - Epoch [6/50], Loss: 0.0056
2024-09-19 23:37:21 - INFO - 조기 종료: 3 에폭 동안 개선 없음
2024-09-19 23:37:21 - INFO - Transformer 훈련 완료. MSE: 0.000571996090002358
2024-09-19 23:37:21 - INFO - transformer 모델의 예측 통계가 초기화되었습니다.
2024-09-19 23:37:21 - INFO - transformer 모델 재학습 완료
2024-09-19 23:37:21 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:37:21 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:37:21 - INFO - GPT | 이전예측가격: 84608000 | 당시BTC가격: 84608000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:37:21 - INFO - ML 모델 예측 업데이트: 정확도 42.11%, 적중/전체: 16/38
2024-09-19 23:37:21 - INFO - ML | 이전예측가격: 84557235 | 당시BTC가격: 84608000 | 예측: 하락 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1908 | 반영가중치값: -0.0200 | 새 가중치: 0.1708 | 예측 총 횟수: 38 | 예측 성공 수: 16 | 예측 성공률: 42.11%
2024-09-19 23:37:21 - INFO - XGBOOST | 이전예측가격: 84608000 | 당시BTC가격: 84608000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:37:21 - INFO - LSTM 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 23:37:21 - INFO - LSTM | 이전예측가격: 84390070 | 당시BTC가격: 84608000 | 예측: 하락 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0780 | 반영가중치값: -0.0200 | 새 가중치: 0.0580 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 23:37:21 - INFO - RL 모델 예측 업데이트: 정확도 68.29%, 적중/전체: 28/41
2024-09-19 23:37:21 - INFO - RL | 이전예측가격: 85454080 | 당시BTC가격: 84608000 | 예측: 상승 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2103 | 반영가중치값: 0.0200 | 새 가중치: 0.2303 | 예측 총 횟수: 41 | 예측 성공 수: 28 | 예측 성공률: 68.29%
2024-09-19 23:37:21 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.50%, 적중/전체: 120/233
2024-09-19 23:37:21 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84608000 | 예측: 하락 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0782 | 반영가중치값: -0.0200 | 새 가중치: 0.0582 | 예측 총 횟수: 233 | 예측 성공 수: 120 | 예측 성공률: 51.50%
2024-09-19 23:37:21 - INFO - PROPHET 모델 예측 업데이트: 정확도 67.57%, 적중/전체: 25/37
2024-09-19 23:37:21 - INFO - PROPHET | 이전예측가격: 84721421 | 당시BTC가격: 84608000 | 예측: 상승 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1978 | 반영가중치값: 0.0200 | 새 가중치: 0.2178 | 예측 총 횟수: 37 | 예측 성공 수: 25 | 예측 성공률: 67.57%
2024-09-19 23:37:21 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 23:37:21 - INFO - TRANSFORMER | 이전예측가격: 84365686 | 당시BTC가격: 84608000 | 예측: 하락 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1079 | 반영가중치값: -0.0200 | 새 가중치: 0.0879 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 23:37:21 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-19 23:37:21 - INFO - BITCOIN_FORECAST | 이전예측가격: 82919754 | 당시BTC가격: 84608000 | 예측: 하락 | 지금 BTC가격: 84709000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0453 | 반영가중치값: -0.0200 | 새 가중치: 0.0253 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-19 23:37:22 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:37:22 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:37:22 - INFO - 새로운 가중치: {'gpt': 0.0056448344540343835, 'ml': 0.18110369183437508, 'xgboost': 0.09500611408658545, 'rl': 0.24420630980089944, 'lstm': 0.061518118694690774, 'arima': 0.06168176576383784, 'prophet': 0.23088231748475185, 'transformer': 0.09316522470429373, 'bitcoin_forecast': 0.026791623176531502}
2024-09-19 23:37:22 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:37:22 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:37:22 - INFO - Current BTC price: 84738000.0
2024-09-19 23:37:22 - INFO - Analyzing market conditions.
2024-09-19 23:37:22 - INFO - Market analysis: {'current_price': 84746000.0, 'sma_20': 84129300.0, 'rsi_14': 74.01155515844388, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-19 23:37:22 - INFO - Starting predictions for all models
2024-09-19 23:37:22 - INFO - Attempting prediction for gpt
2024-09-19 23:37:22 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:37:22 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:37:22 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:37:22 - INFO - GPT prediction: 84738000.0
2024-09-19 23:37:22 - INFO - Attempting prediction for ml
2024-09-19 23:37:22 - INFO - ML prediction: 84712101.60000001
2024-09-19 23:37:22 - INFO - Attempting prediction for xgboost
2024-09-19 23:37:22 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:37:22 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:37:22 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:37:22 - INFO - XGBOOST prediction: 84746000.0
2024-09-19 23:37:22 - INFO - Attempting prediction for lstm
2024-09-19 23:37:22 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:37:22 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:37:22 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:37:22 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:37:22 - INFO - X 샘플:
[[-0.89805735 -1.53558318 -0.62748224 -1.20947363 -1.40233891 -1.40709302
  -1.20947363]
 [-0.91301666 -0.11795902 -0.19906333 -0.23662513  1.40247492  1.39852826
  -0.23662513]
 [-0.41437294 -0.61518541 -0.10385913 -0.07448371 -1.13447377 -1.13578759
  -0.07448371]
 [ 0.6876297   0.09362667 -0.15146123 -0.64704559 -0.07689828 -0.07804727
  -0.64704559]
 [ 0.29868759 -0.20788295 -0.90443992 -1.15880443 -0.47878028 -0.4835149
  -1.15880443]
 [-1.53632132 -1.51971425 -1.72233057 -0.9915961   1.01793701  0.99465637
  -0.9915961 ]
 [-0.30467132  0.11478524  0.32888724  0.46767665  0.15956392  0.16191442
   0.46767665]
 [-0.13014601  1.27850656  0.11684152  0.81729408  0.83951692  0.84950513
   0.81729408]
 [ 1.56524266  1.04047265  1.24198209  1.1669115  -1.33063935 -1.32312194
   1.1669115 ]
 [ 1.64502565  1.46893369  2.02092557  1.86614636  1.00363783  1.02296053
   1.86614636]]
2024-09-19 23:37:22 - INFO - y 샘플:
[1.86614636]
2024-09-19 23:37:22 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:37:22 - INFO - 모델 출력 (스케일링된 예측): [[0.5505433]]
2024-09-19 23:37:22 - INFO - 스케일러 역변환 후 예측 가격: 84486354.44680215
2024-09-19 23:37:22 - INFO - LSTMPredictor 최종 예측 가격: 84486354.44680215
2024-09-19 23:37:22 - INFO - LSTM prediction: 84486354.44680215
2024-09-19 23:37:22 - INFO - Attempting prediction for rl
2024-09-19 23:37:22 - INFO - Preparing state for RL agent.
2024-09-19 23:37:22 - INFO - Prepared state: [[8.47460000e+07 5.13295602e+01 1.63105144e-03 8.41293000e+07
  7.40115552e+01]]
2024-09-19 23:37:22 - INFO - RL prediction: 85585380.0
2024-09-19 23:37:22 - INFO - Attempting prediction for arima
2024-09-19 23:37:22 - INFO - ARIMA 예측 시작
2024-09-19 23:37:22 - INFO - 입력 데이터: {'open': 84690000.0, 'high': 84759000.0, 'low': 84690000.0, 'close': 84746000.0, 'volume': 51.32956017, 'value': 4349302248.98007, 'decision': 'sell', 'sma': 84129300.0, 'ema': 84141904.60817091, 'rsi': 74.01155515844388, 'macd': 327025.05047030747, 'signal_line': 299677.5837517972, 'BB_Upper': 84823347.5776185, 'BB_Lower': 83435252.4223815}
2024-09-19 23:37:22 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:37:22 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84129300.0         0         0
2024-09-19 23:37:22 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84129300.0         0         0
2024-09-19 23:37:22 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:37:22 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:37:22 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:37:22 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:37:22 - INFO - Attempting prediction for prophet
2024-09-19 23:37:22 - INFO - PROPHET prediction: 84886301.53928852
2024-09-19 23:37:22 - INFO - Attempting prediction for transformer
2024-09-19 23:37:22 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:37:22 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:37:22 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:37:22 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:37:22 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:37:22 - INFO - X 샘플:
[[-0.89805735 -1.53558318 -0.62748224 -1.20947363 -1.40233891 -1.40709302
  -1.20947363 -1.20947363  0.          0.          0.         -1.20947363
  -1.20947363]
 [-0.91301666 -0.11795902 -0.19906333 -0.23662513  1.40247492  1.39852826
  -0.23662513 -0.23662513  0.          0.          0.         -0.23662513
  -0.23662513]
 [-0.41437294 -0.61518541 -0.10385913 -0.07448371 -1.13447377 -1.13578759
  -0.07448371 -0.07448371  0.          0.          0.         -0.07448371
  -0.07448371]
 [ 0.6876297   0.09362667 -0.15146123 -0.64704559 -0.07689828 -0.07804727
  -0.64704559 -0.64704559  0.          0.          0.         -0.64704559
  -0.64704559]
 [ 0.29868759 -0.20788295 -0.90443992 -1.15880443 -0.47878028 -0.4835149
  -1.15880443 -1.15880443  0.          0.          0.         -1.15880443
  -1.15880443]
 [-1.53632132 -1.51971425 -1.72233057 -0.9915961   1.01793701  0.99465637
  -0.9915961  -0.9915961   0.          0.          0.         -0.9915961
  -0.9915961 ]
 [-0.30467132  0.11478524  0.32888724  0.46767665  0.15956392  0.16191442
   0.46767665  0.46767665  0.          0.          0.          0.46767665
   0.46767665]
 [-0.13014601  1.27850656  0.11684152  0.81729408  0.83951692  0.84950513
   0.81729408  0.81729408  0.          0.          0.          0.81729408
   0.81729408]
 [ 1.56524266  1.04047265  1.24198209  1.1669115  -1.33063935 -1.32312194
   1.1669115   1.1669115   0.          0.          0.          1.1669115
   1.1669115 ]
 [ 1.64502565  1.46893369  2.02092557  1.86614636  1.00363783  1.02296053
   1.86614636  1.86614636  0.          0.          0.          1.86614636
   1.86614636]]
2024-09-19 23:37:22 - INFO - y 샘플:
[1.86614636]
2024-09-19 23:37:22 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:37:22 - INFO - 모델 출력 (스케일링된 예측): [0.48360094]
2024-09-19 23:37:22 - INFO - 스케일러 역변환 후 예측 가격: 84473142.79675302
2024-09-19 23:37:22 - INFO - TransformerPredictor 최종 예측 가격: 84473142.79675302
2024-09-19 23:37:22 - INFO - TRANSFORMER prediction: 84473142.79675302
2024-09-19 23:37:22 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:37:22 - INFO - BITCOIN_FORECAST prediction: 83396420.50642125
2024-09-19 23:37:22 - INFO - BitcoinForecast prediction: 83396420.50642125
2024-09-19 23:37:23 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:27 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:28 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:29 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:30 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:37:30 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:37:30 - INFO - 조정된 모델 가중치: {'gpt': 0.0056448344540343835, 'ml': 0.18110369183437508, 'xgboost': 0.09500611408658545, 'rl': 0.24420630980089944, 'lstm': 0.061518118694690774, 'arima': 0.06168176576383784, 'prophet': 0.23088231748475185, 'transformer': 0.09316522470429373, 'bitcoin_forecast': 0.026791623176531502}
2024-09-19 23:37:30 - INFO - 조정된 모델 가중치: {'gpt': 0.0056448344540343835, 'ml': 0.18110369183437508, 'xgboost': 0.09500611408658545, 'rl': 0.24420630980089944, 'lstm': 0.061518118694690774, 'arima': 0.06168176576383784, 'prophet': 0.23088231748475185, 'transformer': 0.09316522470429373, 'bitcoin_forecast': 0.026791623176531502}
2024-09-19 23:37:30 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84662349.8660503, 'current_price': 84738000.0, 'predictions': {'gpt': 84738000.0, 'ml': 84712101.60000001, 'xgboost': 84746000.0, 'lstm': 84486354.44680215, 'rl': 85585380.0, 'arima': 80899000.0, 'prophet': 84886301.53928852, 'transformer': 84473142.79675302, 'bitcoin_forecast': 83396420.50642125}, 'weights': {'gpt': 0.0056448344540343835, 'ml': 0.18110369183437508, 'xgboost': 0.09500611408658545, 'rl': 0.24420630980089944, 'lstm': 0.061518118694690774, 'arima': 0.06168176576383784, 'prophet': 0.23088231748475185, 'transformer': 0.09316522470429373, 'bitcoin_forecast': 0.026791623176531502}}
2024-09-19 23:37:30 - INFO - 모델별 가중치:
2024-09-19 23:37:30 - INFO -   - GPT: 0.0056
2024-09-19 23:37:30 - INFO -   - ML: 0.1811
2024-09-19 23:37:30 - INFO -   - XGBOOST: 0.0950
2024-09-19 23:37:30 - INFO -   - RL: 0.2442
2024-09-19 23:37:30 - INFO -   - LSTM: 0.0615
2024-09-19 23:37:30 - INFO -   - ARIMA: 0.0617
2024-09-19 23:37:30 - INFO -   - PROPHET: 0.2309
2024-09-19 23:37:30 - INFO -   - TRANSFORMER: 0.0932
2024-09-19 23:37:30 - INFO -   - BITCOIN_FORECAST: 0.0268
2024-09-19 23:37:30 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:37:30 - INFO - 6. 거래 실행
2024-09-19 23:37:30 - INFO - Cancelling existing orders.
2024-09-19 23:37:30 - INFO - Cancelled 1 orders.
2024-09-19 23:37:30 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84662349.8660503, 'current_price': 84738000.0, 'predictions': {'gpt': 84738000.0, 'ml': 84712101.60000001, 'xgboost': 84746000.0, 'lstm': 84486354.44680215, 'rl': 85585380.0, 'arima': 80899000.0, 'prophet': 84886301.53928852, 'transformer': 84473142.79675302, 'bitcoin_forecast': 83396420.50642125}, 'weights': {'gpt': 0.0056448344540343835, 'ml': 0.18110369183437508, 'xgboost': 0.09500611408658545, 'rl': 0.24420630980089944, 'lstm': 0.061518118694690774, 'arima': 0.06168176576383784, 'prophet': 0.23088231748475185, 'transformer': 0.09316522470429373, 'bitcoin_forecast': 0.026791623176531502}}, 현재 가격=84738000.0
2024-09-19 23:37:30 - INFO - 현재 잔고: KRW=272243.67199846, BTC=0.0024482, 총 자산가치=479699.24359846005
2024-09-19 23:37:30 - INFO - 매도 시도: 0.00024482000000000003 BTC (약 20745.557160000004 KRW)
2024-09-19 23:37:30 - INFO - 주문 결과: {'uuid': 'ac69866a-7a6a-47bd-842e-3441930f96e9', 'side': 'ask', 'ord_type': 'limit', 'price': '84738000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:37:30+09:00', 'volume': '0.00024482', 'remaining_volume': '0.00024482', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00024482', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:37:30 - INFO - sell 주문 성공: UUID=ac69866a-7a6a-47bd-842e-3441930f96e9
2024-09-19 23:37:30 - INFO - Trade executed successfully.
2024-09-19 23:37:30 - INFO - 7. summary 리포트 보내기
2024-09-19 23:37:30 - INFO - Message sent to Discord successfully.
2024-09-19 23:37:30 - INFO - Trading cycle completed.
2024-09-19 23:37:30 - INFO - Performing periodic update.
2024-09-19 23:37:30 - INFO - 계산된 시장 변동성: 0.028998904694399294
2024-09-19 23:45:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:45:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-b7ff-efd2f0abbdc1 "HTTP/1.1 200 OK"
2024-09-19 23:45:41 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:45:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:45:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8139-a8e4-f6c4bcef1f97 "HTTP/1.1 200 OK"
2024-09-19 23:45:48 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8114-9e74-eb4957a12eaa "HTTP/1.1 200 OK"
2024-09-19 23:46:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8176-aeaf-c3f151ff291a "HTTP/1.1 200 OK"
2024-09-19 23:46:13 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81be-b90d-f0e829f1e7b5 "HTTP/1.1 200 OK"
2024-09-19 23:46:19 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8139-b361-edf587412536 "HTTP/1.1 200 OK"
2024-09-19 23:46:26 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/415cdd03-adcb-4103-801e-4aff5bd8f5c0 "HTTP/1.1 200 OK"
2024-09-19 23:46:35 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8108-b189-e5cc35b9d810 "HTTP/1.1 200 OK"
2024-09-19 23:46:43 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:46:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a8-9c97-d7a2b09e7c64 "HTTP/1.1 200 OK"
2024-09-19 23:46:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:35:34.942680
2024-09-19 23:46:48 - INFO - Starting trading cycle.
2024-09-19 23:46:48 - INFO - ##################################################
2024-09-19 23:46:48 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-19 23:46:48 - INFO - ##################################################
2024-09-19 23:46:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:46:48 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:46:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:30:00
2024-09-19 23:46:48 - INFO - 새로운 데이터 범위: 2024-09-18 14:30:00 ~ 2024-09-19 23:40:00
2024-09-19 23:46:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:46:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:46:48 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:46:48 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:46:48 - INFO - Sample date values: [Timestamp('2024-09-19 23:40:00')]
2024-09-19 23:46:48 - INFO - Successfully added 1 new data points
2024-09-19 23:46:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:46:48 - INFO - Final date range: 2024-09-19 23:40:00 to 2024-09-19 23:40:00
2024-09-19 23:46:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:46:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:40:00
2024-09-19 23:46:48 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:46:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:46:49 - INFO - GPT | 이전예측가격: 84738000 | 당시BTC가격: 84738000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:46:49 - INFO - ML 모델 예측 업데이트: 정확도 43.59%, 적중/전체: 17/39
2024-09-19 23:46:49 - INFO - ML | 이전예측가격: 84712102 | 당시BTC가격: 84738000 | 예측: 하락 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1675 | 반영가중치값: 0.0200 | 새 가중치: 0.1875 | 예측 총 횟수: 39 | 예측 성공 수: 17 | 예측 성공률: 43.59%
2024-09-19 23:46:49 - INFO - XGBOOST | 이전예측가격: 84746000 | 당시BTC가격: 84738000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:46:49 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 23:46:49 - INFO - LSTM | 이전예측가격: 84486354 | 당시BTC가격: 84738000 | 예측: 하락 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 23:46:49 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 28/42
2024-09-19 23:46:49 - INFO - RL | 이전예측가격: 85585380 | 당시BTC가격: 84738000 | 예측: 상승 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3305 | 반영가중치값: -0.0200 | 새 가중치: 0.3105 | 예측 총 횟수: 42 | 예측 성공 수: 28 | 예측 성공률: 66.67%
2024-09-19 23:46:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.71%, 적중/전체: 121/234
2024-09-19 23:46:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84738000 | 예측: 하락 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 234 | 예측 성공 수: 121 | 예측 성공률: 51.71%
2024-09-19 23:46:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.79%, 적중/전체: 25/38
2024-09-19 23:46:49 - INFO - PROPHET | 이전예측가격: 84886302 | 당시BTC가격: 84738000 | 예측: 상승 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1199 | 반영가중치값: -0.0200 | 새 가중치: 0.0999 | 예측 총 횟수: 38 | 예측 성공 수: 25 | 예측 성공률: 65.79%
2024-09-19 23:46:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 23:46:49 - INFO - TRANSFORMER | 이전예측가격: 84473143 | 당시BTC가격: 84738000 | 예측: 하락 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 23:46:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-19 23:46:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 83396421 | 당시BTC가격: 84738000 | 예측: 하락 | 지금 BTC가격: 84300000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-19 23:46:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:46:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:46:49 - INFO - 새로운 가중치: {'gpt': 0.004893417038417305, 'ml': 0.16255187163467555, 'xgboost': 0.08235928639020523, 'rl': 0.26917979232317196, 'lstm': 0.12569818944174607, 'arima': 0.017337681302309803, 'prophet': 0.08658338298598195, 'transformer': 0.12569818944174607, 'bitcoin_forecast': 0.12569818944174607}
2024-09-19 23:46:49 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:46:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:46:49 - INFO - Current BTC price: 84300000.0
2024-09-19 23:46:49 - INFO - Analyzing market conditions.
2024-09-19 23:46:49 - INFO - Market analysis: {'current_price': 84300000.0, 'sma_20': 84174750.0, 'rsi_14': 57.59968672691951, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-19 23:46:49 - INFO - Starting predictions for all models
2024-09-19 23:46:49 - INFO - Attempting prediction for gpt
2024-09-19 23:46:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:46:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:46:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:46:49 - INFO - GPT prediction: 84300000.0
2024-09-19 23:46:49 - INFO - Attempting prediction for ml
2024-09-19 23:46:49 - INFO - ML prediction: 84198840.0
2024-09-19 23:46:49 - INFO - Attempting prediction for xgboost
2024-09-19 23:46:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:46:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:46:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:46:49 - INFO - XGBOOST prediction: 84300000.0
2024-09-19 23:46:49 - INFO - Attempting prediction for lstm
2024-09-19 23:46:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:46:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:46:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:46:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:46:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:46:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:46:49 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:46:49 - INFO - X 샘플:
[[-1.10000473 -0.42443838 -0.29041583 -0.34261657  1.44488544  1.44146012
  -0.34261657]
 [-0.63051914 -0.97323077 -0.19316852 -0.16803488 -1.28971056 -1.29390013
  -0.16803488]
 [ 0.407044   -0.1909097  -0.24179217 -0.78452647 -0.14974202 -0.15225047
  -0.78452647]
 [ 0.04084525 -0.52368806 -1.01092997 -1.33554993 -0.58293364 -0.58988339
  -1.33554993]
 [-1.68686171 -1.97156588 -1.84637276 -1.15551256  1.03038914  1.00554952
  -1.15551256]
 [-0.52723231 -0.16755683  0.2488647   0.41572265  0.10514236  0.10674711
   0.41572265]
 [-0.36291236  1.11685091  0.03226843  0.79216442  0.83806879  0.8488836
   0.79216442]
 [ 1.23333863  0.85413115  1.1815548   1.16860619 -1.50115891 -1.4960955
   1.16860619]
 [ 1.30845633  1.32702672  1.97721459  1.92148973  1.01497596  1.03609902
   1.92148973]
 [ 1.31784604  0.95338084  0.14277673 -0.51174258 -0.90991657 -0.90660988
  -0.51174258]]
2024-09-19 23:46:49 - INFO - y 샘플:
[-0.51174258]
2024-09-19 23:46:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:46:49 - INFO - 모델 출력 (스케일링된 예측): [[0.3871256]]
2024-09-19 23:46:49 - INFO - 스케일러 역변환 후 예측 가격: 84464758.29766756
2024-09-19 23:46:49 - INFO - LSTMPredictor 최종 예측 가격: 84464758.29766756
2024-09-19 23:46:49 - INFO - LSTM prediction: 84464758.29766756
2024-09-19 23:46:49 - INFO - Attempting prediction for rl
2024-09-19 23:46:49 - INFO - Preparing state for RL agent.
2024-09-19 23:46:49 - INFO - Prepared state: [[ 8.43000000e+07  3.15096096e+01 -5.26278526e-03  8.41747500e+07
   5.75996867e+01]]
2024-09-19 23:46:49 - INFO - RL prediction: 85143000.0
2024-09-19 23:46:49 - INFO - Attempting prediction for arima
2024-09-19 23:46:49 - INFO - ARIMA 예측 시작
2024-09-19 23:46:49 - INFO - 입력 데이터: {'open': 84692000.0, 'high': 84695000.0, 'low': 84275000.0, 'close': 84300000.0, 'volume': 31.50960962, 'value': 2662483156.21067, 'decision': 'sell', 'sma': 84174750.0, 'ema': 84156961.31215464, 'rsi': 57.59968672691951, 'macd': 299533.78076574206, 'signal_line': 299648.8231545862, 'BB_Upper': 84783231.34728855, 'BB_Lower': 83566268.65271145}
2024-09-19 23:46:49 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:46:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84174750.0         0         0
2024-09-19 23:46:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84174750.0         0         0
2024-09-19 23:46:49 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:46:49 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:46:49 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:46:49 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:46:49 - INFO - Attempting prediction for prophet
2024-09-19 23:46:50 - INFO - PROPHET prediction: 84337776.06457458
2024-09-19 23:46:50 - INFO - Attempting prediction for transformer
2024-09-19 23:46:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:46:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:46:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:46:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:46:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:46:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:46:50 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:46:50 - INFO - X 샘플:
[[-1.10000473 -0.42443838 -0.29041583 -0.34261657  1.44488544  1.44146012
  -0.34261657 -0.34261657  0.          0.          0.         -0.34261657
  -0.34261657]
 [-0.63051914 -0.97323077 -0.19316852 -0.16803488 -1.28971056 -1.29390013
  -0.16803488 -0.16803488  0.          0.          0.         -0.16803488
  -0.16803488]
 [ 0.407044   -0.1909097  -0.24179217 -0.78452647 -0.14974202 -0.15225047
  -0.78452647 -0.78452647  0.          0.          0.         -0.78452647
  -0.78452647]
 [ 0.04084525 -0.52368806 -1.01092997 -1.33554993 -0.58293364 -0.58988339
  -1.33554993 -1.33554993  0.          0.          0.         -1.33554993
  -1.33554993]
 [-1.68686171 -1.97156588 -1.84637276 -1.15551256  1.03038914  1.00554952
  -1.15551256 -1.15551256  0.          0.          0.         -1.15551256
  -1.15551256]
 [-0.52723231 -0.16755683  0.2488647   0.41572265  0.10514236  0.10674711
   0.41572265  0.41572265  0.          0.          0.          0.41572265
   0.41572265]
 [-0.36291236  1.11685091  0.03226843  0.79216442  0.83806879  0.8488836
   0.79216442  0.79216442  0.          0.          0.          0.79216442
   0.79216442]
 [ 1.23333863  0.85413115  1.1815548   1.16860619 -1.50115891 -1.4960955
   1.16860619  1.16860619  0.          0.          0.          1.16860619
   1.16860619]
 [ 1.30845633  1.32702672  1.97721459  1.92148973  1.01497596  1.03609902
   1.92148973  1.92148973  0.          0.          0.          1.92148973
   1.92148973]
 [ 1.31784604  0.95338084  0.14277673 -0.51174258 -0.90991657 -0.90660988
  -0.51174258 -0.51174258  0.          0.          0.         -0.51174258
  -0.51174258]]
2024-09-19 23:46:50 - INFO - y 샘플:
[-0.51174258]
2024-09-19 23:46:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:46:50 - INFO - 모델 출력 (스케일링된 예측): [0.47839925]
2024-09-19 23:46:50 - INFO - 스케일러 역변환 후 예측 가격: 84481488.3243483
2024-09-19 23:46:50 - INFO - TransformerPredictor 최종 예측 가격: 84481488.3243483
2024-09-19 23:46:50 - INFO - TRANSFORMER prediction: 84481488.3243483
2024-09-19 23:46:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:46:50 - INFO - BITCOIN_FORECAST prediction: 83270653.37862048
2024-09-19 23:46:50 - INFO - BitcoinForecast prediction: 83270653.37862048
2024-09-19 23:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:46:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:46:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004893417038417305, 'ml': 0.16255187163467555, 'xgboost': 0.08235928639020523, 'rl': 0.26917979232317196, 'lstm': 0.12569818944174607, 'arima': 0.017337681302309803, 'prophet': 0.08658338298598195, 'transformer': 0.12569818944174607, 'bitcoin_forecast': 0.12569818944174607}
2024-09-19 23:46:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004893417038417305, 'ml': 0.16255187163467555, 'xgboost': 0.08235928639020523, 'rl': 0.26917979232317196, 'lstm': 0.12569818944174607, 'arima': 0.017337681302309803, 'prophet': 0.08658338298598195, 'transformer': 0.12569818944174607, 'bitcoin_forecast': 0.12569818944174607}
2024-09-19 23:46:59 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84368915.7098238, 'current_price': 84300000.0, 'predictions': {'gpt': 84300000.0, 'ml': 84198840.0, 'xgboost': 84300000.0, 'lstm': 84464758.29766756, 'rl': 85143000.0, 'arima': 80899000.0, 'prophet': 84337776.06457458, 'transformer': 84481488.3243483, 'bitcoin_forecast': 83270653.37862048}, 'weights': {'gpt': 0.004893417038417305, 'ml': 0.16255187163467555, 'xgboost': 0.08235928639020523, 'rl': 0.26917979232317196, 'lstm': 0.12569818944174607, 'arima': 0.017337681302309803, 'prophet': 0.08658338298598195, 'transformer': 0.12569818944174607, 'bitcoin_forecast': 0.12569818944174607}}
2024-09-19 23:46:59 - INFO - 모델별 가중치:
2024-09-19 23:46:59 - INFO -   - GPT: 0.0049
2024-09-19 23:46:59 - INFO -   - ML: 0.1626
2024-09-19 23:46:59 - INFO -   - XGBOOST: 0.0824
2024-09-19 23:46:59 - INFO -   - RL: 0.2692
2024-09-19 23:46:59 - INFO -   - LSTM: 0.1257
2024-09-19 23:46:59 - INFO -   - ARIMA: 0.0173
2024-09-19 23:46:59 - INFO -   - PROPHET: 0.0866
2024-09-19 23:46:59 - INFO -   - TRANSFORMER: 0.1257
2024-09-19 23:46:59 - INFO -   - BITCOIN_FORECAST: 0.1257
2024-09-19 23:46:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:46:59 - INFO - 6. 거래 실행
2024-09-19 23:46:59 - INFO - Cancelling existing orders.
2024-09-19 23:46:59 - INFO - Cancelled 0 orders.
2024-09-19 23:46:59 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84368915.7098238, 'current_price': 84300000.0, 'predictions': {'gpt': 84300000.0, 'ml': 84198840.0, 'xgboost': 84300000.0, 'lstm': 84464758.29766756, 'rl': 85143000.0, 'arima': 80899000.0, 'prophet': 84337776.06457458, 'transformer': 84481488.3243483, 'bitcoin_forecast': 83270653.37862048}, 'weights': {'gpt': 0.004893417038417305, 'ml': 0.16255187163467555, 'xgboost': 0.08235928639020523, 'rl': 0.26917979232317196, 'lstm': 0.12569818944174607, 'arima': 0.017337681302309803, 'prophet': 0.08658338298598195, 'transformer': 0.12569818944174607, 'bitcoin_forecast': 0.12569818944174607}}, 현재 가격=84300000.0
2024-09-19 23:46:59 - INFO - 현재 잔고: KRW=292978.85637988, BTC=0.00220338, 총 자산가치=478723.79037988
2024-09-19 23:46:59 - INFO - 매수 시도: 0.0005678811273782681 BTC (약 47872.379037988 KRW)
2024-09-19 23:46:59 - INFO - 주문 결과: {'uuid': '0fa92e70-f0ec-46f2-ad2f-737db9c75133', 'side': 'bid', 'ord_type': 'limit', 'price': '84300000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:47:00+09:00', 'volume': '0.00056788', 'remaining_volume': '0.00056788', 'reserved_fee': '23.936142', 'remaining_fee': '23.936142', 'paid_fee': '0', 'locked': '47896.220142', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:46:59 - INFO - buy 주문 성공: UUID=0fa92e70-f0ec-46f2-ad2f-737db9c75133
2024-09-19 23:46:59 - INFO - Trade executed successfully.
2024-09-19 23:46:59 - INFO - 7. summary 리포트 보내기
2024-09-19 23:47:00 - INFO - Message sent to Discord successfully.
2024-09-19 23:47:00 - INFO - Trading cycle completed.
2024-09-19 23:47:00 - INFO - Performing periodic update.
2024-09-19 23:47:00 - INFO - 계산된 시장 변동성: 0.03037907168335479
2024-09-19 23:55:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:55:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8176-8d15-e9dd2a2d8e07 "HTTP/1.1 200 OK"
2024-09-19 23:55:47 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:55:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-ab2f-cd0a08695fb5 "HTTP/1.1 200 OK"
2024-09-19 23:55:56 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ef-85a3-ca299518e165 "HTTP/1.1 200 OK"
2024-09-19 23:56:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a3ee6e91-15ca-4799-809a-7270e4c01ea4 "HTTP/1.1 200 OK"
2024-09-19 23:56:09 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8114-8e3d-ca963363aed2 "HTTP/1.1 200 OK"
2024-09-19 23:56:18 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8188-a910-c2fd0d1f3467 "HTTP/1.1 200 OK"
2024-09-19 23:56:28 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-a90a-d5cfc1bb71d4 "HTTP/1.1 200 OK"
2024-09-19 23:56:36 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-8b10-d024ababea03 "HTTP/1.1 200 OK"
2024-09-19 23:56:42 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-19 23:56:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d9-9b1a-e83520564064 "HTTP/1.1 200 OK"
2024-09-19 23:56:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:45:34.943129
2024-09-19 23:56:47 - INFO - Starting trading cycle.
2024-09-19 23:56:47 - INFO - ##################################################
2024-09-19 23:56:47 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-19 23:56:47 - INFO - ##################################################
2024-09-19 23:56:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-19 23:56:47 - INFO - 데이터베이스 업데이트 시작
2024-09-19 23:56:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:40:00
2024-09-19 23:56:47 - INFO - 새로운 데이터 범위: 2024-09-18 14:40:00 ~ 2024-09-19 23:50:00
2024-09-19 23:56:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-19 23:56:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-19 23:56:47 - INFO - Index: Index([199], dtype='int64')
2024-09-19 23:56:47 - INFO - Date column data type: datetime64[ns]
2024-09-19 23:56:47 - INFO - Sample date values: [Timestamp('2024-09-19 23:50:00')]
2024-09-19 23:56:47 - INFO - Successfully added 1 new data points
2024-09-19 23:56:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-19 23:56:47 - INFO - Final date range: 2024-09-19 23:50:00 to 2024-09-19 23:50:00
2024-09-19 23:56:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-19 23:56:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-19 23:50:00
2024-09-19 23:56:47 - INFO - 데이터베이스 업데이트 완료
2024-09-19 23:56:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-19 23:56:47 - INFO - GPT | 이전예측가격: 84300000 | 당시BTC가격: 84300000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:56:47 - INFO - ML 모델 예측 업데이트: 정확도 45.00%, 적중/전체: 18/40
2024-09-19 23:56:47 - INFO - ML | 이전예측가격: 84198840 | 당시BTC가격: 84300000 | 예측: 하락 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1811 | 반영가중치값: 0.0200 | 새 가중치: 0.2011 | 예측 총 횟수: 40 | 예측 성공 수: 18 | 예측 성공률: 45.00%
2024-09-19 23:56:47 - INFO - XGBOOST | 이전예측가격: 84300000 | 당시BTC가격: 84300000 | 예측: 변화 없음 (평가에서 제외)
2024-09-19 23:56:47 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-19 23:56:47 - INFO - LSTM | 이전예측가격: 84464758 | 당시BTC가격: 84300000 | 예측: 상승 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0615 | 반영가중치값: -0.0200 | 새 가중치: 0.0415 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-19 23:56:47 - INFO - RL 모델 예측 업데이트: 정확도 65.12%, 적중/전체: 28/43
2024-09-19 23:56:47 - INFO - RL | 이전예측가격: 85143000 | 당시BTC가격: 84300000 | 예측: 상승 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2442 | 반영가중치값: -0.0200 | 새 가중치: 0.2242 | 예측 총 횟수: 43 | 예측 성공 수: 28 | 예측 성공률: 65.12%
2024-09-19 23:56:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.91%, 적중/전체: 122/235
2024-09-19 23:56:48 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84300000 | 예측: 하락 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0617 | 반영가중치값: 0.0200 | 새 가중치: 0.0817 | 예측 총 횟수: 235 | 예측 성공 수: 122 | 예측 성공률: 51.91%
2024-09-19 23:56:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.10%, 적중/전체: 25/39
2024-09-19 23:56:48 - INFO - PROPHET | 이전예측가격: 84337776 | 당시BTC가격: 84300000 | 예측: 상승 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2309 | 반영가중치값: -0.0200 | 새 가중치: 0.2109 | 예측 총 횟수: 39 | 예측 성공 수: 25 | 예측 성공률: 64.10%
2024-09-19 23:56:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-19 23:56:48 - INFO - TRANSFORMER | 이전예측가격: 84481488 | 당시BTC가격: 84300000 | 예측: 상승 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0932 | 반영가중치값: -0.0200 | 새 가중치: 0.0732 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-19 23:56:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-19 23:56:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 83270653 | 당시BTC가격: 84300000 | 예측: 하락 | 지금 BTC가격: 84130000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0268 | 반영가중치값: 0.0200 | 새 가중치: 0.0468 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-19 23:56:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-19 23:56:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-19 23:56:48 - INFO - 새로운 가중치: {'gpt': 0.005062495504143059, 'ml': 0.2080522726318414, 'xgboost': 0.08520498330747181, 'rl': 0.23195313754305938, 'lstm': 0.04295266223627056, 'arima': 0.08450405283332231, 'prophet': 0.21816877159423964, 'transformer': 0.07569324629745904, 'bitcoin_forecast': 0.04840837805219287}
2024-09-19 23:56:48 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-19 23:56:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-19 23:56:48 - INFO - Current BTC price: 84130000.0
2024-09-19 23:56:48 - INFO - Analyzing market conditions.
2024-09-19 23:56:48 - INFO - Market analysis: {'current_price': 84130000.0, 'sma_20': 84204050.0, 'rsi_14': 52.79413839599979, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-19 23:56:48 - INFO - Starting predictions for all models
2024-09-19 23:56:48 - INFO - Attempting prediction for gpt
2024-09-19 23:56:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-19 23:56:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:56:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-19 23:56:48 - INFO - GPT prediction: 84130000.0
2024-09-19 23:56:48 - INFO - Attempting prediction for ml
2024-09-19 23:56:48 - INFO - ML prediction: 84029044.0
2024-09-19 23:56:48 - INFO - Attempting prediction for xgboost
2024-09-19 23:56:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-19 23:56:48 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:56:48 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-19 23:56:48 - INFO - XGBOOST prediction: 84130000.0
2024-09-19 23:56:48 - INFO - Attempting prediction for lstm
2024-09-19 23:56:48 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:56:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:56:48 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-19 23:56:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:56:48 - INFO - X 샘플:
[[-0.77723935 -0.90513941 -0.15678247 -0.0536627  -1.09887542 -1.10154922
  -0.0536627 ]
 [ 0.33382078 -0.14327584 -0.20468822 -0.62038098  0.12471114  0.12216544
  -0.62038098]
 [-0.05831809 -0.46735213 -0.96247016 -1.12691678 -0.34025559 -0.34692577
  -1.12691678]
 [-1.90840918 -1.87736831 -1.78557813 -0.96141498  1.39140629  1.36319137
  -0.96141498]
 [-0.66663608 -0.12053364  0.27872439  0.48296433  0.39829158  0.39978049
   0.48296433]
 [-0.49067633  1.13028716  0.06532603  0.82901355  1.18497902  1.19526386
   0.82901355]
 [ 1.21864696  0.87443745  1.19764387  1.17506276 -1.32583375 -1.31827897
   1.17506276]
 [ 1.2990857   1.33496692  1.98155621  1.86716118  1.37486253  1.39593685
   1.86716118]
 [ 1.30914054  0.97109178  0.17420274 -0.36962068 -0.69122309 -0.68641946
  -0.36962068]
 [-0.25941495 -0.79711398 -0.58793426 -1.22220569 -1.01806271 -1.02316459
  -1.22220569]]
2024-09-19 23:56:48 - INFO - y 샘플:
[-1.22220569]
2024-09-19 23:56:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-19 23:56:48 - INFO - 모델 출력 (스케일링된 예측): [[0.22049269]]
2024-09-19 23:56:48 - INFO - 스케일러 역변환 후 예측 가격: 84417664.83265272
2024-09-19 23:56:48 - INFO - LSTMPredictor 최종 예측 가격: 84417664.83265272
2024-09-19 23:56:48 - INFO - LSTM prediction: 84417664.83265272
2024-09-19 23:56:48 - INFO - Attempting prediction for rl
2024-09-19 23:56:48 - INFO - Preparing state for RL agent.
2024-09-19 23:56:48 - INFO - Prepared state: [[ 8.41300000e+07  2.83742386e+01 -2.01660735e-03  8.42040500e+07
   5.27941384e+01]]
2024-09-19 23:56:48 - INFO - RL prediction: 84971300.0
2024-09-19 23:56:48 - INFO - Attempting prediction for arima
2024-09-19 23:56:48 - INFO - ARIMA 예측 시작
2024-09-19 23:56:48 - INFO - 입력 데이터: {'open': 84380000.0, 'high': 84384000.0, 'low': 84100000.0, 'close': 84130000.0, 'volume': 28.37423862, 'value': 2389701729.44447, 'decision': 'sell', 'sma': 84204050.0, 'ema': 84154393.56813991, 'rsi': 52.79413839599979, 'macd': 261020.29275487363, 'signal_line': 291923.1170746437, 'BB_Upper': 84740377.31610614, 'BB_Lower': 83667722.68389386}
2024-09-19 23:56:48 - INFO - Exogenous 변수 예측 시작
2024-09-19 23:56:48 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84204050.0         0         0
2024-09-19 23:56:48 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84204050.0         0         0
2024-09-19 23:56:48 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-19 23:56:48 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-19 23:56:48 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-19 23:56:48 - INFO - ARIMA prediction: 80899000.0
2024-09-19 23:56:48 - INFO - Attempting prediction for prophet
2024-09-19 23:56:48 - INFO - PROPHET prediction: 84139273.1181532
2024-09-19 23:56:48 - INFO - Attempting prediction for transformer
2024-09-19 23:56:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-19 23:56:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-19 23:56:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-19 23:56:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-19 23:56:48 - INFO - X dtype: float64, y dtype: float64
2024-09-19 23:56:48 - INFO - X 샘플:
[[-0.77723935 -0.90513941 -0.15678247 -0.0536627  -1.09887542 -1.10154922
  -0.0536627  -0.0536627   0.          0.          0.         -0.0536627
  -0.0536627 ]
 [ 0.33382078 -0.14327584 -0.20468822 -0.62038098  0.12471114  0.12216544
  -0.62038098 -0.62038098  0.          0.          0.         -0.62038098
  -0.62038098]
 [-0.05831809 -0.46735213 -0.96247016 -1.12691678 -0.34025559 -0.34692577
  -1.12691678 -1.12691678  0.          0.          0.         -1.12691678
  -1.12691678]
 [-1.90840918 -1.87736831 -1.78557813 -0.96141498  1.39140629  1.36319137
  -0.96141498 -0.96141498  0.          0.          0.         -0.96141498
  -0.96141498]
 [-0.66663608 -0.12053364  0.27872439  0.48296433  0.39829158  0.39978049
   0.48296433  0.48296433  0.          0.          0.          0.48296433
   0.48296433]
 [-0.49067633  1.13028716  0.06532603  0.82901355  1.18497902  1.19526386
   0.82901355  0.82901355  0.          0.          0.          0.82901355
   0.82901355]
 [ 1.21864696  0.87443745  1.19764387  1.17506276 -1.32583375 -1.31827897
   1.17506276  1.17506276  0.          0.          0.          1.17506276
   1.17506276]
 [ 1.2990857   1.33496692  1.98155621  1.86716118  1.37486253  1.39593685
   1.86716118  1.86716118  0.          0.          0.          1.86716118
   1.86716118]
 [ 1.30914054  0.97109178  0.17420274 -0.36962068 -0.69122309 -0.68641946
  -0.36962068 -0.36962068  0.          0.          0.         -0.36962068
  -0.36962068]
 [-0.25941495 -0.79711398 -0.58793426 -1.22220569 -1.01806271 -1.02316459
  -1.22220569 -1.22220569  0.          0.          0.         -1.22220569
  -1.22220569]]
2024-09-19 23:56:48 - INFO - y 샘플:
[-1.22220569]
2024-09-19 23:56:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-19 23:56:48 - INFO - 모델 출력 (스케일링된 예측): [0.47752038]
2024-09-19 23:56:48 - INFO - 스케일러 역변환 후 예측 가격: 84468914.5096615
2024-09-19 23:56:48 - INFO - TransformerPredictor 최종 예측 가격: 84468914.5096615
2024-09-19 23:56:48 - INFO - TRANSFORMER prediction: 84468914.5096615
2024-09-19 23:56:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-19 23:56:48 - INFO - BITCOIN_FORECAST prediction: 83309439.30323777
2024-09-19 23:56:48 - INFO - BitcoinForecast prediction: 83309439.30323777
2024-09-19 23:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-19 23:56:57 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-19 23:56:57 - INFO - 조정된 모델 가중치: {'gpt': 0.005062495504143059, 'ml': 0.2080522726318414, 'xgboost': 0.08520498330747181, 'rl': 0.23195313754305938, 'lstm': 0.04295266223627056, 'arima': 0.08450405283332231, 'prophet': 0.21816877159423964, 'transformer': 0.07569324629745904, 'bitcoin_forecast': 0.04840837805219287}
2024-09-19 23:56:57 - INFO - 조정된 모델 가중치: {'gpt': 0.005062495504143059, 'ml': 0.2080522726318414, 'xgboost': 0.08520498330747181, 'rl': 0.23195313754305938, 'lstm': 0.04295266223627056, 'arima': 0.08450405283332231, 'prophet': 0.21816877159423964, 'transformer': 0.07569324629745904, 'bitcoin_forecast': 0.04840837805219287}
2024-09-19 23:56:57 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84031416.05689517, 'current_price': 84130000.0, 'predictions': {'gpt': 84130000.0, 'ml': 84029044.0, 'xgboost': 84130000.0, 'lstm': 84417664.83265272, 'rl': 84971300.0, 'arima': 80899000.0, 'prophet': 84139273.1181532, 'transformer': 84468914.5096615, 'bitcoin_forecast': 83309439.30323777}, 'weights': {'gpt': 0.005062495504143059, 'ml': 0.2080522726318414, 'xgboost': 0.08520498330747181, 'rl': 0.23195313754305938, 'lstm': 0.04295266223627056, 'arima': 0.08450405283332231, 'prophet': 0.21816877159423964, 'transformer': 0.07569324629745904, 'bitcoin_forecast': 0.04840837805219287}}
2024-09-19 23:56:57 - INFO - 모델별 가중치:
2024-09-19 23:56:57 - INFO -   - GPT: 0.0051
2024-09-19 23:56:57 - INFO -   - ML: 0.2081
2024-09-19 23:56:57 - INFO -   - XGBOOST: 0.0852
2024-09-19 23:56:57 - INFO -   - RL: 0.2320
2024-09-19 23:56:57 - INFO -   - LSTM: 0.0430
2024-09-19 23:56:57 - INFO -   - ARIMA: 0.0845
2024-09-19 23:56:57 - INFO -   - PROPHET: 0.2182
2024-09-19 23:56:57 - INFO -   - TRANSFORMER: 0.0757
2024-09-19 23:56:57 - INFO -   - BITCOIN_FORECAST: 0.0484
2024-09-19 23:56:57 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-19 23:56:57 - INFO - 6. 거래 실행
2024-09-19 23:56:57 - INFO - Cancelling existing orders.
2024-09-19 23:56:57 - INFO - Cancelled 0 orders.
2024-09-19 23:56:57 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84031416.05689517, 'current_price': 84130000.0, 'predictions': {'gpt': 84130000.0, 'ml': 84029044.0, 'xgboost': 84130000.0, 'lstm': 84417664.83265272, 'rl': 84971300.0, 'arima': 80899000.0, 'prophet': 84139273.1181532, 'transformer': 84468914.5096615, 'bitcoin_forecast': 83309439.30323777}, 'weights': {'gpt': 0.005062495504143059, 'ml': 0.2080522726318414, 'xgboost': 0.08520498330747181, 'rl': 0.23195313754305938, 'lstm': 0.04295266223627056, 'arima': 0.08450405283332231, 'prophet': 0.21816877159423964, 'transformer': 0.07569324629745904, 'bitcoin_forecast': 0.04840837805219287}}, 현재 가격=84130000.0
2024-09-19 23:56:57 - INFO - 현재 잔고: KRW=245082.63623788, BTC=0.00277126, 총 자산가치=478228.74003788
2024-09-19 23:56:57 - INFO - 매도 시도: 0.00027712600000000004 BTC (약 23314.610380000002 KRW)
2024-09-19 23:56:57 - INFO - 주문 결과: {'uuid': 'ea9a5654-a71b-49eb-9c9d-74f64a8390c5', 'side': 'ask', 'ord_type': 'limit', 'price': '84130000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-19T23:56:57+09:00', 'volume': '0.00027712', 'remaining_volume': '0.00027712', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00027712', 'executed_volume': '0', 'trades_count': 0}
2024-09-19 23:56:57 - INFO - sell 주문 성공: UUID=ea9a5654-a71b-49eb-9c9d-74f64a8390c5
2024-09-19 23:56:57 - INFO - Trade executed successfully.
2024-09-19 23:56:57 - INFO - 7. summary 리포트 보내기
2024-09-19 23:56:57 - INFO - Message sent to Discord successfully.
2024-09-19 23:56:57 - INFO - Trading cycle completed.
2024-09-19 23:56:57 - INFO - Performing periodic update.
2024-09-19 23:56:57 - INFO - 계산된 시장 변동성: 0.030386225273405735
2024-09-20 00:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:05:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813e-b4ca-c62e8d00f239 "HTTP/1.1 200 OK"
2024-09-20 00:05:42 - INFO - Updated actual price for gpt prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:05:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8134-b835-ca0d312befc9 "HTTP/1.1 200 OK"
2024-09-20 00:05:55 - INFO - Updated actual price for ml prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-a8b7-e9203933fc1c "HTTP/1.1 200 OK"
2024-09-20 00:06:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c7-b0b0-ff0e40530825 "HTTP/1.1 200 OK"
2024-09-20 00:06:09 - INFO - Updated actual price for lstm prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815a-9c1e-f7482d482fa8 "HTTP/1.1 200 OK"
2024-09-20 00:06:16 - INFO - Updated actual price for rl prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8148-82fb-cd6c897f3f11 "HTTP/1.1 200 OK"
2024-09-20 00:06:40 - INFO - Updated actual price for arima prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/2a38497d-9d52-4149-b7f8-cca14200cb06 "HTTP/1.1 200 OK"
2024-09-20 00:06:52 - INFO - Updated actual price for prophet prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:06:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0736ab2e-93d4-4acd-8da8-708fb239b8a1 "HTTP/1.1 200 OK"
2024-09-20 00:06:58 - INFO - Updated actual price for transformer prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:07:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-8b61-c5411a77ce5b "HTTP/1.1 200 OK"
2024-09-20 00:07:03 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-19 23:55:34.945576
2024-09-20 00:07:03 - INFO - Starting trading cycle.
2024-09-20 00:07:03 - INFO - ##################################################
2024-09-20 00:07:03 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-20 00:07:03 - INFO - ##################################################
2024-09-20 00:07:03 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:07:03 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:07:03 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-19 23:50:00
2024-09-20 00:07:03 - INFO - 새로운 데이터 범위: 2024-09-18 14:50:00 ~ 2024-09-20 00:00:00
2024-09-20 00:07:03 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:07:03 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:07:03 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:07:03 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:07:03 - INFO - Sample date values: [Timestamp('2024-09-20 00:00:00')]
2024-09-20 00:07:04 - INFO - Successfully added 1 new data points
2024-09-20 00:07:04 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:07:04 - INFO - Final date range: 2024-09-20 00:00:00 to 2024-09-20 00:00:00
2024-09-20 00:07:04 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:07:04 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:00:00
2024-09-20 00:07:04 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:07:04 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:07:04 - INFO - GPT | 이전예측가격: 84130000 | 당시BTC가격: 84130000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:07:04 - INFO - ML 모델 예측 업데이트: 정확도 43.90%, 적중/전체: 18/41
2024-09-20 00:07:04 - INFO - ML | 이전예측가격: 84029044 | 당시BTC가격: 84130000 | 예측: 하락 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1626 | 반영가중치값: -0.0200 | 새 가중치: 0.1426 | 예측 총 횟수: 41 | 예측 성공 수: 18 | 예측 성공률: 43.90%
2024-09-20 00:07:04 - INFO - XGBOOST | 이전예측가격: 84130000 | 당시BTC가격: 84130000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:07:04 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 00:07:04 - INFO - LSTM | 이전예측가격: 84417665 | 당시BTC가격: 84130000 | 예측: 상승 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1257 | 반영가중치값: 0.0200 | 새 가중치: 0.1457 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 00:07:04 - INFO - RL 모델 예측 업데이트: 정확도 65.91%, 적중/전체: 29/44
2024-09-20 00:07:04 - INFO - RL | 이전예측가격: 84971300 | 당시BTC가격: 84130000 | 예측: 상승 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2692 | 반영가중치값: 0.0200 | 새 가중치: 0.2892 | 예측 총 횟수: 44 | 예측 성공 수: 29 | 예측 성공률: 65.91%
2024-09-20 00:07:04 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.69%, 적중/전체: 122/236
2024-09-20 00:07:04 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84130000 | 예측: 하락 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0173 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 236 | 예측 성공 수: 122 | 예측 성공률: 51.69%
2024-09-20 00:07:04 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.00%, 적중/전체: 26/40
2024-09-20 00:07:04 - INFO - PROPHET | 이전예측가격: 84139273 | 당시BTC가격: 84130000 | 예측: 상승 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0866 | 반영가중치값: 0.0200 | 새 가중치: 0.1066 | 예측 총 횟수: 40 | 예측 성공 수: 26 | 예측 성공률: 65.00%
2024-09-20 00:07:04 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 00:07:04 - INFO - TRANSFORMER | 이전예측가격: 84468915 | 당시BTC가격: 84130000 | 예측: 상승 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1257 | 반영가중치값: 0.0200 | 새 가중치: 0.1457 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 00:07:04 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 00:07:04 - INFO - BITCOIN_FORECAST | 이전예측가격: 83309439 | 당시BTC가격: 84130000 | 예측: 하락 | 지금 BTC가격: 84249000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1257 | 반영가중치값: -0.0200 | 새 가중치: 0.1057 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 00:07:04 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:07:04 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:07:04 - INFO - 새로운 가중치: {'gpt': 0.0049357595420229106, 'ml': 0.13898318725977324, 'xgboost': 0.08307193735650428, 'rl': 0.28194038259415816, 'lstm': 0.14205073924589862, 'arima': 0.0, 'prophet': 0.10391514405565716, 'transformer': 0.14205073924589862, 'bitcoin_forecast': 0.10305211070008702}
2024-09-20 00:07:04 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:07:04 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:07:04 - INFO - Current BTC price: 84249000.0
2024-09-20 00:07:04 - INFO - Analyzing market conditions.
2024-09-20 00:07:04 - INFO - Market analysis: {'current_price': 84249000.0, 'sma_20': 84238250.0, 'rsi_14': 55.587400836145385, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:07:04 - INFO - Starting predictions for all models
2024-09-20 00:07:04 - INFO - Attempting prediction for gpt
2024-09-20 00:07:04 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:07:04 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:07:04 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:07:04 - INFO - GPT prediction: 84249000.0
2024-09-20 00:07:04 - INFO - Attempting prediction for ml
2024-09-20 00:07:04 - INFO - ML prediction: 84164751.0
2024-09-20 00:07:04 - INFO - Attempting prediction for xgboost
2024-09-20 00:07:04 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:07:04 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:07:04 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:07:04 - INFO - XGBOOST prediction: 84249000.0
2024-09-20 00:07:04 - INFO - Attempting prediction for lstm
2024-09-20 00:07:04 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:07:04 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:07:04 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:07:04 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:07:04 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:07:04 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:07:04 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:07:04 - INFO - X 샘플:
[[ 0.36070039 -0.13367617 -0.18374817 -0.55345445  0.13905505  0.13668202
  -0.55345445]
 [-0.01694566 -0.4551758  -0.93780904 -1.05121848 -0.31682747 -0.32313637
  -1.05121848]
 [-1.79866033 -1.85398125 -1.75687516 -0.88858271  1.38100237  1.35317582
  -0.88858271]
 [-0.60278119 -0.11111479  0.29729067  0.53078401  0.40729046  0.40880929
   0.53078401]
 [-0.43332463  1.12976101  0.08494019  0.87084062  1.17860814  1.18856784
   0.87084062]
 [ 1.2128248   0.87594551  1.21169782  1.21089723 -1.28315008 -1.27528822
   1.21089723]
 [ 1.29029065  1.33281341  1.99176079  1.89101045  1.36478183  1.385274
   1.89101045]
 [ 1.29997389  0.97183136  0.19328227 -0.30703662 -0.66093801 -0.65591907
  -0.30703662]
 [-0.21061029 -0.78231579 -0.56511229 -1.14485725 -0.98139206 -0.98600756
  -1.14485725]
 [-1.10146763 -0.9740875  -0.33542708 -0.55838281 -1.22843023 -1.23215775
  -0.55838281]]
2024-09-20 00:07:04 - INFO - y 샘플:
[-0.55838281]
2024-09-20 00:07:04 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:07:04 - INFO - 모델 출력 (스케일링된 예측): [[0.09286258]]
2024-09-20 00:07:04 - INFO - 스케일러 역변환 후 예측 가격: 84381142.5047345
2024-09-20 00:07:04 - INFO - LSTMPredictor 최종 예측 가격: 84381142.5047345
2024-09-20 00:07:04 - INFO - LSTM prediction: 84381142.5047345
2024-09-20 00:07:04 - INFO - Attempting prediction for rl
2024-09-20 00:07:04 - INFO - Preparing state for RL agent.
2024-09-20 00:07:04 - INFO - Prepared state: [[8.42490000e+07 2.59571796e+01 1.41447759e-03 8.42382500e+07
  5.55874008e+01]]
2024-09-20 00:07:04 - INFO - RL prediction: 85091490.0
2024-09-20 00:07:04 - INFO - Attempting prediction for arima
2024-09-20 00:07:04 - INFO - ARIMA 예측 시작
2024-09-20 00:07:04 - INFO - 입력 데이터: {'open': 84196000.0, 'high': 84350000.0, 'low': 84153000.0, 'close': 84249000.0, 'volume': 25.95717958, 'value': 2186285969.42568, 'decision': 'sell', 'sma': 84238250.0, 'ema': 84163403.70450753, 'rsi': 55.587400836145385, 'macd': 237364.19482323527, 'signal_line': 281011.3326243621, 'BB_Upper': 84687355.2771919, 'BB_Lower': 83789144.7228081}
2024-09-20 00:07:04 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:07:04 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84238250.0         0         0
2024-09-20 00:07:04 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84238250.0         0         0
2024-09-20 00:07:04 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:07:04 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:07:04 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:07:04 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:07:04 - INFO - Attempting prediction for prophet
2024-09-20 00:07:05 - INFO - PROPHET prediction: 84271851.27768147
2024-09-20 00:07:05 - INFO - Attempting prediction for transformer
2024-09-20 00:07:05 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:07:05 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:07:05 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:07:05 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:07:05 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:07:05 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:07:05 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:07:05 - INFO - X 샘플:
[[ 0.36070039 -0.13367617 -0.18374817 -0.55345445  0.13905505  0.13668202
  -0.55345445 -0.55345445  0.          0.          0.         -0.55345445
  -0.55345445]
 [-0.01694566 -0.4551758  -0.93780904 -1.05121848 -0.31682747 -0.32313637
  -1.05121848 -1.05121848  0.          0.          0.         -1.05121848
  -1.05121848]
 [-1.79866033 -1.85398125 -1.75687516 -0.88858271  1.38100237  1.35317582
  -0.88858271 -0.88858271  0.          0.          0.         -0.88858271
  -0.88858271]
 [-0.60278119 -0.11111479  0.29729067  0.53078401  0.40729046  0.40880929
   0.53078401  0.53078401  0.          0.          0.          0.53078401
   0.53078401]
 [-0.43332463  1.12976101  0.08494019  0.87084062  1.17860814  1.18856784
   0.87084062  0.87084062  0.          0.          0.          0.87084062
   0.87084062]
 [ 1.2128248   0.87594551  1.21169782  1.21089723 -1.28315008 -1.27528822
   1.21089723  1.21089723  0.          0.          0.          1.21089723
   1.21089723]
 [ 1.29029065  1.33281341  1.99176079  1.89101045  1.36478183  1.385274
   1.89101045  1.89101045  0.          0.          0.          1.89101045
   1.89101045]
 [ 1.29997389  0.97183136  0.19328227 -0.30703662 -0.66093801 -0.65591907
  -0.30703662 -0.30703662  0.          0.          0.         -0.30703662
  -0.30703662]
 [-0.21061029 -0.78231579 -0.56511229 -1.14485725 -0.98139206 -0.98600756
  -1.14485725 -1.14485725  0.          0.          0.         -1.14485725
  -1.14485725]
 [-1.10146763 -0.9740875  -0.33542708 -0.55838281 -1.22843023 -1.23215775
  -0.55838281 -0.55838281  0.          0.          0.         -0.55838281
  -0.55838281]]
2024-09-20 00:07:05 - INFO - y 샘플:
[-0.55838281]
2024-09-20 00:07:05 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:07:05 - INFO - 모델 출력 (스케일링된 예측): [0.4763895]
2024-09-20 00:07:05 - INFO - 스케일러 역변환 후 예측 가격: 84458962.9508367
2024-09-20 00:07:05 - INFO - TransformerPredictor 최종 예측 가격: 84458962.9508367
2024-09-20 00:07:05 - INFO - TRANSFORMER prediction: 84458962.9508367
2024-09-20 00:07:05 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:07:05 - INFO - BITCOIN_FORECAST prediction: 83306212.65489359
2024-09-20 00:07:05 - INFO - BitcoinForecast prediction: 83306212.65489359
2024-09-20 00:07:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:07:17 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:07:17 - INFO - 조정된 모델 가중치: {'gpt': 0.0049357595420229106, 'ml': 0.13898318725977324, 'xgboost': 0.08307193735650428, 'rl': 0.28194038259415816, 'lstm': 0.14205073924589862, 'arima': 0.0, 'prophet': 0.10391514405565716, 'transformer': 0.14205073924589862, 'bitcoin_forecast': 0.10305211070008702}
2024-09-20 00:07:17 - INFO - 조정된 모델 가중치: {'gpt': 0.0049357595420229106, 'ml': 0.13898318725977324, 'xgboost': 0.08307193735650428, 'rl': 0.28194038259415816, 'lstm': 0.14205073924589862, 'arima': 0.0, 'prophet': 0.10391514405565716, 'transformer': 0.14205073924589862, 'bitcoin_forecast': 0.10305211070008702}
2024-09-20 00:07:17 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84428637.45920983, 'current_price': 84249000.0, 'predictions': {'gpt': 84249000.0, 'ml': 84164751.0, 'xgboost': 84249000.0, 'lstm': 84381142.5047345, 'rl': 85091490.0, 'arima': 80899000.0, 'prophet': 84271851.27768147, 'transformer': 84458962.9508367, 'bitcoin_forecast': 83306212.65489359}, 'weights': {'gpt': 0.0049357595420229106, 'ml': 0.13898318725977324, 'xgboost': 0.08307193735650428, 'rl': 0.28194038259415816, 'lstm': 0.14205073924589862, 'arima': 0.0, 'prophet': 0.10391514405565716, 'transformer': 0.14205073924589862, 'bitcoin_forecast': 0.10305211070008702}}
2024-09-20 00:07:17 - INFO - 모델별 가중치:
2024-09-20 00:07:17 - INFO -   - GPT: 0.0049
2024-09-20 00:07:17 - INFO -   - ML: 0.1390
2024-09-20 00:07:17 - INFO -   - XGBOOST: 0.0831
2024-09-20 00:07:17 - INFO -   - RL: 0.2819
2024-09-20 00:07:17 - INFO -   - LSTM: 0.1421
2024-09-20 00:07:17 - INFO -   - ARIMA: 0.0000
2024-09-20 00:07:17 - INFO -   - PROPHET: 0.1039
2024-09-20 00:07:17 - INFO -   - TRANSFORMER: 0.1421
2024-09-20 00:07:17 - INFO -   - BITCOIN_FORECAST: 0.1031
2024-09-20 00:07:17 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:07:17 - INFO - 6. 거래 실행
2024-09-20 00:07:17 - INFO - Cancelling existing orders.
2024-09-20 00:07:17 - INFO - Cancelled 0 orders.
2024-09-20 00:07:17 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84428637.45920983, 'current_price': 84249000.0, 'predictions': {'gpt': 84249000.0, 'ml': 84164751.0, 'xgboost': 84249000.0, 'lstm': 84381142.5047345, 'rl': 85091490.0, 'arima': 80899000.0, 'prophet': 84271851.27768147, 'transformer': 84458962.9508367, 'bitcoin_forecast': 83306212.65489359}, 'weights': {'gpt': 0.0049357595420229106, 'ml': 0.13898318725977324, 'xgboost': 0.08307193735650428, 'rl': 0.28194038259415816, 'lstm': 0.14205073924589862, 'arima': 0.0, 'prophet': 0.10391514405565716, 'transformer': 0.14205073924589862, 'bitcoin_forecast': 0.10305211070008702}}, 현재 가격=84249000.0
2024-09-20 00:07:17 - INFO - 현재 잔고: KRW=268385.08478508, BTC=0.00249414, 총 자산가치=478513.88564508
2024-09-20 00:07:17 - INFO - 매수 시도: 0.0005679757452849055 BTC (약 47851.388564508 KRW)
2024-09-20 00:07:17 - INFO - 주문 결과: {'uuid': '1af1e226-1fda-4322-abf0-cff79bc16243', 'side': 'bid', 'ord_type': 'limit', 'price': '84249000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:07:17+09:00', 'volume': '0.00056797', 'remaining_volume': '0.00056797', 'reserved_fee': '23.925452265', 'remaining_fee': '23.925452265', 'paid_fee': '0', 'locked': '47874.829982265', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:07:17 - INFO - buy 주문 성공: UUID=1af1e226-1fda-4322-abf0-cff79bc16243
2024-09-20 00:07:17 - INFO - Trade executed successfully.
2024-09-20 00:07:17 - INFO - 7. summary 리포트 보내기
2024-09-20 00:07:17 - INFO - Message sent to Discord successfully.
2024-09-20 00:07:17 - INFO - Trading cycle completed.
2024-09-20 00:07:17 - INFO - Performing periodic update.
2024-09-20 00:07:17 - INFO - 계산된 시장 변동성: 0.030285334327045516
2024-09-20 00:15:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:15:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-863f-e1675dc5545c "HTTP/1.1 200 OK"
2024-09-20 00:15:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:15:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:15:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8154-be03-e0a81c54f61c "HTTP/1.1 200 OK"
2024-09-20 00:15:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814a-b858-f172900807f5 "HTTP/1.1 200 OK"
2024-09-20 00:16:01 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819b-a253-d89ec664f233 "HTTP/1.1 200 OK"
2024-09-20 00:16:14 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-bf0b-d00803762d68 "HTTP/1.1 200 OK"
2024-09-20 00:16:23 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8108-b100-c9c35ddd8a23 "HTTP/1.1 200 OK"
2024-09-20 00:16:33 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-ba59-ded67197fdac "HTTP/1.1 200 OK"
2024-09-20 00:16:43 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819a-9581-dfc9193723fc "HTTP/1.1 200 OK"
2024-09-20 00:16:50 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:16:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8137-81be-c7443ec65c94 "HTTP/1.1 200 OK"
2024-09-20 00:16:57 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:05:34.945750
2024-09-20 00:16:57 - INFO - Starting trading cycle.
2024-09-20 00:16:57 - INFO - ##################################################
2024-09-20 00:16:57 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-20 00:16:57 - INFO - ##################################################
2024-09-20 00:16:57 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:16:57 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:16:57 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:00:00
2024-09-20 00:16:57 - INFO - 새로운 데이터 범위: 2024-09-18 15:00:00 ~ 2024-09-20 00:10:00
2024-09-20 00:16:57 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:16:57 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:16:57 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:16:57 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:16:57 - INFO - Sample date values: [Timestamp('2024-09-20 00:10:00')]
2024-09-20 00:16:58 - INFO - Successfully added 1 new data points
2024-09-20 00:16:58 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:16:58 - INFO - Final date range: 2024-09-20 00:10:00 to 2024-09-20 00:10:00
2024-09-20 00:16:58 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:16:58 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:10:00
2024-09-20 00:16:58 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:16:58 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:16:58 - INFO - GPT | 이전예측가격: 84249000 | 당시BTC가격: 84249000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:16:58 - INFO - ML 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 18/42
2024-09-20 00:16:58 - INFO - ML | 이전예측가격: 84164751 | 당시BTC가격: 84249000 | 예측: 하락 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2081 | 반영가중치값: -0.0200 | 새 가중치: 0.1881 | 예측 총 횟수: 42 | 예측 성공 수: 18 | 예측 성공률: 42.86%
2024-09-20 00:16:58 - INFO - XGBOOST | 이전예측가격: 84249000 | 당시BTC가격: 84249000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:16:58 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 00:16:58 - INFO - LSTM | 이전예측가격: 84381143 | 당시BTC가격: 84249000 | 예측: 상승 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0430 | 반영가중치값: 0.0200 | 새 가중치: 0.0630 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 00:16:58 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 30/45
2024-09-20 00:16:58 - INFO - RL | 이전예측가격: 85091490 | 당시BTC가격: 84249000 | 예측: 상승 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2320 | 반영가중치값: 0.0200 | 새 가중치: 0.2520 | 예측 총 횟수: 45 | 예측 성공 수: 30 | 예측 성공률: 66.67%
2024-09-20 00:16:58 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.48%, 적중/전체: 122/237
2024-09-20 00:16:58 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84249000 | 예측: 하락 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0845 | 반영가중치값: -0.0200 | 새 가중치: 0.0645 | 예측 총 횟수: 237 | 예측 성공 수: 122 | 예측 성공률: 51.48%
2024-09-20 00:16:58 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.85%, 적중/전체: 27/41
2024-09-20 00:16:58 - INFO - PROPHET | 이전예측가격: 84271851 | 당시BTC가격: 84249000 | 예측: 상승 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2182 | 반영가중치값: 0.0200 | 새 가중치: 0.2382 | 예측 총 횟수: 41 | 예측 성공 수: 27 | 예측 성공률: 65.85%
2024-09-20 00:16:58 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 00:16:58 - INFO - TRANSFORMER | 이전예측가격: 84458963 | 당시BTC가격: 84249000 | 예측: 상승 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0757 | 반영가중치값: 0.0200 | 새 가중치: 0.0957 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 00:16:58 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 00:16:58 - INFO - BITCOIN_FORECAST | 이전예측가격: 83306213 | 당시BTC가격: 84249000 | 예측: 하락 | 지금 BTC가격: 84482000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0484 | 반영가중치값: -0.0200 | 새 가중치: 0.0284 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 00:16:58 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:16:58 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:16:58 - INFO - 새로운 가중치: {'gpt': 0.004849724373967316, 'ml': 0.18477433562105947, 'xgboost': 0.08162391136773388, 'rl': 0.247561345287765, 'lstm': 0.06185533510172688, 'arima': 0.06337968342704703, 'prophet': 0.23401725446394872, 'transformer': 0.09402521841707064, 'bitcoin_forecast': 0.027913191939681083}
2024-09-20 00:16:58 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:16:58 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:16:58 - INFO - Current BTC price: 84482000.0
2024-09-20 00:16:58 - INFO - Analyzing market conditions.
2024-09-20 00:16:58 - INFO - Market analysis: {'current_price': 84482000.0, 'sma_20': 84274850.0, 'rsi_14': 60.51405414157628, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:16:58 - INFO - Starting predictions for all models
2024-09-20 00:16:58 - INFO - Attempting prediction for gpt
2024-09-20 00:16:59 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:16:59 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:16:59 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:16:59 - INFO - GPT prediction: 84482000.0
2024-09-20 00:16:59 - INFO - Attempting prediction for ml
2024-09-20 00:16:59 - INFO - ML prediction: 84482000.0
2024-09-20 00:16:59 - INFO - Attempting prediction for xgboost
2024-09-20 00:16:59 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:16:59 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:16:59 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:16:59 - INFO - XGBOOST prediction: 84482000.0
2024-09-20 00:16:59 - INFO - Attempting prediction for lstm
2024-09-20 00:16:59 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:16:59 - INFO - X 샘플:
[[ 0.13010381 -0.44483364 -0.90593894 -1.17077988 -0.08990714 -0.09569454
  -1.17077988]
 [-1.56770477 -1.84127343 -1.71896107 -1.00741525  1.37286375  1.34874392
  -1.00741525]
 [-0.42814303 -0.1013545   0.32004681  0.41831247  0.53395905  0.53500568
   0.41831247]
 [-0.26666667  1.13742273  0.10926329  0.75989308  1.19849033  1.20690513
   0.75989308]
 [ 1.30196082  0.88403648  1.22770643  1.10147368 -0.92244556 -0.91614121
   1.10147368]
 [ 1.37577858  1.34013173  2.00201322  1.78463488  1.35888889  1.37640216
   1.78463488]
 [ 1.3850058   0.97976017  0.2168059  -0.42326292 -0.38637671 -0.3824455
  -0.42326292]
 [-0.0544406  -0.77142036 -0.53599237 -1.26483831 -0.66246495 -0.66687492
  -1.26483831]
 [-0.90334489 -0.96286775 -0.30800203 -0.67573554 -0.8753015  -0.8789767
  -0.67573554]
 [-0.97254905 -0.21960142 -0.40694123  0.4777178  -1.52770617 -1.52692401
   0.4777178 ]]
2024-09-20 00:16:59 - INFO - y 샘플:
[0.4777178]
2024-09-20 00:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:16:59 - INFO - 모델 출력 (스케일링된 예측): [[0.07138977]]
2024-09-20 00:16:59 - INFO - 스케일러 역변환 후 예측 가격: 84399920.88414405
2024-09-20 00:16:59 - INFO - LSTMPredictor 최종 예측 가격: 84399920.88414405
2024-09-20 00:16:59 - INFO - LSTM prediction: 84399920.88414405
2024-09-20 00:16:59 - INFO - Attempting prediction for rl
2024-09-20 00:16:59 - INFO - Preparing state for RL agent.
2024-09-20 00:16:59 - INFO - Prepared state: [[8.44820000e+07 1.85482051e+01 2.76561146e-03 8.42748500e+07
  6.05140541e+01]]
2024-09-20 00:16:59 - INFO - RL prediction: 85326820.0
2024-09-20 00:16:59 - INFO - Attempting prediction for arima
2024-09-20 00:16:59 - INFO - ARIMA 예측 시작
2024-09-20 00:16:59 - INFO - 입력 데이터: {'open': 84181000.0, 'high': 84482000.0, 'low': 84130000.0, 'close': 84482000.0, 'volume': 18.54820514, 'value': 1564873493.36436, 'decision': 'sell', 'sma': 84274850.0, 'ema': 84193746.20884015, 'rsi': 60.51405414157628, 'macd': 234712.10447993875, 'signal_line': 271751.48699547746, 'BB_Upper': 84675527.56363642, 'BB_Lower': 83874172.43636358}
2024-09-20 00:16:59 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:16:59 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84274850.0         0         0
2024-09-20 00:16:59 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84274850.0         0         0
2024-09-20 00:16:59 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:16:59 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:16:59 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:16:59 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:16:59 - INFO - Attempting prediction for prophet
2024-09-20 00:16:59 - INFO - PROPHET prediction: 84527402.80162366
2024-09-20 00:16:59 - INFO - Attempting prediction for transformer
2024-09-20 00:16:59 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:16:59 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:16:59 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:16:59 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:16:59 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:16:59 - INFO - X 샘플:
[[ 0.13010381 -0.44483364 -0.90593894 -1.17077988 -0.08990714 -0.09569454
  -1.17077988 -1.17077988  0.          0.          0.         -1.17077988
  -1.17077988]
 [-1.56770477 -1.84127343 -1.71896107 -1.00741525  1.37286375  1.34874392
  -1.00741525 -1.00741525  0.          0.          0.         -1.00741525
  -1.00741525]
 [-0.42814303 -0.1013545   0.32004681  0.41831247  0.53395905  0.53500568
   0.41831247  0.41831247  0.          0.          0.          0.41831247
   0.41831247]
 [-0.26666667  1.13742273  0.10926329  0.75989308  1.19849033  1.20690513
   0.75989308  0.75989308  0.          0.          0.          0.75989308
   0.75989308]
 [ 1.30196082  0.88403648  1.22770643  1.10147368 -0.92244556 -0.91614121
   1.10147368  1.10147368  0.          0.          0.          1.10147368
   1.10147368]
 [ 1.37577858  1.34013173  2.00201322  1.78463488  1.35888889  1.37640216
   1.78463488  1.78463488  0.          0.          0.          1.78463488
   1.78463488]
 [ 1.3850058   0.97976017  0.2168059  -0.42326292 -0.38637671 -0.3824455
  -0.42326292 -0.42326292  0.          0.          0.         -0.42326292
  -0.42326292]
 [-0.0544406  -0.77142036 -0.53599237 -1.26483831 -0.66246495 -0.66687492
  -1.26483831 -1.26483831  0.          0.          0.         -1.26483831
  -1.26483831]
 [-0.90334489 -0.96286775 -0.30800203 -0.67573554 -0.8753015  -0.8789767
  -0.67573554 -0.67573554  0.          0.          0.         -0.67573554
  -0.67573554]
 [-0.97254905 -0.21960142 -0.40694123  0.4777178  -1.52770617 -1.52692401
   0.4777178   0.4777178   0.          0.          0.          0.4777178
   0.4777178 ]]
2024-09-20 00:16:59 - INFO - y 샘플:
[0.4777178]
2024-09-20 00:16:59 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:16:59 - INFO - 모델 출력 (스케일링된 예측): [0.47898397]
2024-09-20 00:16:59 - INFO - 스케일러 역변환 후 예측 가격: 84482255.76939431
2024-09-20 00:16:59 - INFO - TransformerPredictor 최종 예측 가격: 84482255.76939431
2024-09-20 00:16:59 - INFO - TRANSFORMER prediction: 84482255.76939431
2024-09-20 00:16:59 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:16:59 - INFO - BITCOIN_FORECAST prediction: 83292432.35297342
2024-09-20 00:16:59 - INFO - BitcoinForecast prediction: 83292432.35297342
2024-09-20 00:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:17:08 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:17:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004849724373967316, 'ml': 0.18477433562105947, 'xgboost': 0.08162391136773388, 'rl': 0.247561345287765, 'lstm': 0.06185533510172688, 'arima': 0.06337968342704703, 'prophet': 0.23401725446394872, 'transformer': 0.09402521841707064, 'bitcoin_forecast': 0.027913191939681083}
2024-09-20 00:17:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004849724373967316, 'ml': 0.18477433562105947, 'xgboost': 0.08162391136773388, 'rl': 0.247561345287765, 'lstm': 0.06185533510172688, 'arima': 0.06337968342704703, 'prophet': 0.23401725446394872, 'transformer': 0.09402521841707064, 'bitcoin_forecast': 0.027913191939681083}
2024-09-20 00:17:08 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84436422.7964882, 'current_price': 84482000.0, 'predictions': {'gpt': 84482000.0, 'ml': 84482000.0, 'xgboost': 84482000.0, 'lstm': 84399920.88414405, 'rl': 85326820.0, 'arima': 80899000.0, 'prophet': 84527402.80162366, 'transformer': 84482255.76939431, 'bitcoin_forecast': 83292432.35297342}, 'weights': {'gpt': 0.004849724373967316, 'ml': 0.18477433562105947, 'xgboost': 0.08162391136773388, 'rl': 0.247561345287765, 'lstm': 0.06185533510172688, 'arima': 0.06337968342704703, 'prophet': 0.23401725446394872, 'transformer': 0.09402521841707064, 'bitcoin_forecast': 0.027913191939681083}}
2024-09-20 00:17:08 - INFO - 모델별 가중치:
2024-09-20 00:17:08 - INFO -   - GPT: 0.0048
2024-09-20 00:17:08 - INFO -   - ML: 0.1848
2024-09-20 00:17:08 - INFO -   - XGBOOST: 0.0816
2024-09-20 00:17:08 - INFO -   - RL: 0.2476
2024-09-20 00:17:08 - INFO -   - LSTM: 0.0619
2024-09-20 00:17:08 - INFO -   - ARIMA: 0.0634
2024-09-20 00:17:08 - INFO -   - PROPHET: 0.2340
2024-09-20 00:17:08 - INFO -   - TRANSFORMER: 0.0940
2024-09-20 00:17:08 - INFO -   - BITCOIN_FORECAST: 0.0279
2024-09-20 00:17:08 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:17:08 - INFO - 6. 거래 실행
2024-09-20 00:17:08 - INFO - Cancelling existing orders.
2024-09-20 00:17:08 - INFO - Cancelled 0 orders.
2024-09-20 00:17:08 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84436422.7964882, 'current_price': 84482000.0, 'predictions': {'gpt': 84482000.0, 'ml': 84482000.0, 'xgboost': 84482000.0, 'lstm': 84399920.88414405, 'rl': 85326820.0, 'arima': 80899000.0, 'prophet': 84527402.80162366, 'transformer': 84482255.76939431, 'bitcoin_forecast': 83292432.35297342}, 'weights': {'gpt': 0.004849724373967316, 'ml': 0.18477433562105947, 'xgboost': 0.08162391136773388, 'rl': 0.247561345287765, 'lstm': 0.06185533510172688, 'arima': 0.06337968342704703, 'prophet': 0.23401725446394872, 'transformer': 0.09402521841707064, 'bitcoin_forecast': 0.027913191939681083}}, 현재 가격=84482000.0
2024-09-20 00:17:08 - INFO - 현재 잔고: KRW=220510.25480282, BTC=0.00306211, 총 자산가치=479203.43182282
2024-09-20 00:17:08 - INFO - 매도 시도: 0.000306211 BTC (약 25869.317702000004 KRW)
2024-09-20 00:17:08 - INFO - 주문 결과: {'uuid': '387bd30b-a10b-4823-b913-5c83b53e92a4', 'side': 'ask', 'ord_type': 'limit', 'price': '84482000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:17:08+09:00', 'volume': '0.00030621', 'remaining_volume': '0.00030621', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00030621', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:17:08 - INFO - sell 주문 성공: UUID=387bd30b-a10b-4823-b913-5c83b53e92a4
2024-09-20 00:17:08 - INFO - Trade executed successfully.
2024-09-20 00:17:08 - INFO - 7. summary 리포트 보내기
2024-09-20 00:17:08 - INFO - Message sent to Discord successfully.
2024-09-20 00:17:08 - INFO - Trading cycle completed.
2024-09-20 00:17:08 - INFO - Performing periodic update.
2024-09-20 00:17:08 - INFO - 계산된 시장 변동성: 0.03042276864521772
2024-09-20 00:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:25:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-9088-f64f6b5ca56a "HTTP/1.1 200 OK"
2024-09-20 00:25:45 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fc-a91b-f86f077e2722 "HTTP/1.1 200 OK"
2024-09-20 00:26:01 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812d-9b0e-d5d3426b33c4 "HTTP/1.1 200 OK"
2024-09-20 00:26:14 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/fb4af9e3-5a7a-4f96-b341-bdd3728ff4d6 "HTTP/1.1 200 OK"
2024-09-20 00:26:29 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-8a9a-f4799f68f7ab "HTTP/1.1 200 OK"
2024-09-20 00:26:35 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-bd7e-d112a82dd373 "HTTP/1.1 200 OK"
2024-09-20 00:26:40 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b6-a850-c59c03f087d9 "HTTP/1.1 200 OK"
2024-09-20 00:26:48 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:26:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8120-8bfd-d63411026514 "HTTP/1.1 200 OK"
2024-09-20 00:26:54 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:27:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8188-9e98-d94032006e73 "HTTP/1.1 200 OK"
2024-09-20 00:27:00 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:15:34.946205
2024-09-20 00:27:00 - INFO - Starting trading cycle.
2024-09-20 00:27:00 - INFO - ##################################################
2024-09-20 00:27:00 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-20 00:27:00 - INFO - ##################################################
2024-09-20 00:27:00 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:27:00 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:27:00 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:10:00
2024-09-20 00:27:00 - INFO - 새로운 데이터 범위: 2024-09-18 15:10:00 ~ 2024-09-20 00:20:00
2024-09-20 00:27:00 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:27:00 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:27:00 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:27:00 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:27:00 - INFO - Sample date values: [Timestamp('2024-09-20 00:20:00')]
2024-09-20 00:27:01 - INFO - Successfully added 1 new data points
2024-09-20 00:27:01 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:27:01 - INFO - Final date range: 2024-09-20 00:20:00 to 2024-09-20 00:20:00
2024-09-20 00:27:01 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:27:01 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:20:00
2024-09-20 00:27:01 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:27:01 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:27:01 - INFO - GPT | 이전예측가격: 84482000 | 당시BTC가격: 84482000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:27:01 - INFO - ML | 이전예측가격: 84482000 | 당시BTC가격: 84482000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:27:01 - INFO - XGBOOST | 이전예측가격: 84482000 | 당시BTC가격: 84482000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:27:01 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 00:27:01 - INFO - LSTM | 이전예측가격: 84399921 | 당시BTC가격: 84482000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1421 | 반영가중치값: 0.0200 | 새 가중치: 0.1621 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 00:27:01 - INFO - RL 모델 예측 업데이트: 정확도 65.22%, 적중/전체: 30/46
2024-09-20 00:27:01 - INFO - RL | 이전예측가격: 85326820 | 당시BTC가격: 84482000 | 예측: 상승 | 지금 BTC가격: 84362000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2819 | 반영가중치값: -0.0200 | 새 가중치: 0.2619 | 예측 총 횟수: 46 | 예측 성공 수: 30 | 예측 성공률: 65.22%
2024-09-20 00:27:01 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.68%, 적중/전체: 123/238
2024-09-20 00:27:01 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84482000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 238 | 예측 성공 수: 123 | 예측 성공률: 51.68%
2024-09-20 00:27:01 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 27/42
2024-09-20 00:27:01 - INFO - PROPHET | 이전예측가격: 84527403 | 당시BTC가격: 84482000 | 예측: 상승 | 지금 BTC가격: 84362000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1039 | 반영가중치값: -0.0200 | 새 가중치: 0.0839 | 예측 총 횟수: 42 | 예측 성공 수: 27 | 예측 성공률: 64.29%
2024-09-20 00:27:01 - INFO - TRANSFORMER | 이전예측가격: 84482256 | 당시BTC가격: 84482000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:27:01 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-20 00:27:01 - INFO - BITCOIN_FORECAST | 이전예측가격: 83292432 | 당시BTC가격: 84482000 | 예측: 하락 | 지금 BTC가격: 84362000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1031 | 반영가중치값: 0.0200 | 새 가중치: 0.1231 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-20 00:27:01 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:27:01 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:27:01 - INFO - 새로운 가중치: {'gpt': 0.004772263069197656, 'ml': 0.18182306251325484, 'xgboost': 0.08032018889045513, 'rl': 0.2577565894044827, 'lstm': 0.15946241448083437, 'arima': 0.019680553784930697, 'prophet': 0.08257482529787841, 'transformer': 0.09252341840985075, 'bitcoin_forecast': 0.12108668414911543}
2024-09-20 00:27:01 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:27:01 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:27:01 - INFO - Current BTC price: 84362000.0
2024-09-20 00:27:01 - INFO - Analyzing market conditions.
2024-09-20 00:27:01 - INFO - Market analysis: {'current_price': 84362000.0, 'sma_20': 84287950.0, 'rsi_14': 57.00668401011443, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:27:01 - INFO - Starting predictions for all models
2024-09-20 00:27:01 - INFO - Attempting prediction for gpt
2024-09-20 00:27:01 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:27:01 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:27:01 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:27:01 - INFO - GPT prediction: 84362000.0
2024-09-20 00:27:01 - INFO - Attempting prediction for ml
2024-09-20 00:27:01 - INFO - ML prediction: 84395744.8
2024-09-20 00:27:01 - INFO - Attempting prediction for xgboost
2024-09-20 00:27:01 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:27:01 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:27:01 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:27:01 - INFO - XGBOOST prediction: 84362000.0
2024-09-20 00:27:01 - INFO - Attempting prediction for lstm
2024-09-20 00:27:01 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:27:01 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:27:01 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:27:01 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:27:01 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:27:01 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:27:01 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:27:01 - INFO - X 샘플:
[[-1.52755533e+00 -1.77464089e+00 -1.91780817e+00 -1.20482670e+00
   1.29907457e+00  1.27915262e+00 -1.20482670e+00]
 [-3.89720088e-01 -6.74054136e-02  2.20105924e-01  3.38723521e-01
   6.20023539e-01  6.20379874e-01  3.38723521e-01]
 [-2.28488373e-01  1.14810204e+00 -9.02073458e-04  7.08532429e-01
   1.15792808e+00  1.16432511e+00  7.08532429e-01]
 [ 1.33776257e+00  8.99475519e-01  1.17179342e+00  1.07834134e+00
  -5.58862510e-01 -5.54415610e-01  1.07834134e+00]
 [ 1.41146850e+00  1.34700327e+00  1.98365953e+00  1.81795915e+00
   1.28776262e+00  1.30154372e+00  1.81795915e+00]
 [ 1.42068174e+00  9.93401095e-01  1.11857109e-01 -5.72399874e-01
  -1.24941823e-01 -1.22355069e-01 -5.72399874e-01]
 [-1.65838335e-02 -7.24884448e-01 -6.77457167e-01 -1.48352327e+00
  -3.48421318e-01 -3.52618732e-01 -1.48352327e+00]
 [-8.64201991e-01 -9.12735600e-01 -4.38407701e-01 -8.45736893e-01
  -5.20701771e-01 -5.24328583e-01 -8.45736893e-01]
 [-9.33301297e-01 -1.83431126e-01 -5.42146148e-01  4.03038114e-01
  -1.04879043e+00 -1.04888304e+00  4.03038114e-01]
 [-2.10061891e-01 -7.24884448e-01  8.93052723e-02 -2.40107812e-01
  -1.76307096e+00 -1.76280029e+00 -2.40107812e-01]]
2024-09-20 00:27:01 - INFO - y 샘플:
[-0.24010781]
2024-09-20 00:27:01 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:27:01 - INFO - 모델 출력 (스케일링된 예측): [[0.03141816]]
2024-09-20 00:27:01 - INFO - 스케일러 역변환 후 예측 가격: 84412662.08907284
2024-09-20 00:27:01 - INFO - LSTMPredictor 최종 예측 가격: 84412662.08907284
2024-09-20 00:27:01 - INFO - LSTM prediction: 84412662.08907284
2024-09-20 00:27:01 - INFO - Attempting prediction for rl
2024-09-20 00:27:01 - INFO - Preparing state for RL agent.
2024-09-20 00:27:01 - INFO - Prepared state: [[ 8.43620000e+07  8.52699742e+00 -1.42042092e-03  8.42879500e+07
   5.70066840e+01]]
2024-09-20 00:27:01 - INFO - RL prediction: 85205620.0
2024-09-20 00:27:01 - INFO - Attempting prediction for arima
2024-09-20 00:27:01 - INFO - ARIMA 예측 시작
2024-09-20 00:27:01 - INFO - 입력 데이터: {'open': 84338000.0, 'high': 84384000.0, 'low': 84270000.0, 'close': 84362000.0, 'volume': 8.52699742, 'value': 719132726.36483, 'decision': 'sell', 'sma': 84287950.0, 'ema': 84209770.3794268, 'rsi': 57.00668401011443, 'macd': 220386.82453028858, 'signal_line': 261478.55450243969, 'BB_Upper': 84681981.20435217, 'BB_Lower': 83893918.79564783}
2024-09-20 00:27:01 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:27:01 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84287950.0         0         0
2024-09-20 00:27:01 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84287950.0         0         0
2024-09-20 00:27:01 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:27:01 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:27:01 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:27:01 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:27:01 - INFO - Attempting prediction for prophet
2024-09-20 00:27:02 - INFO - PROPHET prediction: 84382264.71626453
2024-09-20 00:27:02 - INFO - Attempting prediction for transformer
2024-09-20 00:27:02 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:27:02 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:27:02 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:27:02 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:27:02 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:27:02 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:27:02 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:27:02 - INFO - X 샘플:
[[-1.52755533e+00 -1.77464089e+00 -1.91780817e+00 -1.20482670e+00
   1.29907457e+00  1.27915262e+00 -1.20482670e+00 -1.20482670e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.20482670e+00
  -1.20482670e+00]
 [-3.89720088e-01 -6.74054136e-02  2.20105924e-01  3.38723521e-01
   6.20023539e-01  6.20379874e-01  3.38723521e-01  3.38723521e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  3.38723521e-01
   3.38723521e-01]
 [-2.28488373e-01  1.14810204e+00 -9.02073458e-04  7.08532429e-01
   1.15792808e+00  1.16432511e+00  7.08532429e-01  7.08532429e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.08532429e-01
   7.08532429e-01]
 [ 1.33776257e+00  8.99475519e-01  1.17179342e+00  1.07834134e+00
  -5.58862510e-01 -5.54415610e-01  1.07834134e+00  1.07834134e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.07834134e+00
   1.07834134e+00]
 [ 1.41146850e+00  1.34700327e+00  1.98365953e+00  1.81795915e+00
   1.28776262e+00  1.30154372e+00  1.81795915e+00  1.81795915e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.81795915e+00
   1.81795915e+00]
 [ 1.42068174e+00  9.93401095e-01  1.11857109e-01 -5.72399874e-01
  -1.24941823e-01 -1.22355069e-01 -5.72399874e-01 -5.72399874e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -5.72399874e-01
  -5.72399874e-01]
 [-1.65838335e-02 -7.24884448e-01 -6.77457167e-01 -1.48352327e+00
  -3.48421318e-01 -3.52618732e-01 -1.48352327e+00 -1.48352327e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.48352327e+00
  -1.48352327e+00]
 [-8.64201991e-01 -9.12735600e-01 -4.38407701e-01 -8.45736893e-01
  -5.20701771e-01 -5.24328583e-01 -8.45736893e-01 -8.45736893e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -8.45736893e-01
  -8.45736893e-01]
 [-9.33301297e-01 -1.83431126e-01 -5.42146148e-01  4.03038114e-01
  -1.04879043e+00 -1.04888304e+00  4.03038114e-01  4.03038114e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  4.03038114e-01
   4.03038114e-01]
 [-2.10061891e-01 -7.24884448e-01  8.93052723e-02 -2.40107812e-01
  -1.76307096e+00 -1.76280029e+00 -2.40107812e-01 -2.40107812e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.40107812e-01
  -2.40107812e-01]]
2024-09-20 00:27:02 - INFO - y 샘플:
[-0.24010781]
2024-09-20 00:27:02 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:27:02 - INFO - 모델 출력 (스케일링된 예측): [0.48095945]
2024-09-20 00:27:02 - INFO - 스케일러 역변환 후 예측 가격: 84496538.78413764
2024-09-20 00:27:02 - INFO - TransformerPredictor 최종 예측 가격: 84496538.78413764
2024-09-20 00:27:02 - INFO - TRANSFORMER prediction: 84496538.78413764
2024-09-20 00:27:02 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:27:02 - INFO - BITCOIN_FORECAST prediction: 83265492.30468494
2024-09-20 00:27:02 - INFO - BitcoinForecast prediction: 83265492.30468494
2024-09-20 00:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:27:12 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:27:12 - INFO - 조정된 모델 가중치: {'gpt': 0.004772263069197656, 'ml': 0.18182306251325484, 'xgboost': 0.08032018889045513, 'rl': 0.2577565894044827, 'lstm': 0.15946241448083437, 'arima': 0.019680553784930697, 'prophet': 0.08257482529787841, 'transformer': 0.09252341840985075, 'bitcoin_forecast': 0.12108668414911543}
2024-09-20 00:27:12 - INFO - 조정된 모델 가중치: {'gpt': 0.004772263069197656, 'ml': 0.18182306251325484, 'xgboost': 0.08032018889045513, 'rl': 0.2577565894044827, 'lstm': 0.15946241448083437, 'arima': 0.019680553784930697, 'prophet': 0.08257482529787841, 'transformer': 0.09252341840985075, 'bitcoin_forecast': 0.12108668414911543}
2024-09-20 00:27:12 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84406858.00077498, 'current_price': 84362000.0, 'predictions': {'gpt': 84362000.0, 'ml': 84395744.8, 'xgboost': 84362000.0, 'lstm': 84412662.08907284, 'rl': 85205620.0, 'arima': 80899000.0, 'prophet': 84382264.71626453, 'transformer': 84496538.78413764, 'bitcoin_forecast': 83265492.30468494}, 'weights': {'gpt': 0.004772263069197656, 'ml': 0.18182306251325484, 'xgboost': 0.08032018889045513, 'rl': 0.2577565894044827, 'lstm': 0.15946241448083437, 'arima': 0.019680553784930697, 'prophet': 0.08257482529787841, 'transformer': 0.09252341840985075, 'bitcoin_forecast': 0.12108668414911543}}
2024-09-20 00:27:12 - INFO - 모델별 가중치:
2024-09-20 00:27:12 - INFO -   - GPT: 0.0048
2024-09-20 00:27:12 - INFO -   - ML: 0.1818
2024-09-20 00:27:12 - INFO -   - XGBOOST: 0.0803
2024-09-20 00:27:12 - INFO -   - RL: 0.2578
2024-09-20 00:27:12 - INFO -   - LSTM: 0.1595
2024-09-20 00:27:12 - INFO -   - ARIMA: 0.0197
2024-09-20 00:27:12 - INFO -   - PROPHET: 0.0826
2024-09-20 00:27:12 - INFO -   - TRANSFORMER: 0.0925
2024-09-20 00:27:12 - INFO -   - BITCOIN_FORECAST: 0.1211
2024-09-20 00:27:12 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:27:12 - INFO - 6. 거래 실행
2024-09-20 00:27:12 - INFO - Cancelling existing orders.
2024-09-20 00:27:12 - INFO - Cancelled 0 orders.
2024-09-20 00:27:12 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84406858.00077498, 'current_price': 84362000.0, 'predictions': {'gpt': 84362000.0, 'ml': 84395744.8, 'xgboost': 84362000.0, 'lstm': 84412662.08907284, 'rl': 85205620.0, 'arima': 80899000.0, 'prophet': 84382264.71626453, 'transformer': 84496538.78413764, 'bitcoin_forecast': 83265492.30468494}, 'weights': {'gpt': 0.004772263069197656, 'ml': 0.18182306251325484, 'xgboost': 0.08032018889045513, 'rl': 0.2577565894044827, 'lstm': 0.15946241448083437, 'arima': 0.019680553784930697, 'prophet': 0.08257482529787841, 'transformer': 0.09252341840985075, 'bitcoin_forecast': 0.12108668414911543}}, 현재 가격=84362000.0
2024-09-20 00:27:12 - INFO - 현재 잔고: KRW=246366.55340621, BTC=0.0027559, 총 자산가치=478859.78920621
2024-09-20 00:27:12 - INFO - 매수 시도: 0.0005676249842419691 BTC (약 47885.978920621004 KRW)
2024-09-20 00:27:12 - INFO - 주문 결과: {'uuid': 'e33c4057-bb11-4f80-aba2-7e6eb3ce188a', 'side': 'bid', 'ord_type': 'limit', 'price': '84362000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:27:13+09:00', 'volume': '0.00056762', 'remaining_volume': '0.00056762', 'reserved_fee': '23.94277922', 'remaining_fee': '23.94277922', 'paid_fee': '0', 'locked': '47909.50121922', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:27:12 - INFO - buy 주문 성공: UUID=e33c4057-bb11-4f80-aba2-7e6eb3ce188a
2024-09-20 00:27:12 - INFO - Trade executed successfully.
2024-09-20 00:27:12 - INFO - 7. summary 리포트 보내기
2024-09-20 00:27:13 - INFO - Message sent to Discord successfully.
2024-09-20 00:27:13 - INFO - Trading cycle completed.
2024-09-20 00:27:13 - INFO - Performing periodic update.
2024-09-20 00:27:13 - INFO - 계산된 시장 변동성: 0.030540431228616285
2024-09-20 00:35:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8105-963e-fa50599c51e5 "HTTP/1.1 200 OK"
2024-09-20 00:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:35:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8103-bf69-ddb1dfb1c0ad "HTTP/1.1 200 OK"
2024-09-20 00:35:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:35:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-8aec-e74387510005 "HTTP/1.1 200 OK"
2024-09-20 00:35:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-a8ab-dd7172aa6d22 "HTTP/1.1 200 OK"
2024-09-20 00:36:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8142-be22-dbdc8e1853a0 "HTTP/1.1 200 OK"
2024-09-20 00:36:14 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ff-a66e-ec93999fce6c "HTTP/1.1 200 OK"
2024-09-20 00:36:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-9fa7-e4269c8a2056 "HTTP/1.1 200 OK"
2024-09-20 00:36:29 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8160-ab3a-c1e77fde3e9a "HTTP/1.1 200 OK"
2024-09-20 00:36:36 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:36:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813b-855d-cc06b03abb4a "HTTP/1.1 200 OK"
2024-09-20 00:36:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:25:34.946739
2024-09-20 00:36:43 - INFO - Starting trading cycle.
2024-09-20 00:36:43 - INFO - ##################################################
2024-09-20 00:36:43 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-20 00:36:43 - INFO - ##################################################
2024-09-20 00:36:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:36:43 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:36:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:20:00
2024-09-20 00:36:43 - INFO - 새로운 데이터 범위: 2024-09-18 15:20:00 ~ 2024-09-20 00:30:00
2024-09-20 00:36:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:36:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:36:43 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:36:43 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:36:43 - INFO - Sample date values: [Timestamp('2024-09-20 00:30:00')]
2024-09-20 00:36:43 - INFO - Successfully added 1 new data points
2024-09-20 00:36:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:36:43 - INFO - Final date range: 2024-09-20 00:30:00 to 2024-09-20 00:30:00
2024-09-20 00:36:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:36:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:30:00
2024-09-20 00:36:43 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:36:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:36:43 - INFO - GPT | 이전예측가격: 84362000 | 당시BTC가격: 84362000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:36:43 - INFO - ML 모델 예측 업데이트: 정확도 44.19%, 적중/전체: 19/43
2024-09-20 00:36:43 - INFO - ML | 이전예측가격: 84395745 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1848 | 반영가중치값: 0.0200 | 새 가중치: 0.2048 | 예측 총 횟수: 43 | 예측 성공 수: 19 | 예측 성공률: 44.19%
2024-09-20 00:36:43 - INFO - XGBOOST | 이전예측가격: 84362000 | 당시BTC가격: 84362000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:36:43 - INFO - LSTM 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 5/7
2024-09-20 00:36:43 - INFO - LSTM | 이전예측가격: 84412662 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0619 | 반영가중치값: 0.0200 | 새 가중치: 0.0819 | 예측 총 횟수: 7 | 예측 성공 수: 5 | 예측 성공률: 71.43%
2024-09-20 00:36:43 - INFO - RL 모델 예측 업데이트: 정확도 65.96%, 적중/전체: 31/47
2024-09-20 00:36:43 - INFO - RL | 이전예측가격: 85205620 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2476 | 반영가중치값: 0.0200 | 새 가중치: 0.2676 | 예측 총 횟수: 47 | 예측 성공 수: 31 | 예측 성공률: 65.96%
2024-09-20 00:36:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.46%, 적중/전체: 123/239
2024-09-20 00:36:43 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0634 | 반영가중치값: -0.0200 | 새 가중치: 0.0434 | 예측 총 횟수: 239 | 예측 성공 수: 123 | 예측 성공률: 51.46%
2024-09-20 00:36:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.12%, 적중/전체: 28/43
2024-09-20 00:36:43 - INFO - PROPHET | 이전예측가격: 84382265 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2340 | 반영가중치값: 0.0200 | 새 가중치: 0.2540 | 예측 총 횟수: 43 | 예측 성공 수: 28 | 예측 성공률: 65.12%
2024-09-20 00:36:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 00:36:43 - INFO - TRANSFORMER | 이전예측가격: 84496539 | 당시BTC가격: 84362000 | 예측: 상승 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0940 | 반영가중치값: 0.0200 | 새 가중치: 0.1140 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 00:36:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 3/7
2024-09-20 00:36:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83265492 | 당시BTC가격: 84362000 | 예측: 하락 | 지금 BTC가격: 84419000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0279 | 반영가중치값: -0.0200 | 새 가중치: 0.0079 | 예측 총 횟수: 7 | 예측 성공 수: 3 | 예측 성공률: 42.86%
2024-09-20 00:36:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:36:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:36:44 - INFO - 새로운 가중치: {'gpt': 0.004508008922651842, 'ml': 0.19343538248511533, 'xgboost': 0.075872625405818, 'rl': 0.2527456920175115, 'lstm': 0.07732276608700886, 'arima': 0.04097762363796478, 'prophet': 0.23995157706666997, 'transformer': 0.10771130899074705, 'bitcoin_forecast': 0.007475015386512733}
2024-09-20 00:36:44 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:36:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:36:44 - INFO - Current BTC price: 84419000.0
2024-09-20 00:36:44 - INFO - Analyzing market conditions.
2024-09-20 00:36:44 - INFO - Market analysis: {'current_price': 84419000.0, 'sma_20': 84300000.0, 'rsi_14': 58.244669538293394, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:36:44 - INFO - Starting predictions for all models
2024-09-20 00:36:44 - INFO - Attempting prediction for gpt
2024-09-20 00:36:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:36:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:36:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:36:44 - INFO - GPT prediction: 84419000.0
2024-09-20 00:36:44 - INFO - Attempting prediction for ml
2024-09-20 00:36:44 - INFO - ML prediction: 84452767.6
2024-09-20 00:36:44 - INFO - Attempting prediction for xgboost
2024-09-20 00:36:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:36:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:36:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:36:44 - INFO - XGBOOST prediction: 84419000.0
2024-09-20 00:36:44 - INFO - Attempting prediction for lstm
2024-09-20 00:36:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:36:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:36:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:36:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:36:44 - INFO - X 샘플:
[[-0.68623524 -0.30998319 -0.05021758  0.23110542  0.90891816  0.90445499
   0.23110542]
 [-0.5003356   1.19545394 -0.33305224  0.63480856  1.44765679  1.44761496
   0.63480856]
 [ 1.30554661  0.88752362  1.16770308  1.0385117  -0.27179589 -0.2686445
   1.0385117 ]
 [ 1.3905293   1.4417982   2.20668752  1.84591798  1.57769265  1.58463547
   1.84591798]
 [ 1.40115214  1.00385285 -0.18874884 -0.7635255   0.16279764  0.1627923
  -0.7635255 ]
 [-0.25601036 -1.12428782 -1.19887261 -1.75815642 -0.06102838 -0.06713895
  -1.75815642]
 [-1.23331132 -1.35694629 -0.89294941 -1.06191478 -0.23357598 -0.23860091
  -1.06191478]
 [-1.31298259 -0.45368401 -1.02570854  0.30131466 -0.7624835  -0.76239809
   0.30131466]
 [-0.47908993 -1.12428782 -0.21760952 -0.40077775 -1.4778716  -1.4752847
  -0.40077775]
 [ 0.37073699 -0.15943948  0.53276814 -0.06728386 -1.2903099  -1.28743057
  -0.06728386]]
2024-09-20 00:36:44 - INFO - y 샘플:
[-0.06728386]
2024-09-20 00:36:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:36:44 - INFO - 모델 출력 (스케일링된 예측): [[0.03200907]]
2024-09-20 00:36:44 - INFO - 스케일러 역변환 후 예측 가격: 84435970.9154789
2024-09-20 00:36:44 - INFO - LSTMPredictor 최종 예측 가격: 84435970.9154789
2024-09-20 00:36:44 - INFO - LSTM prediction: 84435970.9154789
2024-09-20 00:36:44 - INFO - Attempting prediction for rl
2024-09-20 00:36:44 - INFO - Preparing state for RL agent.
2024-09-20 00:36:44 - INFO - Prepared state: [[8.44190000e+07 1.11543752e+01 6.75659657e-04 8.43000000e+07
  5.82446695e+01]]
2024-09-20 00:36:44 - INFO - RL prediction: 85263190.0
2024-09-20 00:36:44 - INFO - Attempting prediction for arima
2024-09-20 00:36:44 - INFO - ARIMA 예측 시작
2024-09-20 00:36:44 - INFO - 입력 데이터: {'open': 84498000.0, 'high': 84525000.0, 'low': 84400000.0, 'close': 84419000.0, 'volume': 11.1543752, 'value': 941995510.34599, 'decision': 'sell', 'sma': 84300000.0, 'ema': 84229697.00995758, 'rsi': 58.244669538293394, 'macd': 211198.79238136113, 'signal_line': 251422.60207822398, 'BB_Upper': 84694584.33826397, 'BB_Lower': 83905415.66173603}
2024-09-20 00:36:44 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:36:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84300000.0         0         0
2024-09-20 00:36:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84300000.0         0         0
2024-09-20 00:36:44 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:36:44 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:36:44 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:36:44 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:36:44 - INFO - Attempting prediction for prophet
2024-09-20 00:36:44 - INFO - PROPHET prediction: 84447427.65568635
2024-09-20 00:36:44 - INFO - Attempting prediction for transformer
2024-09-20 00:36:44 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:36:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:36:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:36:44 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:36:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:36:44 - INFO - X 샘플:
[[-0.68623524 -0.30998319 -0.05021758  0.23110542  0.90891816  0.90445499
   0.23110542  0.23110542  0.          0.          0.          0.23110542
   0.23110542]
 [-0.5003356   1.19545394 -0.33305224  0.63480856  1.44765679  1.44761496
   0.63480856  0.63480856  0.          0.          0.          0.63480856
   0.63480856]
 [ 1.30554661  0.88752362  1.16770308  1.0385117  -0.27179589 -0.2686445
   1.0385117   1.0385117   0.          0.          0.          1.0385117
   1.0385117 ]
 [ 1.3905293   1.4417982   2.20668752  1.84591798  1.57769265  1.58463547
   1.84591798  1.84591798  0.          0.          0.          1.84591798
   1.84591798]
 [ 1.40115214  1.00385285 -0.18874884 -0.7635255   0.16279764  0.1627923
  -0.7635255  -0.7635255   0.          0.          0.         -0.7635255
  -0.7635255 ]
 [-0.25601036 -1.12428782 -1.19887261 -1.75815642 -0.06102838 -0.06713895
  -1.75815642 -1.75815642  0.          0.          0.         -1.75815642
  -1.75815642]
 [-1.23331132 -1.35694629 -0.89294941 -1.06191478 -0.23357598 -0.23860091
  -1.06191478 -1.06191478  0.          0.          0.         -1.06191478
  -1.06191478]
 [-1.31298259 -0.45368401 -1.02570854  0.30131466 -0.7624835  -0.76239809
   0.30131466  0.30131466  0.          0.          0.          0.30131466
   0.30131466]
 [-0.47908993 -1.12428782 -0.21760952 -0.40077775 -1.4778716  -1.4752847
  -0.40077775 -0.40077775  0.          0.          0.         -0.40077775
  -0.40077775]
 [ 0.37073699 -0.15943948  0.53276814 -0.06728386 -1.2903099  -1.28743057
  -0.06728386 -0.06728386  0.          0.          0.         -0.06728386
  -0.06728386]]
2024-09-20 00:36:44 - INFO - y 샘플:
[-0.06728386]
2024-09-20 00:36:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:36:44 - INFO - 모델 출력 (스케일링된 예측): [0.4857764]
2024-09-20 00:36:44 - INFO - 스케일러 역변환 후 예측 가격: 84513527.7696232
2024-09-20 00:36:44 - INFO - TransformerPredictor 최종 예측 가격: 84513527.7696232
2024-09-20 00:36:44 - INFO - TRANSFORMER prediction: 84513527.7696232
2024-09-20 00:36:44 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:36:44 - INFO - BITCOIN_FORECAST prediction: 83318917.80824137
2024-09-20 00:36:44 - INFO - BitcoinForecast prediction: 83318917.80824137
2024-09-20 00:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:36:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:36:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004508008922651842, 'ml': 0.19343538248511533, 'xgboost': 0.075872625405818, 'rl': 0.2527456920175115, 'lstm': 0.07732276608700886, 'arima': 0.04097762363796478, 'prophet': 0.23995157706666997, 'transformer': 0.10771130899074705, 'bitcoin_forecast': 0.007475015386512733}
2024-09-20 00:36:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004508008922651842, 'ml': 0.19343538248511533, 'xgboost': 0.075872625405818, 'rl': 0.2527456920175115, 'lstm': 0.07732276608700886, 'arima': 0.04097762363796478, 'prophet': 0.23995157706666997, 'transformer': 0.10771130899074705, 'bitcoin_forecast': 0.007475015386512733}
2024-09-20 00:36:50 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84504748.0765946, 'current_price': 84419000.0, 'predictions': {'gpt': 84419000.0, 'ml': 84452767.6, 'xgboost': 84419000.0, 'lstm': 84435970.9154789, 'rl': 85263190.0, 'arima': 80899000.0, 'prophet': 84447427.65568635, 'transformer': 84513527.7696232, 'bitcoin_forecast': 83318917.80824137}, 'weights': {'gpt': 0.004508008922651842, 'ml': 0.19343538248511533, 'xgboost': 0.075872625405818, 'rl': 0.2527456920175115, 'lstm': 0.07732276608700886, 'arima': 0.04097762363796478, 'prophet': 0.23995157706666997, 'transformer': 0.10771130899074705, 'bitcoin_forecast': 0.007475015386512733}}
2024-09-20 00:36:50 - INFO - 모델별 가중치:
2024-09-20 00:36:50 - INFO -   - GPT: 0.0045
2024-09-20 00:36:50 - INFO -   - ML: 0.1934
2024-09-20 00:36:50 - INFO -   - XGBOOST: 0.0759
2024-09-20 00:36:50 - INFO -   - RL: 0.2527
2024-09-20 00:36:50 - INFO -   - LSTM: 0.0773
2024-09-20 00:36:50 - INFO -   - ARIMA: 0.0410
2024-09-20 00:36:50 - INFO -   - PROPHET: 0.2400
2024-09-20 00:36:50 - INFO -   - TRANSFORMER: 0.1077
2024-09-20 00:36:50 - INFO -   - BITCOIN_FORECAST: 0.0075
2024-09-20 00:36:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:36:50 - INFO - 6. 거래 실행
2024-09-20 00:36:50 - INFO - Cancelling existing orders.
2024-09-20 00:36:50 - INFO - Cancelled 1 orders.
2024-09-20 00:36:50 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84504748.0765946, 'current_price': 84419000.0, 'predictions': {'gpt': 84419000.0, 'ml': 84452767.6, 'xgboost': 84419000.0, 'lstm': 84435970.9154789, 'rl': 85263190.0, 'arima': 80899000.0, 'prophet': 84447427.65568635, 'transformer': 84513527.7696232, 'bitcoin_forecast': 83318917.80824137}, 'weights': {'gpt': 0.004508008922651842, 'ml': 0.19343538248511533, 'xgboost': 0.075872625405818, 'rl': 0.2527456920175115, 'lstm': 0.07732276608700886, 'arima': 0.04097762363796478, 'prophet': 0.23995157706666997, 'transformer': 0.10771130899074705, 'bitcoin_forecast': 0.007475015386512733}}, 현재 가격=84419000.0
2024-09-20 00:36:51 - INFO - 현재 잔고: KRW=246366.55340621, BTC=0.0027559, 총 자산가치=479016.87550621
2024-09-20 00:36:51 - INFO - 매수 시도: 0.0005674278012132459 BTC (약 47901.687550621005 KRW)
2024-09-20 00:36:51 - INFO - 주문 결과: {'uuid': 'f3e41197-8806-4bc4-bbf6-f24ca92bed0d', 'side': 'bid', 'ord_type': 'limit', 'price': '84419000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:36:51+09:00', 'volume': '0.00056742', 'remaining_volume': '0.00056742', 'reserved_fee': '23.95051449', 'remaining_fee': '23.95051449', 'paid_fee': '0', 'locked': '47924.97949449', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:36:51 - INFO - buy 주문 성공: UUID=f3e41197-8806-4bc4-bbf6-f24ca92bed0d
2024-09-20 00:36:51 - INFO - Trade executed successfully.
2024-09-20 00:36:51 - INFO - 7. summary 리포트 보내기
2024-09-20 00:36:51 - INFO - Message sent to Discord successfully.
2024-09-20 00:36:51 - INFO - Trading cycle completed.
2024-09-20 00:36:51 - INFO - Performing periodic update.
2024-09-20 00:36:51 - INFO - 계산된 시장 변동성: 0.030210271629578154
2024-09-20 00:45:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816c-b9bf-ea96a32c9f62 "HTTP/1.1 200 OK"
2024-09-20 00:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:45:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8191-8736-fc4e774ea40d "HTTP/1.1 200 OK"
2024-09-20 00:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:45:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-9e98-f88f630c196b "HTTP/1.1 200 OK"
2024-09-20 00:45:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-be5e-fd80c8a61e71 "HTTP/1.1 200 OK"
2024-09-20 00:46:08 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-8590-cc1aaf8c987a "HTTP/1.1 200 OK"
2024-09-20 00:46:14 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dd-85dd-e6b6ed4103f2 "HTTP/1.1 200 OK"
2024-09-20 00:46:21 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8147-b118-f8d22c661c42 "HTTP/1.1 200 OK"
2024-09-20 00:46:28 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/016d962c-60c9-4f2c-9813-b434189ebfde "HTTP/1.1 200 OK"
2024-09-20 00:46:37 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:46:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81df-99b3-d284b0117ee7 "HTTP/1.1 200 OK"
2024-09-20 00:46:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:35:34.947023
2024-09-20 00:46:45 - INFO - Starting trading cycle.
2024-09-20 00:46:45 - INFO - ##################################################
2024-09-20 00:46:45 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-20 00:46:45 - INFO - ##################################################
2024-09-20 00:46:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:46:45 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:46:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:30:00
2024-09-20 00:46:45 - INFO - 새로운 데이터 범위: 2024-09-18 15:30:00 ~ 2024-09-20 00:40:00
2024-09-20 00:46:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:46:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:46:45 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:46:45 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:46:45 - INFO - Sample date values: [Timestamp('2024-09-20 00:40:00')]
2024-09-20 00:46:45 - INFO - Successfully added 1 new data points
2024-09-20 00:46:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:46:45 - INFO - Final date range: 2024-09-20 00:40:00 to 2024-09-20 00:40:00
2024-09-20 00:46:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:46:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:40:00
2024-09-20 00:46:45 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:46:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:46:45 - INFO - GPT | 이전예측가격: 84419000 | 당시BTC가격: 84419000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:46:45 - INFO - ML 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 20/44
2024-09-20 00:46:45 - INFO - ML | 이전예측가격: 84452768 | 당시BTC가격: 84419000 | 예측: 상승 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1818 | 반영가중치값: 0.0200 | 새 가중치: 0.2018 | 예측 총 횟수: 44 | 예측 성공 수: 20 | 예측 성공률: 45.45%
2024-09-20 00:46:45 - INFO - XGBOOST | 이전예측가격: 84419000 | 당시BTC가격: 84419000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:46:45 - INFO - LSTM 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 6/8
2024-09-20 00:46:45 - INFO - LSTM | 이전예측가격: 84435971 | 당시BTC가격: 84419000 | 예측: 상승 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1595 | 반영가중치값: 0.0200 | 새 가중치: 0.1795 | 예측 총 횟수: 8 | 예측 성공 수: 6 | 예측 성공률: 75.00%
2024-09-20 00:46:45 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 32/48
2024-09-20 00:46:45 - INFO - RL | 이전예측가격: 85263190 | 당시BTC가격: 84419000 | 예측: 상승 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2578 | 반영가중치값: 0.0200 | 새 가중치: 0.2778 | 예측 총 횟수: 48 | 예측 성공 수: 32 | 예측 성공률: 66.67%
2024-09-20 00:46:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.25%, 적중/전체: 123/240
2024-09-20 00:46:45 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84419000 | 예측: 하락 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0197 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 240 | 예측 성공 수: 123 | 예측 성공률: 51.25%
2024-09-20 00:46:45 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.91%, 적중/전체: 29/44
2024-09-20 00:46:45 - INFO - PROPHET | 이전예측가격: 84447428 | 당시BTC가격: 84419000 | 예측: 상승 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0826 | 반영가중치값: 0.0200 | 새 가중치: 0.1026 | 예측 총 횟수: 44 | 예측 성공 수: 29 | 예측 성공률: 65.91%
2024-09-20 00:46:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 5/7
2024-09-20 00:46:45 - INFO - TRANSFORMER | 이전예측가격: 84513528 | 당시BTC가격: 84419000 | 예측: 상승 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0925 | 반영가중치값: 0.0200 | 새 가중치: 0.1125 | 예측 총 횟수: 7 | 예측 성공 수: 5 | 예측 성공률: 71.43%
2024-09-20 00:46:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-20 00:46:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 83318918 | 당시BTC가격: 84419000 | 예측: 하락 | 지금 BTC가격: 84575000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1211 | 반영가중치값: -0.0200 | 새 가중치: 0.1011 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-20 00:46:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:46:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:46:46 - INFO - 새로운 가중치: {'gpt': 0.0042705346196667835, 'ml': 0.19119136414730495, 'xgboost': 0.07187578353104769, 'rl': 0.26312484097627964, 'lstm': 0.17000863732065477, 'arima': 0.0, 'prophet': 0.0971713565915435, 'transformer': 0.106595874606176, 'bitcoin_forecast': 0.09576160820732676}
2024-09-20 00:46:46 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:46:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:46:46 - INFO - Current BTC price: 84575000.0
2024-09-20 00:46:46 - INFO - Analyzing market conditions.
2024-09-20 00:46:46 - INFO - Market analysis: {'current_price': 84575000.0, 'sma_20': 84329700.0, 'rsi_14': 61.51117718793828, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:46:46 - INFO - Starting predictions for all models
2024-09-20 00:46:46 - INFO - Attempting prediction for gpt
2024-09-20 00:46:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:46:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:46:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:46:46 - INFO - GPT prediction: 84575000.0
2024-09-20 00:46:46 - INFO - Attempting prediction for ml
2024-09-20 00:46:46 - INFO - ML prediction: 84608830.0
2024-09-20 00:46:46 - INFO - Attempting prediction for xgboost
2024-09-20 00:46:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:46:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:46:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:46:46 - INFO - XGBOOST prediction: 84575000.0
2024-09-20 00:46:46 - INFO - Attempting prediction for lstm
2024-09-20 00:46:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:46:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:46:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:46:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:46:46 - INFO - X 샘플:
[[-0.61011193  1.1206359  -0.40861605  0.55629224  1.65340857  1.65221554
   0.55629224]
 [ 1.24201357  0.81314434  1.04872513  0.94796738 -0.07886686 -0.07644116
   0.94796738]
 [ 1.32917241  1.36662914  2.05765364  1.73131768  1.78441417  1.7902258
   1.73131768]
 [ 1.34006727  0.92930782 -0.26848709 -0.80037965  0.35896764  0.35811208
  -0.80037965]
 [-0.35953024 -1.1958005  -1.2493898  -1.76537639  0.13347244  0.12651995
  -1.76537639]
 [-1.36185698 -1.42812745 -0.95231641 -1.08987867 -0.04036192 -0.04618055
  -1.08987867]
 [-1.4435684  -0.52615222 -1.08123505  0.23273451 -0.57321376 -0.57376133
   0.23273451]
 [-0.58832222 -1.1958005  -0.29651288 -0.44843966 -1.29393684 -1.29179741
  -0.44843966]
 [ 0.28326625 -0.23232695  0.43215771 -0.12488193 -1.1049764  -1.10258634
  -0.12488193]
 [ 0.16887027  0.34849043  0.71802079  0.76064449 -0.83890705 -0.83630657
   0.76064449]]
2024-09-20 00:46:46 - INFO - y 샘플:
[0.76064449]
2024-09-20 00:46:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:46:46 - INFO - 모델 출력 (스케일링된 예측): [[0.1286914]]
2024-09-20 00:46:46 - INFO - 스케일러 역변환 후 예측 가격: 84463671.1013614
2024-09-20 00:46:46 - INFO - LSTMPredictor 최종 예측 가격: 84463671.1013614
2024-09-20 00:46:46 - INFO - LSTM prediction: 84463671.1013614
2024-09-20 00:46:46 - INFO - Attempting prediction for rl
2024-09-20 00:46:46 - INFO - Preparing state for RL agent.
2024-09-20 00:46:46 - INFO - Prepared state: [[8.45750000e+07 1.48539045e+01 1.84792523e-03 8.43297000e+07
  6.15111772e+01]]
2024-09-20 00:46:46 - INFO - RL prediction: 85420750.0
2024-09-20 00:46:46 - INFO - Attempting prediction for arima
2024-09-20 00:46:46 - INFO - ARIMA 예측 시작
2024-09-20 00:46:46 - INFO - 입력 데이터: {'open': 84477000.0, 'high': 84610000.0, 'low': 84451000.0, 'close': 84575000.0, 'volume': 14.85390455, 'value': 1255633862.42221, 'decision': 'sell', 'sma': 84329700.0, 'ema': 84262583.00900924, 'rsi': 61.51117718793828, 'macd': 214037.812294513, 'signal_line': 243945.6441214818, 'BB_Upper': 84713029.1536046, 'BB_Lower': 83946370.8463954}
2024-09-20 00:46:46 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:46:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84329700.0         0         0
2024-09-20 00:46:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84329700.0         0         0
2024-09-20 00:46:46 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:46:46 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:46:46 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:46:46 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:46:46 - INFO - Attempting prediction for prophet
2024-09-20 00:46:46 - INFO - PROPHET prediction: 84623217.12405264
2024-09-20 00:46:46 - INFO - Attempting prediction for transformer
2024-09-20 00:46:46 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:46:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:46:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:46:46 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:46:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:46:46 - INFO - X 샘플:
[[-0.61011193  1.1206359  -0.40861605  0.55629224  1.65340857  1.65221554
   0.55629224  0.55629224  0.          0.          0.          0.55629224
   0.55629224]
 [ 1.24201357  0.81314434  1.04872513  0.94796738 -0.07886686 -0.07644116
   0.94796738  0.94796738  0.          0.          0.          0.94796738
   0.94796738]
 [ 1.32917241  1.36662914  2.05765364  1.73131768  1.78441417  1.7902258
   1.73131768  1.73131768  0.          0.          0.          1.73131768
   1.73131768]
 [ 1.34006727  0.92930782 -0.26848709 -0.80037965  0.35896764  0.35811208
  -0.80037965 -0.80037965  0.          0.          0.         -0.80037965
  -0.80037965]
 [-0.35953024 -1.1958005  -1.2493898  -1.76537639  0.13347244  0.12651995
  -1.76537639 -1.76537639  0.          0.          0.         -1.76537639
  -1.76537639]
 [-1.36185698 -1.42812745 -0.95231641 -1.08987867 -0.04036192 -0.04618055
  -1.08987867 -1.08987867  0.          0.          0.         -1.08987867
  -1.08987867]
 [-1.4435684  -0.52615222 -1.08123505  0.23273451 -0.57321376 -0.57376133
   0.23273451  0.23273451  0.          0.          0.          0.23273451
   0.23273451]
 [-0.58832222 -1.1958005  -0.29651288 -0.44843966 -1.29393684 -1.29179741
  -0.44843966 -0.44843966  0.          0.          0.         -0.44843966
  -0.44843966]
 [ 0.28326625 -0.23232695  0.43215771 -0.12488193 -1.1049764  -1.10258634
  -0.12488193 -0.12488193  0.          0.          0.         -0.12488193
  -0.12488193]
 [ 0.16887027  0.34849043  0.71802079  0.76064449 -0.83890705 -0.83630657
   0.76064449  0.76064449  0.          0.          0.          0.76064449
   0.76064449]]
2024-09-20 00:46:46 - INFO - y 샘플:
[0.76064449]
2024-09-20 00:46:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:46:46 - INFO - 모델 출력 (스케일링된 예측): [0.48619208]
2024-09-20 00:46:46 - INFO - 스케일러 역변환 후 예측 가격: 84526650.70730905
2024-09-20 00:46:46 - INFO - TransformerPredictor 최종 예측 가격: 84526650.70730905
2024-09-20 00:46:46 - INFO - TRANSFORMER prediction: 84526650.70730905
2024-09-20 00:46:46 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:46:46 - INFO - BITCOIN_FORECAST prediction: 83351498.77865374
2024-09-20 00:46:46 - INFO - BitcoinForecast prediction: 83351498.77865374
2024-09-20 00:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:46:56 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:46:56 - INFO - 조정된 모델 가중치: {'gpt': 0.0042705346196667835, 'ml': 0.19119136414730495, 'xgboost': 0.07187578353104769, 'rl': 0.26312484097627964, 'lstm': 0.17000863732065477, 'arima': 0.0, 'prophet': 0.0971713565915435, 'transformer': 0.106595874606176, 'bitcoin_forecast': 0.09576160820732676}
2024-09-20 00:46:56 - INFO - 조정된 모델 가중치: {'gpt': 0.0042705346196667835, 'ml': 0.19119136414730495, 'xgboost': 0.07187578353104769, 'rl': 0.26312484097627964, 'lstm': 0.17000863732065477, 'arima': 0.0, 'prophet': 0.0971713565915435, 'transformer': 0.106595874606176, 'bitcoin_forecast': 0.09576160820732676}
2024-09-20 00:46:56 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84667446.00736724, 'current_price': 84575000.0, 'predictions': {'gpt': 84575000.0, 'ml': 84608830.0, 'xgboost': 84575000.0, 'lstm': 84463671.1013614, 'rl': 85420750.0, 'arima': 80899000.0, 'prophet': 84623217.12405264, 'transformer': 84526650.70730905, 'bitcoin_forecast': 83351498.77865374}, 'weights': {'gpt': 0.0042705346196667835, 'ml': 0.19119136414730495, 'xgboost': 0.07187578353104769, 'rl': 0.26312484097627964, 'lstm': 0.17000863732065477, 'arima': 0.0, 'prophet': 0.0971713565915435, 'transformer': 0.106595874606176, 'bitcoin_forecast': 0.09576160820732676}}
2024-09-20 00:46:56 - INFO - 모델별 가중치:
2024-09-20 00:46:56 - INFO -   - GPT: 0.0043
2024-09-20 00:46:56 - INFO -   - ML: 0.1912
2024-09-20 00:46:56 - INFO -   - XGBOOST: 0.0719
2024-09-20 00:46:56 - INFO -   - RL: 0.2631
2024-09-20 00:46:56 - INFO -   - LSTM: 0.1700
2024-09-20 00:46:56 - INFO -   - ARIMA: 0.0000
2024-09-20 00:46:56 - INFO -   - PROPHET: 0.0972
2024-09-20 00:46:56 - INFO -   - TRANSFORMER: 0.1066
2024-09-20 00:46:56 - INFO -   - BITCOIN_FORECAST: 0.0958
2024-09-20 00:46:56 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:46:56 - INFO - 6. 거래 실행
2024-09-20 00:46:56 - INFO - Cancelling existing orders.
2024-09-20 00:46:56 - INFO - Cancelled 1 orders.
2024-09-20 00:46:56 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84667446.00736724, 'current_price': 84575000.0, 'predictions': {'gpt': 84575000.0, 'ml': 84608830.0, 'xgboost': 84575000.0, 'lstm': 84463671.1013614, 'rl': 85420750.0, 'arima': 80899000.0, 'prophet': 84623217.12405264, 'transformer': 84526650.70730905, 'bitcoin_forecast': 83351498.77865374}, 'weights': {'gpt': 0.0042705346196667835, 'ml': 0.19119136414730495, 'xgboost': 0.07187578353104769, 'rl': 0.26312484097627964, 'lstm': 0.17000863732065477, 'arima': 0.0, 'prophet': 0.0971713565915435, 'transformer': 0.106595874606176, 'bitcoin_forecast': 0.09576160820732676}}, 현재 가격=84575000.0
2024-09-20 00:46:56 - INFO - 현재 잔고: KRW=198441.57391172, BTC=0.0027559, 총 자산가치=431521.81641172
2024-09-20 00:46:56 - INFO - 매수 시도: 0.0005102238444123205 BTC (약 43152.18164117201 KRW)
2024-09-20 00:46:56 - INFO - 주문 결과: {'uuid': 'e60d385f-1045-4fae-a1ec-0f44d6d41b77', 'side': 'bid', 'ord_type': 'limit', 'price': '84575000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:46:57+09:00', 'volume': '0.00051022', 'remaining_volume': '0.00051022', 'reserved_fee': '21.57592825', 'remaining_fee': '21.57592825', 'paid_fee': '0', 'locked': '43173.43242825', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:46:56 - INFO - buy 주문 성공: UUID=e60d385f-1045-4fae-a1ec-0f44d6d41b77
2024-09-20 00:46:56 - INFO - Trade executed successfully.
2024-09-20 00:46:56 - INFO - 7. summary 리포트 보내기
2024-09-20 00:46:57 - INFO - Message sent to Discord successfully.
2024-09-20 00:46:57 - INFO - Trading cycle completed.
2024-09-20 00:46:57 - INFO - Performing periodic update.
2024-09-20 00:46:57 - INFO - 계산된 시장 변동성: 0.03014496829897197
2024-09-20 00:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:55:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8196-826a-e66b04daa927 "HTTP/1.1 200 OK"
2024-09-20 00:55:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:55:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b0-b17e-d25352f78be0 "HTTP/1.1 200 OK"
2024-09-20 00:55:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:55:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:55:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fa-abda-f94bb23575e4 "HTTP/1.1 200 OK"
2024-09-20 00:55:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816e-b9db-c90e0811cffb "HTTP/1.1 200 OK"
2024-09-20 00:56:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8100-a18c-d21eeae3d93c "HTTP/1.1 200 OK"
2024-09-20 00:56:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-b1a6-cd1e3f7d60d7 "HTTP/1.1 200 OK"
2024-09-20 00:56:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8140-93e2-cd36fbc22e41 "HTTP/1.1 200 OK"
2024-09-20 00:56:28 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d8-8099-f6eb8900ea8a "HTTP/1.1 200 OK"
2024-09-20 00:56:39 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 00:56:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a8-8a7f-ffd86066d461 "HTTP/1.1 200 OK"
2024-09-20 00:56:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:45:34.947231
2024-09-20 00:56:53 - INFO - Starting trading cycle.
2024-09-20 00:56:53 - INFO - ##################################################
2024-09-20 00:56:53 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-20 00:56:53 - INFO - ##################################################
2024-09-20 00:56:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 00:56:53 - INFO - 데이터베이스 업데이트 시작
2024-09-20 00:56:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:40:00
2024-09-20 00:56:53 - INFO - 새로운 데이터 범위: 2024-09-18 15:40:00 ~ 2024-09-20 00:50:00
2024-09-20 00:56:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 00:56:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 00:56:53 - INFO - Index: Index([199], dtype='int64')
2024-09-20 00:56:53 - INFO - Date column data type: datetime64[ns]
2024-09-20 00:56:53 - INFO - Sample date values: [Timestamp('2024-09-20 00:50:00')]
2024-09-20 00:56:53 - INFO - Successfully added 1 new data points
2024-09-20 00:56:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 00:56:53 - INFO - Final date range: 2024-09-20 00:50:00 to 2024-09-20 00:50:00
2024-09-20 00:56:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 00:56:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 00:50:00
2024-09-20 00:56:53 - INFO - 데이터베이스 업데이트 완료
2024-09-20 00:56:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 00:56:53 - INFO - GPT | 이전예측가격: 84575000 | 당시BTC가격: 84575000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:56:53 - INFO - ML 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 20/45
2024-09-20 00:56:53 - INFO - ML | 이전예측가격: 84608830 | 당시BTC가격: 84575000 | 예측: 상승 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1934 | 반영가중치값: -0.0200 | 새 가중치: 0.1734 | 예측 총 횟수: 45 | 예측 성공 수: 20 | 예측 성공률: 44.44%
2024-09-20 00:56:53 - INFO - XGBOOST | 이전예측가격: 84575000 | 당시BTC가격: 84575000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 00:56:53 - INFO - LSTM 모델 예측 업데이트: 정확도 77.78%, 적중/전체: 7/9
2024-09-20 00:56:53 - INFO - LSTM | 이전예측가격: 84463671 | 당시BTC가격: 84575000 | 예측: 하락 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0773 | 반영가중치값: 0.0200 | 새 가중치: 0.0973 | 예측 총 횟수: 9 | 예측 성공 수: 7 | 예측 성공률: 77.78%
2024-09-20 00:56:53 - INFO - RL 모델 예측 업데이트: 정확도 65.31%, 적중/전체: 32/49
2024-09-20 00:56:53 - INFO - RL | 이전예측가격: 85420750 | 당시BTC가격: 84575000 | 예측: 상승 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2527 | 반영가중치값: -0.0200 | 새 가중치: 0.2327 | 예측 총 횟수: 49 | 예측 성공 수: 32 | 예측 성공률: 65.31%
2024-09-20 00:56:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.45%, 적중/전체: 124/241
2024-09-20 00:56:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84575000 | 예측: 하락 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0410 | 반영가중치값: 0.0200 | 새 가중치: 0.0610 | 예측 총 횟수: 241 | 예측 성공 수: 124 | 예측 성공률: 51.45%
2024-09-20 00:56:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.44%, 적중/전체: 29/45
2024-09-20 00:56:53 - INFO - PROPHET | 이전예측가격: 84623217 | 당시BTC가격: 84575000 | 예측: 상승 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2400 | 반영가중치값: -0.0200 | 새 가중치: 0.2200 | 예측 총 횟수: 45 | 예측 성공 수: 29 | 예측 성공률: 64.44%
2024-09-20 00:56:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 6/8
2024-09-20 00:56:53 - INFO - TRANSFORMER | 이전예측가격: 84526651 | 당시BTC가격: 84575000 | 예측: 하락 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1077 | 반영가중치값: 0.0200 | 새 가중치: 0.1277 | 예측 총 횟수: 8 | 예측 성공 수: 6 | 예측 성공률: 75.00%
2024-09-20 00:56:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 4/9
2024-09-20 00:56:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 83351499 | 당시BTC가격: 84575000 | 예측: 하락 | 지금 BTC가격: 84462000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0075 | 반영가중치값: 0.0200 | 새 가중치: 0.0275 | 예측 총 횟수: 9 | 예측 성공 수: 4 | 예측 성공률: 44.44%
2024-09-20 00:56:54 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 00:56:54 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 00:56:54 - INFO - 새로운 가중치: {'gpt': 0.00420425171639694, 'ml': 0.1707434945355625, 'xgboost': 0.07076020058148144, 'rl': 0.2291332496503605, 'lstm': 0.0958122209058994, 'arima': 0.060031190863340536, 'prophet': 0.21653771196424934, 'transformer': 0.12572910369464307, 'bitcoin_forecast': 0.027048576088066354}
2024-09-20 00:56:54 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 00:56:54 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 00:56:54 - INFO - Current BTC price: 84462000.0
2024-09-20 00:56:54 - INFO - Analyzing market conditions.
2024-09-20 00:56:54 - INFO - Market analysis: {'current_price': 84462000.0, 'sma_20': 84343500.0, 'rsi_14': 57.97333414815963, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 00:56:54 - INFO - Starting predictions for all models
2024-09-20 00:56:54 - INFO - Attempting prediction for gpt
2024-09-20 00:56:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 00:56:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:56:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 00:56:54 - INFO - GPT prediction: 84462000.0
2024-09-20 00:56:54 - INFO - Attempting prediction for ml
2024-09-20 00:56:54 - INFO - ML prediction: 84495784.8
2024-09-20 00:56:54 - INFO - Attempting prediction for xgboost
2024-09-20 00:56:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 00:56:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:56:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 00:56:54 - INFO - XGBOOST prediction: 84462000.0
2024-09-20 00:56:54 - INFO - Attempting prediction for lstm
2024-09-20 00:56:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 00:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:56:54 - INFO - X 샘플:
[[ 1.06219239  0.92836431  0.96332403  1.00764039  0.22701444  0.22930616
   1.00764039]
 [ 1.14780991  1.51401469  1.97380378  1.80360132  2.33922315  2.34540113
   1.80360132]
 [ 1.1585121   1.05127859 -0.35591342 -0.76885211  0.72334206  0.72192533
  -0.76885211]
 [-0.51102959 -1.19732967 -1.33832429 -1.74938369  0.4677215   0.45938737
  -1.74938369]
 [-1.49563109 -1.44315823 -1.04079414 -1.06301159  0.27066349  0.26361026
  -1.06301159]
 [-1.57589752 -0.48876501 -1.169911    0.28089346 -0.33337543 -0.33446699
   0.28089346]
 [-0.73577558 -1.19732967 -0.3839823  -0.41124648 -1.15038454 -1.14844856
  -0.41124648]
 [ 0.12039964 -0.17786419  0.34580863 -0.08248001 -0.93617966 -0.93395471
  -0.08248001]
 [ 0.00802664  0.4367072   0.63211122  0.81730191 -0.6345644  -0.63209407
   0.81730191]
 [ 0.82139311  0.57408198  0.37387751  0.1655368  -0.9734606  -0.97066592
   0.1655368 ]]
2024-09-20 00:56:54 - INFO - y 샘플:
[0.1655368]
2024-09-20 00:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 00:56:54 - INFO - 모델 출력 (스케일링된 예측): [[0.18028769]]
2024-09-20 00:56:54 - INFO - 스케일러 역변환 후 예측 가격: 84464557.44014253
2024-09-20 00:56:54 - INFO - LSTMPredictor 최종 예측 가격: 84464557.44014253
2024-09-20 00:56:54 - INFO - LSTM prediction: 84464557.44014253
2024-09-20 00:56:54 - INFO - Attempting prediction for rl
2024-09-20 00:56:54 - INFO - Preparing state for RL agent.
2024-09-20 00:56:54 - INFO - Prepared state: [[ 8.44620000e+07  1.06970975e+01 -1.33609223e-03  8.43435000e+07
   5.79733341e+01]]
2024-09-20 00:56:54 - INFO - RL prediction: 85306620.0
2024-09-20 00:56:54 - INFO - Attempting prediction for arima
2024-09-20 00:56:54 - INFO - ARIMA 예측 시작
2024-09-20 00:56:54 - INFO - 입력 데이터: {'open': 84629000.0, 'high': 84629000.0, 'low': 84405000.0, 'close': 84462000.0, 'volume': 10.6970975, 'value': 903851926.5597, 'decision': 'sell', 'sma': 84343500.0, 'ema': 84281575.10338931, 'rsi': 57.97333414815963, 'macd': 204808.69328293204, 'signal_line': 236118.25395377187, 'BB_Upper': 84725010.41925906, 'BB_Lower': 83961989.58074094}
2024-09-20 00:56:54 - INFO - Exogenous 변수 예측 시작
2024-09-20 00:56:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84343500.0         0         0
2024-09-20 00:56:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84343500.0         0         0
2024-09-20 00:56:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 00:56:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 00:56:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 00:56:54 - INFO - ARIMA prediction: 80899000.0
2024-09-20 00:56:54 - INFO - Attempting prediction for prophet
2024-09-20 00:56:54 - INFO - PROPHET prediction: 84488187.71132176
2024-09-20 00:56:54 - INFO - Attempting prediction for transformer
2024-09-20 00:56:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 00:56:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 00:56:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 00:56:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 00:56:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 00:56:54 - INFO - X 샘플:
[[ 1.06219239  0.92836431  0.96332403  1.00764039  0.22701444  0.22930616
   1.00764039  1.00764039  0.          0.          0.          1.00764039
   1.00764039]
 [ 1.14780991  1.51401469  1.97380378  1.80360132  2.33922315  2.34540113
   1.80360132  1.80360132  0.          0.          0.          1.80360132
   1.80360132]
 [ 1.1585121   1.05127859 -0.35591342 -0.76885211  0.72334206  0.72192533
  -0.76885211 -0.76885211  0.          0.          0.         -0.76885211
  -0.76885211]
 [-0.51102959 -1.19732967 -1.33832429 -1.74938369  0.4677215   0.45938737
  -1.74938369 -1.74938369  0.          0.          0.         -1.74938369
  -1.74938369]
 [-1.49563109 -1.44315823 -1.04079414 -1.06301159  0.27066349  0.26361026
  -1.06301159 -1.06301159  0.          0.          0.         -1.06301159
  -1.06301159]
 [-1.57589752 -0.48876501 -1.169911    0.28089346 -0.33337543 -0.33446699
   0.28089346  0.28089346  0.          0.          0.          0.28089346
   0.28089346]
 [-0.73577558 -1.19732967 -0.3839823  -0.41124648 -1.15038454 -1.14844856
  -0.41124648 -0.41124648  0.          0.          0.         -0.41124648
  -0.41124648]
 [ 0.12039964 -0.17786419  0.34580863 -0.08248001 -0.93617966 -0.93395471
  -0.08248001 -0.08248001  0.          0.          0.         -0.08248001
  -0.08248001]
 [ 0.00802664  0.4367072   0.63211122  0.81730191 -0.6345644  -0.63209407
   0.81730191  0.81730191  0.          0.          0.          0.81730191
   0.81730191]
 [ 0.82139311  0.57408198  0.37387751  0.1655368  -0.9734606  -0.97066592
   0.1655368   0.1655368   0.          0.          0.          0.1655368
   0.1655368 ]]
2024-09-20 00:56:54 - INFO - y 샘플:
[0.1655368]
2024-09-20 00:56:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 00:56:54 - INFO - 모델 출력 (스케일링된 예측): [0.4837775]
2024-09-20 00:56:54 - INFO - 스케일러 역변환 후 예측 가격: 84517175.08943926
2024-09-20 00:56:54 - INFO - TransformerPredictor 최종 예측 가격: 84517175.08943926
2024-09-20 00:56:54 - INFO - TRANSFORMER prediction: 84517175.08943926
2024-09-20 00:56:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 00:56:54 - INFO - BITCOIN_FORECAST prediction: 83327041.85454291
2024-09-20 00:56:54 - INFO - BitcoinForecast prediction: 83327041.85454291
2024-09-20 00:56:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:57:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:57:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:57:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:57:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 00:57:05 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 00:57:05 - INFO - 조정된 모델 가중치: {'gpt': 0.00420425171639694, 'ml': 0.1707434945355625, 'xgboost': 0.07076020058148144, 'rl': 0.2291332496503605, 'lstm': 0.0958122209058994, 'arima': 0.060031190863340536, 'prophet': 0.21653771196424934, 'transformer': 0.12572910369464307, 'bitcoin_forecast': 0.027048576088066354}
2024-09-20 00:57:05 - INFO - 조정된 모델 가중치: {'gpt': 0.00420425171639694, 'ml': 0.1707434945355625, 'xgboost': 0.07076020058148144, 'rl': 0.2291332496503605, 'lstm': 0.0958122209058994, 'arima': 0.060031190863340536, 'prophet': 0.21653771196424934, 'transformer': 0.12572910369464307, 'bitcoin_forecast': 0.027048576088066354}
2024-09-20 00:57:05 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84429561.70098618, 'current_price': 84462000.0, 'predictions': {'gpt': 84462000.0, 'ml': 84495784.8, 'xgboost': 84462000.0, 'lstm': 84464557.44014253, 'rl': 85306620.0, 'arima': 80899000.0, 'prophet': 84488187.71132176, 'transformer': 84517175.08943926, 'bitcoin_forecast': 83327041.85454291}, 'weights': {'gpt': 0.00420425171639694, 'ml': 0.1707434945355625, 'xgboost': 0.07076020058148144, 'rl': 0.2291332496503605, 'lstm': 0.0958122209058994, 'arima': 0.060031190863340536, 'prophet': 0.21653771196424934, 'transformer': 0.12572910369464307, 'bitcoin_forecast': 0.027048576088066354}}
2024-09-20 00:57:05 - INFO - 모델별 가중치:
2024-09-20 00:57:05 - INFO -   - GPT: 0.0042
2024-09-20 00:57:05 - INFO -   - ML: 0.1707
2024-09-20 00:57:05 - INFO -   - XGBOOST: 0.0708
2024-09-20 00:57:05 - INFO -   - RL: 0.2291
2024-09-20 00:57:05 - INFO -   - LSTM: 0.0958
2024-09-20 00:57:05 - INFO -   - ARIMA: 0.0600
2024-09-20 00:57:05 - INFO -   - PROPHET: 0.2165
2024-09-20 00:57:05 - INFO -   - TRANSFORMER: 0.1257
2024-09-20 00:57:05 - INFO -   - BITCOIN_FORECAST: 0.0270
2024-09-20 00:57:05 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 00:57:05 - INFO - 6. 거래 실행
2024-09-20 00:57:05 - INFO - Cancelling existing orders.
2024-09-20 00:57:05 - INFO - Cancelled 0 orders.
2024-09-20 00:57:05 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84429561.70098618, 'current_price': 84462000.0, 'predictions': {'gpt': 84462000.0, 'ml': 84495784.8, 'xgboost': 84462000.0, 'lstm': 84464557.44014253, 'rl': 85306620.0, 'arima': 80899000.0, 'prophet': 84488187.71132176, 'transformer': 84517175.08943926, 'bitcoin_forecast': 83327041.85454291}, 'weights': {'gpt': 0.00420425171639694, 'ml': 0.1707434945355625, 'xgboost': 0.07076020058148144, 'rl': 0.2291332496503605, 'lstm': 0.0958122209058994, 'arima': 0.060031190863340536, 'prophet': 0.21653771196424934, 'transformer': 0.12572910369464307, 'bitcoin_forecast': 0.027048576088066354}}, 현재 가격=84462000.0
2024-09-20 00:57:05 - INFO - 현재 잔고: KRW=203193.12097796, BTC=0.00326612, 총 자산가치=479056.14841796
2024-09-20 00:57:05 - INFO - 매도 시도: 0.000326612 BTC (약 27586.302744 KRW)
2024-09-20 00:57:05 - INFO - 주문 결과: {'uuid': 'ee7b4042-f55c-4124-b68d-9e00c055597f', 'side': 'ask', 'ord_type': 'limit', 'price': '84462000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T00:57:06+09:00', 'volume': '0.00032661', 'remaining_volume': '0.00032661', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00032661', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 00:57:05 - INFO - sell 주문 성공: UUID=ee7b4042-f55c-4124-b68d-9e00c055597f
2024-09-20 00:57:05 - INFO - Trade executed successfully.
2024-09-20 00:57:05 - INFO - 7. summary 리포트 보내기
2024-09-20 00:57:06 - INFO - Message sent to Discord successfully.
2024-09-20 00:57:06 - INFO - Trading cycle completed.
2024-09-20 00:57:06 - INFO - Performing periodic update.
2024-09-20 00:57:06 - INFO - 계산된 시장 변동성: 0.02999291890407071
2024-09-20 01:06:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ff-a8ce-c7130e8069da "HTTP/1.1 200 OK"
2024-09-20 01:06:00 - INFO - Updated actual price for gpt prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8179-8489-d3a105960f4a "HTTP/1.1 200 OK"
2024-09-20 01:06:19 - INFO - Updated actual price for ml prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8120-b72f-cba092aaaf15 "HTTP/1.1 200 OK"
2024-09-20 01:06:25 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-be47-dd4c1eef5d69 "HTTP/1.1 200 OK"
2024-09-20 01:06:32 - INFO - Updated actual price for lstm prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814b-b7ae-e2402e1c9054 "HTTP/1.1 200 OK"
2024-09-20 01:06:40 - INFO - Updated actual price for rl prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817f-9a27-d5444ffb04c6 "HTTP/1.1 200 OK"
2024-09-20 01:06:46 - INFO - Updated actual price for arima prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:06:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:06:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814c-ac31-d434104977a0 "HTTP/1.1 200 OK"
2024-09-20 01:06:52 - INFO - Updated actual price for prophet prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:07:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:07:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8129-ae7a-c6ee58d9451f "HTTP/1.1 200 OK"
2024-09-20 01:07:04 - INFO - Updated actual price for transformer prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:07:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:07:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81aa-b317-e6ec1307dcfb "HTTP/1.1 200 OK"
2024-09-20 01:07:12 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 00:55:34.948269
2024-09-20 01:07:12 - INFO - Starting trading cycle.
2024-09-20 01:07:12 - INFO - ##################################################
2024-09-20 01:07:12 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-20 01:07:12 - INFO - ##################################################
2024-09-20 01:07:12 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:07:12 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:07:12 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 00:50:00
2024-09-20 01:07:12 - INFO - 새로운 데이터 범위: 2024-09-18 15:50:00 ~ 2024-09-20 01:00:00
2024-09-20 01:07:12 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:07:12 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:07:12 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:07:12 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:07:12 - INFO - Sample date values: [Timestamp('2024-09-20 01:00:00')]
2024-09-20 01:07:12 - INFO - Successfully added 1 new data points
2024-09-20 01:07:12 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:07:12 - INFO - Final date range: 2024-09-20 01:00:00 to 2024-09-20 01:00:00
2024-09-20 01:07:12 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:07:12 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:00:00
2024-09-20 01:07:12 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:07:12 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:07:12 - INFO - GPT | 이전예측가격: 84462000 | 당시BTC가격: 84462000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:07:12 - INFO - ML 모델 예측 업데이트: 정확도 45.65%, 적중/전체: 21/46
2024-09-20 01:07:12 - INFO - ML | 이전예측가격: 84495785 | 당시BTC가격: 84462000 | 예측: 상승 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1912 | 반영가중치값: 0.0200 | 새 가중치: 0.2112 | 예측 총 횟수: 46 | 예측 성공 수: 21 | 예측 성공률: 45.65%
2024-09-20 01:07:12 - INFO - XGBOOST | 이전예측가격: 84462000 | 당시BTC가격: 84462000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:07:12 - INFO - LSTM | 이전예측가격: 84464557 | 당시BTC가격: 84462000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:07:12 - INFO - RL 모델 예측 업데이트: 정확도 66.00%, 적중/전체: 33/50
2024-09-20 01:07:12 - INFO - RL | 이전예측가격: 85306620 | 당시BTC가격: 84462000 | 예측: 상승 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2631 | 반영가중치값: 0.0200 | 새 가중치: 0.2831 | 예측 총 횟수: 50 | 예측 성공 수: 33 | 예측 성공률: 66.00%
2024-09-20 01:07:12 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.24%, 적중/전체: 124/242
2024-09-20 01:07:12 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84462000 | 예측: 하락 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 242 | 예측 성공 수: 124 | 예측 성공률: 51.24%
2024-09-20 01:07:12 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.22%, 적중/전체: 30/46
2024-09-20 01:07:12 - INFO - PROPHET | 이전예측가격: 84488188 | 당시BTC가격: 84462000 | 예측: 상승 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0972 | 반영가중치값: 0.0200 | 새 가중치: 0.1172 | 예측 총 횟수: 46 | 예측 성공 수: 30 | 예측 성공률: 65.22%
2024-09-20 01:07:12 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 77.78%, 적중/전체: 7/9
2024-09-20 01:07:12 - INFO - TRANSFORMER | 이전예측가격: 84517175 | 당시BTC가격: 84462000 | 예측: 상승 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1066 | 반영가중치값: 0.0200 | 새 가중치: 0.1266 | 예측 총 횟수: 9 | 예측 성공 수: 7 | 예측 성공률: 77.78%
2024-09-20 01:07:12 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-20 01:07:12 - INFO - BITCOIN_FORECAST | 이전예측가격: 83327042 | 당시BTC가격: 84462000 | 예측: 하락 | 지금 BTC가격: 84515000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0958 | 반영가중치값: -0.0200 | 새 가중치: 0.0758 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-20 01:07:12 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:07:12 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:07:12 - INFO - 새로운 가중치: {'gpt': 0.0042699156850606185, 'ml': 0.21448984959795553, 'xgboost': 0.07186536647235725, 'rl': 0.2875468170947096, 'lstm': 0.09730866096124274, 'arima': 0.0, 'prophet': 0.11900139361275723, 'transformer': 0.12857310815541148, 'bitcoin_forecast': 0.07694488842050562}
2024-09-20 01:07:12 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:07:12 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:07:12 - INFO - Current BTC price: 84515000.0
2024-09-20 01:07:12 - INFO - Analyzing market conditions.
2024-09-20 01:07:12 - INFO - Market analysis: {'current_price': 84515000.0, 'sma_20': 84370450.0, 'rsi_14': 59.15979800650451, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:07:12 - INFO - Starting predictions for all models
2024-09-20 01:07:12 - INFO - Attempting prediction for gpt
2024-09-20 01:07:13 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:07:13 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:07:13 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:07:13 - INFO - GPT prediction: 84515000.0
2024-09-20 01:07:13 - INFO - Attempting prediction for ml
2024-09-20 01:07:13 - INFO - ML prediction: 84565709.0
2024-09-20 01:07:13 - INFO - Attempting prediction for xgboost
2024-09-20 01:07:13 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:07:13 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:07:13 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:07:13 - INFO - XGBOOST prediction: 84515000.0
2024-09-20 01:07:13 - INFO - Attempting prediction for lstm
2024-09-20 01:07:13 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:07:13 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:07:13 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:07:13 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:07:13 - INFO - X 샘플:
[[ 1.35873545  1.6337959   2.12982694  1.93863372  2.38873984  2.39530708
   1.93863372]
 [ 1.37017743  1.15238274 -0.30644147 -0.7465546   0.80360955  0.802389
  -0.7465546 ]
 [-0.41477187 -1.18698431 -1.33378357 -1.77005688  0.55285355  0.54479264
  -1.77005688]
 [-1.46743429 -1.44273505 -1.02264568 -1.05360528  0.35954563  0.35270053
  -1.05360528]
 [-1.55324916 -0.44982042 -1.15766779  0.34919489 -0.23299822 -0.23411946
   0.34919489]
 [-0.65505351 -1.18698431 -0.3357941  -0.3732773  -1.03445934 -1.03277994
  -0.3732773 ]
 [ 0.26030511 -0.12637095  0.42737431 -0.03010301 -0.82433086 -0.82232337
  -0.03010301]
 [ 0.14016429  0.51300589  0.72677116  0.90911085 -0.52845545 -0.52614449
   0.90911085]
 [ 1.00975498  0.65592543  0.45672695  0.22878286 -0.86090233 -0.8583436
   0.22878286]
 [-0.04862843  0.43778509  0.41563326  0.54787475 -0.62360238 -0.62147839
   0.54787475]]
2024-09-20 01:07:13 - INFO - y 샘플:
[0.54787475]
2024-09-20 01:07:13 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:07:13 - INFO - 모델 출력 (스케일링된 예측): [[0.23422977]]
2024-09-20 01:07:13 - INFO - 스케일러 역변환 후 예측 가격: 84462904.71217816
2024-09-20 01:07:13 - INFO - LSTMPredictor 최종 예측 가격: 84462904.71217816
2024-09-20 01:07:13 - INFO - LSTM prediction: 84462904.71217816
2024-09-20 01:07:13 - INFO - Attempting prediction for rl
2024-09-20 01:07:13 - INFO - Preparing state for RL agent.
2024-09-20 01:07:13 - INFO - Prepared state: [[8.45150000e+07 1.36642184e+01 6.27501125e-04 8.43704500e+07
  5.91597980e+01]]
2024-09-20 01:07:13 - INFO - RL prediction: 85360150.0
2024-09-20 01:07:13 - INFO - Attempting prediction for arima
2024-09-20 01:07:13 - INFO - ARIMA 예측 시작
2024-09-20 01:07:13 - INFO - 입력 데이터: {'open': 84444000.0, 'high': 84600000.0, 'low': 84398000.0, 'close': 84515000.0, 'volume': 13.66421843, 'value': 1154680121.4055, 'decision': 'sell', 'sma': 84370450.0, 'ema': 84303806.04592365, 'rsi': 59.15979800650451, 'macd': 199471.820059821, 'signal_line': 228788.96717498172, 'BB_Upper': 84719041.7239431, 'BB_Lower': 84021858.2760569}
2024-09-20 01:07:13 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:07:13 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84370450.0         0         0
2024-09-20 01:07:13 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84370450.0         0         0
2024-09-20 01:07:13 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:07:13 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:07:13 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:07:13 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:07:13 - INFO - Attempting prediction for prophet
2024-09-20 01:07:13 - INFO - PROPHET prediction: 84549098.57061642
2024-09-20 01:07:13 - INFO - Attempting prediction for transformer
2024-09-20 01:07:13 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:07:13 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:07:13 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:07:13 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:07:13 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:07:13 - INFO - X 샘플:
[[ 1.35873545  1.6337959   2.12982694  1.93863372  2.38873984  2.39530708
   1.93863372  1.93863372  0.          0.          0.          1.93863372
   1.93863372]
 [ 1.37017743  1.15238274 -0.30644147 -0.7465546   0.80360955  0.802389
  -0.7465546  -0.7465546   0.          0.          0.         -0.7465546
  -0.7465546 ]
 [-0.41477187 -1.18698431 -1.33378357 -1.77005688  0.55285355  0.54479264
  -1.77005688 -1.77005688  0.          0.          0.         -1.77005688
  -1.77005688]
 [-1.46743429 -1.44273505 -1.02264568 -1.05360528  0.35954563  0.35270053
  -1.05360528 -1.05360528  0.          0.          0.         -1.05360528
  -1.05360528]
 [-1.55324916 -0.44982042 -1.15766779  0.34919489 -0.23299822 -0.23411946
   0.34919489  0.34919489  0.          0.          0.          0.34919489
   0.34919489]
 [-0.65505351 -1.18698431 -0.3357941  -0.3732773  -1.03445934 -1.03277994
  -0.3732773  -0.3732773   0.          0.          0.         -0.3732773
  -0.3732773 ]
 [ 0.26030511 -0.12637095  0.42737431 -0.03010301 -0.82433086 -0.82232337
  -0.03010301 -0.03010301  0.          0.          0.         -0.03010301
  -0.03010301]
 [ 0.14016429  0.51300589  0.72677116  0.90911085 -0.52845545 -0.52614449
   0.90911085  0.90911085  0.          0.          0.          0.90911085
   0.90911085]
 [ 1.00975498  0.65592543  0.45672695  0.22878286 -0.86090233 -0.8583436
   0.22878286  0.22878286  0.          0.          0.          0.22878286
   0.22878286]
 [-0.04862843  0.43778509  0.41563326  0.54787475 -0.62360238 -0.62147839
   0.54787475  0.54787475  0.          0.          0.          0.54787475
   0.54787475]]
2024-09-20 01:07:13 - INFO - y 샘플:
[0.54787475]
2024-09-20 01:07:13 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:07:13 - INFO - 모델 출력 (스케일링된 예측): [0.48211226]
2024-09-20 01:07:13 - INFO - 스케일러 역변환 후 예측 가격: 84504077.09010826
2024-09-20 01:07:13 - INFO - TransformerPredictor 최종 예측 가격: 84504077.09010826
2024-09-20 01:07:13 - INFO - TRANSFORMER prediction: 84504077.09010826
2024-09-20 01:07:13 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:07:13 - INFO - BITCOIN_FORECAST prediction: 83358965.88993552
2024-09-20 01:07:13 - INFO - BitcoinForecast prediction: 83358965.88993552
2024-09-20 01:07:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:23 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:07:23 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:07:23 - INFO - 조정된 모델 가중치: {'gpt': 0.0042699156850606185, 'ml': 0.21448984959795553, 'xgboost': 0.07186536647235725, 'rl': 0.2875468170947096, 'lstm': 0.09730866096124274, 'arima': 0.0, 'prophet': 0.11900139361275723, 'transformer': 0.12857310815541148, 'bitcoin_forecast': 0.07694488842050562}
2024-09-20 01:07:23 - INFO - 조정된 모델 가중치: {'gpt': 0.0042699156850606185, 'ml': 0.21448984959795553, 'xgboost': 0.07186536647235725, 'rl': 0.2875468170947096, 'lstm': 0.09730866096124274, 'arima': 0.0, 'prophet': 0.11900139361275723, 'transformer': 0.12857310815541148, 'bitcoin_forecast': 0.07694488842050562}
2024-09-20 01:07:23 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84677529.90488999, 'current_price': 84515000.0, 'predictions': {'gpt': 84515000.0, 'ml': 84565709.0, 'xgboost': 84515000.0, 'lstm': 84462904.71217816, 'rl': 85360150.0, 'arima': 80899000.0, 'prophet': 84549098.57061642, 'transformer': 84504077.09010826, 'bitcoin_forecast': 83358965.88993552}, 'weights': {'gpt': 0.0042699156850606185, 'ml': 0.21448984959795553, 'xgboost': 0.07186536647235725, 'rl': 0.2875468170947096, 'lstm': 0.09730866096124274, 'arima': 0.0, 'prophet': 0.11900139361275723, 'transformer': 0.12857310815541148, 'bitcoin_forecast': 0.07694488842050562}}
2024-09-20 01:07:23 - INFO - 모델별 가중치:
2024-09-20 01:07:23 - INFO -   - GPT: 0.0043
2024-09-20 01:07:23 - INFO -   - ML: 0.2145
2024-09-20 01:07:23 - INFO -   - XGBOOST: 0.0719
2024-09-20 01:07:23 - INFO -   - RL: 0.2875
2024-09-20 01:07:23 - INFO -   - LSTM: 0.0973
2024-09-20 01:07:23 - INFO -   - ARIMA: 0.0000
2024-09-20 01:07:23 - INFO -   - PROPHET: 0.1190
2024-09-20 01:07:23 - INFO -   - TRANSFORMER: 0.1286
2024-09-20 01:07:23 - INFO -   - BITCOIN_FORECAST: 0.0769
2024-09-20 01:07:23 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:07:23 - INFO - 6. 거래 실행
2024-09-20 01:07:23 - INFO - Cancelling existing orders.
2024-09-20 01:07:23 - INFO - Cancelled 0 orders.
2024-09-20 01:07:23 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84677529.90488999, 'current_price': 84515000.0, 'predictions': {'gpt': 84515000.0, 'ml': 84565709.0, 'xgboost': 84515000.0, 'lstm': 84462904.71217816, 'rl': 85360150.0, 'arima': 80899000.0, 'prophet': 84549098.57061642, 'transformer': 84504077.09010826, 'bitcoin_forecast': 83358965.88993552}, 'weights': {'gpt': 0.0042699156850606185, 'ml': 0.21448984959795553, 'xgboost': 0.07186536647235725, 'rl': 0.2875468170947096, 'lstm': 0.09730866096124274, 'arima': 0.0, 'prophet': 0.11900139361275723, 'transformer': 0.12857310815541148, 'bitcoin_forecast': 0.07694488842050562}}, 현재 가격=84515000.0
2024-09-20 01:07:23 - INFO - 현재 잔고: KRW=230765.46173105, BTC=0.00293951, 총 자산가치=479198.14938105
2024-09-20 01:07:23 - INFO - 매수 시도: 0.0005669977511460096 BTC (약 47919.814938105 KRW)
2024-09-20 01:07:23 - INFO - 주문 결과: {'uuid': '1b632fa4-27ab-4676-97ec-7e22a3e8f877', 'side': 'bid', 'ord_type': 'limit', 'price': '84515000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:07:24+09:00', 'volume': '0.00056699', 'remaining_volume': '0.00056699', 'reserved_fee': '23.959579925', 'remaining_fee': '23.959579925', 'paid_fee': '0', 'locked': '47943.119429925', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:07:23 - INFO - buy 주문 성공: UUID=1b632fa4-27ab-4676-97ec-7e22a3e8f877
2024-09-20 01:07:23 - INFO - Trade executed successfully.
2024-09-20 01:07:23 - INFO - 7. summary 리포트 보내기
2024-09-20 01:07:24 - INFO - Message sent to Discord successfully.
2024-09-20 01:07:24 - INFO - Trading cycle completed.
2024-09-20 01:07:24 - INFO - Performing periodic update.
2024-09-20 01:07:24 - INFO - 계산된 시장 변동성: 0.02977165923219823
2024-09-20 01:15:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:15:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-9adc-ec34ac31d244 "HTTP/1.1 200 OK"
2024-09-20 01:15:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e6-83e9-cceab122c09b "HTTP/1.1 200 OK"
2024-09-20 01:15:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a4-84aa-f459b92c291a "HTTP/1.1 200 OK"
2024-09-20 01:16:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8187-bc4d-d89400b5dde0 "HTTP/1.1 200 OK"
2024-09-20 01:16:17 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-a1a6-e95eb47ae7b0 "HTTP/1.1 200 OK"
2024-09-20 01:16:23 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8177-9d13-ec1f6ac7fb2a "HTTP/1.1 200 OK"
2024-09-20 01:16:32 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-94bb-e4bdf5e22e71 "HTTP/1.1 200 OK"
2024-09-20 01:16:38 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/bc4289a9-b72f-44d0-8d0f-c3ec7601dd6a "HTTP/1.1 200 OK"
2024-09-20 01:16:47 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:16:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-b9e0-ed10db0c6cc7 "HTTP/1.1 200 OK"
2024-09-20 01:16:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:05:34.948458
2024-09-20 01:16:53 - INFO - Starting trading cycle.
2024-09-20 01:16:53 - INFO - ##################################################
2024-09-20 01:16:53 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-20 01:16:53 - INFO - ##################################################
2024-09-20 01:16:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:16:53 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:16:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:00:00
2024-09-20 01:16:53 - INFO - 새로운 데이터 범위: 2024-09-18 16:00:00 ~ 2024-09-20 01:10:00
2024-09-20 01:16:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:16:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:16:53 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:16:53 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:16:53 - INFO - Sample date values: [Timestamp('2024-09-20 01:10:00')]
2024-09-20 01:16:53 - INFO - Successfully added 1 new data points
2024-09-20 01:16:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:16:53 - INFO - Final date range: 2024-09-20 01:10:00 to 2024-09-20 01:10:00
2024-09-20 01:16:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:16:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:10:00
2024-09-20 01:16:53 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:16:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:16:53 - INFO - GPT | 이전예측가격: 84515000 | 당시BTC가격: 84515000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:16:53 - INFO - ML 모델 예측 업데이트: 정확도 44.68%, 적중/전체: 21/47
2024-09-20 01:16:53 - INFO - ML | 이전예측가격: 84565709 | 당시BTC가격: 84515000 | 예측: 상승 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1707 | 반영가중치값: -0.0200 | 새 가중치: 0.1507 | 예측 총 횟수: 47 | 예측 성공 수: 21 | 예측 성공률: 44.68%
2024-09-20 01:16:53 - INFO - XGBOOST | 이전예측가격: 84515000 | 당시BTC가격: 84515000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:16:53 - INFO - LSTM 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 8/10
2024-09-20 01:16:53 - INFO - LSTM | 이전예측가격: 84462905 | 당시BTC가격: 84515000 | 예측: 하락 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0958 | 반영가중치값: 0.0200 | 새 가중치: 0.1158 | 예측 총 횟수: 10 | 예측 성공 수: 8 | 예측 성공률: 80.00%
2024-09-20 01:16:53 - INFO - RL 모델 예측 업데이트: 정확도 64.71%, 적중/전체: 33/51
2024-09-20 01:16:53 - INFO - RL | 이전예측가격: 85360150 | 당시BTC가격: 84515000 | 예측: 상승 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2291 | 반영가중치값: -0.0200 | 새 가중치: 0.2091 | 예측 총 횟수: 51 | 예측 성공 수: 33 | 예측 성공률: 64.71%
2024-09-20 01:16:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.44%, 적중/전체: 125/243
2024-09-20 01:16:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84515000 | 예측: 하락 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0600 | 반영가중치값: 0.0200 | 새 가중치: 0.0800 | 예측 총 횟수: 243 | 예측 성공 수: 125 | 예측 성공률: 51.44%
2024-09-20 01:16:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.83%, 적중/전체: 30/47
2024-09-20 01:16:53 - INFO - PROPHET | 이전예측가격: 84549099 | 당시BTC가격: 84515000 | 예측: 상승 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2165 | 반영가중치값: -0.0200 | 새 가중치: 0.1965 | 예측 총 횟수: 47 | 예측 성공 수: 30 | 예측 성공률: 63.83%
2024-09-20 01:16:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 8/10
2024-09-20 01:16:53 - INFO - TRANSFORMER | 이전예측가격: 84504077 | 당시BTC가격: 84515000 | 예측: 하락 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1257 | 반영가중치값: 0.0200 | 새 가중치: 0.1457 | 예측 총 횟수: 10 | 예측 성공 수: 8 | 예측 성공률: 80.00%
2024-09-20 01:16:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 01:16:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 83358966 | 당시BTC가격: 84515000 | 예측: 하락 | 지금 BTC가격: 84490000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0270 | 반영가중치값: 0.0200 | 새 가중치: 0.0470 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 01:16:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:16:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:16:53 - INFO - 새로운 가중치: {'gpt': 0.004181392143416335, 'ml': 0.14761829277506588, 'xgboost': 0.07037545959106785, 'rl': 0.20479751627759132, 'lstm': 0.11341121144424893, 'arima': 0.0783719907807675, 'prophet': 0.1924631082453489, 'transformer': 0.1427078598736392, 'bitcoin_forecast': 0.04607316886885401}
2024-09-20 01:16:53 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:16:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:16:53 - INFO - Current BTC price: 84490000.0
2024-09-20 01:16:53 - INFO - Analyzing market conditions.
2024-09-20 01:16:53 - INFO - Market analysis: {'current_price': 84490000.0, 'sma_20': 84388050.0, 'rsi_14': 58.32338434862439, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:16:53 - INFO - Starting predictions for all models
2024-09-20 01:16:53 - INFO - Attempting prediction for gpt
2024-09-20 01:16:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:16:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:16:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:16:54 - INFO - GPT prediction: 84490000.0
2024-09-20 01:16:54 - INFO - Attempting prediction for ml
2024-09-20 01:16:54 - INFO - ML prediction: 84523796.0
2024-09-20 01:16:54 - INFO - Attempting prediction for xgboost
2024-09-20 01:16:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:16:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:16:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:16:54 - INFO - XGBOOST prediction: 84490000.0
2024-09-20 01:16:54 - INFO - Attempting prediction for lstm
2024-09-20 01:16:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:16:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:16:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:16:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:16:54 - INFO - X 샘플:
[[ 1.51360316  1.4824344  -0.02606613 -0.7546971   1.75901232  1.76670254
  -0.7546971 ]
 [-0.38601143 -1.24237115 -1.45155789 -2.05854372  1.34462811  1.33896907
  -2.05854372]
 [-1.50629695 -1.54025986 -1.01983753 -1.14585109  1.02517911  1.02000406
  -1.14585109]
 [-1.59762457 -0.38375075 -1.20718787  0.64118575  0.04597696  0.04560152
   0.64118575]
 [-0.64172877 -1.24237115 -0.06679447 -0.27917657 -1.27846926 -1.28055782
  -0.27917657]
 [ 0.33243255 -0.00700915  0.99214226  0.15799553 -0.93122363 -0.93109901
   0.15799553]
 [ 0.20457388  0.73771263  1.40757128  1.35446654 -0.44227781 -0.43930005
   1.35446654]
 [ 1.13002714  0.90417985  1.03287059  0.48779203 -0.99165944 -0.99090985
   0.48779203]
 [ 0.0036531   0.6500983   0.97585092  0.89428539 -0.59951188 -0.59760003
   0.89428539]
 [ 0.94737189  0.64133687 -0.63699117  0.70254324  0.06834553  0.06818955
   0.70254324]]
2024-09-20 01:16:54 - INFO - y 샘플:
[0.70254324]
2024-09-20 01:16:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:16:54 - INFO - 모델 출력 (스케일링된 예측): [[0.33340144]]
2024-09-20 01:16:54 - INFO - 스케일러 역변환 후 예측 가격: 84441870.02502988
2024-09-20 01:16:54 - INFO - LSTMPredictor 최종 예측 가격: 84441870.02502988
2024-09-20 01:16:54 - INFO - LSTM prediction: 84441870.02502988
2024-09-20 01:16:54 - INFO - Attempting prediction for rl
2024-09-20 01:16:54 - INFO - Preparing state for RL agent.
2024-09-20 01:16:54 - INFO - Prepared state: [[ 8.44900000e+07  1.87174533e+01 -2.95805478e-04  8.43880500e+07
   5.83233843e+01]]
2024-09-20 01:16:54 - INFO - RL prediction: 85334900.0
2024-09-20 01:16:54 - INFO - Attempting prediction for arima
2024-09-20 01:16:54 - INFO - ARIMA 예측 시작
2024-09-20 01:16:54 - INFO - 입력 데이터: {'open': 84599000.0, 'high': 84599000.0, 'low': 84200000.0, 'close': 84490000.0, 'volume': 18.71745331, 'value': 1579278716.81421, 'decision': 'sell', 'sma': 84388050.0, 'ema': 84321538.80345474, 'rsi': 58.32338434862439, 'macd': 191023.02400113642, 'signal_line': 221235.77854021266, 'BB_Upper': 84723205.17302172, 'BB_Lower': 84052894.82697828}
2024-09-20 01:16:54 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:16:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84388050.0         0         0
2024-09-20 01:16:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84388050.0         0         0
2024-09-20 01:16:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:16:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:16:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:16:54 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:16:54 - INFO - Attempting prediction for prophet
2024-09-20 01:16:54 - INFO - PROPHET prediction: 84522139.81619626
2024-09-20 01:16:54 - INFO - Attempting prediction for transformer
2024-09-20 01:16:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:16:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:16:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:16:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:16:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:16:54 - INFO - X 샘플:
[[ 1.51360316  1.4824344  -0.02606613 -0.7546971   1.75901232  1.76670254
  -0.7546971  -0.7546971   0.          0.          0.         -0.7546971
  -0.7546971 ]
 [-0.38601143 -1.24237115 -1.45155789 -2.05854372  1.34462811  1.33896907
  -2.05854372 -2.05854372  0.          0.          0.         -2.05854372
  -2.05854372]
 [-1.50629695 -1.54025986 -1.01983753 -1.14585109  1.02517911  1.02000406
  -1.14585109 -1.14585109  0.          0.          0.         -1.14585109
  -1.14585109]
 [-1.59762457 -0.38375075 -1.20718787  0.64118575  0.04597696  0.04560152
   0.64118575  0.64118575  0.          0.          0.          0.64118575
   0.64118575]
 [-0.64172877 -1.24237115 -0.06679447 -0.27917657 -1.27846926 -1.28055782
  -0.27917657 -0.27917657  0.          0.          0.         -0.27917657
  -0.27917657]
 [ 0.33243255 -0.00700915  0.99214226  0.15799553 -0.93122363 -0.93109901
   0.15799553  0.15799553  0.          0.          0.          0.15799553
   0.15799553]
 [ 0.20457388  0.73771263  1.40757128  1.35446654 -0.44227781 -0.43930005
   1.35446654  1.35446654  0.          0.          0.          1.35446654
   1.35446654]
 [ 1.13002714  0.90417985  1.03287059  0.48779203 -0.99165944 -0.99090985
   0.48779203  0.48779203  0.          0.          0.          0.48779203
   0.48779203]
 [ 0.0036531   0.6500983   0.97585092  0.89428539 -0.59951188 -0.59760003
   0.89428539  0.89428539  0.          0.          0.          0.89428539
   0.89428539]
 [ 0.94737189  0.64133687 -0.63699117  0.70254324  0.06834553  0.06818955
   0.70254324  0.70254324  0.          0.          0.          0.70254324
   0.70254324]]
2024-09-20 01:16:54 - INFO - y 샘플:
[0.70254324]
2024-09-20 01:16:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:16:54 - INFO - 모델 출력 (스케일링된 예측): [0.47352502]
2024-09-20 01:16:54 - INFO - 스케일러 역변환 후 예측 가격: 84460139.81811781
2024-09-20 01:16:54 - INFO - TransformerPredictor 최종 예측 가격: 84460139.81811781
2024-09-20 01:16:54 - INFO - TRANSFORMER prediction: 84460139.81811781
2024-09-20 01:16:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:16:54 - INFO - BITCOIN_FORECAST prediction: 83386717.71147497
2024-09-20 01:16:54 - INFO - BitcoinForecast prediction: 83386717.71147497
2024-09-20 01:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:17:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:17:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:17:00 - INFO - 조정된 모델 가중치: {'gpt': 0.004181392143416335, 'ml': 0.14761829277506588, 'xgboost': 0.07037545959106785, 'rl': 0.20479751627759132, 'lstm': 0.11341121144424893, 'arima': 0.0783719907807675, 'prophet': 0.1924631082453489, 'transformer': 0.1427078598736392, 'bitcoin_forecast': 0.04607316886885401}
2024-09-20 01:17:00 - INFO - 조정된 모델 가중치: {'gpt': 0.004181392143416335, 'ml': 0.14761829277506588, 'xgboost': 0.07037545959106785, 'rl': 0.20479751627759132, 'lstm': 0.11341121144424893, 'arima': 0.0783719907807675, 'prophet': 0.1924631082453489, 'transformer': 0.1427078598736392, 'bitcoin_forecast': 0.04607316886885401}
2024-09-20 01:17:00 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84332222.76674618, 'current_price': 84490000.0, 'predictions': {'gpt': 84490000.0, 'ml': 84523796.0, 'xgboost': 84490000.0, 'lstm': 84441870.02502988, 'rl': 85334900.0, 'arima': 80899000.0, 'prophet': 84522139.81619626, 'transformer': 84460139.81811781, 'bitcoin_forecast': 83386717.71147497}, 'weights': {'gpt': 0.004181392143416335, 'ml': 0.14761829277506588, 'xgboost': 0.07037545959106785, 'rl': 0.20479751627759132, 'lstm': 0.11341121144424893, 'arima': 0.0783719907807675, 'prophet': 0.1924631082453489, 'transformer': 0.1427078598736392, 'bitcoin_forecast': 0.04607316886885401}}
2024-09-20 01:17:00 - INFO - 모델별 가중치:
2024-09-20 01:17:00 - INFO -   - GPT: 0.0042
2024-09-20 01:17:00 - INFO -   - ML: 0.1476
2024-09-20 01:17:00 - INFO -   - XGBOOST: 0.0704
2024-09-20 01:17:00 - INFO -   - RL: 0.2048
2024-09-20 01:17:00 - INFO -   - LSTM: 0.1134
2024-09-20 01:17:00 - INFO -   - ARIMA: 0.0784
2024-09-20 01:17:00 - INFO -   - PROPHET: 0.1925
2024-09-20 01:17:00 - INFO -   - TRANSFORMER: 0.1427
2024-09-20 01:17:00 - INFO -   - BITCOIN_FORECAST: 0.0461
2024-09-20 01:17:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:17:00 - INFO - 6. 거래 실행
2024-09-20 01:17:00 - INFO - Cancelling existing orders.
2024-09-20 01:17:00 - INFO - Cancelled 0 orders.
2024-09-20 01:17:00 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84332222.76674618, 'current_price': 84490000.0, 'predictions': {'gpt': 84490000.0, 'ml': 84523796.0, 'xgboost': 84490000.0, 'lstm': 84441870.02502988, 'rl': 85334900.0, 'arima': 80899000.0, 'prophet': 84522139.81619626, 'transformer': 84460139.81811781, 'bitcoin_forecast': 83386717.71147497}, 'weights': {'gpt': 0.004181392143416335, 'ml': 0.14761829277506588, 'xgboost': 0.07037545959106785, 'rl': 0.20479751627759132, 'lstm': 0.11341121144424893, 'arima': 0.0783719907807675, 'prophet': 0.1924631082453489, 'transformer': 0.1427078598736392, 'bitcoin_forecast': 0.04607316886885401}}, 현재 가격=84490000.0
2024-09-20 01:17:00 - INFO - 현재 잔고: KRW=182822.34230112, BTC=0.0035065, 총 자산가치=479086.52730112
2024-09-20 01:17:00 - INFO - 매도 시도: 0.00035065 BTC (약 29626.4185 KRW)
2024-09-20 01:17:00 - INFO - 주문 결과: {'uuid': '8d1e7c85-d3b0-4c4f-9ff0-263da2e5279d', 'side': 'ask', 'ord_type': 'limit', 'price': '84490000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:17:00+09:00', 'volume': '0.00035065', 'remaining_volume': '0.00035065', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00035065', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:17:00 - INFO - sell 주문 성공: UUID=8d1e7c85-d3b0-4c4f-9ff0-263da2e5279d
2024-09-20 01:17:00 - INFO - Trade executed successfully.
2024-09-20 01:17:00 - INFO - 7. summary 리포트 보내기
2024-09-20 01:17:00 - INFO - Message sent to Discord successfully.
2024-09-20 01:17:00 - INFO - Trading cycle completed.
2024-09-20 01:17:00 - INFO - Performing periodic update.
2024-09-20 01:17:00 - INFO - 계산된 시장 변동성: 0.029683564233438948
2024-09-20 01:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:25:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/ea8e98d3-ed1b-4f28-870e-94d425615b77 "HTTP/1.1 200 OK"
2024-09-20 01:25:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:25:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8153-92f9-fa43844b1729 "HTTP/1.1 200 OK"
2024-09-20 01:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:25:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:25:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8168-86f6-e9e854264e63 "HTTP/1.1 200 OK"
2024-09-20 01:25:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:25:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:25:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cd-b365-f3801f8701c2 "HTTP/1.1 200 OK"
2024-09-20 01:25:59 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:26:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818d-ae98-d828e5d4d87a "HTTP/1.1 200 OK"
2024-09-20 01:26:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:26:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8123-a8cd-fe80d288aa0a "HTTP/1.1 200 OK"
2024-09-20 01:26:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:26:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8104-b2c9-dfe02b6f177f "HTTP/1.1 200 OK"
2024-09-20 01:26:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:26:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-8733-d3aad7af4796 "HTTP/1.1 200 OK"
2024-09-20 01:26:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:26:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816e-80a8-efc070f7048f "HTTP/1.1 200 OK"
2024-09-20 01:26:37 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:15:34.948659
2024-09-20 01:26:37 - INFO - Starting trading cycle.
2024-09-20 01:26:37 - INFO - ##################################################
2024-09-20 01:26:37 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-20 01:26:37 - INFO - ##################################################
2024-09-20 01:26:37 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:26:37 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:26:37 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:10:00
2024-09-20 01:26:37 - INFO - 새로운 데이터 범위: 2024-09-18 16:10:00 ~ 2024-09-20 01:20:00
2024-09-20 01:26:37 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:26:37 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:26:37 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:26:37 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:26:37 - INFO - Sample date values: [Timestamp('2024-09-20 01:20:00')]
2024-09-20 01:26:37 - INFO - Successfully added 1 new data points
2024-09-20 01:26:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:26:37 - INFO - Final date range: 2024-09-20 01:20:00 to 2024-09-20 01:20:00
2024-09-20 01:26:37 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:26:37 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:20:00
2024-09-20 01:26:37 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:26:37 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:26:37 - INFO - GPT | 이전예측가격: 84490000 | 당시BTC가격: 84490000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:26:37 - INFO - ML 모델 예측 업데이트: 정확도 45.83%, 적중/전체: 22/48
2024-09-20 01:26:37 - INFO - ML | 이전예측가격: 84523796 | 당시BTC가격: 84490000 | 예측: 상승 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2145 | 반영가중치값: 0.0200 | 새 가중치: 0.2345 | 예측 총 횟수: 48 | 예측 성공 수: 22 | 예측 성공률: 45.83%
2024-09-20 01:26:37 - INFO - XGBOOST | 이전예측가격: 84490000 | 당시BTC가격: 84490000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:26:37 - INFO - LSTM 모델 예측 업데이트: 정확도 72.73%, 적중/전체: 8/11
2024-09-20 01:26:37 - INFO - LSTM | 이전예측가격: 84441870 | 당시BTC가격: 84490000 | 예측: 하락 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0973 | 반영가중치값: -0.0200 | 새 가중치: 0.0773 | 예측 총 횟수: 11 | 예측 성공 수: 8 | 예측 성공률: 72.73%
2024-09-20 01:26:37 - INFO - RL 모델 예측 업데이트: 정확도 65.38%, 적중/전체: 34/52
2024-09-20 01:26:37 - INFO - RL | 이전예측가격: 85334900 | 당시BTC가격: 84490000 | 예측: 상승 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2875 | 반영가중치값: 0.0200 | 새 가중치: 0.3075 | 예측 총 횟수: 52 | 예측 성공 수: 34 | 예측 성공률: 65.38%
2024-09-20 01:26:37 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.23%, 적중/전체: 125/244
2024-09-20 01:26:37 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84490000 | 예측: 하락 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 244 | 예측 성공 수: 125 | 예측 성공률: 51.23%
2024-09-20 01:26:37 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.58%, 적중/전체: 31/48
2024-09-20 01:26:37 - INFO - PROPHET | 이전예측가격: 84522140 | 당시BTC가격: 84490000 | 예측: 상승 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1190 | 반영가중치값: 0.0200 | 새 가중치: 0.1390 | 예측 총 횟수: 48 | 예측 성공 수: 31 | 예측 성공률: 64.58%
2024-09-20 01:26:37 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 72.73%, 적중/전체: 8/11
2024-09-20 01:26:37 - INFO - TRANSFORMER | 이전예측가격: 84460140 | 당시BTC가격: 84490000 | 예측: 하락 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1286 | 반영가중치값: -0.0200 | 새 가중치: 0.1086 | 예측 총 횟수: 11 | 예측 성공 수: 8 | 예측 성공률: 72.73%
2024-09-20 01:26:37 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 01:26:37 - INFO - BITCOIN_FORECAST | 이전예측가격: 83386718 | 당시BTC가격: 84490000 | 예측: 하락 | 지금 BTC가격: 84500000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0769 | 반영가중치값: -0.0200 | 새 가중치: 0.0569 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 01:26:37 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:26:37 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:26:37 - INFO - 새로운 가중치: {'gpt': 0.004188002614153841, 'ml': 0.23486056065203592, 'xgboost': 0.07048671797112621, 'rl': 0.30803302579389097, 'lstm': 0.07743088021825376, 'arima': 0.0, 'prophet': 0.13922114450275602, 'transformer': 0.10874475418374954, 'bitcoin_forecast': 0.05703491406403369}
2024-09-20 01:26:37 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:26:37 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:26:37 - INFO - Current BTC price: 84529000.0
2024-09-20 01:26:37 - INFO - Analyzing market conditions.
2024-09-20 01:26:37 - INFO - Market analysis: {'current_price': 84529000.0, 'sma_20': 84407550.0, 'rsi_14': 59.290328330623915, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:26:37 - INFO - Starting predictions for all models
2024-09-20 01:26:37 - INFO - Attempting prediction for gpt
2024-09-20 01:26:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:26:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:26:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:26:38 - INFO - GPT prediction: 84529000.0
2024-09-20 01:26:38 - INFO - Attempting prediction for ml
2024-09-20 01:26:38 - INFO - ML prediction: 84545905.8
2024-09-20 01:26:38 - INFO - Attempting prediction for xgboost
2024-09-20 01:26:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:26:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:26:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:26:38 - INFO - XGBOOST prediction: 84529000.0
2024-09-20 01:26:38 - INFO - Attempting prediction for lstm
2024-09-20 01:26:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:26:38 - INFO - X 샘플:
[[-0.32353547 -1.26776357 -1.49034642 -2.22031502  1.84189195  1.83992953
  -2.22031502]
 [-1.58477545 -1.60850634 -1.06522069 -1.31328623  1.49159313  1.48953548
  -1.31328623]
 [-1.68759392 -0.28562262 -1.24970921  0.46266091  0.41782747  0.41912068
   0.46266091]
 [-0.61142721 -1.26776357 -0.12673559 -0.45198998 -1.03452317 -1.03771107
  -0.45198998]
 [ 0.48530321  0.14531677  0.91602562 -0.01753081 -0.65374334 -0.65381852
  -0.01753081]
 [ 0.34135734  0.99717371  1.32510887  1.17151534 -0.11757904 -0.11356041
   1.17151534]
 [ 1.38325123  1.1875888   0.95613182  0.31021909 -0.72001554 -0.7195228
   0.31021909]
 [ 0.11515669  0.89695525  0.89998314  0.7141899  -0.28999752 -0.28745839
   0.7141899 ]
 [ 1.17761428  0.8869334  -0.6882224   0.52363763  0.44235622  0.44393442
   0.52363763]
 [ 0.70464929  0.31568816  0.52298486  0.82089917 -1.37781016 -1.38044891
   0.82089917]]
2024-09-20 01:26:38 - INFO - y 샘플:
[0.82089917]
2024-09-20 01:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:26:38 - INFO - 모델 출력 (스케일링된 예측): [[0.31843188]]
2024-09-20 01:26:38 - INFO - 스케일러 역변환 후 예측 가격: 84463077.49865264
2024-09-20 01:26:38 - INFO - LSTMPredictor 최종 예측 가격: 84463077.49865264
2024-09-20 01:26:38 - INFO - LSTM prediction: 84463077.49865264
2024-09-20 01:26:38 - INFO - Attempting prediction for rl
2024-09-20 01:26:38 - INFO - Preparing state for RL agent.
2024-09-20 01:26:38 - INFO - Prepared state: [[8.45290000e+07 6.15831993e+00 4.61593088e-04 8.44075500e+07
  5.92903283e+01]]
2024-09-20 01:26:38 - INFO - RL prediction: 85374290.0
2024-09-20 01:26:38 - INFO - Attempting prediction for arima
2024-09-20 01:26:38 - INFO - ARIMA 예측 시작
2024-09-20 01:26:38 - INFO - 입력 데이터: {'open': 84530000.0, 'high': 84542000.0, 'low': 84351000.0, 'close': 84529000.0, 'volume': 6.15831993, 'value': 520161666.93057, 'decision': 'sell', 'sma': 84407550.0, 'ema': 84341297.01264954, 'rsi': 59.290328330623915, 'macd': 185337.80744233727, 'signal_line': 214056.1843206376, 'BB_Upper': 84727512.79471467, 'BB_Lower': 84087587.20528533}
2024-09-20 01:26:38 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:26:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84407550.0         0         0
2024-09-20 01:26:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84407550.0         0         0
2024-09-20 01:26:38 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:26:38 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:26:38 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:26:38 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:26:38 - INFO - Attempting prediction for prophet
2024-09-20 01:26:38 - INFO - PROPHET prediction: 84559147.58779584
2024-09-20 01:26:38 - INFO - Attempting prediction for transformer
2024-09-20 01:26:38 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:26:38 - INFO - X 샘플:
[[-0.32353547 -1.26776357 -1.49034642 -2.22031502  1.84189195  1.83992953
  -2.22031502 -2.22031502  0.          0.          0.         -2.22031502
  -2.22031502]
 [-1.58477545 -1.60850634 -1.06522069 -1.31328623  1.49159313  1.48953548
  -1.31328623 -1.31328623  0.          0.          0.         -1.31328623
  -1.31328623]
 [-1.68759392 -0.28562262 -1.24970921  0.46266091  0.41782747  0.41912068
   0.46266091  0.46266091  0.          0.          0.          0.46266091
   0.46266091]
 [-0.61142721 -1.26776357 -0.12673559 -0.45198998 -1.03452317 -1.03771107
  -0.45198998 -0.45198998  0.          0.          0.         -0.45198998
  -0.45198998]
 [ 0.48530321  0.14531677  0.91602562 -0.01753081 -0.65374334 -0.65381852
  -0.01753081 -0.01753081  0.          0.          0.         -0.01753081
  -0.01753081]
 [ 0.34135734  0.99717371  1.32510887  1.17151534 -0.11757904 -0.11356041
   1.17151534  1.17151534  0.          0.          0.          1.17151534
   1.17151534]
 [ 1.38325123  1.1875888   0.95613182  0.31021909 -0.72001554 -0.7195228
   0.31021909  0.31021909  0.          0.          0.          0.31021909
   0.31021909]
 [ 0.11515669  0.89695525  0.89998314  0.7141899  -0.28999752 -0.28745839
   0.7141899   0.7141899   0.          0.          0.          0.7141899
   0.7141899 ]
 [ 1.17761428  0.8869334  -0.6882224   0.52363763  0.44235622  0.44393442
   0.52363763  0.52363763  0.          0.          0.          0.52363763
   0.52363763]
 [ 0.70464929  0.31568816  0.52298486  0.82089917 -1.37781016 -1.38044891
   0.82089917  0.82089917  0.          0.          0.          0.82089917
   0.82089917]]
2024-09-20 01:26:38 - INFO - y 샘플:
[0.82089917]
2024-09-20 01:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:26:38 - INFO - 모델 출력 (스케일링된 예측): [0.47359923]
2024-09-20 01:26:38 - INFO - 스케일러 역변환 후 예측 가격: 84483435.08127537
2024-09-20 01:26:38 - INFO - TransformerPredictor 최종 예측 가격: 84483435.08127537
2024-09-20 01:26:38 - INFO - TRANSFORMER prediction: 84483435.08127537
2024-09-20 01:26:38 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:26:38 - INFO - BITCOIN_FORECAST prediction: 83285939.9709063
2024-09-20 01:26:38 - INFO - BitcoinForecast prediction: 83285939.9709063
2024-09-20 01:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:26:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:26:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004188002614153841, 'ml': 0.23486056065203592, 'xgboost': 0.07048671797112621, 'rl': 0.30803302579389097, 'lstm': 0.07743088021825376, 'arima': 0.0, 'prophet': 0.13922114450275602, 'transformer': 0.10874475418374954, 'bitcoin_forecast': 0.05703491406403369}
2024-09-20 01:26:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004188002614153841, 'ml': 0.23486056065203592, 'xgboost': 0.07048671797112621, 'rl': 0.30803302579389097, 'lstm': 0.07743088021825376, 'arima': 0.0, 'prophet': 0.13922114450275602, 'transformer': 0.10874475418374954, 'bitcoin_forecast': 0.05703491406403369}
2024-09-20 01:26:47 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84716587.7185891, 'current_price': 84529000.0, 'predictions': {'gpt': 84529000.0, 'ml': 84545905.8, 'xgboost': 84529000.0, 'lstm': 84463077.49865264, 'rl': 85374290.0, 'arima': 80899000.0, 'prophet': 84559147.58779584, 'transformer': 84483435.08127537, 'bitcoin_forecast': 83285939.9709063}, 'weights': {'gpt': 0.004188002614153841, 'ml': 0.23486056065203592, 'xgboost': 0.07048671797112621, 'rl': 0.30803302579389097, 'lstm': 0.07743088021825376, 'arima': 0.0, 'prophet': 0.13922114450275602, 'transformer': 0.10874475418374954, 'bitcoin_forecast': 0.05703491406403369}}
2024-09-20 01:26:47 - INFO - 모델별 가중치:
2024-09-20 01:26:47 - INFO -   - GPT: 0.0042
2024-09-20 01:26:47 - INFO -   - ML: 0.2349
2024-09-20 01:26:47 - INFO -   - XGBOOST: 0.0705
2024-09-20 01:26:47 - INFO -   - RL: 0.3080
2024-09-20 01:26:47 - INFO -   - LSTM: 0.0774
2024-09-20 01:26:47 - INFO -   - ARIMA: 0.0000
2024-09-20 01:26:47 - INFO -   - PROPHET: 0.1392
2024-09-20 01:26:47 - INFO -   - TRANSFORMER: 0.1087
2024-09-20 01:26:47 - INFO -   - BITCOIN_FORECAST: 0.0570
2024-09-20 01:26:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:26:47 - INFO - 6. 거래 실행
2024-09-20 01:26:47 - INFO - Cancelling existing orders.
2024-09-20 01:26:47 - INFO - Cancelled 0 orders.
2024-09-20 01:26:47 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84716587.7185891, 'current_price': 84529000.0, 'predictions': {'gpt': 84529000.0, 'ml': 84545905.8, 'xgboost': 84529000.0, 'lstm': 84463077.49865264, 'rl': 85374290.0, 'arima': 80899000.0, 'prophet': 84559147.58779584, 'transformer': 84483435.08127537, 'bitcoin_forecast': 83285939.9709063}, 'weights': {'gpt': 0.004188002614153841, 'ml': 0.23486056065203592, 'xgboost': 0.07048671797112621, 'rl': 0.30803302579389097, 'lstm': 0.07743088021825376, 'arima': 0.0, 'prophet': 0.13922114450275602, 'transformer': 0.10874475418374954, 'bitcoin_forecast': 0.05703491406403369}}, 현재 가격=84529000.0
2024-09-20 01:26:47 - INFO - 현재 잔고: KRW=212433.94759187, BTC=0.00315585, 총 자산가치=479194.79224186996
2024-09-20 01:26:47 - INFO - 매수 시도: 0.0005668998713363107 BTC (약 47919.479224187 KRW)
2024-09-20 01:26:47 - INFO - 주문 결과: {'uuid': '39878bbc-0cb7-4fb7-8e3b-da6e7071dcba', 'side': 'bid', 'ord_type': 'limit', 'price': '84529000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:26:47+09:00', 'volume': '0.00056689', 'remaining_volume': '0.00056689', 'reserved_fee': '23.959322405', 'remaining_fee': '23.959322405', 'paid_fee': '0', 'locked': '47942.604132405', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:26:47 - INFO - buy 주문 성공: UUID=39878bbc-0cb7-4fb7-8e3b-da6e7071dcba
2024-09-20 01:26:47 - INFO - Trade executed successfully.
2024-09-20 01:26:47 - INFO - 7. summary 리포트 보내기
2024-09-20 01:26:47 - INFO - Message sent to Discord successfully.
2024-09-20 01:26:47 - INFO - Trading cycle completed.
2024-09-20 01:26:47 - INFO - Performing periodic update.
2024-09-20 01:26:47 - INFO - 계산된 시장 변동성: 0.029440034771522773
2024-09-20 01:35:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:35:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-ab3f-f88ce0879fb2 "HTTP/1.1 200 OK"
2024-09-20 01:35:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:35:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811a-a5a3-dcecd887de7c "HTTP/1.1 200 OK"
2024-09-20 01:35:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:35:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8109-9a1e-c227c7633d39 "HTTP/1.1 200 OK"
2024-09-20 01:35:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817c-a4d6-c39d5cc10cf5 "HTTP/1.1 200 OK"
2024-09-20 01:36:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c2-b42f-da2bd943e9a5 "HTTP/1.1 200 OK"
2024-09-20 01:36:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811d-bf2e-e6c2e1001a58 "HTTP/1.1 200 OK"
2024-09-20 01:36:17 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-bd25-d0bc81768bf7 "HTTP/1.1 200 OK"
2024-09-20 01:36:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8fc5f061-cc76-4869-9234-c2d8f85efff3 "HTTP/1.1 200 OK"
2024-09-20 01:36:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:36:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a5-ad70-f5ceee596cb5 "HTTP/1.1 200 OK"
2024-09-20 01:36:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:25:34.949129
2024-09-20 01:36:43 - INFO - Starting trading cycle.
2024-09-20 01:36:43 - INFO - ##################################################
2024-09-20 01:36:43 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-20 01:36:43 - INFO - ##################################################
2024-09-20 01:36:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:36:43 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:36:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:20:00
2024-09-20 01:36:43 - INFO - 새로운 데이터 범위: 2024-09-18 16:20:00 ~ 2024-09-20 01:30:00
2024-09-20 01:36:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:36:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:36:43 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:36:43 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:36:43 - INFO - Sample date values: [Timestamp('2024-09-20 01:30:00')]
2024-09-20 01:36:44 - INFO - Successfully added 1 new data points
2024-09-20 01:36:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:36:44 - INFO - Final date range: 2024-09-20 01:30:00 to 2024-09-20 01:30:00
2024-09-20 01:36:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:36:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:30:00
2024-09-20 01:36:44 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:36:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:36:44 - INFO - GPT | 이전예측가격: 84529000 | 당시BTC가격: 84529000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:36:44 - INFO - ML 모델 예측 업데이트: 정확도 46.94%, 적중/전체: 23/49
2024-09-20 01:36:44 - INFO - ML | 이전예측가격: 84545906 | 당시BTC가격: 84529000 | 예측: 상승 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1476 | 반영가중치값: 0.0200 | 새 가중치: 0.1676 | 예측 총 횟수: 49 | 예측 성공 수: 23 | 예측 성공률: 46.94%
2024-09-20 01:36:44 - INFO - XGBOOST | 이전예측가격: 84529000 | 당시BTC가격: 84529000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:36:44 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-20 01:36:44 - INFO - LSTM | 이전예측가격: 84463077 | 당시BTC가격: 84529000 | 예측: 하락 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1134 | 반영가중치값: -0.0200 | 새 가중치: 0.0934 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-20 01:36:44 - INFO - RL 모델 예측 업데이트: 정확도 66.04%, 적중/전체: 35/53
2024-09-20 01:36:44 - INFO - RL | 이전예측가격: 85374290 | 당시BTC가격: 84529000 | 예측: 상승 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2048 | 반영가중치값: 0.0200 | 새 가중치: 0.2248 | 예측 총 횟수: 53 | 예측 성공 수: 35 | 예측 성공률: 66.04%
2024-09-20 01:36:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 51.02%, 적중/전체: 125/245
2024-09-20 01:36:44 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84529000 | 예측: 하락 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0784 | 반영가중치값: -0.0200 | 새 가중치: 0.0584 | 예측 총 횟수: 245 | 예측 성공 수: 125 | 예측 성공률: 51.02%
2024-09-20 01:36:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.31%, 적중/전체: 32/49
2024-09-20 01:36:44 - INFO - PROPHET | 이전예측가격: 84559148 | 당시BTC가격: 84529000 | 예측: 상승 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1925 | 반영가중치값: 0.0200 | 새 가중치: 0.2125 | 예측 총 횟수: 49 | 예측 성공 수: 32 | 예측 성공률: 65.31%
2024-09-20 01:36:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-20 01:36:44 - INFO - TRANSFORMER | 이전예측가격: 84483435 | 당시BTC가격: 84529000 | 예측: 하락 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1427 | 반영가중치값: -0.0200 | 새 가중치: 0.1227 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-20 01:36:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 38.46%, 적중/전체: 5/13
2024-09-20 01:36:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83285940 | 당시BTC가격: 84529000 | 예측: 하락 | 지금 BTC가격: 84630000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0461 | 반영가중치값: -0.0200 | 새 가중치: 0.0261 | 예측 총 횟수: 13 | 예측 성공 수: 5 | 예측 성공률: 38.46%
2024-09-20 01:36:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:36:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:36:44 - INFO - 새로운 가중치: {'gpt': 0.0042729581280508055, 'ml': 0.17101850512285943, 'xgboost': 0.07191657270137626, 'rl': 0.22935763485382638, 'lstm': 0.09530609982019315, 'arima': 0.05955609282913044, 'prophet': 0.21677301781515865, 'transformer': 0.1251970439203564, 'bitcoin_forecast': 0.02660207480904845}
2024-09-20 01:36:44 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:36:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:36:44 - INFO - Current BTC price: 84630000.0
2024-09-20 01:36:44 - INFO - Analyzing market conditions.
2024-09-20 01:36:44 - INFO - Market analysis: {'current_price': 84630000.0, 'sma_20': 84422500.0, 'rsi_14': 61.76443185467036, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:36:44 - INFO - Starting predictions for all models
2024-09-20 01:36:44 - INFO - Attempting prediction for gpt
2024-09-20 01:36:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:36:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:36:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:36:44 - INFO - GPT prediction: 84630000.0
2024-09-20 01:36:44 - INFO - Attempting prediction for ml
2024-09-20 01:36:44 - INFO - ML prediction: 84714629.99999999
2024-09-20 01:36:44 - INFO - Attempting prediction for xgboost
2024-09-20 01:36:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:36:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:36:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:36:44 - INFO - XGBOOST prediction: 84630000.0
2024-09-20 01:36:44 - INFO - Attempting prediction for lstm
2024-09-20 01:36:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:36:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:36:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:36:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:36:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:36:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:36:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:36:44 - INFO - X 샘플:
[[-1.66337535 -1.9319977  -1.45310149 -2.16092136  2.07867781  2.07326842
  -2.16092136]
 [-1.76521466 -0.55423597 -1.65602398  0.10401196  0.73247693  0.73249675
   0.10401196]
 [-0.69929657 -1.57711968 -0.4208436  -1.06247731 -1.08836328 -1.09229002
  -1.06247731]
 [ 0.38698937 -0.10541965  0.72610961 -0.5083949  -0.61097221 -0.61143693
  -0.5083949 ]
 [ 0.24441434  0.78177541  1.17606818  1.00804114  0.06122739  0.06527529
   1.00804114]
 [ 1.27638598  0.98008959  0.7702232  -0.09040292 -0.69405896 -0.69373627
  -0.09040292]
 [ 0.02036786  0.67739952  0.70846418  0.42479651 -0.154937   -0.15254447
   0.42479651]
 [ 1.07270737  0.66696193 -1.03843379  0.18177791  0.7632291   0.76357774
   0.18177791]
 [ 0.60424656  0.07201936  0.29379648  0.56088692 -1.51874886 -1.52159386
   0.56088692]
 [ 0.52277511  0.99052718  0.89374123  1.54268205  0.43146907  0.43698336
   1.54268205]]
2024-09-20 01:36:44 - INFO - y 샘플:
[1.54268205]
2024-09-20 01:36:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:36:44 - INFO - 모델 출력 (스케일링된 예측): [[0.40112132]]
2024-09-20 01:36:44 - INFO - 스케일러 역변환 후 예측 가격: 84512564.46734786
2024-09-20 01:36:44 - INFO - LSTMPredictor 최종 예측 가격: 84512564.46734786
2024-09-20 01:36:44 - INFO - LSTM prediction: 84512564.46734786
2024-09-20 01:36:44 - INFO - Attempting prediction for rl
2024-09-20 01:36:44 - INFO - Preparing state for RL agent.
2024-09-20 01:36:44 - INFO - Prepared state: [[8.46300000e+07 1.68915730e+01 1.19485620e-03 8.44225000e+07
  6.17644319e+01]]
2024-09-20 01:36:44 - INFO - RL prediction: 85476300.0
2024-09-20 01:36:44 - INFO - Attempting prediction for arima
2024-09-20 01:36:44 - INFO - ARIMA 예측 시작
2024-09-20 01:36:44 - INFO - 입력 데이터: {'open': 84518000.0, 'high': 84630000.0, 'low': 84419000.0, 'close': 84630000.0, 'volume': 16.89157303, 'value': 1427910797.13032, 'decision': 'sell', 'sma': 84422500.0, 'ema': 84368792.53525434, 'rsi': 61.76443185467036, 'macd': 186828.44623593986, 'signal_line': 208610.63670369808, 'BB_Upper': 84754474.39660555, 'BB_Lower': 84090525.60339445}
2024-09-20 01:36:44 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:36:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84422500.0         0         0
2024-09-20 01:36:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84422500.0         0         0
2024-09-20 01:36:45 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:36:45 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:36:45 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:36:45 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:36:45 - INFO - Attempting prediction for prophet
2024-09-20 01:36:45 - INFO - PROPHET prediction: 84679720.83623248
2024-09-20 01:36:45 - INFO - Attempting prediction for transformer
2024-09-20 01:36:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:36:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:36:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:36:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:36:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:36:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:36:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:36:45 - INFO - X 샘플:
[[-1.66337535 -1.9319977  -1.45310149 -2.16092136  2.07867781  2.07326842
  -2.16092136 -2.16092136  0.          0.          0.         -2.16092136
  -2.16092136]
 [-1.76521466 -0.55423597 -1.65602398  0.10401196  0.73247693  0.73249675
   0.10401196  0.10401196  0.          0.          0.          0.10401196
   0.10401196]
 [-0.69929657 -1.57711968 -0.4208436  -1.06247731 -1.08836328 -1.09229002
  -1.06247731 -1.06247731  0.          0.          0.         -1.06247731
  -1.06247731]
 [ 0.38698937 -0.10541965  0.72610961 -0.5083949  -0.61097221 -0.61143693
  -0.5083949  -0.5083949   0.          0.          0.         -0.5083949
  -0.5083949 ]
 [ 0.24441434  0.78177541  1.17606818  1.00804114  0.06122739  0.06527529
   1.00804114  1.00804114  0.          0.          0.          1.00804114
   1.00804114]
 [ 1.27638598  0.98008959  0.7702232  -0.09040292 -0.69405896 -0.69373627
  -0.09040292 -0.09040292  0.          0.          0.         -0.09040292
  -0.09040292]
 [ 0.02036786  0.67739952  0.70846418  0.42479651 -0.154937   -0.15254447
   0.42479651  0.42479651  0.          0.          0.          0.42479651
   0.42479651]
 [ 1.07270737  0.66696193 -1.03843379  0.18177791  0.7632291   0.76357774
   0.18177791  0.18177791  0.          0.          0.          0.18177791
   0.18177791]
 [ 0.60424656  0.07201936  0.29379648  0.56088692 -1.51874886 -1.52159386
   0.56088692  0.56088692  0.          0.          0.          0.56088692
   0.56088692]
 [ 0.52277511  0.99052718  0.89374123  1.54268205  0.43146907  0.43698336
   1.54268205  1.54268205  0.          0.          0.          1.54268205
   1.54268205]]
2024-09-20 01:36:45 - INFO - y 샘플:
[1.54268205]
2024-09-20 01:36:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:36:45 - INFO - 모델 출력 (스케일링된 예측): [0.4767107]
2024-09-20 01:36:45 - INFO - 스케일러 역변환 후 예측 가격: 84520340.55830958
2024-09-20 01:36:45 - INFO - TransformerPredictor 최종 예측 가격: 84520340.55830958
2024-09-20 01:36:45 - INFO - TRANSFORMER prediction: 84520340.55830958
2024-09-20 01:36:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:36:45 - INFO - BITCOIN_FORECAST prediction: 83392979.1891507
2024-09-20 01:36:45 - INFO - BitcoinForecast prediction: 83392979.1891507
2024-09-20 01:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:36:57 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:36:57 - INFO - 조정된 모델 가중치: {'gpt': 0.0042729581280508055, 'ml': 0.17101850512285943, 'xgboost': 0.07191657270137626, 'rl': 0.22935763485382638, 'lstm': 0.09530609982019315, 'arima': 0.05955609282913044, 'prophet': 0.21677301781515865, 'transformer': 0.1251970439203564, 'bitcoin_forecast': 0.02660207480904845}
2024-09-20 01:36:57 - INFO - 조정된 모델 가중치: {'gpt': 0.0042729581280508055, 'ml': 0.17101850512285943, 'xgboost': 0.07191657270137626, 'rl': 0.22935763485382638, 'lstm': 0.09530609982019315, 'arima': 0.05955609282913044, 'prophet': 0.21677301781515865, 'transformer': 0.1251970439203564, 'bitcoin_forecast': 0.02660207480904845}
2024-09-20 01:36:57 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84569324.33515272, 'current_price': 84630000.0, 'predictions': {'gpt': 84630000.0, 'ml': 84714629.99999999, 'xgboost': 84630000.0, 'lstm': 84512564.46734786, 'rl': 85476300.0, 'arima': 80899000.0, 'prophet': 84679720.83623248, 'transformer': 84520340.55830958, 'bitcoin_forecast': 83392979.1891507}, 'weights': {'gpt': 0.0042729581280508055, 'ml': 0.17101850512285943, 'xgboost': 0.07191657270137626, 'rl': 0.22935763485382638, 'lstm': 0.09530609982019315, 'arima': 0.05955609282913044, 'prophet': 0.21677301781515865, 'transformer': 0.1251970439203564, 'bitcoin_forecast': 0.02660207480904845}}
2024-09-20 01:36:57 - INFO - 모델별 가중치:
2024-09-20 01:36:57 - INFO -   - GPT: 0.0043
2024-09-20 01:36:57 - INFO -   - ML: 0.1710
2024-09-20 01:36:57 - INFO -   - XGBOOST: 0.0719
2024-09-20 01:36:57 - INFO -   - RL: 0.2294
2024-09-20 01:36:57 - INFO -   - LSTM: 0.0953
2024-09-20 01:36:57 - INFO -   - ARIMA: 0.0596
2024-09-20 01:36:57 - INFO -   - PROPHET: 0.2168
2024-09-20 01:36:57 - INFO -   - TRANSFORMER: 0.1252
2024-09-20 01:36:57 - INFO -   - BITCOIN_FORECAST: 0.0266
2024-09-20 01:36:57 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:36:57 - INFO - 6. 거래 실행
2024-09-20 01:36:57 - INFO - Cancelling existing orders.
2024-09-20 01:36:57 - INFO - Cancelled 0 orders.
2024-09-20 01:36:57 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84569324.33515272, 'current_price': 84630000.0, 'predictions': {'gpt': 84630000.0, 'ml': 84714629.99999999, 'xgboost': 84630000.0, 'lstm': 84512564.46734786, 'rl': 85476300.0, 'arima': 80899000.0, 'prophet': 84679720.83623248, 'transformer': 84520340.55830958, 'bitcoin_forecast': 83392979.1891507}, 'weights': {'gpt': 0.0042729581280508055, 'ml': 0.17101850512285943, 'xgboost': 0.07191657270137626, 'rl': 0.22935763485382638, 'lstm': 0.09530609982019315, 'arima': 0.05955609282913044, 'prophet': 0.21677301781515865, 'transformer': 0.1251970439203564, 'bitcoin_forecast': 0.02660207480904845}}, 현재 가격=84630000.0
2024-09-20 01:36:57 - INFO - 현재 잔고: KRW=164491.34345947, BTC=0.00372274, 총 자산가치=479546.82965947
2024-09-20 01:36:57 - INFO - 매도 시도: 0.000372274 BTC (약 31505.54862 KRW)
2024-09-20 01:36:57 - INFO - 주문 결과: {'uuid': 'eaa5490f-b213-4a9e-b138-111b247b3934', 'side': 'ask', 'ord_type': 'limit', 'price': '84630000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:36:57+09:00', 'volume': '0.00037227', 'remaining_volume': '0.00037227', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00037227', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:36:57 - INFO - sell 주문 성공: UUID=eaa5490f-b213-4a9e-b138-111b247b3934
2024-09-20 01:36:57 - INFO - Trade executed successfully.
2024-09-20 01:36:57 - INFO - 7. summary 리포트 보내기
2024-09-20 01:36:57 - INFO - Message sent to Discord successfully.
2024-09-20 01:36:57 - INFO - Trading cycle completed.
2024-09-20 01:36:57 - INFO - Performing periodic update.
2024-09-20 01:36:57 - INFO - 계산된 시장 변동성: 0.028048575577983025
2024-09-20 01:45:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:45:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9f15-c95e0939c154 "HTTP/1.1 200 OK"
2024-09-20 01:45:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:45:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-82b5-f024dc00cb0f "HTTP/1.1 200 OK"
2024-09-20 01:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:46:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:46:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-a257-f548e6ad860e "HTTP/1.1 200 OK"
2024-09-20 01:46:30 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:46:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:46:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819b-8a54-f8e0e6531033 "HTTP/1.1 200 OK"
2024-09-20 01:46:36 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:46:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8134-b73a-f737272667a8 "HTTP/1.1 200 OK"
2024-09-20 01:46:42 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:46:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ab-a179-fe284b9f94c1 "HTTP/1.1 200 OK"
2024-09-20 01:46:47 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:46:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:46:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-9178-cf81d9814aaf "HTTP/1.1 200 OK"
2024-09-20 01:46:54 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:47:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:47:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-a660-dd618c3a2ea8 "HTTP/1.1 200 OK"
2024-09-20 01:47:01 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:47:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8158-8d6a-d65932ed3f6f "HTTP/1.1 200 OK"
2024-09-20 01:47:07 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:35:34.949184
2024-09-20 01:47:07 - INFO - Starting trading cycle.
2024-09-20 01:47:07 - INFO - ##################################################
2024-09-20 01:47:07 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-20 01:47:07 - INFO - ##################################################
2024-09-20 01:47:07 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:47:07 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:47:07 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:30:00
2024-09-20 01:47:07 - INFO - 새로운 데이터 범위: 2024-09-18 16:30:00 ~ 2024-09-20 01:40:00
2024-09-20 01:47:07 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:47:07 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:47:07 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:47:07 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:47:07 - INFO - Sample date values: [Timestamp('2024-09-20 01:40:00')]
2024-09-20 01:47:07 - INFO - Successfully added 1 new data points
2024-09-20 01:47:07 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:47:07 - INFO - Final date range: 2024-09-20 01:40:00 to 2024-09-20 01:40:00
2024-09-20 01:47:07 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:47:07 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:40:00
2024-09-20 01:47:07 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:47:07 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:47:07 - INFO - GPT | 이전예측가격: 84630000 | 당시BTC가격: 84630000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:47:07 - INFO - ML 모델 예측 업데이트: 정확도 48.00%, 적중/전체: 24/50
2024-09-20 01:47:08 - INFO - ML | 이전예측가격: 84714630 | 당시BTC가격: 84630000 | 예측: 상승 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2349 | 반영가중치값: 0.0200 | 새 가중치: 0.2549 | 예측 총 횟수: 50 | 예측 성공 수: 24 | 예측 성공률: 48.00%
2024-09-20 01:47:08 - INFO - XGBOOST | 이전예측가격: 84630000 | 당시BTC가격: 84630000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:47:08 - INFO - LSTM 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-20 01:47:08 - INFO - LSTM | 이전예측가격: 84512564 | 당시BTC가격: 84630000 | 예측: 하락 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0774 | 반영가중치값: -0.0200 | 새 가중치: 0.0574 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-20 01:47:08 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 36/54
2024-09-20 01:47:08 - INFO - RL | 이전예측가격: 85476300 | 당시BTC가격: 84630000 | 예측: 상승 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3080 | 반영가중치값: 0.0200 | 새 가중치: 0.3280 | 예측 총 횟수: 54 | 예측 성공 수: 36 | 예측 성공률: 66.67%
2024-09-20 01:47:08 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.81%, 적중/전체: 125/246
2024-09-20 01:47:08 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84630000 | 예측: 하락 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 246 | 예측 성공 수: 125 | 예측 성공률: 50.81%
2024-09-20 01:47:08 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.00%, 적중/전체: 33/50
2024-09-20 01:47:08 - INFO - PROPHET | 이전예측가격: 84679721 | 당시BTC가격: 84630000 | 예측: 상승 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1392 | 반영가중치값: 0.0200 | 새 가중치: 0.1592 | 예측 총 횟수: 50 | 예측 성공 수: 33 | 예측 성공률: 66.00%
2024-09-20 01:47:08 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-20 01:47:08 - INFO - TRANSFORMER | 이전예측가격: 84520341 | 당시BTC가격: 84630000 | 예측: 하락 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1087 | 반영가중치값: -0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-20 01:47:08 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 35.71%, 적중/전체: 5/14
2024-09-20 01:47:08 - INFO - BITCOIN_FORECAST | 이전예측가격: 83392979 | 당시BTC가격: 84630000 | 예측: 하락 | 지금 BTC가격: 84646000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0570 | 반영가중치값: -0.0200 | 새 가중치: 0.0370 | 예측 총 횟수: 14 | 예측 성공 수: 5 | 예측 성공률: 35.71%
2024-09-20 01:47:08 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:47:08 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:47:08 - INFO - 새로운 가중치: {'gpt': 0.004266495197419152, 'ml': 0.25447507919519097, 'xgboost': 0.07180779751409229, 'rl': 0.32753686958850253, 'lstm': 0.05734401491701694, 'arima': 0.0, 'prophet': 0.1589803194861806, 'transformer': 0.08861052605114801, 'bitcoin_forecast': 0.0369788980504496}
2024-09-20 01:47:08 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:47:08 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:47:08 - INFO - Current BTC price: 84646000.0
2024-09-20 01:47:08 - INFO - Analyzing market conditions.
2024-09-20 01:47:08 - INFO - Market analysis: {'current_price': 84646000.0, 'sma_20': 84436650.0, 'rsi_14': 62.156797918085324, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:47:08 - INFO - Starting predictions for all models
2024-09-20 01:47:08 - INFO - Attempting prediction for gpt
2024-09-20 01:47:08 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:47:08 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:47:08 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:47:08 - INFO - GPT prediction: 84646000.0
2024-09-20 01:47:08 - INFO - Attempting prediction for ml
2024-09-20 01:47:08 - INFO - ML prediction: 84662929.2
2024-09-20 01:47:08 - INFO - Attempting prediction for xgboost
2024-09-20 01:47:08 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:47:08 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:47:08 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:47:08 - INFO - XGBOOST prediction: 84646000.0
2024-09-20 01:47:08 - INFO - Attempting prediction for lstm
2024-09-20 01:47:08 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:47:08 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:47:08 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:47:08 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:47:08 - INFO - X 샘플:
[[-2.25146135 -1.03820039 -1.99830748 -0.34375539  1.35645047  1.35295086
  -0.34375539]
 [-1.10081216 -2.19965745 -0.74432699 -1.76619148 -0.95142191 -0.95506851
  -1.76619148]
 [ 0.07182396 -0.52858148  0.42008346 -1.09053434 -0.34633989 -0.34687787
  -1.09053434]
 [-0.08208453  0.47880475  0.87689064  0.75863258  0.50565738  0.50903853
   0.75863258]
 [ 1.03191978  0.7039852   0.46486848 -0.58082807 -0.45165041 -0.45097138
  -0.58082807]
 [-0.32394073  0.36028872  0.40216946  0.04741454  0.23167406  0.23353663
   0.04741454]
 [ 0.81205051  0.34843712 -1.37131723 -0.24892632  1.39542813  1.39226259
  -0.24892632]
 [ 0.30635119 -0.32710423 -0.01880971  0.21336541 -1.49692556 -1.49805884
   0.21336541]
 [ 0.21840348  0.7158368   0.59026653  1.41058246  0.97493004  0.97918082
   1.41058246]
 [ 1.31774984  1.48619097  1.37848284  1.6002406  -1.2178023  -1.21599284
   1.6002406 ]]
2024-09-20 01:47:08 - INFO - y 샘플:
[1.6002406]
2024-09-20 01:47:08 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:47:08 - INFO - 모델 출력 (스케일링된 예측): [[0.41722918]]
2024-09-20 01:47:08 - INFO - 스케일러 역변환 후 예측 가격: 84546198.41866125
2024-09-20 01:47:08 - INFO - LSTMPredictor 최종 예측 가격: 84546198.41866125
2024-09-20 01:47:08 - INFO - LSTM prediction: 84546198.41866125
2024-09-20 01:47:08 - INFO - Attempting prediction for rl
2024-09-20 01:47:08 - INFO - Preparing state for RL agent.
2024-09-20 01:47:08 - INFO - Prepared state: [[8.46460000e+07 7.37032464e+00 1.89058254e-04 8.44366500e+07
  6.21567979e+01]]
2024-09-20 01:47:08 - INFO - RL prediction: 85492460.0
2024-09-20 01:47:08 - INFO - Attempting prediction for arima
2024-09-20 01:47:08 - INFO - ARIMA 예측 시작
2024-09-20 01:47:08 - INFO - 입력 데이터: {'open': 84668000.0, 'high': 84695000.0, 'low': 84507000.0, 'close': 84646000.0, 'volume': 7.37032464, 'value': 623520729.87161, 'decision': 'sell', 'sma': 84436650.0, 'ema': 84395193.2461825, 'rsi': 62.156797918085324, 'macd': 187143.57980659604, 'signal_line': 204317.2253242777, 'BB_Upper': 84781161.98818506, 'BB_Lower': 84092138.01181494}
2024-09-20 01:47:08 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:47:08 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84436650.0         0         0
2024-09-20 01:47:08 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84436650.0         0         0
2024-09-20 01:47:08 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:47:08 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:47:08 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:47:08 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:47:08 - INFO - Attempting prediction for prophet
2024-09-20 01:47:08 - INFO - PROPHET prediction: 84692336.23156986
2024-09-20 01:47:08 - INFO - Attempting prediction for transformer
2024-09-20 01:47:08 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:47:08 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:47:08 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:47:08 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:47:08 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:47:08 - INFO - X 샘플:
[[-2.25146135 -1.03820039 -1.99830748 -0.34375539  1.35645047  1.35295086
  -0.34375539 -0.34375539  0.          0.          0.         -0.34375539
  -0.34375539]
 [-1.10081216 -2.19965745 -0.74432699 -1.76619148 -0.95142191 -0.95506851
  -1.76619148 -1.76619148  0.          0.          0.         -1.76619148
  -1.76619148]
 [ 0.07182396 -0.52858148  0.42008346 -1.09053434 -0.34633989 -0.34687787
  -1.09053434 -1.09053434  0.          0.          0.         -1.09053434
  -1.09053434]
 [-0.08208453  0.47880475  0.87689064  0.75863258  0.50565738  0.50903853
   0.75863258  0.75863258  0.          0.          0.          0.75863258
   0.75863258]
 [ 1.03191978  0.7039852   0.46486848 -0.58082807 -0.45165041 -0.45097138
  -0.58082807 -0.58082807  0.          0.          0.         -0.58082807
  -0.58082807]
 [-0.32394073  0.36028872  0.40216946  0.04741454  0.23167406  0.23353663
   0.04741454  0.04741454  0.          0.          0.          0.04741454
   0.04741454]
 [ 0.81205051  0.34843712 -1.37131723 -0.24892632  1.39542813  1.39226259
  -0.24892632 -0.24892632  0.          0.          0.         -0.24892632
  -0.24892632]
 [ 0.30635119 -0.32710423 -0.01880971  0.21336541 -1.49692556 -1.49805884
   0.21336541  0.21336541  0.          0.          0.          0.21336541
   0.21336541]
 [ 0.21840348  0.7158368   0.59026653  1.41058246  0.97493004  0.97918082
   1.41058246  1.41058246  0.          0.          0.          1.41058246
   1.41058246]
 [ 1.31774984  1.48619097  1.37848284  1.6002406  -1.2178023  -1.21599284
   1.6002406   1.6002406   0.          0.          0.          1.6002406
   1.6002406 ]]
2024-09-20 01:47:08 - INFO - y 샘플:
[1.6002406]
2024-09-20 01:47:08 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:47:08 - INFO - 모델 출력 (스케일링된 예측): [0.479569]
2024-09-20 01:47:08 - INFO - 스케일러 역변환 후 예측 가격: 84551457.54949087
2024-09-20 01:47:08 - INFO - TransformerPredictor 최종 예측 가격: 84551457.54949087
2024-09-20 01:47:08 - INFO - TRANSFORMER prediction: 84551457.54949087
2024-09-20 01:47:08 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:47:08 - INFO - BITCOIN_FORECAST prediction: 83305082.4861342
2024-09-20 01:47:08 - INFO - BitcoinForecast prediction: 83305082.4861342
2024-09-20 01:47:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:19 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:19 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:20 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:47:22 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:47:22 - INFO - 조정된 모델 가중치: {'gpt': 0.004266495197419152, 'ml': 0.25447507919519097, 'xgboost': 0.07180779751409229, 'rl': 0.32753686958850253, 'lstm': 0.05734401491701694, 'arima': 0.0, 'prophet': 0.1589803194861806, 'transformer': 0.08861052605114801, 'bitcoin_forecast': 0.0369788980504496}
2024-09-20 01:47:22 - INFO - 조정된 모델 가중치: {'gpt': 0.004266495197419152, 'ml': 0.25447507919519097, 'xgboost': 0.07180779751409229, 'rl': 0.32753686958850253, 'lstm': 0.05734401491701694, 'arima': 0.0, 'prophet': 0.1589803194861806, 'transformer': 0.08861052605114801, 'bitcoin_forecast': 0.0369788980504496}
2024-09-20 01:47:22 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84871235.33535925, 'current_price': 84646000.0, 'predictions': {'gpt': 84646000.0, 'ml': 84662929.2, 'xgboost': 84646000.0, 'lstm': 84546198.41866125, 'rl': 85492460.0, 'arima': 80899000.0, 'prophet': 84692336.23156986, 'transformer': 84551457.54949087, 'bitcoin_forecast': 83305082.4861342}, 'weights': {'gpt': 0.004266495197419152, 'ml': 0.25447507919519097, 'xgboost': 0.07180779751409229, 'rl': 0.32753686958850253, 'lstm': 0.05734401491701694, 'arima': 0.0, 'prophet': 0.1589803194861806, 'transformer': 0.08861052605114801, 'bitcoin_forecast': 0.0369788980504496}}
2024-09-20 01:47:22 - INFO - 모델별 가중치:
2024-09-20 01:47:22 - INFO -   - GPT: 0.0043
2024-09-20 01:47:22 - INFO -   - ML: 0.2545
2024-09-20 01:47:22 - INFO -   - XGBOOST: 0.0718
2024-09-20 01:47:22 - INFO -   - RL: 0.3275
2024-09-20 01:47:22 - INFO -   - LSTM: 0.0573
2024-09-20 01:47:22 - INFO -   - ARIMA: 0.0000
2024-09-20 01:47:22 - INFO -   - PROPHET: 0.1590
2024-09-20 01:47:22 - INFO -   - TRANSFORMER: 0.0886
2024-09-20 01:47:22 - INFO -   - BITCOIN_FORECAST: 0.0370
2024-09-20 01:47:22 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:47:22 - INFO - 6. 거래 실행
2024-09-20 01:47:22 - INFO - Cancelling existing orders.
2024-09-20 01:47:22 - INFO - Cancelled 0 orders.
2024-09-20 01:47:22 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84871235.33535925, 'current_price': 84646000.0, 'predictions': {'gpt': 84646000.0, 'ml': 84662929.2, 'xgboost': 84646000.0, 'lstm': 84546198.41866125, 'rl': 85492460.0, 'arima': 80899000.0, 'prophet': 84692336.23156986, 'transformer': 84551457.54949087, 'bitcoin_forecast': 83305082.4861342}, 'weights': {'gpt': 0.004266495197419152, 'ml': 0.25447507919519097, 'xgboost': 0.07180779751409229, 'rl': 0.32753686958850253, 'lstm': 0.05734401491701694, 'arima': 0.0, 'prophet': 0.1589803194861806, 'transformer': 0.08861052605114801, 'bitcoin_forecast': 0.0369788980504496}}, 현재 가격=84646000.0
2024-09-20 01:47:22 - INFO - 현재 잔고: KRW=195986.75429626, BTC=0.00335047, 총 자산가치=479590.63791626
2024-09-20 01:47:22 - INFO - 매수 시도: 0.0005665839353498807 BTC (약 47959.063791626 KRW)
2024-09-20 01:47:22 - INFO - 주문 결과: {'uuid': '73c2119b-468c-4ac2-b548-3468f6a67b12', 'side': 'bid', 'ord_type': 'limit', 'price': '84646000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:47:23+09:00', 'volume': '0.00056658', 'remaining_volume': '0.00056658', 'reserved_fee': '23.97936534', 'remaining_fee': '23.97936534', 'paid_fee': '0', 'locked': '47982.71004534', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:47:22 - INFO - buy 주문 성공: UUID=73c2119b-468c-4ac2-b548-3468f6a67b12
2024-09-20 01:47:22 - INFO - Trade executed successfully.
2024-09-20 01:47:22 - INFO - 7. summary 리포트 보내기
2024-09-20 01:47:23 - INFO - Message sent to Discord successfully.
2024-09-20 01:47:23 - INFO - Trading cycle completed.
2024-09-20 01:47:23 - INFO - Performing periodic update.
2024-09-20 01:47:23 - INFO - 계산된 시장 변동성: 0.027985689330806723
2024-09-20 01:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818f-bafd-d32bee94d34b "HTTP/1.1 200 OK"
2024-09-20 01:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:55:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-9530-f3616cdc4c00 "HTTP/1.1 200 OK"
2024-09-20 01:55:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:55:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:55:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8159-b6aa-ea159ed06157 "HTTP/1.1 200 OK"
2024-09-20 01:55:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:55:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-8004-f570f9a81bbb "HTTP/1.1 200 OK"
2024-09-20 01:56:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-8b75-de785b6c0077 "HTTP/1.1 200 OK"
2024-09-20 01:56:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/eb848131-5617-4ade-807a-50024d2c8b9a "HTTP/1.1 200 OK"
2024-09-20 01:56:17 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8f06e7d4-07d3-4f69-9f56-f30beeea9cf9 "HTTP/1.1 200 OK"
2024-09-20 01:56:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5725a5c1-bc59-4da7-a46d-50f72e7cfab0 "HTTP/1.1 200 OK"
2024-09-20 01:56:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 01:56:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811b-9c74-cb3d6dedb7b1 "HTTP/1.1 200 OK"
2024-09-20 01:56:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:45:34.949308
2024-09-20 01:56:47 - INFO - Starting trading cycle.
2024-09-20 01:56:47 - INFO - ##################################################
2024-09-20 01:56:47 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-20 01:56:47 - INFO - ##################################################
2024-09-20 01:56:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 01:56:47 - INFO - 데이터베이스 업데이트 시작
2024-09-20 01:56:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:40:00
2024-09-20 01:56:47 - INFO - 새로운 데이터 범위: 2024-09-18 16:40:00 ~ 2024-09-20 01:50:00
2024-09-20 01:56:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 01:56:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 01:56:47 - INFO - Index: Index([199], dtype='int64')
2024-09-20 01:56:47 - INFO - Date column data type: datetime64[ns]
2024-09-20 01:56:47 - INFO - Sample date values: [Timestamp('2024-09-20 01:50:00')]
2024-09-20 01:56:47 - INFO - Successfully added 1 new data points
2024-09-20 01:56:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 01:56:47 - INFO - Final date range: 2024-09-20 01:50:00 to 2024-09-20 01:50:00
2024-09-20 01:56:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 01:56:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 01:50:00
2024-09-20 01:56:47 - INFO - 데이터베이스 업데이트 완료
2024-09-20 01:56:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 01:56:47 - INFO - GPT | 이전예측가격: 84646000 | 당시BTC가격: 84646000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:56:47 - INFO - ML 모델 예측 업데이트: 정확도 49.02%, 적중/전체: 25/51
2024-09-20 01:56:47 - INFO - ML | 이전예측가격: 84662929 | 당시BTC가격: 84646000 | 예측: 상승 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1710 | 반영가중치값: 0.0200 | 새 가중치: 0.1910 | 예측 총 횟수: 51 | 예측 성공 수: 25 | 예측 성공률: 49.02%
2024-09-20 01:56:47 - INFO - XGBOOST | 이전예측가격: 84646000 | 당시BTC가격: 84646000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 01:56:47 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 8/14
2024-09-20 01:56:47 - INFO - LSTM | 이전예측가격: 84546198 | 당시BTC가격: 84646000 | 예측: 하락 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0953 | 반영가중치값: -0.0200 | 새 가중치: 0.0753 | 예측 총 횟수: 14 | 예측 성공 수: 8 | 예측 성공률: 57.14%
2024-09-20 01:56:47 - INFO - RL 모델 예측 업데이트: 정확도 67.27%, 적중/전체: 37/55
2024-09-20 01:56:47 - INFO - RL | 이전예측가격: 85492460 | 당시BTC가격: 84646000 | 예측: 상승 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2294 | 반영가중치값: 0.0200 | 새 가중치: 0.2494 | 예측 총 횟수: 55 | 예측 성공 수: 37 | 예측 성공률: 67.27%
2024-09-20 01:56:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.61%, 적중/전체: 125/247
2024-09-20 01:56:47 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84646000 | 예측: 하락 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0596 | 반영가중치값: -0.0200 | 새 가중치: 0.0396 | 예측 총 횟수: 247 | 예측 성공 수: 125 | 예측 성공률: 50.61%
2024-09-20 01:56:47 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 34/51
2024-09-20 01:56:47 - INFO - PROPHET | 이전예측가격: 84692336 | 당시BTC가격: 84646000 | 예측: 상승 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2168 | 반영가중치값: 0.0200 | 새 가중치: 0.2368 | 예측 총 횟수: 51 | 예측 성공 수: 34 | 예측 성공률: 66.67%
2024-09-20 01:56:47 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 8/14
2024-09-20 01:56:47 - INFO - TRANSFORMER | 이전예측가격: 84551458 | 당시BTC가격: 84646000 | 예측: 하락 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1252 | 반영가중치값: -0.0200 | 새 가중치: 0.1052 | 예측 총 횟수: 14 | 예측 성공 수: 8 | 예측 성공률: 57.14%
2024-09-20 01:56:47 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 5/15
2024-09-20 01:56:47 - INFO - BITCOIN_FORECAST | 이전예측가격: 83305082 | 당시BTC가격: 84646000 | 예측: 하락 | 지금 BTC가격: 84876000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0266 | 반영가중치값: -0.0200 | 새 가중치: 0.0066 | 예측 총 횟수: 15 | 예측 성공 수: 5 | 예측 성공률: 33.33%
2024-09-20 01:56:47 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 01:56:47 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 01:56:47 - INFO - 새로운 가중치: {'gpt': 0.004354078523707634, 'ml': 0.1949397649127295, 'xgboost': 0.07328187997961068, 'rl': 0.2544764900465236, 'lstm': 0.076851996019972, 'arima': 0.04036810691203552, 'prophet': 0.24163353388656025, 'transformer': 0.10735654641501143, 'bitcoin_forecast': 0.006737603303849436}
2024-09-20 01:56:47 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 01:56:47 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 01:56:47 - INFO - Current BTC price: 84879000.0
2024-09-20 01:56:47 - INFO - Analyzing market conditions.
2024-09-20 01:56:47 - INFO - Market analysis: {'current_price': 84876000.0, 'sma_20': 84467950.0, 'rsi_14': 67.34447666794772, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 01:56:47 - INFO - Starting predictions for all models
2024-09-20 01:56:47 - INFO - Attempting prediction for gpt
2024-09-20 01:56:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 01:56:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:56:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 01:56:48 - INFO - GPT prediction: 84879000.0
2024-09-20 01:56:48 - INFO - Attempting prediction for ml
2024-09-20 01:56:48 - INFO - ML prediction: 84876000.0
2024-09-20 01:56:48 - INFO - Attempting prediction for xgboost
2024-09-20 01:56:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 01:56:48 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:56:48 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 01:56:48 - INFO - XGBOOST prediction: 84876000.0
2024-09-20 01:56:48 - INFO - Attempting prediction for lstm
2024-09-20 01:56:48 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:56:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:56:48 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 01:56:48 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:56:48 - INFO - X 샘플:
[[-1.94040399 -1.84880712 -1.10535322 -1.37393714 -0.61241035 -0.61236439
  -1.37393714]
 [-0.39963655 -0.69789408 -0.07527495 -0.95825552 -0.38723433 -0.38735324
  -0.95825552]
 [-0.60186228 -0.00408125  0.32883268  0.17939944 -0.07017093 -0.07069146
   0.17939944]
 [ 0.86186678  0.15100632 -0.03565656 -0.64467114 -0.42642472 -0.42586452
  -0.64467114]
 [-0.91964556 -0.08570629 -0.09112231 -0.25816016 -0.17213145 -0.17261838
  -0.25816016]
 [ 0.57297289 -0.09386879 -1.66001076 -0.44047666  0.26094954  0.25607327
  -0.44047666]
 [-0.09148307 -0.55913151 -0.46353522 -0.15606292 -0.8154148  -0.81325349
  -0.15606292]
 [-0.20704062  0.15916882  0.07527495  0.58049573  0.10446482  0.10324619
   0.58049573]
 [ 1.23742885  0.68973157  0.77255871  0.69717829 -0.7115415  -0.70889807
   0.69717829]
 [ 1.48780355  2.28958232  2.25428668  2.37449009  2.82991373  2.83172409
   2.37449009]]
2024-09-20 01:56:48 - INFO - y 샘플:
[2.37449009]
2024-09-20 01:56:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 01:56:48 - INFO - 모델 출력 (스케일링된 예측): [[0.62004083]]
2024-09-20 01:56:48 - INFO - 스케일러 역변환 후 예측 가격: 84635422.58924735
2024-09-20 01:56:48 - INFO - LSTMPredictor 최종 예측 가격: 84635422.58924735
2024-09-20 01:56:48 - INFO - LSTM prediction: 84635422.58924735
2024-09-20 01:56:48 - INFO - Attempting prediction for rl
2024-09-20 01:56:48 - INFO - Preparing state for RL agent.
2024-09-20 01:56:48 - INFO - Prepared state: [[8.48760000e+07 4.86924002e+01 2.71719869e-03 8.44679500e+07
  6.73444767e+01]]
2024-09-20 01:56:48 - INFO - RL prediction: 85727790.0
2024-09-20 01:56:48 - INFO - Attempting prediction for arima
2024-09-20 01:56:48 - INFO - ARIMA 예측 시작
2024-09-20 01:56:48 - INFO - 입력 데이터: {'open': 84694000.0, 'high': 84891000.0, 'low': 84694000.0, 'close': 84876000.0, 'volume': 48.69240022, 'value': 4130337732.51576, 'decision': 'sell', 'sma': 84467950.0, 'ema': 84440984.36559369, 'rsi': 67.34447666794772, 'macd': 203605.36730720103, 'signal_line': 204174.8537208624, 'BB_Upper': 84850582.7090018, 'BB_Lower': 84085317.2909982}
2024-09-20 01:56:48 - INFO - Exogenous 변수 예측 시작
2024-09-20 01:56:48 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84467950.0         0         0
2024-09-20 01:56:48 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84467950.0         0         0
2024-09-20 01:56:48 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 01:56:48 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 01:56:48 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 01:56:48 - INFO - ARIMA prediction: 80899000.0
2024-09-20 01:56:48 - INFO - Attempting prediction for prophet
2024-09-20 01:56:48 - INFO - PROPHET prediction: 84974232.81684634
2024-09-20 01:56:48 - INFO - Attempting prediction for transformer
2024-09-20 01:56:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 01:56:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 01:56:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 01:56:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 01:56:48 - INFO - X dtype: float64, y dtype: float64
2024-09-20 01:56:48 - INFO - X 샘플:
[[-1.94040399 -1.84880712 -1.10535322 -1.37393714 -0.61241035 -0.61236439
  -1.37393714 -1.37393714  0.          0.          0.         -1.37393714
  -1.37393714]
 [-0.39963655 -0.69789408 -0.07527495 -0.95825552 -0.38723433 -0.38735324
  -0.95825552 -0.95825552  0.          0.          0.         -0.95825552
  -0.95825552]
 [-0.60186228 -0.00408125  0.32883268  0.17939944 -0.07017093 -0.07069146
   0.17939944  0.17939944  0.          0.          0.          0.17939944
   0.17939944]
 [ 0.86186678  0.15100632 -0.03565656 -0.64467114 -0.42642472 -0.42586452
  -0.64467114 -0.64467114  0.          0.          0.         -0.64467114
  -0.64467114]
 [-0.91964556 -0.08570629 -0.09112231 -0.25816016 -0.17213145 -0.17261838
  -0.25816016 -0.25816016  0.          0.          0.         -0.25816016
  -0.25816016]
 [ 0.57297289 -0.09386879 -1.66001076 -0.44047666  0.26094954  0.25607327
  -0.44047666 -0.44047666  0.          0.          0.         -0.44047666
  -0.44047666]
 [-0.09148307 -0.55913151 -0.46353522 -0.15606292 -0.8154148  -0.81325349
  -0.15606292 -0.15606292  0.          0.          0.         -0.15606292
  -0.15606292]
 [-0.20704062  0.15916882  0.07527495  0.58049573  0.10446482  0.10324619
   0.58049573  0.58049573  0.          0.          0.          0.58049573
   0.58049573]
 [ 1.23742885  0.68973157  0.77255871  0.69717829 -0.7115415  -0.70889807
   0.69717829  0.69717829  0.          0.          0.          0.69717829
   0.69717829]
 [ 1.48780355  2.28958232  2.25428668  2.37449009  2.82991373  2.83172409
   2.37449009  2.37449009  0.          0.          0.          2.37449009
   2.37449009]]
2024-09-20 01:56:48 - INFO - y 샘플:
[2.37449009]
2024-09-20 01:56:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 01:56:48 - INFO - 모델 출력 (스케일링된 예측): [0.48849657]
2024-09-20 01:56:48 - INFO - 스케일러 역변환 후 예측 가격: 84617384.69051874
2024-09-20 01:56:48 - INFO - TransformerPredictor 최종 예측 가격: 84617384.69051874
2024-09-20 01:56:48 - INFO - TRANSFORMER prediction: 84617384.69051874
2024-09-20 01:56:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 01:56:48 - INFO - BITCOIN_FORECAST prediction: 83508721.2179589
2024-09-20 01:56:48 - INFO - BitcoinForecast prediction: 83508721.2179589
2024-09-20 01:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 01:56:53 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 01:56:53 - INFO - 조정된 모델 가중치: {'gpt': 0.004354078523707634, 'ml': 0.1949397649127295, 'xgboost': 0.07328187997961068, 'rl': 0.2544764900465236, 'lstm': 0.076851996019972, 'arima': 0.04036810691203552, 'prophet': 0.24163353388656025, 'transformer': 0.10735654641501143, 'bitcoin_forecast': 0.006737603303849436}
2024-09-20 01:56:53 - INFO - 조정된 모델 가중치: {'gpt': 0.004354078523707634, 'ml': 0.1949397649127295, 'xgboost': 0.07328187997961068, 'rl': 0.2544764900465236, 'lstm': 0.076851996019972, 'arima': 0.04036810691203552, 'prophet': 0.24163353388656025, 'transformer': 0.10735654641501143, 'bitcoin_forecast': 0.006737603303849436}
2024-09-20 01:56:53 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84900500.89045256, 'current_price': 84879000.0, 'predictions': {'gpt': 84879000.0, 'ml': 84876000.0, 'xgboost': 84876000.0, 'lstm': 84635422.58924735, 'rl': 85727790.0, 'arima': 80899000.0, 'prophet': 84974232.81684634, 'transformer': 84617384.69051874, 'bitcoin_forecast': 83508721.2179589}, 'weights': {'gpt': 0.004354078523707634, 'ml': 0.1949397649127295, 'xgboost': 0.07328187997961068, 'rl': 0.2544764900465236, 'lstm': 0.076851996019972, 'arima': 0.04036810691203552, 'prophet': 0.24163353388656025, 'transformer': 0.10735654641501143, 'bitcoin_forecast': 0.006737603303849436}}
2024-09-20 01:56:53 - INFO - 모델별 가중치:
2024-09-20 01:56:53 - INFO -   - GPT: 0.0044
2024-09-20 01:56:53 - INFO -   - ML: 0.1949
2024-09-20 01:56:53 - INFO -   - XGBOOST: 0.0733
2024-09-20 01:56:53 - INFO -   - RL: 0.2545
2024-09-20 01:56:53 - INFO -   - LSTM: 0.0769
2024-09-20 01:56:53 - INFO -   - ARIMA: 0.0404
2024-09-20 01:56:53 - INFO -   - PROPHET: 0.2416
2024-09-20 01:56:53 - INFO -   - TRANSFORMER: 0.1074
2024-09-20 01:56:53 - INFO -   - BITCOIN_FORECAST: 0.0067
2024-09-20 01:56:53 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 01:56:53 - INFO - 6. 거래 실행
2024-09-20 01:56:53 - INFO - Cancelling existing orders.
2024-09-20 01:56:53 - INFO - Cancelled 0 orders.
2024-09-20 01:56:53 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84900500.89045256, 'current_price': 84879000.0, 'predictions': {'gpt': 84879000.0, 'ml': 84876000.0, 'xgboost': 84876000.0, 'lstm': 84635422.58924735, 'rl': 85727790.0, 'arima': 80899000.0, 'prophet': 84974232.81684634, 'transformer': 84617384.69051874, 'bitcoin_forecast': 83508721.2179589}, 'weights': {'gpt': 0.004354078523707634, 'ml': 0.1949397649127295, 'xgboost': 0.07328187997961068, 'rl': 0.2544764900465236, 'lstm': 0.076851996019972, 'arima': 0.04036810691203552, 'prophet': 0.24163353388656025, 'transformer': 0.10735654641501143, 'bitcoin_forecast': 0.006737603303849436}}, 현재 가격=84879000.0
2024-09-20 01:56:53 - INFO - 현재 잔고: KRW=148004.04425092, BTC=0.00391705, 총 자산가치=480479.33120092
2024-09-20 01:56:53 - INFO - 매수 시도: 0.0005660756267167615 BTC (약 48047.933120092 KRW)
2024-09-20 01:56:53 - INFO - 주문 결과: {'uuid': 'f86caf1e-db1f-413c-85b7-cf2a4370a668', 'side': 'bid', 'ord_type': 'limit', 'price': '84879000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T01:56:54+09:00', 'volume': '0.00056607', 'remaining_volume': '0.00056607', 'reserved_fee': '24.023727765', 'remaining_fee': '24.023727765', 'paid_fee': '0', 'locked': '48071.479257765', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 01:56:53 - INFO - buy 주문 성공: UUID=f86caf1e-db1f-413c-85b7-cf2a4370a668
2024-09-20 01:56:53 - INFO - Trade executed successfully.
2024-09-20 01:56:53 - INFO - 7. summary 리포트 보내기
2024-09-20 01:56:54 - INFO - Message sent to Discord successfully.
2024-09-20 01:56:54 - INFO - Trading cycle completed.
2024-09-20 01:56:54 - INFO - Performing periodic update.
2024-09-20 01:56:54 - INFO - 계산된 시장 변동성: 0.027893792201615215
2024-09-20 02:05:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:05:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-82da-d9f3c394a1b7 "HTTP/1.1 200 OK"
2024-09-20 02:05:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:05:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:05:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8136-8959-f2c5e1ed50dd "HTTP/1.1 200 OK"
2024-09-20 02:05:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/1e62c013-00f9-4498-b762-27472a1c21ae "HTTP/1.1 200 OK"
2024-09-20 02:06:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-ab4e-e3a309c85d5a "HTTP/1.1 200 OK"
2024-09-20 02:06:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-aeb7-cea2ec5343a7 "HTTP/1.1 200 OK"
2024-09-20 02:06:24 - INFO - Updated actual price for rl prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-84a6-d761773eca7e "HTTP/1.1 200 OK"
2024-09-20 02:06:31 - INFO - Updated actual price for arima prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810e-bf78-e5d7049015f6 "HTTP/1.1 200 OK"
2024-09-20 02:06:40 - INFO - Updated actual price for prophet prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b2-a3d1-c752693944bf "HTTP/1.1 200 OK"
2024-09-20 02:06:46 - INFO - Updated actual price for transformer prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:06:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8103-9ca2-c0b9e64ac558 "HTTP/1.1 200 OK"
2024-09-20 02:06:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 01:55:34.949586
2024-09-20 02:06:53 - INFO - Starting trading cycle.
2024-09-20 02:06:53 - INFO - ##################################################
2024-09-20 02:06:53 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-20 02:06:53 - INFO - ##################################################
2024-09-20 02:06:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:06:53 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:06:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 01:50:00
2024-09-20 02:06:53 - INFO - 새로운 데이터 범위: 2024-09-18 16:50:00 ~ 2024-09-20 02:00:00
2024-09-20 02:06:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:06:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:06:53 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:06:53 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:06:53 - INFO - Sample date values: [Timestamp('2024-09-20 02:00:00')]
2024-09-20 02:06:53 - INFO - Successfully added 1 new data points
2024-09-20 02:06:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:06:53 - INFO - Final date range: 2024-09-20 02:00:00 to 2024-09-20 02:00:00
2024-09-20 02:06:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:06:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:00:00
2024-09-20 02:06:53 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:06:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:06:53 - INFO - GPT | 이전예측가격: 84879000 | 당시BTC가격: 84879000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:06:53 - INFO - ML | 이전예측가격: 84876000 | 당시BTC가격: 84879000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:06:53 - INFO - XGBOOST | 이전예측가격: 84876000 | 당시BTC가격: 84879000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:06:53 - INFO - LSTM 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-20 02:06:53 - INFO - LSTM | 이전예측가격: 84635423 | 당시BTC가격: 84879000 | 예측: 하락 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0573 | 반영가중치값: -0.0200 | 새 가중치: 0.0373 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-20 02:06:53 - INFO - RL 모델 예측 업데이트: 정확도 67.86%, 적중/전체: 38/56
2024-09-20 02:06:53 - INFO - RL | 이전예측가격: 85727790 | 당시BTC가격: 84879000 | 예측: 상승 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3275 | 반영가중치값: 0.0200 | 새 가중치: 0.3475 | 예측 총 횟수: 56 | 예측 성공 수: 38 | 예측 성공률: 67.86%
2024-09-20 02:06:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.40%, 적중/전체: 125/248
2024-09-20 02:06:53 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84879000 | 예측: 하락 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 248 | 예측 성공 수: 125 | 예측 성공률: 50.40%
2024-09-20 02:06:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 67.31%, 적중/전체: 35/52
2024-09-20 02:06:53 - INFO - PROPHET | 이전예측가격: 84974233 | 당시BTC가격: 84879000 | 예측: 상승 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1590 | 반영가중치값: 0.0200 | 새 가중치: 0.1790 | 예측 총 횟수: 52 | 예측 성공 수: 35 | 예측 성공률: 67.31%
2024-09-20 02:06:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-20 02:06:53 - INFO - TRANSFORMER | 이전예측가격: 84617385 | 당시BTC가격: 84879000 | 예측: 하락 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0886 | 반영가중치값: -0.0200 | 새 가중치: 0.0686 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-20 02:06:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 31.25%, 적중/전체: 5/16
2024-09-20 02:06:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 83508721 | 당시BTC가격: 84879000 | 예측: 하락 | 지금 BTC가격: 84968000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0370 | 반영가중치값: -0.0200 | 새 가중치: 0.0170 | 예측 총 횟수: 16 | 예측 성공 수: 5 | 예측 성공률: 31.25%
2024-09-20 02:06:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:06:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:06:53 - INFO - 새로운 가중치: {'gpt': 0.004722292932929804, 'ml': 0.2114253725976655, 'xgboost': 0.07947916006917716, 'rl': 0.37692726354251055, 'lstm': 0.040502112391782794, 'arima': 0.0, 'prophet': 0.19411627356766112, 'transformer': 0.07441276048003774, 'bitcoin_forecast': 0.018414764418235287}
2024-09-20 02:06:53 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:06:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:06:53 - INFO - Current BTC price: 84968000.0
2024-09-20 02:06:53 - INFO - Analyzing market conditions.
2024-09-20 02:06:53 - INFO - Market analysis: {'current_price': 84968000.0, 'sma_20': 84508900.0, 'rsi_14': 69.16530708519637, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:06:53 - INFO - Starting predictions for all models
2024-09-20 02:06:53 - INFO - Attempting prediction for gpt
2024-09-20 02:06:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:06:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:06:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:06:54 - INFO - GPT prediction: 84968000.0
2024-09-20 02:06:54 - INFO - Attempting prediction for ml
2024-09-20 02:06:54 - INFO - ML prediction: 84968000.0
2024-09-20 02:06:54 - INFO - Attempting prediction for xgboost
2024-09-20 02:06:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:06:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:06:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:06:54 - INFO - XGBOOST prediction: 84968000.0
2024-09-20 02:06:54 - INFO - Attempting prediction for lstm
2024-09-20 02:06:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:06:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:06:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:06:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:06:54 - INFO - X 샘플:
[[-0.76042841 -1.0089721  -0.39267501 -1.12707036 -0.56137942 -0.56169494
  -1.12707036]
 [-0.92421299 -0.42594947 -0.11568434 -0.21132569 -0.2665968  -0.26754409
  -0.21132569]
 [ 0.2612754  -0.29562677 -0.36551906 -0.87465356 -0.59781582 -0.59746853
  -0.87465356]
 [-1.18158876 -0.49454037 -0.40353739 -0.56353518 -0.36139232 -0.3622252
  -0.56353518]
 [ 0.02729743 -0.50139946 -1.47891292 -0.71028913  0.04125507  0.03599153
  -0.71028913]
 [-0.5108519  -0.89236757 -0.6588033  -0.48135297 -0.95947067 -0.95731871
  -0.48135297]
 [-0.60444309 -0.28876768 -0.2894824   0.111533   -0.10423311 -0.10597135
   0.111533  ]
 [ 0.56544676  0.15707315  0.18846228  0.20545553 -0.86289679 -0.86038172
   0.20545553]
 [ 0.76822767  1.50145474  1.20409473  1.5555919   2.42969223  2.42854394
   1.5555919 ]
 [ 2.35927788  2.24909551  2.3120574   2.09564645  1.24283764  1.24806907
   2.09564645]]
2024-09-20 02:06:54 - INFO - y 샘플:
[2.09564645]
2024-09-20 02:06:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:06:54 - INFO - 모델 출력 (스케일링된 예측): [[0.65690285]]
2024-09-20 02:06:54 - INFO - 스케일러 역변환 후 예측 가격: 84722905.47794788
2024-09-20 02:06:54 - INFO - LSTMPredictor 최종 예측 가격: 84722905.47794788
2024-09-20 02:06:54 - INFO - LSTM prediction: 84722905.47794788
2024-09-20 02:06:54 - INFO - Attempting prediction for rl
2024-09-20 02:06:54 - INFO - Preparing state for RL agent.
2024-09-20 02:06:54 - INFO - Prepared state: [[8.49680000e+07 3.37973451e+01 1.08393421e-03 8.45089000e+07
  6.91653071e+01]]
2024-09-20 02:06:54 - INFO - RL prediction: 85817680.0
2024-09-20 02:06:54 - INFO - Attempting prediction for arima
2024-09-20 02:06:54 - INFO - ARIMA 예측 시작
2024-09-20 02:06:54 - INFO - 입력 데이터: {'open': 84898000.0, 'high': 85000000.0, 'low': 84898000.0, 'close': 84968000.0, 'volume': 33.79734509, 'value': 2871656391.79124, 'decision': 'sell', 'sma': 84508900.0, 'ema': 84491176.33077525, 'rsi': 69.16530708519637, 'macd': 221521.52141954005, 'signal_line': 207644.18726059794, 'BB_Upper': 84920439.0139484, 'BB_Lower': 84097360.9860516}
2024-09-20 02:06:54 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:06:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84508900.0         0         0
2024-09-20 02:06:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84508900.0         0         0
2024-09-20 02:06:54 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 02:06:54 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 02:06:54 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 02:06:54 - INFO - ARIMA prediction: 80899000.0
2024-09-20 02:06:54 - INFO - Attempting prediction for prophet
2024-09-20 02:06:54 - INFO - PROPHET prediction: 85067467.94606225
2024-09-20 02:06:54 - INFO - Attempting prediction for transformer
2024-09-20 02:06:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:06:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:06:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:06:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:06:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:06:54 - INFO - X 샘플:
[[-0.76042841 -1.0089721  -0.39267501 -1.12707036 -0.56137942 -0.56169494
  -1.12707036 -1.12707036  0.          0.          0.         -1.12707036
  -1.12707036]
 [-0.92421299 -0.42594947 -0.11568434 -0.21132569 -0.2665968  -0.26754409
  -0.21132569 -0.21132569  0.          0.          0.         -0.21132569
  -0.21132569]
 [ 0.2612754  -0.29562677 -0.36551906 -0.87465356 -0.59781582 -0.59746853
  -0.87465356 -0.87465356  0.          0.          0.         -0.87465356
  -0.87465356]
 [-1.18158876 -0.49454037 -0.40353739 -0.56353518 -0.36139232 -0.3622252
  -0.56353518 -0.56353518  0.          0.          0.         -0.56353518
  -0.56353518]
 [ 0.02729743 -0.50139946 -1.47891292 -0.71028913  0.04125507  0.03599153
  -0.71028913 -0.71028913  0.          0.          0.         -0.71028913
  -0.71028913]
 [-0.5108519  -0.89236757 -0.6588033  -0.48135297 -0.95947067 -0.95731871
  -0.48135297 -0.48135297  0.          0.          0.         -0.48135297
  -0.48135297]
 [-0.60444309 -0.28876768 -0.2894824   0.111533   -0.10423311 -0.10597135
   0.111533    0.111533    0.          0.          0.          0.111533
   0.111533  ]
 [ 0.56544676  0.15707315  0.18846228  0.20545553 -0.86289679 -0.86038172
   0.20545553  0.20545553  0.          0.          0.          0.20545553
   0.20545553]
 [ 0.76822767  1.50145474  1.20409473  1.5555919   2.42969223  2.42854394
   1.5555919   1.5555919   0.          0.          0.          1.5555919
   1.5555919 ]
 [ 2.35927788  2.24909551  2.3120574   2.09564645  1.24283764  1.24806907
   2.09564645  2.09564645  0.          0.          0.          2.09564645
   2.09564645]]
2024-09-20 02:06:54 - INFO - y 샘플:
[2.09564645]
2024-09-20 02:06:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:06:54 - INFO - 모델 출력 (스케일링된 예측): [0.4863874]
2024-09-20 02:06:54 - INFO - 스케일러 역변환 후 예측 가격: 84693857.63213754
2024-09-20 02:06:54 - INFO - TransformerPredictor 최종 예측 가격: 84693857.63213754
2024-09-20 02:06:54 - INFO - TRANSFORMER prediction: 84693857.63213754
2024-09-20 02:06:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:06:54 - INFO - BITCOIN_FORECAST prediction: 83359204.01008914
2024-09-20 02:06:54 - INFO - BitcoinForecast prediction: 83359204.01008914
2024-09-20 02:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:07:08 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:07:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004722292932929804, 'ml': 0.2114253725976655, 'xgboost': 0.07947916006917716, 'rl': 0.37692726354251055, 'lstm': 0.040502112391782794, 'arima': 0.0, 'prophet': 0.19411627356766112, 'transformer': 0.07441276048003774, 'bitcoin_forecast': 0.018414764418235287}
2024-09-20 02:07:08 - INFO - 조정된 모델 가중치: {'gpt': 0.004722292932929804, 'ml': 0.2114253725976655, 'xgboost': 0.07947916006917716, 'rl': 0.37692726354251055, 'lstm': 0.040502112391782794, 'arima': 0.0, 'prophet': 0.19411627356766112, 'transformer': 0.07441276048003774, 'bitcoin_forecast': 0.018414764418235287}
2024-09-20 02:07:08 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85247623.76892868, 'current_price': 84968000.0, 'predictions': {'gpt': 84968000.0, 'ml': 84968000.0, 'xgboost': 84968000.0, 'lstm': 84722905.47794788, 'rl': 85817680.0, 'arima': 80899000.0, 'prophet': 85067467.94606225, 'transformer': 84693857.63213754, 'bitcoin_forecast': 83359204.01008914}, 'weights': {'gpt': 0.004722292932929804, 'ml': 0.2114253725976655, 'xgboost': 0.07947916006917716, 'rl': 0.37692726354251055, 'lstm': 0.040502112391782794, 'arima': 0.0, 'prophet': 0.19411627356766112, 'transformer': 0.07441276048003774, 'bitcoin_forecast': 0.018414764418235287}}
2024-09-20 02:07:08 - INFO - 모델별 가중치:
2024-09-20 02:07:08 - INFO -   - GPT: 0.0047
2024-09-20 02:07:08 - INFO -   - ML: 0.2114
2024-09-20 02:07:08 - INFO -   - XGBOOST: 0.0795
2024-09-20 02:07:08 - INFO -   - RL: 0.3769
2024-09-20 02:07:08 - INFO -   - LSTM: 0.0405
2024-09-20 02:07:08 - INFO -   - ARIMA: 0.0000
2024-09-20 02:07:08 - INFO -   - PROPHET: 0.1941
2024-09-20 02:07:08 - INFO -   - TRANSFORMER: 0.0744
2024-09-20 02:07:08 - INFO -   - BITCOIN_FORECAST: 0.0184
2024-09-20 02:07:08 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:07:08 - INFO - 6. 거래 실행
2024-09-20 02:07:08 - INFO - Cancelling existing orders.
2024-09-20 02:07:08 - INFO - Cancelled 0 orders.
2024-09-20 02:07:08 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85247623.76892868, 'current_price': 84968000.0, 'predictions': {'gpt': 84968000.0, 'ml': 84968000.0, 'xgboost': 84968000.0, 'lstm': 84722905.47794788, 'rl': 85817680.0, 'arima': 80899000.0, 'prophet': 85067467.94606225, 'transformer': 84693857.63213754, 'bitcoin_forecast': 83359204.01008914}, 'weights': {'gpt': 0.004722292932929804, 'ml': 0.2114253725976655, 'xgboost': 0.07947916006917716, 'rl': 0.37692726354251055, 'lstm': 0.040502112391782794, 'arima': 0.0, 'prophet': 0.19411627356766112, 'transformer': 0.07441276048003774, 'bitcoin_forecast': 0.018414764418235287}}, 현재 가격=84968000.0
2024-09-20 02:07:09 - INFO - 현재 잔고: KRW=99932.56499315, BTC=0.00448312, 총 자산가치=480854.30515315
2024-09-20 02:07:09 - INFO - 매수 시도: 0.0005659240009805457 BTC (약 48085.430515315005 KRW)
2024-09-20 02:07:09 - INFO - 주문 결과: {'uuid': 'c7925c43-0764-469b-acce-fda33f9a3de7', 'side': 'bid', 'ord_type': 'limit', 'price': '84968000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T02:07:09+09:00', 'volume': '0.00056592', 'remaining_volume': '0.00056592', 'reserved_fee': '24.04254528', 'remaining_fee': '24.04254528', 'paid_fee': '0', 'locked': '48109.13310528', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 02:07:09 - INFO - buy 주문 성공: UUID=c7925c43-0764-469b-acce-fda33f9a3de7
2024-09-20 02:07:09 - INFO - Trade executed successfully.
2024-09-20 02:07:09 - INFO - 7. summary 리포트 보내기
2024-09-20 02:07:09 - INFO - Message sent to Discord successfully.
2024-09-20 02:07:09 - INFO - Trading cycle completed.
2024-09-20 02:07:09 - INFO - Performing periodic update.
2024-09-20 02:07:09 - INFO - 계산된 시장 변동성: 0.027910527484050093
2024-09-20 02:15:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:15:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-a41e-d94813bb4bed "HTTP/1.1 200 OK"
2024-09-20 02:15:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d6-b871-eb7672278ad7 "HTTP/1.1 200 OK"
2024-09-20 02:15:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a4-95c7-f520e81ab631 "HTTP/1.1 200 OK"
2024-09-20 02:16:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819a-8294-ee93dc6a4532 "HTTP/1.1 200 OK"
2024-09-20 02:16:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810a-acc0-c256864f5b31 "HTTP/1.1 200 OK"
2024-09-20 02:16:20 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-810a-a075-eae468fdf001 "HTTP/1.1 200 OK"
2024-09-20 02:16:27 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8172-a95c-f7b237ca4916 "HTTP/1.1 200 OK"
2024-09-20 02:16:33 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-b71a-d729adb65a48 "HTTP/1.1 200 OK"
2024-09-20 02:16:42 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:16:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a2bcd5ea-63ee-4f95-90d9-5df7e4b1124f "HTTP/1.1 200 OK"
2024-09-20 02:16:49 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:05:34.949725
2024-09-20 02:16:49 - INFO - Starting trading cycle.
2024-09-20 02:16:49 - INFO - ##################################################
2024-09-20 02:16:49 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-20 02:16:49 - INFO - ##################################################
2024-09-20 02:16:49 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:16:49 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:16:49 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:00:00
2024-09-20 02:16:49 - INFO - 새로운 데이터 범위: 2024-09-18 17:00:00 ~ 2024-09-20 02:10:00
2024-09-20 02:16:49 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:16:49 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:16:49 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:16:49 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:16:49 - INFO - Sample date values: [Timestamp('2024-09-20 02:10:00')]
2024-09-20 02:16:49 - INFO - Successfully added 1 new data points
2024-09-20 02:16:49 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:16:49 - INFO - Final date range: 2024-09-20 02:10:00 to 2024-09-20 02:10:00
2024-09-20 02:16:49 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:16:49 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:10:00
2024-09-20 02:16:49 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:16:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:16:49 - INFO - GPT | 이전예측가격: 84968000 | 당시BTC가격: 84968000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:16:49 - INFO - ML | 이전예측가격: 84968000 | 당시BTC가격: 84968000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:16:49 - INFO - XGBOOST | 이전예측가격: 84968000 | 당시BTC가격: 84968000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:16:49 - INFO - LSTM 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 9/16
2024-09-20 02:16:49 - INFO - LSTM | 이전예측가격: 84722905 | 당시BTC가격: 84968000 | 예측: 하락 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0769 | 반영가중치값: 0.0200 | 새 가중치: 0.0969 | 예측 총 횟수: 16 | 예측 성공 수: 9 | 예측 성공률: 56.25%
2024-09-20 02:16:49 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 38/57
2024-09-20 02:16:49 - INFO - RL | 이전예측가격: 85817680 | 당시BTC가격: 84968000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2545 | 반영가중치값: -0.0200 | 새 가중치: 0.2345 | 예측 총 횟수: 57 | 예측 성공 수: 38 | 예측 성공률: 66.67%
2024-09-20 02:16:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.60%, 적중/전체: 126/249
2024-09-20 02:16:49 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84968000 | 예측: 하락 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0404 | 반영가중치값: 0.0200 | 새 가중치: 0.0604 | 예측 총 횟수: 249 | 예측 성공 수: 126 | 예측 성공률: 50.60%
2024-09-20 02:16:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 66.04%, 적중/전체: 35/53
2024-09-20 02:16:49 - INFO - PROPHET | 이전예측가격: 85067468 | 당시BTC가격: 84968000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2416 | 반영가중치값: -0.0200 | 새 가중치: 0.2216 | 예측 총 횟수: 53 | 예측 성공 수: 35 | 예측 성공률: 66.04%
2024-09-20 02:16:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 9/16
2024-09-20 02:16:49 - INFO - TRANSFORMER | 이전예측가격: 84693858 | 당시BTC가격: 84968000 | 예측: 하락 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1074 | 반영가중치값: 0.0200 | 새 가중치: 0.1274 | 예측 총 횟수: 16 | 예측 성공 수: 9 | 예측 성공률: 56.25%
2024-09-20 02:16:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 35.29%, 적중/전체: 6/17
2024-09-20 02:16:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 83359204 | 당시BTC가격: 84968000 | 예측: 하락 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0067 | 반영가중치값: 0.0200 | 새 가중치: 0.0267 | 예측 총 횟수: 17 | 예측 성공 수: 6 | 예측 성공률: 35.29%
2024-09-20 02:16:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:16:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:16:49 - INFO - 새로운 가중치: {'gpt': 0.004442206892245581, 'ml': 0.1988854272041621, 'xgboost': 0.07476513584898287, 'rl': 0.2205693494554127, 'lstm': 0.09110756371073617, 'arima': 0.056787586963624855, 'prophet': 0.2084881276462435, 'transformer': 0.11980284499342975, 'bitcoin_forecast': 0.025151757285162418}
2024-09-20 02:16:49 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:16:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:16:49 - INFO - Current BTC price: 84686000.0
2024-09-20 02:16:49 - INFO - Analyzing market conditions.
2024-09-20 02:16:49 - INFO - Market analysis: {'current_price': 84686000.0, 'sma_20': 84534100.0, 'rsi_14': 58.41369692512837, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:16:49 - INFO - Starting predictions for all models
2024-09-20 02:16:49 - INFO - Attempting prediction for gpt
2024-09-20 02:16:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:16:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:16:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:16:49 - INFO - GPT prediction: 84686000.0
2024-09-20 02:16:49 - INFO - Attempting prediction for ml
2024-09-20 02:16:50 - INFO - ML prediction: 84838434.8
2024-09-20 02:16:50 - INFO - Attempting prediction for xgboost
2024-09-20 02:16:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:16:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:16:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:16:50 - INFO - XGBOOST prediction: 84686000.0
2024-09-20 02:16:50 - INFO - Attempting prediction for lstm
2024-09-20 02:16:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:16:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:16:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:16:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:16:50 - INFO - X 샘플:
[[-1.04527713 -0.65800551 -0.17192015 -0.39510295 -0.31955707 -0.32061808
  -0.39510295]
 [-0.04159978 -0.53197623 -0.42377769 -1.10717047 -0.65639081 -0.65614454
  -1.10717047]
 [-1.26318076 -0.72433672 -0.46210384 -0.7731919  -0.41595953 -0.41690685
  -0.7731919 ]
 [-0.239694   -0.73096984 -1.54618632 -0.93072896 -0.00648659 -0.01192852
  -0.93072896]
 [-0.69531069 -1.10905768 -0.71943655 -0.68497114 -1.02417632 -1.02210486
  -0.68497114]
 [-0.77454837 -0.52534311 -0.3471254  -0.04852141 -0.15444103 -0.15630189
  -0.04852141]
 [ 0.21592269 -0.09419031  0.13468903  0.0523023  -0.92596535 -0.92352192
   0.0523023 ]
 [ 0.38760434  1.20590123  1.15854471  1.50164327  2.42243863  2.42124867
   1.50164327]
 [ 1.73464499  1.92891133  2.27547817  2.08137966  1.21546485  1.22072971
   2.08137966]
 [ 1.72143871  1.23906684  0.10183805  0.3043616  -0.13492678 -0.13445172
   0.3043616 ]]
2024-09-20 02:16:50 - INFO - y 샘플:
[0.3043616]
2024-09-20 02:16:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:16:50 - INFO - 모델 출력 (스케일링된 예측): [[0.5444456]]
2024-09-20 02:16:50 - INFO - 스케일러 역변환 후 예측 가격: 84724099.6015991
2024-09-20 02:16:50 - INFO - LSTMPredictor 최종 예측 가격: 84724099.6015991
2024-09-20 02:16:50 - INFO - LSTM prediction: 84724099.6015991
2024-09-20 02:16:50 - INFO - Attempting prediction for rl
2024-09-20 02:16:50 - INFO - Preparing state for RL agent.
2024-09-20 02:16:50 - INFO - Prepared state: [[ 8.46860000e+07  1.71323950e+01 -3.31889653e-03  8.45341000e+07
   5.84136969e+01]]
2024-09-20 02:16:50 - INFO - RL prediction: 85532860.0
2024-09-20 02:16:50 - INFO - Attempting prediction for arima
2024-09-20 02:16:50 - INFO - ARIMA 예측 시작
2024-09-20 02:16:50 - INFO - 입력 데이터: {'open': 84896000.0, 'high': 84896000.0, 'low': 84501000.0, 'close': 84686000.0, 'volume': 17.13239502, 'value': 1450819558.18724, 'decision': 'sell', 'sma': 84534100.0, 'ema': 84509730.9659395, 'rsi': 58.41369692512837, 'macd': 210538.2060213089, 'signal_line': 208222.99101274015, 'BB_Upper': 84923618.1125417, 'BB_Lower': 84144581.8874583}
2024-09-20 02:16:50 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:16:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84534100.0         0         0
2024-09-20 02:16:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84534100.0         0         0
2024-09-20 02:16:50 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 02:16:50 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 02:16:50 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 02:16:50 - INFO - ARIMA prediction: 80899000.0
2024-09-20 02:16:50 - INFO - Attempting prediction for prophet
2024-09-20 02:16:50 - INFO - PROPHET prediction: 84716118.19479509
2024-09-20 02:16:50 - INFO - Attempting prediction for transformer
2024-09-20 02:16:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:16:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:16:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:16:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:16:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:16:50 - INFO - X 샘플:
[[-1.04527713 -0.65800551 -0.17192015 -0.39510295 -0.31955707 -0.32061808
  -0.39510295 -0.39510295  0.          0.          0.         -0.39510295
  -0.39510295]
 [-0.04159978 -0.53197623 -0.42377769 -1.10717047 -0.65639081 -0.65614454
  -1.10717047 -1.10717047  0.          0.          0.         -1.10717047
  -1.10717047]
 [-1.26318076 -0.72433672 -0.46210384 -0.7731919  -0.41595953 -0.41690685
  -0.7731919  -0.7731919   0.          0.          0.         -0.7731919
  -0.7731919 ]
 [-0.239694   -0.73096984 -1.54618632 -0.93072896 -0.00648659 -0.01192852
  -0.93072896 -0.93072896  0.          0.          0.         -0.93072896
  -0.93072896]
 [-0.69531069 -1.10905768 -0.71943655 -0.68497114 -1.02417632 -1.02210486
  -0.68497114 -0.68497114  0.          0.          0.         -0.68497114
  -0.68497114]
 [-0.77454837 -0.52534311 -0.3471254  -0.04852141 -0.15444103 -0.15630189
  -0.04852141 -0.04852141  0.          0.          0.         -0.04852141
  -0.04852141]
 [ 0.21592269 -0.09419031  0.13468903  0.0523023  -0.92596535 -0.92352192
   0.0523023   0.0523023   0.          0.          0.          0.0523023
   0.0523023 ]
 [ 0.38760434  1.20590123  1.15854471  1.50164327  2.42243863  2.42124867
   1.50164327  1.50164327  0.          0.          0.          1.50164327
   1.50164327]
 [ 1.73464499  1.92891133  2.27547817  2.08137966  1.21546485  1.22072971
   2.08137966  2.08137966  0.          0.          0.          2.08137966
   2.08137966]
 [ 1.72143871  1.23906684  0.10183805  0.3043616  -0.13492678 -0.13445172
   0.3043616   0.3043616   0.          0.          0.          0.3043616
   0.3043616 ]]
2024-09-20 02:16:50 - INFO - y 샘플:
[0.3043616]
2024-09-20 02:16:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:16:50 - INFO - 모델 출력 (스케일링된 예측): [0.48441502]
2024-09-20 02:16:50 - INFO - 스케일러 역변환 후 예측 가격: 84714573.18458255
2024-09-20 02:16:50 - INFO - TransformerPredictor 최종 예측 가격: 84714573.18458255
2024-09-20 02:16:50 - INFO - TRANSFORMER prediction: 84714573.18458255
2024-09-20 02:16:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:16:50 - INFO - BITCOIN_FORECAST prediction: 83323540.7065772
2024-09-20 02:16:50 - INFO - BitcoinForecast prediction: 83323540.7065772
2024-09-20 02:16:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:16:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:17:05 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:17:05 - INFO - 조정된 모델 가중치: {'gpt': 0.004442206892245581, 'ml': 0.1988854272041621, 'xgboost': 0.07476513584898287, 'rl': 0.2205693494554127, 'lstm': 0.09110756371073617, 'arima': 0.056787586963624855, 'prophet': 0.2084881276462435, 'transformer': 0.11980284499342975, 'bitcoin_forecast': 0.025151757285162418}
2024-09-20 02:17:05 - INFO - 조정된 모델 가중치: {'gpt': 0.004442206892245581, 'ml': 0.1988854272041621, 'xgboost': 0.07476513584898287, 'rl': 0.2205693494554127, 'lstm': 0.09110756371073617, 'arima': 0.056787586963624855, 'prophet': 0.2084881276462435, 'transformer': 0.11980284499342975, 'bitcoin_forecast': 0.025151757285162418}
2024-09-20 02:17:05 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84666959.17903273, 'current_price': 84686000.0, 'predictions': {'gpt': 84686000.0, 'ml': 84838434.8, 'xgboost': 84686000.0, 'lstm': 84724099.6015991, 'rl': 85532860.0, 'arima': 80899000.0, 'prophet': 84716118.19479509, 'transformer': 84714573.18458255, 'bitcoin_forecast': 83323540.7065772}, 'weights': {'gpt': 0.004442206892245581, 'ml': 0.1988854272041621, 'xgboost': 0.07476513584898287, 'rl': 0.2205693494554127, 'lstm': 0.09110756371073617, 'arima': 0.056787586963624855, 'prophet': 0.2084881276462435, 'transformer': 0.11980284499342975, 'bitcoin_forecast': 0.025151757285162418}}
2024-09-20 02:17:05 - INFO - 모델별 가중치:
2024-09-20 02:17:05 - INFO -   - GPT: 0.0044
2024-09-20 02:17:05 - INFO -   - ML: 0.1989
2024-09-20 02:17:05 - INFO -   - XGBOOST: 0.0748
2024-09-20 02:17:05 - INFO -   - RL: 0.2206
2024-09-20 02:17:05 - INFO -   - LSTM: 0.0911
2024-09-20 02:17:05 - INFO -   - ARIMA: 0.0568
2024-09-20 02:17:05 - INFO -   - PROPHET: 0.2085
2024-09-20 02:17:05 - INFO -   - TRANSFORMER: 0.1198
2024-09-20 02:17:05 - INFO -   - BITCOIN_FORECAST: 0.0252
2024-09-20 02:17:05 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:17:05 - INFO - 6. 거래 실행
2024-09-20 02:17:05 - INFO - Cancelling existing orders.
2024-09-20 02:17:05 - INFO - Cancelled 0 orders.
2024-09-20 02:17:05 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84666959.17903273, 'current_price': 84686000.0, 'predictions': {'gpt': 84686000.0, 'ml': 84838434.8, 'xgboost': 84686000.0, 'lstm': 84724099.6015991, 'rl': 85532860.0, 'arima': 80899000.0, 'prophet': 84716118.19479509, 'transformer': 84714573.18458255, 'bitcoin_forecast': 83323540.7065772}, 'weights': {'gpt': 0.004442206892245581, 'ml': 0.1988854272041621, 'xgboost': 0.07476513584898287, 'rl': 0.2205693494554127, 'lstm': 0.09110756371073617, 'arima': 0.056787586963624855, 'prophet': 0.2084881276462435, 'transformer': 0.11980284499342975, 'bitcoin_forecast': 0.025151757285162418}}, 현재 가격=84686000.0
2024-09-20 02:17:05 - INFO - 현재 잔고: KRW=51847.21241219, BTC=0.00504904, 총 자산가치=479430.21385219
2024-09-20 02:17:05 - INFO - 매도 시도: 0.0005049040000000001 BTC (약 42758.300144000015 KRW)
2024-09-20 02:17:06 - INFO - 주문 결과: {'uuid': 'c831fc88-73cf-44a3-a459-ff53697a2fd0', 'side': 'ask', 'ord_type': 'limit', 'price': '84686000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T02:17:06+09:00', 'volume': '0.0005049', 'remaining_volume': '0.0005049', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0005049', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 02:17:06 - INFO - sell 주문 성공: UUID=c831fc88-73cf-44a3-a459-ff53697a2fd0
2024-09-20 02:17:06 - INFO - Trade executed successfully.
2024-09-20 02:17:06 - INFO - 7. summary 리포트 보내기
2024-09-20 02:17:06 - INFO - Message sent to Discord successfully.
2024-09-20 02:17:06 - INFO - Trading cycle completed.
2024-09-20 02:17:06 - INFO - Performing periodic update.
2024-09-20 02:17:06 - INFO - 계산된 시장 변동성: 0.028474015888837342
2024-09-20 02:25:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:25:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8196-bdfb-fc12179b46b6 "HTTP/1.1 200 OK"
2024-09-20 02:25:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-8a37-fd327d489565 "HTTP/1.1 200 OK"
2024-09-20 02:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:25:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d42deb81-597a-48ba-8ae8-34a831caf590 "HTTP/1.1 200 OK"
2024-09-20 02:25:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-8656-da1ebf513b11 "HTTP/1.1 200 OK"
2024-09-20 02:26:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8181-8e30-f8ffed3f0dcb "HTTP/1.1 200 OK"
2024-09-20 02:26:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dc-91e5-e8ae7942b054 "HTTP/1.1 200 OK"
2024-09-20 02:26:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8106-b8ad-d6d1cd141141 "HTTP/1.1 200 OK"
2024-09-20 02:26:29 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bb-b30e-e3fd415dd98e "HTTP/1.1 200 OK"
2024-09-20 02:26:36 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:26:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-9a84-d6bbdf4f0c6e "HTTP/1.1 200 OK"
2024-09-20 02:26:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:15:34.949975
2024-09-20 02:26:43 - INFO - Starting trading cycle.
2024-09-20 02:26:43 - INFO - ##################################################
2024-09-20 02:26:43 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-20 02:26:43 - INFO - ##################################################
2024-09-20 02:26:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:26:43 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:26:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:10:00
2024-09-20 02:26:43 - INFO - 새로운 데이터 범위: 2024-09-18 17:10:00 ~ 2024-09-20 02:20:00
2024-09-20 02:26:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:26:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:26:43 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:26:43 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:26:43 - INFO - Sample date values: [Timestamp('2024-09-20 02:20:00')]
2024-09-20 02:26:43 - INFO - Successfully added 1 new data points
2024-09-20 02:26:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:26:43 - INFO - Final date range: 2024-09-20 02:20:00 to 2024-09-20 02:20:00
2024-09-20 02:26:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:26:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:20:00
2024-09-20 02:26:43 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:26:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:26:43 - INFO - GPT | 이전예측가격: 84686000 | 당시BTC가격: 84686000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:26:43 - INFO - ML 모델 예측 업데이트: 정확도 48.08%, 적중/전체: 25/52
2024-09-20 02:26:43 - INFO - ML | 이전예측가격: 84838435 | 당시BTC가격: 84686000 | 예측: 상승 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2114 | 반영가중치값: -0.0200 | 새 가중치: 0.1914 | 예측 총 횟수: 52 | 예측 성공 수: 25 | 예측 성공률: 48.08%
2024-09-20 02:26:43 - INFO - XGBOOST | 이전예측가격: 84686000 | 당시BTC가격: 84686000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:26:43 - INFO - LSTM 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 9/17
2024-09-20 02:26:43 - INFO - LSTM | 이전예측가격: 84724100 | 당시BTC가격: 84686000 | 예측: 상승 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0405 | 반영가중치값: -0.0200 | 새 가중치: 0.0205 | 예측 총 횟수: 17 | 예측 성공 수: 9 | 예측 성공률: 52.94%
2024-09-20 02:26:43 - INFO - RL 모델 예측 업데이트: 정확도 65.52%, 적중/전체: 38/58
2024-09-20 02:26:44 - INFO - RL | 이전예측가격: 85532860 | 당시BTC가격: 84686000 | 예측: 상승 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3769 | 반영가중치값: -0.0200 | 새 가중치: 0.3569 | 예측 총 횟수: 58 | 예측 성공 수: 38 | 예측 성공률: 65.52%
2024-09-20 02:26:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.80%, 적중/전체: 127/250
2024-09-20 02:26:44 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84686000 | 예측: 하락 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 250 | 예측 성공 수: 127 | 예측 성공률: 50.80%
2024-09-20 02:26:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.81%, 적중/전체: 35/54
2024-09-20 02:26:44 - INFO - PROPHET | 이전예측가격: 84716118 | 당시BTC가격: 84686000 | 예측: 상승 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1941 | 반영가중치값: -0.0200 | 새 가중치: 0.1741 | 예측 총 횟수: 54 | 예측 성공 수: 35 | 예측 성공률: 64.81%
2024-09-20 02:26:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 9/17
2024-09-20 02:26:44 - INFO - TRANSFORMER | 이전예측가격: 84714573 | 당시BTC가격: 84686000 | 예측: 상승 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0744 | 반영가중치값: -0.0200 | 새 가중치: 0.0544 | 예측 총 횟수: 17 | 예측 성공 수: 9 | 예측 성공률: 52.94%
2024-09-20 02:26:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 38.89%, 적중/전체: 7/18
2024-09-20 02:26:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83323541 | 당시BTC가격: 84686000 | 예측: 하락 | 지금 BTC가격: 84570000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0184 | 반영가중치값: 0.0200 | 새 가중치: 0.0384 | 예측 총 횟수: 18 | 예측 성공 수: 7 | 예측 성공률: 38.89%
2024-09-20 02:26:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:26:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:26:44 - INFO - 새로운 가중치: {'gpt': 0.004750993486773664, 'ml': 0.20473172917774413, 'xgboost': 0.07996220844110756, 'rl': 0.38173798417686733, 'lstm': 0.021927254808526548, 'arima': 0.0213902395904482, 'prophet': 0.18621944041041472, 'transformer': 0.058195099172283916, 'bitcoin_forecast': 0.04108505073583386}
2024-09-20 02:26:44 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:26:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:26:44 - INFO - Current BTC price: 84570000.0
2024-09-20 02:26:44 - INFO - Analyzing market conditions.
2024-09-20 02:26:44 - INFO - Market analysis: {'current_price': 84570000.0, 'sma_20': 84539100.0, 'rsi_14': 54.650370626482584, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:26:44 - INFO - Starting predictions for all models
2024-09-20 02:26:44 - INFO - Attempting prediction for gpt
2024-09-20 02:26:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:26:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:26:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:26:44 - INFO - GPT prediction: 84570000.0
2024-09-20 02:26:44 - INFO - Attempting prediction for ml
2024-09-20 02:26:44 - INFO - ML prediction: 84603828.0
2024-09-20 02:26:44 - INFO - Attempting prediction for xgboost
2024-09-20 02:26:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:26:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:26:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:26:44 - INFO - XGBOOST prediction: 84570000.0
2024-09-20 02:26:44 - INFO - Attempting prediction for lstm
2024-09-20 02:26:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:26:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:26:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:26:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:26:44 - INFO - X 샘플:
[[-0.20048373 -0.66521619 -0.45647289 -1.1025988  -0.61385237 -0.61393467
  -1.1025988 ]
 [-1.49731904 -0.85988087 -0.49483196 -0.76905008 -0.3770642  -0.37829397
  -0.76905008]
 [-0.41078135 -0.86659344 -1.57984557 -0.92638438  0.02620425  0.02059545
  -0.92638438]
 [-0.89446587 -1.24921022 -0.7523857  -0.68094287 -0.97606505 -0.97439272
  -0.68094287]
 [-0.97858491 -0.65850361 -0.37975476 -0.04531228 -0.11950833 -0.12160724
  -0.04531228]
 [ 0.07290317 -0.22218623  0.10247351  0.05538167 -0.8793422  -0.87729199
   0.05538167]
 [ 0.25516111  1.09347848  1.12720858  1.50285727  2.41832543  2.41718942
   1.50285727]
 [ 1.68518491  1.82514916  2.24510138  2.0818475   1.22964019  1.23472045
   2.0818475 ]
 [ 1.67116507  1.12704135  0.06959431  0.30711656 -0.10028977 -0.10008559
   0.30711656]
 [ 0.29722063  0.47592157  0.11891311 -0.42291461 -0.60804796 -0.60689914
  -0.42291461]]
2024-09-20 02:26:44 - INFO - y 샘플:
[-0.42291461]
2024-09-20 02:26:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:26:44 - INFO - 모델 출력 (스케일링된 예측): [[0.39552882]]
2024-09-20 02:26:44 - INFO - 스케일러 역변환 후 예측 가격: 84700048.47209114
2024-09-20 02:26:44 - INFO - LSTMPredictor 최종 예측 가격: 84700048.47209114
2024-09-20 02:26:44 - INFO - LSTM prediction: 84700048.47209114
2024-09-20 02:26:44 - INFO - Attempting prediction for rl
2024-09-20 02:26:44 - INFO - Preparing state for RL agent.
2024-09-20 02:26:44 - INFO - Prepared state: [[ 8.45700000e+07  1.07698307e+01 -1.36976596e-03  8.45391000e+07
   5.46503706e+01]]
2024-09-20 02:26:44 - INFO - RL prediction: 85415700.0
2024-09-20 02:26:44 - INFO - Attempting prediction for arima
2024-09-20 02:26:44 - INFO - ARIMA 예측 시작
2024-09-20 02:26:44 - INFO - 입력 데이터: {'open': 84700000.0, 'high': 84799000.0, 'low': 84510000.0, 'close': 84570000.0, 'volume': 10.76983074, 'value': 911340906.43405, 'decision': 'sell', 'sma': 84539100.0, 'ema': 84515470.87394527, 'rsi': 54.650370626482584, 'macd': 190280.1873358339, 'signal_line': 204634.43027735892, 'BB_Upper': 84927764.8427605, 'BB_Lower': 84150435.1572395}
2024-09-20 02:26:44 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:26:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84539100.0         0         0
2024-09-20 02:26:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84539100.0         0         0
2024-09-20 02:26:44 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 02:26:44 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 02:26:44 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 02:26:44 - INFO - ARIMA prediction: 80899000.0
2024-09-20 02:26:44 - INFO - Attempting prediction for prophet
2024-09-20 02:26:44 - INFO - PROPHET prediction: 84575696.21847151
2024-09-20 02:26:44 - INFO - Attempting prediction for transformer
2024-09-20 02:26:44 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:26:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:26:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:26:44 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:26:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:26:44 - INFO - X 샘플:
[[-0.20048373 -0.66521619 -0.45647289 -1.1025988  -0.61385237 -0.61393467
  -1.1025988  -1.1025988   0.          0.          0.         -1.1025988
  -1.1025988 ]
 [-1.49731904 -0.85988087 -0.49483196 -0.76905008 -0.3770642  -0.37829397
  -0.76905008 -0.76905008  0.          0.          0.         -0.76905008
  -0.76905008]
 [-0.41078135 -0.86659344 -1.57984557 -0.92638438  0.02620425  0.02059545
  -0.92638438 -0.92638438  0.          0.          0.         -0.92638438
  -0.92638438]
 [-0.89446587 -1.24921022 -0.7523857  -0.68094287 -0.97606505 -0.97439272
  -0.68094287 -0.68094287  0.          0.          0.         -0.68094287
  -0.68094287]
 [-0.97858491 -0.65850361 -0.37975476 -0.04531228 -0.11950833 -0.12160724
  -0.04531228 -0.04531228  0.          0.          0.         -0.04531228
  -0.04531228]
 [ 0.07290317 -0.22218623  0.10247351  0.05538167 -0.8793422  -0.87729199
   0.05538167  0.05538167  0.          0.          0.          0.05538167
   0.05538167]
 [ 0.25516111  1.09347848  1.12720858  1.50285727  2.41832543  2.41718942
   1.50285727  1.50285727  0.          0.          0.          1.50285727
   1.50285727]
 [ 1.68518491  1.82514916  2.24510138  2.0818475   1.22964019  1.23472045
   2.0818475   2.0818475   0.          0.          0.          2.0818475
   2.0818475 ]
 [ 1.67116507  1.12704135  0.06959431  0.30711656 -0.10028977 -0.10008559
   0.30711656  0.30711656  0.          0.          0.          0.30711656
   0.30711656]
 [ 0.29722063  0.47592157  0.11891311 -0.42291461 -0.60804796 -0.60689914
  -0.42291461 -0.42291461  0.          0.          0.         -0.42291461
  -0.42291461]]
2024-09-20 02:26:44 - INFO - y 샘플:
[-0.42291461]
2024-09-20 02:26:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:26:44 - INFO - 모델 출력 (스케일링된 예측): [0.4849293]
2024-09-20 02:26:44 - INFO - 스케일러 역변환 후 예측 가격: 84714253.96769902
2024-09-20 02:26:44 - INFO - TransformerPredictor 최종 예측 가격: 84714253.96769902
2024-09-20 02:26:44 - INFO - TRANSFORMER prediction: 84714253.96769902
2024-09-20 02:26:44 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:26:44 - INFO - BITCOIN_FORECAST prediction: 83320084.65712544
2024-09-20 02:26:44 - INFO - BitcoinForecast prediction: 83320084.65712544
2024-09-20 02:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:26:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:26:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004750993486773664, 'ml': 0.20473172917774413, 'xgboost': 0.07996220844110756, 'rl': 0.38173798417686733, 'lstm': 0.021927254808526548, 'arima': 0.0213902395904482, 'prophet': 0.18621944041041472, 'transformer': 0.058195099172283916, 'bitcoin_forecast': 0.04108505073583386}
2024-09-20 02:26:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004750993486773664, 'ml': 0.20473172917774413, 'xgboost': 0.07996220844110756, 'rl': 0.38173798417686733, 'lstm': 0.021927254808526548, 'arima': 0.0213902395904482, 'prophet': 0.18621944041041472, 'transformer': 0.058195099172283916, 'bitcoin_forecast': 0.04108505073583386}
2024-09-20 02:26:51 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84782192.29989643, 'current_price': 84570000.0, 'predictions': {'gpt': 84570000.0, 'ml': 84603828.0, 'xgboost': 84570000.0, 'lstm': 84700048.47209114, 'rl': 85415700.0, 'arima': 80899000.0, 'prophet': 84575696.21847151, 'transformer': 84714253.96769902, 'bitcoin_forecast': 83320084.65712544}, 'weights': {'gpt': 0.004750993486773664, 'ml': 0.20473172917774413, 'xgboost': 0.07996220844110756, 'rl': 0.38173798417686733, 'lstm': 0.021927254808526548, 'arima': 0.0213902395904482, 'prophet': 0.18621944041041472, 'transformer': 0.058195099172283916, 'bitcoin_forecast': 0.04108505073583386}}
2024-09-20 02:26:51 - INFO - 모델별 가중치:
2024-09-20 02:26:51 - INFO -   - GPT: 0.0048
2024-09-20 02:26:51 - INFO -   - ML: 0.2047
2024-09-20 02:26:51 - INFO -   - XGBOOST: 0.0800
2024-09-20 02:26:51 - INFO -   - RL: 0.3817
2024-09-20 02:26:51 - INFO -   - LSTM: 0.0219
2024-09-20 02:26:51 - INFO -   - ARIMA: 0.0214
2024-09-20 02:26:51 - INFO -   - PROPHET: 0.1862
2024-09-20 02:26:51 - INFO -   - TRANSFORMER: 0.0582
2024-09-20 02:26:51 - INFO -   - BITCOIN_FORECAST: 0.0411
2024-09-20 02:26:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:26:51 - INFO - 6. 거래 실행
2024-09-20 02:26:51 - INFO - Cancelling existing orders.
2024-09-20 02:26:51 - INFO - Cancelled 0 orders.
2024-09-20 02:26:51 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84782192.29989643, 'current_price': 84570000.0, 'predictions': {'gpt': 84570000.0, 'ml': 84603828.0, 'xgboost': 84570000.0, 'lstm': 84700048.47209114, 'rl': 85415700.0, 'arima': 80899000.0, 'prophet': 84575696.21847151, 'transformer': 84714253.96769902, 'bitcoin_forecast': 83320084.65712544}, 'weights': {'gpt': 0.004750993486773664, 'ml': 0.20473172917774413, 'xgboost': 0.07996220844110756, 'rl': 0.38173798417686733, 'lstm': 0.021927254808526548, 'arima': 0.0213902395904482, 'prophet': 0.18621944041041472, 'transformer': 0.058195099172283916, 'bitcoin_forecast': 0.04108505073583386}}, 현재 가격=84570000.0
2024-09-20 02:26:51 - INFO - 현재 잔고: KRW=94583.79483149, BTC=0.00454414, 총 자산가치=478881.71463149006
2024-09-20 02:26:51 - INFO - 매수 시도: 0.0005662548357945963 BTC (약 47888.171463149 KRW)
2024-09-20 02:26:52 - INFO - 주문 결과: {'uuid': '86ed8a46-96bf-4196-82e3-3e69258ce94b', 'side': 'bid', 'ord_type': 'limit', 'price': '84570000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T02:26:52+09:00', 'volume': '0.00056625', 'remaining_volume': '0.00056625', 'reserved_fee': '23.94388125', 'remaining_fee': '23.94388125', 'paid_fee': '0', 'locked': '47911.70638125', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 02:26:52 - INFO - buy 주문 성공: UUID=86ed8a46-96bf-4196-82e3-3e69258ce94b
2024-09-20 02:26:52 - INFO - Trade executed successfully.
2024-09-20 02:26:52 - INFO - 7. summary 리포트 보내기
2024-09-20 02:26:52 - INFO - Message sent to Discord successfully.
2024-09-20 02:26:52 - INFO - Trading cycle completed.
2024-09-20 02:26:52 - INFO - Performing periodic update.
2024-09-20 02:26:52 - INFO - 계산된 시장 변동성: 0.027943887937925217
2024-09-20 02:35:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:35:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811a-9a0b-f9c62d43c83e "HTTP/1.1 200 OK"
2024-09-20 02:35:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:35:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:35:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c9-b7e2-f1f00d3be803 "HTTP/1.1 200 OK"
2024-09-20 02:35:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:35:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816e-a2f4-dca4ee06c5ba "HTTP/1.1 200 OK"
2024-09-20 02:36:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7b213bf4-bc27-4935-b64a-4d459ee12ffa "HTTP/1.1 200 OK"
2024-09-20 02:36:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818a-9cac-e292622f4063 "HTTP/1.1 200 OK"
2024-09-20 02:36:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/34c84a7e-6a57-4e0d-8c96-41e017c0f615 "HTTP/1.1 200 OK"
2024-09-20 02:36:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-abc0-d8a5821aafbe "HTTP/1.1 200 OK"
2024-09-20 02:36:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bb-b3f4-eb4614b61fb3 "HTTP/1.1 200 OK"
2024-09-20 02:36:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-8d30-c4a5fa779bb3 "HTTP/1.1 200 OK"
2024-09-20 02:36:35 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:25:34.950384
2024-09-20 02:36:35 - INFO - Starting trading cycle.
2024-09-20 02:36:35 - INFO - ##################################################
2024-09-20 02:36:35 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-20 02:36:35 - INFO - ##################################################
2024-09-20 02:36:35 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:36:35 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:36:35 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:20:00
2024-09-20 02:36:35 - INFO - 새로운 데이터 범위: 2024-09-18 17:20:00 ~ 2024-09-20 02:30:00
2024-09-20 02:36:35 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:36:35 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:36:35 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:36:35 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:36:35 - INFO - Sample date values: [Timestamp('2024-09-20 02:30:00')]
2024-09-20 02:36:35 - INFO - Successfully added 1 new data points
2024-09-20 02:36:35 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:36:35 - INFO - Final date range: 2024-09-20 02:30:00 to 2024-09-20 02:30:00
2024-09-20 02:36:35 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:36:35 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:30:00
2024-09-20 02:36:35 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:36:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:36:35 - INFO - GPT | 이전예측가격: 84570000 | 당시BTC가격: 84570000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:36:35 - INFO - ML 모델 예측 업데이트: 정확도 49.06%, 적중/전체: 26/53
2024-09-20 02:36:35 - INFO - ML | 이전예측가격: 84603828 | 당시BTC가격: 84570000 | 예측: 상승 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1989 | 반영가중치값: 0.0200 | 새 가중치: 0.2189 | 예측 총 횟수: 53 | 예측 성공 수: 26 | 예측 성공률: 49.06%
2024-09-20 02:36:35 - INFO - XGBOOST | 이전예측가격: 84570000 | 당시BTC가격: 84570000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:36:35 - INFO - LSTM 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 10/18
2024-09-20 02:36:35 - INFO - LSTM | 이전예측가격: 84700048 | 당시BTC가격: 84570000 | 예측: 상승 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0911 | 반영가중치값: 0.0200 | 새 가중치: 0.1111 | 예측 총 횟수: 18 | 예측 성공 수: 10 | 예측 성공률: 55.56%
2024-09-20 02:36:35 - INFO - RL 모델 예측 업데이트: 정확도 66.10%, 적중/전체: 39/59
2024-09-20 02:36:35 - INFO - RL | 이전예측가격: 85415700 | 당시BTC가격: 84570000 | 예측: 상승 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2206 | 반영가중치값: 0.0200 | 새 가중치: 0.2406 | 예측 총 횟수: 59 | 예측 성공 수: 39 | 예측 성공률: 66.10%
2024-09-20 02:36:35 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.60%, 적중/전체: 127/251
2024-09-20 02:36:35 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84570000 | 예측: 하락 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0568 | 반영가중치값: -0.0200 | 새 가중치: 0.0368 | 예측 총 횟수: 251 | 예측 성공 수: 127 | 예측 성공률: 50.60%
2024-09-20 02:36:35 - INFO - PROPHET | 이전예측가격: 84575696 | 당시BTC가격: 84570000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:36:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 10/18
2024-09-20 02:36:36 - INFO - TRANSFORMER | 이전예측가격: 84714254 | 당시BTC가격: 84570000 | 예측: 상승 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1198 | 반영가중치값: 0.0200 | 새 가중치: 0.1398 | 예측 총 횟수: 18 | 예측 성공 수: 10 | 예측 성공률: 55.56%
2024-09-20 02:36:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 36.84%, 적중/전체: 7/19
2024-09-20 02:36:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83320085 | 당시BTC가격: 84570000 | 예측: 하락 | 지금 BTC가격: 84858000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0252 | 반영가중치값: -0.0200 | 새 가중치: 0.0052 | 예측 총 횟수: 19 | 예측 성공 수: 7 | 예측 성공률: 36.84%
2024-09-20 02:36:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:36:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:36:36 - INFO - 새로운 가중치: {'gpt': 0.004643100951576839, 'ml': 0.21391465556988343, 'xgboost': 0.078146309216521, 'rl': 0.2351061474797304, 'lstm': 0.10858437003310502, 'arima': 0.03595216042971594, 'prophet': 0.1819904959623225, 'transformer': 0.13662799673988835, 'bitcoin_forecast': 0.005034763617256476}
2024-09-20 02:36:36 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:36:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:36:36 - INFO - Current BTC price: 84858000.0
2024-09-20 02:36:36 - INFO - Analyzing market conditions.
2024-09-20 02:36:36 - INFO - Market analysis: {'current_price': 84858000.0, 'sma_20': 84555050.0, 'rsi_14': 61.314253378767006, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:36:36 - INFO - Starting predictions for all models
2024-09-20 02:36:36 - INFO - Attempting prediction for gpt
2024-09-20 02:36:36 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:36:36 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:36:36 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:36:36 - INFO - GPT prediction: 84858000.0
2024-09-20 02:36:36 - INFO - Attempting prediction for ml
2024-09-20 02:36:36 - INFO - ML prediction: 84908914.8
2024-09-20 02:36:36 - INFO - Attempting prediction for xgboost
2024-09-20 02:36:36 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:36:36 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:36:36 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:36:36 - INFO - XGBOOST prediction: 84858000.0
2024-09-20 02:36:36 - INFO - Attempting prediction for lstm
2024-09-20 02:36:36 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:36:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:36:36 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:36:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:36:36 - INFO - X 샘플:
[[-1.44901494 -1.00949272 -0.57838763 -1.01350995 -0.33575551 -0.33734752
  -1.01350995]
 [-0.37438664 -1.0161781  -1.67218659 -1.17010914  0.05774419  0.05198268
  -1.17010914]
 [-0.85276956 -1.39724488 -0.83802678 -0.92581441 -0.9202462  -0.91916103
  -0.92581441]
 [-0.93596659 -0.80893125 -0.46237865 -0.29315368 -0.08443866 -0.08681218
  -0.29315368]
 [ 0.10399629 -0.3743814   0.02375422 -0.1929302  -0.82586636 -0.82438727
  -0.1929302 ]
 [ 0.28425652  0.93595351  1.05678657  1.24778234  2.39191877  2.39114334
   1.24778234]
 [ 1.69860603  1.66466017  2.18373095  1.82406736  1.23202817  1.23701172
   1.82406736]
 [ 1.68473986  0.96938042 -0.0093912   0.0576285  -0.06568565 -0.06580628
   0.0576285 ]
 [ 0.32585503  0.32089835  0.04032693 -0.66899174 -0.56114393 -0.56047427
  -0.66899174]
 [-0.48531601  0.7153359   0.25577218  1.13503093 -0.88855483 -0.88614919
   1.13503093]]
2024-09-20 02:36:36 - INFO - y 샘플:
[1.13503093]
2024-09-20 02:36:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:36:36 - INFO - 모델 출력 (스케일링된 예측): [[0.3317194]]
2024-09-20 02:36:36 - INFO - 스케일러 역변환 후 예측 가격: 84729756.75531067
2024-09-20 02:36:36 - INFO - LSTMPredictor 최종 예측 가격: 84729756.75531067
2024-09-20 02:36:36 - INFO - LSTM prediction: 84729756.75531067
2024-09-20 02:36:36 - INFO - Attempting prediction for rl
2024-09-20 02:36:36 - INFO - Preparing state for RL agent.
2024-09-20 02:36:36 - INFO - Prepared state: [[8.48580000e+07 6.56529340e+00 3.40546293e-03 8.45550500e+07
  6.13142534e+01]]
2024-09-20 02:36:36 - INFO - RL prediction: 85706580.0
2024-09-20 02:36:36 - INFO - Attempting prediction for arima
2024-09-20 02:36:36 - INFO - ARIMA 예측 시작
2024-09-20 02:36:36 - INFO - 입력 데이터: {'open': 84583000.0, 'high': 84858000.0, 'low': 84549000.0, 'close': 84858000.0, 'volume': 6.5652934, 'value': 556163962.84839, 'decision': 'sell', 'sma': 84555050.0, 'ema': 84548092.69547428, 'rsi': 61.314253378767006, 'macd': 195214.44406561553, 'signal_line': 202750.43303501024, 'BB_Upper': 84967823.77581821, 'BB_Lower': 84142276.22418179}
2024-09-20 02:36:36 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:36:36 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84555050.0         0         0
2024-09-20 02:36:36 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84555050.0         0         0
2024-09-20 02:36:36 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 02:36:36 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 02:36:36 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 02:36:36 - INFO - ARIMA prediction: 80899000.0
2024-09-20 02:36:36 - INFO - Attempting prediction for prophet
2024-09-20 02:36:36 - INFO - PROPHET prediction: 84897962.22646739
2024-09-20 02:36:36 - INFO - Attempting prediction for transformer
2024-09-20 02:36:36 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:36:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:36:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:36:36 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:36:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:36:36 - INFO - X 샘플:
[[-1.44901494 -1.00949272 -0.57838763 -1.01350995 -0.33575551 -0.33734752
  -1.01350995 -1.01350995  0.          0.          0.         -1.01350995
  -1.01350995]
 [-0.37438664 -1.0161781  -1.67218659 -1.17010914  0.05774419  0.05198268
  -1.17010914 -1.17010914  0.          0.          0.         -1.17010914
  -1.17010914]
 [-0.85276956 -1.39724488 -0.83802678 -0.92581441 -0.9202462  -0.91916103
  -0.92581441 -0.92581441  0.          0.          0.         -0.92581441
  -0.92581441]
 [-0.93596659 -0.80893125 -0.46237865 -0.29315368 -0.08443866 -0.08681218
  -0.29315368 -0.29315368  0.          0.          0.         -0.29315368
  -0.29315368]
 [ 0.10399629 -0.3743814   0.02375422 -0.1929302  -0.82586636 -0.82438727
  -0.1929302  -0.1929302   0.          0.          0.         -0.1929302
  -0.1929302 ]
 [ 0.28425652  0.93595351  1.05678657  1.24778234  2.39191877  2.39114334
   1.24778234  1.24778234  0.          0.          0.          1.24778234
   1.24778234]
 [ 1.69860603  1.66466017  2.18373095  1.82406736  1.23202817  1.23701172
   1.82406736  1.82406736  0.          0.          0.          1.82406736
   1.82406736]
 [ 1.68473986  0.96938042 -0.0093912   0.0576285  -0.06568565 -0.06580628
   0.0576285   0.0576285   0.          0.          0.          0.0576285
   0.0576285 ]
 [ 0.32585503  0.32089835  0.04032693 -0.66899174 -0.56114393 -0.56047427
  -0.66899174 -0.66899174  0.          0.          0.         -0.66899174
  -0.66899174]
 [-0.48531601  0.7153359   0.25577218  1.13503093 -0.88855483 -0.88614919
   1.13503093  1.13503093  0.          0.          0.          1.13503093
   1.13503093]]
2024-09-20 02:36:36 - INFO - y 샘플:
[1.13503093]
2024-09-20 02:36:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:36:36 - INFO - 모델 출력 (스케일링된 예측): [0.482914]
2024-09-20 02:36:36 - INFO - 스케일러 역변환 후 예측 가격: 84753893.9495536
2024-09-20 02:36:36 - INFO - TransformerPredictor 최종 예측 가격: 84753893.9495536
2024-09-20 02:36:36 - INFO - TRANSFORMER prediction: 84753893.9495536
2024-09-20 02:36:36 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:36:36 - INFO - BITCOIN_FORECAST prediction: 83308608.88926771
2024-09-20 02:36:36 - INFO - BitcoinForecast prediction: 83308608.88926771
2024-09-20 02:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:36:43 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:36:43 - INFO - 조정된 모델 가중치: {'gpt': 0.004643100951576839, 'ml': 0.21391465556988343, 'xgboost': 0.078146309216521, 'rl': 0.2351061474797304, 'lstm': 0.10858437003310502, 'arima': 0.03595216042971594, 'prophet': 0.1819904959623225, 'transformer': 0.13662799673988835, 'bitcoin_forecast': 0.005034763617256476}
2024-09-20 02:36:43 - INFO - 조정된 모델 가중치: {'gpt': 0.004643100951576839, 'ml': 0.21391465556988343, 'xgboost': 0.078146309216521, 'rl': 0.2351061474797304, 'lstm': 0.10858437003310502, 'arima': 0.03595216042971594, 'prophet': 0.1819904959623225, 'transformer': 0.13662799673988835, 'bitcoin_forecast': 0.005034763617256476}
2024-09-20 02:36:43 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84897386.10775727, 'current_price': 84858000.0, 'predictions': {'gpt': 84858000.0, 'ml': 84908914.8, 'xgboost': 84858000.0, 'lstm': 84729756.75531067, 'rl': 85706580.0, 'arima': 80899000.0, 'prophet': 84897962.22646739, 'transformer': 84753893.9495536, 'bitcoin_forecast': 83308608.88926771}, 'weights': {'gpt': 0.004643100951576839, 'ml': 0.21391465556988343, 'xgboost': 0.078146309216521, 'rl': 0.2351061474797304, 'lstm': 0.10858437003310502, 'arima': 0.03595216042971594, 'prophet': 0.1819904959623225, 'transformer': 0.13662799673988835, 'bitcoin_forecast': 0.005034763617256476}}
2024-09-20 02:36:43 - INFO - 모델별 가중치:
2024-09-20 02:36:43 - INFO -   - GPT: 0.0046
2024-09-20 02:36:43 - INFO -   - ML: 0.2139
2024-09-20 02:36:43 - INFO -   - XGBOOST: 0.0781
2024-09-20 02:36:43 - INFO -   - RL: 0.2351
2024-09-20 02:36:43 - INFO -   - LSTM: 0.1086
2024-09-20 02:36:43 - INFO -   - ARIMA: 0.0360
2024-09-20 02:36:43 - INFO -   - PROPHET: 0.1820
2024-09-20 02:36:43 - INFO -   - TRANSFORMER: 0.1366
2024-09-20 02:36:43 - INFO -   - BITCOIN_FORECAST: 0.0050
2024-09-20 02:36:43 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:36:43 - INFO - 6. 거래 실행
2024-09-20 02:36:43 - INFO - Cancelling existing orders.
2024-09-20 02:36:43 - INFO - Cancelled 0 orders.
2024-09-20 02:36:43 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84897386.10775727, 'current_price': 84858000.0, 'predictions': {'gpt': 84858000.0, 'ml': 84908914.8, 'xgboost': 84858000.0, 'lstm': 84729756.75531067, 'rl': 85706580.0, 'arima': 80899000.0, 'prophet': 84897962.22646739, 'transformer': 84753893.9495536, 'bitcoin_forecast': 83308608.88926771}, 'weights': {'gpt': 0.004643100951576839, 'ml': 0.21391465556988343, 'xgboost': 0.078146309216521, 'rl': 0.2351061474797304, 'lstm': 0.10858437003310502, 'arima': 0.03595216042971594, 'prophet': 0.1819904959623225, 'transformer': 0.13662799673988835, 'bitcoin_forecast': 0.005034763617256476}}, 현재 가격=84858000.0
2024-09-20 02:36:43 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480329.56307023996
2024-09-20 02:36:43 - INFO - 매수 시도: 0.000550002220771642 BTC (약 46672.08845024 KRW)
2024-09-20 02:36:43 - INFO - 주문 결과: None
2024-09-20 02:36:43 - ERROR - 주문 실패
2024-09-20 02:36:43 - WARNING - Trade execution failed: Failed to place order
2024-09-20 02:36:43 - INFO - 7. summary 리포트 보내기
2024-09-20 02:36:43 - INFO - Message sent to Discord successfully.
2024-09-20 02:36:43 - INFO - Trading cycle completed.
2024-09-20 02:36:43 - INFO - Performing periodic update.
2024-09-20 02:36:43 - INFO - 계산된 시장 변동성: 0.027808120617069332
2024-09-20 02:45:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-990b-dcaa9d8cf97c "HTTP/1.1 200 OK"
2024-09-20 02:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:45:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:45:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d5-b85c-c87a5fa89ac3 "HTTP/1.1 200 OK"
2024-09-20 02:45:56 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-bd3d-f0c65da3f096 "HTTP/1.1 200 OK"
2024-09-20 02:46:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817f-aacb-f61ed58eaf06 "HTTP/1.1 200 OK"
2024-09-20 02:46:08 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f0-83e0-eee2755f5bd3 "HTTP/1.1 200 OK"
2024-09-20 02:46:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cc-a756-dc5e5e2ea97e "HTTP/1.1 200 OK"
2024-09-20 02:46:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ab-aa86-d738c608d12f "HTTP/1.1 200 OK"
2024-09-20 02:46:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819e-9fb4-de454dd79452 "HTTP/1.1 200 OK"
2024-09-20 02:46:34 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a3-835a-f04335c1454c "HTTP/1.1 200 OK"
2024-09-20 02:46:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:35:34.953778
2024-09-20 02:46:39 - INFO - Starting trading cycle.
2024-09-20 02:46:39 - INFO - ##################################################
2024-09-20 02:46:39 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-20 02:46:39 - INFO - ##################################################
2024-09-20 02:46:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:46:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:46:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:30:00
2024-09-20 02:46:39 - INFO - 새로운 데이터 범위: 2024-09-18 17:30:00 ~ 2024-09-20 02:40:00
2024-09-20 02:46:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:46:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:46:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:46:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:46:39 - INFO - Sample date values: [Timestamp('2024-09-20 02:40:00')]
2024-09-20 02:46:39 - INFO - Successfully added 1 new data points
2024-09-20 02:46:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:46:39 - INFO - Final date range: 2024-09-20 02:40:00 to 2024-09-20 02:40:00
2024-09-20 02:46:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:46:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:40:00
2024-09-20 02:46:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:46:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:46:40 - INFO - GPT | 이전예측가격: 84858000 | 당시BTC가격: 84858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:46:40 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 27/54
2024-09-20 02:46:40 - INFO - ML | 이전예측가격: 84908915 | 당시BTC가격: 84858000 | 예측: 상승 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2047 | 반영가중치값: 0.0200 | 새 가중치: 0.2247 | 예측 총 횟수: 54 | 예측 성공 수: 27 | 예측 성공률: 50.00%
2024-09-20 02:46:40 - INFO - XGBOOST | 이전예측가격: 84858000 | 당시BTC가격: 84858000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:46:40 - INFO - LSTM 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 10/19
2024-09-20 02:46:40 - INFO - LSTM | 이전예측가격: 84729757 | 당시BTC가격: 84858000 | 예측: 하락 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0219 | 반영가중치값: -0.0200 | 새 가중치: 0.0019 | 예측 총 횟수: 19 | 예측 성공 수: 10 | 예측 성공률: 52.63%
2024-09-20 02:46:40 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 40/60
2024-09-20 02:46:40 - INFO - RL | 이전예측가격: 85706580 | 당시BTC가격: 84858000 | 예측: 상승 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3817 | 반영가중치값: 0.0200 | 새 가중치: 0.4017 | 예측 총 횟수: 60 | 예측 성공 수: 40 | 예측 성공률: 66.67%
2024-09-20 02:46:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.40%, 적중/전체: 127/252
2024-09-20 02:46:40 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84858000 | 예측: 하락 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0214 | 반영가중치값: -0.0200 | 새 가중치: 0.0014 | 예측 총 횟수: 252 | 예측 성공 수: 127 | 예측 성공률: 50.40%
2024-09-20 02:46:40 - INFO - PROPHET 모델 예측 업데이트: 정확도 65.45%, 적중/전체: 36/55
2024-09-20 02:46:40 - INFO - PROPHET | 이전예측가격: 84897962 | 당시BTC가격: 84858000 | 예측: 상승 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1862 | 반영가중치값: 0.0200 | 새 가중치: 0.2062 | 예측 총 횟수: 55 | 예측 성공 수: 36 | 예측 성공률: 65.45%
2024-09-20 02:46:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 52.63%, 적중/전체: 10/19
2024-09-20 02:46:40 - INFO - TRANSFORMER | 이전예측가격: 84753894 | 당시BTC가격: 84858000 | 예측: 하락 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0582 | 반영가중치값: -0.0200 | 새 가중치: 0.0382 | 예측 총 횟수: 19 | 예측 성공 수: 10 | 예측 성공률: 52.63%
2024-09-20 02:46:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 35.00%, 적중/전체: 7/20
2024-09-20 02:46:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83308609 | 당시BTC가격: 84858000 | 예측: 하락 | 지금 BTC가격: 84998000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0411 | 반영가중치값: -0.0200 | 새 가중치: 0.0211 | 예측 총 횟수: 20 | 예측 성공 수: 7 | 예측 성공률: 35.00%
2024-09-20 02:46:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:46:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:46:40 - INFO - 새로운 가중치: {'gpt': 0.004747177073175967, 'ml': 0.22976913995494078, 'xgboost': 0.07989797579998817, 'rl': 0.4107430288072196, 'lstm': 0.001970454645854356, 'arima': 0.0014214021144114716, 'prophet': 0.210841894192939, 'transformer': 0.03905125065970643, 'bitcoin_forecast': 0.02155767675176426}
2024-09-20 02:46:40 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:46:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:46:40 - INFO - Current BTC price: 84998000.0
2024-09-20 02:46:40 - INFO - Analyzing market conditions.
2024-09-20 02:46:40 - INFO - Market analysis: {'current_price': 84998000.0, 'sma_20': 84574550.0, 'rsi_14': 64.0776225508212, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:46:40 - INFO - Starting predictions for all models
2024-09-20 02:46:40 - INFO - Attempting prediction for gpt
2024-09-20 02:46:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:46:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:46:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:46:40 - INFO - GPT prediction: 84998000.0
2024-09-20 02:46:40 - INFO - Attempting prediction for ml
2024-09-20 02:46:40 - INFO - ML prediction: 84964000.8
2024-09-20 02:46:40 - INFO - Attempting prediction for xgboost
2024-09-20 02:46:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:46:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:46:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:46:40 - INFO - XGBOOST prediction: 84998000.0
2024-09-20 02:46:40 - INFO - Attempting prediction for lstm
2024-09-20 02:46:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:46:40 - INFO - X 샘플:
[[-0.69539253 -1.2218102  -1.66393964 -1.33847522 -0.02915427 -0.03552647
  -1.33847522]
 [-1.16033521 -1.58453511 -0.95216942 -1.11643977 -1.00241859 -1.00183186
  -1.11643977]
 [-1.2411948  -1.02453877 -0.63163714 -0.5414249  -0.17065003 -0.17362985
  -0.5414249 ]
 [-0.23044985 -0.6109051  -0.21683066 -0.45033343 -0.90849484 -0.90753028
  -0.45033343]
 [-0.05525406  0.63635948  0.66463311  0.85910638  2.29374059  2.29198027
   0.85910638]
 [ 1.31935908  1.32999132  1.62622996  1.38288231  1.13945508  1.14359864
   1.38288231]
 [ 1.30588248  0.66817746 -0.24511292 -0.22260477 -0.15198764 -0.15272861
  -0.22260477]
 [-0.01482426  0.05090876 -0.20268953 -0.88301789 -0.64505166 -0.64493212
  -0.88301789]
 [-0.80320532  0.42636085 -0.01885484  0.75662848 -0.97088037 -0.96898449
   0.75662848]
 [ 1.57541447  1.32999132  1.64037109  1.5536788   0.44544172  0.44958477
   1.5536788 ]]
2024-09-20 02:46:40 - INFO - y 샘플:
[1.5536788]
2024-09-20 02:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:46:40 - INFO - 모델 출력 (스케일링된 예측): [[0.4220605]]
2024-09-20 02:46:40 - INFO - 스케일러 역변환 후 예측 가격: 84799233.92481503
2024-09-20 02:46:40 - INFO - LSTMPredictor 최종 예측 가격: 84799233.92481503
2024-09-20 02:46:40 - INFO - LSTM prediction: 84799233.92481503
2024-09-20 02:46:40 - INFO - Attempting prediction for rl
2024-09-20 02:46:40 - INFO - Preparing state for RL agent.
2024-09-20 02:46:40 - INFO - Prepared state: [[8.49980000e+07 2.48417036e+01 1.64981499e-03 8.45745500e+07
  6.40776226e+01]]
2024-09-20 02:46:40 - INFO - RL prediction: 85847980.0
2024-09-20 02:46:40 - INFO - Attempting prediction for arima
2024-09-20 02:46:40 - INFO - ARIMA 예측 시작
2024-09-20 02:46:40 - INFO - 입력 데이터: {'open': 84936000.0, 'high': 85000000.0, 'low': 84901000.0, 'close': 84998000.0, 'volume': 24.84170364, 'value': 2110983903.6382, 'decision': 'sell', 'sma': 84574550.0, 'ema': 84590941.01019101, 'rsi': 64.0776225508212, 'macd': 208023.73986169696, 'signal_line': 203805.0944003476, 'BB_Upper': 85030117.10812089, 'BB_Lower': 84118982.89187911}
2024-09-20 02:46:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:46:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84574550.0         0         0
2024-09-20 02:46:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84574550.0         0         0
2024-09-20 02:46:40 - INFO - ARIMA 예측 결과: 4980    8.089900e+09
dtype: float64
2024-09-20 02:46:40 - INFO - 신뢰 구간: [[7.80045741e+09 8.37934259e+09]]
2024-09-20 02:46:40 - INFO - 최종 ARIMA 예측값: 80899000.0
2024-09-20 02:46:40 - INFO - ARIMA prediction: 80899000.0
2024-09-20 02:46:40 - INFO - Attempting prediction for prophet
2024-09-20 02:46:40 - INFO - PROPHET prediction: 85063487.9409845
2024-09-20 02:46:40 - INFO - Attempting prediction for transformer
2024-09-20 02:46:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:46:40 - INFO - X 샘플:
[[-0.69539253 -1.2218102  -1.66393964 -1.33847522 -0.02915427 -0.03552647
  -1.33847522 -1.33847522  0.          0.          0.         -1.33847522
  -1.33847522]
 [-1.16033521 -1.58453511 -0.95216942 -1.11643977 -1.00241859 -1.00183186
  -1.11643977 -1.11643977  0.          0.          0.         -1.11643977
  -1.11643977]
 [-1.2411948  -1.02453877 -0.63163714 -0.5414249  -0.17065003 -0.17362985
  -0.5414249  -0.5414249   0.          0.          0.         -0.5414249
  -0.5414249 ]
 [-0.23044985 -0.6109051  -0.21683066 -0.45033343 -0.90849484 -0.90753028
  -0.45033343 -0.45033343  0.          0.          0.         -0.45033343
  -0.45033343]
 [-0.05525406  0.63635948  0.66463311  0.85910638  2.29374059  2.29198027
   0.85910638  0.85910638  0.          0.          0.          0.85910638
   0.85910638]
 [ 1.31935908  1.32999132  1.62622996  1.38288231  1.13945508  1.14359864
   1.38288231  1.38288231  0.          0.          0.          1.38288231
   1.38288231]
 [ 1.30588248  0.66817746 -0.24511292 -0.22260477 -0.15198764 -0.15272861
  -0.22260477 -0.22260477  0.          0.          0.         -0.22260477
  -0.22260477]
 [-0.01482426  0.05090876 -0.20268953 -0.88301789 -0.64505166 -0.64493212
  -0.88301789 -0.88301789  0.          0.          0.         -0.88301789
  -0.88301789]
 [-0.80320532  0.42636085 -0.01885484  0.75662848 -0.97088037 -0.96898449
   0.75662848  0.75662848  0.          0.          0.          0.75662848
   0.75662848]
 [ 1.57541447  1.32999132  1.64037109  1.5536788   0.44544172  0.44958477
   1.5536788   1.5536788   0.          0.          0.          1.5536788
   1.5536788 ]]
2024-09-20 02:46:40 - INFO - y 샘플:
[1.5536788]
2024-09-20 02:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:46:40 - INFO - 모델 출력 (스케일링된 예측): [0.4848129]
2024-09-20 02:46:40 - INFO - 스케일러 역변환 후 예측 가격: 84810256.23443958
2024-09-20 02:46:40 - INFO - TransformerPredictor 최종 예측 가격: 84810256.23443958
2024-09-20 02:46:40 - INFO - TRANSFORMER prediction: 84810256.23443958
2024-09-20 02:46:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:46:40 - INFO - BITCOIN_FORECAST prediction: 83449956.05035171
2024-09-20 02:46:40 - INFO - BitcoinForecast prediction: 83449956.05035171
2024-09-20 02:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:46:46 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:46:46 - INFO - 조정된 모델 가중치: {'gpt': 0.004747177073175967, 'ml': 0.22976913995494078, 'xgboost': 0.07989797579998817, 'rl': 0.4107430288072196, 'lstm': 0.001970454645854356, 'arima': 0.0014214021144114716, 'prophet': 0.210841894192939, 'transformer': 0.03905125065970643, 'bitcoin_forecast': 0.02155767675176426}
2024-09-20 02:46:46 - INFO - 조정된 모델 가중치: {'gpt': 0.004747177073175967, 'ml': 0.22976913995494078, 'xgboost': 0.07989797579998817, 'rl': 0.4107430288072196, 'lstm': 0.001970454645854356, 'arima': 0.0014214021144114716, 'prophet': 0.210841894192939, 'transformer': 0.03905125065970643, 'bitcoin_forecast': 0.02155767675176426}
2024-09-20 02:46:46 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85306197.14749037, 'current_price': 84998000.0, 'predictions': {'gpt': 84998000.0, 'ml': 84964000.8, 'xgboost': 84998000.0, 'lstm': 84799233.92481503, 'rl': 85847980.0, 'arima': 80899000.0, 'prophet': 85063487.9409845, 'transformer': 84810256.23443958, 'bitcoin_forecast': 83449956.05035171}, 'weights': {'gpt': 0.004747177073175967, 'ml': 0.22976913995494078, 'xgboost': 0.07989797579998817, 'rl': 0.4107430288072196, 'lstm': 0.001970454645854356, 'arima': 0.0014214021144114716, 'prophet': 0.210841894192939, 'transformer': 0.03905125065970643, 'bitcoin_forecast': 0.02155767675176426}}
2024-09-20 02:46:46 - INFO - 모델별 가중치:
2024-09-20 02:46:46 - INFO -   - GPT: 0.0047
2024-09-20 02:46:46 - INFO -   - ML: 0.2298
2024-09-20 02:46:46 - INFO -   - XGBOOST: 0.0799
2024-09-20 02:46:46 - INFO -   - RL: 0.4107
2024-09-20 02:46:46 - INFO -   - LSTM: 0.0020
2024-09-20 02:46:46 - INFO -   - ARIMA: 0.0014
2024-09-20 02:46:46 - INFO -   - PROPHET: 0.2108
2024-09-20 02:46:46 - INFO -   - TRANSFORMER: 0.0391
2024-09-20 02:46:46 - INFO -   - BITCOIN_FORECAST: 0.0216
2024-09-20 02:46:46 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:46:46 - INFO - 6. 거래 실행
2024-09-20 02:46:46 - INFO - Cancelling existing orders.
2024-09-20 02:46:46 - INFO - Cancelled 0 orders.
2024-09-20 02:46:46 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85306197.14749037, 'current_price': 84998000.0, 'predictions': {'gpt': 84998000.0, 'ml': 84964000.8, 'xgboost': 84998000.0, 'lstm': 84799233.92481503, 'rl': 85847980.0, 'arima': 80899000.0, 'prophet': 85063487.9409845, 'transformer': 84810256.23443958, 'bitcoin_forecast': 83449956.05035171}, 'weights': {'gpt': 0.004747177073175967, 'ml': 0.22976913995494078, 'xgboost': 0.07989797579998817, 'rl': 0.4107430288072196, 'lstm': 0.001970454645854356, 'arima': 0.0014214021144114716, 'prophet': 0.210841894192939, 'transformer': 0.03905125065970643, 'bitcoin_forecast': 0.02155767675176426}}, 현재 가격=84998000.0
2024-09-20 02:46:46 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=481045.01767024
2024-09-20 02:46:46 - INFO - 매수 시도: 0.0005490963134454929 BTC (약 46672.08845024 KRW)
2024-09-20 02:46:46 - INFO - 주문 결과: None
2024-09-20 02:46:46 - ERROR - 주문 실패
2024-09-20 02:46:46 - WARNING - Trade execution failed: Failed to place order
2024-09-20 02:46:46 - INFO - 7. summary 리포트 보내기
2024-09-20 02:46:47 - INFO - Message sent to Discord successfully.
2024-09-20 02:46:47 - INFO - Trading cycle completed.
2024-09-20 02:46:47 - INFO - Performing periodic update.
2024-09-20 02:46:47 - INFO - 계산된 시장 변동성: 0.026761012232034444
2024-09-20 02:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:55:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-be49-c61a249f4fd7 "HTTP/1.1 200 OK"
2024-09-20 02:55:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:55:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:55:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-86e4-ecf08d7d04a9 "HTTP/1.1 200 OK"
2024-09-20 02:55:45 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:55:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:55:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a6fc880f-2593-4fea-9881-f88222bd089e "HTTP/1.1 200 OK"
2024-09-20 02:55:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:55:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:55:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ed-9794-f4b3992d32f7 "HTTP/1.1 200 OK"
2024-09-20 02:55:59 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-b553-cd04a9a21ea2 "HTTP/1.1 200 OK"
2024-09-20 02:56:04 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:56:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d2-bd61-f5594c0fe2a9 "HTTP/1.1 200 OK"
2024-09-20 02:56:22 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:56:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81af-a5bc-d580f7bc173d "HTTP/1.1 200 OK"
2024-09-20 02:56:29 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:56:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811b-ba28-f47f443e835f "HTTP/1.1 200 OK"
2024-09-20 02:56:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 02:56:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/31cdd59c-5b79-42d0-a704-cd31b270c828 "HTTP/1.1 200 OK"
2024-09-20 02:56:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:45:34.954211
2024-09-20 02:56:42 - INFO - Starting trading cycle.
2024-09-20 02:56:42 - INFO - ##################################################
2024-09-20 02:56:42 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-20 02:56:42 - INFO - ##################################################
2024-09-20 02:56:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 02:56:42 - INFO - 데이터베이스 업데이트 시작
2024-09-20 02:56:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:40:00
2024-09-20 02:56:42 - INFO - 새로운 데이터 범위: 2024-09-18 17:40:00 ~ 2024-09-20 02:50:00
2024-09-20 02:56:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 02:56:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 02:56:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 02:56:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 02:56:42 - INFO - Sample date values: [Timestamp('2024-09-20 02:50:00')]
2024-09-20 02:56:42 - INFO - Successfully added 1 new data points
2024-09-20 02:56:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 02:56:42 - INFO - Final date range: 2024-09-20 02:50:00 to 2024-09-20 02:50:00
2024-09-20 02:56:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 02:56:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 02:50:00
2024-09-20 02:56:42 - INFO - 데이터베이스 업데이트 완료
2024-09-20 02:56:43 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-20 02:56:43 - INFO - 재학습 대상 모델: ['bitcoin_forecast', 'ml', 'arima']
2024-09-20 02:56:43 - INFO - bitcoin_forecast 모델 재학습 시작
2024-09-20 02:56:43 - INFO - BitcoinForecastPredictor 훈련 시작
2024-09-20 02:56:43 - INFO - BitcoinForecastPredictor prepare_data 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 02:56:43 - INFO - 준비된 데이터 shape - X: (2970, 30, 2), y: (2970,)
2024-09-20 02:56:43 - INFO - Epoch [1/30], Loss: 1.0835
2024-09-20 02:56:43 - INFO - Epoch [2/30], Loss: 0.8361
2024-09-20 02:56:43 - INFO - Epoch [3/30], Loss: 0.5674
2024-09-20 02:56:43 - INFO - Epoch [4/30], Loss: 0.3232
2024-09-20 02:56:43 - INFO - Epoch [5/30], Loss: 0.2194
2024-09-20 02:56:43 - INFO - Epoch [6/30], Loss: 0.1414
2024-09-20 02:56:44 - INFO - Epoch [7/30], Loss: 0.0842
2024-09-20 02:56:44 - INFO - Epoch [8/30], Loss: 0.0475
2024-09-20 02:56:44 - INFO - Epoch [9/30], Loss: 0.0303
2024-09-20 02:56:44 - INFO - Epoch [10/30], Loss: 0.0232
2024-09-20 02:56:44 - INFO - Epoch [11/30], Loss: 0.0199
2024-09-20 02:56:44 - INFO - Epoch [12/30], Loss: 0.0179
2024-09-20 02:56:44 - INFO - Epoch [13/30], Loss: 0.0162
2024-09-20 02:56:44 - INFO - Epoch [14/30], Loss: 0.0149
2024-09-20 02:56:45 - INFO - Epoch [15/30], Loss: 0.0138
2024-09-20 02:56:45 - INFO - Epoch [16/30], Loss: 0.0129
2024-09-20 02:56:45 - INFO - Epoch [17/30], Loss: 0.0122
2024-09-20 02:56:45 - INFO - Epoch [18/30], Loss: 0.0116
2024-09-20 02:56:45 - INFO - Epoch [19/30], Loss: 0.0111
2024-09-20 02:56:45 - INFO - Epoch [20/30], Loss: 0.0106
2024-09-20 02:56:45 - INFO - Epoch [21/30], Loss: 0.0102
2024-09-20 02:56:46 - INFO - Epoch [22/30], Loss: 0.0099
2024-09-20 02:56:46 - INFO - Epoch [23/30], Loss: 0.0096
2024-09-20 02:56:46 - INFO - Epoch [24/30], Loss: 0.0093
2024-09-20 02:56:46 - INFO - Epoch [25/30], Loss: 0.0090
2024-09-20 02:56:46 - INFO - Epoch [26/30], Loss: 0.0088
2024-09-20 02:56:46 - INFO - Epoch [27/30], Loss: 0.0086
2024-09-20 02:56:46 - INFO - Epoch [28/30], Loss: 0.0084
2024-09-20 02:56:47 - INFO - Epoch [29/30], Loss: 0.0082
2024-09-20 02:56:47 - INFO - Epoch [30/30], Loss: 0.0081
2024-09-20 02:56:47 - INFO - BitcoinForecastPredictor 훈련 완료
2024-09-20 02:56:47 - INFO - bitcoin_forecast 모델의 예측 통계가 초기화되었습니다.
2024-09-20 02:56:47 - INFO - bitcoin_forecast 모델 재학습 완료
2024-09-20 02:56:47 - INFO - ml 모델 재학습 시작
2024-09-20 02:56:47 - INFO - prepare_data_for_ml 메서드 시작. 데이터 shape: (5000, 15)
2024-09-20 02:56:47 - INFO - 최종 X shape: (4999, 12), y shape: (4999,)
2024-09-20 02:56:47 - INFO - ML 모델 훈련 시작
2024-09-20 02:56:51 - INFO - ML 모델 학습 완료. MSE: 0.2626, RMSE: 0.5125, MAE: 0.4875, R2: -0.0515
2024-09-20 02:56:51 - INFO - ml 모델의 예측 통계가 초기화되었습니다.
2024-09-20 02:56:51 - INFO - ml 모델 재학습 완료
2024-09-20 02:56:51 - INFO - arima 모델 재학습 시작
2024-09-20 02:56:51 - INFO - ARIMA 훈련 시작. 입력 데이터 타입: <class 'pandas.core.frame.DataFrame'>
2024-09-20 02:56:51 - INFO - 데이터 샘플:
                    date        open  ...      BB_Upper      BB_Lower
4999 2024-08-10 11:10:00  85300000.0  ...  8.550060e+07  8.468320e+07
4998 2024-08-10 11:20:00  85505000.0  ...  8.550060e+07  8.468320e+07
4997 2024-08-10 11:30:00  85340000.0  ...  8.550060e+07  8.468320e+07
4996 2024-08-10 11:40:00  85426000.0  ...  8.550060e+07  8.468320e+07
4995 2024-08-10 11:50:00  85406000.0  ...  8.550060e+07  8.468320e+07

[5 rows x 15 columns]
2024-09-20 02:56:51 - INFO - 전처리 후 데이터 shape: (4980, 6)
2024-09-20 02:56:51 - INFO - 전처리 후 데이터 컬럼: ['close', 'returns', 'volatility', 'sma', 'upper_bb', 'lower_bb']
2024-09-20 02:56:52 - INFO - ARIMA 모델 훈련 완료
2024-09-20 02:56:52 - INFO - arima 모델의 예측 통계가 초기화되었습니다.
2024-09-20 02:56:52 - INFO - arima 모델 재학습 완료
2024-09-20 02:56:52 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:56:52 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 02:56:52 - INFO - GPT | 이전예측가격: 84998000 | 당시BTC가격: 84998000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:56:52 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 02:56:52 - INFO - ML | 이전예측가격: 84964001 | 당시BTC가격: 84998000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2139 | 반영가중치값: 0.0200 | 새 가중치: 0.2339 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 02:56:52 - INFO - XGBOOST | 이전예측가격: 84998000 | 당시BTC가격: 84998000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 02:56:52 - INFO - LSTM 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 11/20
2024-09-20 02:56:52 - INFO - LSTM | 이전예측가격: 84799234 | 당시BTC가격: 84998000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1086 | 반영가중치값: 0.0200 | 새 가중치: 0.1286 | 예측 총 횟수: 20 | 예측 성공 수: 11 | 예측 성공률: 55.00%
2024-09-20 02:56:52 - INFO - RL 모델 예측 업데이트: 정확도 65.57%, 적중/전체: 40/61
2024-09-20 02:56:52 - INFO - RL | 이전예측가격: 85847980 | 당시BTC가격: 84998000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2351 | 반영가중치값: -0.0200 | 새 가중치: 0.2151 | 예측 총 횟수: 61 | 예측 성공 수: 40 | 예측 성공률: 65.57%
2024-09-20 02:56:52 - INFO - ARIMA 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 02:56:52 - INFO - ARIMA | 이전예측가격: 80899000 | 당시BTC가격: 84998000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0360 | 반영가중치값: 0.0200 | 새 가중치: 0.0560 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 02:56:52 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 36/56
2024-09-20 02:56:52 - INFO - PROPHET | 이전예측가격: 85063488 | 당시BTC가격: 84998000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1820 | 반영가중치값: -0.0200 | 새 가중치: 0.1620 | 예측 총 횟수: 56 | 예측 성공 수: 36 | 예측 성공률: 64.29%
2024-09-20 02:56:52 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 11/20
2024-09-20 02:56:52 - INFO - TRANSFORMER | 이전예측가격: 84810256 | 당시BTC가격: 84998000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1366 | 반영가중치값: 0.0200 | 새 가중치: 0.1566 | 예측 총 횟수: 20 | 예측 성공 수: 11 | 예측 성공률: 55.00%
2024-09-20 02:56:52 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 02:56:52 - INFO - BITCOIN_FORECAST | 이전예측가격: 83449956 | 당시BTC가격: 84998000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0050 | 반영가중치값: 0.0200 | 새 가중치: 0.0250 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 02:56:52 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 02:56:52 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 02:56:52 - INFO - 새로운 가중치: {'gpt': 0.0044706421807189966, 'ml': 0.22028854406718967, 'xgboost': 0.07524371963789442, 'rl': 0.20257567843608376, 'lstm': 0.12109401010116279, 'arima': 0.05269280767571912, 'prophet': 0.152554145961158, 'transformer': 0.14750402567949594, 'bitcoin_forecast': 0.02357642626057724}
2024-09-20 02:56:52 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 02:56:52 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 02:56:52 - INFO - Current BTC price: 84956000.0
2024-09-20 02:56:52 - INFO - Analyzing market conditions.
2024-09-20 02:56:52 - INFO - Market analysis: {'current_price': 84953000.0, 'sma_20': 84584900.0, 'rsi_14': 62.53145824386892, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 02:56:52 - INFO - Starting predictions for all models
2024-09-20 02:56:52 - INFO - Attempting prediction for gpt
2024-09-20 02:56:52 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 02:56:52 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:56:52 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 02:56:52 - INFO - GPT prediction: 84956000.0
2024-09-20 02:56:52 - INFO - Attempting prediction for ml
2024-09-20 02:56:52 - INFO - ML prediction: 85105915.4
2024-09-20 02:56:52 - INFO - Attempting prediction for xgboost
2024-09-20 02:56:52 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 02:56:52 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:56:52 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 02:56:52 - INFO - XGBOOST prediction: 84953000.0
2024-09-20 02:56:52 - INFO - Attempting prediction for lstm
2024-09-20 02:56:52 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:56:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:56:52 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 02:56:52 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:56:52 - INFO - X 샘플:
[[-1.28202041 -1.87590372 -1.3807205  -1.43901186 -0.86764948 -0.86821676
  -1.43901186]
 [-1.35569974 -1.30469428 -1.03078016 -0.83942359 -0.07086667 -0.07466465
  -0.83942359]
 [-0.43470807 -0.88277822 -0.57791618 -0.74443931 -0.77767634 -0.77786052
  -0.74443931]
 [-0.27506951  0.38946098  0.38441976  0.62095974  2.28986704  2.2877905
   0.62095974]
 [ 0.97747916  1.09698176  1.43424079  1.16711936  1.18413294  1.18745429
   1.16711936]
 [ 0.96519927  0.42191606 -0.60879327 -0.5069786  -0.05298926 -0.05463786
  -0.5069786 ]
 [-0.23822985 -0.20771252 -0.56247764 -1.19561464 -0.52531408 -0.52624881
  -1.19561464]
 [-0.95660335  0.17525744 -0.36177656  0.51410242 -0.83743782 -0.83674364
   0.51410242]
 [ 1.21079705  1.09698176  1.44967933  1.34521489  0.5193111   0.52247623
   1.34521489]
 [ 1.38885544  1.09049074  1.25412443  1.07807159 -0.86137742 -0.85934879
   1.07807159]]
2024-09-20 02:56:52 - INFO - y 샘플:
[1.07807159]
2024-09-20 02:56:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 02:56:52 - INFO - 모델 출력 (스케일링된 예측): [[0.39646903]]
2024-09-20 02:56:52 - INFO - 스케일러 역변환 후 예측 가격: 84838184.78096828
2024-09-20 02:56:52 - INFO - LSTMPredictor 최종 예측 가격: 84838184.78096828
2024-09-20 02:56:52 - INFO - LSTM prediction: 84838184.78096828
2024-09-20 02:56:52 - INFO - Attempting prediction for rl
2024-09-20 02:56:52 - INFO - Preparing state for RL agent.
2024-09-20 02:56:52 - INFO - Prepared state: [[ 8.49530000e+07  6.24280927e+00 -5.29424222e-04  8.45849000e+07
   6.25314582e+01]]
2024-09-20 02:56:52 - INFO - RL prediction: 85805560.0
2024-09-20 02:56:52 - INFO - Attempting prediction for arima
2024-09-20 02:56:52 - INFO - ARIMA 예측 시작
2024-09-20 02:56:52 - INFO - 입력 데이터: {'open': 84965000.0, 'high': 84999000.0, 'low': 84863000.0, 'close': 84953000.0, 'volume': 6.24280927, 'value': 530305794.22116, 'decision': 'sell', 'sma': 84584900.0, 'ema': 84625422.81874426, 'rsi': 62.53145824386892, 'macd': 212099.12842144072, 'signal_line': 205463.9012045662, 'BB_Upper': 85064356.73423326, 'BB_Lower': 84105443.26576674}
2024-09-20 02:56:52 - INFO - Exogenous 변수 예측 시작
2024-09-20 02:56:52 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84584900.0         0         0
2024-09-20 02:56:52 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84584900.0         0         0
2024-09-20 02:56:52 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 02:56:52 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 02:56:52 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 02:56:52 - INFO - ARIMA prediction: 84953000.0
2024-09-20 02:56:52 - INFO - Attempting prediction for prophet
2024-09-20 02:56:52 - INFO - PROPHET prediction: 84999208.77442026
2024-09-20 02:56:52 - INFO - Attempting prediction for transformer
2024-09-20 02:56:52 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 02:56:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 02:56:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 02:56:52 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 02:56:52 - INFO - X dtype: float64, y dtype: float64
2024-09-20 02:56:52 - INFO - X 샘플:
[[-1.28202041 -1.87590372 -1.3807205  -1.43901186 -0.86764948 -0.86821676
  -1.43901186 -1.43901186  0.          0.          0.         -1.43901186
  -1.43901186]
 [-1.35569974 -1.30469428 -1.03078016 -0.83942359 -0.07086667 -0.07466465
  -0.83942359 -0.83942359  0.          0.          0.         -0.83942359
  -0.83942359]
 [-0.43470807 -0.88277822 -0.57791618 -0.74443931 -0.77767634 -0.77786052
  -0.74443931 -0.74443931  0.          0.          0.         -0.74443931
  -0.74443931]
 [-0.27506951  0.38946098  0.38441976  0.62095974  2.28986704  2.2877905
   0.62095974  0.62095974  0.          0.          0.          0.62095974
   0.62095974]
 [ 0.97747916  1.09698176  1.43424079  1.16711936  1.18413294  1.18745429
   1.16711936  1.16711936  0.          0.          0.          1.16711936
   1.16711936]
 [ 0.96519927  0.42191606 -0.60879327 -0.5069786  -0.05298926 -0.05463786
  -0.5069786  -0.5069786   0.          0.          0.         -0.5069786
  -0.5069786 ]
 [-0.23822985 -0.20771252 -0.56247764 -1.19561464 -0.52531408 -0.52624881
  -1.19561464 -1.19561464  0.          0.          0.         -1.19561464
  -1.19561464]
 [-0.95660335  0.17525744 -0.36177656  0.51410242 -0.83743782 -0.83674364
   0.51410242  0.51410242  0.          0.          0.          0.51410242
   0.51410242]
 [ 1.21079705  1.09698176  1.44967933  1.34521489  0.5193111   0.52247623
   1.34521489  1.34521489  0.          0.          0.          1.34521489
   1.34521489]
 [ 1.38885544  1.09049074  1.25412443  1.07807159 -0.86137742 -0.85934879
   1.07807159  1.07807159  0.          0.          0.          1.07807159
   1.07807159]]
2024-09-20 02:56:52 - INFO - y 샘플:
[1.07807159]
2024-09-20 02:56:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 02:56:52 - INFO - 모델 출력 (스케일링된 예측): [0.48416093]
2024-09-20 02:56:52 - INFO - 스케일러 역변환 후 예측 가격: 84852956.38769223
2024-09-20 02:56:52 - INFO - TransformerPredictor 최종 예측 가격: 84852956.38769223
2024-09-20 02:56:52 - INFO - TRANSFORMER prediction: 84852956.38769223
2024-09-20 02:56:52 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 02:56:52 - INFO - BITCOIN_FORECAST prediction: 83197578.45253944
2024-09-20 02:56:52 - INFO - BitcoinForecast prediction: 83197578.45253944
2024-09-20 02:56:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:56:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:57:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 02:57:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 02:57:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0044706421807189966, 'ml': 0.22028854406718967, 'xgboost': 0.07524371963789442, 'rl': 0.20257567843608376, 'lstm': 0.12109401010116279, 'arima': 0.05269280767571912, 'prophet': 0.152554145961158, 'transformer': 0.14750402567949594, 'bitcoin_forecast': 0.02357642626057724}
2024-09-20 02:57:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0044706421807189966, 'ml': 0.22028854406718967, 'xgboost': 0.07524371963789442, 'rl': 0.20257567843608376, 'lstm': 0.12109401010116279, 'arima': 0.05269280767571912, 'prophet': 0.152554145961158, 'transformer': 0.14750402567949594, 'bitcoin_forecast': 0.02357642626057724}
2024-09-20 02:57:00 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85096409.34576102, 'current_price': 84956000.0, 'predictions': {'gpt': 84956000.0, 'ml': 85105915.4, 'xgboost': 84953000.0, 'lstm': 84838184.78096828, 'rl': 85805560.0, 'arima': 84953000.0, 'prophet': 84999208.77442026, 'transformer': 84852956.38769223, 'bitcoin_forecast': 83197578.45253944}, 'weights': {'gpt': 0.0044706421807189966, 'ml': 0.22028854406718967, 'xgboost': 0.07524371963789442, 'rl': 0.20257567843608376, 'lstm': 0.12109401010116279, 'arima': 0.05269280767571912, 'prophet': 0.152554145961158, 'transformer': 0.14750402567949594, 'bitcoin_forecast': 0.02357642626057724}}
2024-09-20 02:57:00 - INFO - 모델별 가중치:
2024-09-20 02:57:00 - INFO -   - GPT: 0.0045
2024-09-20 02:57:00 - INFO -   - ML: 0.2203
2024-09-20 02:57:00 - INFO -   - XGBOOST: 0.0752
2024-09-20 02:57:00 - INFO -   - RL: 0.2026
2024-09-20 02:57:00 - INFO -   - LSTM: 0.1211
2024-09-20 02:57:00 - INFO -   - ARIMA: 0.0527
2024-09-20 02:57:00 - INFO -   - PROPHET: 0.1526
2024-09-20 02:57:00 - INFO -   - TRANSFORMER: 0.1475
2024-09-20 02:57:00 - INFO -   - BITCOIN_FORECAST: 0.0236
2024-09-20 02:57:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 02:57:00 - INFO - 6. 거래 실행
2024-09-20 02:57:00 - INFO - Cancelling existing orders.
2024-09-20 02:57:00 - INFO - Cancelled 0 orders.
2024-09-20 02:57:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85096409.34576102, 'current_price': 84956000.0, 'predictions': {'gpt': 84956000.0, 'ml': 85105915.4, 'xgboost': 84953000.0, 'lstm': 84838184.78096828, 'rl': 85805560.0, 'arima': 84953000.0, 'prophet': 84999208.77442026, 'transformer': 84852956.38769223, 'bitcoin_forecast': 83197578.45253944}, 'weights': {'gpt': 0.0044706421807189966, 'ml': 0.22028854406718967, 'xgboost': 0.07524371963789442, 'rl': 0.20257567843608376, 'lstm': 0.12109401010116279, 'arima': 0.05269280767571912, 'prophet': 0.152554145961158, 'transformer': 0.14750402567949594, 'bitcoin_forecast': 0.02357642626057724}}, 현재 가격=84956000.0
2024-09-20 02:57:00 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480830.38129024
2024-09-20 02:57:00 - INFO - 매수 시도: 0.0005493677721436979 BTC (약 46672.08845023999 KRW)
2024-09-20 02:57:00 - INFO - 주문 결과: None
2024-09-20 02:57:00 - ERROR - 주문 실패
2024-09-20 02:57:00 - WARNING - Trade execution failed: Failed to place order
2024-09-20 02:57:00 - INFO - 7. summary 리포트 보내기
2024-09-20 02:57:00 - INFO - Message sent to Discord successfully.
2024-09-20 02:57:00 - INFO - Trading cycle completed.
2024-09-20 02:57:00 - INFO - Performing periodic update.
2024-09-20 02:57:00 - INFO - 계산된 시장 변동성: 0.026759929018533857
2024-09-20 03:05:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:05:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8178-9e64-dcf4692b29fd "HTTP/1.1 200 OK"
2024-09-20 03:05:45 - INFO - Updated actual price for gpt prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:05:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:05:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bb-8811-ce2dd3256264 "HTTP/1.1 200 OK"
2024-09-20 03:05:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:05:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:05:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81db-a173-eeb367151bcd "HTTP/1.1 200 OK"
2024-09-20 03:05:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8187-af7e-f750498c7c0d "HTTP/1.1 200 OK"
2024-09-20 03:06:07 - INFO - Updated actual price for lstm prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ae-8645-d9983177b931 "HTTP/1.1 200 OK"
2024-09-20 03:06:20 - INFO - Updated actual price for rl prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-ab3c-d5dc4a8e54c6 "HTTP/1.1 200 OK"
2024-09-20 03:06:25 - INFO - Updated actual price for arima prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8179-a73c-eda9a9fb3966 "HTTP/1.1 200 OK"
2024-09-20 03:06:34 - INFO - Updated actual price for prophet prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d2-8298-f6e75bb428ce "HTTP/1.1 200 OK"
2024-09-20 03:06:42 - INFO - Updated actual price for transformer prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:06:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8122-ad43-c3d43f708cd2 "HTTP/1.1 200 OK"
2024-09-20 03:06:50 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 02:55:34.954593
2024-09-20 03:06:50 - INFO - Starting trading cycle.
2024-09-20 03:06:50 - INFO - ##################################################
2024-09-20 03:06:50 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-20 03:06:50 - INFO - ##################################################
2024-09-20 03:06:50 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:06:50 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:06:50 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 02:50:00
2024-09-20 03:06:50 - INFO - 새로운 데이터 범위: 2024-09-18 17:50:00 ~ 2024-09-20 03:00:00
2024-09-20 03:06:50 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:06:50 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:06:50 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:06:50 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:06:50 - INFO - Sample date values: [Timestamp('2024-09-20 03:00:00')]
2024-09-20 03:06:50 - INFO - Successfully added 1 new data points
2024-09-20 03:06:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:06:50 - INFO - Final date range: 2024-09-20 03:00:00 to 2024-09-20 03:00:00
2024-09-20 03:06:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:06:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:00:00
2024-09-20 03:06:50 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:06:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:06:50 - INFO - GPT | 이전예측가격: 84956000 | 당시BTC가격: 84956000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:06:50 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 03:06:50 - INFO - ML | 이전예측가격: 85105915 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1250 | 반영가중치값: -0.0200 | 새 가중치: 0.1050 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 03:06:50 - INFO - XGBOOST | 이전예측가격: 84953000 | 당시BTC가격: 84956000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:06:50 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 12/21
2024-09-20 03:06:50 - INFO - LSTM | 이전예측가격: 84838185 | 당시BTC가격: 84956000 | 예측: 하락 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0020 | 반영가중치값: 0.0200 | 새 가중치: 0.0220 | 예측 총 횟수: 21 | 예측 성공 수: 12 | 예측 성공률: 57.14%
2024-09-20 03:06:50 - INFO - RL 모델 예측 업데이트: 정확도 64.52%, 적중/전체: 40/62
2024-09-20 03:06:50 - INFO - RL | 이전예측가격: 85805560 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.4107 | 반영가중치값: -0.0200 | 새 가중치: 0.3907 | 예측 총 횟수: 62 | 예측 성공 수: 40 | 예측 성공률: 64.52%
2024-09-20 03:06:50 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84956000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:06:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 36/57
2024-09-20 03:06:50 - INFO - PROPHET | 이전예측가격: 84999209 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2108 | 반영가중치값: -0.0200 | 새 가중치: 0.1908 | 예측 총 횟수: 57 | 예측 성공 수: 36 | 예측 성공률: 63.16%
2024-09-20 03:06:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 12/21
2024-09-20 03:06:50 - INFO - TRANSFORMER | 이전예측가격: 84852956 | 당시BTC가격: 84956000 | 예측: 하락 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0391 | 반영가중치값: 0.0200 | 새 가중치: 0.0591 | 예측 총 횟수: 21 | 예측 성공 수: 12 | 예측 성공률: 57.14%
2024-09-20 03:06:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-20 03:06:51 - INFO - BITCOIN_FORECAST | 이전예측가격: 83197578 | 당시BTC가격: 84956000 | 예측: 하락 | 지금 BTC가격: 84936000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-20 03:06:51 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:06:51 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:06:51 - INFO - 새로운 가중치: {'gpt': 0.004278070002645447, 'ml': 0.10047714223586761, 'xgboost': 0.07200260876583298, 'rl': 0.37391183698225444, 'lstm': 0.02102408091845892, 'arima': 0.050423073634670926, 'prophet': 0.18262141092748888, 'transformer': 0.056507627730868516, 'bitcoin_forecast': 0.13875414880191242}
2024-09-20 03:06:51 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:06:51 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:06:51 - INFO - Current BTC price: 84936000.0
2024-09-20 03:06:51 - INFO - Analyzing market conditions.
2024-09-20 03:06:51 - INFO - Market analysis: {'current_price': 84936000.0, 'sma_20': 84616700.0, 'rsi_14': 61.9235664152655, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:06:51 - INFO - Starting predictions for all models
2024-09-20 03:06:51 - INFO - Attempting prediction for gpt
2024-09-20 03:06:51 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:06:51 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:06:51 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:06:51 - INFO - GPT prediction: 84936000.0
2024-09-20 03:06:51 - INFO - Attempting prediction for ml
2024-09-20 03:06:51 - INFO - ML prediction: 85105872.0
2024-09-20 03:06:51 - INFO - Attempting prediction for xgboost
2024-09-20 03:06:51 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:06:51 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:06:51 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:06:51 - INFO - XGBOOST prediction: 84936000.0
2024-09-20 03:06:51 - INFO - Attempting prediction for lstm
2024-09-20 03:06:51 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:06:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:06:51 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:06:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:06:51 - INFO - X 샘플:
[[-1.6892039  -1.94465894 -1.37478507 -1.18657507 -0.07215469 -0.07621546
  -1.18657507]
 [-0.69827474 -1.43186855 -0.88138749 -1.08231806 -0.77970444 -0.78029473
  -1.08231806]
 [-0.52651369  0.1143917   0.16708236  0.41637643  2.29105091  2.28920754
   0.41637643]
 [ 0.82114996  0.97430174  1.31086766  1.01585422  1.18415902  1.18748902
   1.01585422]
 [ 0.80793757  0.15383712 -0.91502824 -0.82167554 -0.05425855 -0.05616352
  -0.82167554]
 [-0.48687652 -0.61140393 -0.86456712 -1.57753885 -0.52707794 -0.52836693
  -1.57753885]
 [-1.25980126 -0.14594803 -0.64590229  0.29908729 -0.83952849 -0.83925182
   0.29908729]
 [ 1.07218534  0.97430174  1.32768803  1.21133611  0.51864105  0.52167557
   1.21133611]
 [ 1.26376498  0.96641266  1.11462999  0.91811328 -0.86349316 -0.86188537
   0.91811328]
 [ 0.69563227  0.95063449  0.76140217  0.8073402  -0.85763372 -0.85619428
   0.8073402 ]]
2024-09-20 03:06:51 - INFO - y 샘플:
[0.8073402]
2024-09-20 03:06:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:06:51 - INFO - 모델 출력 (스케일링된 예측): [[0.34618253]]
2024-09-20 03:06:51 - INFO - 스케일러 역변환 후 예측 가격: 84865227.55965184
2024-09-20 03:06:51 - INFO - LSTMPredictor 최종 예측 가격: 84865227.55965184
2024-09-20 03:06:51 - INFO - LSTM prediction: 84865227.55965184
2024-09-20 03:06:51 - INFO - Attempting prediction for rl
2024-09-20 03:06:51 - INFO - Preparing state for RL agent.
2024-09-20 03:06:51 - INFO - Prepared state: [[ 8.49360000e+07  6.32165777e+00 -2.00110649e-04  8.46167000e+07
   6.19235664e+01]]
2024-09-20 03:06:51 - INFO - RL prediction: 85785360.0
2024-09-20 03:06:51 - INFO - Attempting prediction for arima
2024-09-20 03:06:51 - INFO - ARIMA 예측 시작
2024-09-20 03:06:51 - INFO - 입력 데이터: {'open': 84879000.0, 'high': 84997000.0, 'low': 84800000.0, 'close': 84936000.0, 'volume': 6.32165777, 'value': 536807696.56545, 'decision': 'sell', 'sma': 84616700.0, 'ema': 84655001.59791146, 'rsi': 61.9235664152655, 'macd': 211518.8872255683, 'signal_line': 206674.89840876663, 'BB_Upper': 85100698.3884304, 'BB_Lower': 84132701.6115696}
2024-09-20 03:06:51 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:06:51 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84616700.0         0         0
2024-09-20 03:06:51 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84616700.0         0         0
2024-09-20 03:06:51 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:06:51 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:06:51 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:06:51 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:06:51 - INFO - Attempting prediction for prophet
2024-09-20 03:06:51 - INFO - PROPHET prediction: 84978512.13723943
2024-09-20 03:06:51 - INFO - Attempting prediction for transformer
2024-09-20 03:06:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:06:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:06:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:06:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:06:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:06:51 - INFO - X 샘플:
[[-1.6892039  -1.94465894 -1.37478507 -1.18657507 -0.07215469 -0.07621546
  -1.18657507 -1.18657507  0.          0.          0.         -1.18657507
  -1.18657507]
 [-0.69827474 -1.43186855 -0.88138749 -1.08231806 -0.77970444 -0.78029473
  -1.08231806 -1.08231806  0.          0.          0.         -1.08231806
  -1.08231806]
 [-0.52651369  0.1143917   0.16708236  0.41637643  2.29105091  2.28920754
   0.41637643  0.41637643  0.          0.          0.          0.41637643
   0.41637643]
 [ 0.82114996  0.97430174  1.31086766  1.01585422  1.18415902  1.18748902
   1.01585422  1.01585422  0.          0.          0.          1.01585422
   1.01585422]
 [ 0.80793757  0.15383712 -0.91502824 -0.82167554 -0.05425855 -0.05616352
  -0.82167554 -0.82167554  0.          0.          0.         -0.82167554
  -0.82167554]
 [-0.48687652 -0.61140393 -0.86456712 -1.57753885 -0.52707794 -0.52836693
  -1.57753885 -1.57753885  0.          0.          0.         -1.57753885
  -1.57753885]
 [-1.25980126 -0.14594803 -0.64590229  0.29908729 -0.83952849 -0.83925182
   0.29908729  0.29908729  0.          0.          0.          0.29908729
   0.29908729]
 [ 1.07218534  0.97430174  1.32768803  1.21133611  0.51864105  0.52167557
   1.21133611  1.21133611  0.          0.          0.          1.21133611
   1.21133611]
 [ 1.26376498  0.96641266  1.11462999  0.91811328 -0.86349316 -0.86188537
   0.91811328  0.91811328  0.          0.          0.          0.91811328
   0.91811328]
 [ 0.69563227  0.95063449  0.76140217  0.8073402  -0.85763372 -0.85619428
   0.8073402   0.8073402   0.          0.          0.          0.8073402
   0.8073402 ]]
2024-09-20 03:06:51 - INFO - y 샘플:
[0.8073402]
2024-09-20 03:06:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:06:51 - INFO - 모델 출력 (스케일링된 예측): [0.48326954]
2024-09-20 03:06:51 - INFO - 스케일러 역변환 후 예측 가격: 84886265.87949671
2024-09-20 03:06:51 - INFO - TransformerPredictor 최종 예측 가격: 84886265.87949671
2024-09-20 03:06:51 - INFO - TRANSFORMER prediction: 84886265.87949671
2024-09-20 03:06:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:06:51 - INFO - BITCOIN_FORECAST prediction: 83165084.07127383
2024-09-20 03:06:51 - INFO - BitcoinForecast prediction: 83165084.07127383
2024-09-20 03:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:06:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:07:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:07:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:07:00 - INFO - 조정된 모델 가중치: {'gpt': 0.004278070002645447, 'ml': 0.10047714223586761, 'xgboost': 0.07200260876583298, 'rl': 0.37391183698225444, 'lstm': 0.02102408091845892, 'arima': 0.050423073634670926, 'prophet': 0.18262141092748888, 'transformer': 0.056507627730868516, 'bitcoin_forecast': 0.13875414880191242}
2024-09-20 03:07:00 - INFO - 조정된 모델 가중치: {'gpt': 0.004278070002645447, 'ml': 0.10047714223586761, 'xgboost': 0.07200260876583298, 'rl': 0.37391183698225444, 'lstm': 0.02102408091845892, 'arima': 0.050423073634670926, 'prophet': 0.18262141092748888, 'transformer': 0.056507627730868516, 'bitcoin_forecast': 0.13875414880191242}
2024-09-20 03:07:00 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85029254.61473139, 'current_price': 84936000.0, 'predictions': {'gpt': 84936000.0, 'ml': 85105872.0, 'xgboost': 84936000.0, 'lstm': 84865227.55965184, 'rl': 85785360.0, 'arima': 84953000.0, 'prophet': 84978512.13723943, 'transformer': 84886265.87949671, 'bitcoin_forecast': 83165084.07127383}, 'weights': {'gpt': 0.004278070002645447, 'ml': 0.10047714223586761, 'xgboost': 0.07200260876583298, 'rl': 0.37391183698225444, 'lstm': 0.02102408091845892, 'arima': 0.050423073634670926, 'prophet': 0.18262141092748888, 'transformer': 0.056507627730868516, 'bitcoin_forecast': 0.13875414880191242}}
2024-09-20 03:07:00 - INFO - 모델별 가중치:
2024-09-20 03:07:00 - INFO -   - GPT: 0.0043
2024-09-20 03:07:00 - INFO -   - ML: 0.1005
2024-09-20 03:07:00 - INFO -   - XGBOOST: 0.0720
2024-09-20 03:07:00 - INFO -   - RL: 0.3739
2024-09-20 03:07:00 - INFO -   - LSTM: 0.0210
2024-09-20 03:07:00 - INFO -   - ARIMA: 0.0504
2024-09-20 03:07:00 - INFO -   - PROPHET: 0.1826
2024-09-20 03:07:00 - INFO -   - TRANSFORMER: 0.0565
2024-09-20 03:07:00 - INFO -   - BITCOIN_FORECAST: 0.1388
2024-09-20 03:07:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:07:00 - INFO - 6. 거래 실행
2024-09-20 03:07:00 - INFO - Cancelling existing orders.
2024-09-20 03:07:01 - INFO - Cancelled 0 orders.
2024-09-20 03:07:01 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85029254.61473139, 'current_price': 84936000.0, 'predictions': {'gpt': 84936000.0, 'ml': 85105872.0, 'xgboost': 84936000.0, 'lstm': 84865227.55965184, 'rl': 85785360.0, 'arima': 84953000.0, 'prophet': 84978512.13723943, 'transformer': 84886265.87949671, 'bitcoin_forecast': 83165084.07127383}, 'weights': {'gpt': 0.004278070002645447, 'ml': 0.10047714223586761, 'xgboost': 0.07200260876583298, 'rl': 0.37391183698225444, 'lstm': 0.02102408091845892, 'arima': 0.050423073634670926, 'prophet': 0.18262141092748888, 'transformer': 0.056507627730868516, 'bitcoin_forecast': 0.13875414880191242}}, 현재 가격=84936000.0
2024-09-20 03:07:01 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480728.17349024
2024-09-20 03:07:01 - INFO - 매수 시도: 0.0005494971325496845 BTC (약 46672.08845024 KRW)
2024-09-20 03:07:01 - INFO - 주문 결과: None
2024-09-20 03:07:01 - ERROR - 주문 실패
2024-09-20 03:07:01 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:07:01 - INFO - 7. summary 리포트 보내기
2024-09-20 03:07:01 - INFO - Message sent to Discord successfully.
2024-09-20 03:07:01 - INFO - Trading cycle completed.
2024-09-20 03:07:01 - INFO - Performing periodic update.
2024-09-20 03:07:01 - INFO - 계산된 시장 변동성: 0.02658913566475015
2024-09-20 03:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:15:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/fa4ebf15-0861-44f1-b974-c820ca0ea0b9 "HTTP/1.1 200 OK"
2024-09-20 03:15:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:15:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:15:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81df-98db-f07cfef0a4a3 "HTTP/1.1 200 OK"
2024-09-20 03:15:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:15:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-8ee7-cb629bc02b42 "HTTP/1.1 200 OK"
2024-09-20 03:15:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816e-9b6f-d0e3f97e6262 "HTTP/1.1 200 OK"
2024-09-20 03:16:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811d-b6f9-c5e43fc7442c "HTTP/1.1 200 OK"
2024-09-20 03:16:18 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818c-b45d-f5fb0555cc44 "HTTP/1.1 200 OK"
2024-09-20 03:16:23 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-a8ac-c22261e94c20 "HTTP/1.1 200 OK"
2024-09-20 03:16:28 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/66dbc615-29c4-43be-8d60-4c76fe1a8a9b "HTTP/1.1 200 OK"
2024-09-20 03:16:38 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:16:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8171-bf2b-cee75e835770 "HTTP/1.1 200 OK"
2024-09-20 03:16:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:05:34.955167
2024-09-20 03:16:45 - INFO - Starting trading cycle.
2024-09-20 03:16:45 - INFO - ##################################################
2024-09-20 03:16:45 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-20 03:16:45 - INFO - ##################################################
2024-09-20 03:16:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:16:45 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:16:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:00:00
2024-09-20 03:16:45 - INFO - 새로운 데이터 범위: 2024-09-18 18:00:00 ~ 2024-09-20 03:10:00
2024-09-20 03:16:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:16:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:16:45 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:16:45 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:16:45 - INFO - Sample date values: [Timestamp('2024-09-20 03:10:00')]
2024-09-20 03:16:45 - INFO - Successfully added 1 new data points
2024-09-20 03:16:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:16:45 - INFO - Final date range: 2024-09-20 03:10:00 to 2024-09-20 03:10:00
2024-09-20 03:16:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:16:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:10:00
2024-09-20 03:16:45 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:16:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:16:46 - INFO - GPT | 이전예측가격: 84936000 | 당시BTC가격: 84936000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:16:46 - INFO - ML 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-20 03:16:46 - INFO - ML | 이전예측가격: 85105872 | 당시BTC가격: 84936000 | 예측: 상승 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2203 | 반영가중치값: -0.0200 | 새 가중치: 0.2003 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-20 03:16:46 - INFO - XGBOOST | 이전예측가격: 84936000 | 당시BTC가격: 84936000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:16:46 - INFO - LSTM 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-20 03:16:46 - INFO - LSTM | 이전예측가격: 84865228 | 당시BTC가격: 84936000 | 예측: 하락 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1211 | 반영가중치값: 0.0200 | 새 가중치: 0.1411 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-20 03:16:46 - INFO - RL 모델 예측 업데이트: 정확도 63.49%, 적중/전체: 40/63
2024-09-20 03:16:46 - INFO - RL | 이전예측가격: 85785360 | 당시BTC가격: 84936000 | 예측: 상승 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2026 | 반영가중치값: -0.0200 | 새 가중치: 0.1826 | 예측 총 횟수: 63 | 예측 성공 수: 40 | 예측 성공률: 63.49%
2024-09-20 03:16:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 03:16:46 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84936000 | 예측: 상승 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0527 | 반영가중치값: -0.0200 | 새 가중치: 0.0327 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 03:16:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.07%, 적중/전체: 36/58
2024-09-20 03:16:46 - INFO - PROPHET | 이전예측가격: 84978512 | 당시BTC가격: 84936000 | 예측: 상승 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1526 | 반영가중치값: -0.0200 | 새 가중치: 0.1326 | 예측 총 횟수: 58 | 예측 성공 수: 36 | 예측 성공률: 62.07%
2024-09-20 03:16:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-20 03:16:46 - INFO - TRANSFORMER | 이전예측가격: 84886266 | 당시BTC가격: 84936000 | 예측: 하락 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1475 | 반영가중치값: 0.0200 | 새 가중치: 0.1675 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-20 03:16:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 3/3
2024-09-20 03:16:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 83165084 | 당시BTC가격: 84936000 | 예측: 하락 | 지금 BTC가격: 84760000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0236 | 반영가중치값: 0.0200 | 새 가중치: 0.0436 | 예측 총 횟수: 3 | 예측 성공 수: 3 | 예측 성공률: 100.00%
2024-09-20 03:16:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:16:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:16:46 - INFO - 새로운 가중치: {'gpt': 0.004380726560390957, 'ml': 0.2050946675006733, 'xgboost': 0.07373038319683255, 'rl': 0.18695676398744446, 'lstm': 0.14447970163649038, 'arima': 0.03347730421199599, 'prophet': 0.1357349149366198, 'transformer': 0.1715234518866733, 'bitcoin_forecast': 0.04462208608287928}
2024-09-20 03:16:46 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:16:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:16:46 - INFO - Current BTC price: 84760000.0
2024-09-20 03:16:46 - INFO - Analyzing market conditions.
2024-09-20 03:16:46 - INFO - Market analysis: {'current_price': 84760000.0, 'sma_20': 84648200.0, 'rsi_14': 55.868194589055946, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:16:46 - INFO - Starting predictions for all models
2024-09-20 03:16:46 - INFO - Attempting prediction for gpt
2024-09-20 03:16:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:16:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:16:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:16:46 - INFO - GPT prediction: 84760000.0
2024-09-20 03:16:46 - INFO - Attempting prediction for ml
2024-09-20 03:16:46 - INFO - ML prediction: 84946472.0
2024-09-20 03:16:46 - INFO - Attempting prediction for xgboost
2024-09-20 03:16:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:16:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:16:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:16:46 - INFO - XGBOOST prediction: 84760000.0
2024-09-20 03:16:46 - INFO - Attempting prediction for lstm
2024-09-20 03:16:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:16:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:16:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:16:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:16:46 - INFO - X 샘플:
[[-1.07036151 -2.13951551 -1.19671914 -1.25584555 -0.69375644 -0.69483325
  -1.25584555]
 [-0.86252432 -0.11271493 -0.02689959  0.35690976  2.30051408  2.29836418
   0.35690976]
 [ 0.76819821  1.01443437  1.24926719  1.00201189  1.2211921   1.22403331
   1.00201189]
 [ 0.75221074 -0.06101083 -1.23425346 -0.97536637  0.01362041  0.01129676
  -0.97536637]
 [-0.81456189 -1.06407031 -1.17795198 -1.78875601 -0.44742223 -0.44916814
  -1.78875601]
 [-1.74982923 -0.45396197 -0.93397892  0.23069413 -0.75209043 -0.75232474
   0.23069413]
 [ 1.07196026  1.01443437  1.26803434  1.21237128  0.57225052  0.57477133
   1.21237128]
 [ 1.30377865  1.00409355  1.030317    0.8968322  -0.77545819 -0.77439563
   0.8968322 ]
 [ 0.61631719  0.98341192  0.63620667  0.77762854 -0.76974469 -0.76884602
   0.77762854]
 [-0.0151881  -0.18510067  0.38597789 -0.45647988 -0.66910513 -0.6688978
  -0.45647988]]
2024-09-20 03:16:46 - INFO - y 샘플:
[-0.45647988]
2024-09-20 03:16:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:16:46 - INFO - 모델 출력 (스케일링된 예측): [[0.24914905]]
2024-09-20 03:16:46 - INFO - 스케일러 역변환 후 예측 가격: 84860631.91349839
2024-09-20 03:16:46 - INFO - LSTMPredictor 최종 예측 가격: 84860631.91349839
2024-09-20 03:16:46 - INFO - LSTM prediction: 84860631.91349839
2024-09-20 03:16:46 - INFO - Attempting prediction for rl
2024-09-20 03:16:46 - INFO - Preparing state for RL agent.
2024-09-20 03:16:46 - INFO - Prepared state: [[ 8.47600000e+07  7.71052216e+00 -2.07214844e-03  8.46482000e+07
   5.58681946e+01]]
2024-09-20 03:16:46 - INFO - RL prediction: 85607600.0
2024-09-20 03:16:46 - INFO - Attempting prediction for arima
2024-09-20 03:16:46 - INFO - ARIMA 예측 시작
2024-09-20 03:16:46 - INFO - 입력 데이터: {'open': 84800000.0, 'high': 84884000.0, 'low': 84760000.0, 'close': 84760000.0, 'volume': 7.71052216, 'value': 653906597.45425, 'decision': 'sell', 'sma': 84648200.0, 'ema': 84665001.44572942, 'rsi': 55.868194589055946, 'macd': 194613.9246108532, 'signal_line': 204262.70364918397, 'BB_Upper': 85080654.66814826, 'BB_Lower': 84215745.33185174}
2024-09-20 03:16:46 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:16:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84648200.0         0         0
2024-09-20 03:16:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84648200.0         0         0
2024-09-20 03:16:46 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:16:46 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:16:46 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:16:46 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:16:46 - INFO - Attempting prediction for prophet
2024-09-20 03:16:46 - INFO - PROPHET prediction: 84769426.97149198
2024-09-20 03:16:46 - INFO - Attempting prediction for transformer
2024-09-20 03:16:46 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:16:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:16:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:16:46 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:16:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:16:46 - INFO - X 샘플:
[[-1.07036151 -2.13951551 -1.19671914 -1.25584555 -0.69375644 -0.69483325
  -1.25584555 -1.25584555  0.          0.          0.         -1.25584555
  -1.25584555]
 [-0.86252432 -0.11271493 -0.02689959  0.35690976  2.30051408  2.29836418
   0.35690976  0.35690976  0.          0.          0.          0.35690976
   0.35690976]
 [ 0.76819821  1.01443437  1.24926719  1.00201189  1.2211921   1.22403331
   1.00201189  1.00201189  0.          0.          0.          1.00201189
   1.00201189]
 [ 0.75221074 -0.06101083 -1.23425346 -0.97536637  0.01362041  0.01129676
  -0.97536637 -0.97536637  0.          0.          0.         -0.97536637
  -0.97536637]
 [-0.81456189 -1.06407031 -1.17795198 -1.78875601 -0.44742223 -0.44916814
  -1.78875601 -1.78875601  0.          0.          0.         -1.78875601
  -1.78875601]
 [-1.74982923 -0.45396197 -0.93397892  0.23069413 -0.75209043 -0.75232474
   0.23069413  0.23069413  0.          0.          0.          0.23069413
   0.23069413]
 [ 1.07196026  1.01443437  1.26803434  1.21237128  0.57225052  0.57477133
   1.21237128  1.21237128  0.          0.          0.          1.21237128
   1.21237128]
 [ 1.30377865  1.00409355  1.030317    0.8968322  -0.77545819 -0.77439563
   0.8968322   0.8968322   0.          0.          0.          0.8968322
   0.8968322 ]
 [ 0.61631719  0.98341192  0.63620667  0.77762854 -0.76974469 -0.76884602
   0.77762854  0.77762854  0.          0.          0.          0.77762854
   0.77762854]
 [-0.0151881  -0.18510067  0.38597789 -0.45647988 -0.66910513 -0.6688978
  -0.45647988 -0.45647988  0.          0.          0.         -0.45647988
  -0.45647988]]
2024-09-20 03:16:46 - INFO - y 샘플:
[-0.45647988]
2024-09-20 03:16:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:16:46 - INFO - 모델 출력 (스케일링된 예측): [0.4824899]
2024-09-20 03:16:46 - INFO - 스케일러 역변환 후 예측 가격: 84893909.37166886
2024-09-20 03:16:46 - INFO - TransformerPredictor 최종 예측 가격: 84893909.37166886
2024-09-20 03:16:46 - INFO - TRANSFORMER prediction: 84893909.37166886
2024-09-20 03:16:46 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:16:46 - INFO - BITCOIN_FORECAST prediction: 83166925.29326971
2024-09-20 03:16:46 - INFO - BitcoinForecast prediction: 83166925.29326971
2024-09-20 03:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:17:28 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:17:29 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:17:29 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:17:29 - INFO - 조정된 모델 가중치: {'gpt': 0.004380726560390957, 'ml': 0.2050946675006733, 'xgboost': 0.07373038319683255, 'rl': 0.18695676398744446, 'lstm': 0.14447970163649038, 'arima': 0.03347730421199599, 'prophet': 0.1357349149366198, 'transformer': 0.1715234518866733, 'bitcoin_forecast': 0.04462208608287928}
2024-09-20 03:17:29 - INFO - 조정된 모델 가중치: {'gpt': 0.004380726560390957, 'ml': 0.2050946675006733, 'xgboost': 0.07373038319683255, 'rl': 0.18695676398744446, 'lstm': 0.14447970163649038, 'arima': 0.03347730421199599, 'prophet': 0.1357349149366198, 'transformer': 0.1715234518866733, 'bitcoin_forecast': 0.04462208608287928}
2024-09-20 03:17:29 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84930871.20468622, 'current_price': 84760000.0, 'predictions': {'gpt': 84760000.0, 'ml': 84946472.0, 'xgboost': 84760000.0, 'lstm': 84860631.91349839, 'rl': 85607600.0, 'arima': 84953000.0, 'prophet': 84769426.97149198, 'transformer': 84893909.37166886, 'bitcoin_forecast': 83166925.29326971}, 'weights': {'gpt': 0.004380726560390957, 'ml': 0.2050946675006733, 'xgboost': 0.07373038319683255, 'rl': 0.18695676398744446, 'lstm': 0.14447970163649038, 'arima': 0.03347730421199599, 'prophet': 0.1357349149366198, 'transformer': 0.1715234518866733, 'bitcoin_forecast': 0.04462208608287928}}
2024-09-20 03:17:29 - INFO - 모델별 가중치:
2024-09-20 03:17:29 - INFO -   - GPT: 0.0044
2024-09-20 03:17:29 - INFO -   - ML: 0.2051
2024-09-20 03:17:29 - INFO -   - XGBOOST: 0.0737
2024-09-20 03:17:29 - INFO -   - RL: 0.1870
2024-09-20 03:17:29 - INFO -   - LSTM: 0.1445
2024-09-20 03:17:29 - INFO -   - ARIMA: 0.0335
2024-09-20 03:17:29 - INFO -   - PROPHET: 0.1357
2024-09-20 03:17:29 - INFO -   - TRANSFORMER: 0.1715
2024-09-20 03:17:29 - INFO -   - BITCOIN_FORECAST: 0.0446
2024-09-20 03:17:29 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:17:29 - INFO - 6. 거래 실행
2024-09-20 03:17:29 - INFO - Cancelling existing orders.
2024-09-20 03:17:29 - INFO - Cancelled 0 orders.
2024-09-20 03:17:29 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84930871.20468622, 'current_price': 84760000.0, 'predictions': {'gpt': 84760000.0, 'ml': 84946472.0, 'xgboost': 84760000.0, 'lstm': 84860631.91349839, 'rl': 85607600.0, 'arima': 84953000.0, 'prophet': 84769426.97149198, 'transformer': 84893909.37166886, 'bitcoin_forecast': 83166925.29326971}, 'weights': {'gpt': 0.004380726560390957, 'ml': 0.2050946675006733, 'xgboost': 0.07373038319683255, 'rl': 0.18695676398744446, 'lstm': 0.14447970163649038, 'arima': 0.03347730421199599, 'prophet': 0.1357349149366198, 'transformer': 0.1715234518866733, 'bitcoin_forecast': 0.04462208608287928}}, 현재 가격=84760000.0
2024-09-20 03:17:29 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=479828.74485024007
2024-09-20 03:17:29 - INFO - 매수 시도: 0.000550638136505899 BTC (약 46672.08845024 KRW)
2024-09-20 03:17:29 - INFO - 주문 결과: None
2024-09-20 03:17:29 - ERROR - 주문 실패
2024-09-20 03:17:29 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:17:29 - INFO - 7. summary 리포트 보내기
2024-09-20 03:17:29 - INFO - Message sent to Discord successfully.
2024-09-20 03:17:29 - INFO - Trading cycle completed.
2024-09-20 03:17:29 - INFO - Performing periodic update.
2024-09-20 03:17:30 - INFO - 계산된 시장 변동성: 0.026466319964423342
2024-09-20 03:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:25:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8170-aa3e-ef1bfda11b4d "HTTP/1.1 200 OK"
2024-09-20 03:25:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:25:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:25:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-abb6-dd7f8353466b "HTTP/1.1 200 OK"
2024-09-20 03:25:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:25:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8132-a174-e37dc4ff8a9d "HTTP/1.1 200 OK"
2024-09-20 03:25:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b8-812d-ddf0c05a5db3 "HTTP/1.1 200 OK"
2024-09-20 03:26:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c7-b5f7-e12ac510c450 "HTTP/1.1 200 OK"
2024-09-20 03:26:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-bfa9-e0f11433e451 "HTTP/1.1 200 OK"
2024-09-20 03:26:15 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816a-a2ba-f7e47bb0646c "HTTP/1.1 200 OK"
2024-09-20 03:26:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-a7ed-d99d80196041 "HTTP/1.1 200 OK"
2024-09-20 03:26:47 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:26:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8104-9b02-f11aa58c5fba "HTTP/1.1 200 OK"
2024-09-20 03:26:53 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:15:34.955594
2024-09-20 03:26:53 - INFO - Starting trading cycle.
2024-09-20 03:26:53 - INFO - ##################################################
2024-09-20 03:26:53 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-20 03:26:53 - INFO - ##################################################
2024-09-20 03:26:53 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:26:53 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:26:53 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:10:00
2024-09-20 03:26:53 - INFO - 새로운 데이터 범위: 2024-09-18 18:10:00 ~ 2024-09-20 03:20:00
2024-09-20 03:26:53 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:26:53 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:26:53 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:26:53 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:26:53 - INFO - Sample date values: [Timestamp('2024-09-20 03:20:00')]
2024-09-20 03:26:53 - INFO - Successfully added 1 new data points
2024-09-20 03:26:53 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:26:53 - INFO - Final date range: 2024-09-20 03:20:00 to 2024-09-20 03:20:00
2024-09-20 03:26:53 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:26:53 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:20:00
2024-09-20 03:26:53 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:26:53 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:26:53 - INFO - GPT | 이전예측가격: 84760000 | 당시BTC가격: 84760000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:26:53 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 03:26:53 - INFO - ML | 이전예측가격: 84946472 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1005 | 반영가중치값: 0.0200 | 새 가중치: 0.1205 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 03:26:53 - INFO - XGBOOST | 이전예측가격: 84760000 | 당시BTC가격: 84760000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:26:53 - INFO - LSTM 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 14/23
2024-09-20 03:26:53 - INFO - LSTM | 이전예측가격: 84860632 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0210 | 반영가중치값: 0.0200 | 새 가중치: 0.0410 | 예측 총 횟수: 23 | 예측 성공 수: 14 | 예측 성공률: 60.87%
2024-09-20 03:26:53 - INFO - RL 모델 예측 업데이트: 정확도 64.06%, 적중/전체: 41/64
2024-09-20 03:26:53 - INFO - RL | 이전예측가격: 85607600 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3739 | 반영가중치값: 0.0200 | 새 가중치: 0.3939 | 예측 총 횟수: 64 | 예측 성공 수: 41 | 예측 성공률: 64.06%
2024-09-20 03:26:53 - INFO - ARIMA 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-20 03:26:53 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0504 | 반영가중치값: 0.0200 | 새 가중치: 0.0704 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-20 03:26:53 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.71%, 적중/전체: 37/59
2024-09-20 03:26:53 - INFO - PROPHET | 이전예측가격: 84769427 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1826 | 반영가중치값: 0.0200 | 새 가중치: 0.2026 | 예측 총 횟수: 59 | 예측 성공 수: 37 | 예측 성공률: 62.71%
2024-09-20 03:26:53 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 14/23
2024-09-20 03:26:53 - INFO - TRANSFORMER | 이전예측가격: 84893909 | 당시BTC가격: 84760000 | 예측: 상승 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0565 | 반영가중치값: 0.0200 | 새 가중치: 0.0765 | 예측 총 횟수: 23 | 예측 성공 수: 14 | 예측 성공률: 60.87%
2024-09-20 03:26:53 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-20 03:26:53 - INFO - BITCOIN_FORECAST | 이전예측가격: 83166925 | 당시BTC가격: 84760000 | 예측: 하락 | 지금 BTC가격: 84836000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1388 | 반영가중치값: -0.0200 | 새 가중치: 0.1188 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-20 03:26:53 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:26:53 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:26:53 - INFO - 새로운 가중치: {'gpt': 0.003975862743652707, 'ml': 0.10934272538448182, 'xgboost': 0.06691627052873227, 'rl': 0.35750676864930236, 'lstm': 0.03723266281695025, 'arima': 0.06391462030275898, 'prophet': 0.18389527574189732, 'transformer': 0.06943684398171247, 'bitcoin_forecast': 0.10777896985051182}
2024-09-20 03:26:53 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:26:53 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:26:54 - INFO - Current BTC price: 84836000.0
2024-09-20 03:26:54 - INFO - Analyzing market conditions.
2024-09-20 03:26:54 - INFO - Market analysis: {'current_price': 84836000.0, 'sma_20': 84677550.0, 'rsi_14': 57.78778513654212, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:26:54 - INFO - Starting predictions for all models
2024-09-20 03:26:54 - INFO - Attempting prediction for gpt
2024-09-20 03:26:54 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:26:54 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:26:54 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:26:54 - INFO - GPT prediction: 84836000.0
2024-09-20 03:26:54 - INFO - Attempting prediction for ml
2024-09-20 03:26:54 - INFO - ML prediction: 85005672.0
2024-09-20 03:26:54 - INFO - Attempting prediction for xgboost
2024-09-20 03:26:54 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:26:54 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:26:54 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:26:54 - INFO - XGBOOST prediction: 84836000.0
2024-09-20 03:26:54 - INFO - Attempting prediction for lstm
2024-09-20 03:26:54 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:26:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:26:54 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:26:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:26:54 - INFO - X 샘플:
[[-1.03528137e+00 -5.34879639e-01 -1.99948930e-01  2.46248070e-01
   2.30637496e+00  2.30428918e+00  2.46248070e-01]
 [ 7.08710369e-01  1.06243216e+00  1.18745181e+00  9.56430593e-01
   1.21851525e+00  1.22135567e+00  9.56430593e-01]
 [ 6.91612411e-01 -4.61608455e-01 -1.51253884e+00 -1.22043323e+00
   1.39134288e-03 -1.09178919e-03 -1.22043323e+00]
 [-9.83987496e-01 -1.88306941e+00 -1.45132999e+00 -2.11588075e+00
  -4.63298265e-01 -4.65243825e-01 -2.11588075e+00]
 [-1.98421805e+00 -1.01846945e+00 -1.18609161e+00  1.07299316e-01
  -7.70376469e-01 -7.70827930e-01  1.07299316e-01]
 [ 1.03357158e+00  1.06243216e+00  1.20785476e+00  1.18801185e+00
   5.64440366e-01  5.66894773e-01  1.18801185e+00]
 [ 1.28149197e+00  1.04777792e+00  9.49417367e-01  8.40639964e-01
  -7.93929083e-01 -7.93075561e-01  8.40639964e-01]
 [ 5.46279766e-01  1.01846945e+00  5.20955375e-01  7.09410585e-01
  -7.88170386e-01 -7.87481509e-01  7.09410585e-01]
 [-1.29089585e-01 -6.37459296e-01  2.48916015e-01 -6.49199458e-01
  -6.86734735e-01 -6.86732957e-01 -6.49199458e-01]
 [-1.29089585e-01  3.44374562e-01  2.35314047e-01 -6.25269395e-02
  -5.88212986e-01 -5.88086050e-01 -6.25269395e-02]]
2024-09-20 03:26:54 - INFO - y 샘플:
[-0.06252694]
2024-09-20 03:26:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:26:54 - INFO - 모델 출력 (스케일링된 예측): [[0.19561502]]
2024-09-20 03:26:54 - INFO - 스케일러 역변환 후 예측 가격: 84869440.78434691
2024-09-20 03:26:54 - INFO - LSTMPredictor 최종 예측 가격: 84869440.78434691
2024-09-20 03:26:54 - INFO - LSTM prediction: 84869440.78434691
2024-09-20 03:26:54 - INFO - Attempting prediction for rl
2024-09-20 03:26:54 - INFO - Preparing state for RL agent.
2024-09-20 03:26:54 - INFO - Prepared state: [[8.48360000e+07 9.05948920e+00 8.96649363e-04 8.46775500e+07
  5.77877851e+01]]
2024-09-20 03:26:54 - INFO - RL prediction: 85684360.0
2024-09-20 03:26:54 - INFO - Attempting prediction for arima
2024-09-20 03:26:54 - INFO - ARIMA 예측 시작
2024-09-20 03:26:54 - INFO - 입력 데이터: {'open': 84800000.0, 'high': 84951000.0, 'low': 84758000.0, 'close': 84836000.0, 'volume': 9.0594892, 'value': 768562780.2822, 'decision': 'sell', 'sma': 84677550.0, 'ema': 84681287.02232662, 'rsi': 57.78778513654212, 'macd': 185214.1513416469, 'signal_line': 200452.99318767656, 'BB_Upper': 85075988.18843281, 'BB_Lower': 84279111.81156719}
2024-09-20 03:26:54 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:26:54 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84677550.0         0         0
2024-09-20 03:26:54 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84677550.0         0         0
2024-09-20 03:26:54 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:26:54 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:26:54 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:26:54 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:26:54 - INFO - Attempting prediction for prophet
2024-09-20 03:26:54 - INFO - PROPHET prediction: 84856463.06498688
2024-09-20 03:26:54 - INFO - Attempting prediction for transformer
2024-09-20 03:26:54 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:26:54 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:26:54 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:26:54 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:26:54 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:26:54 - INFO - X 샘플:
[[-1.03528137e+00 -5.34879639e-01 -1.99948930e-01  2.46248070e-01
   2.30637496e+00  2.30428918e+00  2.46248070e-01  2.46248070e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.46248070e-01
   2.46248070e-01]
 [ 7.08710369e-01  1.06243216e+00  1.18745181e+00  9.56430593e-01
   1.21851525e+00  1.22135567e+00  9.56430593e-01  9.56430593e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.56430593e-01
   9.56430593e-01]
 [ 6.91612411e-01 -4.61608455e-01 -1.51253884e+00 -1.22043323e+00
   1.39134288e-03 -1.09178919e-03 -1.22043323e+00 -1.22043323e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.22043323e+00
  -1.22043323e+00]
 [-9.83987496e-01 -1.88306941e+00 -1.45132999e+00 -2.11588075e+00
  -4.63298265e-01 -4.65243825e-01 -2.11588075e+00 -2.11588075e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.11588075e+00
  -2.11588075e+00]
 [-1.98421805e+00 -1.01846945e+00 -1.18609161e+00  1.07299316e-01
  -7.70376469e-01 -7.70827930e-01  1.07299316e-01  1.07299316e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.07299316e-01
   1.07299316e-01]
 [ 1.03357158e+00  1.06243216e+00  1.20785476e+00  1.18801185e+00
   5.64440366e-01  5.66894773e-01  1.18801185e+00  1.18801185e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.18801185e+00
   1.18801185e+00]
 [ 1.28149197e+00  1.04777792e+00  9.49417367e-01  8.40639964e-01
  -7.93929083e-01 -7.93075561e-01  8.40639964e-01  8.40639964e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.40639964e-01
   8.40639964e-01]
 [ 5.46279766e-01  1.01846945e+00  5.20955375e-01  7.09410585e-01
  -7.88170386e-01 -7.87481509e-01  7.09410585e-01  7.09410585e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.09410585e-01
   7.09410585e-01]
 [-1.29089585e-01 -6.37459296e-01  2.48916015e-01 -6.49199458e-01
  -6.86734735e-01 -6.86732957e-01 -6.49199458e-01 -6.49199458e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -6.49199458e-01
  -6.49199458e-01]
 [-1.29089585e-01  3.44374562e-01  2.35314047e-01 -6.25269395e-02
  -5.88212986e-01 -5.88086050e-01 -6.25269395e-02 -6.25269395e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -6.25269395e-02
  -6.25269395e-02]]
2024-09-20 03:26:54 - INFO - y 샘플:
[-0.06252694]
2024-09-20 03:26:54 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:26:54 - INFO - 모델 출력 (스케일링된 예측): [0.48013857]
2024-09-20 03:26:54 - INFO - 스케일러 역변환 후 예측 가격: 84906299.1488736
2024-09-20 03:26:54 - INFO - TransformerPredictor 최종 예측 가격: 84906299.1488736
2024-09-20 03:26:54 - INFO - TRANSFORMER prediction: 84906299.1488736
2024-09-20 03:26:54 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:26:54 - INFO - BITCOIN_FORECAST prediction: 83187843.18666312
2024-09-20 03:26:54 - INFO - BitcoinForecast prediction: 83187843.18666312
2024-09-20 03:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:27:03 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:27:03 - INFO - 조정된 모델 가중치: {'gpt': 0.003975862743652707, 'ml': 0.10934272538448182, 'xgboost': 0.06691627052873227, 'rl': 0.35750676864930236, 'lstm': 0.03723266281695025, 'arima': 0.06391462030275898, 'prophet': 0.18389527574189732, 'transformer': 0.06943684398171247, 'bitcoin_forecast': 0.10777896985051182}
2024-09-20 03:27:03 - INFO - 조정된 모델 가중치: {'gpt': 0.003975862743652707, 'ml': 0.10934272538448182, 'xgboost': 0.06691627052873227, 'rl': 0.35750676864930236, 'lstm': 0.03723266281695025, 'arima': 0.06391462030275898, 'prophet': 0.18389527574189732, 'transformer': 0.06943684398171247, 'bitcoin_forecast': 0.10777896985051182}
2024-09-20 03:27:03 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84997577.70969322, 'current_price': 84836000.0, 'predictions': {'gpt': 84836000.0, 'ml': 85005672.0, 'xgboost': 84836000.0, 'lstm': 84869440.78434691, 'rl': 85684360.0, 'arima': 84953000.0, 'prophet': 84856463.06498688, 'transformer': 84906299.1488736, 'bitcoin_forecast': 83187843.18666312}, 'weights': {'gpt': 0.003975862743652707, 'ml': 0.10934272538448182, 'xgboost': 0.06691627052873227, 'rl': 0.35750676864930236, 'lstm': 0.03723266281695025, 'arima': 0.06391462030275898, 'prophet': 0.18389527574189732, 'transformer': 0.06943684398171247, 'bitcoin_forecast': 0.10777896985051182}}
2024-09-20 03:27:03 - INFO - 모델별 가중치:
2024-09-20 03:27:03 - INFO -   - GPT: 0.0040
2024-09-20 03:27:03 - INFO -   - ML: 0.1093
2024-09-20 03:27:03 - INFO -   - XGBOOST: 0.0669
2024-09-20 03:27:03 - INFO -   - RL: 0.3575
2024-09-20 03:27:03 - INFO -   - LSTM: 0.0372
2024-09-20 03:27:03 - INFO -   - ARIMA: 0.0639
2024-09-20 03:27:03 - INFO -   - PROPHET: 0.1839
2024-09-20 03:27:03 - INFO -   - TRANSFORMER: 0.0694
2024-09-20 03:27:03 - INFO -   - BITCOIN_FORECAST: 0.1078
2024-09-20 03:27:03 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:27:03 - INFO - 6. 거래 실행
2024-09-20 03:27:03 - INFO - Cancelling existing orders.
2024-09-20 03:27:03 - INFO - Cancelled 0 orders.
2024-09-20 03:27:03 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84997577.70969322, 'current_price': 84836000.0, 'predictions': {'gpt': 84836000.0, 'ml': 85005672.0, 'xgboost': 84836000.0, 'lstm': 84869440.78434691, 'rl': 85684360.0, 'arima': 84953000.0, 'prophet': 84856463.06498688, 'transformer': 84906299.1488736, 'bitcoin_forecast': 83187843.18666312}, 'weights': {'gpt': 0.003975862743652707, 'ml': 0.10934272538448182, 'xgboost': 0.06691627052873227, 'rl': 0.35750676864930236, 'lstm': 0.03723266281695025, 'arima': 0.06391462030275898, 'prophet': 0.18389527574189732, 'transformer': 0.06943684398171247, 'bitcoin_forecast': 0.10777896985051182}}, 현재 가격=84836000.0
2024-09-20 03:27:03 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480217.13449024
2024-09-20 03:27:03 - INFO - 매수 시도: 0.0005501448494771088 BTC (약 46672.08845024 KRW)
2024-09-20 03:27:03 - INFO - 주문 결과: None
2024-09-20 03:27:03 - ERROR - 주문 실패
2024-09-20 03:27:03 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:27:03 - INFO - 7. summary 리포트 보내기
2024-09-20 03:27:04 - INFO - Message sent to Discord successfully.
2024-09-20 03:27:04 - INFO - Trading cycle completed.
2024-09-20 03:27:04 - INFO - Performing periodic update.
2024-09-20 03:27:04 - INFO - 계산된 시장 변동성: 0.02630784899287862
2024-09-20 03:35:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:35:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cf-9e29-f524a1c599b4 "HTTP/1.1 200 OK"
2024-09-20 03:35:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:35:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:35:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-aec1-dd73ed8a9031 "HTTP/1.1 200 OK"
2024-09-20 03:35:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:35:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:35:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-87c8-e70fa0c3597e "HTTP/1.1 200 OK"
2024-09-20 03:35:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f7-8a77-da9de7ce6302 "HTTP/1.1 200 OK"
2024-09-20 03:36:12 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-8412-dae518f4498c "HTTP/1.1 200 OK"
2024-09-20 03:36:19 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-a27f-e845050310a5 "HTTP/1.1 200 OK"
2024-09-20 03:36:25 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8116-b0dd-ee83f95968e2 "HTTP/1.1 200 OK"
2024-09-20 03:36:33 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815e-9b16-ecfb2b6fc259 "HTTP/1.1 200 OK"
2024-09-20 03:36:47 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:36:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/320306be-0282-4d67-9dd8-001c2af4056d "HTTP/1.1 200 OK"
2024-09-20 03:36:58 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:25:34.956076
2024-09-20 03:36:58 - INFO - Starting trading cycle.
2024-09-20 03:36:58 - INFO - ##################################################
2024-09-20 03:36:58 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-20 03:36:58 - INFO - ##################################################
2024-09-20 03:36:58 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:36:58 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:36:58 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:20:00
2024-09-20 03:36:58 - INFO - 새로운 데이터 범위: 2024-09-18 18:20:00 ~ 2024-09-20 03:30:00
2024-09-20 03:36:58 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:36:58 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:36:58 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:36:58 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:36:58 - INFO - Sample date values: [Timestamp('2024-09-20 03:30:00')]
2024-09-20 03:36:59 - INFO - Successfully added 1 new data points
2024-09-20 03:36:59 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:36:59 - INFO - Final date range: 2024-09-20 03:30:00 to 2024-09-20 03:30:00
2024-09-20 03:36:59 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:36:59 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:30:00
2024-09-20 03:36:59 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:36:59 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:36:59 - INFO - GPT | 이전예측가격: 84836000 | 당시BTC가격: 84836000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:36:59 - INFO - ML 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 03:36:59 - INFO - ML | 이전예측가격: 85005672 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2051 | 반영가중치값: 0.0200 | 새 가중치: 0.2251 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 03:36:59 - INFO - XGBOOST | 이전예측가격: 84836000 | 당시BTC가격: 84836000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:36:59 - INFO - LSTM 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-20 03:36:59 - INFO - LSTM | 이전예측가격: 84869441 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1445 | 반영가중치값: 0.0200 | 새 가중치: 0.1645 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-20 03:36:59 - INFO - RL 모델 예측 업데이트: 정확도 64.62%, 적중/전체: 42/65
2024-09-20 03:36:59 - INFO - RL | 이전예측가격: 85684360 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1870 | 반영가중치값: 0.0200 | 새 가중치: 0.2070 | 예측 총 횟수: 65 | 예측 성공 수: 42 | 예측 성공률: 64.62%
2024-09-20 03:36:59 - INFO - ARIMA 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-20 03:36:59 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0335 | 반영가중치값: 0.0200 | 새 가중치: 0.0535 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-20 03:36:59 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.33%, 적중/전체: 38/60
2024-09-20 03:36:59 - INFO - PROPHET | 이전예측가격: 84856463 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1357 | 반영가중치값: 0.0200 | 새 가중치: 0.1557 | 예측 총 횟수: 60 | 예측 성공 수: 38 | 예측 성공률: 63.33%
2024-09-20 03:36:59 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 15/24
2024-09-20 03:36:59 - INFO - TRANSFORMER | 이전예측가격: 84906299 | 당시BTC가격: 84836000 | 예측: 상승 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1715 | 반영가중치값: 0.0200 | 새 가중치: 0.1915 | 예측 총 횟수: 24 | 예측 성공 수: 15 | 예측 성공률: 62.50%
2024-09-20 03:36:59 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 03:36:59 - INFO - BITCOIN_FORECAST | 이전예측가격: 83187843 | 당시BTC가격: 84836000 | 예측: 하락 | 지금 BTC가격: 84890000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0446 | 반영가중치값: -0.0200 | 새 가중치: 0.0246 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 03:36:59 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:36:59 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:36:59 - INFO - 새로운 가중치: {'gpt': 0.00363829775416808, 'ml': 0.20598332388368956, 'xgboost': 0.06123483944979381, 'rl': 0.1893853933533035, 'lstm': 0.15051478575955374, 'arima': 0.04893688951513354, 'prophet': 0.14251246277654556, 'transformer': 0.1752624247359252, 'bitcoin_forecast': 0.022531582771887024}
2024-09-20 03:36:59 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:36:59 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:36:59 - INFO - Current BTC price: 84890000.0
2024-09-20 03:36:59 - INFO - Analyzing market conditions.
2024-09-20 03:36:59 - INFO - Market analysis: {'current_price': 84890000.0, 'sma_20': 84697950.0, 'rsi_14': 59.14747743480922, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:36:59 - INFO - Starting predictions for all models
2024-09-20 03:36:59 - INFO - Attempting prediction for gpt
2024-09-20 03:37:00 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:37:00 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:37:00 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:37:00 - INFO - GPT prediction: 84890000.0
2024-09-20 03:37:00 - INFO - Attempting prediction for ml
2024-09-20 03:37:00 - INFO - ML prediction: 85042802.0
2024-09-20 03:37:00 - INFO - Attempting prediction for xgboost
2024-09-20 03:37:00 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:37:00 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:37:00 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:37:00 - INFO - XGBOOST prediction: 84890000.0
2024-09-20 03:37:00 - INFO - Attempting prediction for lstm
2024-09-20 03:37:00 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:37:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:37:00 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:37:00 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:37:00 - INFO - X 샘플:
[[ 0.62277005  0.98665883  1.06809692  0.94262428  2.30821607  2.30939229
   0.94262428]
 [ 0.6045604  -0.55638656 -1.57386244 -1.22733528  0.47948501  0.47480684
  -1.22733528]
 [-1.17998536 -1.99557312 -1.51396916 -2.11994276 -0.21871204 -0.22176835
  -2.11994276]
 [-2.24524991 -1.1201916  -1.25443159  0.09618615 -0.68009764 -0.68037305
   0.09618615]
 [ 0.96875341  0.98665883  1.08806135  1.17347104  1.32546727  1.32721147
   1.17347104]
 [ 1.23279334  0.97182186  0.83517859  0.8272009  -0.71548549 -0.71376113
   0.8272009 ]
 [ 0.44977837  0.94214791  0.41592559  0.69638773 -0.70683304 -0.70536587
   0.69638773]
 [-0.26950283 -0.73443026  0.14973321 -0.65791327 -0.55442578 -0.55416769
  -0.65791327]
 [-0.26950283  0.25964706  0.13642359 -0.07310147 -0.40639665 -0.40612356
  -0.07310147]
 [ 0.08558536  0.25964706  0.64884392  0.3424227  -0.83121769 -0.82985095
   0.3424227 ]]
2024-09-20 03:37:00 - INFO - y 샘플:
[0.3424227]
2024-09-20 03:37:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:37:00 - INFO - 모델 출력 (스케일링된 예측): [[0.20752572]]
2024-09-20 03:37:00 - INFO - 스케일러 역변환 후 예측 가격: 84872469.28216293
2024-09-20 03:37:00 - INFO - LSTMPredictor 최종 예측 가격: 84872469.28216293
2024-09-20 03:37:00 - INFO - LSTM prediction: 84872469.28216293
2024-09-20 03:37:00 - INFO - Attempting prediction for rl
2024-09-20 03:37:00 - INFO - Preparing state for RL agent.
2024-09-20 03:37:00 - INFO - Prepared state: [[8.48900000e+07 5.18815919e+00 6.36522231e-04 8.46979500e+07
  5.91474774e+01]]
2024-09-20 03:37:00 - INFO - RL prediction: 85738900.0
2024-09-20 03:37:00 - INFO - Attempting prediction for arima
2024-09-20 03:37:00 - INFO - ARIMA 예측 시작
2024-09-20 03:37:00 - INFO - 입력 데이터: {'open': 84839000.0, 'high': 84951000.0, 'low': 84835000.0, 'close': 84890000.0, 'volume': 5.18815919, 'value': 440397365.54085, 'decision': 'sell', 'sma': 84697950.0, 'ema': 84701164.44877172, 'rsi': 59.14747743480922, 'macd': 180046.6463433653, 'signal_line': 196371.72381881432, 'BB_Upper': 85096029.62771037, 'BB_Lower': 84299870.37228963}
2024-09-20 03:37:00 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:37:00 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84697950.0         0         0
2024-09-20 03:37:00 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84697950.0         0         0
2024-09-20 03:37:00 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:37:00 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:37:00 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:37:00 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:37:00 - INFO - Attempting prediction for prophet
2024-09-20 03:37:00 - INFO - PROPHET prediction: 84915555.23497774
2024-09-20 03:37:00 - INFO - Attempting prediction for transformer
2024-09-20 03:37:00 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:37:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:37:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:37:00 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:37:00 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:37:00 - INFO - X 샘플:
[[ 0.62277005  0.98665883  1.06809692  0.94262428  2.30821607  2.30939229
   0.94262428  0.94262428  0.          0.          0.          0.94262428
   0.94262428]
 [ 0.6045604  -0.55638656 -1.57386244 -1.22733528  0.47948501  0.47480684
  -1.22733528 -1.22733528  0.          0.          0.         -1.22733528
  -1.22733528]
 [-1.17998536 -1.99557312 -1.51396916 -2.11994276 -0.21871204 -0.22176835
  -2.11994276 -2.11994276  0.          0.          0.         -2.11994276
  -2.11994276]
 [-2.24524991 -1.1201916  -1.25443159  0.09618615 -0.68009764 -0.68037305
   0.09618615  0.09618615  0.          0.          0.          0.09618615
   0.09618615]
 [ 0.96875341  0.98665883  1.08806135  1.17347104  1.32546727  1.32721147
   1.17347104  1.17347104  0.          0.          0.          1.17347104
   1.17347104]
 [ 1.23279334  0.97182186  0.83517859  0.8272009  -0.71548549 -0.71376113
   0.8272009   0.8272009   0.          0.          0.          0.8272009
   0.8272009 ]
 [ 0.44977837  0.94214791  0.41592559  0.69638773 -0.70683304 -0.70536587
   0.69638773  0.69638773  0.          0.          0.          0.69638773
   0.69638773]
 [-0.26950283 -0.73443026  0.14973321 -0.65791327 -0.55442578 -0.55416769
  -0.65791327 -0.65791327  0.          0.          0.         -0.65791327
  -0.65791327]
 [-0.26950283  0.25964706  0.13642359 -0.07310147 -0.40639665 -0.40612356
  -0.07310147 -0.07310147  0.          0.          0.         -0.07310147
  -0.07310147]
 [ 0.08558536  0.25964706  0.64884392  0.3424227  -0.83121769 -0.82985095
   0.3424227   0.3424227   0.          0.          0.          0.3424227
   0.3424227 ]]
2024-09-20 03:37:00 - INFO - y 샘플:
[0.3424227]
2024-09-20 03:37:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:37:00 - INFO - 모델 출력 (스케일링된 예측): [0.47929302]
2024-09-20 03:37:00 - INFO - 스케일러 역변환 후 예측 가격: 84907787.1659175
2024-09-20 03:37:00 - INFO - TransformerPredictor 최종 예측 가격: 84907787.1659175
2024-09-20 03:37:00 - INFO - TRANSFORMER prediction: 84907787.1659175
2024-09-20 03:37:00 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:37:00 - INFO - BITCOIN_FORECAST prediction: 83116425.78129783
2024-09-20 03:37:00 - INFO - BitcoinForecast prediction: 83116425.78129783
2024-09-20 03:37:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:05 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:37:06 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:37:06 - INFO - 조정된 모델 가중치: {'gpt': 0.00363829775416808, 'ml': 0.20598332388368956, 'xgboost': 0.06123483944979381, 'rl': 0.1893853933533035, 'lstm': 0.15051478575955374, 'arima': 0.04893688951513354, 'prophet': 0.14251246277654556, 'transformer': 0.1752624247359252, 'bitcoin_forecast': 0.022531582771887024}
2024-09-20 03:37:06 - INFO - 조정된 모델 가중치: {'gpt': 0.00363829775416808, 'ml': 0.20598332388368956, 'xgboost': 0.06123483944979381, 'rl': 0.1893853933533035, 'lstm': 0.15051478575955374, 'arima': 0.04893688951513354, 'prophet': 0.14251246277654556, 'transformer': 0.1752624247359252, 'bitcoin_forecast': 0.022531582771887024}
2024-09-20 03:37:06 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85049486.24306431, 'current_price': 84890000.0, 'predictions': {'gpt': 84890000.0, 'ml': 85042802.0, 'xgboost': 84890000.0, 'lstm': 84872469.28216293, 'rl': 85738900.0, 'arima': 84953000.0, 'prophet': 84915555.23497774, 'transformer': 84907787.1659175, 'bitcoin_forecast': 83116425.78129783}, 'weights': {'gpt': 0.00363829775416808, 'ml': 0.20598332388368956, 'xgboost': 0.06123483944979381, 'rl': 0.1893853933533035, 'lstm': 0.15051478575955374, 'arima': 0.04893688951513354, 'prophet': 0.14251246277654556, 'transformer': 0.1752624247359252, 'bitcoin_forecast': 0.022531582771887024}}
2024-09-20 03:37:06 - INFO - 모델별 가중치:
2024-09-20 03:37:06 - INFO -   - GPT: 0.0036
2024-09-20 03:37:06 - INFO -   - ML: 0.2060
2024-09-20 03:37:06 - INFO -   - XGBOOST: 0.0612
2024-09-20 03:37:06 - INFO -   - RL: 0.1894
2024-09-20 03:37:06 - INFO -   - LSTM: 0.1505
2024-09-20 03:37:06 - INFO -   - ARIMA: 0.0489
2024-09-20 03:37:06 - INFO -   - PROPHET: 0.1425
2024-09-20 03:37:06 - INFO -   - TRANSFORMER: 0.1753
2024-09-20 03:37:06 - INFO -   - BITCOIN_FORECAST: 0.0225
2024-09-20 03:37:06 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:37:06 - INFO - 6. 거래 실행
2024-09-20 03:37:06 - INFO - Cancelling existing orders.
2024-09-20 03:37:06 - INFO - Cancelled 0 orders.
2024-09-20 03:37:06 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85049486.24306431, 'current_price': 84890000.0, 'predictions': {'gpt': 84890000.0, 'ml': 85042802.0, 'xgboost': 84890000.0, 'lstm': 84872469.28216293, 'rl': 85738900.0, 'arima': 84953000.0, 'prophet': 84915555.23497774, 'transformer': 84907787.1659175, 'bitcoin_forecast': 83116425.78129783}, 'weights': {'gpt': 0.00363829775416808, 'ml': 0.20598332388368956, 'xgboost': 0.06123483944979381, 'rl': 0.1893853933533035, 'lstm': 0.15051478575955374, 'arima': 0.04893688951513354, 'prophet': 0.14251246277654556, 'transformer': 0.1752624247359252, 'bitcoin_forecast': 0.022531582771887024}}, 현재 가격=84890000.0
2024-09-20 03:37:06 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480493.09555024
2024-09-20 03:37:06 - INFO - 매수 시도: 0.0005497948928052775 BTC (약 46672.08845024 KRW)
2024-09-20 03:37:06 - INFO - 주문 결과: None
2024-09-20 03:37:06 - ERROR - 주문 실패
2024-09-20 03:37:06 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:37:06 - INFO - 7. summary 리포트 보내기
2024-09-20 03:37:07 - INFO - Message sent to Discord successfully.
2024-09-20 03:37:07 - INFO - Trading cycle completed.
2024-09-20 03:37:07 - INFO - Performing periodic update.
2024-09-20 03:37:07 - INFO - 계산된 시장 변동성: 0.02610556379950338
2024-09-20 03:45:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8173-9a1a-f6b69b37c237 "HTTP/1.1 200 OK"
2024-09-20 03:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:45:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fc-be1b-f1633c324217 "HTTP/1.1 200 OK"
2024-09-20 03:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:45:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/04dd7838-e561-43da-ae0d-ce81d78fe427 "HTTP/1.1 200 OK"
2024-09-20 03:45:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8102ccf4-1111-44b2-8c17-0eb8012a5478 "HTTP/1.1 200 OK"
2024-09-20 03:46:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815c-857d-f2a70dc046db "HTTP/1.1 200 OK"
2024-09-20 03:46:16 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ee-9134-f8e80d67126f "HTTP/1.1 200 OK"
2024-09-20 03:46:24 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9804-d68111b60e76 "HTTP/1.1 200 OK"
2024-09-20 03:46:32 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a8-b77e-e9d8f874f700 "HTTP/1.1 200 OK"
2024-09-20 03:46:39 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:46:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5b17726c-3a5d-468b-9b0c-87f1b822483e "HTTP/1.1 200 OK"
2024-09-20 03:46:44 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:35:34.956640
2024-09-20 03:46:44 - INFO - Starting trading cycle.
2024-09-20 03:46:44 - INFO - ##################################################
2024-09-20 03:46:44 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-20 03:46:44 - INFO - ##################################################
2024-09-20 03:46:44 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:46:44 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:46:44 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:30:00
2024-09-20 03:46:44 - INFO - 새로운 데이터 범위: 2024-09-18 18:30:00 ~ 2024-09-20 03:40:00
2024-09-20 03:46:44 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:46:44 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:46:44 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:46:44 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:46:44 - INFO - Sample date values: [Timestamp('2024-09-20 03:40:00')]
2024-09-20 03:46:44 - INFO - Successfully added 1 new data points
2024-09-20 03:46:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:46:44 - INFO - Final date range: 2024-09-20 03:40:00 to 2024-09-20 03:40:00
2024-09-20 03:46:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:46:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:40:00
2024-09-20 03:46:44 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:46:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:46:44 - INFO - GPT | 이전예측가격: 84890000 | 당시BTC가격: 84890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:46:44 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 03:46:44 - INFO - ML | 이전예측가격: 85042802 | 당시BTC가격: 84890000 | 예측: 상승 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1093 | 반영가중치값: 0.0200 | 새 가중치: 0.1293 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 03:46:44 - INFO - XGBOOST | 이전예측가격: 84890000 | 당시BTC가격: 84890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:46:44 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 15/25
2024-09-20 03:46:44 - INFO - LSTM | 이전예측가격: 84872469 | 당시BTC가격: 84890000 | 예측: 하락 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0372 | 반영가중치값: -0.0200 | 새 가중치: 0.0172 | 예측 총 횟수: 25 | 예측 성공 수: 15 | 예측 성공률: 60.00%
2024-09-20 03:46:44 - INFO - RL 모델 예측 업데이트: 정확도 65.15%, 적중/전체: 43/66
2024-09-20 03:46:44 - INFO - RL | 이전예측가격: 85738900 | 당시BTC가격: 84890000 | 예측: 상승 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3575 | 반영가중치값: 0.0200 | 새 가중치: 0.3775 | 예측 총 횟수: 66 | 예측 성공 수: 43 | 예측 성공률: 65.15%
2024-09-20 03:46:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 80.00%, 적중/전체: 4/5
2024-09-20 03:46:45 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84890000 | 예측: 상승 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0639 | 반영가중치값: 0.0200 | 새 가중치: 0.0839 | 예측 총 횟수: 5 | 예측 성공 수: 4 | 예측 성공률: 80.00%
2024-09-20 03:46:45 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.93%, 적중/전체: 39/61
2024-09-20 03:46:45 - INFO - PROPHET | 이전예측가격: 84915555 | 당시BTC가격: 84890000 | 예측: 상승 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1839 | 반영가중치값: 0.0200 | 새 가중치: 0.2039 | 예측 총 횟수: 61 | 예측 성공 수: 39 | 예측 성공률: 63.93%
2024-09-20 03:46:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 64.00%, 적중/전체: 16/25
2024-09-20 03:46:45 - INFO - TRANSFORMER | 이전예측가격: 84907787 | 당시BTC가격: 84890000 | 예측: 상승 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0694 | 반영가중치값: 0.0200 | 새 가중치: 0.0894 | 예측 총 횟수: 25 | 예측 성공 수: 16 | 예측 성공률: 64.00%
2024-09-20 03:46:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-20 03:46:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 83116426 | 당시BTC가격: 84890000 | 예측: 하락 | 지금 BTC가격: 84929000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1078 | 반영가중치값: -0.0200 | 새 가중치: 0.0878 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-20 03:46:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:46:45 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:46:45 - INFO - 새로운 가중치: {'gpt': 0.0034519576165001485, 'ml': 0.12271826997071628, 'xgboost': 0.05809861773729757, 'rl': 0.358172269937618, 'lstm': 0.016350069643256086, 'arima': 0.07961682420246599, 'prophet': 0.19345251478093425, 'transformer': 0.08485622003441591, 'bitcoin_forecast': 0.08328325607679578}
2024-09-20 03:46:45 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:46:45 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:46:45 - INFO - Current BTC price: 84929000.0
2024-09-20 03:46:45 - INFO - Analyzing market conditions.
2024-09-20 03:46:45 - INFO - Market analysis: {'current_price': 84929000.0, 'sma_20': 84726300.0, 'rsi_14': 60.14593733465893, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:46:45 - INFO - Starting predictions for all models
2024-09-20 03:46:45 - INFO - Attempting prediction for gpt
2024-09-20 03:46:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:46:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:46:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:46:45 - INFO - GPT prediction: 84929000.0
2024-09-20 03:46:45 - INFO - Attempting prediction for ml
2024-09-20 03:46:45 - INFO - ML prediction: 85132829.6
2024-09-20 03:46:45 - INFO - Attempting prediction for xgboost
2024-09-20 03:46:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:46:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:46:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:46:45 - INFO - XGBOOST prediction: 84929000.0
2024-09-20 03:46:45 - INFO - Attempting prediction for lstm
2024-09-20 03:46:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:46:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:46:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:46:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:46:45 - INFO - X 샘플:
[[ 0.52827155 -0.54829973 -1.57294638 -1.22744238  1.13438351  1.12778167
  -1.22744238]
 [-1.1803295  -2.00942814 -1.51313853 -2.14250225  0.04265513  0.03782983
  -2.14250225]
 [-2.20025971 -1.12070055 -1.25397119  0.12937053 -0.67878555 -0.67976254
   0.12937053]
 [ 0.87696564  1.01827093  1.08518016  1.23375314  2.45719465  2.46156446
   1.23375314]
 [ 1.12976885  1.00320775  0.83265814  0.87877301 -0.73411938 -0.73200586
   0.87877301]
 [ 0.38007656  0.97308139  0.41400321  0.74466941 -0.72059006 -0.71886955
   0.74466941]
 [-0.30859427 -0.72905788  0.14819055 -0.64369729 -0.48228007 -0.48228528
  -0.64369729]
 [-0.30859427  0.28017514  0.13489992 -0.0441753  -0.25081591 -0.25063623
  -0.0441753 ]
 [ 0.03138247  0.28017514  0.64658928  0.38180084 -0.9150828  -0.91365505
   0.38180084]
 [ 1.05131268  0.85257596  1.07853484  0.68945028  0.14744049  0.15003857
   0.68945028]]
2024-09-20 03:46:45 - INFO - y 샘플:
[0.68945028]
2024-09-20 03:46:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:46:45 - INFO - 모델 출력 (스케일링된 예측): [[0.32535648]]
2024-09-20 03:46:45 - INFO - 스케일러 역변환 후 예측 가격: 84882844.68055922
2024-09-20 03:46:45 - INFO - LSTMPredictor 최종 예측 가격: 84882844.68055922
2024-09-20 03:46:45 - INFO - LSTM prediction: 84882844.68055922
2024-09-20 03:46:45 - INFO - Attempting prediction for rl
2024-09-20 03:46:45 - INFO - Preparing state for RL agent.
2024-09-20 03:46:45 - INFO - Prepared state: [[8.49290000e+07 1.13805170e+01 4.59418070e-04 8.47263000e+07
  6.01459373e+01]]
2024-09-20 03:46:45 - INFO - RL prediction: 85778290.0
2024-09-20 03:46:45 - INFO - Attempting prediction for arima
2024-09-20 03:46:45 - INFO - ARIMA 예측 시작
2024-09-20 03:46:45 - INFO - 입력 데이터: {'open': 84956000.0, 'high': 84989000.0, 'low': 84900000.0, 'close': 84929000.0, 'volume': 11.38051703, 'value': 966879340.66897, 'decision': 'sell', 'sma': 84726300.0, 'ema': 84722863.07269822, 'rsi': 60.14593733465893, 'macd': 177057.32879379392, 'signal_line': 192508.84481381025, 'BB_Upper': 85104924.93314838, 'BB_Lower': 84347675.06685162}
2024-09-20 03:46:45 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:46:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84726300.0         0         0
2024-09-20 03:46:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84726300.0         0         0
2024-09-20 03:46:45 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:46:45 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:46:45 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:46:45 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:46:45 - INFO - Attempting prediction for prophet
2024-09-20 03:46:45 - INFO - PROPHET prediction: 84963276.82040645
2024-09-20 03:46:45 - INFO - Attempting prediction for transformer
2024-09-20 03:46:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:46:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:46:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:46:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:46:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:46:45 - INFO - X 샘플:
[[ 0.52827155 -0.54829973 -1.57294638 -1.22744238  1.13438351  1.12778167
  -1.22744238 -1.22744238  0.          0.          0.         -1.22744238
  -1.22744238]
 [-1.1803295  -2.00942814 -1.51313853 -2.14250225  0.04265513  0.03782983
  -2.14250225 -2.14250225  0.          0.          0.         -2.14250225
  -2.14250225]
 [-2.20025971 -1.12070055 -1.25397119  0.12937053 -0.67878555 -0.67976254
   0.12937053  0.12937053  0.          0.          0.          0.12937053
   0.12937053]
 [ 0.87696564  1.01827093  1.08518016  1.23375314  2.45719465  2.46156446
   1.23375314  1.23375314  0.          0.          0.          1.23375314
   1.23375314]
 [ 1.12976885  1.00320775  0.83265814  0.87877301 -0.73411938 -0.73200586
   0.87877301  0.87877301  0.          0.          0.          0.87877301
   0.87877301]
 [ 0.38007656  0.97308139  0.41400321  0.74466941 -0.72059006 -0.71886955
   0.74466941  0.74466941  0.          0.          0.          0.74466941
   0.74466941]
 [-0.30859427 -0.72905788  0.14819055 -0.64369729 -0.48228007 -0.48228528
  -0.64369729 -0.64369729  0.          0.          0.         -0.64369729
  -0.64369729]
 [-0.30859427  0.28017514  0.13489992 -0.0441753  -0.25081591 -0.25063623
  -0.0441753  -0.0441753   0.          0.          0.         -0.0441753
  -0.0441753 ]
 [ 0.03138247  0.28017514  0.64658928  0.38180084 -0.9150828  -0.91365505
   0.38180084  0.38180084  0.          0.          0.          0.38180084
   0.38180084]
 [ 1.05131268  0.85257596  1.07853484  0.68945028  0.14744049  0.15003857
   0.68945028  0.68945028  0.          0.          0.          0.68945028
   0.68945028]]
2024-09-20 03:46:45 - INFO - y 샘플:
[0.68945028]
2024-09-20 03:46:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:46:45 - INFO - 모델 출력 (스케일링된 예측): [0.47999915]
2024-09-20 03:46:45 - INFO - 스케일러 역변환 후 예측 가격: 84902448.37037262
2024-09-20 03:46:45 - INFO - TransformerPredictor 최종 예측 가격: 84902448.37037262
2024-09-20 03:46:45 - INFO - TRANSFORMER prediction: 84902448.37037262
2024-09-20 03:46:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:46:45 - INFO - BITCOIN_FORECAST prediction: 83220590.11960681
2024-09-20 03:46:45 - INFO - BitcoinForecast prediction: 83220590.11960681
2024-09-20 03:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:47:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:47:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:47:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:47:13 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:47:13 - INFO - 조정된 모델 가중치: {'gpt': 0.0034519576165001485, 'ml': 0.12271826997071628, 'xgboost': 0.05809861773729757, 'rl': 0.358172269937618, 'lstm': 0.016350069643256086, 'arima': 0.07961682420246599, 'prophet': 0.19345251478093425, 'transformer': 0.08485622003441591, 'bitcoin_forecast': 0.08328325607679578}
2024-09-20 03:47:13 - INFO - 조정된 모델 가중치: {'gpt': 0.0034519576165001485, 'ml': 0.12271826997071628, 'xgboost': 0.05809861773729757, 'rl': 0.358172269937618, 'lstm': 0.016350069643256086, 'arima': 0.07961682420246599, 'prophet': 0.19345251478093425, 'transformer': 0.08485622003441591, 'bitcoin_forecast': 0.08328325607679578}
2024-09-20 03:47:13 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 85121457.8327372, 'current_price': 84929000.0, 'predictions': {'gpt': 84929000.0, 'ml': 85132829.6, 'xgboost': 84929000.0, 'lstm': 84882844.68055922, 'rl': 85778290.0, 'arima': 84953000.0, 'prophet': 84963276.82040645, 'transformer': 84902448.37037262, 'bitcoin_forecast': 83220590.11960681}, 'weights': {'gpt': 0.0034519576165001485, 'ml': 0.12271826997071628, 'xgboost': 0.05809861773729757, 'rl': 0.358172269937618, 'lstm': 0.016350069643256086, 'arima': 0.07961682420246599, 'prophet': 0.19345251478093425, 'transformer': 0.08485622003441591, 'bitcoin_forecast': 0.08328325607679578}}
2024-09-20 03:47:13 - INFO - 모델별 가중치:
2024-09-20 03:47:13 - INFO -   - GPT: 0.0035
2024-09-20 03:47:13 - INFO -   - ML: 0.1227
2024-09-20 03:47:13 - INFO -   - XGBOOST: 0.0581
2024-09-20 03:47:13 - INFO -   - RL: 0.3582
2024-09-20 03:47:13 - INFO -   - LSTM: 0.0164
2024-09-20 03:47:13 - INFO -   - ARIMA: 0.0796
2024-09-20 03:47:13 - INFO -   - PROPHET: 0.1935
2024-09-20 03:47:13 - INFO -   - TRANSFORMER: 0.0849
2024-09-20 03:47:13 - INFO -   - BITCOIN_FORECAST: 0.0833
2024-09-20 03:47:13 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:47:13 - INFO - 6. 거래 실행
2024-09-20 03:47:13 - INFO - Cancelling existing orders.
2024-09-20 03:47:14 - INFO - Cancelled 0 orders.
2024-09-20 03:47:14 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 85121457.8327372, 'current_price': 84929000.0, 'predictions': {'gpt': 84929000.0, 'ml': 85132829.6, 'xgboost': 84929000.0, 'lstm': 84882844.68055922, 'rl': 85778290.0, 'arima': 84953000.0, 'prophet': 84963276.82040645, 'transformer': 84902448.37037262, 'bitcoin_forecast': 83220590.11960681}, 'weights': {'gpt': 0.0034519576165001485, 'ml': 0.12271826997071628, 'xgboost': 0.05809861773729757, 'rl': 0.358172269937618, 'lstm': 0.016350069643256086, 'arima': 0.07961682420246599, 'prophet': 0.19345251478093425, 'transformer': 0.08485622003441591, 'bitcoin_forecast': 0.08328325607679578}}, 현재 가격=84929000.0
2024-09-20 03:47:14 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480692.40076024004
2024-09-20 03:47:14 - INFO - 매수 시도: 0.0005495424230856363 BTC (약 46672.08845024 KRW)
2024-09-20 03:47:14 - INFO - 주문 결과: None
2024-09-20 03:47:14 - ERROR - 주문 실패
2024-09-20 03:47:14 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:47:14 - INFO - 7. summary 리포트 보내기
2024-09-20 03:47:14 - INFO - Message sent to Discord successfully.
2024-09-20 03:47:14 - INFO - Trading cycle completed.
2024-09-20 03:47:14 - INFO - Performing periodic update.
2024-09-20 03:47:14 - INFO - 계산된 시장 변동성: 0.02591528901490049
2024-09-20 03:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:55:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8113-9170-ed9c0c4e8b50 "HTTP/1.1 200 OK"
2024-09-20 03:55:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/f7b6d552-197d-4c3a-86b1-40e2034fe279 "HTTP/1.1 200 OK"
2024-09-20 03:55:57 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/ccbe0f42-7982-4feb-895c-e45d062d6124 "HTTP/1.1 200 OK"
2024-09-20 03:56:04 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812f-bc09-c099a363ce48 "HTTP/1.1 200 OK"
2024-09-20 03:56:10 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-af85-efe900551d44 "HTTP/1.1 200 OK"
2024-09-20 03:56:15 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812b-9dac-edfd2f0c3e97 "HTTP/1.1 200 OK"
2024-09-20 03:56:21 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811e-a628-fbd6d342673f "HTTP/1.1 200 OK"
2024-09-20 03:56:29 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:56:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/27732fd8-5bb0-492a-9ff7-d6ecf2541c72 "HTTP/1.1 200 OK"
2024-09-20 03:56:34 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:56:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 03:57:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-8096-c3c00a4c37f8 "HTTP/1.1 200 OK"
2024-09-20 03:57:08 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:45:34.957186
2024-09-20 03:57:08 - INFO - Starting trading cycle.
2024-09-20 03:57:08 - INFO - ##################################################
2024-09-20 03:57:08 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-20 03:57:08 - INFO - ##################################################
2024-09-20 03:57:08 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 03:57:08 - INFO - 데이터베이스 업데이트 시작
2024-09-20 03:57:08 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:40:00
2024-09-20 03:57:08 - INFO - 새로운 데이터 범위: 2024-09-18 18:40:00 ~ 2024-09-20 03:50:00
2024-09-20 03:57:08 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 03:57:08 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 03:57:08 - INFO - Index: Index([199], dtype='int64')
2024-09-20 03:57:08 - INFO - Date column data type: datetime64[ns]
2024-09-20 03:57:08 - INFO - Sample date values: [Timestamp('2024-09-20 03:50:00')]
2024-09-20 03:57:09 - INFO - Successfully added 1 new data points
2024-09-20 03:57:09 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 03:57:09 - INFO - Final date range: 2024-09-20 03:50:00 to 2024-09-20 03:50:00
2024-09-20 03:57:09 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 03:57:09 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 03:50:00
2024-09-20 03:57:09 - INFO - 데이터베이스 업데이트 완료
2024-09-20 03:57:09 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 03:57:09 - INFO - GPT | 이전예측가격: 84929000 | 당시BTC가격: 84929000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:57:09 - INFO - ML 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-20 03:57:09 - INFO - ML | 이전예측가격: 85132830 | 당시BTC가격: 84929000 | 예측: 상승 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2060 | 반영가중치값: -0.0200 | 새 가중치: 0.1860 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-20 03:57:09 - INFO - XGBOOST | 이전예측가격: 84929000 | 당시BTC가격: 84929000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 03:57:09 - INFO - LSTM 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 16/26
2024-09-20 03:57:09 - INFO - LSTM | 이전예측가격: 84882845 | 당시BTC가격: 84929000 | 예측: 하락 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1505 | 반영가중치값: 0.0200 | 새 가중치: 0.1705 | 예측 총 횟수: 26 | 예측 성공 수: 16 | 예측 성공률: 61.54%
2024-09-20 03:57:09 - INFO - RL 모델 예측 업데이트: 정확도 64.18%, 적중/전체: 43/67
2024-09-20 03:57:09 - INFO - RL | 이전예측가격: 85778290 | 당시BTC가격: 84929000 | 예측: 상승 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1894 | 반영가중치값: -0.0200 | 새 가중치: 0.1694 | 예측 총 횟수: 67 | 예측 성공 수: 43 | 예측 성공률: 64.18%
2024-09-20 03:57:09 - INFO - ARIMA 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 03:57:09 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84929000 | 예측: 상승 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0489 | 반영가중치값: -0.0200 | 새 가중치: 0.0289 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 03:57:09 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.90%, 적중/전체: 39/62
2024-09-20 03:57:09 - INFO - PROPHET | 이전예측가격: 84963277 | 당시BTC가격: 84929000 | 예측: 상승 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1425 | 반영가중치값: -0.0200 | 새 가중치: 0.1225 | 예측 총 횟수: 62 | 예측 성공 수: 39 | 예측 성공률: 62.90%
2024-09-20 03:57:09 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 65.38%, 적중/전체: 17/26
2024-09-20 03:57:09 - INFO - TRANSFORMER | 이전예측가격: 84902448 | 당시BTC가격: 84929000 | 예측: 하락 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1753 | 반영가중치값: 0.0200 | 새 가중치: 0.1953 | 예측 총 횟수: 26 | 예측 성공 수: 17 | 예측 성공률: 65.38%
2024-09-20 03:57:09 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-20 03:57:09 - INFO - BITCOIN_FORECAST | 이전예측가격: 83220590 | 당시BTC가격: 84929000 | 예측: 하락 | 지금 BTC가격: 84873000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0225 | 반영가중치값: 0.0200 | 새 가중치: 0.0425 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-20 03:57:09 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 03:57:09 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 03:57:09 - INFO - 새로운 가중치: {'gpt': 0.0035343886135419974, 'ml': 0.19042451132689844, 'xgboost': 0.059485983261122935, 'rl': 0.1734302306339521, 'lstm': 0.17458659235803337, 'arima': 0.02962788775990361, 'prophet': 0.1254379982490703, 'transformer': 0.19992519240110596, 'bitcoin_forecast': 0.04354721539637131}
2024-09-20 03:57:09 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 03:57:09 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 03:57:09 - INFO - Current BTC price: 84873000.0
2024-09-20 03:57:09 - INFO - Analyzing market conditions.
2024-09-20 03:57:09 - INFO - Market analysis: {'current_price': 84873000.0, 'sma_20': 84749000.0, 'rsi_14': 57.95557933271464, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 03:57:09 - INFO - Starting predictions for all models
2024-09-20 03:57:09 - INFO - Attempting prediction for gpt
2024-09-20 03:57:09 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 03:57:09 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:57:09 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 03:57:09 - INFO - GPT prediction: 84873000.0
2024-09-20 03:57:09 - INFO - Attempting prediction for ml
2024-09-20 03:57:09 - INFO - ML prediction: 84873000.0
2024-09-20 03:57:09 - INFO - Attempting prediction for xgboost
2024-09-20 03:57:09 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 03:57:09 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:57:09 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 03:57:09 - INFO - XGBOOST prediction: 84873000.0
2024-09-20 03:57:09 - INFO - Attempting prediction for lstm
2024-09-20 03:57:09 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:57:09 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:57:09 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:57:09 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:57:09 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:57:09 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 03:57:09 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:57:09 - INFO - X 샘플:
[[-1.17821365 -2.08540251 -1.98376169 -2.50801499 -0.13351175 -0.13728199
  -2.50801499]
 [-2.20084716 -1.18269709 -1.67940801 -0.0198706  -0.64230631 -0.64330986
  -0.0198706 ]
 [ 0.88453428  0.98991594  1.06757907  1.18964404  1.56933726  1.57187397
   1.18964404]
 [ 1.13800755  0.97461585  0.77102933  0.80087148 -0.68133038 -0.68015053
   0.80087148]
 [ 0.38632821  0.94401566  0.27938107  0.65400184 -0.67178885 -0.67088713
   0.65400184]
 [-0.30416792 -0.78489471 -0.03277655 -0.86653084 -0.50372122 -0.50405393
  -0.86653084]
 [-0.30416792  0.24021144 -0.04838443 -0.20993718 -0.3404816  -0.34070091
  -0.20993718]
 [ 0.03670992  0.24021144  0.55251899  0.25658989 -0.80895446 -0.80824491
   0.25658989]
 [ 1.05934343  0.82161493  1.05977513  0.59352611 -0.0596121  -0.05815525
   0.59352611]
 [ 0.48247325 -0.15759095  0.01404709  0.10972026  2.27236941  2.27091054
   0.10972026]]
2024-09-20 03:57:09 - INFO - y 샘플:
[0.10972026]
2024-09-20 03:57:09 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 03:57:09 - INFO - 모델 출력 (스케일링된 예측): [[0.41926086]]
2024-09-20 03:57:09 - INFO - 스케일러 역변환 후 예측 가격: 84908828.98719059
2024-09-20 03:57:09 - INFO - LSTMPredictor 최종 예측 가격: 84908828.98719059
2024-09-20 03:57:09 - INFO - LSTM prediction: 84908828.98719059
2024-09-20 03:57:09 - INFO - Attempting prediction for rl
2024-09-20 03:57:09 - INFO - Preparing state for RL agent.
2024-09-20 03:57:09 - INFO - Prepared state: [[ 8.48730000e+07  3.06513666e+01 -6.59374301e-04  8.47490000e+07
   5.79555793e+01]]
2024-09-20 03:57:09 - INFO - RL prediction: 85721730.0
2024-09-20 03:57:09 - INFO - Attempting prediction for arima
2024-09-20 03:57:09 - INFO - ARIMA 예측 시작
2024-09-20 03:57:09 - INFO - 입력 데이터: {'open': 84890000.0, 'high': 84925000.0, 'low': 84766000.0, 'close': 84873000.0, 'volume': 30.65136665, 'value': 2601632117.99428, 'decision': 'sell', 'sma': 84749000.0, 'ema': 84737161.82767934, 'rsi': 57.95557933271464, 'macd': 168230.28708066046, 'signal_line': 187653.1332671803, 'BB_Upper': 85104967.97609001, 'BB_Lower': 84393032.02390999}
2024-09-20 03:57:09 - INFO - Exogenous 변수 예측 시작
2024-09-20 03:57:09 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84749000.0         0         0
2024-09-20 03:57:09 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84749000.0         0         0
2024-09-20 03:57:09 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 03:57:09 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 03:57:09 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 03:57:09 - INFO - ARIMA prediction: 84953000.0
2024-09-20 03:57:09 - INFO - Attempting prediction for prophet
2024-09-20 03:57:10 - INFO - PROPHET prediction: 84905828.78583913
2024-09-20 03:57:10 - INFO - Attempting prediction for transformer
2024-09-20 03:57:10 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:57:10 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 03:57:10 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 03:57:10 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 03:57:10 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 03:57:10 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 03:57:10 - INFO - X dtype: float64, y dtype: float64
2024-09-20 03:57:10 - INFO - X 샘플:
[[-1.17821365 -2.08540251 -1.98376169 -2.50801499 -0.13351175 -0.13728199
  -2.50801499 -2.50801499  0.          0.          0.         -2.50801499
  -2.50801499]
 [-2.20084716 -1.18269709 -1.67940801 -0.0198706  -0.64230631 -0.64330986
  -0.0198706  -0.0198706   0.          0.          0.         -0.0198706
  -0.0198706 ]
 [ 0.88453428  0.98991594  1.06757907  1.18964404  1.56933726  1.57187397
   1.18964404  1.18964404  0.          0.          0.          1.18964404
   1.18964404]
 [ 1.13800755  0.97461585  0.77102933  0.80087148 -0.68133038 -0.68015053
   0.80087148  0.80087148  0.          0.          0.          0.80087148
   0.80087148]
 [ 0.38632821  0.94401566  0.27938107  0.65400184 -0.67178885 -0.67088713
   0.65400184  0.65400184  0.          0.          0.          0.65400184
   0.65400184]
 [-0.30416792 -0.78489471 -0.03277655 -0.86653084 -0.50372122 -0.50405393
  -0.86653084 -0.86653084  0.          0.          0.         -0.86653084
  -0.86653084]
 [-0.30416792  0.24021144 -0.04838443 -0.20993718 -0.3404816  -0.34070091
  -0.20993718 -0.20993718  0.          0.          0.         -0.20993718
  -0.20993718]
 [ 0.03670992  0.24021144  0.55251899  0.25658989 -0.80895446 -0.80824491
   0.25658989  0.25658989  0.          0.          0.          0.25658989
   0.25658989]
 [ 1.05934343  0.82161493  1.05977513  0.59352611 -0.0596121  -0.05815525
   0.59352611  0.59352611  0.          0.          0.          0.59352611
   0.59352611]
 [ 0.48247325 -0.15759095  0.01404709  0.10972026  2.27236941  2.27091054
   0.10972026  0.10972026  0.          0.          0.          0.10972026
   0.10972026]]
2024-09-20 03:57:10 - INFO - y 샘플:
[0.10972026]
2024-09-20 03:57:10 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 03:57:10 - INFO - 모델 출력 (스케일링된 예측): [0.48141977]
2024-09-20 03:57:10 - INFO - 스케일러 역변환 후 예측 가격: 84916023.8135054
2024-09-20 03:57:10 - INFO - TransformerPredictor 최종 예측 가격: 84916023.8135054
2024-09-20 03:57:10 - INFO - TRANSFORMER prediction: 84916023.8135054
2024-09-20 03:57:10 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 03:57:10 - INFO - BITCOIN_FORECAST prediction: 83530754.54793048
2024-09-20 03:57:10 - INFO - BitcoinForecast prediction: 83530754.54793048
2024-09-20 03:57:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 03:57:18 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 03:57:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0035343886135419974, 'ml': 0.19042451132689844, 'xgboost': 0.059485983261122935, 'rl': 0.1734302306339521, 'lstm': 0.17458659235803337, 'arima': 0.02962788775990361, 'prophet': 0.1254379982490703, 'transformer': 0.19992519240110596, 'bitcoin_forecast': 0.04354721539637131}
2024-09-20 03:57:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0035343886135419974, 'ml': 0.19042451132689844, 'xgboost': 0.059485983261122935, 'rl': 0.1734302306339521, 'lstm': 0.17458659235803337, 'arima': 0.02962788775990361, 'prophet': 0.1254379982490703, 'transformer': 0.19992519240110596, 'bitcoin_forecast': 0.04354721539637131}
2024-09-20 03:57:18 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84983089.40100542, 'current_price': 84873000.0, 'predictions': {'gpt': 84873000.0, 'ml': 84873000.0, 'xgboost': 84873000.0, 'lstm': 84908828.98719059, 'rl': 85721730.0, 'arima': 84953000.0, 'prophet': 84905828.78583913, 'transformer': 84916023.8135054, 'bitcoin_forecast': 83530754.54793048}, 'weights': {'gpt': 0.0035343886135419974, 'ml': 0.19042451132689844, 'xgboost': 0.059485983261122935, 'rl': 0.1734302306339521, 'lstm': 0.17458659235803337, 'arima': 0.02962788775990361, 'prophet': 0.1254379982490703, 'transformer': 0.19992519240110596, 'bitcoin_forecast': 0.04354721539637131}}
2024-09-20 03:57:18 - INFO - 모델별 가중치:
2024-09-20 03:57:18 - INFO -   - GPT: 0.0035
2024-09-20 03:57:18 - INFO -   - ML: 0.1904
2024-09-20 03:57:18 - INFO -   - XGBOOST: 0.0595
2024-09-20 03:57:18 - INFO -   - RL: 0.1734
2024-09-20 03:57:18 - INFO -   - LSTM: 0.1746
2024-09-20 03:57:18 - INFO -   - ARIMA: 0.0296
2024-09-20 03:57:18 - INFO -   - PROPHET: 0.1254
2024-09-20 03:57:18 - INFO -   - TRANSFORMER: 0.1999
2024-09-20 03:57:18 - INFO -   - BITCOIN_FORECAST: 0.0435
2024-09-20 03:57:18 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 03:57:18 - INFO - 6. 거래 실행
2024-09-20 03:57:18 - INFO - Cancelling existing orders.
2024-09-20 03:57:18 - INFO - Cancelled 0 orders.
2024-09-20 03:57:18 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84983089.40100542, 'current_price': 84873000.0, 'predictions': {'gpt': 84873000.0, 'ml': 84873000.0, 'xgboost': 84873000.0, 'lstm': 84908828.98719059, 'rl': 85721730.0, 'arima': 84953000.0, 'prophet': 84905828.78583913, 'transformer': 84916023.8135054, 'bitcoin_forecast': 83530754.54793048}, 'weights': {'gpt': 0.0035343886135419974, 'ml': 0.19042451132689844, 'xgboost': 0.059485983261122935, 'rl': 0.1734302306339521, 'lstm': 0.17458659235803337, 'arima': 0.02962788775990361, 'prophet': 0.1254379982490703, 'transformer': 0.19992519240110596, 'bitcoin_forecast': 0.04354721539637131}}, 현재 가격=84873000.0
2024-09-20 03:57:18 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=480406.21892024006
2024-09-20 03:57:18 - INFO - 매수 시도: 0.0005499050163213272 BTC (약 46672.08845024 KRW)
2024-09-20 03:57:18 - INFO - 주문 결과: None
2024-09-20 03:57:18 - ERROR - 주문 실패
2024-09-20 03:57:18 - WARNING - Trade execution failed: Failed to place order
2024-09-20 03:57:18 - INFO - 7. summary 리포트 보내기
2024-09-20 03:57:19 - INFO - Message sent to Discord successfully.
2024-09-20 03:57:19 - INFO - Trading cycle completed.
2024-09-20 03:57:19 - INFO - Performing periodic update.
2024-09-20 03:57:19 - INFO - 계산된 시장 변동성: 0.02594821655068694
2024-09-20 04:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:05:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-a583-f86d67d7f7ee "HTTP/1.1 200 OK"
2024-09-20 04:05:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:05:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819b-b628-d1e3722b0f3f "HTTP/1.1 200 OK"
2024-09-20 04:05:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:05:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818f-a988-e0ee6030203d "HTTP/1.1 200 OK"
2024-09-20 04:05:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:05:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8135-9a0a-ef4db541a1dc "HTTP/1.1 200 OK"
2024-09-20 04:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-863d-d6edd12a7b41 "HTTP/1.1 200 OK"
2024-09-20 04:06:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-8906-e89048d36af5 "HTTP/1.1 200 OK"
2024-09-20 04:06:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8152-84b2-c0881f3b634f "HTTP/1.1 200 OK"
2024-09-20 04:06:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-9660-c99ba6143a0d "HTTP/1.1 200 OK"
2024-09-20 04:06:33 - INFO - Updated actual price for transformer prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:06:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8125-8de9-fc627f9e1db4 "HTTP/1.1 200 OK"
2024-09-20 04:06:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 03:55:34.957485
2024-09-20 04:06:38 - INFO - Starting trading cycle.
2024-09-20 04:06:38 - INFO - ##################################################
2024-09-20 04:06:38 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-20 04:06:38 - INFO - ##################################################
2024-09-20 04:06:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:06:38 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:06:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 03:50:00
2024-09-20 04:06:38 - INFO - 새로운 데이터 범위: 2024-09-18 18:50:00 ~ 2024-09-20 04:00:00
2024-09-20 04:06:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:06:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:06:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:06:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:06:38 - INFO - Sample date values: [Timestamp('2024-09-20 04:00:00')]
2024-09-20 04:06:38 - INFO - Successfully added 1 new data points
2024-09-20 04:06:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:06:38 - INFO - Final date range: 2024-09-20 04:00:00 to 2024-09-20 04:00:00
2024-09-20 04:06:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:06:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:00:00
2024-09-20 04:06:38 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:06:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:06:39 - INFO - GPT | 이전예측가격: 84873000 | 당시BTC가격: 84873000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:06:39 - INFO - ML | 이전예측가격: 84873000 | 당시BTC가격: 84873000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:06:39 - INFO - XGBOOST | 이전예측가격: 84873000 | 당시BTC가격: 84873000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:06:39 - INFO - LSTM 모델 예측 업데이트: 정확도 59.26%, 적중/전체: 16/27
2024-09-20 04:06:39 - INFO - LSTM | 이전예측가격: 84908829 | 당시BTC가격: 84873000 | 예측: 상승 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0164 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 27 | 예측 성공 수: 16 | 예측 성공률: 59.26%
2024-09-20 04:06:39 - INFO - RL 모델 예측 업데이트: 정확도 63.24%, 적중/전체: 43/68
2024-09-20 04:06:39 - INFO - RL | 이전예측가격: 85721730 | 당시BTC가격: 84873000 | 예측: 상승 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3582 | 반영가중치값: -0.0200 | 새 가중치: 0.3382 | 예측 총 횟수: 68 | 예측 성공 수: 43 | 예측 성공률: 63.24%
2024-09-20 04:06:39 - INFO - ARIMA 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-20 04:06:39 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84873000 | 예측: 상승 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0796 | 반영가중치값: -0.0200 | 새 가중치: 0.0596 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-20 04:06:39 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.90%, 적중/전체: 39/63
2024-09-20 04:06:39 - INFO - PROPHET | 이전예측가격: 84905829 | 당시BTC가격: 84873000 | 예측: 상승 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1935 | 반영가중치값: -0.0200 | 새 가중치: 0.1735 | 예측 총 횟수: 63 | 예측 성공 수: 39 | 예측 성공률: 61.90%
2024-09-20 04:06:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.96%, 적중/전체: 17/27
2024-09-20 04:06:39 - INFO - TRANSFORMER | 이전예측가격: 84916024 | 당시BTC가격: 84873000 | 예측: 상승 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0849 | 반영가중치값: -0.0200 | 새 가중치: 0.0649 | 예측 총 횟수: 27 | 예측 성공 수: 17 | 예측 성공률: 62.96%
2024-09-20 04:06:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-20 04:06:39 - INFO - BITCOIN_FORECAST | 이전예측가격: 83530755 | 당시BTC가격: 84873000 | 예측: 하락 | 지금 BTC가격: 84783000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0833 | 반영가중치값: 0.0200 | 새 가중치: 0.1033 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-20 04:06:39 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:06:39 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:06:39 - INFO - 새로운 가중치: {'gpt': 0.0035599276475710697, 'ml': 0.19180049416481093, 'xgboost': 0.05991582126618491, 'rl': 0.3406158589296531, 'lstm': 0.0, 'arima': 0.0600476076472118, 'prophet': 0.1747058601715474, 'transformer': 0.0653248626743649, 'bitcoin_forecast': 0.10402956749865588}
2024-09-20 04:06:39 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 04:06:39 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:06:39 - INFO - Current BTC price: 84783000.0
2024-09-20 04:06:39 - INFO - Analyzing market conditions.
2024-09-20 04:06:39 - INFO - Market analysis: {'current_price': 84783000.0, 'sma_20': 84759400.0, 'rsi_14': 54.51922718243809, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:06:39 - INFO - Starting predictions for all models
2024-09-20 04:06:39 - INFO - Attempting prediction for gpt
2024-09-20 04:06:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:06:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:06:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:06:39 - INFO - GPT prediction: 84783000.0
2024-09-20 04:06:39 - INFO - Attempting prediction for ml
2024-09-20 04:06:39 - INFO - ML prediction: 84884739.60000001
2024-09-20 04:06:39 - INFO - Attempting prediction for xgboost
2024-09-20 04:06:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:06:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:06:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:06:39 - INFO - XGBOOST prediction: 84783000.0
2024-09-20 04:06:39 - INFO - Attempting prediction for lstm
2024-09-20 04:06:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:06:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:06:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:06:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:06:39 - INFO - X 샘플:
[[-2.55561982 -1.97809667 -2.40704838 -0.33000571 -0.62199119 -0.6233562
  -0.33000571]
 [ 0.78437943  1.04222298  1.17402106  1.62765527  1.58120659  1.58344476
   1.62765527]
 [ 1.0587703   1.02095312  0.78742834  0.9984071  -0.66086624 -0.66005745
   0.9984071 ]
 [ 0.24505944  0.97841341  0.1464983   0.76069112 -0.65136115 -0.65082911
   0.76069112]
 [-0.50241915 -1.4250804  -0.26044141 -1.70036839 -0.48393533 -0.48462725
  -1.70036839]
 [-0.50241915  0.         -0.2807884  -0.63763815 -0.32131909 -0.32189241
  -0.63763815]
 [-0.13341073  0.          0.50257054  0.11745966 -0.78800295 -0.78766709
   0.11745966]
 [ 0.97361451  0.80825455  1.16384757  0.66280807 -0.04152217 -0.04041598
   0.66280807]
 [ 0.34913873 -0.55301627 -0.19940046 -0.12025632  2.281554    2.27983597
  -0.12025632]
 [ 0.28290645  0.10634928 -0.62668715 -1.37875266 -0.29376247 -0.29443523
  -1.37875266]]
2024-09-20 04:06:39 - INFO - y 샘플:
[-1.37875266]
2024-09-20 04:06:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:06:39 - INFO - 모델 출력 (스케일링된 예측): [[0.2634675]]
2024-09-20 04:06:39 - INFO - 스케일러 역변환 후 예측 가격: 84900441.59166211
2024-09-20 04:06:39 - INFO - LSTMPredictor 최종 예측 가격: 84900441.59166211
2024-09-20 04:06:39 - INFO - LSTM prediction: 84900441.59166211
2024-09-20 04:06:39 - INFO - Attempting prediction for rl
2024-09-20 04:06:39 - INFO - Preparing state for RL agent.
2024-09-20 04:06:39 - INFO - Prepared state: [[ 8.47830000e+07  9.28808242e+00 -1.06040790e-03  8.47594000e+07
   5.45192272e+01]]
2024-09-20 04:06:39 - INFO - RL prediction: 85630830.0
2024-09-20 04:06:39 - INFO - Attempting prediction for arima
2024-09-20 04:06:39 - INFO - ARIMA 예측 시작
2024-09-20 04:06:39 - INFO - 입력 데이터: {'open': 84883000.0, 'high': 84956000.0, 'low': 84724000.0, 'close': 84783000.0, 'volume': 9.28808242, 'value': 787907963.96736, 'decision': 'sell', 'sma': 84759400.0, 'ema': 84741527.36790036, 'rsi': 54.51922718243809, 'macd': 152217.87221047282, 'signal_line': 180566.08105583882, 'BB_Upper': 85106468.5234959, 'BB_Lower': 84412331.4765041}
2024-09-20 04:06:39 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:06:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84759400.0         0         0
2024-09-20 04:06:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84759400.0         0         0
2024-09-20 04:06:39 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:06:39 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:06:39 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:06:39 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:06:39 - INFO - Attempting prediction for prophet
2024-09-20 04:06:39 - INFO - PROPHET prediction: 84784584.83422112
2024-09-20 04:06:39 - INFO - Attempting prediction for transformer
2024-09-20 04:06:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:06:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:06:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:06:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:06:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:06:39 - INFO - X 샘플:
[[-2.55561982 -1.97809667 -2.40704838 -0.33000571 -0.62199119 -0.6233562
  -0.33000571 -0.33000571  0.          0.          0.         -0.33000571
  -0.33000571]
 [ 0.78437943  1.04222298  1.17402106  1.62765527  1.58120659  1.58344476
   1.62765527  1.62765527  0.          0.          0.          1.62765527
   1.62765527]
 [ 1.0587703   1.02095312  0.78742834  0.9984071  -0.66086624 -0.66005745
   0.9984071   0.9984071   0.          0.          0.          0.9984071
   0.9984071 ]
 [ 0.24505944  0.97841341  0.1464983   0.76069112 -0.65136115 -0.65082911
   0.76069112  0.76069112  0.          0.          0.          0.76069112
   0.76069112]
 [-0.50241915 -1.4250804  -0.26044141 -1.70036839 -0.48393533 -0.48462725
  -1.70036839 -1.70036839  0.          0.          0.         -1.70036839
  -1.70036839]
 [-0.50241915  0.         -0.2807884  -0.63763815 -0.32131909 -0.32189241
  -0.63763815 -0.63763815  0.          0.          0.         -0.63763815
  -0.63763815]
 [-0.13341073  0.          0.50257054  0.11745966 -0.78800295 -0.78766709
   0.11745966  0.11745966  0.          0.          0.          0.11745966
   0.11745966]
 [ 0.97361451  0.80825455  1.16384757  0.66280807 -0.04152217 -0.04041598
   0.66280807  0.66280807  0.          0.          0.          0.66280807
   0.66280807]
 [ 0.34913873 -0.55301627 -0.19940046 -0.12025632  2.281554    2.27983597
  -0.12025632 -0.12025632  0.          0.          0.         -0.12025632
  -0.12025632]
 [ 0.28290645  0.10634928 -0.62668715 -1.37875266 -0.29376247 -0.29443523
  -1.37875266 -1.37875266  0.          0.          0.         -1.37875266
  -1.37875266]]
2024-09-20 04:06:39 - INFO - y 샘플:
[-1.37875266]
2024-09-20 04:06:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:06:39 - INFO - 모델 출력 (스케일링된 예측): [0.4756396]
2024-09-20 04:06:39 - INFO - 스케일러 역변환 후 예측 가격: 84915614.85061775
2024-09-20 04:06:39 - INFO - TransformerPredictor 최종 예측 가격: 84915614.85061775
2024-09-20 04:06:39 - INFO - TRANSFORMER prediction: 84915614.85061775
2024-09-20 04:06:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:06:39 - INFO - BITCOIN_FORECAST prediction: 83246879.54666749
2024-09-20 04:06:39 - INFO - BitcoinForecast prediction: 83246879.54666749
2024-09-20 04:06:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:06:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:06:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0035599276475710697, 'ml': 0.19180049416481093, 'xgboost': 0.05991582126618491, 'rl': 0.3406158589296531, 'lstm': 0.0, 'arima': 0.0600476076472118, 'prophet': 0.1747058601715474, 'transformer': 0.0653248626743649, 'bitcoin_forecast': 0.10402956749865588}
2024-09-20 04:06:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0035599276475710697, 'ml': 0.19180049416481093, 'xgboost': 0.05991582126618491, 'rl': 0.3406158589296531, 'lstm': 0.0, 'arima': 0.0600476076472118, 'prophet': 0.1747058601715474, 'transformer': 0.0653248626743649, 'bitcoin_forecast': 0.10402956749865588}
2024-09-20 04:06:54 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84950644.12287748, 'current_price': 84783000.0, 'predictions': {'gpt': 84783000.0, 'ml': 84884739.60000001, 'xgboost': 84783000.0, 'lstm': 84900441.59166211, 'rl': 85630830.0, 'arima': 84953000.0, 'prophet': 84784584.83422112, 'transformer': 84915614.85061775, 'bitcoin_forecast': 83246879.54666749}, 'weights': {'gpt': 0.0035599276475710697, 'ml': 0.19180049416481093, 'xgboost': 0.05991582126618491, 'rl': 0.3406158589296531, 'lstm': 0.0, 'arima': 0.0600476076472118, 'prophet': 0.1747058601715474, 'transformer': 0.0653248626743649, 'bitcoin_forecast': 0.10402956749865588}}
2024-09-20 04:06:54 - INFO - 모델별 가중치:
2024-09-20 04:06:54 - INFO -   - GPT: 0.0036
2024-09-20 04:06:54 - INFO -   - ML: 0.1918
2024-09-20 04:06:54 - INFO -   - XGBOOST: 0.0599
2024-09-20 04:06:54 - INFO -   - RL: 0.3406
2024-09-20 04:06:54 - INFO -   - LSTM: 0.0000
2024-09-20 04:06:54 - INFO -   - ARIMA: 0.0600
2024-09-20 04:06:54 - INFO -   - PROPHET: 0.1747
2024-09-20 04:06:54 - INFO -   - TRANSFORMER: 0.0653
2024-09-20 04:06:54 - INFO -   - BITCOIN_FORECAST: 0.1040
2024-09-20 04:06:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:06:54 - INFO - 6. 거래 실행
2024-09-20 04:06:54 - INFO - Cancelling existing orders.
2024-09-20 04:06:54 - INFO - Cancelled 0 orders.
2024-09-20 04:06:54 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84950644.12287748, 'current_price': 84783000.0, 'predictions': {'gpt': 84783000.0, 'ml': 84884739.60000001, 'xgboost': 84783000.0, 'lstm': 84900441.59166211, 'rl': 85630830.0, 'arima': 84953000.0, 'prophet': 84784584.83422112, 'transformer': 84915614.85061775, 'bitcoin_forecast': 83246879.54666749}, 'weights': {'gpt': 0.0035599276475710697, 'ml': 0.19180049416481093, 'xgboost': 0.05991582126618491, 'rl': 0.3406158589296531, 'lstm': 0.0, 'arima': 0.0600476076472118, 'prophet': 0.1747058601715474, 'transformer': 0.0653248626743649, 'bitcoin_forecast': 0.10402956749865588}}, 현재 가격=84783000.0
2024-09-20 04:06:54 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=479946.28382024006
2024-09-20 04:06:54 - INFO - 매수 시도: 0.0005504887589521484 BTC (약 46672.08845024 KRW)
2024-09-20 04:06:55 - INFO - 주문 결과: None
2024-09-20 04:06:55 - ERROR - 주문 실패
2024-09-20 04:06:55 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:06:55 - INFO - 7. summary 리포트 보내기
2024-09-20 04:06:55 - INFO - Message sent to Discord successfully.
2024-09-20 04:06:55 - INFO - Trading cycle completed.
2024-09-20 04:06:55 - INFO - Performing periodic update.
2024-09-20 04:06:55 - INFO - 계산된 시장 변동성: 0.02601380820381118
2024-09-20 04:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:15:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8123-87cc-ec59ff77ad49 "HTTP/1.1 200 OK"
2024-09-20 04:15:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:15:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:15:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/c264b005-5b33-4d55-ab60-16bf0995fcf1 "HTTP/1.1 200 OK"
2024-09-20 04:15:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8133-9724-caaf381683b4 "HTTP/1.1 200 OK"
2024-09-20 04:16:07 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818d-8e9f-ee02c523e8b2 "HTTP/1.1 200 OK"
2024-09-20 04:16:15 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/40d8f06d-fb33-432f-9781-fc1da1a2c480 "HTTP/1.1 200 OK"
2024-09-20 04:16:21 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d3-8140-c8c6ad0caaf5 "HTTP/1.1 200 OK"
2024-09-20 04:16:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8184-bb82-e7b3380aa89e "HTTP/1.1 200 OK"
2024-09-20 04:16:37 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8147-ad08-fa9a96e0e0be "HTTP/1.1 200 OK"
2024-09-20 04:16:48 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:16:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819e-a996-cd2bb0adb3e4 "HTTP/1.1 200 OK"
2024-09-20 04:16:56 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:05:34.957997
2024-09-20 04:16:56 - INFO - Starting trading cycle.
2024-09-20 04:16:56 - INFO - ##################################################
2024-09-20 04:16:56 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-20 04:16:56 - INFO - ##################################################
2024-09-20 04:16:56 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:16:56 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:16:56 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:00:00
2024-09-20 04:16:56 - INFO - 새로운 데이터 범위: 2024-09-18 19:00:00 ~ 2024-09-20 04:10:00
2024-09-20 04:16:56 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:16:56 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:16:56 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:16:56 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:16:56 - INFO - Sample date values: [Timestamp('2024-09-20 04:10:00')]
2024-09-20 04:16:56 - INFO - Successfully added 1 new data points
2024-09-20 04:16:56 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:16:56 - INFO - Final date range: 2024-09-20 04:10:00 to 2024-09-20 04:10:00
2024-09-20 04:16:56 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:16:56 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:10:00
2024-09-20 04:16:56 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:16:56 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:16:56 - INFO - GPT | 이전예측가격: 84783000 | 당시BTC가격: 84783000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:16:56 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-20 04:16:56 - INFO - ML | 이전예측가격: 84884740 | 당시BTC가격: 84783000 | 예측: 상승 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1904 | 반영가중치값: -0.0200 | 새 가중치: 0.1704 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-20 04:16:56 - INFO - XGBOOST | 이전예측가격: 84783000 | 당시BTC가격: 84783000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:16:56 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 16/28
2024-09-20 04:16:56 - INFO - LSTM | 이전예측가격: 84900442 | 당시BTC가격: 84783000 | 예측: 상승 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1746 | 반영가중치값: -0.0200 | 새 가중치: 0.1546 | 예측 총 횟수: 28 | 예측 성공 수: 16 | 예측 성공률: 57.14%
2024-09-20 04:16:56 - INFO - RL 모델 예측 업데이트: 정확도 62.32%, 적중/전체: 43/69
2024-09-20 04:16:56 - INFO - RL | 이전예측가격: 85630830 | 당시BTC가격: 84783000 | 예측: 상승 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1734 | 반영가중치값: -0.0200 | 새 가중치: 0.1534 | 예측 총 횟수: 69 | 예측 성공 수: 43 | 예측 성공률: 62.32%
2024-09-20 04:16:56 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-20 04:16:56 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84783000 | 예측: 상승 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0296 | 반영가중치값: -0.0200 | 새 가중치: 0.0096 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-20 04:16:56 - INFO - PROPHET | 이전예측가격: 84784585 | 당시BTC가격: 84783000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:16:56 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.71%, 적중/전체: 17/28
2024-09-20 04:16:56 - INFO - TRANSFORMER | 이전예측가격: 84915615 | 당시BTC가격: 84783000 | 예측: 상승 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1999 | 반영가중치값: -0.0200 | 새 가중치: 0.1799 | 예측 총 횟수: 28 | 예측 성공 수: 17 | 예측 성공률: 60.71%
2024-09-20 04:16:56 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 6/9
2024-09-20 04:16:56 - INFO - BITCOIN_FORECAST | 이전예측가격: 83246880 | 당시BTC가격: 84783000 | 예측: 하락 | 지금 BTC가격: 84763000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0435 | 반영가중치값: 0.0200 | 새 가중치: 0.0635 | 예측 총 횟수: 9 | 예측 성공 수: 6 | 예측 성공률: 66.67%
2024-09-20 04:16:56 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:16:56 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:16:56 - INFO - 새로운 가중치: {'gpt': 0.0036710759364529943, 'ml': 0.17574551632834765, 'xgboost': 0.06178651687294407, 'rl': 0.15822063911580944, 'lstm': 0.15941310483965818, 'arima': 0.009928490287820337, 'prophet': 0.18016053772067156, 'transformer': 0.18554282827518864, 'bitcoin_forecast': 0.06553129062310716}
2024-09-20 04:16:56 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 04:16:56 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:16:56 - INFO - Current BTC price: 84763000.0
2024-09-20 04:16:56 - INFO - Analyzing market conditions.
2024-09-20 04:16:56 - INFO - Market analysis: {'current_price': 84763000.0, 'sma_20': 84774450.0, 'rsi_14': 53.75643706551832, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:16:56 - INFO - Starting predictions for all models
2024-09-20 04:16:56 - INFO - Attempting prediction for gpt
2024-09-20 04:16:57 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:16:57 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:16:57 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:16:57 - INFO - GPT prediction: 84763000.0
2024-09-20 04:16:57 - INFO - Attempting prediction for ml
2024-09-20 04:16:57 - INFO - ML prediction: 84915573.4
2024-09-20 04:16:57 - INFO - Attempting prediction for xgboost
2024-09-20 04:16:57 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:16:57 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:16:57 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:16:57 - INFO - XGBOOST prediction: 84763000.0
2024-09-20 04:16:57 - INFO - Attempting prediction for lstm
2024-09-20 04:16:57 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:16:57 - INFO - X 샘플:
[[ 9.92095582e-01  1.12281935e+00  1.48391454e+00  1.57684637e+00
   1.57082432e+00  1.57296991e+00  1.57684637e+00]
 [ 1.44304812e+00  1.09781223e+00  9.21713617e-01  1.01323964e+00
  -5.99518413e-01 -5.98894523e-01  1.01323964e+00]
 [ 1.05740595e-01  1.04779801e+00 -1.03563328e-02  8.00321549e-01
  -5.90317421e-01 -5.89960857e-01  8.00321549e-01]
 [-1.12271632e+00 -1.77800569e+00 -6.02146777e-01 -1.40400697e+00
  -4.28248017e-01 -4.29066026e-01 -1.40400697e+00]
 [-1.12271632e+00 -1.02529161e-01 -6.31736299e-01 -4.52137839e-01
  -2.70834316e-01 -2.71527509e-01 -4.52137839e-01]
 [-5.16262905e-01 -1.02529161e-01  5.07460306e-01  2.24190230e-01
  -7.22587671e-01 -7.22429427e-01  2.24190230e-01]
 [ 1.30309733e+00  8.47741111e-01  1.46911978e+00  7.12649392e-01
   1.11321862e-05  9.61040115e-04  7.12649392e-01]
 [ 2.76791557e-01 -7.52714084e-01 -5.13378210e-01  1.12721345e-02
   2.24876568e+00  2.24712450e+00  1.12721345e-02]
 [ 1.67940945e-01  2.25064012e-02 -1.13475818e+00 -1.11594131e+00
  -2.44159309e-01 -2.44947071e-01 -1.11594131e+00]
 [-1.52701859e+00 -1.40289901e+00 -1.48983244e+00 -1.36643319e+00
  -9.63935984e-01 -9.64230038e-01 -1.36643319e+00]]
2024-09-20 04:16:57 - INFO - y 샘플:
[-1.36643319]
2024-09-20 04:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:16:57 - INFO - 모델 출력 (스케일링된 예측): [[0.07691278]]
2024-09-20 04:16:57 - INFO - 스케일러 역변환 후 예측 가격: 84878240.93968938
2024-09-20 04:16:57 - INFO - LSTMPredictor 최종 예측 가격: 84878240.93968938
2024-09-20 04:16:57 - INFO - LSTM prediction: 84878240.93968938
2024-09-20 04:16:57 - INFO - Attempting prediction for rl
2024-09-20 04:16:57 - INFO - Preparing state for RL agent.
2024-09-20 04:16:57 - INFO - Prepared state: [[ 8.47630000e+07  3.11990899e+00 -2.35896347e-04  8.47744500e+07
   5.37564371e+01]]
2024-09-20 04:16:57 - INFO - RL prediction: 85610630.0
2024-09-20 04:16:57 - INFO - Attempting prediction for arima
2024-09-20 04:16:57 - INFO - ARIMA 예측 시작
2024-09-20 04:16:57 - INFO - 입력 데이터: {'open': 84774000.0, 'high': 84899000.0, 'low': 84700000.0, 'close': 84763000.0, 'volume': 3.11990899, 'value': 264415417.74568, 'decision': 'sell', 'sma': 84774450.0, 'ema': 84743572.38048129, 'rsi': 53.75643706551832, 'macd': 136342.41472287476, 'signal_line': 171721.34778924604, 'BB_Upper': 85093611.07219024, 'BB_Lower': 84455288.92780976}
2024-09-20 04:16:57 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:16:57 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84774450.0         0         0
2024-09-20 04:16:57 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84774450.0         0         0
2024-09-20 04:16:57 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:16:57 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:16:57 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:16:57 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:16:57 - INFO - Attempting prediction for prophet
2024-09-20 04:16:57 - INFO - PROPHET prediction: 84756701.56581822
2024-09-20 04:16:57 - INFO - Attempting prediction for transformer
2024-09-20 04:16:57 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:16:57 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:16:57 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:16:57 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:16:57 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:16:57 - INFO - X 샘플:
[[ 9.92095582e-01  1.12281935e+00  1.48391454e+00  1.57684637e+00
   1.57082432e+00  1.57296991e+00  1.57684637e+00  1.57684637e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.57684637e+00
   1.57684637e+00]
 [ 1.44304812e+00  1.09781223e+00  9.21713617e-01  1.01323964e+00
  -5.99518413e-01 -5.98894523e-01  1.01323964e+00  1.01323964e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.01323964e+00
   1.01323964e+00]
 [ 1.05740595e-01  1.04779801e+00 -1.03563328e-02  8.00321549e-01
  -5.90317421e-01 -5.89960857e-01  8.00321549e-01  8.00321549e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.00321549e-01
   8.00321549e-01]
 [-1.12271632e+00 -1.77800569e+00 -6.02146777e-01 -1.40400697e+00
  -4.28248017e-01 -4.29066026e-01 -1.40400697e+00 -1.40400697e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.40400697e+00
  -1.40400697e+00]
 [-1.12271632e+00 -1.02529161e-01 -6.31736299e-01 -4.52137839e-01
  -2.70834316e-01 -2.71527509e-01 -4.52137839e-01 -4.52137839e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.52137839e-01
  -4.52137839e-01]
 [-5.16262905e-01 -1.02529161e-01  5.07460306e-01  2.24190230e-01
  -7.22587671e-01 -7.22429427e-01  2.24190230e-01  2.24190230e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.24190230e-01
   2.24190230e-01]
 [ 1.30309733e+00  8.47741111e-01  1.46911978e+00  7.12649392e-01
   1.11321862e-05  9.61040115e-04  7.12649392e-01  7.12649392e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.12649392e-01
   7.12649392e-01]
 [ 2.76791557e-01 -7.52714084e-01 -5.13378210e-01  1.12721345e-02
   2.24876568e+00  2.24712450e+00  1.12721345e-02  1.12721345e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12721345e-02
   1.12721345e-02]
 [ 1.67940945e-01  2.25064012e-02 -1.13475818e+00 -1.11594131e+00
  -2.44159309e-01 -2.44947071e-01 -1.11594131e+00 -1.11594131e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.11594131e+00
  -1.11594131e+00]
 [-1.52701859e+00 -1.40289901e+00 -1.48983244e+00 -1.36643319e+00
  -9.63935984e-01 -9.64230038e-01 -1.36643319e+00 -1.36643319e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.36643319e+00
  -1.36643319e+00]]
2024-09-20 04:16:57 - INFO - y 샘플:
[-1.36643319]
2024-09-20 04:16:57 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:16:57 - INFO - 모델 출력 (스케일링된 예측): [0.47564146]
2024-09-20 04:16:57 - INFO - 스케일러 역변환 후 예측 가격: 84910076.59739542
2024-09-20 04:16:57 - INFO - TransformerPredictor 최종 예측 가격: 84910076.59739542
2024-09-20 04:16:57 - INFO - TRANSFORMER prediction: 84910076.59739542
2024-09-20 04:16:57 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:16:57 - INFO - BITCOIN_FORECAST prediction: 83099187.9266421
2024-09-20 04:16:57 - INFO - BitcoinForecast prediction: 83099187.9266421
2024-09-20 04:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:17:10 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0036710759364529943, 'ml': 0.17574551632834765, 'xgboost': 0.06178651687294407, 'rl': 0.15822063911580944, 'lstm': 0.15941310483965818, 'arima': 0.009928490287820337, 'prophet': 0.18016053772067156, 'transformer': 0.18554282827518864, 'bitcoin_forecast': 0.06553129062310716}
2024-09-20 04:17:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0036710759364529943, 'ml': 0.17574551632834765, 'xgboost': 0.06178651687294407, 'rl': 0.15822063911580944, 'lstm': 0.15941310483965818, 'arima': 0.009928490287820337, 'prophet': 0.18016053772067156, 'transformer': 0.18554282827518864, 'bitcoin_forecast': 0.06553129062310716}
2024-09-20 04:17:10 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84861306.50649332, 'current_price': 84763000.0, 'predictions': {'gpt': 84763000.0, 'ml': 84915573.4, 'xgboost': 84763000.0, 'lstm': 84878240.93968938, 'rl': 85610630.0, 'arima': 84953000.0, 'prophet': 84756701.56581822, 'transformer': 84910076.59739542, 'bitcoin_forecast': 83099187.9266421}, 'weights': {'gpt': 0.0036710759364529943, 'ml': 0.17574551632834765, 'xgboost': 0.06178651687294407, 'rl': 0.15822063911580944, 'lstm': 0.15941310483965818, 'arima': 0.009928490287820337, 'prophet': 0.18016053772067156, 'transformer': 0.18554282827518864, 'bitcoin_forecast': 0.06553129062310716}}
2024-09-20 04:17:10 - INFO - 모델별 가중치:
2024-09-20 04:17:10 - INFO -   - GPT: 0.0037
2024-09-20 04:17:10 - INFO -   - ML: 0.1757
2024-09-20 04:17:10 - INFO -   - XGBOOST: 0.0618
2024-09-20 04:17:10 - INFO -   - RL: 0.1582
2024-09-20 04:17:10 - INFO -   - LSTM: 0.1594
2024-09-20 04:17:10 - INFO -   - ARIMA: 0.0099
2024-09-20 04:17:10 - INFO -   - PROPHET: 0.1802
2024-09-20 04:17:10 - INFO -   - TRANSFORMER: 0.1855
2024-09-20 04:17:10 - INFO -   - BITCOIN_FORECAST: 0.0655
2024-09-20 04:17:10 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:17:10 - INFO - 6. 거래 실행
2024-09-20 04:17:10 - INFO - Cancelling existing orders.
2024-09-20 04:17:10 - INFO - Cancelled 0 orders.
2024-09-20 04:17:10 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84861306.50649332, 'current_price': 84763000.0, 'predictions': {'gpt': 84763000.0, 'ml': 84915573.4, 'xgboost': 84763000.0, 'lstm': 84878240.93968938, 'rl': 85610630.0, 'arima': 84953000.0, 'prophet': 84756701.56581822, 'transformer': 84910076.59739542, 'bitcoin_forecast': 83099187.9266421}, 'weights': {'gpt': 0.0036710759364529943, 'ml': 0.17574551632834765, 'xgboost': 0.06178651687294407, 'rl': 0.15822063911580944, 'lstm': 0.15941310483965818, 'arima': 0.009928490287820337, 'prophet': 0.18016053772067156, 'transformer': 0.18554282827518864, 'bitcoin_forecast': 0.06553129062310716}}, 현재 가격=84763000.0
2024-09-20 04:17:10 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=479844.07602023997
2024-09-20 04:17:10 - INFO - 매수 시도: 0.0005506186478798533 BTC (약 46672.08845024001 KRW)
2024-09-20 04:17:10 - INFO - 주문 결과: None
2024-09-20 04:17:10 - ERROR - 주문 실패
2024-09-20 04:17:10 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:17:10 - INFO - 7. summary 리포트 보내기
2024-09-20 04:17:10 - INFO - Message sent to Discord successfully.
2024-09-20 04:17:10 - INFO - Trading cycle completed.
2024-09-20 04:17:10 - INFO - Performing periodic update.
2024-09-20 04:17:10 - INFO - 계산된 시장 변동성: 0.025820283561115223
2024-09-20 04:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:25:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8145-82bb-dbcd6b4260d2 "HTTP/1.1 200 OK"
2024-09-20 04:25:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:25:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:25:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-b2c2-f308a4898149 "HTTP/1.1 200 OK"
2024-09-20 04:25:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:25:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:25:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8153-b506-dcb1a290da7c "HTTP/1.1 200 OK"
2024-09-20 04:25:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-9822-d28d0dbafa2e "HTTP/1.1 200 OK"
2024-09-20 04:26:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d0-af01-ef0204fbfbce "HTTP/1.1 200 OK"
2024-09-20 04:26:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c7-9ec5-d1dcc6cf616e "HTTP/1.1 200 OK"
2024-09-20 04:26:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/9dca7f68-e8f5-42d2-be51-70d0cfa8018f "HTTP/1.1 200 OK"
2024-09-20 04:26:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8118-9ff8-e3fd1bb7b25e "HTTP/1.1 200 OK"
2024-09-20 04:26:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:26:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8197-9e80-d2b4d00f94b9 "HTTP/1.1 200 OK"
2024-09-20 04:26:44 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:15:34.958229
2024-09-20 04:26:44 - INFO - Starting trading cycle.
2024-09-20 04:26:44 - INFO - ##################################################
2024-09-20 04:26:44 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-20 04:26:44 - INFO - ##################################################
2024-09-20 04:26:44 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:26:44 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:26:44 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:10:00
2024-09-20 04:26:44 - INFO - 새로운 데이터 범위: 2024-09-18 19:10:00 ~ 2024-09-20 04:20:00
2024-09-20 04:26:44 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:26:44 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:26:44 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:26:44 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:26:44 - INFO - Sample date values: [Timestamp('2024-09-20 04:20:00')]
2024-09-20 04:26:44 - INFO - Successfully added 1 new data points
2024-09-20 04:26:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:26:44 - INFO - Final date range: 2024-09-20 04:20:00 to 2024-09-20 04:20:00
2024-09-20 04:26:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:26:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:20:00
2024-09-20 04:26:44 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:26:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:26:44 - INFO - GPT | 이전예측가격: 84763000 | 당시BTC가격: 84763000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:26:44 - INFO - ML 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 4/9
2024-09-20 04:26:44 - INFO - ML | 이전예측가격: 84915573 | 당시BTC가격: 84763000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1918 | 반영가중치값: -0.0200 | 새 가중치: 0.1718 | 예측 총 횟수: 9 | 예측 성공 수: 4 | 예측 성공률: 44.44%
2024-09-20 04:26:44 - INFO - XGBOOST | 이전예측가격: 84763000 | 당시BTC가격: 84763000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:26:44 - INFO - LSTM 모델 예측 업데이트: 정확도 55.17%, 적중/전체: 16/29
2024-09-20 04:26:44 - INFO - LSTM | 이전예측가격: 84878241 | 당시BTC가격: 84763000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 29 | 예측 성공 수: 16 | 예측 성공률: 55.17%
2024-09-20 04:26:44 - INFO - RL 모델 예측 업데이트: 정확도 61.43%, 적중/전체: 43/70
2024-09-20 04:26:44 - INFO - RL | 이전예측가격: 85610630 | 당시BTC가격: 84763000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3406 | 반영가중치값: -0.0200 | 새 가중치: 0.3206 | 예측 총 횟수: 70 | 예측 성공 수: 43 | 예측 성공률: 61.43%
2024-09-20 04:26:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 4/9
2024-09-20 04:26:44 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84763000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0600 | 반영가중치값: -0.0200 | 새 가중치: 0.0400 | 예측 총 횟수: 9 | 예측 성공 수: 4 | 예측 성공률: 44.44%
2024-09-20 04:26:44 - INFO - PROPHET | 이전예측가격: 84756702 | 당시BTC가격: 84763000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:26:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 17/29
2024-09-20 04:26:44 - INFO - TRANSFORMER | 이전예측가격: 84910077 | 당시BTC가격: 84763000 | 예측: 상승 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0653 | 반영가중치값: -0.0200 | 새 가중치: 0.0453 | 예측 총 횟수: 29 | 예측 성공 수: 17 | 예측 성공률: 58.62%
2024-09-20 04:26:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 70.00%, 적중/전체: 7/10
2024-09-20 04:26:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83099188 | 당시BTC가격: 84763000 | 예측: 하락 | 지금 BTC가격: 84686000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1040 | 반영가중치값: 0.0200 | 새 가중치: 0.1240 | 예측 총 횟수: 10 | 예측 성공 수: 7 | 예측 성공률: 70.00%
2024-09-20 04:26:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:26:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:26:44 - INFO - 새로운 가중치: {'gpt': 0.0038747460683222303, 'ml': 0.18133193124414168, 'xgboost': 0.06521441328726124, 'rl': 0.33840352537892404, 'lstm': 0.0, 'arima': 0.04226943625325144, 'prophet': 0.19015578737237307, 'transformer': 0.04783947172022468, 'bitcoin_forecast': 0.13091068867550162}
2024-09-20 04:26:44 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 04:26:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:26:44 - INFO - Current BTC price: 84599000.0
2024-09-20 04:26:44 - INFO - Analyzing market conditions.
2024-09-20 04:26:44 - INFO - Market analysis: {'current_price': 84599000.0, 'sma_20': 84778650.0, 'rsi_14': 47.84503160998928, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:26:44 - INFO - Starting predictions for all models
2024-09-20 04:26:44 - INFO - Attempting prediction for gpt
2024-09-20 04:26:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:26:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:26:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:26:45 - INFO - GPT prediction: 84599000.0
2024-09-20 04:26:45 - INFO - Attempting prediction for ml
2024-09-20 04:26:45 - INFO - ML prediction: 84802037.6
2024-09-20 04:26:45 - INFO - Attempting prediction for xgboost
2024-09-20 04:26:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:26:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:26:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:26:45 - INFO - XGBOOST prediction: 84599000.0
2024-09-20 04:26:45 - INFO - Attempting prediction for lstm
2024-09-20 04:26:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:26:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:26:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:26:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:26:45 - INFO - X 샘플:
[[ 1.58541053  0.96599311  1.02351732  1.17021744 -0.42520835 -0.42419054
   1.17021744]
 [ 0.36695382  0.93815469  0.37284536  1.00553453 -0.41461115 -0.41389724
   1.00553453]
 [-0.75232617 -0.63471593 -0.04027969 -0.69941804 -0.22794846 -0.22851549
  -0.69941804]
 [-0.75232617  0.29787107 -0.06093595  0.03681148 -0.04664795 -0.04700087
   0.03681148]
 [-0.19977023  0.29787107  0.73432978  0.55992192 -0.5669528  -0.56652647
   0.55992192]
 [ 1.45789761  0.82680102  1.405658    0.93772391  0.26529705  0.26695827
   0.93772391]
 [ 0.52280293 -0.06402836  0.02168907  0.395239    2.85528978  2.85496993
   0.395239  ]
 [ 0.42362623  0.36746712 -0.41209224 -0.47661174 -0.01592513 -0.0163751
  -0.47661174]
 [-1.12069681 -0.4259278  -0.65996727 -0.67035635 -0.84492462 -0.84512721
  -0.67035635]
 [-1.53157174 -2.569486   -2.38476437 -2.25906215 -0.57836836 -0.5802953
  -2.25906215]]
2024-09-20 04:26:45 - INFO - y 샘플:
[-2.25906215]
2024-09-20 04:26:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:26:45 - INFO - 모델 출력 (스케일링된 예측): [[0.01812568]]
2024-09-20 04:26:45 - INFO - 스케일러 역변환 후 예측 가격: 84834071.08953534
2024-09-20 04:26:45 - INFO - LSTMPredictor 최종 예측 가격: 84834071.08953534
2024-09-20 04:26:45 - INFO - LSTM prediction: 84834071.08953534
2024-09-20 04:26:45 - INFO - Attempting prediction for rl
2024-09-20 04:26:45 - INFO - Preparing state for RL agent.
2024-09-20 04:26:45 - INFO - Prepared state: [[ 8.45990000e+07  5.10322168e+00 -1.93480646e-03  8.47786500e+07
   4.78450316e+01]]
2024-09-20 04:26:45 - INFO - RL prediction: 85444990.0
2024-09-20 04:26:45 - INFO - Attempting prediction for arima
2024-09-20 04:26:45 - INFO - ARIMA 예측 시작
2024-09-20 04:26:45 - INFO - 입력 데이터: {'open': 84745000.0, 'high': 84745000.0, 'low': 84533000.0, 'close': 84599000.0, 'volume': 5.10322168, 'value': 431700096.86358, 'decision': 'sell', 'sma': 84778650.0, 'ema': 84729803.58234021, 'rsi': 47.84503160998928, 'macd': 109267.99743518233, 'signal_line': 159230.6777184333, 'BB_Upper': 85086037.23135163, 'BB_Lower': 84471262.76864837}
2024-09-20 04:26:45 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:26:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84778650.0         0         0
2024-09-20 04:26:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84778650.0         0         0
2024-09-20 04:26:45 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:26:45 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:26:45 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:26:45 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:26:45 - INFO - Attempting prediction for prophet
2024-09-20 04:26:45 - INFO - PROPHET prediction: 84561225.5498566
2024-09-20 04:26:45 - INFO - Attempting prediction for transformer
2024-09-20 04:26:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:26:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:26:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:26:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:26:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:26:45 - INFO - X 샘플:
[[ 1.58541053  0.96599311  1.02351732  1.17021744 -0.42520835 -0.42419054
   1.17021744  1.17021744  0.          0.          0.          1.17021744
   1.17021744]
 [ 0.36695382  0.93815469  0.37284536  1.00553453 -0.41461115 -0.41389724
   1.00553453  1.00553453  0.          0.          0.          1.00553453
   1.00553453]
 [-0.75232617 -0.63471593 -0.04027969 -0.69941804 -0.22794846 -0.22851549
  -0.69941804 -0.69941804  0.          0.          0.         -0.69941804
  -0.69941804]
 [-0.75232617  0.29787107 -0.06093595  0.03681148 -0.04664795 -0.04700087
   0.03681148  0.03681148  0.          0.          0.          0.03681148
   0.03681148]
 [-0.19977023  0.29787107  0.73432978  0.55992192 -0.5669528  -0.56652647
   0.55992192  0.55992192  0.          0.          0.          0.55992192
   0.55992192]
 [ 1.45789761  0.82680102  1.405658    0.93772391  0.26529705  0.26695827
   0.93772391  0.93772391  0.          0.          0.          0.93772391
   0.93772391]
 [ 0.52280293 -0.06402836  0.02168907  0.395239    2.85528978  2.85496993
   0.395239    0.395239    0.          0.          0.          0.395239
   0.395239  ]
 [ 0.42362623  0.36746712 -0.41209224 -0.47661174 -0.01592513 -0.0163751
  -0.47661174 -0.47661174  0.          0.          0.         -0.47661174
  -0.47661174]
 [-1.12069681 -0.4259278  -0.65996727 -0.67035635 -0.84492462 -0.84512721
  -0.67035635 -0.67035635  0.          0.          0.         -0.67035635
  -0.67035635]
 [-1.53157174 -2.569486   -2.38476437 -2.25906215 -0.57836836 -0.5802953
  -2.25906215 -2.25906215  0.          0.          0.         -2.25906215
  -2.25906215]]
2024-09-20 04:26:45 - INFO - y 샘플:
[-2.25906215]
2024-09-20 04:26:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:26:45 - INFO - 모델 출력 (스케일링된 예측): [0.47161618]
2024-09-20 04:26:45 - INFO - 스케일러 역변환 후 예측 가격: 84880884.31474353
2024-09-20 04:26:45 - INFO - TransformerPredictor 최종 예측 가격: 84880884.31474353
2024-09-20 04:26:45 - INFO - TRANSFORMER prediction: 84880884.31474353
2024-09-20 04:26:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:26:45 - INFO - BITCOIN_FORECAST prediction: 83089187.78216058
2024-09-20 04:26:45 - INFO - BitcoinForecast prediction: 83089187.78216058
2024-09-20 04:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:26:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:26:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0038747460683222303, 'ml': 0.18133193124414168, 'xgboost': 0.06521441328726124, 'rl': 0.33840352537892404, 'lstm': 0.0, 'arima': 0.04226943625325144, 'prophet': 0.19015578737237307, 'transformer': 0.04783947172022468, 'bitcoin_forecast': 0.13091068867550162}
2024-09-20 04:26:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0038747460683222303, 'ml': 0.18133193124414168, 'xgboost': 0.06521441328726124, 'rl': 0.33840352537892404, 'lstm': 0.0, 'arima': 0.04226943625325144, 'prophet': 0.19015578737237307, 'transformer': 0.04783947172022468, 'bitcoin_forecast': 0.13091068867550162}
2024-09-20 04:26:54 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84745718.18817806, 'current_price': 84599000.0, 'predictions': {'gpt': 84599000.0, 'ml': 84802037.6, 'xgboost': 84599000.0, 'lstm': 84834071.08953534, 'rl': 85444990.0, 'arima': 84953000.0, 'prophet': 84561225.5498566, 'transformer': 84880884.31474353, 'bitcoin_forecast': 83089187.78216058}, 'weights': {'gpt': 0.0038747460683222303, 'ml': 0.18133193124414168, 'xgboost': 0.06521441328726124, 'rl': 0.33840352537892404, 'lstm': 0.0, 'arima': 0.04226943625325144, 'prophet': 0.19015578737237307, 'transformer': 0.04783947172022468, 'bitcoin_forecast': 0.13091068867550162}}
2024-09-20 04:26:54 - INFO - 모델별 가중치:
2024-09-20 04:26:54 - INFO -   - GPT: 0.0039
2024-09-20 04:26:54 - INFO -   - ML: 0.1813
2024-09-20 04:26:54 - INFO -   - XGBOOST: 0.0652
2024-09-20 04:26:54 - INFO -   - RL: 0.3384
2024-09-20 04:26:54 - INFO -   - LSTM: 0.0000
2024-09-20 04:26:54 - INFO -   - ARIMA: 0.0423
2024-09-20 04:26:54 - INFO -   - PROPHET: 0.1902
2024-09-20 04:26:54 - INFO -   - TRANSFORMER: 0.0478
2024-09-20 04:26:54 - INFO -   - BITCOIN_FORECAST: 0.1309
2024-09-20 04:26:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:26:54 - INFO - 6. 거래 실행
2024-09-20 04:26:54 - INFO - Cancelling existing orders.
2024-09-20 04:26:54 - INFO - Cancelled 0 orders.
2024-09-20 04:26:54 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84745718.18817806, 'current_price': 84599000.0, 'predictions': {'gpt': 84599000.0, 'ml': 84802037.6, 'xgboost': 84599000.0, 'lstm': 84834071.08953534, 'rl': 85444990.0, 'arima': 84953000.0, 'prophet': 84561225.5498566, 'transformer': 84880884.31474353, 'bitcoin_forecast': 83089187.78216058}, 'weights': {'gpt': 0.0038747460683222303, 'ml': 0.18133193124414168, 'xgboost': 0.06521441328726124, 'rl': 0.33840352537892404, 'lstm': 0.0, 'arima': 0.04226943625325144, 'prophet': 0.19015578737237307, 'transformer': 0.04783947172022468, 'bitcoin_forecast': 0.13091068867550162}}, 현재 가격=84599000.0
2024-09-20 04:26:54 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=479005.97206024
2024-09-20 04:26:54 - INFO - 매수 시도: 0.000551686053620492 BTC (약 46672.08845024 KRW)
2024-09-20 04:26:54 - INFO - 주문 결과: None
2024-09-20 04:26:54 - ERROR - 주문 실패
2024-09-20 04:26:54 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:26:54 - INFO - 7. summary 리포트 보내기
2024-09-20 04:26:55 - INFO - Message sent to Discord successfully.
2024-09-20 04:26:55 - INFO - Trading cycle completed.
2024-09-20 04:26:55 - INFO - Performing periodic update.
2024-09-20 04:26:55 - INFO - 계산된 시장 변동성: 0.026011411842524996
2024-09-20 04:35:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:35:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814b-8514-ddea4b5055d6 "HTTP/1.1 200 OK"
2024-09-20 04:35:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cc-89c1-caf9301ecb1f "HTTP/1.1 200 OK"
2024-09-20 04:35:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:35:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:35:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f7-a2ef-f3d0a1ecc344 "HTTP/1.1 200 OK"
2024-09-20 04:35:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:35:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:35:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d7-aedb-f47121ab4d04 "HTTP/1.1 200 OK"
2024-09-20 04:35:58 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:36:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8120-9087-f7fa0b4a49b4 "HTTP/1.1 200 OK"
2024-09-20 04:36:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:36:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c1-916b-c1918aa15036 "HTTP/1.1 200 OK"
2024-09-20 04:36:15 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:36:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-9aa9-d68f97587a9d "HTTP/1.1 200 OK"
2024-09-20 04:36:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:36:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/b65bbbd6-bdd5-46bc-881b-1d4423eba9c6 "HTTP/1.1 200 OK"
2024-09-20 04:36:28 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:36:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817c-b2f1-d281960ceaad "HTTP/1.1 200 OK"
2024-09-20 04:36:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:25:34.958360
2024-09-20 04:36:39 - INFO - Starting trading cycle.
2024-09-20 04:36:39 - INFO - ##################################################
2024-09-20 04:36:39 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-20 04:36:39 - INFO - ##################################################
2024-09-20 04:36:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:36:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:36:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:20:00
2024-09-20 04:36:39 - INFO - 새로운 데이터 범위: 2024-09-18 19:20:00 ~ 2024-09-20 04:30:00
2024-09-20 04:36:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:36:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:36:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:36:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:36:39 - INFO - Sample date values: [Timestamp('2024-09-20 04:30:00')]
2024-09-20 04:36:39 - INFO - Successfully added 1 new data points
2024-09-20 04:36:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:36:39 - INFO - Final date range: 2024-09-20 04:30:00 to 2024-09-20 04:30:00
2024-09-20 04:36:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:36:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:30:00
2024-09-20 04:36:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:36:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:36:39 - INFO - GPT | 이전예측가격: 84599000 | 당시BTC가격: 84599000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:36:39 - INFO - ML 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-20 04:36:39 - INFO - ML | 이전예측가격: 84802038 | 당시BTC가격: 84599000 | 예측: 상승 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1757 | 반영가중치값: -0.0200 | 새 가중치: 0.1557 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-20 04:36:39 - INFO - XGBOOST | 이전예측가격: 84599000 | 당시BTC가격: 84599000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:36:39 - INFO - LSTM 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 16/30
2024-09-20 04:36:39 - INFO - LSTM | 이전예측가격: 84834071 | 당시BTC가격: 84599000 | 예측: 상승 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1594 | 반영가중치값: -0.0200 | 새 가중치: 0.1394 | 예측 총 횟수: 30 | 예측 성공 수: 16 | 예측 성공률: 53.33%
2024-09-20 04:36:39 - INFO - RL 모델 예측 업데이트: 정확도 60.56%, 적중/전체: 43/71
2024-09-20 04:36:39 - INFO - RL | 이전예측가격: 85444990 | 당시BTC가격: 84599000 | 예측: 상승 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1582 | 반영가중치값: -0.0200 | 새 가중치: 0.1382 | 예측 총 횟수: 71 | 예측 성공 수: 43 | 예측 성공률: 60.56%
2024-09-20 04:36:39 - INFO - ARIMA 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-20 04:36:39 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84599000 | 예측: 상승 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0099 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-20 04:36:39 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 40/64
2024-09-20 04:36:39 - INFO - PROPHET | 이전예측가격: 84561226 | 당시BTC가격: 84599000 | 예측: 하락 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1802 | 반영가중치값: 0.0200 | 새 가중치: 0.2002 | 예측 총 횟수: 64 | 예측 성공 수: 40 | 예측 성공률: 62.50%
2024-09-20 04:36:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.67%, 적중/전체: 17/30
2024-09-20 04:36:39 - INFO - TRANSFORMER | 이전예측가격: 84880884 | 당시BTC가격: 84599000 | 예측: 상승 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1855 | 반영가중치값: -0.0200 | 새 가중치: 0.1655 | 예측 총 횟수: 30 | 예측 성공 수: 17 | 예측 성공률: 56.67%
2024-09-20 04:36:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 72.73%, 적중/전체: 8/11
2024-09-20 04:36:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83089188 | 당시BTC가격: 84599000 | 예측: 하락 | 지금 BTC가격: 84578000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0655 | 반영가중치값: 0.0200 | 새 가중치: 0.0855 | 예측 총 횟수: 11 | 예측 성공 수: 8 | 예측 성공률: 72.73%
2024-09-20 04:36:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:36:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:36:40 - INFO - 새로운 가중치: {'gpt': 0.004062843210618447, 'ml': 0.16330608572573682, 'xgboost': 0.06838020649269051, 'rl': 0.14493047422902966, 'lstm': 0.14618082746111433, 'arima': 0.0, 'prophet': 0.20987720675700786, 'transformer': 0.17357900209849142, 'bitcoin_forecast': 0.08968335402531093}
2024-09-20 04:36:40 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 04:36:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:36:40 - INFO - Current BTC price: 84571000.0
2024-09-20 04:36:40 - INFO - Analyzing market conditions.
2024-09-20 04:36:40 - INFO - Market analysis: {'current_price': 84571000.0, 'sma_20': 84782700.0, 'rsi_14': 46.896825853603794, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:36:40 - INFO - Starting predictions for all models
2024-09-20 04:36:40 - INFO - Attempting prediction for gpt
2024-09-20 04:36:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:36:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:36:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:36:40 - INFO - GPT prediction: 84571000.0
2024-09-20 04:36:40 - INFO - Attempting prediction for ml
2024-09-20 04:36:40 - INFO - ML prediction: 84723227.8
2024-09-20 04:36:40 - INFO - Attempting prediction for xgboost
2024-09-20 04:36:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:36:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:36:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:36:40 - INFO - XGBOOST prediction: 84571000.0
2024-09-20 04:36:40 - INFO - Attempting prediction for lstm
2024-09-20 04:36:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:36:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:36:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:36:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:36:40 - INFO - X 샘플:
[[ 0.68205431  0.96323542  0.61473633  1.17680546 -0.37676616 -0.37577937
   1.17680546]
 [-0.22505496 -0.10074896  0.25888317 -0.28177032 -0.19331813 -0.1936144
  -0.28177032]
 [-0.22505496  0.53010903  0.24109051  0.34806922 -0.01513995 -0.01524945
   0.34806922]
 [ 0.22275848  0.53010903  0.92610784  0.79558679 -0.52648421 -0.52576016
   0.79558679]
 [ 1.56619879  0.88790909  1.50436922  1.11879392  0.2914328   0.29326182
   1.11879392]
 [ 0.80836067  0.28529847  0.31226114  0.65470163  2.83682117  2.83636589
   0.65470163]
 [ 0.7279839   0.57718799 -0.06138467 -0.09116099  0.01505377  0.0148449
  -0.09116099]
 [-0.52359725  0.0404879  -0.27489656 -0.25690823 -0.79966884 -0.79952657
  -0.25690823]
 [-0.85658673 -1.40954391 -1.76058349 -1.61603566 -0.53770317 -0.53929007
  -1.61603566]
 [-2.17706225 -2.30404405 -1.76058349 -1.84808181 -0.69422727 -0.69525259
  -1.84808181]]
2024-09-20 04:36:40 - INFO - y 샘플:
[-1.84808181]
2024-09-20 04:36:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:36:40 - INFO - 모델 출력 (스케일링된 예측): [[-0.04043866]]
2024-09-20 04:36:40 - INFO - 스케일러 역변환 후 예측 가격: 84789120.44271511
2024-09-20 04:36:40 - INFO - LSTMPredictor 최종 예측 가격: 84789120.44271511
2024-09-20 04:36:40 - INFO - LSTM prediction: 84789120.44271511
2024-09-20 04:36:40 - INFO - Attempting prediction for rl
2024-09-20 04:36:40 - INFO - Preparing state for RL agent.
2024-09-20 04:36:40 - INFO - Prepared state: [[ 8.45710000e+07  3.91819530e+00 -3.30973179e-04  8.47827000e+07
   4.68968259e+01]]
2024-09-20 04:36:40 - INFO - RL prediction: 85416710.0
2024-09-20 04:36:40 - INFO - Attempting prediction for arima
2024-09-20 04:36:40 - INFO - ARIMA 예측 시작
2024-09-20 04:36:40 - INFO - 입력 데이터: {'open': 84630000.0, 'high': 84650000.0, 'low': 84533000.0, 'close': 84571000.0, 'volume': 3.9181953, 'value': 331444597.55962, 'decision': 'sell', 'sma': 84782700.0, 'ema': 84714679.43164115, 'rsi': 46.896825853603794, 'macd': 84577.00956094265, 'signal_line': 144299.94408693517, 'BB_Upper': 85076606.85599628, 'BB_Lower': 84488793.14400372}
2024-09-20 04:36:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:36:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84782700.0         0         0
2024-09-20 04:36:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84782700.0         0         0
2024-09-20 04:36:40 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:36:40 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:36:40 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:36:40 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:36:40 - INFO - Attempting prediction for prophet
2024-09-20 04:36:40 - INFO - PROPHET prediction: 84527299.23343703
2024-09-20 04:36:40 - INFO - Attempting prediction for transformer
2024-09-20 04:36:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:36:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:36:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:36:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:36:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:36:40 - INFO - X 샘플:
[[ 0.68205431  0.96323542  0.61473633  1.17680546 -0.37676616 -0.37577937
   1.17680546  1.17680546  0.          0.          0.          1.17680546
   1.17680546]
 [-0.22505496 -0.10074896  0.25888317 -0.28177032 -0.19331813 -0.1936144
  -0.28177032 -0.28177032  0.          0.          0.         -0.28177032
  -0.28177032]
 [-0.22505496  0.53010903  0.24109051  0.34806922 -0.01513995 -0.01524945
   0.34806922  0.34806922  0.          0.          0.          0.34806922
   0.34806922]
 [ 0.22275848  0.53010903  0.92610784  0.79558679 -0.52648421 -0.52576016
   0.79558679  0.79558679  0.          0.          0.          0.79558679
   0.79558679]
 [ 1.56619879  0.88790909  1.50436922  1.11879392  0.2914328   0.29326182
   1.11879392  1.11879392  0.          0.          0.          1.11879392
   1.11879392]
 [ 0.80836067  0.28529847  0.31226114  0.65470163  2.83682117  2.83636589
   0.65470163  0.65470163  0.          0.          0.          0.65470163
   0.65470163]
 [ 0.7279839   0.57718799 -0.06138467 -0.09116099  0.01505377  0.0148449
  -0.09116099 -0.09116099  0.          0.          0.         -0.09116099
  -0.09116099]
 [-0.52359725  0.0404879  -0.27489656 -0.25690823 -0.79966884 -0.79952657
  -0.25690823 -0.25690823  0.          0.          0.         -0.25690823
  -0.25690823]
 [-0.85658673 -1.40954391 -1.76058349 -1.61603566 -0.53770317 -0.53929007
  -1.61603566 -1.61603566  0.          0.          0.         -1.61603566
  -1.61603566]
 [-2.17706225 -2.30404405 -1.76058349 -1.84808181 -0.69422727 -0.69525259
  -1.84808181 -1.84808181  0.          0.          0.         -1.84808181
  -1.84808181]]
2024-09-20 04:36:40 - INFO - y 샘플:
[-1.84808181]
2024-09-20 04:36:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:36:40 - INFO - 모델 출력 (스케일링된 예측): [0.47439936]
2024-09-20 04:36:40 - INFO - 스케일러 역변환 후 예측 가격: 84851243.70868577
2024-09-20 04:36:40 - INFO - TransformerPredictor 최종 예측 가격: 84851243.70868577
2024-09-20 04:36:40 - INFO - TRANSFORMER prediction: 84851243.70868577
2024-09-20 04:36:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:36:40 - INFO - BITCOIN_FORECAST prediction: 83047278.03381088
2024-09-20 04:36:40 - INFO - BitcoinForecast prediction: 83047278.03381088
2024-09-20 04:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:36:45 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:36:45 - INFO - 조정된 모델 가중치: {'gpt': 0.004062843210618447, 'ml': 0.16330608572573682, 'xgboost': 0.06838020649269051, 'rl': 0.14493047422902966, 'lstm': 0.14618082746111433, 'arima': 0.0, 'prophet': 0.20987720675700786, 'transformer': 0.17357900209849142, 'bitcoin_forecast': 0.08968335402531093}
2024-09-20 04:36:45 - INFO - 조정된 모델 가중치: {'gpt': 0.004062843210618447, 'ml': 0.16330608572573682, 'xgboost': 0.06838020649269051, 'rl': 0.14493047422902966, 'lstm': 0.14618082746111433, 'arima': 0.0, 'prophet': 0.20987720675700786, 'transformer': 0.17357900209849142, 'bitcoin_forecast': 0.08968335402531093}
2024-09-20 04:36:45 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84653134.03626795, 'current_price': 84571000.0, 'predictions': {'gpt': 84571000.0, 'ml': 84723227.8, 'xgboost': 84571000.0, 'lstm': 84789120.44271511, 'rl': 85416710.0, 'arima': 84953000.0, 'prophet': 84527299.23343703, 'transformer': 84851243.70868577, 'bitcoin_forecast': 83047278.03381088}, 'weights': {'gpt': 0.004062843210618447, 'ml': 0.16330608572573682, 'xgboost': 0.06838020649269051, 'rl': 0.14493047422902966, 'lstm': 0.14618082746111433, 'arima': 0.0, 'prophet': 0.20987720675700786, 'transformer': 0.17357900209849142, 'bitcoin_forecast': 0.08968335402531093}}
2024-09-20 04:36:45 - INFO - 모델별 가중치:
2024-09-20 04:36:45 - INFO -   - GPT: 0.0041
2024-09-20 04:36:45 - INFO -   - ML: 0.1633
2024-09-20 04:36:45 - INFO -   - XGBOOST: 0.0684
2024-09-20 04:36:45 - INFO -   - RL: 0.1449
2024-09-20 04:36:45 - INFO -   - LSTM: 0.1462
2024-09-20 04:36:45 - INFO -   - ARIMA: 0.0000
2024-09-20 04:36:45 - INFO -   - PROPHET: 0.2099
2024-09-20 04:36:45 - INFO -   - TRANSFORMER: 0.1736
2024-09-20 04:36:45 - INFO -   - BITCOIN_FORECAST: 0.0897
2024-09-20 04:36:45 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:36:45 - INFO - 6. 거래 실행
2024-09-20 04:36:45 - INFO - Cancelling existing orders.
2024-09-20 04:36:45 - INFO - Cancelled 0 orders.
2024-09-20 04:36:45 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84653134.03626795, 'current_price': 84571000.0, 'predictions': {'gpt': 84571000.0, 'ml': 84723227.8, 'xgboost': 84571000.0, 'lstm': 84789120.44271511, 'rl': 85416710.0, 'arima': 84953000.0, 'prophet': 84527299.23343703, 'transformer': 84851243.70868577, 'bitcoin_forecast': 83047278.03381088}, 'weights': {'gpt': 0.004062843210618447, 'ml': 0.16330608572573682, 'xgboost': 0.06838020649269051, 'rl': 0.14493047422902966, 'lstm': 0.14618082746111433, 'arima': 0.0, 'prophet': 0.20987720675700786, 'transformer': 0.17357900209849142, 'bitcoin_forecast': 0.08968335402531093}}, 현재 가격=84571000.0
2024-09-20 04:36:45 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=478862.88114024
2024-09-20 04:36:45 - INFO - 매수 시도: 0.0005518687073611521 BTC (약 46672.08845024 KRW)
2024-09-20 04:36:45 - INFO - 주문 결과: None
2024-09-20 04:36:45 - ERROR - 주문 실패
2024-09-20 04:36:45 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:36:45 - INFO - 7. summary 리포트 보내기
2024-09-20 04:36:45 - INFO - Message sent to Discord successfully.
2024-09-20 04:36:45 - INFO - Trading cycle completed.
2024-09-20 04:36:45 - INFO - Performing periodic update.
2024-09-20 04:36:45 - INFO - 계산된 시장 변동성: 0.025950226611755046
2024-09-20 04:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:45:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f5-9df4-e539106686c0 "HTTP/1.1 200 OK"
2024-09-20 04:45:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:45:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:45:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8127-abb8-df3f20e0806e "HTTP/1.1 200 OK"
2024-09-20 04:45:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:45:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ab-8dd8-d85e9a807ded "HTTP/1.1 200 OK"
2024-09-20 04:45:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-a3f1-d35287b79333 "HTTP/1.1 200 OK"
2024-09-20 04:46:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8118-a1e8-c65c08aa6695 "HTTP/1.1 200 OK"
2024-09-20 04:46:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e0-942d-d0235962a800 "HTTP/1.1 200 OK"
2024-09-20 04:46:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-9918-cfd46fa43b36 "HTTP/1.1 200 OK"
2024-09-20 04:46:35 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817c-87da-c5053e6be494 "HTTP/1.1 200 OK"
2024-09-20 04:46:41 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:46:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8140-a765-d76a10fdfa9f "HTTP/1.1 200 OK"
2024-09-20 04:46:50 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:35:34.958941
2024-09-20 04:46:50 - INFO - Starting trading cycle.
2024-09-20 04:46:50 - INFO - ##################################################
2024-09-20 04:46:50 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-20 04:46:50 - INFO - ##################################################
2024-09-20 04:46:50 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:46:50 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:46:50 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:30:00
2024-09-20 04:46:50 - INFO - 새로운 데이터 범위: 2024-09-18 19:30:00 ~ 2024-09-20 04:40:00
2024-09-20 04:46:50 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:46:50 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:46:50 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:46:50 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:46:50 - INFO - Sample date values: [Timestamp('2024-09-20 04:40:00')]
2024-09-20 04:46:50 - INFO - Successfully added 1 new data points
2024-09-20 04:46:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:46:50 - INFO - Final date range: 2024-09-20 04:40:00 to 2024-09-20 04:40:00
2024-09-20 04:46:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:46:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:40:00
2024-09-20 04:46:50 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:46:51 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:46:51 - INFO - GPT | 이전예측가격: 84571000 | 당시BTC가격: 84571000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:46:51 - INFO - ML 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 04:46:51 - INFO - ML | 이전예측가격: 84723228 | 당시BTC가격: 84571000 | 예측: 상승 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1813 | 반영가중치값: 0.0200 | 새 가중치: 0.2013 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 04:46:51 - INFO - XGBOOST | 이전예측가격: 84571000 | 당시BTC가격: 84571000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:46:51 - INFO - LSTM 모델 예측 업데이트: 정확도 54.84%, 적중/전체: 17/31
2024-09-20 04:46:51 - INFO - LSTM | 이전예측가격: 84789120 | 당시BTC가격: 84571000 | 예측: 상승 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 31 | 예측 성공 수: 17 | 예측 성공률: 54.84%
2024-09-20 04:46:51 - INFO - RL 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 44/72
2024-09-20 04:46:51 - INFO - RL | 이전예측가격: 85416710 | 당시BTC가격: 84571000 | 예측: 상승 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3384 | 반영가중치값: 0.0200 | 새 가중치: 0.3584 | 예측 총 횟수: 72 | 예측 성공 수: 44 | 예측 성공률: 61.11%
2024-09-20 04:46:51 - INFO - ARIMA 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 04:46:51 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84571000 | 예측: 상승 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0423 | 반영가중치값: 0.0200 | 새 가중치: 0.0623 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 04:46:51 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 40/65
2024-09-20 04:46:51 - INFO - PROPHET | 이전예측가격: 84527299 | 당시BTC가격: 84571000 | 예측: 하락 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1902 | 반영가중치값: -0.0200 | 새 가중치: 0.1702 | 예측 총 횟수: 65 | 예측 성공 수: 40 | 예측 성공률: 61.54%
2024-09-20 04:46:51 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.06%, 적중/전체: 18/31
2024-09-20 04:46:51 - INFO - TRANSFORMER | 이전예측가격: 84851244 | 당시BTC가격: 84571000 | 예측: 상승 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0478 | 반영가중치값: 0.0200 | 새 가중치: 0.0678 | 예측 총 횟수: 31 | 예측 성공 수: 18 | 예측 성공률: 58.06%
2024-09-20 04:46:51 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-20 04:46:51 - INFO - BITCOIN_FORECAST | 이전예측가격: 83047278 | 당시BTC가격: 84571000 | 예측: 하락 | 지금 BTC가격: 84841000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1309 | 반영가중치값: -0.0200 | 새 가중치: 0.1109 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-20 04:46:51 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:46:51 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:46:51 - INFO - 새로운 가중치: {'gpt': 0.0038207818182617115, 'ml': 0.18933671383691883, 'xgboost': 0.06430616101882095, 'rl': 0.33705009087964416, 'lstm': 0.018808413813636245, 'arima': 0.0585594662496498, 'prophet': 0.16001802308423466, 'transformer': 0.06379764285062296, 'bitcoin_forecast': 0.10430270644821067}
2024-09-20 04:46:51 - INFO - XGBoost 모델 성능: 정확도 62.18%, 적중/전체: 74/119
2024-09-20 04:46:51 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:46:51 - INFO - Current BTC price: 84768000.0
2024-09-20 04:46:51 - INFO - Analyzing market conditions.
2024-09-20 04:46:51 - INFO - Market analysis: {'current_price': 84841000.0, 'sma_20': 84798300.0, 'rsi_14': 55.9604005479568, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:46:51 - INFO - Starting predictions for all models
2024-09-20 04:46:51 - INFO - Attempting prediction for gpt
2024-09-20 04:46:51 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:46:51 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:46:51 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:46:51 - INFO - GPT prediction: 84768000.0
2024-09-20 04:46:51 - INFO - Attempting prediction for ml
2024-09-20 04:46:51 - INFO - ML prediction: 85027650.2
2024-09-20 04:46:51 - INFO - Attempting prediction for xgboost
2024-09-20 04:46:51 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:46:51 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:46:51 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:46:51 - INFO - XGBOOST prediction: 84841000.0
2024-09-20 04:46:51 - INFO - Attempting prediction for lstm
2024-09-20 04:46:51 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:46:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:46:51 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:46:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:46:51 - INFO - X 샘플:
[[ 0.01367814  0.03467412  0.39100348 -0.21762136 -0.16966023 -0.16984475
  -0.21762136]
 [ 0.01367814  0.69843587  0.37314944  0.45744898  0.00669161  0.00668542
   0.45744898]
 [ 0.4240224   0.69843587  1.06052999  0.93710423 -0.49941131 -0.49857382
   0.93710423]
 [ 1.65505518  1.07489775  1.6407863   1.28352191  0.31012194  0.31202312
   1.28352191]
 [ 0.96062643  0.44085668  0.4445656   0.78610165  2.82941974  2.82896701
   0.78610165]
 [ 0.8869749   0.74797032  0.06963076 -0.01332376  0.03657583  0.03647019
  -0.01332376]
 [-0.2598847   0.1832775  -0.14461773 -0.19097385 -0.76979576 -0.76952408
  -0.19097385]
 [-0.56501248 -1.34238383 -1.63543009 -1.64770459 -0.51051527 -0.51196455
  -1.64770459]
 [-1.77500196 -2.28353854 -1.63543009 -1.89641472 -0.66543498 -0.66632273
  -1.89641472]
 [-1.35413605 -0.25262574 -0.56418767  0.50186151 -0.56799157 -0.56791581
   0.50186151]]
2024-09-20 04:46:51 - INFO - y 샘플:
[0.50186151]
2024-09-20 04:46:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:46:51 - INFO - 모델 출력 (스케일링된 예측): [[0.01774233]]
2024-09-20 04:46:51 - INFO - 스케일러 역변환 후 예측 가격: 84786497.44658054
2024-09-20 04:46:51 - INFO - LSTMPredictor 최종 예측 가격: 84786497.44658054
2024-09-20 04:46:51 - INFO - LSTM prediction: 84786497.44658054
2024-09-20 04:46:51 - INFO - Attempting prediction for rl
2024-09-20 04:46:51 - INFO - Preparing state for RL agent.
2024-09-20 04:46:51 - INFO - Prepared state: [[8.48410000e+07 4.66356856e+00 3.19258375e-03 8.47983000e+07
  5.59604005e+01]]
2024-09-20 04:46:51 - INFO - RL prediction: 85615680.0
2024-09-20 04:46:51 - INFO - Attempting prediction for arima
2024-09-20 04:46:51 - INFO - ARIMA 예측 시작
2024-09-20 04:46:51 - INFO - 입력 데이터: {'open': 84670000.0, 'high': 84855000.0, 'low': 84653000.0, 'close': 84841000.0, 'volume': 4.66356856, 'value': 395359807.09385, 'decision': 'sell', 'sma': 84798300.0, 'ema': 84726709.96196105, 'rsi': 55.9604005479568, 'macd': 85806.83946505189, 'signal_line': 132601.32316255852, 'BB_Upper': 85068882.40889168, 'BB_Lower': 84527717.59110832}
2024-09-20 04:46:51 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:46:51 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84798300.0         0         0
2024-09-20 04:46:51 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84798300.0         0         0
2024-09-20 04:46:51 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:46:51 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:46:51 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:46:51 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:46:51 - INFO - Attempting prediction for prophet
2024-09-20 04:46:51 - INFO - PROPHET prediction: 84847469.4703263
2024-09-20 04:46:51 - INFO - Attempting prediction for transformer
2024-09-20 04:46:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:46:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:46:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:46:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:46:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:46:51 - INFO - X 샘플:
[[ 0.01367814  0.03467412  0.39100348 -0.21762136 -0.16966023 -0.16984475
  -0.21762136 -0.21762136  0.          0.          0.         -0.21762136
  -0.21762136]
 [ 0.01367814  0.69843587  0.37314944  0.45744898  0.00669161  0.00668542
   0.45744898  0.45744898  0.          0.          0.          0.45744898
   0.45744898]
 [ 0.4240224   0.69843587  1.06052999  0.93710423 -0.49941131 -0.49857382
   0.93710423  0.93710423  0.          0.          0.          0.93710423
   0.93710423]
 [ 1.65505518  1.07489775  1.6407863   1.28352191  0.31012194  0.31202312
   1.28352191  1.28352191  0.          0.          0.          1.28352191
   1.28352191]
 [ 0.96062643  0.44085668  0.4445656   0.78610165  2.82941974  2.82896701
   0.78610165  0.78610165  0.          0.          0.          0.78610165
   0.78610165]
 [ 0.8869749   0.74797032  0.06963076 -0.01332376  0.03657583  0.03647019
  -0.01332376 -0.01332376  0.          0.          0.         -0.01332376
  -0.01332376]
 [-0.2598847   0.1832775  -0.14461773 -0.19097385 -0.76979576 -0.76952408
  -0.19097385 -0.19097385  0.          0.          0.         -0.19097385
  -0.19097385]
 [-0.56501248 -1.34238383 -1.63543009 -1.64770459 -0.51051527 -0.51196455
  -1.64770459 -1.64770459  0.          0.          0.         -1.64770459
  -1.64770459]
 [-1.77500196 -2.28353854 -1.63543009 -1.89641472 -0.66543498 -0.66632273
  -1.89641472 -1.89641472  0.          0.          0.         -1.89641472
  -1.89641472]
 [-1.35413605 -0.25262574 -0.56418767  0.50186151 -0.56799157 -0.56791581
   0.50186151  0.50186151  0.          0.          0.          0.50186151
   0.50186151]]
2024-09-20 04:46:51 - INFO - y 샘플:
[0.50186151]
2024-09-20 04:46:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:46:51 - INFO - 모델 출력 (스케일링된 예측): [0.4797165]
2024-09-20 04:46:51 - INFO - 스케일러 역변환 후 예측 가격: 84838506.8971231
2024-09-20 04:46:51 - INFO - TransformerPredictor 최종 예측 가격: 84838506.8971231
2024-09-20 04:46:51 - INFO - TRANSFORMER prediction: 84838506.8971231
2024-09-20 04:46:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:46:51 - INFO - BITCOIN_FORECAST prediction: 83054486.88093616
2024-09-20 04:46:51 - INFO - BitcoinForecast prediction: 83054486.88093616
2024-09-20 04:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:47:10 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:47:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0038207818182617115, 'ml': 0.18933671383691883, 'xgboost': 0.06430616101882095, 'rl': 0.33705009087964416, 'lstm': 0.018808413813636245, 'arima': 0.0585594662496498, 'prophet': 0.16001802308423466, 'transformer': 0.06379764285062296, 'bitcoin_forecast': 0.10430270644821067}
2024-09-20 04:47:10 - INFO - 조정된 모델 가중치: {'gpt': 0.0038207818182617115, 'ml': 0.18933671383691883, 'xgboost': 0.06430616101882095, 'rl': 0.33705009087964416, 'lstm': 0.018808413813636245, 'arima': 0.0585594662496498, 'prophet': 0.16001802308423466, 'transformer': 0.06379764285062296, 'bitcoin_forecast': 0.10430270644821067}
2024-09-20 04:47:10 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84957238.36081776, 'current_price': 84768000.0, 'predictions': {'gpt': 84768000.0, 'ml': 85027650.2, 'xgboost': 84841000.0, 'lstm': 84786497.44658054, 'rl': 85615680.0, 'arima': 84953000.0, 'prophet': 84847469.4703263, 'transformer': 84838506.8971231, 'bitcoin_forecast': 83054486.88093616}, 'weights': {'gpt': 0.0038207818182617115, 'ml': 0.18933671383691883, 'xgboost': 0.06430616101882095, 'rl': 0.33705009087964416, 'lstm': 0.018808413813636245, 'arima': 0.0585594662496498, 'prophet': 0.16001802308423466, 'transformer': 0.06379764285062296, 'bitcoin_forecast': 0.10430270644821067}}
2024-09-20 04:47:10 - INFO - 모델별 가중치:
2024-09-20 04:47:10 - INFO -   - GPT: 0.0038
2024-09-20 04:47:10 - INFO -   - ML: 0.1893
2024-09-20 04:47:10 - INFO -   - XGBOOST: 0.0643
2024-09-20 04:47:10 - INFO -   - RL: 0.3371
2024-09-20 04:47:10 - INFO -   - LSTM: 0.0188
2024-09-20 04:47:10 - INFO -   - ARIMA: 0.0586
2024-09-20 04:47:10 - INFO -   - PROPHET: 0.1600
2024-09-20 04:47:10 - INFO -   - TRANSFORMER: 0.0638
2024-09-20 04:47:10 - INFO -   - BITCOIN_FORECAST: 0.1043
2024-09-20 04:47:10 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:47:10 - INFO - 6. 거래 실행
2024-09-20 04:47:10 - INFO - Cancelling existing orders.
2024-09-20 04:47:10 - INFO - Cancelled 0 orders.
2024-09-20 04:47:10 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84957238.36081776, 'current_price': 84768000.0, 'predictions': {'gpt': 84768000.0, 'ml': 85027650.2, 'xgboost': 84841000.0, 'lstm': 84786497.44658054, 'rl': 85615680.0, 'arima': 84953000.0, 'prophet': 84847469.4703263, 'transformer': 84838506.8971231, 'bitcoin_forecast': 83054486.88093616}, 'weights': {'gpt': 0.0038207818182617115, 'ml': 0.18933671383691883, 'xgboost': 0.06430616101882095, 'rl': 0.33705009087964416, 'lstm': 0.018808413813636245, 'arima': 0.0585594662496498, 'prophet': 0.16001802308423466, 'transformer': 0.06379764285062296, 'bitcoin_forecast': 0.10430270644821067}}, 현재 가격=84768000.0
2024-09-20 04:47:10 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=479869.6279702401
2024-09-20 04:47:10 - INFO - 매수 시도: 0.0005505861699018498 BTC (약 46672.08845024 KRW)
2024-09-20 04:47:10 - INFO - 주문 결과: None
2024-09-20 04:47:10 - ERROR - 주문 실패
2024-09-20 04:47:10 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:47:10 - INFO - 7. summary 리포트 보내기
2024-09-20 04:47:11 - INFO - Message sent to Discord successfully.
2024-09-20 04:47:11 - INFO - Trading cycle completed.
2024-09-20 04:47:11 - INFO - Performing periodic update.
2024-09-20 04:47:11 - INFO - 계산된 시장 변동성: 0.02624059028524342
2024-09-20 04:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:55:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-81b5-cd100fb2e2fc "HTTP/1.1 200 OK"
2024-09-20 04:55:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:55:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:55:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/f3d759a5-c205-4772-bdc5-0f97395b903d "HTTP/1.1 200 OK"
2024-09-20 04:55:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:55:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b8-8f68-d01c054d5174 "HTTP/1.1 200 OK"
2024-09-20 04:55:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fa-b23e-dd6297da0b3a "HTTP/1.1 200 OK"
2024-09-20 04:56:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ac-a50c-e4f71915ac0b "HTTP/1.1 200 OK"
2024-09-20 04:56:15 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819d-a424-fd56641f199c "HTTP/1.1 200 OK"
2024-09-20 04:56:23 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814f-b513-dd1a9367c696 "HTTP/1.1 200 OK"
2024-09-20 04:56:31 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814c-b485-e5be154d420e "HTTP/1.1 200 OK"
2024-09-20 04:56:36 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 04:56:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8131-904d-c6cc94039e65 "HTTP/1.1 200 OK"
2024-09-20 04:56:49 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:45:34.959441
2024-09-20 04:56:49 - INFO - Starting trading cycle.
2024-09-20 04:56:49 - INFO - ##################################################
2024-09-20 04:56:49 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-20 04:56:49 - INFO - ##################################################
2024-09-20 04:56:49 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 04:56:49 - INFO - 데이터베이스 업데이트 시작
2024-09-20 04:56:49 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:40:00
2024-09-20 04:56:49 - INFO - 새로운 데이터 범위: 2024-09-18 19:40:00 ~ 2024-09-20 04:50:00
2024-09-20 04:56:49 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 04:56:49 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 04:56:49 - INFO - Index: Index([199], dtype='int64')
2024-09-20 04:56:49 - INFO - Date column data type: datetime64[ns]
2024-09-20 04:56:49 - INFO - Sample date values: [Timestamp('2024-09-20 04:50:00')]
2024-09-20 04:56:50 - INFO - Successfully added 1 new data points
2024-09-20 04:56:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 04:56:50 - INFO - Final date range: 2024-09-20 04:50:00 to 2024-09-20 04:50:00
2024-09-20 04:56:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 04:56:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 04:50:00
2024-09-20 04:56:50 - INFO - 데이터베이스 업데이트 완료
2024-09-20 04:56:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 04:56:50 - INFO - GPT | 이전예측가격: 84768000 | 당시BTC가격: 84768000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 04:56:50 - INFO - ML 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 04:56:50 - INFO - ML | 이전예측가격: 85027650 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1633 | 반영가중치값: -0.0200 | 새 가중치: 0.1433 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 04:56:50 - INFO - XGBOOST 모델 예측 업데이트: 정확도 61.67%, 적중/전체: 74/120
2024-09-20 04:56:50 - INFO - XGBOOST | 이전예측가격: 84841000 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0684 | 반영가중치값: -0.0200 | 새 가중치: 0.0484 | 예측 총 횟수: 120 | 예측 성공 수: 74 | 예측 성공률: 61.67%
2024-09-20 04:56:50 - INFO - LSTM 모델 예측 업데이트: 정확도 53.12%, 적중/전체: 17/32
2024-09-20 04:56:50 - INFO - LSTM | 이전예측가격: 84786497 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1462 | 반영가중치값: -0.0200 | 새 가중치: 0.1262 | 예측 총 횟수: 32 | 예측 성공 수: 17 | 예측 성공률: 53.12%
2024-09-20 04:56:50 - INFO - RL 모델 예측 업데이트: 정확도 60.27%, 적중/전체: 44/73
2024-09-20 04:56:50 - INFO - RL | 이전예측가격: 85615680 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1449 | 반영가중치값: -0.0200 | 새 가중치: 0.1249 | 예측 총 횟수: 73 | 예측 성공 수: 44 | 예측 성공률: 60.27%
2024-09-20 04:56:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 04:56:50 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 04:56:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.61%, 적중/전체: 40/66
2024-09-20 04:56:50 - INFO - PROPHET | 이전예측가격: 84847469 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2099 | 반영가중치값: -0.0200 | 새 가중치: 0.1899 | 예측 총 횟수: 66 | 예측 성공 수: 40 | 예측 성공률: 60.61%
2024-09-20 04:56:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 18/32
2024-09-20 04:56:50 - INFO - TRANSFORMER | 이전예측가격: 84838507 | 당시BTC가격: 84768000 | 예측: 상승 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1736 | 반영가중치값: -0.0200 | 새 가중치: 0.1536 | 예측 총 횟수: 32 | 예측 성공 수: 18 | 예측 성공률: 56.25%
2024-09-20 04:56:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 69.23%, 적중/전체: 9/13
2024-09-20 04:56:50 - INFO - BITCOIN_FORECAST | 이전예측가격: 83054487 | 당시BTC가격: 84768000 | 예측: 하락 | 지금 BTC가격: 84506000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0897 | 반영가중치값: 0.0200 | 새 가중치: 0.1097 | 예측 총 횟수: 13 | 예측 성공 수: 9 | 예측 성공률: 69.23%
2024-09-20 04:56:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 04:56:50 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 04:56:50 - INFO - 새로운 가중치: {'gpt': 0.004246455245701185, 'ml': 0.15927182142732746, 'xgboost': 0.053770246881686724, 'rl': 0.13884898245227706, 'lstm': 0.14023863757887653, 'arima': 0.0, 'prophet': 0.21103143257712056, 'transformer': 0.17068924374943747, 'bitcoin_forecast': 0.12190318008757293}
2024-09-20 04:56:50 - INFO - XGBoost 모델 성능: 정확도 61.67%, 적중/전체: 74/120
2024-09-20 04:56:50 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 04:56:50 - INFO - Current BTC price: 84506000.0
2024-09-20 04:56:50 - INFO - Analyzing market conditions.
2024-09-20 04:56:50 - INFO - Market analysis: {'current_price': 84506000.0, 'sma_20': 84792100.0, 'rsi_14': 45.56821718519788, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 04:56:50 - INFO - Starting predictions for all models
2024-09-20 04:56:50 - INFO - Attempting prediction for gpt
2024-09-20 04:56:50 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 04:56:50 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:56:50 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 04:56:50 - INFO - GPT prediction: 84506000.0
2024-09-20 04:56:50 - INFO - Attempting prediction for ml
2024-09-20 04:56:50 - INFO - ML prediction: 84691913.2
2024-09-20 04:56:50 - INFO - Attempting prediction for xgboost
2024-09-20 04:56:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 04:56:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:56:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 04:56:50 - INFO - XGBOOST prediction: 84506000.0
2024-09-20 04:56:50 - INFO - Attempting prediction for lstm
2024-09-20 04:56:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:56:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:56:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:56:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:56:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:56:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 04:56:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:56:50 - INFO - X 샘플:
[[ 1.26257326e-02  7.59987824e-01  5.29301223e-01  5.47535698e-01
  -2.24443288e-03 -1.95413416e-03  5.47535698e-01]
 [ 4.22962042e-01  7.59987824e-01  1.13489103e+00  9.32021104e-01
  -5.08933684e-01 -5.07785935e-01  9.32021104e-01]
 [ 1.65397097e+00  1.12647941e+00  1.64610321e+00  1.20970501e+00
   3.01537433e-01  3.03729580e-01  1.20970501e+00]
 [ 9.59555677e-01  5.09230420e-01  5.92219644e-01  8.10979402e-01
   2.82375392e+00  2.82352571e+00  8.10979402e-01]
 [ 8.85905570e-01  8.08210401e-01  2.61897930e-01  1.70170393e-01
   2.76744134e-02  2.78643923e-02  1.70170393e-01]
 [-2.60931807e-01  2.58473016e-01  7.31426652e-02  2.77683904e-02
  -7.79631389e-01 -7.79043239e-01  2.77683904e-02]
 [-5.66053678e-01 -1.22678238e+00 -1.24027939e+00 -1.13992803e+00
  -5.20050516e-01 -5.21191843e-01 -1.13992803e+00]
 [-1.77601972e+00 -2.14301135e+00 -1.24027939e+00 -1.33929083e+00
  -6.75149701e-01 -6.75724945e-01 -1.33929083e+00]
 [-1.35516197e+00 -1.65885667e-01 -2.96503062e-01  5.83136199e-01
  -5.77593404e-01 -5.77206503e-01  5.83136199e-01]
 [ 2.31471764e-02 -6.86689506e-01 -1.46049386e+00 -1.80209734e+00
  -8.93626376e-02 -9.22130830e-02 -1.80209734e+00]]
2024-09-20 04:56:50 - INFO - y 샘플:
[-1.80209734]
2024-09-20 04:56:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 04:56:50 - INFO - 모델 출력 (스케일링된 예측): [[0.02538297]]
2024-09-20 04:56:50 - INFO - 스케일러 역변환 후 예측 가격: 84762664.97420925
2024-09-20 04:56:50 - INFO - LSTMPredictor 최종 예측 가격: 84762664.97420925
2024-09-20 04:56:50 - INFO - LSTM prediction: 84762664.97420925
2024-09-20 04:56:50 - INFO - Attempting prediction for rl
2024-09-20 04:56:50 - INFO - Preparing state for RL agent.
2024-09-20 04:56:50 - INFO - Prepared state: [[ 8.45060000e+07  8.39386758e+00 -3.94856261e-03  8.47921000e+07
   4.55682172e+01]]
2024-09-20 04:56:50 - INFO - RL prediction: 85351060.0
2024-09-20 04:56:50 - INFO - Attempting prediction for arima
2024-09-20 04:56:50 - INFO - ARIMA 예측 시작
2024-09-20 04:56:50 - INFO - 입력 데이터: {'open': 84801000.0, 'high': 84801000.0, 'low': 84505000.0, 'close': 84506000.0, 'volume': 8.39386758, 'value': 710006032.16507, 'decision': 'sell', 'sma': 84792100.0, 'ema': 84705689.9655838, 'rsi': 45.56821718519788, 'macd': 59068.878968670964, 'signal_line': 117894.83432378102, 'BB_Upper': 85082761.24612342, 'BB_Lower': 84501438.75387658}
2024-09-20 04:56:50 - INFO - Exogenous 변수 예측 시작
2024-09-20 04:56:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84792100.0         0         0
2024-09-20 04:56:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84792100.0         0         0
2024-09-20 04:56:50 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 04:56:50 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 04:56:50 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 04:56:50 - INFO - ARIMA prediction: 84953000.0
2024-09-20 04:56:50 - INFO - Attempting prediction for prophet
2024-09-20 04:56:51 - INFO - PROPHET prediction: 84457444.05129202
2024-09-20 04:56:51 - INFO - Attempting prediction for transformer
2024-09-20 04:56:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:56:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 04:56:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 04:56:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 04:56:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 04:56:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 04:56:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 04:56:51 - INFO - X 샘플:
[[ 1.26257326e-02  7.59987824e-01  5.29301223e-01  5.47535698e-01
  -2.24443288e-03 -1.95413416e-03  5.47535698e-01  5.47535698e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  5.47535698e-01
   5.47535698e-01]
 [ 4.22962042e-01  7.59987824e-01  1.13489103e+00  9.32021104e-01
  -5.08933684e-01 -5.07785935e-01  9.32021104e-01  9.32021104e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.32021104e-01
   9.32021104e-01]
 [ 1.65397097e+00  1.12647941e+00  1.64610321e+00  1.20970501e+00
   3.01537433e-01  3.03729580e-01  1.20970501e+00  1.20970501e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.20970501e+00
   1.20970501e+00]
 [ 9.59555677e-01  5.09230420e-01  5.92219644e-01  8.10979402e-01
   2.82375392e+00  2.82352571e+00  8.10979402e-01  8.10979402e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.10979402e-01
   8.10979402e-01]
 [ 8.85905570e-01  8.08210401e-01  2.61897930e-01  1.70170393e-01
   2.76744134e-02  2.78643923e-02  1.70170393e-01  1.70170393e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.70170393e-01
   1.70170393e-01]
 [-2.60931807e-01  2.58473016e-01  7.31426652e-02  2.77683904e-02
  -7.79631389e-01 -7.79043239e-01  2.77683904e-02  2.77683904e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.77683904e-02
   2.77683904e-02]
 [-5.66053678e-01 -1.22678238e+00 -1.24027939e+00 -1.13992803e+00
  -5.20050516e-01 -5.21191843e-01 -1.13992803e+00 -1.13992803e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.13992803e+00
  -1.13992803e+00]
 [-1.77601972e+00 -2.14301135e+00 -1.24027939e+00 -1.33929083e+00
  -6.75149701e-01 -6.75724945e-01 -1.33929083e+00 -1.33929083e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.33929083e+00
  -1.33929083e+00]
 [-1.35516197e+00 -1.65885667e-01 -2.96503062e-01  5.83136199e-01
  -5.77593404e-01 -5.77206503e-01  5.83136199e-01  5.83136199e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  5.83136199e-01
   5.83136199e-01]
 [ 2.31471764e-02 -6.86689506e-01 -1.46049386e+00 -1.80209734e+00
  -8.93626376e-02 -9.22130830e-02 -1.80209734e+00 -1.80209734e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.80209734e+00
  -1.80209734e+00]]
2024-09-20 04:56:51 - INFO - y 샘플:
[-1.80209734]
2024-09-20 04:56:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 04:56:51 - INFO - 모델 출력 (스케일링된 예측): [0.4737986]
2024-09-20 04:56:51 - INFO - 스케일러 역변환 후 예측 가격: 84825643.81196979
2024-09-20 04:56:51 - INFO - TransformerPredictor 최종 예측 가격: 84825643.81196979
2024-09-20 04:56:51 - INFO - TRANSFORMER prediction: 84825643.81196979
2024-09-20 04:56:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 04:56:51 - INFO - BITCOIN_FORECAST prediction: 83111567.769376
2024-09-20 04:56:51 - INFO - BitcoinForecast prediction: 83111567.769376
2024-09-20 04:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:57:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:57:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:57:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:57:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 04:57:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 04:57:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004246455245701185, 'ml': 0.15927182142732746, 'xgboost': 0.053770246881686724, 'rl': 0.13884898245227706, 'lstm': 0.14023863757887653, 'arima': 0.0, 'prophet': 0.21103143257712056, 'transformer': 0.17068924374943747, 'bitcoin_forecast': 0.12190318008757293}
2024-09-20 04:57:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004246455245701185, 'ml': 0.15927182142732746, 'xgboost': 0.053770246881686724, 'rl': 0.13884898245227706, 'lstm': 0.14023863757887653, 'arima': 0.0, 'prophet': 0.21103143257712056, 'transformer': 0.17068924374943747, 'bitcoin_forecast': 0.12190318008757293}
2024-09-20 04:57:07 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84563268.00718848, 'current_price': 84506000.0, 'predictions': {'gpt': 84506000.0, 'ml': 84691913.2, 'xgboost': 84506000.0, 'lstm': 84762664.97420925, 'rl': 85351060.0, 'arima': 84953000.0, 'prophet': 84457444.05129202, 'transformer': 84825643.81196979, 'bitcoin_forecast': 83111567.769376}, 'weights': {'gpt': 0.004246455245701185, 'ml': 0.15927182142732746, 'xgboost': 0.053770246881686724, 'rl': 0.13884898245227706, 'lstm': 0.14023863757887653, 'arima': 0.0, 'prophet': 0.21103143257712056, 'transformer': 0.17068924374943747, 'bitcoin_forecast': 0.12190318008757293}}
2024-09-20 04:57:07 - INFO - 모델별 가중치:
2024-09-20 04:57:07 - INFO -   - GPT: 0.0042
2024-09-20 04:57:07 - INFO -   - ML: 0.1593
2024-09-20 04:57:07 - INFO -   - XGBOOST: 0.0538
2024-09-20 04:57:07 - INFO -   - RL: 0.1388
2024-09-20 04:57:07 - INFO -   - LSTM: 0.1402
2024-09-20 04:57:07 - INFO -   - ARIMA: 0.0000
2024-09-20 04:57:07 - INFO -   - PROPHET: 0.2110
2024-09-20 04:57:07 - INFO -   - TRANSFORMER: 0.1707
2024-09-20 04:57:07 - INFO -   - BITCOIN_FORECAST: 0.1219
2024-09-20 04:57:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 04:57:07 - INFO - 6. 거래 실행
2024-09-20 04:57:07 - INFO - Cancelling existing orders.
2024-09-20 04:57:07 - INFO - Cancelled 0 orders.
2024-09-20 04:57:07 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84563268.00718848, 'current_price': 84506000.0, 'predictions': {'gpt': 84506000.0, 'ml': 84691913.2, 'xgboost': 84506000.0, 'lstm': 84762664.97420925, 'rl': 85351060.0, 'arima': 84953000.0, 'prophet': 84457444.05129202, 'transformer': 84825643.81196979, 'bitcoin_forecast': 83111567.769376}, 'weights': {'gpt': 0.004246455245701185, 'ml': 0.15927182142732746, 'xgboost': 0.053770246881686724, 'rl': 0.13884898245227706, 'lstm': 0.14023863757887653, 'arima': 0.0, 'prophet': 0.21103143257712056, 'transformer': 0.17068924374943747, 'bitcoin_forecast': 0.12190318008757293}}, 현재 가격=84506000.0
2024-09-20 04:57:07 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=478530.70579023997
2024-09-20 04:57:07 - INFO - 매수 시도: 0.0005522931916105365 BTC (약 46672.08845024 KRW)
2024-09-20 04:57:07 - INFO - 주문 결과: None
2024-09-20 04:57:07 - ERROR - 주문 실패
2024-09-20 04:57:07 - WARNING - Trade execution failed: Failed to place order
2024-09-20 04:57:07 - INFO - 7. summary 리포트 보내기
2024-09-20 04:57:07 - INFO - Message sent to Discord successfully.
2024-09-20 04:57:07 - INFO - Trading cycle completed.
2024-09-20 04:57:07 - INFO - Performing periodic update.
2024-09-20 04:57:07 - INFO - 계산된 시장 변동성: 0.026974830282351665
2024-09-20 05:05:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:05:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81aa-8453-d0e366c5fbde "HTTP/1.1 200 OK"
2024-09-20 05:05:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:05:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:05:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f6-ab29-cf5a4a800fae "HTTP/1.1 200 OK"
2024-09-20 05:05:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:05:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d2-9f3f-de99556a030e "HTTP/1.1 200 OK"
2024-09-20 05:06:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ce-ad2f-ebcfc011067f "HTTP/1.1 200 OK"
2024-09-20 05:06:08 - INFO - Updated actual price for lstm prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8124-aea0-eed728d957ca "HTTP/1.1 200 OK"
2024-09-20 05:06:18 - INFO - Updated actual price for rl prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/c53b74e0-8069-42b1-84ea-0ed0a67e2d4c "HTTP/1.1 200 OK"
2024-09-20 05:06:23 - INFO - Updated actual price for arima prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-a256-ccf18db7ce96 "HTTP/1.1 200 OK"
2024-09-20 05:06:31 - INFO - Updated actual price for prophet prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-8b55-e56ee628e7db "HTTP/1.1 200 OK"
2024-09-20 05:06:38 - INFO - Updated actual price for transformer prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:06:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/32c6e7ae-4cd0-4ff3-8025-79579eb85723 "HTTP/1.1 200 OK"
2024-09-20 05:06:44 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 04:55:34.959915
2024-09-20 05:06:44 - INFO - Starting trading cycle.
2024-09-20 05:06:44 - INFO - ##################################################
2024-09-20 05:06:44 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-20 05:06:44 - INFO - ##################################################
2024-09-20 05:06:44 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:06:44 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:06:44 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 04:50:00
2024-09-20 05:06:44 - INFO - 새로운 데이터 범위: 2024-09-18 19:50:00 ~ 2024-09-20 05:00:00
2024-09-20 05:06:44 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:06:44 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:06:44 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:06:44 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:06:44 - INFO - Sample date values: [Timestamp('2024-09-20 05:00:00')]
2024-09-20 05:06:44 - INFO - Successfully added 1 new data points
2024-09-20 05:06:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:06:44 - INFO - Final date range: 2024-09-20 05:00:00 to 2024-09-20 05:00:00
2024-09-20 05:06:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:06:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:00:00
2024-09-20 05:06:44 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:06:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:06:44 - INFO - GPT | 이전예측가격: 84506000 | 당시BTC가격: 84506000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:06:44 - INFO - ML 모델 예측 업데이트: 정확도 38.46%, 적중/전체: 5/13
2024-09-20 05:06:44 - INFO - ML | 이전예측가격: 84691913 | 당시BTC가격: 84506000 | 예측: 상승 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1893 | 반영가중치값: -0.0200 | 새 가중치: 0.1693 | 예측 총 횟수: 13 | 예측 성공 수: 5 | 예측 성공률: 38.46%
2024-09-20 05:06:44 - INFO - XGBOOST | 이전예측가격: 84506000 | 당시BTC가격: 84506000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:06:44 - INFO - LSTM 모델 예측 업데이트: 정확도 51.52%, 적중/전체: 17/33
2024-09-20 05:06:44 - INFO - LSTM | 이전예측가격: 84762665 | 당시BTC가격: 84506000 | 예측: 상승 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0188 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 33 | 예측 성공 수: 17 | 예측 성공률: 51.52%
2024-09-20 05:06:44 - INFO - RL 모델 예측 업데이트: 정확도 59.46%, 적중/전체: 44/74
2024-09-20 05:06:44 - INFO - RL | 이전예측가격: 85351060 | 당시BTC가격: 84506000 | 예측: 상승 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3371 | 반영가중치값: -0.0200 | 새 가중치: 0.3171 | 예측 총 횟수: 74 | 예측 성공 수: 44 | 예측 성공률: 59.46%
2024-09-20 05:06:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 38.46%, 적중/전체: 5/13
2024-09-20 05:06:44 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84506000 | 예측: 상승 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0586 | 반영가중치값: -0.0200 | 새 가중치: 0.0386 | 예측 총 횟수: 13 | 예측 성공 수: 5 | 예측 성공률: 38.46%
2024-09-20 05:06:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.19%, 적중/전체: 41/67
2024-09-20 05:06:44 - INFO - PROPHET | 이전예측가격: 84457444 | 당시BTC가격: 84506000 | 예측: 하락 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1600 | 반영가중치값: 0.0200 | 새 가중치: 0.1800 | 예측 총 횟수: 67 | 예측 성공 수: 41 | 예측 성공률: 61.19%
2024-09-20 05:06:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 18/33
2024-09-20 05:06:44 - INFO - TRANSFORMER | 이전예측가격: 84825644 | 당시BTC가격: 84506000 | 예측: 상승 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0638 | 반영가중치값: -0.0200 | 새 가중치: 0.0438 | 예측 총 횟수: 33 | 예측 성공 수: 18 | 예측 성공률: 54.55%
2024-09-20 05:06:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 10/14
2024-09-20 05:06:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83111568 | 당시BTC가격: 84506000 | 예측: 하락 | 지금 BTC가격: 84479000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1043 | 반영가중치값: 0.0200 | 새 가중치: 0.1243 | 예측 총 횟수: 14 | 예측 성공 수: 10 | 예측 성공률: 71.43%
2024-09-20 05:06:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:06:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:06:44 - INFO - 새로운 가중치: {'gpt': 0.0045607779237883915, 'ml': 0.18187101981967704, 'xgboost': 0.057750321325747256, 'rl': 0.34051814314605316, 'lstm': 0.0, 'arima': 0.041413638493540225, 'prophet': 0.1933429597304133, 'transformer': 0.047039545001517205, 'bitcoin_forecast': 0.13350359455926342}
2024-09-20 05:06:44 - INFO - XGBoost 모델 성능: 정확도 61.67%, 적중/전체: 74/120
2024-09-20 05:06:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:06:45 - INFO - Current BTC price: 84479000.0
2024-09-20 05:06:45 - INFO - Analyzing market conditions.
2024-09-20 05:06:45 - INFO - Market analysis: {'current_price': 84479000.0, 'sma_20': 84783750.0, 'rsi_14': 44.845368780641074, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:06:45 - INFO - Starting predictions for all models
2024-09-20 05:06:45 - INFO - Attempting prediction for gpt
2024-09-20 05:06:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:06:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:06:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:06:45 - INFO - GPT prediction: 84479000.0
2024-09-20 05:06:45 - INFO - Attempting prediction for ml
2024-09-20 05:06:45 - INFO - ML prediction: 84631062.2
2024-09-20 05:06:45 - INFO - Attempting prediction for xgboost
2024-09-20 05:06:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:06:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:06:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:06:45 - INFO - XGBOOST prediction: 84479000.0
2024-09-20 05:06:45 - INFO - Attempting prediction for lstm
2024-09-20 05:06:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:06:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:06:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:06:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:06:45 - INFO - X 샘플:
[[ 0.538899    0.8851394   1.20350778  1.03911632 -0.58320019 -0.58162056
   1.03911632]
 [ 1.46612227  1.17711246  1.6427442   1.28236684  0.19348086  0.19665331
   1.28236684]
 [ 0.94307324  0.68536835  0.73724143  0.93308404  2.61054139  2.61323245
   0.93308404]
 [ 0.88759835  0.92355691  0.45342713  0.37173669 -0.06896429 -0.06791177
   0.37173669]
 [ 0.02377496  0.48559731  0.29124753  0.24699283 -0.84261199 -0.8417665
   0.24699283]
 [-0.20604962 -0.69766196 -0.83725218 -0.77590678 -0.59385354 -0.59447733
  -0.77590678]
 [-1.11742292 -1.42759462 -0.83725218 -0.95054818 -0.74248634 -0.74268038
  -0.95054818]
 [-0.80042351  0.14752323 -0.02635418  0.73349387 -0.64899735 -0.64819749
   0.73349387]
 [ 0.23774956 -0.26738586 -1.02646172 -1.35596571 -0.18112185 -0.18307058
  -1.35596571]
 [-1.97332133 -1.91165523 -1.6008478  -1.52436992  0.85721329  0.84983885
  -1.52436992]]
2024-09-20 05:06:45 - INFO - y 샘플:
[-1.52436992]
2024-09-20 05:06:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:06:45 - INFO - 모델 출력 (스케일링된 예측): [[0.05130841]]
2024-09-20 05:06:45 - INFO - 스케일러 역변환 후 예측 가격: 84731626.20208704
2024-09-20 05:06:45 - INFO - LSTMPredictor 최종 예측 가격: 84731626.20208704
2024-09-20 05:06:45 - INFO - LSTM prediction: 84731626.20208704
2024-09-20 05:06:45 - INFO - Attempting prediction for rl
2024-09-20 05:06:45 - INFO - Preparing state for RL agent.
2024-09-20 05:06:45 - INFO - Prepared state: [[ 8.44790000e+07  1.66723530e+01 -3.19503941e-04  8.47837500e+07
   4.48453688e+01]]
2024-09-20 05:06:45 - INFO - RL prediction: 85323790.0
2024-09-20 05:06:45 - INFO - Attempting prediction for arima
2024-09-20 05:06:45 - INFO - ARIMA 예측 시작
2024-09-20 05:06:45 - INFO - 입력 데이터: {'open': 84522000.0, 'high': 84587000.0, 'low': 84420000.0, 'close': 84479000.0, 'volume': 16.67235301, 'value': 1408742331.47319, 'decision': 'sell', 'sma': 84783750.0, 'ema': 84684100.44505201, 'rsi': 44.845368780641074, 'macd': 35293.33864851296, 'signal_line': 101374.53518872742, 'BB_Upper': 85099253.32803002, 'BB_Lower': 84468246.67196998}
2024-09-20 05:06:45 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:06:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84783750.0         0         0
2024-09-20 05:06:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84783750.0         0         0
2024-09-20 05:06:45 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:06:45 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:06:45 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:06:45 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:06:45 - INFO - Attempting prediction for prophet
2024-09-20 05:06:45 - INFO - PROPHET prediction: 84431259.41807541
2024-09-20 05:06:45 - INFO - Attempting prediction for transformer
2024-09-20 05:06:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:06:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:06:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:06:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:06:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:06:45 - INFO - X 샘플:
[[ 0.538899    0.8851394   1.20350778  1.03911632 -0.58320019 -0.58162056
   1.03911632  1.03911632  0.          0.          0.          1.03911632
   1.03911632]
 [ 1.46612227  1.17711246  1.6427442   1.28236684  0.19348086  0.19665331
   1.28236684  1.28236684  0.          0.          0.          1.28236684
   1.28236684]
 [ 0.94307324  0.68536835  0.73724143  0.93308404  2.61054139  2.61323245
   0.93308404  0.93308404  0.          0.          0.          0.93308404
   0.93308404]
 [ 0.88759835  0.92355691  0.45342713  0.37173669 -0.06896429 -0.06791177
   0.37173669  0.37173669  0.          0.          0.          0.37173669
   0.37173669]
 [ 0.02377496  0.48559731  0.29124753  0.24699283 -0.84261199 -0.8417665
   0.24699283  0.24699283  0.          0.          0.          0.24699283
   0.24699283]
 [-0.20604962 -0.69766196 -0.83725218 -0.77590678 -0.59385354 -0.59447733
  -0.77590678 -0.77590678  0.          0.          0.         -0.77590678
  -0.77590678]
 [-1.11742292 -1.42759462 -0.83725218 -0.95054818 -0.74248634 -0.74268038
  -0.95054818 -0.95054818  0.          0.          0.         -0.95054818
  -0.95054818]
 [-0.80042351  0.14752323 -0.02635418  0.73349387 -0.64899735 -0.64819749
   0.73349387  0.73349387  0.          0.          0.          0.73349387
   0.73349387]
 [ 0.23774956 -0.26738586 -1.02646172 -1.35596571 -0.18112185 -0.18307058
  -1.35596571 -1.35596571  0.          0.          0.         -1.35596571
  -1.35596571]
 [-1.97332133 -1.91165523 -1.6008478  -1.52436992  0.85721329  0.84983885
  -1.52436992 -1.52436992  0.          0.          0.         -1.52436992
  -1.52436992]]
2024-09-20 05:06:45 - INFO - y 샘플:
[-1.52436992]
2024-09-20 05:06:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:06:45 - INFO - 모델 출력 (스케일링된 예측): [0.47263077]
2024-09-20 05:06:45 - INFO - 스케일러 역변환 후 예측 가격: 84799176.2000666
2024-09-20 05:06:45 - INFO - TransformerPredictor 최종 예측 가격: 84799176.2000666
2024-09-20 05:06:45 - INFO - TRANSFORMER prediction: 84799176.2000666
2024-09-20 05:06:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:06:45 - INFO - BITCOIN_FORECAST prediction: 83261591.88454245
2024-09-20 05:06:45 - INFO - BitcoinForecast prediction: 83261591.88454245
2024-09-20 05:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:06:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:06:58 - INFO - 조정된 모델 가중치: {'gpt': 0.0045607779237883915, 'ml': 0.18187101981967704, 'xgboost': 0.057750321325747256, 'rl': 0.34051814314605316, 'lstm': 0.0, 'arima': 0.041413638493540225, 'prophet': 0.1933429597304133, 'transformer': 0.047039545001517205, 'bitcoin_forecast': 0.13350359455926342}
2024-09-20 05:06:58 - INFO - 조정된 모델 가중치: {'gpt': 0.0045607779237883915, 'ml': 0.18187101981967704, 'xgboost': 0.057750321325747256, 'rl': 0.34051814314605316, 'lstm': 0.0, 'arima': 0.041413638493540225, 'prophet': 0.1933429597304133, 'transformer': 0.047039545001517205, 'bitcoin_forecast': 0.13350359455926342}
2024-09-20 05:06:58 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84657254.37208802, 'current_price': 84479000.0, 'predictions': {'gpt': 84479000.0, 'ml': 84631062.2, 'xgboost': 84479000.0, 'lstm': 84731626.20208704, 'rl': 85323790.0, 'arima': 84953000.0, 'prophet': 84431259.41807541, 'transformer': 84799176.2000666, 'bitcoin_forecast': 83261591.88454245}, 'weights': {'gpt': 0.0045607779237883915, 'ml': 0.18187101981967704, 'xgboost': 0.057750321325747256, 'rl': 0.34051814314605316, 'lstm': 0.0, 'arima': 0.041413638493540225, 'prophet': 0.1933429597304133, 'transformer': 0.047039545001517205, 'bitcoin_forecast': 0.13350359455926342}}
2024-09-20 05:06:58 - INFO - 모델별 가중치:
2024-09-20 05:06:58 - INFO -   - GPT: 0.0046
2024-09-20 05:06:58 - INFO -   - ML: 0.1819
2024-09-20 05:06:58 - INFO -   - XGBOOST: 0.0578
2024-09-20 05:06:58 - INFO -   - RL: 0.3405
2024-09-20 05:06:58 - INFO -   - LSTM: 0.0000
2024-09-20 05:06:58 - INFO -   - ARIMA: 0.0414
2024-09-20 05:06:58 - INFO -   - PROPHET: 0.1933
2024-09-20 05:06:58 - INFO -   - TRANSFORMER: 0.0470
2024-09-20 05:06:58 - INFO -   - BITCOIN_FORECAST: 0.1335
2024-09-20 05:06:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:06:58 - INFO - 6. 거래 실행
2024-09-20 05:06:58 - INFO - Cancelling existing orders.
2024-09-20 05:06:58 - INFO - Cancelled 0 orders.
2024-09-20 05:06:58 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84657254.37208802, 'current_price': 84479000.0, 'predictions': {'gpt': 84479000.0, 'ml': 84631062.2, 'xgboost': 84479000.0, 'lstm': 84731626.20208704, 'rl': 85323790.0, 'arima': 84953000.0, 'prophet': 84431259.41807541, 'transformer': 84799176.2000666, 'bitcoin_forecast': 83261591.88454245}, 'weights': {'gpt': 0.0045607779237883915, 'ml': 0.18187101981967704, 'xgboost': 0.057750321325747256, 'rl': 0.34051814314605316, 'lstm': 0.0, 'arima': 0.041413638493540225, 'prophet': 0.1933429597304133, 'transformer': 0.047039545001517205, 'bitcoin_forecast': 0.13350359455926342}}, 현재 가격=84479000.0
2024-09-20 05:06:59 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=478392.72526024
2024-09-20 05:06:59 - INFO - 매수 시도: 0.0005524697078592313 BTC (약 46672.08845024 KRW)
2024-09-20 05:06:59 - INFO - 주문 결과: None
2024-09-20 05:06:59 - ERROR - 주문 실패
2024-09-20 05:06:59 - WARNING - Trade execution failed: Failed to place order
2024-09-20 05:06:59 - INFO - 7. summary 리포트 보내기
2024-09-20 05:06:59 - INFO - Message sent to Discord successfully.
2024-09-20 05:06:59 - INFO - Trading cycle completed.
2024-09-20 05:06:59 - INFO - Performing periodic update.
2024-09-20 05:06:59 - INFO - 계산된 시장 변동성: 0.02675808871132828
2024-09-20 05:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:15:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8168-8ee2-fd391a71d39e "HTTP/1.1 200 OK"
2024-09-20 05:15:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:15:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:15:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819c-a1d1-c71de17ed199 "HTTP/1.1 200 OK"
2024-09-20 05:15:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:15:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8150-8d2d-d2aa1f31d366 "HTTP/1.1 200 OK"
2024-09-20 05:15:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8169-b8c6-c07f86dfa277 "HTTP/1.1 200 OK"
2024-09-20 05:16:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819d-ba8d-fa5cd2ad708d "HTTP/1.1 200 OK"
2024-09-20 05:16:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a2-a270-c4b911ac318c "HTTP/1.1 200 OK"
2024-09-20 05:16:15 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8142-9420-fd19ca8847ed "HTTP/1.1 200 OK"
2024-09-20 05:16:23 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8170-b570-d35b2c61925c "HTTP/1.1 200 OK"
2024-09-20 05:16:29 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:16:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-ab6e-fc71151bc264 "HTTP/1.1 200 OK"
2024-09-20 05:16:35 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:05:34.960186
2024-09-20 05:16:35 - INFO - Starting trading cycle.
2024-09-20 05:16:35 - INFO - ##################################################
2024-09-20 05:16:35 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-20 05:16:35 - INFO - ##################################################
2024-09-20 05:16:35 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:16:35 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:16:35 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:00:00
2024-09-20 05:16:36 - INFO - 새로운 데이터 범위: 2024-09-18 20:00:00 ~ 2024-09-20 05:10:00
2024-09-20 05:16:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:16:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:16:36 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:16:36 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:16:36 - INFO - Sample date values: [Timestamp('2024-09-20 05:10:00')]
2024-09-20 05:16:36 - INFO - Successfully added 1 new data points
2024-09-20 05:16:36 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:16:36 - INFO - Final date range: 2024-09-20 05:10:00 to 2024-09-20 05:10:00
2024-09-20 05:16:36 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:16:36 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:10:00
2024-09-20 05:16:36 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:16:36 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:16:36 - INFO - GPT | 이전예측가격: 84479000 | 당시BTC가격: 84479000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:16:36 - INFO - ML 모델 예측 업데이트: 정확도 35.71%, 적중/전체: 5/14
2024-09-20 05:16:36 - INFO - ML | 이전예측가격: 84631062 | 당시BTC가격: 84479000 | 예측: 상승 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1593 | 반영가중치값: -0.0200 | 새 가중치: 0.1393 | 예측 총 횟수: 14 | 예측 성공 수: 5 | 예측 성공률: 35.71%
2024-09-20 05:16:36 - INFO - XGBOOST | 이전예측가격: 84479000 | 당시BTC가격: 84479000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:16:36 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 17/34
2024-09-20 05:16:36 - INFO - LSTM | 이전예측가격: 84731626 | 당시BTC가격: 84479000 | 예측: 상승 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1402 | 반영가중치값: -0.0200 | 새 가중치: 0.1202 | 예측 총 횟수: 34 | 예측 성공 수: 17 | 예측 성공률: 50.00%
2024-09-20 05:16:36 - INFO - RL 모델 예측 업데이트: 정확도 58.67%, 적중/전체: 44/75
2024-09-20 05:16:36 - INFO - RL | 이전예측가격: 85323790 | 당시BTC가격: 84479000 | 예측: 상승 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1388 | 반영가중치값: -0.0200 | 새 가중치: 0.1188 | 예측 총 횟수: 75 | 예측 성공 수: 44 | 예측 성공률: 58.67%
2024-09-20 05:16:36 - INFO - ARIMA 모델 예측 업데이트: 정확도 35.71%, 적중/전체: 5/14
2024-09-20 05:16:36 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84479000 | 예측: 상승 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 14 | 예측 성공 수: 5 | 예측 성공률: 35.71%
2024-09-20 05:16:36 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.76%, 적중/전체: 42/68
2024-09-20 05:16:36 - INFO - PROPHET | 이전예측가격: 84431259 | 당시BTC가격: 84479000 | 예측: 하락 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2110 | 반영가중치값: 0.0200 | 새 가중치: 0.2310 | 예측 총 횟수: 68 | 예측 성공 수: 42 | 예측 성공률: 61.76%
2024-09-20 05:16:36 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 18/34
2024-09-20 05:16:36 - INFO - TRANSFORMER | 이전예측가격: 84799176 | 당시BTC가격: 84479000 | 예측: 상승 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1707 | 반영가중치값: -0.0200 | 새 가중치: 0.1507 | 예측 총 횟수: 34 | 예측 성공 수: 18 | 예측 성공률: 52.94%
2024-09-20 05:16:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 73.33%, 적중/전체: 11/15
2024-09-20 05:16:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83261592 | 당시BTC가격: 84479000 | 예측: 하락 | 지금 BTC가격: 84391000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1219 | 반영가중치값: 0.0200 | 새 가중치: 0.1419 | 예측 총 횟수: 15 | 예측 성공 수: 11 | 예측 성공률: 73.33%
2024-09-20 05:16:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:16:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:16:36 - INFO - 새로운 가중치: {'gpt': 0.004729653036873008, 'ml': 0.14442873653831448, 'xgboost': 0.05988868285255835, 'rl': 0.12324968682486537, 'lstm': 0.12469079768348569, 'arima': 0.0, 'prophet': 0.2395859949685632, 'transformer': 0.1562689197398184, 'bitcoin_forecast': 0.14715752835552148}
2024-09-20 05:16:36 - INFO - XGBoost 모델 성능: 정확도 61.67%, 적중/전체: 74/120
2024-09-20 05:16:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:16:36 - INFO - Current BTC price: 84391000.0
2024-09-20 05:16:36 - INFO - Analyzing market conditions.
2024-09-20 05:16:36 - INFO - Market analysis: {'current_price': 84381000.0, 'sma_20': 84759000.0, 'rsi_14': 42.227047696274944, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:16:36 - INFO - Starting predictions for all models
2024-09-20 05:16:36 - INFO - Attempting prediction for gpt
2024-09-20 05:16:36 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:16:36 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:16:36 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:16:36 - INFO - GPT prediction: 84391000.0
2024-09-20 05:16:36 - INFO - Attempting prediction for ml
2024-09-20 05:16:36 - INFO - ML prediction: 84532885.8
2024-09-20 05:16:36 - INFO - Attempting prediction for xgboost
2024-09-20 05:16:36 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:16:36 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:16:36 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:16:36 - INFO - XGBOOST prediction: 84381000.0
2024-09-20 05:16:36 - INFO - Attempting prediction for lstm
2024-09-20 05:16:36 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:16:36 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:16:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:16:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:16:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:16:36 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:16:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:16:36 - INFO - X 샘플:
[[ 1.41281377  1.205795    1.81083748  1.43247702  0.18560456  0.18918135
   1.43247702]
 [ 1.0007691   0.82824666  0.97983672  1.1197335   2.6142652   2.61679096
   1.1197335 ]
 [ 0.95706739  1.01112164  0.71937379  0.61710998 -0.07810014 -0.07659133
   0.61710998]
 [ 0.27656938  0.67486765  0.57053784  0.50541587 -0.85546078 -0.85397832
   0.50541587]
 [ 0.09551945 -0.23360803 -0.46511237 -0.41047587 -0.60550846 -0.60556039
  -0.41047587]
 [-0.62243717 -0.79403134 -0.46511237 -0.56684763 -0.7548546  -0.75443991
  -0.56684763]
 [-0.37271313  0.41530317  0.27906742  0.94102291 -0.66091693 -0.65952576
   0.94102291]
 [ 0.4451331   0.09674676 -0.63875432 -0.9298535  -0.19079597 -0.19227578
  -0.9298535 ]
 [-1.29669209 -1.16568048 -1.16588166 -1.08064056  0.85252242  0.84534836
  -1.08064056]
 [-1.89602979 -2.03876101 -1.62479253 -1.62794172 -0.50675531 -0.50894917
  -1.62794172]]
2024-09-20 05:16:36 - INFO - y 샘플:
[-1.62794172]
2024-09-20 05:16:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:16:36 - INFO - 모델 출력 (스케일링된 예측): [[0.00307091]]
2024-09-20 05:16:36 - INFO - 스케일러 역변환 후 예측 가격: 84673049.87782027
2024-09-20 05:16:36 - INFO - LSTMPredictor 최종 예측 가격: 84673049.87782027
2024-09-20 05:16:36 - INFO - LSTM prediction: 84673049.87782027
2024-09-20 05:16:36 - INFO - Attempting prediction for rl
2024-09-20 05:16:36 - INFO - Preparing state for RL agent.
2024-09-20 05:16:36 - INFO - Prepared state: [[ 8.43810000e+07  5.88680470e+00 -1.16005161e-03  8.47590000e+07
   4.22270477e+01]]
2024-09-20 05:16:36 - INFO - RL prediction: 85234910.0
2024-09-20 05:16:36 - INFO - Attempting prediction for arima
2024-09-20 05:16:36 - INFO - ARIMA 예측 시작
2024-09-20 05:16:36 - INFO - 입력 데이터: {'open': 84426000.0, 'high': 84439000.0, 'low': 84346000.0, 'close': 84381000.0, 'volume': 5.8868047, 'value': 496758109.64249, 'decision': 'sell', 'sma': 84759000.0, 'ema': 84655233.73599945, 'rsi': 42.227047696274944, 'macd': 8445.911461502314, 'signal_line': 82788.8104432824, 'BB_Upper': 85116535.45278981, 'BB_Lower': 84401464.54721019}
2024-09-20 05:16:36 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:16:36 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84759000.0         0         0
2024-09-20 05:16:36 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84759000.0         0         0
2024-09-20 05:16:36 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:16:36 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:16:36 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:16:36 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:16:36 - INFO - Attempting prediction for prophet
2024-09-20 05:16:37 - INFO - PROPHET prediction: 84313126.57471779
2024-09-20 05:16:37 - INFO - Attempting prediction for transformer
2024-09-20 05:16:37 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:16:37 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:16:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:16:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:16:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:16:37 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:16:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:16:37 - INFO - X 샘플:
[[ 1.41281377  1.205795    1.81083748  1.43247702  0.18560456  0.18918135
   1.43247702  1.43247702  0.          0.          0.          1.43247702
   1.43247702]
 [ 1.0007691   0.82824666  0.97983672  1.1197335   2.6142652   2.61679096
   1.1197335   1.1197335   0.          0.          0.          1.1197335
   1.1197335 ]
 [ 0.95706739  1.01112164  0.71937379  0.61710998 -0.07810014 -0.07659133
   0.61710998  0.61710998  0.          0.          0.          0.61710998
   0.61710998]
 [ 0.27656938  0.67486765  0.57053784  0.50541587 -0.85546078 -0.85397832
   0.50541587  0.50541587  0.          0.          0.          0.50541587
   0.50541587]
 [ 0.09551945 -0.23360803 -0.46511237 -0.41047587 -0.60550846 -0.60556039
  -0.41047587 -0.41047587  0.          0.          0.         -0.41047587
  -0.41047587]
 [-0.62243717 -0.79403134 -0.46511237 -0.56684763 -0.7548546  -0.75443991
  -0.56684763 -0.56684763  0.          0.          0.         -0.56684763
  -0.56684763]
 [-0.37271313  0.41530317  0.27906742  0.94102291 -0.66091693 -0.65952576
   0.94102291  0.94102291  0.          0.          0.          0.94102291
   0.94102291]
 [ 0.4451331   0.09674676 -0.63875432 -0.9298535  -0.19079597 -0.19227578
  -0.9298535  -0.9298535   0.          0.          0.         -0.9298535
  -0.9298535 ]
 [-1.29669209 -1.16568048 -1.16588166 -1.08064056  0.85252242  0.84534836
  -1.08064056 -1.08064056  0.          0.          0.         -1.08064056
  -1.08064056]
 [-1.89602979 -2.03876101 -1.62479253 -1.62794172 -0.50675531 -0.50894917
  -1.62794172 -1.62794172  0.          0.          0.         -1.62794172
  -1.62794172]]
2024-09-20 05:16:37 - INFO - y 샘플:
[-1.62794172]
2024-09-20 05:16:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:16:37 - INFO - 모델 출력 (스케일링된 예측): [0.4736956]
2024-09-20 05:16:37 - INFO - 스케일러 역변환 후 예측 가격: 84757320.15531093
2024-09-20 05:16:37 - INFO - TransformerPredictor 최종 예측 가격: 84757320.15531093
2024-09-20 05:16:37 - INFO - TRANSFORMER prediction: 84757320.15531093
2024-09-20 05:16:37 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:16:37 - INFO - BITCOIN_FORECAST prediction: 83092055.74699053
2024-09-20 05:16:37 - INFO - BitcoinForecast prediction: 83092055.74699053
2024-09-20 05:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:16:43 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:16:43 - INFO - 조정된 모델 가중치: {'gpt': 0.004729653036873008, 'ml': 0.14442873653831448, 'xgboost': 0.05988868285255835, 'rl': 0.12324968682486537, 'lstm': 0.12469079768348569, 'arima': 0.0, 'prophet': 0.2395859949685632, 'transformer': 0.1562689197398184, 'bitcoin_forecast': 0.14715752835552148}
2024-09-20 05:16:43 - INFO - 조정된 모델 가중치: {'gpt': 0.004729653036873008, 'ml': 0.14442873653831448, 'xgboost': 0.05988868285255835, 'rl': 0.12324968682486537, 'lstm': 0.12469079768348569, 'arima': 0.0, 'prophet': 0.2395859949685632, 'transformer': 0.1562689197398184, 'bitcoin_forecast': 0.14715752835552148}
2024-09-20 05:16:43 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84397511.81458554, 'current_price': 84391000.0, 'predictions': {'gpt': 84391000.0, 'ml': 84532885.8, 'xgboost': 84381000.0, 'lstm': 84673049.87782027, 'rl': 85234910.0, 'arima': 84953000.0, 'prophet': 84313126.57471779, 'transformer': 84757320.15531093, 'bitcoin_forecast': 83092055.74699053}, 'weights': {'gpt': 0.004729653036873008, 'ml': 0.14442873653831448, 'xgboost': 0.05988868285255835, 'rl': 0.12324968682486537, 'lstm': 0.12469079768348569, 'arima': 0.0, 'prophet': 0.2395859949685632, 'transformer': 0.1562689197398184, 'bitcoin_forecast': 0.14715752835552148}}
2024-09-20 05:16:43 - INFO - 모델별 가중치:
2024-09-20 05:16:43 - INFO -   - GPT: 0.0047
2024-09-20 05:16:43 - INFO -   - ML: 0.1444
2024-09-20 05:16:43 - INFO -   - XGBOOST: 0.0599
2024-09-20 05:16:43 - INFO -   - RL: 0.1232
2024-09-20 05:16:43 - INFO -   - LSTM: 0.1247
2024-09-20 05:16:43 - INFO -   - ARIMA: 0.0000
2024-09-20 05:16:43 - INFO -   - PROPHET: 0.2396
2024-09-20 05:16:43 - INFO -   - TRANSFORMER: 0.1563
2024-09-20 05:16:43 - INFO -   - BITCOIN_FORECAST: 0.1472
2024-09-20 05:16:43 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:16:43 - INFO - 6. 거래 실행
2024-09-20 05:16:43 - INFO - Cancelling existing orders.
2024-09-20 05:16:44 - INFO - Cancelled 0 orders.
2024-09-20 05:16:44 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84397511.81458554, 'current_price': 84391000.0, 'predictions': {'gpt': 84391000.0, 'ml': 84532885.8, 'xgboost': 84381000.0, 'lstm': 84673049.87782027, 'rl': 85234910.0, 'arima': 84953000.0, 'prophet': 84313126.57471779, 'transformer': 84757320.15531093, 'bitcoin_forecast': 83092055.74699053}, 'weights': {'gpt': 0.004729653036873008, 'ml': 0.14442873653831448, 'xgboost': 0.05988868285255835, 'rl': 0.12324968682486537, 'lstm': 0.12469079768348569, 'arima': 0.0, 'prophet': 0.2395859949685632, 'transformer': 0.1562689197398184, 'bitcoin_forecast': 0.14715752835552148}}, 현재 가격=84391000.0
2024-09-20 05:16:44 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=477943.01094024
2024-09-20 05:16:44 - INFO - 매수 시도: 0.0005530458040577786 BTC (약 46672.08845024 KRW)
2024-09-20 05:16:44 - INFO - 주문 결과: None
2024-09-20 05:16:44 - ERROR - 주문 실패
2024-09-20 05:16:44 - WARNING - Trade execution failed: Failed to place order
2024-09-20 05:16:44 - INFO - 7. summary 리포트 보내기
2024-09-20 05:16:44 - INFO - Message sent to Discord successfully.
2024-09-20 05:16:44 - INFO - Trading cycle completed.
2024-09-20 05:16:44 - INFO - Performing periodic update.
2024-09-20 05:16:44 - INFO - 계산된 시장 변동성: 0.026837748765622373
2024-09-20 05:25:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:25:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/b2a11270-9eb7-4d83-a962-f594a4b74d16 "HTTP/1.1 200 OK"
2024-09-20 05:25:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:25:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816c-89c5-c2575e0d5666 "HTTP/1.1 200 OK"
2024-09-20 05:25:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:25:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:25:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8123-94d5-d2cf84bd7afd "HTTP/1.1 200 OK"
2024-09-20 05:25:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8170-a36a-d5f186640280 "HTTP/1.1 200 OK"
2024-09-20 05:26:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-a3bf-dc26db777bad "HTTP/1.1 200 OK"
2024-09-20 05:26:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8156-bd87-faf5523231d9 "HTTP/1.1 200 OK"
2024-09-20 05:26:13 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a7-bb4c-cd8d889cb773 "HTTP/1.1 200 OK"
2024-09-20 05:26:19 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811e-8bee-d0f61633d42a "HTTP/1.1 200 OK"
2024-09-20 05:26:44 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:26:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bd-b15e-ddd3d518ca61 "HTTP/1.1 200 OK"
2024-09-20 05:26:54 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:15:34.960281
2024-09-20 05:26:54 - INFO - Starting trading cycle.
2024-09-20 05:26:54 - INFO - ##################################################
2024-09-20 05:26:54 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-20 05:26:54 - INFO - ##################################################
2024-09-20 05:26:54 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:26:54 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:26:54 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:10:00
2024-09-20 05:26:55 - INFO - 새로운 데이터 범위: 2024-09-18 20:10:00 ~ 2024-09-20 05:20:00
2024-09-20 05:26:55 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:26:55 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:26:55 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:26:55 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:26:55 - INFO - Sample date values: [Timestamp('2024-09-20 05:20:00')]
2024-09-20 05:26:55 - INFO - Successfully added 1 new data points
2024-09-20 05:26:55 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:26:55 - INFO - Final date range: 2024-09-20 05:20:00 to 2024-09-20 05:20:00
2024-09-20 05:26:55 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:26:55 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:20:00
2024-09-20 05:26:55 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:26:55 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:26:55 - INFO - GPT | 이전예측가격: 84391000 | 당시BTC가격: 84391000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:26:55 - INFO - ML 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 6/15
2024-09-20 05:26:55 - INFO - ML | 이전예측가격: 84532886 | 당시BTC가격: 84391000 | 예측: 상승 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1819 | 반영가중치값: 0.0200 | 새 가중치: 0.2019 | 예측 총 횟수: 15 | 예측 성공 수: 6 | 예측 성공률: 40.00%
2024-09-20 05:26:55 - INFO - XGBOOST 모델 예측 업데이트: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 05:26:55 - INFO - XGBOOST | 이전예측가격: 84381000 | 당시BTC가격: 84391000 | 예측: 하락 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0578 | 반영가중치값: -0.0200 | 새 가중치: 0.0378 | 예측 총 횟수: 121 | 예측 성공 수: 74 | 예측 성공률: 61.16%
2024-09-20 05:26:55 - INFO - LSTM 모델 예측 업데이트: 정확도 51.43%, 적중/전체: 18/35
2024-09-20 05:26:55 - INFO - LSTM | 이전예측가격: 84673050 | 당시BTC가격: 84391000 | 예측: 상승 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 35 | 예측 성공 수: 18 | 예측 성공률: 51.43%
2024-09-20 05:26:55 - INFO - RL 모델 예측 업데이트: 정확도 59.21%, 적중/전체: 45/76
2024-09-20 05:26:55 - INFO - RL | 이전예측가격: 85234910 | 당시BTC가격: 84391000 | 예측: 상승 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3405 | 반영가중치값: 0.0200 | 새 가중치: 0.3605 | 예측 총 횟수: 76 | 예측 성공 수: 45 | 예측 성공률: 59.21%
2024-09-20 05:26:55 - INFO - ARIMA 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 6/15
2024-09-20 05:26:55 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84391000 | 예측: 상승 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0414 | 반영가중치값: 0.0200 | 새 가중치: 0.0614 | 예측 총 횟수: 15 | 예측 성공 수: 6 | 예측 성공률: 40.00%
2024-09-20 05:26:55 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.87%, 적중/전체: 42/69
2024-09-20 05:26:55 - INFO - PROPHET | 이전예측가격: 84313127 | 당시BTC가격: 84391000 | 예측: 하락 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1933 | 반영가중치값: -0.0200 | 새 가중치: 0.1733 | 예측 총 횟수: 69 | 예측 성공 수: 42 | 예측 성공률: 60.87%
2024-09-20 05:26:55 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.29%, 적중/전체: 19/35
2024-09-20 05:26:55 - INFO - TRANSFORMER | 이전예측가격: 84757320 | 당시BTC가격: 84391000 | 예측: 상승 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0470 | 반영가중치값: 0.0200 | 새 가중치: 0.0670 | 예측 총 횟수: 35 | 예측 성공 수: 19 | 예측 성공률: 54.29%
2024-09-20 05:26:55 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 68.75%, 적중/전체: 11/16
2024-09-20 05:26:55 - INFO - BITCOIN_FORECAST | 이전예측가격: 83092056 | 당시BTC가격: 84391000 | 예측: 하락 | 지금 BTC가격: 84400000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1335 | 반영가중치값: -0.0200 | 새 가중치: 0.1135 | 예측 총 횟수: 16 | 예측 성공 수: 11 | 예측 성공률: 68.75%
2024-09-20 05:26:55 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:26:55 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:26:55 - INFO - 새로운 가중치: {'gpt': 0.004547004962399794, 'ml': 0.19407523590602546, 'xgboost': 0.03629249271820706, 'rl': 0.3465957805234833, 'lstm': 0.019227647047048633, 'arima': 0.05904198824144155, 'prophet': 0.16664886238935758, 'transformer': 0.06445063547419531, 'bitcoin_forecast': 0.10912035273784132}
2024-09-20 05:26:55 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 05:26:55 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:26:55 - INFO - Current BTC price: 84400000.0
2024-09-20 05:26:55 - INFO - Analyzing market conditions.
2024-09-20 05:26:55 - INFO - Market analysis: {'current_price': 84400000.0, 'sma_20': 84730600.0, 'rsi_14': 42.922840390827105, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:26:55 - INFO - Starting predictions for all models
2024-09-20 05:26:55 - INFO - Attempting prediction for gpt
2024-09-20 05:26:55 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:26:55 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:26:55 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:26:55 - INFO - GPT prediction: 84400000.0
2024-09-20 05:26:55 - INFO - Attempting prediction for ml
2024-09-20 05:26:55 - INFO - ML prediction: 84535040.0
2024-09-20 05:26:55 - INFO - Attempting prediction for xgboost
2024-09-20 05:26:55 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:26:55 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:26:55 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:26:55 - INFO - XGBOOST prediction: 84400000.0
2024-09-20 05:26:55 - INFO - Attempting prediction for lstm
2024-09-20 05:26:55 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:26:55 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:26:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:26:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:26:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:26:55 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:26:55 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:26:55 - INFO - X 샘플:
[[ 1.24828479e+00  1.05216108e+00  1.44301746e+00  1.46031524e+00
   2.65880495e+00  2.66183540e+00  1.46031524e+00]
 [ 1.20874636e+00  1.21581885e+00  1.16243073e+00  9.41655525e-01
  -1.93841499e-03  1.09842346e-04  9.41655525e-01]
 [ 5.93076484e-01  9.14899722e-01  1.00209546e+00  8.26397811e-01
  -7.70168914e-01 -7.68140107e-01  8.26397811e-01]
 [ 4.29274407e-01  1.01890159e-01 -1.13570818e-01 -1.18715446e-01
  -5.23152303e-01 -5.22641967e-01 -1.18715446e-01]
 [-2.20285551e-01 -3.99641713e-01 -1.13570818e-01 -2.80076246e-01
  -6.70744361e-01 -6.69771631e-01 -2.80076246e-01]
 [ 5.64834747e-03  6.82611275e-01  6.88105547e-01  1.27590290e+00
  -5.77909994e-01 -5.75973053e-01  1.27590290e+00]
 [ 7.45581866e-01  3.97530000e-01 -3.00628637e-01 -6.54663817e-01
  -1.13310626e-01 -1.14214909e-01 -6.54663817e-01]
 [-8.30307078e-01 -7.32236534e-01 -8.68482729e-01 -8.10261731e-01
   9.17753930e-01  9.11213495e-01 -8.10261731e-01]
 [-1.37254843e+00 -1.51357040e+00 -1.36284982e+00 -1.37502453e+00
  -4.25559007e-01 -4.27166271e-01 -1.37502453e+00]
 [-1.80747119e+00 -1.71946243e+00 -1.53654637e+00 -1.26552970e+00
  -4.93775256e-01 -4.95250799e-01 -1.26552970e+00]]
2024-09-20 05:26:55 - INFO - y 샘플:
[-1.2655297]
2024-09-20 05:26:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:26:55 - INFO - 모델 출력 (스케일링된 예측): [[-0.01565859]]
2024-09-20 05:26:55 - INFO - 스케일러 역변환 후 예측 가격: 84616882.85524744
2024-09-20 05:26:55 - INFO - LSTMPredictor 최종 예측 가격: 84616882.85524744
2024-09-20 05:26:55 - INFO - LSTM prediction: 84616882.85524744
2024-09-20 05:26:55 - INFO - Attempting prediction for rl
2024-09-20 05:26:55 - INFO - Preparing state for RL agent.
2024-09-20 05:26:55 - INFO - Prepared state: [[8.44000000e+07 5.33909193e+00 2.25169173e-04 8.47306000e+07
  4.29228404e+01]]
2024-09-20 05:26:55 - INFO - RL prediction: 85244000.0
2024-09-20 05:26:55 - INFO - Attempting prediction for arima
2024-09-20 05:26:55 - INFO - ARIMA 예측 시작
2024-09-20 05:26:55 - INFO - 입력 데이터: {'open': 84349000.0, 'high': 84400000.0, 'low': 84320000.0, 'close': 84400000.0, 'volume': 5.33909193, 'value': 450364689.3715, 'decision': 'sell', 'sma': 84730600.0, 'ema': 84630925.76114236, 'rsi': 42.922840390827105, 'macd': -11168.977775737643, 'signal_line': 63997.25279947839, 'BB_Upper': 85106958.02103585, 'BB_Lower': 84354241.97896415}
2024-09-20 05:26:55 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:26:55 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84730600.0         0         0
2024-09-20 05:26:55 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84730600.0         0         0
2024-09-20 05:26:55 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:26:55 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:26:55 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:26:55 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:26:55 - INFO - Attempting prediction for prophet
2024-09-20 05:26:56 - INFO - PROPHET prediction: 84335954.34727928
2024-09-20 05:26:56 - INFO - Attempting prediction for transformer
2024-09-20 05:26:56 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:26:56 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:26:56 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:26:56 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:26:56 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:26:56 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:26:56 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:26:56 - INFO - X 샘플:
[[ 1.24828479e+00  1.05216108e+00  1.44301746e+00  1.46031524e+00
   2.65880495e+00  2.66183540e+00  1.46031524e+00  1.46031524e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.46031524e+00
   1.46031524e+00]
 [ 1.20874636e+00  1.21581885e+00  1.16243073e+00  9.41655525e-01
  -1.93841499e-03  1.09842346e-04  9.41655525e-01  9.41655525e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.41655525e-01
   9.41655525e-01]
 [ 5.93076484e-01  9.14899722e-01  1.00209546e+00  8.26397811e-01
  -7.70168914e-01 -7.68140107e-01  8.26397811e-01  8.26397811e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.26397811e-01
   8.26397811e-01]
 [ 4.29274407e-01  1.01890159e-01 -1.13570818e-01 -1.18715446e-01
  -5.23152303e-01 -5.22641967e-01 -1.18715446e-01 -1.18715446e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.18715446e-01
  -1.18715446e-01]
 [-2.20285551e-01 -3.99641713e-01 -1.13570818e-01 -2.80076246e-01
  -6.70744361e-01 -6.69771631e-01 -2.80076246e-01 -2.80076246e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.80076246e-01
  -2.80076246e-01]
 [ 5.64834747e-03  6.82611275e-01  6.88105547e-01  1.27590290e+00
  -5.77909994e-01 -5.75973053e-01  1.27590290e+00  1.27590290e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.27590290e+00
   1.27590290e+00]
 [ 7.45581866e-01  3.97530000e-01 -3.00628637e-01 -6.54663817e-01
  -1.13310626e-01 -1.14214909e-01 -6.54663817e-01 -6.54663817e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -6.54663817e-01
  -6.54663817e-01]
 [-8.30307078e-01 -7.32236534e-01 -8.68482729e-01 -8.10261731e-01
   9.17753930e-01  9.11213495e-01 -8.10261731e-01 -8.10261731e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -8.10261731e-01
  -8.10261731e-01]
 [-1.37254843e+00 -1.51357040e+00 -1.36284982e+00 -1.37502453e+00
  -4.25559007e-01 -4.27166271e-01 -1.37502453e+00 -1.37502453e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.37502453e+00
  -1.37502453e+00]
 [-1.80747119e+00 -1.71946243e+00 -1.53654637e+00 -1.26552970e+00
  -4.93775256e-01 -4.95250799e-01 -1.26552970e+00 -1.26552970e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.26552970e+00
  -1.26552970e+00]]
2024-09-20 05:26:56 - INFO - y 샘플:
[-1.2655297]
2024-09-20 05:26:56 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:26:56 - INFO - 모델 출력 (스케일링된 예측): [0.47549304]
2024-09-20 05:26:56 - INFO - 스케일러 역변환 후 예측 가격: 84702109.53906569
2024-09-20 05:26:56 - INFO - TransformerPredictor 최종 예측 가격: 84702109.53906569
2024-09-20 05:26:56 - INFO - TRANSFORMER prediction: 84702109.53906569
2024-09-20 05:26:56 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:26:56 - INFO - BITCOIN_FORECAST prediction: 83052372.66260256
2024-09-20 05:26:56 - INFO - BitcoinForecast prediction: 83052372.66260256
2024-09-20 05:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:26:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:01 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:06 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:27:07 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:27:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004547004962399794, 'ml': 0.19407523590602546, 'xgboost': 0.03629249271820706, 'rl': 0.3465957805234833, 'lstm': 0.019227647047048633, 'arima': 0.05904198824144155, 'prophet': 0.16664886238935758, 'transformer': 0.06445063547419531, 'bitcoin_forecast': 0.10912035273784132}
2024-09-20 05:27:07 - INFO - 조정된 모델 가중치: {'gpt': 0.004547004962399794, 'ml': 0.19407523590602546, 'xgboost': 0.03629249271820706, 'rl': 0.3465957805234833, 'lstm': 0.019227647047048633, 'arima': 0.05904198824144155, 'prophet': 0.16664886238935758, 'transformer': 0.06445063547419531, 'bitcoin_forecast': 0.10912035273784132}
2024-09-20 05:27:07 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84617299.57130009, 'current_price': 84400000.0, 'predictions': {'gpt': 84400000.0, 'ml': 84535040.0, 'xgboost': 84400000.0, 'lstm': 84616882.85524744, 'rl': 85244000.0, 'arima': 84953000.0, 'prophet': 84335954.34727928, 'transformer': 84702109.53906569, 'bitcoin_forecast': 83052372.66260256}, 'weights': {'gpt': 0.004547004962399794, 'ml': 0.19407523590602546, 'xgboost': 0.03629249271820706, 'rl': 0.3465957805234833, 'lstm': 0.019227647047048633, 'arima': 0.05904198824144155, 'prophet': 0.16664886238935758, 'transformer': 0.06445063547419531, 'bitcoin_forecast': 0.10912035273784132}}
2024-09-20 05:27:07 - INFO - 모델별 가중치:
2024-09-20 05:27:07 - INFO -   - GPT: 0.0045
2024-09-20 05:27:07 - INFO -   - ML: 0.1941
2024-09-20 05:27:07 - INFO -   - XGBOOST: 0.0363
2024-09-20 05:27:07 - INFO -   - RL: 0.3466
2024-09-20 05:27:07 - INFO -   - LSTM: 0.0192
2024-09-20 05:27:07 - INFO -   - ARIMA: 0.0590
2024-09-20 05:27:07 - INFO -   - PROPHET: 0.1666
2024-09-20 05:27:07 - INFO -   - TRANSFORMER: 0.0645
2024-09-20 05:27:07 - INFO -   - BITCOIN_FORECAST: 0.1091
2024-09-20 05:27:07 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:27:07 - INFO - 6. 거래 실행
2024-09-20 05:27:07 - INFO - Cancelling existing orders.
2024-09-20 05:27:07 - INFO - Cancelled 0 orders.
2024-09-20 05:27:07 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84617299.57130009, 'current_price': 84400000.0, 'predictions': {'gpt': 84400000.0, 'ml': 84535040.0, 'xgboost': 84400000.0, 'lstm': 84616882.85524744, 'rl': 85244000.0, 'arima': 84953000.0, 'prophet': 84335954.34727928, 'transformer': 84702109.53906569, 'bitcoin_forecast': 83052372.66260256}, 'weights': {'gpt': 0.004547004962399794, 'ml': 0.19407523590602546, 'xgboost': 0.03629249271820706, 'rl': 0.3465957805234833, 'lstm': 0.019227647047048633, 'arima': 0.05904198824144155, 'prophet': 0.16664886238935758, 'transformer': 0.06445063547419531, 'bitcoin_forecast': 0.10912035273784132}}, 현재 가격=84400000.0
2024-09-20 05:27:07 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=477989.00445024006
2024-09-20 05:27:07 - INFO - 매수 시도: 0.0005529868299791469 BTC (약 46672.08845024 KRW)
2024-09-20 05:27:07 - INFO - 주문 결과: None
2024-09-20 05:27:07 - ERROR - 주문 실패
2024-09-20 05:27:07 - WARNING - Trade execution failed: Failed to place order
2024-09-20 05:27:07 - INFO - 7. summary 리포트 보내기
2024-09-20 05:27:08 - INFO - Message sent to Discord successfully.
2024-09-20 05:27:08 - INFO - Trading cycle completed.
2024-09-20 05:27:08 - INFO - Performing periodic update.
2024-09-20 05:27:08 - INFO - 계산된 시장 변동성: 0.026782391867729582
2024-09-20 05:35:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b7-84a7-e14ba659fc66 "HTTP/1.1 200 OK"
2024-09-20 05:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ca-9e79-f4667cae8f48 "HTTP/1.1 200 OK"
2024-09-20 05:36:00 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/54ea02cd-43b0-4c68-b0c4-7cb53028514a "HTTP/1.1 200 OK"
2024-09-20 05:36:09 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5a0c920a-e555-4dd7-9f10-71341ef1dd0c "HTTP/1.1 200 OK"
2024-09-20 05:36:14 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e6-9d9e-dbee9ca58900 "HTTP/1.1 200 OK"
2024-09-20 05:36:20 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8186-bc60-f3ee1a5e7e26 "HTTP/1.1 200 OK"
2024-09-20 05:36:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813e-97cf-ed9983d8aa3b "HTTP/1.1 200 OK"
2024-09-20 05:36:35 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817f-8579-f0463fbdbda8 "HTTP/1.1 200 OK"
2024-09-20 05:36:41 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:36:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-a6c3-c9ab5d064a01 "HTTP/1.1 200 OK"
2024-09-20 05:36:47 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:25:34.960795
2024-09-20 05:36:47 - INFO - Starting trading cycle.
2024-09-20 05:36:47 - INFO - ##################################################
2024-09-20 05:36:47 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-20 05:36:47 - INFO - ##################################################
2024-09-20 05:36:47 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:36:47 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:36:47 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:20:00
2024-09-20 05:36:47 - INFO - 새로운 데이터 범위: 2024-09-18 20:20:00 ~ 2024-09-20 05:30:00
2024-09-20 05:36:47 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:36:47 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:36:47 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:36:47 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:36:47 - INFO - Sample date values: [Timestamp('2024-09-20 05:30:00')]
2024-09-20 05:36:47 - INFO - Successfully added 1 new data points
2024-09-20 05:36:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:36:47 - INFO - Final date range: 2024-09-20 05:30:00 to 2024-09-20 05:30:00
2024-09-20 05:36:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:36:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:30:00
2024-09-20 05:36:47 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:36:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:36:48 - INFO - GPT | 이전예측가격: 84400000 | 당시BTC가격: 84400000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:36:48 - INFO - ML 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 6/16
2024-09-20 05:36:48 - INFO - ML | 이전예측가격: 84535040 | 당시BTC가격: 84400000 | 예측: 상승 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1444 | 반영가중치값: -0.0200 | 새 가중치: 0.1244 | 예측 총 횟수: 16 | 예측 성공 수: 6 | 예측 성공률: 37.50%
2024-09-20 05:36:48 - INFO - XGBOOST | 이전예측가격: 84400000 | 당시BTC가격: 84400000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:36:48 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 18/36
2024-09-20 05:36:48 - INFO - LSTM | 이전예측가격: 84616883 | 당시BTC가격: 84400000 | 예측: 상승 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1247 | 반영가중치값: -0.0200 | 새 가중치: 0.1047 | 예측 총 횟수: 36 | 예측 성공 수: 18 | 예측 성공률: 50.00%
2024-09-20 05:36:48 - INFO - RL 모델 예측 업데이트: 정확도 58.44%, 적중/전체: 45/77
2024-09-20 05:36:48 - INFO - RL | 이전예측가격: 85244000 | 당시BTC가격: 84400000 | 예측: 상승 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1232 | 반영가중치값: -0.0200 | 새 가중치: 0.1032 | 예측 총 횟수: 77 | 예측 성공 수: 45 | 예측 성공률: 58.44%
2024-09-20 05:36:48 - INFO - ARIMA 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 6/16
2024-09-20 05:36:48 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84400000 | 예측: 상승 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 16 | 예측 성공 수: 6 | 예측 성공률: 37.50%
2024-09-20 05:36:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.43%, 적중/전체: 43/70
2024-09-20 05:36:48 - INFO - PROPHET | 이전예측가격: 84335954 | 당시BTC가격: 84400000 | 예측: 하락 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2396 | 반영가중치값: 0.0200 | 새 가중치: 0.2596 | 예측 총 횟수: 70 | 예측 성공 수: 43 | 예측 성공률: 61.43%
2024-09-20 05:36:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 52.78%, 적중/전체: 19/36
2024-09-20 05:36:48 - INFO - TRANSFORMER | 이전예측가격: 84702110 | 당시BTC가격: 84400000 | 예측: 상승 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1563 | 반영가중치값: -0.0200 | 새 가중치: 0.1363 | 예측 총 횟수: 36 | 예측 성공 수: 19 | 예측 성공률: 52.78%
2024-09-20 05:36:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 70.59%, 적중/전체: 12/17
2024-09-20 05:36:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 83052373 | 당시BTC가격: 84400000 | 예측: 하락 | 지금 BTC가격: 84236000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1472 | 반영가중치값: 0.0200 | 새 가중치: 0.1672 | 예측 총 횟수: 17 | 예측 성공 수: 12 | 예측 성공률: 70.59%
2024-09-20 05:36:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:36:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:36:48 - INFO - 새로운 가중치: {'gpt': 0.0048567637092292145, 'ml': 0.13290528094906312, 'xgboost': 0.038764871164386386, 'rl': 0.11028343626342345, 'lstm': 0.11182272090837123, 'arima': 0.0, 'prophet': 0.2772699502667981, 'transformer': 0.1455520610953817, 'bitcoin_forecast': 0.17854491564334668}
2024-09-20 05:36:48 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 05:36:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:36:48 - INFO - Current BTC price: 84236000.0
2024-09-20 05:36:48 - INFO - Analyzing market conditions.
2024-09-20 05:36:48 - INFO - Market analysis: {'current_price': 84236000.0, 'sma_20': 84708100.0, 'rsi_14': 38.601357378215674, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:36:48 - INFO - Starting predictions for all models
2024-09-20 05:36:48 - INFO - Attempting prediction for gpt
2024-09-20 05:36:48 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:36:48 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:36:48 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:36:48 - INFO - GPT prediction: 84236000.0
2024-09-20 05:36:48 - INFO - Attempting prediction for ml
2024-09-20 05:36:48 - INFO - ML prediction: 84387624.8
2024-09-20 05:36:48 - INFO - Attempting prediction for xgboost
2024-09-20 05:36:48 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:36:48 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:36:48 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:36:48 - INFO - XGBOOST prediction: 84236000.0
2024-09-20 05:36:48 - INFO - Attempting prediction for lstm
2024-09-20 05:36:48 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:36:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:36:48 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:36:48 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:36:48 - INFO - X 샘플:
[[ 1.50374678  1.43593785  1.4328009   1.22539101  0.61099253  0.61949488
   1.22539101]
 [ 0.87065138  1.14225842  1.28197975  1.11747458 -1.04423117 -1.04291899
   1.11747458]
 [ 0.70221315  0.34880873  0.23251594  0.2325599  -0.51201102 -0.51168627
   0.2325599 ]
 [ 0.03426847 -0.14065699  0.23251594  0.0814769  -0.83001177 -0.83005973
   0.0814769 ]
 [ 0.26659705  0.91555851  0.98662167  1.53834864 -0.62999154 -0.62708925
   1.53834864]
 [ 1.02747317  0.63733589  0.05655793 -0.26925148  0.37103079  0.37210788
  -0.26925148]
 [-0.59301872 -0.46525005 -0.4776003  -0.41493865  2.59255479  2.59102948
  -0.41493865]
 [-1.15060733 -1.22778611 -0.94263217 -0.94372914 -0.30173724 -0.30508668
  -0.94372914]
 [-1.59783985 -1.42872467 -1.10602175 -0.84120853 -0.44871546 -0.4524146
  -0.84120853]
 [-1.06348411 -1.21748157 -1.6967379  -1.72612322  0.19212008  0.18662328
  -1.72612322]]
2024-09-20 05:36:48 - INFO - y 샘플:
[-1.72612322]
2024-09-20 05:36:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:36:48 - INFO - 모델 출력 (스케일링된 예측): [[0.03705448]]
2024-09-20 05:36:48 - INFO - 스케일러 역변환 후 예측 가격: 84562767.25405124
2024-09-20 05:36:48 - INFO - LSTMPredictor 최종 예측 가격: 84562767.25405124
2024-09-20 05:36:48 - INFO - LSTM prediction: 84562767.25405124
2024-09-20 05:36:48 - INFO - Attempting prediction for rl
2024-09-20 05:36:48 - INFO - Preparing state for RL agent.
2024-09-20 05:36:48 - INFO - Prepared state: [[ 8.42360000e+07  7.72715872e+00 -1.94312796e-03  8.47081000e+07
   3.86013574e+01]]
2024-09-20 05:36:48 - INFO - RL prediction: 85078360.0
2024-09-20 05:36:48 - INFO - Attempting prediction for arima
2024-09-20 05:36:48 - INFO - ARIMA 예측 시작
2024-09-20 05:36:48 - INFO - 입력 데이터: {'open': 84441000.0, 'high': 84441000.0, 'low': 84226000.0, 'close': 84236000.0, 'volume': 7.72715872, 'value': 651597108.01121, 'decision': 'sell', 'sma': 84708100.0, 'ema': 84593313.78389071, 'rsi': 38.601357378215674, 'macd': -39492.107773289084, 'signal_line': 43299.380684924894, 'BB_Upper': 85141860.71744871, 'BB_Lower': 84274339.28255129}
2024-09-20 05:36:48 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:36:48 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84708100.0         0         0
2024-09-20 05:36:48 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84708100.0         0         0
2024-09-20 05:36:48 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:36:48 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:36:48 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:36:48 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:36:48 - INFO - Attempting prediction for prophet
2024-09-20 05:36:48 - INFO - PROPHET prediction: 84149982.50656003
2024-09-20 05:36:48 - INFO - Attempting prediction for transformer
2024-09-20 05:36:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:36:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:36:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:36:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:36:48 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:36:48 - INFO - X 샘플:
[[ 1.50374678  1.43593785  1.4328009   1.22539101  0.61099253  0.61949488
   1.22539101  1.22539101  0.          0.          0.          1.22539101
   1.22539101]
 [ 0.87065138  1.14225842  1.28197975  1.11747458 -1.04423117 -1.04291899
   1.11747458  1.11747458  0.          0.          0.          1.11747458
   1.11747458]
 [ 0.70221315  0.34880873  0.23251594  0.2325599  -0.51201102 -0.51168627
   0.2325599   0.2325599   0.          0.          0.          0.2325599
   0.2325599 ]
 [ 0.03426847 -0.14065699  0.23251594  0.0814769  -0.83001177 -0.83005973
   0.0814769   0.0814769   0.          0.          0.          0.0814769
   0.0814769 ]
 [ 0.26659705  0.91555851  0.98662167  1.53834864 -0.62999154 -0.62708925
   1.53834864  1.53834864  0.          0.          0.          1.53834864
   1.53834864]
 [ 1.02747317  0.63733589  0.05655793 -0.26925148  0.37103079  0.37210788
  -0.26925148 -0.26925148  0.          0.          0.         -0.26925148
  -0.26925148]
 [-0.59301872 -0.46525005 -0.4776003  -0.41493865  2.59255479  2.59102948
  -0.41493865 -0.41493865  0.          0.          0.         -0.41493865
  -0.41493865]
 [-1.15060733 -1.22778611 -0.94263217 -0.94372914 -0.30173724 -0.30508668
  -0.94372914 -0.94372914  0.          0.          0.         -0.94372914
  -0.94372914]
 [-1.59783985 -1.42872467 -1.10602175 -0.84120853 -0.44871546 -0.4524146
  -0.84120853 -0.84120853  0.          0.          0.         -0.84120853
  -0.84120853]
 [-1.06348411 -1.21748157 -1.6967379  -1.72612322  0.19212008  0.18662328
  -1.72612322 -1.72612322  0.          0.          0.         -1.72612322
  -1.72612322]]
2024-09-20 05:36:48 - INFO - y 샘플:
[-1.72612322]
2024-09-20 05:36:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:36:48 - INFO - 모델 출력 (스케일링된 예측): [0.4654546]
2024-09-20 05:36:48 - INFO - 스케일러 역변환 후 예측 가격: 84642162.0509293
2024-09-20 05:36:48 - INFO - TransformerPredictor 최종 예측 가격: 84642162.0509293
2024-09-20 05:36:48 - INFO - TRANSFORMER prediction: 84642162.0509293
2024-09-20 05:36:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:36:48 - INFO - BITCOIN_FORECAST prediction: 83071262.3254956
2024-09-20 05:36:48 - INFO - BitcoinForecast prediction: 83071262.3254956
2024-09-20 05:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:36:53 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:36:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0048567637092292145, 'ml': 0.13290528094906312, 'xgboost': 0.038764871164386386, 'rl': 0.11028343626342345, 'lstm': 0.11182272090837123, 'arima': 0.0, 'prophet': 0.2772699502667981, 'transformer': 0.1455520610953817, 'bitcoin_forecast': 0.17854491564334668}
2024-09-20 05:36:53 - INFO - 조정된 모델 가중치: {'gpt': 0.0048567637092292145, 'ml': 0.13290528094906312, 'xgboost': 0.038764871164386386, 'rl': 0.11028343626342345, 'lstm': 0.11182272090837123, 'arima': 0.0, 'prophet': 0.2772699502667981, 'transformer': 0.1455520610953817, 'bitcoin_forecast': 0.17854491564334668}
2024-09-20 05:36:53 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84212899.76314776, 'current_price': 84236000.0, 'predictions': {'gpt': 84236000.0, 'ml': 84387624.8, 'xgboost': 84236000.0, 'lstm': 84562767.25405124, 'rl': 85078360.0, 'arima': 84953000.0, 'prophet': 84149982.50656003, 'transformer': 84642162.0509293, 'bitcoin_forecast': 83071262.3254956}, 'weights': {'gpt': 0.0048567637092292145, 'ml': 0.13290528094906312, 'xgboost': 0.038764871164386386, 'rl': 0.11028343626342345, 'lstm': 0.11182272090837123, 'arima': 0.0, 'prophet': 0.2772699502667981, 'transformer': 0.1455520610953817, 'bitcoin_forecast': 0.17854491564334668}}
2024-09-20 05:36:53 - INFO - 모델별 가중치:
2024-09-20 05:36:53 - INFO -   - GPT: 0.0049
2024-09-20 05:36:53 - INFO -   - ML: 0.1329
2024-09-20 05:36:53 - INFO -   - XGBOOST: 0.0388
2024-09-20 05:36:53 - INFO -   - RL: 0.1103
2024-09-20 05:36:53 - INFO -   - LSTM: 0.1118
2024-09-20 05:36:53 - INFO -   - ARIMA: 0.0000
2024-09-20 05:36:53 - INFO -   - PROPHET: 0.2773
2024-09-20 05:36:53 - INFO -   - TRANSFORMER: 0.1456
2024-09-20 05:36:53 - INFO -   - BITCOIN_FORECAST: 0.1785
2024-09-20 05:36:53 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:36:53 - INFO - 6. 거래 실행
2024-09-20 05:36:53 - INFO - Cancelling existing orders.
2024-09-20 05:36:53 - INFO - Cancelled 0 orders.
2024-09-20 05:36:53 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84212899.76314776, 'current_price': 84236000.0, 'predictions': {'gpt': 84236000.0, 'ml': 84387624.8, 'xgboost': 84236000.0, 'lstm': 84562767.25405124, 'rl': 85078360.0, 'arima': 84953000.0, 'prophet': 84149982.50656003, 'transformer': 84642162.0509293, 'bitcoin_forecast': 83071262.3254956}, 'weights': {'gpt': 0.0048567637092292145, 'ml': 0.13290528094906312, 'xgboost': 0.038764871164386386, 'rl': 0.11028343626342345, 'lstm': 0.11182272090837123, 'arima': 0.0, 'prophet': 0.2772699502667981, 'transformer': 0.1455520610953817, 'bitcoin_forecast': 0.17854491564334668}}, 현재 가격=84236000.0
2024-09-20 05:36:53 - INFO - 현재 잔고: KRW=46672.08845024, BTC=0.00511039, 총 자산가치=477150.9004902401
2024-09-20 05:36:53 - INFO - 매도 시도: 0.000511039 BTC (약 43047.881204000005 KRW)
2024-09-20 05:36:53 - INFO - 주문 결과: {'uuid': '575241ef-90ec-4681-a16c-389279f2610c', 'side': 'ask', 'ord_type': 'limit', 'price': '84236000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T05:36:54+09:00', 'volume': '0.00051103', 'remaining_volume': '0.00051103', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00051103', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 05:36:53 - INFO - sell 주문 성공: UUID=575241ef-90ec-4681-a16c-389279f2610c
2024-09-20 05:36:53 - INFO - Trade executed successfully.
2024-09-20 05:36:53 - INFO - 7. summary 리포트 보내기
2024-09-20 05:36:54 - INFO - Message sent to Discord successfully.
2024-09-20 05:36:54 - INFO - Trading cycle completed.
2024-09-20 05:36:54 - INFO - Performing periodic update.
2024-09-20 05:36:54 - INFO - 계산된 시장 변동성: 0.026986188574811013
2024-09-20 05:45:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:45:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c7-a9a6-fac02cc9edb2 "HTTP/1.1 200 OK"
2024-09-20 05:45:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:45:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:45:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-ae11-ff41c9fa5d60 "HTTP/1.1 200 OK"
2024-09-20 05:45:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:45:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:45:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8135-9309-d9f9d8218f5a "HTTP/1.1 200 OK"
2024-09-20 05:45:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:45:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:45:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8165-b88e-e585be06299e "HTTP/1.1 200 OK"
2024-09-20 05:45:59 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8166-8a21-e02c50806a58 "HTTP/1.1 200 OK"
2024-09-20 05:46:06 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:46:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c6-be37-fa25e25e7f56 "HTTP/1.1 200 OK"
2024-09-20 05:46:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:46:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8121-8bfa-d9f2bfe07a00 "HTTP/1.1 200 OK"
2024-09-20 05:46:23 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:46:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-8f7a-d56c476fa54c "HTTP/1.1 200 OK"
2024-09-20 05:46:31 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:46:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818b-93b9-cc5bde0a8525 "HTTP/1.1 200 OK"
2024-09-20 05:46:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:35:34.961083
2024-09-20 05:46:42 - INFO - Starting trading cycle.
2024-09-20 05:46:42 - INFO - ##################################################
2024-09-20 05:46:42 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-20 05:46:42 - INFO - ##################################################
2024-09-20 05:46:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:46:42 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:46:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:30:00
2024-09-20 05:46:42 - INFO - 새로운 데이터 범위: 2024-09-18 20:30:00 ~ 2024-09-20 05:40:00
2024-09-20 05:46:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:46:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:46:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:46:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:46:42 - INFO - Sample date values: [Timestamp('2024-09-20 05:40:00')]
2024-09-20 05:46:42 - INFO - Successfully added 1 new data points
2024-09-20 05:46:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:46:42 - INFO - Final date range: 2024-09-20 05:40:00 to 2024-09-20 05:40:00
2024-09-20 05:46:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:46:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:40:00
2024-09-20 05:46:42 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:46:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:46:42 - INFO - GPT | 이전예측가격: 84236000 | 당시BTC가격: 84236000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:46:42 - INFO - ML 모델 예측 업데이트: 정확도 35.29%, 적중/전체: 6/17
2024-09-20 05:46:42 - INFO - ML | 이전예측가격: 84387625 | 당시BTC가격: 84236000 | 예측: 상승 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1941 | 반영가중치값: -0.0200 | 새 가중치: 0.1741 | 예측 총 횟수: 17 | 예측 성공 수: 6 | 예측 성공률: 35.29%
2024-09-20 05:46:42 - INFO - XGBOOST | 이전예측가격: 84236000 | 당시BTC가격: 84236000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:46:42 - INFO - LSTM 모델 예측 업데이트: 정확도 48.65%, 적중/전체: 18/37
2024-09-20 05:46:42 - INFO - LSTM | 이전예측가격: 84562767 | 당시BTC가격: 84236000 | 예측: 상승 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0192 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 37 | 예측 성공 수: 18 | 예측 성공률: 48.65%
2024-09-20 05:46:42 - INFO - RL 모델 예측 업데이트: 정확도 57.69%, 적중/전체: 45/78
2024-09-20 05:46:42 - INFO - RL | 이전예측가격: 85078360 | 당시BTC가격: 84236000 | 예측: 상승 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3466 | 반영가중치값: -0.0200 | 새 가중치: 0.3266 | 예측 총 횟수: 78 | 예측 성공 수: 45 | 예측 성공률: 57.69%
2024-09-20 05:46:42 - INFO - ARIMA 모델 예측 업데이트: 정확도 35.29%, 적중/전체: 6/17
2024-09-20 05:46:42 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84236000 | 예측: 상승 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0590 | 반영가중치값: -0.0200 | 새 가중치: 0.0390 | 예측 총 횟수: 17 | 예측 성공 수: 6 | 예측 성공률: 35.29%
2024-09-20 05:46:42 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.97%, 적중/전체: 44/71
2024-09-20 05:46:42 - INFO - PROPHET | 이전예측가격: 84149983 | 당시BTC가격: 84236000 | 예측: 하락 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1666 | 반영가중치값: 0.0200 | 새 가중치: 0.1866 | 예측 총 횟수: 71 | 예측 성공 수: 44 | 예측 성공률: 61.97%
2024-09-20 05:46:42 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 51.35%, 적중/전체: 19/37
2024-09-20 05:46:42 - INFO - TRANSFORMER | 이전예측가격: 84642162 | 당시BTC가격: 84236000 | 예측: 상승 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0645 | 반영가중치값: -0.0200 | 새 가중치: 0.0445 | 예측 총 횟수: 37 | 예측 성공 수: 19 | 예측 성공률: 51.35%
2024-09-20 05:46:42 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 72.22%, 적중/전체: 13/18
2024-09-20 05:46:42 - INFO - BITCOIN_FORECAST | 이전예측가격: 83071262 | 당시BTC가격: 84236000 | 예측: 하락 | 지금 BTC가격: 84228000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1091 | 반영가중치값: 0.0200 | 새 가중치: 0.1291 | 예측 총 횟수: 18 | 예측 성공 수: 13 | 예측 성공률: 72.22%
2024-09-20 05:46:42 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:46:42 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:46:42 - INFO - 새로운 가중치: {'gpt': 0.005147306022016718, 'ml': 0.18448880030139805, 'xgboost': 0.041083871222307236, 'rl': 0.346133460159743, 'lstm': 0.0, 'arima': 0.041377566053871544, 'prophet': 0.19781460884202304, 'transformer': 0.04710977048852702, 'bitcoin_forecast': 0.13684461691011343}
2024-09-20 05:46:42 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 05:46:42 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:46:42 - INFO - Current BTC price: 84228000.0
2024-09-20 05:46:42 - INFO - Analyzing market conditions.
2024-09-20 05:46:42 - INFO - Market analysis: {'current_price': 84228000.0, 'sma_20': 84691000.0, 'rsi_14': 38.398268183942804, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:46:42 - INFO - Starting predictions for all models
2024-09-20 05:46:42 - INFO - Attempting prediction for gpt
2024-09-20 05:46:42 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:46:42 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:46:42 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:46:42 - INFO - GPT prediction: 84228000.0
2024-09-20 05:46:42 - INFO - Attempting prediction for ml
2024-09-20 05:46:42 - INFO - ML prediction: 84329073.60000001
2024-09-20 05:46:42 - INFO - Attempting prediction for xgboost
2024-09-20 05:46:42 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:46:42 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:46:42 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:46:42 - INFO - XGBOOST prediction: 84228000.0
2024-09-20 05:46:42 - INFO - Attempting prediction for lstm
2024-09-20 05:46:42 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:46:42 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:46:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:46:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:46:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:46:42 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:46:42 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:46:42 - INFO - X 샘플:
[[ 1.20776427  1.44807689  1.5824212   1.36776696 -1.00300074 -1.00067694
   1.36776696]
 [ 1.03839694  0.66807045  0.55335445  0.51356368 -0.45947242 -0.45780986
   0.51356368]
 [ 0.36676787  0.18689765  0.55335445  0.36772409 -0.78422978 -0.78315591
   0.36772409]
 [ 0.60037799  1.22521791  1.29280361  1.77403437 -0.57995969 -0.57574025
   1.77403437]
 [ 1.3654511   0.95170916  0.38081632  0.02916792  0.44233153  0.44533997
   0.02916792]
 [-0.26397943 -0.1321959  -0.14296017 -0.11146311  2.7110566   2.71285744
  -0.11146311]
 [-0.82464369 -0.88181247 -0.59895382 -0.62190166 -0.24473091 -0.24668561
  -0.62190166]
 [-1.27434316 -1.07934657 -0.7591678  -0.52293908 -0.39483201 -0.3972401
  -0.52293908]
 [-0.7370399  -0.87168252 -1.33840297 -1.37714236  0.25961947  0.25579313
  -1.37714236]
 [-1.478752   -1.51493458 -1.52326526 -1.41881081  0.05321794  0.04731814
  -1.41881081]]
2024-09-20 05:46:42 - INFO - y 샘플:
[-1.41881081]
2024-09-20 05:46:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:46:42 - INFO - 모델 출력 (스케일링된 예측): [[0.03683534]]
2024-09-20 05:46:42 - INFO - 스케일러 역변환 후 예측 가격: 84507472.08122684
2024-09-20 05:46:42 - INFO - LSTMPredictor 최종 예측 가격: 84507472.08122684
2024-09-20 05:46:42 - INFO - LSTM prediction: 84507472.08122684
2024-09-20 05:46:42 - INFO - Attempting prediction for rl
2024-09-20 05:46:42 - INFO - Preparing state for RL agent.
2024-09-20 05:46:42 - INFO - Prepared state: [[ 8.42280000e+07  6.97400795e+00 -9.49712712e-05  8.46910000e+07
   3.83982682e+01]]
2024-09-20 05:46:42 - INFO - RL prediction: 85070280.0
2024-09-20 05:46:42 - INFO - Attempting prediction for arima
2024-09-20 05:46:42 - INFO - ARIMA 예측 시작
2024-09-20 05:46:42 - INFO - 입력 데이터: {'open': 84314000.0, 'high': 84314000.0, 'low': 84196000.0, 'close': 84228000.0, 'volume': 6.97400795, 'value': 587355467.46868, 'decision': 'sell', 'sma': 84691000.0, 'ema': 84558521.99494873, 'rsi': 38.398268183942804, 'macd': -61870.71836654842, 'signal_line': 22265.360874630234, 'BB_Upper': 85169814.78674078, 'BB_Lower': 84212185.21325922}
2024-09-20 05:46:42 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:46:42 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84691000.0         0         0
2024-09-20 05:46:42 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84691000.0         0         0
2024-09-20 05:46:42 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:46:42 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:46:42 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:46:42 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:46:42 - INFO - Attempting prediction for prophet
2024-09-20 05:46:43 - INFO - PROPHET prediction: 84140649.96979888
2024-09-20 05:46:43 - INFO - Attempting prediction for transformer
2024-09-20 05:46:43 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:46:43 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:46:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:46:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:46:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:46:43 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:46:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:46:43 - INFO - X 샘플:
[[ 1.20776427  1.44807689  1.5824212   1.36776696 -1.00300074 -1.00067694
   1.36776696  1.36776696  0.          0.          0.          1.36776696
   1.36776696]
 [ 1.03839694  0.66807045  0.55335445  0.51356368 -0.45947242 -0.45780986
   0.51356368  0.51356368  0.          0.          0.          0.51356368
   0.51356368]
 [ 0.36676787  0.18689765  0.55335445  0.36772409 -0.78422978 -0.78315591
   0.36772409  0.36772409  0.          0.          0.          0.36772409
   0.36772409]
 [ 0.60037799  1.22521791  1.29280361  1.77403437 -0.57995969 -0.57574025
   1.77403437  1.77403437  0.          0.          0.          1.77403437
   1.77403437]
 [ 1.3654511   0.95170916  0.38081632  0.02916792  0.44233153  0.44533997
   0.02916792  0.02916792  0.          0.          0.          0.02916792
   0.02916792]
 [-0.26397943 -0.1321959  -0.14296017 -0.11146311  2.7110566   2.71285744
  -0.11146311 -0.11146311  0.          0.          0.         -0.11146311
  -0.11146311]
 [-0.82464369 -0.88181247 -0.59895382 -0.62190166 -0.24473091 -0.24668561
  -0.62190166 -0.62190166  0.          0.          0.         -0.62190166
  -0.62190166]
 [-1.27434316 -1.07934657 -0.7591678  -0.52293908 -0.39483201 -0.3972401
  -0.52293908 -0.52293908  0.          0.          0.         -0.52293908
  -0.52293908]
 [-0.7370399  -0.87168252 -1.33840297 -1.37714236  0.25961947  0.25579313
  -1.37714236 -1.37714236  0.          0.          0.         -1.37714236
  -1.37714236]
 [-1.478752   -1.51493458 -1.52326526 -1.41881081  0.05321794  0.04731814
  -1.41881081 -1.41881081  0.          0.          0.         -1.41881081
  -1.41881081]]
2024-09-20 05:46:43 - INFO - y 샘플:
[-1.41881081]
2024-09-20 05:46:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:46:43 - INFO - 모델 출력 (스케일링된 예측): [0.4619845]
2024-09-20 05:46:43 - INFO - 스케일러 역변환 후 예측 가격: 84589097.21936566
2024-09-20 05:46:43 - INFO - TransformerPredictor 최종 예측 가격: 84589097.21936566
2024-09-20 05:46:43 - INFO - TRANSFORMER prediction: 84589097.21936566
2024-09-20 05:46:43 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:46:43 - INFO - BITCOIN_FORECAST prediction: 83050862.46369901
2024-09-20 05:46:43 - INFO - BitcoinForecast prediction: 83050862.46369901
2024-09-20 05:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:46:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:46:50 - INFO - 조정된 모델 가중치: {'gpt': 0.005147306022016718, 'ml': 0.18448880030139805, 'xgboost': 0.041083871222307236, 'rl': 0.346133460159743, 'lstm': 0.0, 'arima': 0.041377566053871544, 'prophet': 0.19781460884202304, 'transformer': 0.04710977048852702, 'bitcoin_forecast': 0.13684461691011343}
2024-09-20 05:46:50 - INFO - 조정된 모델 가중치: {'gpt': 0.005147306022016718, 'ml': 0.18448880030139805, 'xgboost': 0.041083871222307236, 'rl': 0.346133460159743, 'lstm': 0.0, 'arima': 0.041377566053871544, 'prophet': 0.19781460884202304, 'transformer': 0.04710977048852702, 'bitcoin_forecast': 0.13684461691011343}
2024-09-20 05:46:50 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84406834.13328472, 'current_price': 84228000.0, 'predictions': {'gpt': 84228000.0, 'ml': 84329073.60000001, 'xgboost': 84228000.0, 'lstm': 84507472.08122684, 'rl': 85070280.0, 'arima': 84953000.0, 'prophet': 84140649.96979888, 'transformer': 84589097.21936566, 'bitcoin_forecast': 83050862.46369901}, 'weights': {'gpt': 0.005147306022016718, 'ml': 0.18448880030139805, 'xgboost': 0.041083871222307236, 'rl': 0.346133460159743, 'lstm': 0.0, 'arima': 0.041377566053871544, 'prophet': 0.19781460884202304, 'transformer': 0.04710977048852702, 'bitcoin_forecast': 0.13684461691011343}}
2024-09-20 05:46:50 - INFO - 모델별 가중치:
2024-09-20 05:46:50 - INFO -   - GPT: 0.0051
2024-09-20 05:46:50 - INFO -   - ML: 0.1845
2024-09-20 05:46:50 - INFO -   - XGBOOST: 0.0411
2024-09-20 05:46:50 - INFO -   - RL: 0.3461
2024-09-20 05:46:50 - INFO -   - LSTM: 0.0000
2024-09-20 05:46:50 - INFO -   - ARIMA: 0.0414
2024-09-20 05:46:50 - INFO -   - PROPHET: 0.1978
2024-09-20 05:46:50 - INFO -   - TRANSFORMER: 0.0471
2024-09-20 05:46:50 - INFO -   - BITCOIN_FORECAST: 0.1368
2024-09-20 05:46:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:46:50 - INFO - 6. 거래 실행
2024-09-20 05:46:50 - INFO - Cancelling existing orders.
2024-09-20 05:46:51 - INFO - Cancelled 0 orders.
2024-09-20 05:46:51 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84406834.13328472, 'current_price': 84228000.0, 'predictions': {'gpt': 84228000.0, 'ml': 84329073.60000001, 'xgboost': 84228000.0, 'lstm': 84507472.08122684, 'rl': 85070280.0, 'arima': 84953000.0, 'prophet': 84140649.96979888, 'transformer': 84589097.21936566, 'bitcoin_forecast': 83050862.46369901}, 'weights': {'gpt': 0.005147306022016718, 'ml': 0.18448880030139805, 'xgboost': 0.041083871222307236, 'rl': 0.346133460159743, 'lstm': 0.0, 'arima': 0.041377566053871544, 'prophet': 0.19781460884202304, 'transformer': 0.04710977048852702, 'bitcoin_forecast': 0.13684461691011343}}, 현재 가격=84228000.0
2024-09-20 05:46:51 - INFO - 현재 잔고: KRW=89701.2633901, BTC=0.00459936, 총 자산가치=477096.1574701
2024-09-20 05:46:51 - INFO - 매수 시도: 0.0005664341519092226 BTC (약 47709.61574701 KRW)
2024-09-20 05:46:51 - INFO - 주문 결과: {'uuid': '1665368c-b335-44f2-8920-868b2b02d646', 'side': 'bid', 'ord_type': 'limit', 'price': '84228000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T05:46:52+09:00', 'volume': '0.00056643', 'remaining_volume': '0.00056643', 'reserved_fee': '23.85463302', 'remaining_fee': '23.85463302', 'paid_fee': '0', 'locked': '47733.12067302', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 05:46:51 - INFO - buy 주문 성공: UUID=1665368c-b335-44f2-8920-868b2b02d646
2024-09-20 05:46:51 - INFO - Trade executed successfully.
2024-09-20 05:46:51 - INFO - 7. summary 리포트 보내기
2024-09-20 05:46:51 - INFO - Message sent to Discord successfully.
2024-09-20 05:46:51 - INFO - Trading cycle completed.
2024-09-20 05:46:51 - INFO - Performing periodic update.
2024-09-20 05:46:51 - INFO - 계산된 시장 변동성: 0.026986158275047585
2024-09-20 05:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bd-abe2-d3b519258bc9 "HTTP/1.1 200 OK"
2024-09-20 05:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815c-844e-ea48530b07b7 "HTTP/1.1 200 OK"
2024-09-20 05:55:57 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-a8fc-c1121979a15c "HTTP/1.1 200 OK"
2024-09-20 05:56:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d8-bd73-e570dc8863b7 "HTTP/1.1 200 OK"
2024-09-20 05:56:12 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8154-8f4f-d2749f229dff "HTTP/1.1 200 OK"
2024-09-20 05:56:18 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8151-8835-cd26ca722787 "HTTP/1.1 200 OK"
2024-09-20 05:56:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-93f1-c704e253fa66 "HTTP/1.1 200 OK"
2024-09-20 05:56:35 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c2-b256-d259d6a7a146 "HTTP/1.1 200 OK"
2024-09-20 05:56:43 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 05:56:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f8-aa13-c1cab4348a66 "HTTP/1.1 200 OK"
2024-09-20 05:56:49 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:45:34.961786
2024-09-20 05:56:49 - INFO - Starting trading cycle.
2024-09-20 05:56:49 - INFO - ##################################################
2024-09-20 05:56:49 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-20 05:56:49 - INFO - ##################################################
2024-09-20 05:56:49 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 05:56:49 - INFO - 데이터베이스 업데이트 시작
2024-09-20 05:56:49 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:40:00
2024-09-20 05:56:49 - INFO - 새로운 데이터 범위: 2024-09-18 20:40:00 ~ 2024-09-20 05:50:00
2024-09-20 05:56:49 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 05:56:49 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 05:56:49 - INFO - Index: Index([199], dtype='int64')
2024-09-20 05:56:49 - INFO - Date column data type: datetime64[ns]
2024-09-20 05:56:49 - INFO - Sample date values: [Timestamp('2024-09-20 05:50:00')]
2024-09-20 05:56:49 - INFO - Successfully added 1 new data points
2024-09-20 05:56:49 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 05:56:49 - INFO - Final date range: 2024-09-20 05:50:00 to 2024-09-20 05:50:00
2024-09-20 05:56:49 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 05:56:49 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 05:50:00
2024-09-20 05:56:49 - INFO - 데이터베이스 업데이트 완료
2024-09-20 05:56:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 05:56:49 - INFO - GPT | 이전예측가격: 84228000 | 당시BTC가격: 84228000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:56:49 - INFO - ML 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 6/18
2024-09-20 05:56:49 - INFO - ML | 이전예측가격: 84329074 | 당시BTC가격: 84228000 | 예측: 상승 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1329 | 반영가중치값: -0.0200 | 새 가중치: 0.1129 | 예측 총 횟수: 18 | 예측 성공 수: 6 | 예측 성공률: 33.33%
2024-09-20 05:56:49 - INFO - XGBOOST | 이전예측가격: 84228000 | 당시BTC가격: 84228000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 05:56:49 - INFO - LSTM 모델 예측 업데이트: 정확도 47.37%, 적중/전체: 18/38
2024-09-20 05:56:49 - INFO - LSTM | 이전예측가격: 84507472 | 당시BTC가격: 84228000 | 예측: 상승 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1118 | 반영가중치값: -0.0200 | 새 가중치: 0.0918 | 예측 총 횟수: 38 | 예측 성공 수: 18 | 예측 성공률: 47.37%
2024-09-20 05:56:49 - INFO - RL 모델 예측 업데이트: 정확도 56.96%, 적중/전체: 45/79
2024-09-20 05:56:49 - INFO - RL | 이전예측가격: 85070280 | 당시BTC가격: 84228000 | 예측: 상승 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1103 | 반영가중치값: -0.0200 | 새 가중치: 0.0903 | 예측 총 횟수: 79 | 예측 성공 수: 45 | 예측 성공률: 56.96%
2024-09-20 05:56:49 - INFO - ARIMA 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 6/18
2024-09-20 05:56:49 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84228000 | 예측: 상승 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 18 | 예측 성공 수: 6 | 예측 성공률: 33.33%
2024-09-20 05:56:49 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 45/72
2024-09-20 05:56:49 - INFO - PROPHET | 이전예측가격: 84140650 | 당시BTC가격: 84228000 | 예측: 하락 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2773 | 반영가중치값: 0.0200 | 새 가중치: 0.2973 | 예측 총 횟수: 72 | 예측 성공 수: 45 | 예측 성공률: 62.50%
2024-09-20 05:56:49 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 19/38
2024-09-20 05:56:49 - INFO - TRANSFORMER | 이전예측가격: 84589097 | 당시BTC가격: 84228000 | 예측: 상승 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1456 | 반영가중치값: -0.0200 | 새 가중치: 0.1256 | 예측 총 횟수: 38 | 예측 성공 수: 19 | 예측 성공률: 50.00%
2024-09-20 05:56:49 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 73.68%, 적중/전체: 14/19
2024-09-20 05:56:49 - INFO - BITCOIN_FORECAST | 이전예측가격: 83050862 | 당시BTC가격: 84228000 | 예측: 하락 | 지금 BTC가격: 84136000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1785 | 반영가중치값: 0.0200 | 새 가중치: 0.1985 | 예측 총 횟수: 19 | 예측 성공 수: 14 | 예측 성공률: 73.68%
2024-09-20 05:56:49 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 05:56:49 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 05:56:49 - INFO - 새로운 가중치: {'gpt': 0.005347241841525867, 'ml': 0.11729083909868664, 'xgboost': 0.042679684143922106, 'rl': 0.0937902984434104, 'lstm': 0.09538937322627287, 'arima': 0.0, 'prophet': 0.3088167498679514, 'transformer': 0.1304288556979946, 'bitcoin_forecast': 0.20625695768023616}
2024-09-20 05:56:49 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 05:56:49 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 05:56:50 - INFO - Current BTC price: 84136000.0
2024-09-20 05:56:50 - INFO - Analyzing market conditions.
2024-09-20 05:56:50 - INFO - Market analysis: {'current_price': 84136000.0, 'sma_20': 84654900.0, 'rsi_14': 36.04936872497864, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 05:56:50 - INFO - Starting predictions for all models
2024-09-20 05:56:50 - INFO - Attempting prediction for gpt
2024-09-20 05:56:50 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 05:56:50 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:56:50 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 05:56:50 - INFO - GPT prediction: 84136000.0
2024-09-20 05:56:50 - INFO - Attempting prediction for ml
2024-09-20 05:56:50 - INFO - ML prediction: 84220135.99999999
2024-09-20 05:56:50 - INFO - Attempting prediction for xgboost
2024-09-20 05:56:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 05:56:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:56:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 05:56:50 - INFO - XGBOOST prediction: 84136000.0
2024-09-20 05:56:50 - INFO - Attempting prediction for lstm
2024-09-20 05:56:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:56:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:56:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 05:56:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:56:50 - INFO - X 샘플:
[[ 1.26474099  0.97984487  0.90673995  0.81352243 -0.6129871  -0.61004691
   0.81352243]
 [ 0.6407804   0.51325207  0.90673995  0.67230341 -0.9574898  -0.95509002
   0.67230341]
 [ 0.85781017  1.52011021  1.65098614  2.03405826 -0.74080002 -0.73511702
   2.03405826]
 [ 1.56858267  1.25488904  0.7330825   0.34447354  0.34364679  0.34778128
   0.34447354]
 [ 0.05480002  0.20382738  0.20590811  0.20829806  2.75031099  2.75257844
   0.20829806]
 [-0.46607143 -0.52307508 -0.25304371 -0.28596852 -0.38518925 -0.38614081
  -0.28596852]
 [-0.88385375 -0.7146237  -0.41429705 -0.19014132 -0.54441653 -0.54581015
  -0.19014132]
 [-0.38468527 -0.51325207 -0.9972899  -1.01728131  0.14982578  0.14675892
  -1.01728131]
 [-1.0737548  -1.13701296 -1.18335145 -1.0576296  -0.06912502 -0.07433753
  -1.0576296 ]
 [-1.57834901 -1.58395975 -1.55547454 -1.52163495  0.06622416  0.0594238
  -1.52163495]]
2024-09-20 05:56:50 - INFO - y 샘플:
[-1.52163495]
2024-09-20 05:56:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 05:56:50 - INFO - 모델 출력 (스케일링된 예측): [[0.02007575]]
2024-09-20 05:56:50 - INFO - 스케일러 역변환 후 예측 가격: 84441680.49135628
2024-09-20 05:56:50 - INFO - LSTMPredictor 최종 예측 가격: 84441680.49135628
2024-09-20 05:56:50 - INFO - LSTM prediction: 84441680.49135628
2024-09-20 05:56:50 - INFO - Attempting prediction for rl
2024-09-20 05:56:50 - INFO - Preparing state for RL agent.
2024-09-20 05:56:50 - INFO - Prepared state: [[ 8.41360000e+07  7.43958439e+00 -1.09227335e-03  8.46549000e+07
   3.60493687e+01]]
2024-09-20 05:56:50 - INFO - RL prediction: 84977360.0
2024-09-20 05:56:50 - INFO - Attempting prediction for arima
2024-09-20 05:56:50 - INFO - ARIMA 예측 시작
2024-09-20 05:56:50 - INFO - 입력 데이터: {'open': 84221000.0, 'high': 84223000.0, 'low': 84136000.0, 'close': 84136000.0, 'volume': 7.43958439, 'value': 626221071.59942, 'decision': 'sell', 'sma': 84654900.0, 'ema': 84518281.8049536, 'rsi': 36.04936872497864, 'macd': -86037.76976165175, 'signal_line': 604.7347473738373, 'BB_Upper': 85184123.92236333, 'BB_Lower': 84125676.07763667}
2024-09-20 05:56:50 - INFO - Exogenous 변수 예측 시작
2024-09-20 05:56:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84654900.0         0         0
2024-09-20 05:56:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84654900.0         0         0
2024-09-20 05:56:50 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 05:56:50 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 05:56:50 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 05:56:50 - INFO - ARIMA prediction: 84953000.0
2024-09-20 05:56:50 - INFO - Attempting prediction for prophet
2024-09-20 05:56:50 - INFO - PROPHET prediction: 84036556.22169057
2024-09-20 05:56:50 - INFO - Attempting prediction for transformer
2024-09-20 05:56:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 05:56:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 05:56:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 05:56:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 05:56:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 05:56:50 - INFO - X 샘플:
[[ 1.26474099  0.97984487  0.90673995  0.81352243 -0.6129871  -0.61004691
   0.81352243  0.81352243  0.          0.          0.          0.81352243
   0.81352243]
 [ 0.6407804   0.51325207  0.90673995  0.67230341 -0.9574898  -0.95509002
   0.67230341  0.67230341  0.          0.          0.          0.67230341
   0.67230341]
 [ 0.85781017  1.52011021  1.65098614  2.03405826 -0.74080002 -0.73511702
   2.03405826  2.03405826  0.          0.          0.          2.03405826
   2.03405826]
 [ 1.56858267  1.25488904  0.7330825   0.34447354  0.34364679  0.34778128
   0.34447354  0.34447354  0.          0.          0.          0.34447354
   0.34447354]
 [ 0.05480002  0.20382738  0.20590811  0.20829806  2.75031099  2.75257844
   0.20829806  0.20829806  0.          0.          0.          0.20829806
   0.20829806]
 [-0.46607143 -0.52307508 -0.25304371 -0.28596852 -0.38518925 -0.38614081
  -0.28596852 -0.28596852  0.          0.          0.         -0.28596852
  -0.28596852]
 [-0.88385375 -0.7146237  -0.41429705 -0.19014132 -0.54441653 -0.54581015
  -0.19014132 -0.19014132  0.          0.          0.         -0.19014132
  -0.19014132]
 [-0.38468527 -0.51325207 -0.9972899  -1.01728131  0.14982578  0.14675892
  -1.01728131 -1.01728131  0.          0.          0.         -1.01728131
  -1.01728131]
 [-1.0737548  -1.13701296 -1.18335145 -1.0576296  -0.06912502 -0.07433753
  -1.0576296  -1.0576296   0.          0.          0.         -1.0576296
  -1.0576296 ]
 [-1.57834901 -1.58395975 -1.55547454 -1.52163495  0.06622416  0.0594238
  -1.52163495 -1.52163495  0.          0.          0.         -1.52163495
  -1.52163495]]
2024-09-20 05:56:50 - INFO - y 샘플:
[-1.52163495]
2024-09-20 05:56:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 05:56:50 - INFO - 모델 출력 (스케일링된 예측): [0.46432242]
2024-09-20 05:56:50 - INFO - 스케일러 역변환 후 예측 가격: 84529762.86512831
2024-09-20 05:56:50 - INFO - TransformerPredictor 최종 예측 가격: 84529762.86512831
2024-09-20 05:56:50 - INFO - TRANSFORMER prediction: 84529762.86512831
2024-09-20 05:56:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 05:56:50 - INFO - BITCOIN_FORECAST prediction: 83045061.89283577
2024-09-20 05:56:50 - INFO - BitcoinForecast prediction: 83045061.89283577
2024-09-20 05:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 05:56:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 05:56:58 - INFO - 조정된 모델 가중치: {'gpt': 0.005347241841525867, 'ml': 0.11729083909868664, 'xgboost': 0.042679684143922106, 'rl': 0.0937902984434104, 'lstm': 0.09538937322627287, 'arima': 0.0, 'prophet': 0.3088167498679514, 'transformer': 0.1304288556979946, 'bitcoin_forecast': 0.20625695768023616}
2024-09-20 05:56:58 - INFO - 조정된 모델 가중치: {'gpt': 0.005347241841525867, 'ml': 0.11729083909868664, 'xgboost': 0.042679684143922106, 'rl': 0.0937902984434104, 'lstm': 0.09538937322627287, 'arima': 0.0, 'prophet': 0.3088167498679514, 'transformer': 0.1304288556979946, 'bitcoin_forecast': 0.20625695768023616}
2024-09-20 05:56:58 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84049573.01851654, 'current_price': 84136000.0, 'predictions': {'gpt': 84136000.0, 'ml': 84220135.99999999, 'xgboost': 84136000.0, 'lstm': 84441680.49135628, 'rl': 84977360.0, 'arima': 84953000.0, 'prophet': 84036556.22169057, 'transformer': 84529762.86512831, 'bitcoin_forecast': 83045061.89283577}, 'weights': {'gpt': 0.005347241841525867, 'ml': 0.11729083909868664, 'xgboost': 0.042679684143922106, 'rl': 0.0937902984434104, 'lstm': 0.09538937322627287, 'arima': 0.0, 'prophet': 0.3088167498679514, 'transformer': 0.1304288556979946, 'bitcoin_forecast': 0.20625695768023616}}
2024-09-20 05:56:58 - INFO - 모델별 가중치:
2024-09-20 05:56:58 - INFO -   - GPT: 0.0053
2024-09-20 05:56:58 - INFO -   - ML: 0.1173
2024-09-20 05:56:58 - INFO -   - XGBOOST: 0.0427
2024-09-20 05:56:58 - INFO -   - RL: 0.0938
2024-09-20 05:56:58 - INFO -   - LSTM: 0.0954
2024-09-20 05:56:58 - INFO -   - ARIMA: 0.0000
2024-09-20 05:56:58 - INFO -   - PROPHET: 0.3088
2024-09-20 05:56:58 - INFO -   - TRANSFORMER: 0.1304
2024-09-20 05:56:58 - INFO -   - BITCOIN_FORECAST: 0.2063
2024-09-20 05:56:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 05:56:58 - INFO - 6. 거래 실행
2024-09-20 05:56:58 - INFO - Cancelling existing orders.
2024-09-20 05:56:58 - INFO - Cancelled 0 orders.
2024-09-20 05:56:58 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84049573.01851654, 'current_price': 84136000.0, 'predictions': {'gpt': 84136000.0, 'ml': 84220135.99999999, 'xgboost': 84136000.0, 'lstm': 84441680.49135628, 'rl': 84977360.0, 'arima': 84953000.0, 'prophet': 84036556.22169057, 'transformer': 84529762.86512831, 'bitcoin_forecast': 83045061.89283577}, 'weights': {'gpt': 0.005347241841525867, 'ml': 0.11729083909868664, 'xgboost': 0.042679684143922106, 'rl': 0.0937902984434104, 'lstm': 0.09538937322627287, 'arima': 0.0, 'prophet': 0.3088167498679514, 'transformer': 0.1304288556979946, 'bitcoin_forecast': 0.20625695768023616}}, 현재 가격=84136000.0
2024-09-20 05:56:58 - INFO - 현재 잔고: KRW=41968.14271708, BTC=0.00516579, 총 자산가치=476597.05015708
2024-09-20 05:56:58 - INFO - 매도 시도: 0.0005165790000000001 BTC (약 43462.890744000004 KRW)
2024-09-20 05:56:58 - INFO - 주문 결과: {'uuid': '4839e355-619d-47b3-a75b-2fb147d9bf3d', 'side': 'ask', 'ord_type': 'limit', 'price': '84136000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T05:56:59+09:00', 'volume': '0.00051657', 'remaining_volume': '0.00051657', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00051657', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 05:56:58 - INFO - sell 주문 성공: UUID=4839e355-619d-47b3-a75b-2fb147d9bf3d
2024-09-20 05:56:58 - INFO - Trade executed successfully.
2024-09-20 05:56:58 - INFO - 7. summary 리포트 보내기
2024-09-20 05:56:58 - INFO - Message sent to Discord successfully.
2024-09-20 05:56:58 - INFO - Trading cycle completed.
2024-09-20 05:56:58 - INFO - Performing periodic update.
2024-09-20 05:56:58 - INFO - 계산된 시장 변동성: 0.026664973518920512
2024-09-20 06:05:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-b159-c2c22caed211 "HTTP/1.1 200 OK"
2024-09-20 06:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:05:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812a-9615-c850c13f2d1c "HTTP/1.1 200 OK"
2024-09-20 06:05:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:05:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:05:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d5-a6bc-c1c13ae949ab "HTTP/1.1 200 OK"
2024-09-20 06:05:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-a7a4-c84e0cd85d94 "HTTP/1.1 200 OK"
2024-09-20 06:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8144-aa7c-fb208ad34043 "HTTP/1.1 200 OK"
2024-09-20 06:06:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8129-bd6e-ec9a0daf6c80 "HTTP/1.1 200 OK"
2024-09-20 06:06:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8114-9967-d41b86d9dc67 "HTTP/1.1 200 OK"
2024-09-20 06:06:23 - INFO - Updated actual price for prophet prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0c8de83d-e839-460e-ada3-19e19faa1c1c "HTTP/1.1 200 OK"
2024-09-20 06:06:28 - INFO - Updated actual price for transformer prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81af-90fb-d95eecc50e86 "HTTP/1.1 200 OK"
2024-09-20 06:06:33 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 05:55:34.962312
2024-09-20 06:06:33 - INFO - Starting trading cycle.
2024-09-20 06:06:33 - INFO - ##################################################
2024-09-20 06:06:33 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-20 06:06:33 - INFO - ##################################################
2024-09-20 06:06:33 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:06:33 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:06:33 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 05:50:00
2024-09-20 06:06:33 - INFO - 새로운 데이터 범위: 2024-09-18 20:50:00 ~ 2024-09-20 06:00:00
2024-09-20 06:06:33 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:06:33 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:06:33 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:06:33 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:06:33 - INFO - Sample date values: [Timestamp('2024-09-20 06:00:00')]
2024-09-20 06:06:33 - INFO - Successfully added 1 new data points
2024-09-20 06:06:33 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:06:33 - INFO - Final date range: 2024-09-20 06:00:00 to 2024-09-20 06:00:00
2024-09-20 06:06:33 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:06:33 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:00:00
2024-09-20 06:06:33 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:06:33 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:06:33 - INFO - GPT | 이전예측가격: 84136000 | 당시BTC가격: 84136000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:06:33 - INFO - ML 모델 예측 업데이트: 정확도 31.58%, 적중/전체: 6/19
2024-09-20 06:06:33 - INFO - ML | 이전예측가격: 84220136 | 당시BTC가격: 84136000 | 예측: 상승 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1845 | 반영가중치값: -0.0200 | 새 가중치: 0.1645 | 예측 총 횟수: 19 | 예측 성공 수: 6 | 예측 성공률: 31.58%
2024-09-20 06:06:33 - INFO - XGBOOST | 이전예측가격: 84136000 | 당시BTC가격: 84136000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:06:33 - INFO - LSTM 모델 예측 업데이트: 정확도 46.15%, 적중/전체: 18/39
2024-09-20 06:06:33 - INFO - LSTM | 이전예측가격: 84441680 | 당시BTC가격: 84136000 | 예측: 상승 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 39 | 예측 성공 수: 18 | 예측 성공률: 46.15%
2024-09-20 06:06:33 - INFO - RL 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 45/80
2024-09-20 06:06:33 - INFO - RL | 이전예측가격: 84977360 | 당시BTC가격: 84136000 | 예측: 상승 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3461 | 반영가중치값: -0.0200 | 새 가중치: 0.3261 | 예측 총 횟수: 80 | 예측 성공 수: 45 | 예측 성공률: 56.25%
2024-09-20 06:06:33 - INFO - ARIMA 모델 예측 업데이트: 정확도 31.58%, 적중/전체: 6/19
2024-09-20 06:06:33 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 84136000 | 예측: 상승 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0414 | 반영가중치값: -0.0200 | 새 가중치: 0.0214 | 예측 총 횟수: 19 | 예측 성공 수: 6 | 예측 성공률: 31.58%
2024-09-20 06:06:33 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.01%, 적중/전체: 46/73
2024-09-20 06:06:33 - INFO - PROPHET | 이전예측가격: 84036556 | 당시BTC가격: 84136000 | 예측: 하락 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1978 | 반영가중치값: 0.0200 | 새 가중치: 0.2178 | 예측 총 횟수: 73 | 예측 성공 수: 46 | 예측 성공률: 63.01%
2024-09-20 06:06:33 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 48.72%, 적중/전체: 19/39
2024-09-20 06:06:34 - INFO - TRANSFORMER | 이전예측가격: 84529763 | 당시BTC가격: 84136000 | 예측: 상승 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0471 | 반영가중치값: -0.0200 | 새 가중치: 0.0271 | 예측 총 횟수: 39 | 예측 성공 수: 19 | 예측 성공률: 48.72%
2024-09-20 06:06:34 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 15/20
2024-09-20 06:06:34 - INFO - BITCOIN_FORECAST | 이전예측가격: 83045062 | 당시BTC가격: 84136000 | 예측: 하락 | 지금 BTC가격: 83959000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1368 | 반영가중치값: 0.0200 | 새 가중치: 0.1568 | 예측 총 횟수: 20 | 예측 성공 수: 15 | 예측 성공률: 75.00%
2024-09-20 06:06:34 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:06:34 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:06:34 - INFO - 새로운 가중치: {'gpt': 0.005559643872958234, 'ml': 0.1710225903126462, 'xgboost': 0.04437499770588997, 'rl': 0.3390880658254237, 'lstm': 0.0, 'arima': 0.02222672129904112, 'prophet': 0.22646659556056092, 'transformer': 0.028186619169413542, 'bitcoin_forecast': 0.16307476625406622}
2024-09-20 06:06:34 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:06:34 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:06:34 - INFO - Current BTC price: 83987000.0
2024-09-20 06:06:34 - INFO - Analyzing market conditions.
2024-09-20 06:06:34 - INFO - Market analysis: {'current_price': 83987000.0, 'sma_20': 84604350.0, 'rsi_14': 32.57395575940002, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:06:34 - INFO - Starting predictions for all models
2024-09-20 06:06:34 - INFO - Attempting prediction for gpt
2024-09-20 06:06:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:06:34 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:06:34 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:06:34 - INFO - GPT prediction: 83987000.0
2024-09-20 06:06:34 - INFO - Attempting prediction for ml
2024-09-20 06:06:34 - INFO - ML prediction: 84070986.99999999
2024-09-20 06:06:34 - INFO - Attempting prediction for xgboost
2024-09-20 06:06:34 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:06:34 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:06:34 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:06:34 - INFO - XGBOOST prediction: 83987000.0
2024-09-20 06:06:34 - INFO - Attempting prediction for lstm
2024-09-20 06:06:34 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:06:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:06:34 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:06:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:06:34 - INFO - X 샘플:
[[ 0.88866528  0.73089571  1.03273856  0.84264496 -1.00596769 -1.00575076
   0.84264496]
 [ 1.0797761   1.6066036   1.64142533  2.01238348 -0.84004331 -0.83666074
   2.01238348]
 [ 1.70566401  1.37592932  0.89071164  0.56104125 -0.00965723 -0.00425266
   0.56104125]
 [ 0.37266609  0.46177572  0.45955851  0.4440674   1.83318137  1.84427973
   0.4440674 ]
 [-0.08599987 -0.17044266  0.08420167  0.01949564 -0.56774389 -0.56840783
   0.01949564]
 [-0.45388818 -0.33704074 -0.04768046  0.10181057 -0.68966791 -0.69114331
   0.10181057]
 [-0.01433331 -0.16189917 -0.5244851  -0.60869726 -0.15807047 -0.1587756
  -0.60869726]
 [-0.62111014 -0.70441088 -0.6766568  -0.64335618 -0.32572617 -0.32872921
  -0.64335618]
 [-1.06544278 -1.09313975 -0.98100018 -1.04193375 -0.22208617 -0.22590883
  -1.04193375]
 [-1.80599719 -1.70827115 -1.87881317 -1.68745611  1.98578147  1.97534921
  -1.68745611]]
2024-09-20 06:06:34 - INFO - y 샘플:
[-1.68745611]
2024-09-20 06:06:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:06:34 - INFO - 모델 출력 (스케일링된 예측): [[0.09938654]]
2024-09-20 06:06:34 - INFO - 스케일러 역변환 후 예측 가격: 84399440.48143712
2024-09-20 06:06:34 - INFO - LSTMPredictor 최종 예측 가격: 84399440.48143712
2024-09-20 06:06:34 - INFO - LSTM prediction: 84399440.48143712
2024-09-20 06:06:34 - INFO - Attempting prediction for rl
2024-09-20 06:06:34 - INFO - Preparing state for RL agent.
2024-09-20 06:06:34 - INFO - Prepared state: [[ 8.39870000e+07  1.73578703e+01 -1.77094228e-03  8.46043500e+07
   3.25739558e+01]]
2024-09-20 06:06:34 - INFO - RL prediction: 84826870.0
2024-09-20 06:06:34 - INFO - Attempting prediction for arima
2024-09-20 06:06:34 - INFO - ARIMA 예측 시작
2024-09-20 06:06:34 - INFO - 입력 데이터: {'open': 84066000.0, 'high': 84079000.0, 'low': 83959000.0, 'close': 83987000.0, 'volume': 17.35787029, 'value': 1458285958.13749, 'decision': 'sell', 'sma': 84604350.0, 'ema': 84467683.53781517, 'rsi': 32.57395575940002, 'macd': -115877.62176905572, 'signal_line': -22691.736555912077, 'BB_Upper': 85183600.64523195, 'BB_Lower': 84025099.35476805}
2024-09-20 06:06:34 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:06:34 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84604350.0         0         0
2024-09-20 06:06:34 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84604350.0         0         0
2024-09-20 06:06:34 - INFO - ARIMA 예측 결과: 4980    8.495300e+09
dtype: float64
2024-09-20 06:06:34 - INFO - 신뢰 구간: [[8.20600395e+09 8.78459605e+09]]
2024-09-20 06:06:34 - INFO - 최종 ARIMA 예측값: 84953000.0
2024-09-20 06:06:34 - INFO - ARIMA prediction: 84953000.0
2024-09-20 06:06:34 - INFO - Attempting prediction for prophet
2024-09-20 06:06:34 - INFO - PROPHET prediction: 83874882.59571652
2024-09-20 06:06:34 - INFO - Attempting prediction for transformer
2024-09-20 06:06:34 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:06:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:06:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:06:34 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:06:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:06:34 - INFO - X 샘플:
[[ 0.88866528  0.73089571  1.03273856  0.84264496 -1.00596769 -1.00575076
   0.84264496  0.84264496  0.          0.          0.          0.84264496
   0.84264496]
 [ 1.0797761   1.6066036   1.64142533  2.01238348 -0.84004331 -0.83666074
   2.01238348  2.01238348  0.          0.          0.          2.01238348
   2.01238348]
 [ 1.70566401  1.37592932  0.89071164  0.56104125 -0.00965723 -0.00425266
   0.56104125  0.56104125  0.          0.          0.          0.56104125
   0.56104125]
 [ 0.37266609  0.46177572  0.45955851  0.4440674   1.83318137  1.84427973
   0.4440674   0.4440674   0.          0.          0.          0.4440674
   0.4440674 ]
 [-0.08599987 -0.17044266  0.08420167  0.01949564 -0.56774389 -0.56840783
   0.01949564  0.01949564  0.          0.          0.          0.01949564
   0.01949564]
 [-0.45388818 -0.33704074 -0.04768046  0.10181057 -0.68966791 -0.69114331
   0.10181057  0.10181057  0.          0.          0.          0.10181057
   0.10181057]
 [-0.01433331 -0.16189917 -0.5244851  -0.60869726 -0.15807047 -0.1587756
  -0.60869726 -0.60869726  0.          0.          0.         -0.60869726
  -0.60869726]
 [-0.62111014 -0.70441088 -0.6766568  -0.64335618 -0.32572617 -0.32872921
  -0.64335618 -0.64335618  0.          0.          0.         -0.64335618
  -0.64335618]
 [-1.06544278 -1.09313975 -0.98100018 -1.04193375 -0.22208617 -0.22590883
  -1.04193375 -1.04193375  0.          0.          0.         -1.04193375
  -1.04193375]
 [-1.80599719 -1.70827115 -1.87881317 -1.68745611  1.98578147  1.97534921
  -1.68745611 -1.68745611  0.          0.          0.         -1.68745611
  -1.68745611]]
2024-09-20 06:06:34 - INFO - y 샘플:
[-1.68745611]
2024-09-20 06:06:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:06:34 - INFO - 모델 출력 (스케일링된 예측): [0.46328762]
2024-09-20 06:06:34 - INFO - 스케일러 역변환 후 예측 가격: 84483436.42779623
2024-09-20 06:06:34 - INFO - TransformerPredictor 최종 예측 가격: 84483436.42779623
2024-09-20 06:06:34 - INFO - TRANSFORMER prediction: 84483436.42779623
2024-09-20 06:06:34 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:06:34 - INFO - BITCOIN_FORECAST prediction: 83198539.35154316
2024-09-20 06:06:34 - INFO - BitcoinForecast prediction: 83198539.35154316
2024-09-20 06:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:06:42 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:06:42 - INFO - 조정된 모델 가중치: {'gpt': 0.005559643872958234, 'ml': 0.1710225903126462, 'xgboost': 0.04437499770588997, 'rl': 0.3390880658254237, 'lstm': 0.0, 'arima': 0.02222672129904112, 'prophet': 0.22646659556056092, 'transformer': 0.028186619169413542, 'bitcoin_forecast': 0.16307476625406622}
2024-09-20 06:06:42 - INFO - 조정된 모델 가중치: {'gpt': 0.005559643872958234, 'ml': 0.1710225903126462, 'xgboost': 0.04437499770588997, 'rl': 0.3390880658254237, 'lstm': 0.0, 'arima': 0.02222672129904112, 'prophet': 0.22646659556056092, 'transformer': 0.028186619169413542, 'bitcoin_forecast': 0.16307476625406622}
2024-09-20 06:06:42 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84167648.56264558, 'current_price': 83987000.0, 'predictions': {'gpt': 83987000.0, 'ml': 84070986.99999999, 'xgboost': 83987000.0, 'lstm': 84399440.48143712, 'rl': 84826870.0, 'arima': 84953000.0, 'prophet': 83874882.59571652, 'transformer': 84483436.42779623, 'bitcoin_forecast': 83198539.35154316}, 'weights': {'gpt': 0.005559643872958234, 'ml': 0.1710225903126462, 'xgboost': 0.04437499770588997, 'rl': 0.3390880658254237, 'lstm': 0.0, 'arima': 0.02222672129904112, 'prophet': 0.22646659556056092, 'transformer': 0.028186619169413542, 'bitcoin_forecast': 0.16307476625406622}}
2024-09-20 06:06:42 - INFO - 모델별 가중치:
2024-09-20 06:06:42 - INFO -   - GPT: 0.0056
2024-09-20 06:06:42 - INFO -   - ML: 0.1710
2024-09-20 06:06:42 - INFO -   - XGBOOST: 0.0444
2024-09-20 06:06:42 - INFO -   - RL: 0.3391
2024-09-20 06:06:42 - INFO -   - LSTM: 0.0000
2024-09-20 06:06:42 - INFO -   - ARIMA: 0.0222
2024-09-20 06:06:42 - INFO -   - PROPHET: 0.2265
2024-09-20 06:06:42 - INFO -   - TRANSFORMER: 0.0282
2024-09-20 06:06:42 - INFO -   - BITCOIN_FORECAST: 0.1631
2024-09-20 06:06:42 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:06:42 - INFO - 6. 거래 실행
2024-09-20 06:06:42 - INFO - Cancelling existing orders.
2024-09-20 06:06:42 - INFO - Cancelled 1 orders.
2024-09-20 06:06:42 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84167648.56264558, 'current_price': 83987000.0, 'predictions': {'gpt': 83987000.0, 'ml': 84070986.99999999, 'xgboost': 83987000.0, 'lstm': 84399440.48143712, 'rl': 84826870.0, 'arima': 84953000.0, 'prophet': 83874882.59571652, 'transformer': 84483436.42779623, 'bitcoin_forecast': 83198539.35154316}, 'weights': {'gpt': 0.005559643872958234, 'ml': 0.1710225903126462, 'xgboost': 0.04437499770588997, 'rl': 0.3390880658254237, 'lstm': 0.0, 'arima': 0.02222672129904112, 'prophet': 0.22646659556056092, 'transformer': 0.028186619169413542, 'bitcoin_forecast': 0.16307476625406622}}, 현재 가격=83987000.0
2024-09-20 06:06:42 - INFO - 현재 잔고: KRW=41968.14271708, BTC=0.00516579, 총 자산가치=475827.34744708
2024-09-20 06:06:42 - INFO - 매수 시도: 0.0004996980808587043 BTC (약 41968.14271708 KRW)
2024-09-20 06:06:42 - INFO - 주문 결과: None
2024-09-20 06:06:42 - ERROR - 주문 실패
2024-09-20 06:06:42 - WARNING - Trade execution failed: Failed to place order
2024-09-20 06:06:42 - INFO - 7. summary 리포트 보내기
2024-09-20 06:06:43 - INFO - Message sent to Discord successfully.
2024-09-20 06:06:43 - INFO - Trading cycle completed.
2024-09-20 06:06:43 - INFO - Performing periodic update.
2024-09-20 06:06:43 - INFO - 계산된 시장 변동성: 0.02684195391692667
2024-09-20 06:16:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813d-be44-f91602cdf98f "HTTP/1.1 200 OK"
2024-09-20 06:16:20 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:16:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81af-93d7-ceb63d4fedb6 "HTTP/1.1 200 OK"
2024-09-20 06:16:26 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813b-bdde-e8bbcb41a97d "HTTP/1.1 200 OK"
2024-09-20 06:16:34 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8170-a520-d69f5b149b69 "HTTP/1.1 200 OK"
2024-09-20 06:16:40 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-95d4-d24d1c9b1aac "HTTP/1.1 200 OK"
2024-09-20 06:16:45 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:16:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-9078-ebe3ad530976 "HTTP/1.1 200 OK"
2024-09-20 06:16:57 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:17:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:17:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8131-a9f9-fc98c76c5244 "HTTP/1.1 200 OK"
2024-09-20 06:17:06 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:17:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:17:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ae-96ad-d796b3d19f23 "HTTP/1.1 200 OK"
2024-09-20 06:17:15 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:17:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:17:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8151-b47a-ee88a3e7742c "HTTP/1.1 200 OK"
2024-09-20 06:17:20 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:05:34.962618
2024-09-20 06:17:20 - INFO - Starting trading cycle.
2024-09-20 06:17:20 - INFO - ##################################################
2024-09-20 06:17:20 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-20 06:17:20 - INFO - ##################################################
2024-09-20 06:17:20 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:17:20 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:17:20 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:00:00
2024-09-20 06:17:20 - INFO - 새로운 데이터 범위: 2024-09-18 21:00:00 ~ 2024-09-20 06:10:00
2024-09-20 06:17:20 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:17:20 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:17:20 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:17:20 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:17:20 - INFO - Sample date values: [Timestamp('2024-09-20 06:10:00')]
2024-09-20 06:17:21 - INFO - Successfully added 1 new data points
2024-09-20 06:17:21 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:17:21 - INFO - Final date range: 2024-09-20 06:10:00 to 2024-09-20 06:10:00
2024-09-20 06:17:21 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:17:21 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:10:00
2024-09-20 06:17:21 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:17:21 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-20 06:17:21 - INFO - 재학습 대상 모델: ['ml', 'arima', 'lstm']
2024-09-20 06:17:21 - INFO - ml 모델 재학습 시작
2024-09-20 06:17:21 - INFO - prepare_data_for_ml 메서드 시작. 데이터 shape: (5000, 15)
2024-09-20 06:17:21 - INFO - 최종 X shape: (4999, 12), y shape: (4999,)
2024-09-20 06:17:21 - INFO - ML 모델 훈련 시작
2024-09-20 06:17:25 - INFO - ML 모델 학습 완료. MSE: 0.2668, RMSE: 0.5166, MAE: 0.4921, R2: -0.0674
2024-09-20 06:17:25 - INFO - ml 모델의 예측 통계가 초기화되었습니다.
2024-09-20 06:17:25 - INFO - ml 모델 재학습 완료
2024-09-20 06:17:25 - INFO - arima 모델 재학습 시작
2024-09-20 06:17:25 - INFO - ARIMA 훈련 시작. 입력 데이터 타입: <class 'pandas.core.frame.DataFrame'>
2024-09-20 06:17:25 - INFO - 데이터 샘플:
                    date        open  ...      BB_Upper      BB_Lower
4999 2024-08-10 14:30:00  85000000.0  ...  8.566282e+07  8.477578e+07
4998 2024-08-10 14:40:00  84880000.0  ...  8.566282e+07  8.477578e+07
4997 2024-08-10 14:50:00  84989000.0  ...  8.566282e+07  8.477578e+07
4996 2024-08-10 15:00:00  84975000.0  ...  8.566282e+07  8.477578e+07
4995 2024-08-10 15:10:00  84980000.0  ...  8.566282e+07  8.477578e+07

[5 rows x 15 columns]
2024-09-20 06:17:25 - INFO - 전처리 후 데이터 shape: (4980, 6)
2024-09-20 06:17:25 - INFO - 전처리 후 데이터 컬럼: ['close', 'returns', 'volatility', 'sma', 'upper_bb', 'lower_bb']
2024-09-20 06:17:25 - INFO - ARIMA 모델 훈련 완료
2024-09-20 06:17:25 - INFO - arima 모델의 예측 통계가 초기화되었습니다.
2024-09-20 06:17:25 - INFO - arima 모델 재학습 완료
2024-09-20 06:17:25 - INFO - lstm 모델 재학습 시작
2024-09-20 06:17:25 - INFO - LSTM 하이퍼파라미터 랜덤 조정: hidden_dim=43, num_layers=2, learning_rate=0.0009095750700256198
2024-09-20 06:17:25 - INFO - LSTM 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 06:17:25 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 06:17:25 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-20 06:17:25 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:17:25 - INFO - NaN 값 개수:
date           0
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:17:25 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:17:25 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:17:25 - INFO - X 샘플:
[[ 0.48507308  0.49176821  0.48839165  0.49522952 -0.19332777 -0.17817624
   0.49964972]
 [ 0.49290341  0.48854255  0.47953936  0.47520421 -0.1155271  -0.0752985
   0.49927377]
 [ 0.47622659  0.47575938  0.47445528  0.47359023  0.05713244  0.15316256
   0.49876746]
 [ 0.47048833  0.46691869  0.47002913  0.46773208 -0.16781545 -0.14502272
   0.49726672]
 [ 0.46588577  0.46458904  0.468474    0.46886784 -0.17923877 -0.16019166
   0.49554465]
 [ 0.47138493  0.46703815  0.4628516   0.45906441 -0.12943226 -0.09439607
   0.49418034]
 [ 0.46379369  0.45945188  0.46105722  0.45858619 -0.14514028 -0.11540072
   0.49314346]
 [ 0.45823475  0.45401605  0.45746845  0.4530867  -0.13543003 -0.1026931
   0.49095449]
 [ 0.44896985  0.44541429  0.44688159  0.44417992  0.07142987  0.1693615
   0.48788933]
 [ 0.44018314  0.45347844  0.44335264  0.45332581  0.05973653  0.15404608
   0.48542447]]
2024-09-20 06:17:25 - INFO - y 샘플:
[0.45332581]
2024-09-20 06:17:25 - INFO - Epoch [10/50], Loss: 0.1434
2024-09-20 06:17:25 - INFO - Epoch [20/50], Loss: 0.0192
2024-09-20 06:17:25 - INFO - Epoch [30/50], Loss: 0.0084
2024-09-20 06:17:25 - INFO - Epoch [40/50], Loss: 0.0039
2024-09-20 06:17:25 - INFO - Epoch [50/50], Loss: 0.0000
2024-09-20 06:17:25 - INFO - LSTM 훈련 완료. MSE: 5.942173447692767e-05
2024-09-20 06:17:25 - INFO - lstm 모델의 예측 통계가 초기화되었습니다.
2024-09-20 06:17:25 - INFO - lstm 모델 재학습 완료
2024-09-20 06:17:25 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:17:25 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:17:25 - INFO - GPT | 이전예측가격: 83987000 | 당시BTC가격: 83987000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:17:25 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 06:17:26 - INFO - ML | 이전예측가격: 84070987 | 당시BTC가격: 83987000 | 예측: 상승 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1173 | 반영가중치값: 0.0200 | 새 가중치: 0.1373 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 06:17:26 - INFO - XGBOOST | 이전예측가격: 83987000 | 당시BTC가격: 83987000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:17:26 - INFO - LSTM 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 06:17:26 - INFO - LSTM | 이전예측가격: 84399440 | 당시BTC가격: 83987000 | 예측: 상승 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0954 | 반영가중치값: 0.0200 | 새 가중치: 0.1154 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 06:17:26 - INFO - RL 모델 예측 업데이트: 정확도 56.79%, 적중/전체: 46/81
2024-09-20 06:17:26 - INFO - RL | 이전예측가격: 84826870 | 당시BTC가격: 83987000 | 예측: 상승 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0938 | 반영가중치값: 0.0200 | 새 가중치: 0.1138 | 예측 총 횟수: 81 | 예측 성공 수: 46 | 예측 성공률: 56.79%
2024-09-20 06:17:26 - INFO - ARIMA 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 06:17:26 - INFO - ARIMA | 이전예측가격: 84953000 | 당시BTC가격: 83987000 | 예측: 상승 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 06:17:26 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.16%, 적중/전체: 46/74
2024-09-20 06:17:26 - INFO - PROPHET | 이전예측가격: 83874883 | 당시BTC가격: 83987000 | 예측: 하락 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3088 | 반영가중치값: -0.0200 | 새 가중치: 0.2888 | 예측 총 횟수: 74 | 예측 성공 수: 46 | 예측 성공률: 62.16%
2024-09-20 06:17:26 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 20/40
2024-09-20 06:17:26 - INFO - TRANSFORMER | 이전예측가격: 84483436 | 당시BTC가격: 83987000 | 예측: 상승 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1304 | 반영가중치값: 0.0200 | 새 가중치: 0.1504 | 예측 총 횟수: 40 | 예측 성공 수: 20 | 예측 성공률: 50.00%
2024-09-20 06:17:26 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 15/21
2024-09-20 06:17:26 - INFO - BITCOIN_FORECAST | 이전예측가격: 83198539 | 당시BTC가격: 83987000 | 예측: 하락 | 지금 BTC가격: 84137000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2063 | 반영가중치값: -0.0200 | 새 가중치: 0.1863 | 예측 총 횟수: 21 | 예측 성공 수: 15 | 예측 성공률: 71.43%
2024-09-20 06:17:26 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:17:26 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:17:26 - INFO - 새로운 가중치: {'gpt': 0.0052355245105752644, 'ml': 0.12928697765602704, 'xgboost': 0.04178799819821722, 'rl': 0.10715648523169805, 'lstm': 0.10866233621985939, 'arima': 0.018834028330629356, 'prophet': 0.2719791424686644, 'transformer': 0.14165906649800925, 'bitcoin_forecast': 0.17539844088632003}
2024-09-20 06:17:26 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:17:26 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:17:26 - INFO - Current BTC price: 84137000.0
2024-09-20 06:17:26 - INFO - Analyzing market conditions.
2024-09-20 06:17:26 - INFO - Market analysis: {'current_price': 84140000.0, 'sma_20': 84563700.0, 'rsi_14': 39.06974052489096, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:17:26 - INFO - Starting predictions for all models
2024-09-20 06:17:26 - INFO - Attempting prediction for gpt
2024-09-20 06:17:26 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:17:26 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:17:26 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:17:26 - INFO - GPT prediction: 84137000.0
2024-09-20 06:17:26 - INFO - Attempting prediction for ml
2024-09-20 06:17:26 - INFO - ML prediction: 84123172.0
2024-09-20 06:17:26 - INFO - Attempting prediction for xgboost
2024-09-20 06:17:26 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:17:26 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:17:26 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:17:26 - INFO - XGBOOST prediction: 84140000.0
2024-09-20 06:17:26 - INFO - Attempting prediction for lstm
2024-09-20 06:17:26 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:17:26 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:17:26 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:17:26 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:17:26 - INFO - X 샘플:
[[ 1.18503652  1.75808701  1.74511915  2.2000875  -1.04482989 -1.04210667
   2.2000875 ]
 [ 1.70755346  1.53188568  1.07756259  0.7480991  -0.27480839 -0.26923203
   0.7480991 ]
 [ 0.59471203  0.63545818  0.69416862  0.63107317  1.43406581  1.44709419
   0.63107317]
 [ 0.21179885  0.01549898  0.36039033  0.20631238 -0.79232517 -0.79303908
   0.20631238]
 [-0.09532943 -0.14786865  0.24311688  0.28866396 -0.90538597 -0.90699658
   0.28866396]
 [ 0.27162904  0.02387681 -0.18087174 -0.42216021 -0.41243279 -0.41270356
  -0.42216021]
 [-0.23493319 -0.50811521 -0.31618726 -0.45683456 -0.56790083 -0.57050216
  -0.45683456]
 [-0.60588033 -0.88930634 -0.5868183  -0.85558958 -0.4717949  -0.47503545
  -0.85558958]
 [-1.22412557 -1.49250989 -1.38517987 -1.50139935  1.57557271  1.56878964
  -1.50139935]
 [-1.81046138 -0.92700656 -1.65130039 -0.83825241  1.45983944  1.4537317
  -0.83825241]]
2024-09-20 06:17:26 - INFO - y 샘플:
[-0.83825241]
2024-09-20 06:17:26 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:17:26 - INFO - 모델 출력 (스케일링된 예측): [[0.14477558]]
2024-09-20 06:17:26 - INFO - 스케일러 역변환 후 예측 가격: 84366802.34722212
2024-09-20 06:17:26 - INFO - LSTMPredictor 최종 예측 가격: 84366802.34722212
2024-09-20 06:17:26 - INFO - LSTM prediction: 84366802.34722212
2024-09-20 06:17:26 - INFO - Attempting prediction for rl
2024-09-20 06:17:26 - INFO - Preparing state for RL agent.
2024-09-20 06:17:26 - INFO - Prepared state: [[8.41400000e+07 1.67972110e+01 1.82171050e-03 8.45637000e+07
  3.90697405e+01]]
2024-09-20 06:17:26 - INFO - RL prediction: 84978370.0
2024-09-20 06:17:26 - INFO - Attempting prediction for arima
2024-09-20 06:17:26 - INFO - ARIMA 예측 시작
2024-09-20 06:17:26 - INFO - 입력 데이터: {'open': 83919000.0, 'high': 84214000.0, 'low': 83900000.0, 'close': 84140000.0, 'volume': 16.79721104, 'value': 1411444539.28174, 'decision': 'sell', 'sma': 84563700.0, 'ema': 84436475.58183277, 'rsi': 39.06974052489096, 'macd': -125730.75229603052, 'signal_line': -43299.53970393577, 'BB_Upper': 85153390.12201598, 'BB_Lower': 83974009.87798402}
2024-09-20 06:17:26 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:17:26 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84563700.0         0         0
2024-09-20 06:17:26 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84563700.0         0         0
2024-09-20 06:17:26 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 06:17:26 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 06:17:26 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 06:17:26 - INFO - ARIMA prediction: 84140000.0
2024-09-20 06:17:26 - INFO - Attempting prediction for prophet
2024-09-20 06:17:26 - INFO - PROPHET prediction: 84063418.65756023
2024-09-20 06:17:26 - INFO - Attempting prediction for transformer
2024-09-20 06:17:26 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:17:26 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:17:26 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:17:26 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:17:26 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:17:26 - INFO - X 샘플:
[[ 1.18503652  1.75808701  1.74511915  2.2000875  -1.04482989 -1.04210667
   2.2000875   2.2000875   0.          0.          0.          2.2000875
   2.2000875 ]
 [ 1.70755346  1.53188568  1.07756259  0.7480991  -0.27480839 -0.26923203
   0.7480991   0.7480991   0.          0.          0.          0.7480991
   0.7480991 ]
 [ 0.59471203  0.63545818  0.69416862  0.63107317  1.43406581  1.44709419
   0.63107317  0.63107317  0.          0.          0.          0.63107317
   0.63107317]
 [ 0.21179885  0.01549898  0.36039033  0.20631238 -0.79232517 -0.79303908
   0.20631238  0.20631238  0.          0.          0.          0.20631238
   0.20631238]
 [-0.09532943 -0.14786865  0.24311688  0.28866396 -0.90538597 -0.90699658
   0.28866396  0.28866396  0.          0.          0.          0.28866396
   0.28866396]
 [ 0.27162904  0.02387681 -0.18087174 -0.42216021 -0.41243279 -0.41270356
  -0.42216021 -0.42216021  0.          0.          0.         -0.42216021
  -0.42216021]
 [-0.23493319 -0.50811521 -0.31618726 -0.45683456 -0.56790083 -0.57050216
  -0.45683456 -0.45683456  0.          0.          0.         -0.45683456
  -0.45683456]
 [-0.60588033 -0.88930634 -0.5868183  -0.85558958 -0.4717949  -0.47503545
  -0.85558958 -0.85558958  0.          0.          0.         -0.85558958
  -0.85558958]
 [-1.22412557 -1.49250989 -1.38517987 -1.50139935  1.57557271  1.56878964
  -1.50139935 -1.50139935  0.          0.          0.         -1.50139935
  -1.50139935]
 [-1.81046138 -0.92700656 -1.65130039 -0.83825241  1.45983944  1.4537317
  -0.83825241 -0.83825241  0.          0.          0.         -0.83825241
  -0.83825241]]
2024-09-20 06:17:26 - INFO - y 샘플:
[-0.83825241]
2024-09-20 06:17:26 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:17:26 - INFO - 모델 출력 (스케일링된 예측): [0.4606878]
2024-09-20 06:17:26 - INFO - 스케일러 역변환 후 예측 가격: 84439689.00909282
2024-09-20 06:17:26 - INFO - TransformerPredictor 최종 예측 가격: 84439689.00909282
2024-09-20 06:17:26 - INFO - TRANSFORMER prediction: 84439689.00909282
2024-09-20 06:17:26 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:17:26 - INFO - BITCOIN_FORECAST prediction: 83218855.93141735
2024-09-20 06:17:26 - INFO - BitcoinForecast prediction: 83218855.93141735
2024-09-20 06:17:27 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:27 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:30 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:31 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:17:34 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:17:34 - INFO - 조정된 모델 가중치: {'gpt': 0.0052355245105752644, 'ml': 0.12928697765602704, 'xgboost': 0.04178799819821722, 'rl': 0.10715648523169805, 'lstm': 0.10866233621985939, 'arima': 0.018834028330629356, 'prophet': 0.2719791424686644, 'transformer': 0.14165906649800925, 'bitcoin_forecast': 0.17539844088632003}
2024-09-20 06:17:34 - INFO - 조정된 모델 가중치: {'gpt': 0.0052355245105752644, 'ml': 0.12928697765602704, 'xgboost': 0.04178799819821722, 'rl': 0.10715648523169805, 'lstm': 0.10866233621985939, 'arima': 0.018834028330629356, 'prophet': 0.2719791424686644, 'transformer': 0.14165906649800925, 'bitcoin_forecast': 0.17539844088632003}
2024-09-20 06:17:34 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84112348.21156032, 'current_price': 84137000.0, 'predictions': {'gpt': 84137000.0, 'ml': 84123172.0, 'xgboost': 84140000.0, 'lstm': 84366802.34722212, 'rl': 84978370.0, 'arima': 84140000.0, 'prophet': 84063418.65756023, 'transformer': 84439689.00909282, 'bitcoin_forecast': 83218855.93141735}, 'weights': {'gpt': 0.0052355245105752644, 'ml': 0.12928697765602704, 'xgboost': 0.04178799819821722, 'rl': 0.10715648523169805, 'lstm': 0.10866233621985939, 'arima': 0.018834028330629356, 'prophet': 0.2719791424686644, 'transformer': 0.14165906649800925, 'bitcoin_forecast': 0.17539844088632003}}
2024-09-20 06:17:34 - INFO - 모델별 가중치:
2024-09-20 06:17:34 - INFO -   - GPT: 0.0052
2024-09-20 06:17:34 - INFO -   - ML: 0.1293
2024-09-20 06:17:34 - INFO -   - XGBOOST: 0.0418
2024-09-20 06:17:34 - INFO -   - RL: 0.1072
2024-09-20 06:17:34 - INFO -   - LSTM: 0.1087
2024-09-20 06:17:34 - INFO -   - ARIMA: 0.0188
2024-09-20 06:17:34 - INFO -   - PROPHET: 0.2720
2024-09-20 06:17:34 - INFO -   - TRANSFORMER: 0.1417
2024-09-20 06:17:34 - INFO -   - BITCOIN_FORECAST: 0.1754
2024-09-20 06:17:34 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:17:35 - INFO - 6. 거래 실행
2024-09-20 06:17:35 - INFO - Cancelling existing orders.
2024-09-20 06:17:35 - INFO - Cancelled 0 orders.
2024-09-20 06:17:35 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84112348.21156032, 'current_price': 84137000.0, 'predictions': {'gpt': 84137000.0, 'ml': 84123172.0, 'xgboost': 84140000.0, 'lstm': 84366802.34722212, 'rl': 84978370.0, 'arima': 84140000.0, 'prophet': 84063418.65756023, 'transformer': 84439689.00909282, 'bitcoin_forecast': 83218855.93141735}, 'weights': {'gpt': 0.0052355245105752644, 'ml': 0.12928697765602704, 'xgboost': 0.04178799819821722, 'rl': 0.10715648523169805, 'lstm': 0.10866233621985939, 'arima': 0.018834028330629356, 'prophet': 0.2719791424686644, 'transformer': 0.14165906649800925, 'bitcoin_forecast': 0.17539844088632003}}, 현재 가격=84137000.0
2024-09-20 06:17:35 - INFO - 현재 잔고: KRW=41968.14271708, BTC=0.00516579, 총 자산가치=476602.21594708
2024-09-20 06:17:35 - INFO - 매도 시도: 0.000516579 BTC (약 43463.407323 KRW)
2024-09-20 06:17:35 - INFO - 주문 결과: {'uuid': '9f729606-501a-4fe9-b58f-660323aede22', 'side': 'ask', 'ord_type': 'limit', 'price': '84137000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T06:17:36+09:00', 'volume': '0.00051657', 'remaining_volume': '0.00051657', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00051657', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 06:17:35 - INFO - sell 주문 성공: UUID=9f729606-501a-4fe9-b58f-660323aede22
2024-09-20 06:17:35 - INFO - Trade executed successfully.
2024-09-20 06:17:35 - INFO - 7. summary 리포트 보내기
2024-09-20 06:17:35 - INFO - Message sent to Discord successfully.
2024-09-20 06:17:35 - INFO - Trading cycle completed.
2024-09-20 06:17:35 - INFO - Performing periodic update.
2024-09-20 06:17:35 - INFO - 계산된 시장 변동성: 0.02695208499170386
2024-09-20 06:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:25:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8129-a36d-d816918b4041 "HTTP/1.1 200 OK"
2024-09-20 06:25:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:25:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:25:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8107-a9b5-c0b00f794801 "HTTP/1.1 200 OK"
2024-09-20 06:25:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:25:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:25:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b4-aaba-edaaa59cc944 "HTTP/1.1 200 OK"
2024-09-20 06:25:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811f-9253-f2ead4af0988 "HTTP/1.1 200 OK"
2024-09-20 06:26:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8133-92a1-e11779c93106 "HTTP/1.1 200 OK"
2024-09-20 06:26:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d9-8a4d-c9f0871af80e "HTTP/1.1 200 OK"
2024-09-20 06:26:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-ab29-dd3870c7298d "HTTP/1.1 200 OK"
2024-09-20 06:26:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f1-925c-c9b843fed054 "HTTP/1.1 200 OK"
2024-09-20 06:26:27 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:26:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b7-86fe-e1f017f55d3e "HTTP/1.1 200 OK"
2024-09-20 06:26:36 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:15:34.963034
2024-09-20 06:26:36 - INFO - Starting trading cycle.
2024-09-20 06:26:36 - INFO - ##################################################
2024-09-20 06:26:36 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-20 06:26:36 - INFO - ##################################################
2024-09-20 06:26:36 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:26:36 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:26:36 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:10:00
2024-09-20 06:26:36 - INFO - 새로운 데이터 범위: 2024-09-18 21:10:00 ~ 2024-09-20 06:20:00
2024-09-20 06:26:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:26:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:26:36 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:26:36 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:26:36 - INFO - Sample date values: [Timestamp('2024-09-20 06:20:00')]
2024-09-20 06:26:36 - INFO - Successfully added 1 new data points
2024-09-20 06:26:36 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:26:36 - INFO - Final date range: 2024-09-20 06:20:00 to 2024-09-20 06:20:00
2024-09-20 06:26:36 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:26:36 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:20:00
2024-09-20 06:26:36 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:26:36 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:26:36 - INFO - GPT | 이전예측가격: 84137000 | 당시BTC가격: 84137000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:26:36 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-20 06:26:36 - INFO - ML | 이전예측가격: 84123172 | 당시BTC가격: 84137000 | 예측: 하락 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-20 06:26:36 - INFO - XGBOOST | 이전예측가격: 84140000 | 당시BTC가격: 84137000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:26:36 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 06:26:36 - INFO - LSTM | 이전예측가격: 84366802 | 당시BTC가격: 84137000 | 예측: 상승 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1250 | 반영가중치값: -0.0200 | 새 가중치: 0.1050 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 06:26:36 - INFO - RL 모델 예측 업데이트: 정확도 56.10%, 적중/전체: 46/82
2024-09-20 06:26:36 - INFO - RL | 이전예측가격: 84978370 | 당시BTC가격: 84137000 | 예측: 상승 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3391 | 반영가중치값: -0.0200 | 새 가중치: 0.3191 | 예측 총 횟수: 82 | 예측 성공 수: 46 | 예측 성공률: 56.10%
2024-09-20 06:26:36 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84137000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:26:36 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.67%, 적중/전체: 47/75
2024-09-20 06:26:36 - INFO - PROPHET | 이전예측가격: 84063419 | 당시BTC가격: 84137000 | 예측: 하락 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2265 | 반영가중치값: 0.0200 | 새 가중치: 0.2465 | 예측 총 횟수: 75 | 예측 성공 수: 47 | 예측 성공률: 62.67%
2024-09-20 06:26:36 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 48.78%, 적중/전체: 20/41
2024-09-20 06:26:36 - INFO - TRANSFORMER | 이전예측가격: 84439689 | 당시BTC가격: 84137000 | 예측: 상승 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0282 | 반영가중치값: -0.0200 | 새 가중치: 0.0082 | 예측 총 횟수: 41 | 예측 성공 수: 20 | 예측 성공률: 48.78%
2024-09-20 06:26:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 72.73%, 적중/전체: 16/22
2024-09-20 06:26:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83218856 | 당시BTC가격: 84137000 | 예측: 하락 | 지금 BTC가격: 83926000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1631 | 반영가중치값: 0.0200 | 새 가중치: 0.1831 | 예측 총 횟수: 22 | 예측 성공 수: 16 | 예측 성공률: 72.73%
2024-09-20 06:26:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:26:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:26:36 - INFO - 새로운 가중치: {'gpt': 0.004880817912433437, 'ml': 0.13517625519149487, 'xgboost': 0.038956862816440965, 'rl': 0.29746986079019305, 'lstm': 0.09788625375935836, 'arima': 0.017558023585551714, 'prophet': 0.22976849253567824, 'transformer': 0.007631976013794681, 'bitcoin_forecast': 0.1706714573950547}
2024-09-20 06:26:36 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:26:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:26:36 - INFO - Current BTC price: 83926000.0
2024-09-20 06:26:36 - INFO - Analyzing market conditions.
2024-09-20 06:26:36 - INFO - Market analysis: {'current_price': 83926000.0, 'sma_20': 84513200.0, 'rsi_14': 34.11863065767436, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:26:36 - INFO - Starting predictions for all models
2024-09-20 06:26:36 - INFO - Attempting prediction for gpt
2024-09-20 06:26:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:26:37 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:26:37 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:26:37 - INFO - GPT prediction: 83926000.0
2024-09-20 06:26:37 - INFO - Attempting prediction for ml
2024-09-20 06:26:37 - INFO - ML prediction: 83993140.8
2024-09-20 06:26:37 - INFO - Attempting prediction for xgboost
2024-09-20 06:26:37 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:26:37 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:26:37 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:26:37 - INFO - XGBOOST prediction: 83926000.0
2024-09-20 06:26:37 - INFO - Attempting prediction for lstm
2024-09-20 06:26:37 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:26:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:26:37 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:26:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:26:37 - INFO - X 샘플:
[[ 2.01698309  2.10566553  1.54528597  1.39795555 -0.37544602 -0.36845038
   1.39795555]
 [ 0.85165221  1.07616491  1.12469901  1.25503696  1.43521163  1.44909974
   1.25503696]
 [ 0.45067814  0.36417382  0.75854095  0.73629541 -0.92378698 -0.92315004
   0.73629541]
 [ 0.12906353  0.17655455  0.62989082  0.83686775 -1.04358187 -1.04382842
   0.83686775]
 [ 0.51333034  0.37379532  0.16477113 -0.03123036 -0.52126756 -0.52038344
  -0.03123036]
 [-0.01712493 -0.23717     0.01632867 -0.07357661 -0.68599555 -0.68748855
  -0.07357661]
 [-0.40556856 -0.67494831 -0.28055624 -0.56055847 -0.58416538 -0.58639149
  -0.56055847]
 [-1.05297461 -1.36769639 -1.15636673 -1.34925736  1.58514692  1.57797243
  -1.34925736]
 [-1.66696615 -0.71824506 -1.44830356 -0.53938535  1.46252039  1.45612871
  -0.53938535]
 [-0.81907307 -1.09829436 -1.35429001 -1.67214751 -0.34863557 -0.35350855
  -1.67214751]]
2024-09-20 06:26:37 - INFO - y 샘플:
[-1.67214751]
2024-09-20 06:26:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:26:37 - INFO - 모델 출력 (스케일링된 예측): [[0.14144318]]
2024-09-20 06:26:37 - INFO - 스케일러 역변환 후 예측 가격: 84268621.26685926
2024-09-20 06:26:37 - INFO - LSTMPredictor 최종 예측 가격: 84268621.26685926
2024-09-20 06:26:37 - INFO - LSTM prediction: 84268621.26685926
2024-09-20 06:26:37 - INFO - Attempting prediction for rl
2024-09-20 06:26:37 - INFO - Preparing state for RL agent.
2024-09-20 06:26:37 - INFO - Prepared state: [[ 8.39260000e+07  8.51644731e+00 -2.54338008e-03  8.45132000e+07
   3.41186307e+01]]
2024-09-20 06:26:37 - INFO - RL prediction: 84765260.0
2024-09-20 06:26:37 - INFO - Attempting prediction for arima
2024-09-20 06:26:37 - INFO - ARIMA 예측 시작
2024-09-20 06:26:37 - INFO - 입력 데이터: {'open': 84122000.0, 'high': 84135000.0, 'low': 83919000.0, 'close': 83926000.0, 'volume': 8.51644731, 'value': 715750245.43609, 'decision': 'sell', 'sma': 84513200.0, 'ema': 84387858.85975346, 'rsi': 34.11863065767436, 'macd': -149088.83744058013, 'signal_line': -64457.399251264644, 'BB_Upper': 85138615.25405255, 'BB_Lower': 83887784.74594745}
2024-09-20 06:26:37 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:26:37 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84513200.0         0         0
2024-09-20 06:26:37 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84513200.0         0         0
2024-09-20 06:26:37 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 06:26:37 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 06:26:37 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 06:26:37 - INFO - ARIMA prediction: 84140000.0
2024-09-20 06:26:37 - INFO - Attempting prediction for prophet
2024-09-20 06:26:37 - INFO - PROPHET prediction: 83818489.31405655
2024-09-20 06:26:37 - INFO - Attempting prediction for transformer
2024-09-20 06:26:37 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:26:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:26:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:26:37 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:26:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:26:37 - INFO - X 샘플:
[[ 2.01698309  2.10566553  1.54528597  1.39795555 -0.37544602 -0.36845038
   1.39795555  1.39795555  0.          0.          0.          1.39795555
   1.39795555]
 [ 0.85165221  1.07616491  1.12469901  1.25503696  1.43521163  1.44909974
   1.25503696  1.25503696  0.          0.          0.          1.25503696
   1.25503696]
 [ 0.45067814  0.36417382  0.75854095  0.73629541 -0.92378698 -0.92315004
   0.73629541  0.73629541  0.          0.          0.          0.73629541
   0.73629541]
 [ 0.12906353  0.17655455  0.62989082  0.83686775 -1.04358187 -1.04382842
   0.83686775  0.83686775  0.          0.          0.          0.83686775
   0.83686775]
 [ 0.51333034  0.37379532  0.16477113 -0.03123036 -0.52126756 -0.52038344
  -0.03123036 -0.03123036  0.          0.          0.         -0.03123036
  -0.03123036]
 [-0.01712493 -0.23717     0.01632867 -0.07357661 -0.68599555 -0.68748855
  -0.07357661 -0.07357661  0.          0.          0.         -0.07357661
  -0.07357661]
 [-0.40556856 -0.67494831 -0.28055624 -0.56055847 -0.58416538 -0.58639149
  -0.56055847 -0.56055847  0.          0.          0.         -0.56055847
  -0.56055847]
 [-1.05297461 -1.36769639 -1.15636673 -1.34925736  1.58514692  1.57797243
  -1.34925736 -1.34925736  0.          0.          0.         -1.34925736
  -1.34925736]
 [-1.66696615 -0.71824506 -1.44830356 -0.53938535  1.46252039  1.45612871
  -0.53938535 -0.53938535  0.          0.          0.         -0.53938535
  -0.53938535]
 [-0.81907307 -1.09829436 -1.35429001 -1.67214751 -0.34863557 -0.35350855
  -1.67214751 -1.67214751  0.          0.          0.         -1.67214751
  -1.67214751]]
2024-09-20 06:26:37 - INFO - y 샘플:
[-1.67214751]
2024-09-20 06:26:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:26:37 - INFO - 모델 출력 (스케일링된 예측): [0.46054116]
2024-09-20 06:26:37 - INFO - 스케일러 역변환 후 예측 가격: 84328904.85506634
2024-09-20 06:26:37 - INFO - TransformerPredictor 최종 예측 가격: 84328904.85506634
2024-09-20 06:26:37 - INFO - TRANSFORMER prediction: 84328904.85506634
2024-09-20 06:26:37 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:26:37 - INFO - BITCOIN_FORECAST prediction: 83078889.08551675
2024-09-20 06:26:37 - INFO - BitcoinForecast prediction: 83078889.08551675
2024-09-20 06:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:26:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:26:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004880817912433437, 'ml': 0.13517625519149487, 'xgboost': 0.038956862816440965, 'rl': 0.29746986079019305, 'lstm': 0.09788625375935836, 'arima': 0.017558023585551714, 'prophet': 0.22976849253567824, 'transformer': 0.007631976013794681, 'bitcoin_forecast': 0.1706714573950547}
2024-09-20 06:26:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004880817912433437, 'ml': 0.13517625519149487, 'xgboost': 0.038956862816440965, 'rl': 0.29746986079019305, 'lstm': 0.09788625375935836, 'arima': 0.017558023585551714, 'prophet': 0.22976849253567824, 'transformer': 0.007631976013794681, 'bitcoin_forecast': 0.1706714573950547}
2024-09-20 06:26:50 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84055820.46419868, 'current_price': 83926000.0, 'predictions': {'gpt': 83926000.0, 'ml': 83993140.8, 'xgboost': 83926000.0, 'lstm': 84268621.26685926, 'rl': 84765260.0, 'arima': 84140000.0, 'prophet': 83818489.31405655, 'transformer': 84328904.85506634, 'bitcoin_forecast': 83078889.08551675}, 'weights': {'gpt': 0.004880817912433437, 'ml': 0.13517625519149487, 'xgboost': 0.038956862816440965, 'rl': 0.29746986079019305, 'lstm': 0.09788625375935836, 'arima': 0.017558023585551714, 'prophet': 0.22976849253567824, 'transformer': 0.007631976013794681, 'bitcoin_forecast': 0.1706714573950547}}
2024-09-20 06:26:50 - INFO - 모델별 가중치:
2024-09-20 06:26:50 - INFO -   - GPT: 0.0049
2024-09-20 06:26:50 - INFO -   - ML: 0.1352
2024-09-20 06:26:50 - INFO -   - XGBOOST: 0.0390
2024-09-20 06:26:50 - INFO -   - RL: 0.2975
2024-09-20 06:26:50 - INFO -   - LSTM: 0.0979
2024-09-20 06:26:50 - INFO -   - ARIMA: 0.0176
2024-09-20 06:26:50 - INFO -   - PROPHET: 0.2298
2024-09-20 06:26:50 - INFO -   - TRANSFORMER: 0.0076
2024-09-20 06:26:50 - INFO -   - BITCOIN_FORECAST: 0.1707
2024-09-20 06:26:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:26:50 - INFO - 6. 거래 실행
2024-09-20 06:26:50 - INFO - Cancelling existing orders.
2024-09-20 06:26:50 - INFO - Cancelled 0 orders.
2024-09-20 06:26:50 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84055820.46419868, 'current_price': 83926000.0, 'predictions': {'gpt': 83926000.0, 'ml': 83993140.8, 'xgboost': 83926000.0, 'lstm': 84268621.26685926, 'rl': 84765260.0, 'arima': 84140000.0, 'prophet': 83818489.31405655, 'transformer': 84328904.85506634, 'bitcoin_forecast': 83078889.08551675}, 'weights': {'gpt': 0.004880817912433437, 'ml': 0.13517625519149487, 'xgboost': 0.038956862816440965, 'rl': 0.29746986079019305, 'lstm': 0.09788625375935836, 'arima': 0.017558023585551714, 'prophet': 0.22976849253567824, 'transformer': 0.007631976013794681, 'bitcoin_forecast': 0.1706714573950547}}, 현재 가격=83926000.0
2024-09-20 06:26:50 - INFO - 현재 잔고: KRW=85409.06148203, BTC=0.00464922, 총 자산가치=475599.49920203
2024-09-20 06:26:50 - INFO - 매수 시도: 0.0005666891061197126 BTC (약 47559.949920203 KRW)
2024-09-20 06:26:50 - INFO - 주문 결과: {'uuid': 'c5fb2788-c8dd-42fc-ad0d-c1fc5eea640e', 'side': 'bid', 'ord_type': 'limit', 'price': '83926000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T06:26:51+09:00', 'volume': '0.00056668', 'remaining_volume': '0.00056668', 'reserved_fee': '23.77959284', 'remaining_fee': '23.77959284', 'paid_fee': '0', 'locked': '47582.96527284', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 06:26:50 - INFO - buy 주문 성공: UUID=c5fb2788-c8dd-42fc-ad0d-c1fc5eea640e
2024-09-20 06:26:50 - INFO - Trade executed successfully.
2024-09-20 06:26:50 - INFO - 7. summary 리포트 보내기
2024-09-20 06:26:50 - INFO - Message sent to Discord successfully.
2024-09-20 06:26:50 - INFO - Trading cycle completed.
2024-09-20 06:26:50 - INFO - Performing periodic update.
2024-09-20 06:26:50 - INFO - 계산된 시장 변동성: 0.0272821300214911
2024-09-20 06:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-b75a-f4cdd088a6dc "HTTP/1.1 200 OK"
2024-09-20 06:35:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:35:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:35:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fa-ad4c-c55fadbf6225 "HTTP/1.1 200 OK"
2024-09-20 06:35:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-817c-b60e-f3a8d60b9477 "HTTP/1.1 200 OK"
2024-09-20 06:36:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813e-a267-d6ccd4947be1 "HTTP/1.1 200 OK"
2024-09-20 06:36:12 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8195-b52c-d36202c62c71 "HTTP/1.1 200 OK"
2024-09-20 06:36:16 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c7-9045-fcb4dda7e16c "HTTP/1.1 200 OK"
2024-09-20 06:36:24 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b7-8100-d27ee2d3e558 "HTTP/1.1 200 OK"
2024-09-20 06:36:28 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8171-98f2-e22b5671388f "HTTP/1.1 200 OK"
2024-09-20 06:36:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:36:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8623fc11-fa6e-492d-b408-a79c1eaeae64 "HTTP/1.1 200 OK"
2024-09-20 06:36:48 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:25:34.963536
2024-09-20 06:36:48 - INFO - Starting trading cycle.
2024-09-20 06:36:48 - INFO - ##################################################
2024-09-20 06:36:48 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-20 06:36:48 - INFO - ##################################################
2024-09-20 06:36:48 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:36:48 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:36:48 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:20:00
2024-09-20 06:36:48 - INFO - 새로운 데이터 범위: 2024-09-18 21:20:00 ~ 2024-09-20 06:30:00
2024-09-20 06:36:48 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:36:48 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:36:48 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:36:48 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:36:48 - INFO - Sample date values: [Timestamp('2024-09-20 06:30:00')]
2024-09-20 06:36:48 - INFO - Successfully added 1 new data points
2024-09-20 06:36:48 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:36:48 - INFO - Final date range: 2024-09-20 06:30:00 to 2024-09-20 06:30:00
2024-09-20 06:36:48 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:36:48 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:30:00
2024-09-20 06:36:48 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:36:48 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:36:48 - INFO - GPT | 이전예측가격: 83926000 | 당시BTC가격: 83926000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:36:48 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-20 06:36:48 - INFO - ML | 이전예측가격: 83993141 | 당시BTC가격: 83926000 | 예측: 상승 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1293 | 반영가중치값: -0.0200 | 새 가중치: 0.1093 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-20 06:36:48 - INFO - XGBOOST | 이전예측가격: 83926000 | 당시BTC가격: 83926000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:36:48 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-20 06:36:48 - INFO - LSTM | 이전예측가격: 84268621 | 당시BTC가격: 83926000 | 예측: 상승 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1087 | 반영가중치값: -0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-20 06:36:48 - INFO - RL 모델 예측 업데이트: 정확도 55.42%, 적중/전체: 46/83
2024-09-20 06:36:48 - INFO - RL | 이전예측가격: 84765260 | 당시BTC가격: 83926000 | 예측: 상승 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1072 | 반영가중치값: -0.0200 | 새 가중치: 0.0872 | 예측 총 횟수: 83 | 예측 성공 수: 46 | 예측 성공률: 55.42%
2024-09-20 06:36:48 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 06:36:48 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83926000 | 예측: 상승 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0188 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 06:36:48 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 48/76
2024-09-20 06:36:48 - INFO - PROPHET | 이전예측가격: 83818489 | 당시BTC가격: 83926000 | 예측: 하락 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2720 | 반영가중치값: 0.0200 | 새 가중치: 0.2920 | 예측 총 횟수: 76 | 예측 성공 수: 48 | 예측 성공률: 63.16%
2024-09-20 06:36:48 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 47.62%, 적중/전체: 20/42
2024-09-20 06:36:48 - INFO - TRANSFORMER | 이전예측가격: 84328905 | 당시BTC가격: 83926000 | 예측: 상승 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1417 | 반영가중치값: -0.0200 | 새 가중치: 0.1217 | 예측 총 횟수: 42 | 예측 성공 수: 20 | 예측 성공률: 47.62%
2024-09-20 06:36:48 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 73.91%, 적중/전체: 17/23
2024-09-20 06:36:48 - INFO - BITCOIN_FORECAST | 이전예측가격: 83078889 | 당시BTC가격: 83926000 | 예측: 하락 | 지금 BTC가격: 83900000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1754 | 반영가중치값: 0.0200 | 새 가중치: 0.1954 | 예측 총 횟수: 23 | 예측 성공 수: 17 | 예측 성공률: 73.91%
2024-09-20 06:36:48 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:36:48 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:36:48 - INFO - 새로운 가중치: {'gpt': 0.005203540840518, 'ml': 0.11651310533860657, 'xgboost': 0.041532716507906034, 'rl': 0.09291933002946864, 'lstm': 0.09452474888696609, 'arima': 0.0, 'prophet': 0.3112849976527042, 'transformer': 0.12970324492725474, 'bitcoin_forecast': 0.20831831581657573}
2024-09-20 06:36:48 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:36:48 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:36:48 - INFO - Current BTC price: 83900000.0
2024-09-20 06:36:48 - INFO - Analyzing market conditions.
2024-09-20 06:36:48 - INFO - Market analysis: {'current_price': 83900000.0, 'sma_20': 84470200.0, 'rsi_14': 33.562142443403225, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:36:48 - INFO - Starting predictions for all models
2024-09-20 06:36:48 - INFO - Attempting prediction for gpt
2024-09-20 06:36:49 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:36:49 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:36:49 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:36:49 - INFO - GPT prediction: 83900000.0
2024-09-20 06:36:49 - INFO - Attempting prediction for ml
2024-09-20 06:36:49 - INFO - ML prediction: 83799320.0
2024-09-20 06:36:49 - INFO - Attempting prediction for xgboost
2024-09-20 06:36:49 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:36:49 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:36:49 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:36:49 - INFO - XGBOOST prediction: 83900000.0
2024-09-20 06:36:49 - INFO - Attempting prediction for lstm
2024-09-20 06:36:49 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:36:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:36:49 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:36:49 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:36:49 - INFO - X 샘플:
[[ 1.38174708  1.81890649  1.48035119  1.55329141  0.5858789   0.59727003
   1.55329141]
 [ 0.9379608   0.90295494  1.10863084  1.0419627  -0.85483591 -0.8549507
   1.0419627 ]
 [ 0.58200722  0.66158933  0.97802639  1.14109786 -0.92799843 -0.92882641
   1.14109786]
 [ 1.00730241  0.91533266  0.50584108  0.2854049  -0.60900461 -0.60838897
   0.2854049 ]
 [ 0.42021014  0.12934721  0.35514363  0.24366379 -0.70960919 -0.71068574
   0.24366379]
 [-0.00970782 -0.43383921  0.05374875 -0.23635909 -0.64741829 -0.64879713
  -0.23635909]
 [-0.72623776 -1.32503531 -0.83536615 -1.01378744  0.67744911  0.67616205
  -1.01378744]
 [-1.4057855  -0.48953897 -1.13173778 -0.21548853  0.60255722  0.60157295
  -0.21548853]
 [-0.46736243 -0.97845905 -1.03629607 -1.33206348 -0.50357282 -0.50623313
  -1.33206348]
 [-1.72013412 -1.20125808 -1.47834189 -1.46772212  2.38655401  2.38287706
  -1.46772212]]
2024-09-20 06:36:49 - INFO - y 샘플:
[-1.46772212]
2024-09-20 06:36:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:36:49 - INFO - 모델 출력 (스케일링된 예측): [[0.14512558]]
2024-09-20 06:36:49 - INFO - 스케일러 역변환 후 예측 가격: 84209114.41119415
2024-09-20 06:36:49 - INFO - LSTMPredictor 최종 예측 가격: 84209114.41119415
2024-09-20 06:36:49 - INFO - LSTM prediction: 84209114.41119415
2024-09-20 06:36:49 - INFO - Attempting prediction for rl
2024-09-20 06:36:49 - INFO - Preparing state for RL agent.
2024-09-20 06:36:49 - INFO - Prepared state: [[ 8.39000000e+07  3.01526534e+01 -3.09796726e-04  8.44702000e+07
   3.35621424e+01]]
2024-09-20 06:36:49 - INFO - RL prediction: 84739000.0
2024-09-20 06:36:49 - INFO - Attempting prediction for arima
2024-09-20 06:36:49 - INFO - ARIMA 예측 시작
2024-09-20 06:36:49 - INFO - 입력 데이터: {'open': 83851000.0, 'high': 84099000.0, 'low': 83831000.0, 'close': 83900000.0, 'volume': 30.15265341, 'value': 2530090772.94472, 'decision': 'sell', 'sma': 84470200.0, 'ema': 84341396.11120552, 'rsi': 33.562142443403225, 'macd': -167764.38748328388, 'signal_line': -85118.79689766851, 'BB_Upper': 85138607.83957224, 'BB_Lower': 83801792.16042776}
2024-09-20 06:36:49 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:36:49 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84470200.0         0         0
2024-09-20 06:36:49 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84470200.0         0         0
2024-09-20 06:36:49 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 06:36:49 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 06:36:49 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 06:36:49 - INFO - ARIMA prediction: 84140000.0
2024-09-20 06:36:49 - INFO - Attempting prediction for prophet
2024-09-20 06:36:49 - INFO - PROPHET prediction: 83802122.76175532
2024-09-20 06:36:49 - INFO - Attempting prediction for transformer
2024-09-20 06:36:49 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:36:49 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:36:49 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:36:49 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:36:49 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:36:49 - INFO - X 샘플:
[[ 1.38174708  1.81890649  1.48035119  1.55329141  0.5858789   0.59727003
   1.55329141  1.55329141  0.          0.          0.          1.55329141
   1.55329141]
 [ 0.9379608   0.90295494  1.10863084  1.0419627  -0.85483591 -0.8549507
   1.0419627   1.0419627   0.          0.          0.          1.0419627
   1.0419627 ]
 [ 0.58200722  0.66158933  0.97802639  1.14109786 -0.92799843 -0.92882641
   1.14109786  1.14109786  0.          0.          0.          1.14109786
   1.14109786]
 [ 1.00730241  0.91533266  0.50584108  0.2854049  -0.60900461 -0.60838897
   0.2854049   0.2854049   0.          0.          0.          0.2854049
   0.2854049 ]
 [ 0.42021014  0.12934721  0.35514363  0.24366379 -0.70960919 -0.71068574
   0.24366379  0.24366379  0.          0.          0.          0.24366379
   0.24366379]
 [-0.00970782 -0.43383921  0.05374875 -0.23635909 -0.64741829 -0.64879713
  -0.23635909 -0.23635909  0.          0.          0.         -0.23635909
  -0.23635909]
 [-0.72623776 -1.32503531 -0.83536615 -1.01378744  0.67744911  0.67616205
  -1.01378744 -1.01378744  0.          0.          0.         -1.01378744
  -1.01378744]
 [-1.4057855  -0.48953897 -1.13173778 -0.21548853  0.60255722  0.60157295
  -0.21548853 -0.21548853  0.          0.          0.         -0.21548853
  -0.21548853]
 [-0.46736243 -0.97845905 -1.03629607 -1.33206348 -0.50357282 -0.50623313
  -1.33206348 -1.33206348  0.          0.          0.         -1.33206348
  -1.33206348]
 [-1.72013412 -1.20125808 -1.47834189 -1.46772212  2.38655401  2.38287706
  -1.46772212 -1.46772212  0.          0.          0.         -1.46772212
  -1.46772212]]
2024-09-20 06:36:49 - INFO - y 샘플:
[-1.46772212]
2024-09-20 06:36:49 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:36:49 - INFO - 모델 출력 (스케일링된 예측): [0.46235076]
2024-09-20 06:36:49 - INFO - 스케일러 역변환 후 예측 가격: 84269913.00531572
2024-09-20 06:36:49 - INFO - TransformerPredictor 최종 예측 가격: 84269913.00531572
2024-09-20 06:36:49 - INFO - TRANSFORMER prediction: 84269913.00531572
2024-09-20 06:36:49 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:36:49 - INFO - BITCOIN_FORECAST prediction: 83365726.15717545
2024-09-20 06:36:49 - INFO - BitcoinForecast prediction: 83365726.15717545
2024-09-20 06:36:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:36:56 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:36:56 - INFO - 조정된 모델 가중치: {'gpt': 0.005203540840518, 'ml': 0.11651310533860657, 'xgboost': 0.041532716507906034, 'rl': 0.09291933002946864, 'lstm': 0.09452474888696609, 'arima': 0.0, 'prophet': 0.3112849976527042, 'transformer': 0.12970324492725474, 'bitcoin_forecast': 0.20831831581657573}
2024-09-20 06:36:56 - INFO - 조정된 모델 가중치: {'gpt': 0.005203540840518, 'ml': 0.11651310533860657, 'xgboost': 0.041532716507906034, 'rl': 0.09291933002946864, 'lstm': 0.09452474888696609, 'arima': 0.0, 'prophet': 0.3112849976527042, 'transformer': 0.12970324492725474, 'bitcoin_forecast': 0.20831831581657573}
2024-09-20 06:36:56 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83901659.91467564, 'current_price': 83900000.0, 'predictions': {'gpt': 83900000.0, 'ml': 83799320.0, 'xgboost': 83900000.0, 'lstm': 84209114.41119415, 'rl': 84739000.0, 'arima': 84140000.0, 'prophet': 83802122.76175532, 'transformer': 84269913.00531572, 'bitcoin_forecast': 83365726.15717545}, 'weights': {'gpt': 0.005203540840518, 'ml': 0.11651310533860657, 'xgboost': 0.041532716507906034, 'rl': 0.09291933002946864, 'lstm': 0.09452474888696609, 'arima': 0.0, 'prophet': 0.3112849976527042, 'transformer': 0.12970324492725474, 'bitcoin_forecast': 0.20831831581657573}}
2024-09-20 06:36:56 - INFO - 모델별 가중치:
2024-09-20 06:36:56 - INFO -   - GPT: 0.0052
2024-09-20 06:36:56 - INFO -   - ML: 0.1165
2024-09-20 06:36:56 - INFO -   - XGBOOST: 0.0415
2024-09-20 06:36:56 - INFO -   - RL: 0.0929
2024-09-20 06:36:56 - INFO -   - LSTM: 0.0945
2024-09-20 06:36:56 - INFO -   - ARIMA: 0.0000
2024-09-20 06:36:56 - INFO -   - PROPHET: 0.3113
2024-09-20 06:36:56 - INFO -   - TRANSFORMER: 0.1297
2024-09-20 06:36:56 - INFO -   - BITCOIN_FORECAST: 0.2083
2024-09-20 06:36:56 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:36:56 - INFO - 6. 거래 실행
2024-09-20 06:36:56 - INFO - Cancelling existing orders.
2024-09-20 06:36:56 - INFO - Cancelled 0 orders.
2024-09-20 06:36:56 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83901659.91467564, 'current_price': 83900000.0, 'predictions': {'gpt': 83900000.0, 'ml': 83799320.0, 'xgboost': 83900000.0, 'lstm': 84209114.41119415, 'rl': 84739000.0, 'arima': 84140000.0, 'prophet': 83802122.76175532, 'transformer': 84269913.00531572, 'bitcoin_forecast': 83365726.15717545}, 'weights': {'gpt': 0.005203540840518, 'ml': 0.11651310533860657, 'xgboost': 0.041532716507906034, 'rl': 0.09291933002946864, 'lstm': 0.09452474888696609, 'arima': 0.0, 'prophet': 0.3112849976527042, 'transformer': 0.12970324492725474, 'bitcoin_forecast': 0.20831831581657573}}, 현재 가격=83900000.0
2024-09-20 06:36:56 - INFO - 현재 잔고: KRW=37827.79709921, BTC=0.0052159, 총 자산가치=475441.80709921
2024-09-20 06:36:56 - INFO - 매수 시도: 0.00045086766506805724 BTC (약 37827.79709921 KRW)
2024-09-20 06:36:56 - INFO - 주문 결과: None
2024-09-20 06:36:56 - ERROR - 주문 실패
2024-09-20 06:36:56 - WARNING - Trade execution failed: Failed to place order
2024-09-20 06:36:56 - INFO - 7. summary 리포트 보내기
2024-09-20 06:36:56 - INFO - Message sent to Discord successfully.
2024-09-20 06:36:56 - INFO - Trading cycle completed.
2024-09-20 06:36:56 - INFO - Performing periodic update.
2024-09-20 06:36:56 - INFO - 계산된 시장 변동성: 0.027230126721556617
2024-09-20 06:45:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:45:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c6-8245-d290713233d7 "HTTP/1.1 200 OK"
2024-09-20 06:45:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:45:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:45:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f5-ab20-f418e8c0d666 "HTTP/1.1 200 OK"
2024-09-20 06:45:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:45:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-9cf9-c029891424f4 "HTTP/1.1 200 OK"
2024-09-20 06:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81af-997d-e5f8dfb9c8ae "HTTP/1.1 200 OK"
2024-09-20 06:46:07 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b9-9fc6-edf882dbfb0c "HTTP/1.1 200 OK"
2024-09-20 06:46:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b2-86de-fe989348b28a "HTTP/1.1 200 OK"
2024-09-20 06:46:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/9e81ff94-a4cc-4f8d-9690-c333ca16020d "HTTP/1.1 200 OK"
2024-09-20 06:46:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816e-89c1-de250dc08cb7 "HTTP/1.1 200 OK"
2024-09-20 06:46:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:46:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814d-9a93-f1e598923714 "HTTP/1.1 200 OK"
2024-09-20 06:46:37 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:35:34.963894
2024-09-20 06:46:37 - INFO - Starting trading cycle.
2024-09-20 06:46:37 - INFO - ##################################################
2024-09-20 06:46:37 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-20 06:46:37 - INFO - ##################################################
2024-09-20 06:46:37 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:46:37 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:46:37 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:30:00
2024-09-20 06:46:38 - INFO - 새로운 데이터 범위: 2024-09-18 21:30:00 ~ 2024-09-20 06:40:00
2024-09-20 06:46:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:46:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:46:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:46:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:46:38 - INFO - Sample date values: [Timestamp('2024-09-20 06:40:00')]
2024-09-20 06:46:38 - INFO - Successfully added 1 new data points
2024-09-20 06:46:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:46:38 - INFO - Final date range: 2024-09-20 06:40:00 to 2024-09-20 06:40:00
2024-09-20 06:46:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:46:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:40:00
2024-09-20 06:46:38 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:46:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:46:38 - INFO - GPT | 이전예측가격: 83900000 | 당시BTC가격: 83900000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:46:38 - INFO - ML 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-20 06:46:38 - INFO - ML | 이전예측가격: 83799320 | 당시BTC가격: 83900000 | 예측: 하락 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1352 | 반영가중치값: 0.0200 | 새 가중치: 0.1552 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-20 06:46:38 - INFO - XGBOOST | 이전예측가격: 83900000 | 당시BTC가격: 83900000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:46:38 - INFO - LSTM 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 1/4
2024-09-20 06:46:38 - INFO - LSTM | 이전예측가격: 84209114 | 당시BTC가격: 83900000 | 예측: 상승 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0979 | 반영가중치값: -0.0200 | 새 가중치: 0.0779 | 예측 총 횟수: 4 | 예측 성공 수: 1 | 예측 성공률: 25.00%
2024-09-20 06:46:38 - INFO - RL 모델 예측 업데이트: 정확도 54.76%, 적중/전체: 46/84
2024-09-20 06:46:38 - INFO - RL | 이전예측가격: 84739000 | 당시BTC가격: 83900000 | 예측: 상승 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2975 | 반영가중치값: -0.0200 | 새 가중치: 0.2775 | 예측 총 횟수: 84 | 예측 성공 수: 46 | 예측 성공률: 54.76%
2024-09-20 06:46:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-20 06:46:38 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83900000 | 예측: 상승 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0176 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-20 06:46:38 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 49/77
2024-09-20 06:46:38 - INFO - PROPHET | 이전예측가격: 83802123 | 당시BTC가격: 83900000 | 예측: 하락 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2298 | 반영가중치값: 0.0200 | 새 가중치: 0.2498 | 예측 총 횟수: 77 | 예측 성공 수: 49 | 예측 성공률: 63.64%
2024-09-20 06:46:38 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 46.51%, 적중/전체: 20/43
2024-09-20 06:46:38 - INFO - TRANSFORMER | 이전예측가격: 84269913 | 당시BTC가격: 83900000 | 예측: 상승 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0076 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 43 | 예측 성공 수: 20 | 예측 성공률: 46.51%
2024-09-20 06:46:38 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 18/24
2024-09-20 06:46:38 - INFO - BITCOIN_FORECAST | 이전예측가격: 83365726 | 당시BTC가격: 83900000 | 예측: 하락 | 지금 BTC가격: 83893000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1707 | 반영가중치값: 0.0200 | 새 가중치: 0.1907 | 예측 총 횟수: 24 | 예측 성공 수: 18 | 예측 성공률: 75.00%
2024-09-20 06:46:38 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:46:38 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:46:38 - INFO - 새로운 가중치: {'gpt': 0.005215491738137709, 'ml': 0.15553264627126945, 'xgboost': 0.041628104102251304, 'rl': 0.2781071218400224, 'lstm': 0.07806513400132992, 'arima': 0.0, 'prophet': 0.250342132250328, 'transformer': 0.0, 'bitcoin_forecast': 0.19110936979666124}
2024-09-20 06:46:38 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:46:38 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:46:38 - INFO - Current BTC price: 83893000.0
2024-09-20 06:46:38 - INFO - Analyzing market conditions.
2024-09-20 06:46:38 - INFO - Market analysis: {'current_price': 83893000.0, 'sma_20': 84423050.0, 'rsi_14': 33.40417249674474, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:46:38 - INFO - Starting predictions for all models
2024-09-20 06:46:38 - INFO - Attempting prediction for gpt
2024-09-20 06:46:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:46:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:46:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:46:38 - INFO - GPT prediction: 83893000.0
2024-09-20 06:46:38 - INFO - Attempting prediction for ml
2024-09-20 06:46:38 - INFO - ML prediction: 83859442.8
2024-09-20 06:46:38 - INFO - Attempting prediction for xgboost
2024-09-20 06:46:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:46:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:46:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:46:38 - INFO - XGBOOST prediction: 83893000.0
2024-09-20 06:46:38 - INFO - Attempting prediction for lstm
2024-09-20 06:46:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:46:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:46:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:46:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:46:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:46:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:46:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:46:38 - INFO - X 샘플:
[[ 1.24865856e+00  1.27171324e+00  1.46772415e+00  1.42735919e+00
  -8.05026971e-01 -8.04068373e-01  1.42735919e+00]
 [ 8.90169713e-01  1.04135181e+00  1.33158134e+00  1.53235270e+00
  -8.79625882e-01 -8.79453068e-01  1.53235270e+00]
 [ 1.31849405e+00  1.28352665e+00  8.39372746e-01  6.26092900e-01
  -5.54369303e-01 -5.52470397e-01  6.26092900e-01]
 [ 7.27220236e-01  5.33375316e-01  6.82284896e-01  5.81885105e-01
  -6.56949032e-01 -6.56856675e-01  5.81885105e-01]
 [ 2.94240198e-01 -4.13469238e-03  3.68109196e-01  7.34954596e-02
  -5.93537154e-01 -5.93703933e-01  7.34954596e-02]
 [-4.27393199e-01 -8.54699981e-01 -5.58709121e-01 -7.49874727e-01
   7.57341201e-01  7.58318772e-01 -7.49874727e-01]
 [-1.11178100e+00 -5.72950229e-02 -8.67648559e-01  9.55993572e-02
   6.80978969e-01  6.82206124e-01  9.55993572e-02]
 [-1.66674036e-01 -5.23924591e-01 -7.68159588e-01 -1.08695917e+00
  -4.46867575e-01 -4.48227928e-01 -1.08695917e+00]
 [-1.42836856e+00 -7.36565913e-01 -1.22895061e+00 -1.23063450e+00
   2.50000074e+00  2.49989502e+00 -1.23063450e+00]
 [-1.34456597e+00 -1.95334681e+00 -1.26560445e+00 -1.26931632e+00
  -1.94499574e-03 -5.63954664e-03 -1.26931632e+00]]
2024-09-20 06:46:38 - INFO - y 샘플:
[-1.26931632]
2024-09-20 06:46:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:46:38 - INFO - 모델 출력 (스케일링된 예측): [[0.14334331]]
2024-09-20 06:46:38 - INFO - 스케일러 역변환 후 예측 가격: 84148639.9164803
2024-09-20 06:46:38 - INFO - LSTMPredictor 최종 예측 가격: 84148639.9164803
2024-09-20 06:46:38 - INFO - LSTM prediction: 84148639.9164803
2024-09-20 06:46:38 - INFO - Attempting prediction for rl
2024-09-20 06:46:38 - INFO - Preparing state for RL agent.
2024-09-20 06:46:38 - INFO - Prepared state: [[ 8.38930000e+07  1.17831140e+01 -8.34326579e-05  8.44230500e+07
   3.34041725e+01]]
2024-09-20 06:46:38 - INFO - RL prediction: 84731930.0
2024-09-20 06:46:38 - INFO - Attempting prediction for arima
2024-09-20 06:46:38 - INFO - ARIMA 예측 시작
2024-09-20 06:46:38 - INFO - 입력 데이터: {'open': 83869000.0, 'high': 83893000.0, 'low': 83824000.0, 'close': 83893000.0, 'volume': 11.78311402, 'value': 988128992.86662, 'decision': 'sell', 'sma': 84423050.0, 'ema': 84298691.71966213, 'rsi': 33.40417249674474, 'macd': -181042.78837162256, 'signal_line': -104303.59519245932, 'BB_Upper': 85114242.15128879, 'BB_Lower': 83731857.84871121}
2024-09-20 06:46:38 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:46:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84423050.0         0         0
2024-09-20 06:46:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84423050.0         0         0
2024-09-20 06:46:38 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 06:46:38 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 06:46:38 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 06:46:38 - INFO - ARIMA prediction: 84140000.0
2024-09-20 06:46:38 - INFO - Attempting prediction for prophet
2024-09-20 06:46:39 - INFO - PROPHET prediction: 83784499.62476091
2024-09-20 06:46:39 - INFO - Attempting prediction for transformer
2024-09-20 06:46:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:46:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:46:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:46:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:46:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:46:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:46:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:46:39 - INFO - X 샘플:
[[ 1.24865856e+00  1.27171324e+00  1.46772415e+00  1.42735919e+00
  -8.05026971e-01 -8.04068373e-01  1.42735919e+00  1.42735919e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.42735919e+00
   1.42735919e+00]
 [ 8.90169713e-01  1.04135181e+00  1.33158134e+00  1.53235270e+00
  -8.79625882e-01 -8.79453068e-01  1.53235270e+00  1.53235270e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.53235270e+00
   1.53235270e+00]
 [ 1.31849405e+00  1.28352665e+00  8.39372746e-01  6.26092900e-01
  -5.54369303e-01 -5.52470397e-01  6.26092900e-01  6.26092900e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  6.26092900e-01
   6.26092900e-01]
 [ 7.27220236e-01  5.33375316e-01  6.82284896e-01  5.81885105e-01
  -6.56949032e-01 -6.56856675e-01  5.81885105e-01  5.81885105e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  5.81885105e-01
   5.81885105e-01]
 [ 2.94240198e-01 -4.13469238e-03  3.68109196e-01  7.34954596e-02
  -5.93537154e-01 -5.93703933e-01  7.34954596e-02  7.34954596e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.34954596e-02
   7.34954596e-02]
 [-4.27393199e-01 -8.54699981e-01 -5.58709121e-01 -7.49874727e-01
   7.57341201e-01  7.58318772e-01 -7.49874727e-01 -7.49874727e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -7.49874727e-01
  -7.49874727e-01]
 [-1.11178100e+00 -5.72950229e-02 -8.67648559e-01  9.55993572e-02
   6.80978969e-01  6.82206124e-01  9.55993572e-02  9.55993572e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00  9.55993572e-02
   9.55993572e-02]
 [-1.66674036e-01 -5.23924591e-01 -7.68159588e-01 -1.08695917e+00
  -4.46867575e-01 -4.48227928e-01 -1.08695917e+00 -1.08695917e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.08695917e+00
  -1.08695917e+00]
 [-1.42836856e+00 -7.36565913e-01 -1.22895061e+00 -1.23063450e+00
   2.50000074e+00  2.49989502e+00 -1.23063450e+00 -1.23063450e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.23063450e+00
  -1.23063450e+00]
 [-1.34456597e+00 -1.95334681e+00 -1.26560445e+00 -1.26931632e+00
  -1.94499574e-03 -5.63954664e-03 -1.26931632e+00 -1.26931632e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.26931632e+00
  -1.26931632e+00]]
2024-09-20 06:46:39 - INFO - y 샘플:
[-1.26931632]
2024-09-20 06:46:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:46:39 - INFO - 모델 출력 (스케일링된 예측): [0.45775083]
2024-09-20 06:46:39 - INFO - 스케일러 역변환 후 예측 가격: 84205536.21919972
2024-09-20 06:46:39 - INFO - TransformerPredictor 최종 예측 가격: 84205536.21919972
2024-09-20 06:46:39 - INFO - TRANSFORMER prediction: 84205536.21919972
2024-09-20 06:46:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:46:39 - INFO - BITCOIN_FORECAST prediction: 83142199.28135902
2024-09-20 06:46:39 - INFO - BitcoinForecast prediction: 83142199.28135902
2024-09-20 06:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:46:45 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:46:45 - INFO - 조정된 모델 가중치: {'gpt': 0.005215491738137709, 'ml': 0.15553264627126945, 'xgboost': 0.041628104102251304, 'rl': 0.2781071218400224, 'lstm': 0.07806513400132992, 'arima': 0.0, 'prophet': 0.250342132250328, 'transformer': 0.0, 'bitcoin_forecast': 0.19110936979666124}
2024-09-20 06:46:45 - INFO - 조정된 모델 가중치: {'gpt': 0.005215491738137709, 'ml': 0.15553264627126945, 'xgboost': 0.041628104102251304, 'rl': 0.2781071218400224, 'lstm': 0.07806513400132992, 'arima': 0.0, 'prophet': 0.250342132250328, 'transformer': 0.0, 'bitcoin_forecast': 0.19110936979666124}
2024-09-20 06:46:45 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83970402.46447425, 'current_price': 83893000.0, 'predictions': {'gpt': 83893000.0, 'ml': 83859442.8, 'xgboost': 83893000.0, 'lstm': 84148639.9164803, 'rl': 84731930.0, 'arima': 84140000.0, 'prophet': 83784499.62476091, 'transformer': 84205536.21919972, 'bitcoin_forecast': 83142199.28135902}, 'weights': {'gpt': 0.005215491738137709, 'ml': 0.15553264627126945, 'xgboost': 0.041628104102251304, 'rl': 0.2781071218400224, 'lstm': 0.07806513400132992, 'arima': 0.0, 'prophet': 0.250342132250328, 'transformer': 0.0, 'bitcoin_forecast': 0.19110936979666124}}
2024-09-20 06:46:45 - INFO - 모델별 가중치:
2024-09-20 06:46:45 - INFO -   - GPT: 0.0052
2024-09-20 06:46:45 - INFO -   - ML: 0.1555
2024-09-20 06:46:45 - INFO -   - XGBOOST: 0.0416
2024-09-20 06:46:45 - INFO -   - RL: 0.2781
2024-09-20 06:46:45 - INFO -   - LSTM: 0.0781
2024-09-20 06:46:45 - INFO -   - ARIMA: 0.0000
2024-09-20 06:46:45 - INFO -   - PROPHET: 0.2503
2024-09-20 06:46:45 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 06:46:45 - INFO -   - BITCOIN_FORECAST: 0.1911
2024-09-20 06:46:45 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:46:45 - INFO - 6. 거래 실행
2024-09-20 06:46:45 - INFO - Cancelling existing orders.
2024-09-20 06:46:45 - INFO - Cancelled 0 orders.
2024-09-20 06:46:45 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83970402.46447425, 'current_price': 83893000.0, 'predictions': {'gpt': 83893000.0, 'ml': 83859442.8, 'xgboost': 83893000.0, 'lstm': 84148639.9164803, 'rl': 84731930.0, 'arima': 84140000.0, 'prophet': 83784499.62476091, 'transformer': 84205536.21919972, 'bitcoin_forecast': 83142199.28135902}, 'weights': {'gpt': 0.005215491738137709, 'ml': 0.15553264627126945, 'xgboost': 0.041628104102251304, 'rl': 0.2781071218400224, 'lstm': 0.07806513400132992, 'arima': 0.0, 'prophet': 0.250342132250328, 'transformer': 0.0, 'bitcoin_forecast': 0.19110936979666124}}, 현재 가격=83893000.0
2024-09-20 06:46:45 - INFO - 현재 잔고: KRW=37827.79709921, BTC=0.0052159, 총 자산가치=475405.29579920997
2024-09-20 06:46:45 - INFO - 매수 시도: 0.0004509052852944823 BTC (약 37827.79709921 KRW)
2024-09-20 06:46:45 - INFO - 주문 결과: None
2024-09-20 06:46:45 - ERROR - 주문 실패
2024-09-20 06:46:45 - WARNING - Trade execution failed: Failed to place order
2024-09-20 06:46:45 - INFO - 7. summary 리포트 보내기
2024-09-20 06:46:45 - INFO - Message sent to Discord successfully.
2024-09-20 06:46:45 - INFO - Trading cycle completed.
2024-09-20 06:46:45 - INFO - Performing periodic update.
2024-09-20 06:46:45 - INFO - 계산된 시장 변동성: 0.027145863139121776
2024-09-20 06:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8117-9df4-c2c03ac4e42c "HTTP/1.1 200 OK"
2024-09-20 06:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:55:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814e-9fa2-cd4e43481324 "HTTP/1.1 200 OK"
2024-09-20 06:55:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:55:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7bde0de0-045e-409b-a2d6-b94249129aab "HTTP/1.1 200 OK"
2024-09-20 06:56:05 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-b4f4-c8b75cf7ba4e "HTTP/1.1 200 OK"
2024-09-20 06:56:13 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813c-a238-cc39bdec521f "HTTP/1.1 200 OK"
2024-09-20 06:56:19 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f6-969e-e1b5ca41726c "HTTP/1.1 200 OK"
2024-09-20 06:56:25 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-9320-efc62ef74384 "HTTP/1.1 200 OK"
2024-09-20 06:56:32 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8141-bd9f-e48d3e4ed8b1 "HTTP/1.1 200 OK"
2024-09-20 06:56:38 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 06:56:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ce-89aa-ea0029359c8b "HTTP/1.1 200 OK"
2024-09-20 06:56:46 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:45:34.964310
2024-09-20 06:56:46 - INFO - Starting trading cycle.
2024-09-20 06:56:46 - INFO - ##################################################
2024-09-20 06:56:46 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-20 06:56:46 - INFO - ##################################################
2024-09-20 06:56:46 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 06:56:46 - INFO - 데이터베이스 업데이트 시작
2024-09-20 06:56:46 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:40:00
2024-09-20 06:56:46 - INFO - 새로운 데이터 범위: 2024-09-18 21:40:00 ~ 2024-09-20 06:50:00
2024-09-20 06:56:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 06:56:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 06:56:46 - INFO - Index: Index([199], dtype='int64')
2024-09-20 06:56:46 - INFO - Date column data type: datetime64[ns]
2024-09-20 06:56:46 - INFO - Sample date values: [Timestamp('2024-09-20 06:50:00')]
2024-09-20 06:56:46 - INFO - Successfully added 1 new data points
2024-09-20 06:56:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 06:56:46 - INFO - Final date range: 2024-09-20 06:50:00 to 2024-09-20 06:50:00
2024-09-20 06:56:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 06:56:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 06:50:00
2024-09-20 06:56:46 - INFO - 데이터베이스 업데이트 완료
2024-09-20 06:56:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 06:56:47 - INFO - GPT | 이전예측가격: 83893000 | 당시BTC가격: 83893000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:56:47 - INFO - ML 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 06:56:47 - INFO - ML | 이전예측가격: 83859443 | 당시BTC가격: 83893000 | 예측: 하락 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1165 | 반영가중치값: -0.0200 | 새 가중치: 0.0965 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 06:56:47 - INFO - XGBOOST | 이전예측가격: 83893000 | 당시BTC가격: 83893000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 06:56:47 - INFO - LSTM 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 06:56:47 - INFO - LSTM | 이전예측가격: 84148640 | 당시BTC가격: 83893000 | 예측: 상승 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0945 | 반영가중치값: 0.0200 | 새 가중치: 0.1145 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 06:56:47 - INFO - RL 모델 예측 업데이트: 정확도 55.29%, 적중/전체: 47/85
2024-09-20 06:56:47 - INFO - RL | 이전예측가격: 84731930 | 당시BTC가격: 83893000 | 예측: 상승 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0929 | 반영가중치값: 0.0200 | 새 가중치: 0.1129 | 예측 총 횟수: 85 | 예측 성공 수: 47 | 예측 성공률: 55.29%
2024-09-20 06:56:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 06:56:47 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83893000 | 예측: 상승 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 06:56:47 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.82%, 적중/전체: 49/78
2024-09-20 06:56:47 - INFO - PROPHET | 이전예측가격: 83784500 | 당시BTC가격: 83893000 | 예측: 하락 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3113 | 반영가중치값: -0.0200 | 새 가중치: 0.2913 | 예측 총 횟수: 78 | 예측 성공 수: 49 | 예측 성공률: 62.82%
2024-09-20 06:56:47 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 47.73%, 적중/전체: 21/44
2024-09-20 06:56:47 - INFO - TRANSFORMER | 이전예측가격: 84205536 | 당시BTC가격: 83893000 | 예측: 상승 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1297 | 반영가중치값: 0.0200 | 새 가중치: 0.1497 | 예측 총 횟수: 44 | 예측 성공 수: 21 | 예측 성공률: 47.73%
2024-09-20 06:56:47 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 72.00%, 적중/전체: 18/25
2024-09-20 06:56:47 - INFO - BITCOIN_FORECAST | 이전예측가격: 83142199 | 당시BTC가격: 83893000 | 예측: 하락 | 지금 BTC가격: 83911000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2083 | 반영가중치값: -0.0200 | 새 가중치: 0.1883 | 예측 총 횟수: 25 | 예측 성공 수: 18 | 예측 성공률: 72.00%
2024-09-20 06:56:47 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 06:56:47 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 06:56:47 - INFO - 새로운 가중치: {'gpt': 0.0051126891664634265, 'ml': 0.09461073525976478, 'xgboost': 0.0408075724303587, 'rl': 0.11069357681163086, 'lstm': 0.11226735125371139, 'arima': 0.01960577994622233, 'prophet': 0.2855434782807403, 'transformer': 0.14675244386395903, 'bitcoin_forecast': 0.1846063729871492}
2024-09-20 06:56:47 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 06:56:47 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 06:56:47 - INFO - Current BTC price: 83911000.0
2024-09-20 06:56:47 - INFO - Analyzing market conditions.
2024-09-20 06:56:47 - INFO - Market analysis: {'current_price': 83911000.0, 'sma_20': 84374100.0, 'rsi_14': 34.261026562223655, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 06:56:47 - INFO - Starting predictions for all models
2024-09-20 06:56:47 - INFO - Attempting prediction for gpt
2024-09-20 06:56:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 06:56:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:56:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 06:56:47 - INFO - GPT prediction: 83911000.0
2024-09-20 06:56:47 - INFO - Attempting prediction for ml
2024-09-20 06:56:47 - INFO - ML prediction: 83944564.39999999
2024-09-20 06:56:47 - INFO - Attempting prediction for xgboost
2024-09-20 06:56:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 06:56:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:56:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 06:56:47 - INFO - XGBOOST prediction: 83911000.0
2024-09-20 06:56:47 - INFO - Attempting prediction for lstm
2024-09-20 06:56:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:56:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:56:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 06:56:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:56:47 - INFO - X 샘플:
[[ 1.17960474  1.33752696  1.74525599  1.9261099  -0.93018359 -0.92942024
   1.9261099 ]
 [ 1.63273058  1.58656694  1.19436927  0.95206728 -0.59798146 -0.59553227
   0.95206728]
 [ 1.00721992  0.8151504   1.01855437  0.904553   -0.70275168 -0.702123
   0.904553  ]
 [ 0.54916881  0.26240311  0.66692455  0.35813884 -0.6379857  -0.63763658
   0.35813884]
 [-0.21424971 -0.61227392 -0.37038341 -0.52681452  0.7417394   0.74293848
  -0.52681452]
 [-0.93826599  0.20773579 -0.71615273  0.38189598  0.66374652  0.66521846
   0.38189598]
 [ 0.06156601 -0.27212174 -0.60480328 -0.88911086 -0.48818413 -0.48908838
  -0.88911086]
 [-1.27318508 -0.490791   -1.12052701 -1.04353225  2.5216118   2.52129377
  -1.04353225]
 [-1.18453003 -1.74206508 -1.16155049 -1.08510724 -0.03376065 -0.03715331
  -1.08510724]
 [-0.82005925 -1.09213146 -0.65168726 -0.97820013 -0.53625051 -0.53849692
  -0.97820013]]
2024-09-20 06:56:47 - INFO - y 샘플:
[-0.97820013]
2024-09-20 06:56:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 06:56:47 - INFO - 모델 출력 (스케일링된 예측): [[0.13853113]]
2024-09-20 06:56:47 - INFO - 스케일러 역변환 후 예측 가격: 84099024.54993644
2024-09-20 06:56:47 - INFO - LSTMPredictor 최종 예측 가격: 84099024.54993644
2024-09-20 06:56:47 - INFO - LSTM prediction: 84099024.54993644
2024-09-20 06:56:47 - INFO - Attempting prediction for rl
2024-09-20 06:56:47 - INFO - Preparing state for RL agent.
2024-09-20 06:56:47 - INFO - Prepared state: [[8.39110000e+07 8.17091752e+00 2.14559022e-04 8.43741000e+07
  3.42610266e+01]]
2024-09-20 06:56:47 - INFO - RL prediction: 84750110.0
2024-09-20 06:56:47 - INFO - Attempting prediction for arima
2024-09-20 06:56:47 - INFO - ARIMA 예측 시작
2024-09-20 06:56:47 - INFO - 입력 데이터: {'open': 83943000.0, 'high': 84000000.0, 'low': 83911000.0, 'close': 83911000.0, 'volume': 8.17091752, 'value': 685971992.9176, 'decision': 'sell', 'sma': 84374100.0, 'ema': 84261768.69874193, 'rsi': 34.261026562223655, 'macd': -187947.0307955742, 'signal_line': -121032.28231308231, 'BB_Upper': 85064746.62454951, 'BB_Lower': 83683453.37545049}
2024-09-20 06:56:47 - INFO - Exogenous 변수 예측 시작
2024-09-20 06:56:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84374100.0         0         0
2024-09-20 06:56:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84374100.0         0         0
2024-09-20 06:56:47 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 06:56:47 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 06:56:47 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 06:56:47 - INFO - ARIMA prediction: 84140000.0
2024-09-20 06:56:47 - INFO - Attempting prediction for prophet
2024-09-20 06:56:47 - INFO - PROPHET prediction: 83805693.09710711
2024-09-20 06:56:47 - INFO - Attempting prediction for transformer
2024-09-20 06:56:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 06:56:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 06:56:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 06:56:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 06:56:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 06:56:47 - INFO - X 샘플:
[[ 1.17960474  1.33752696  1.74525599  1.9261099  -0.93018359 -0.92942024
   1.9261099   1.9261099   0.          0.          0.          1.9261099
   1.9261099 ]
 [ 1.63273058  1.58656694  1.19436927  0.95206728 -0.59798146 -0.59553227
   0.95206728  0.95206728  0.          0.          0.          0.95206728
   0.95206728]
 [ 1.00721992  0.8151504   1.01855437  0.904553   -0.70275168 -0.702123
   0.904553    0.904553    0.          0.          0.          0.904553
   0.904553  ]
 [ 0.54916881  0.26240311  0.66692455  0.35813884 -0.6379857  -0.63763658
   0.35813884  0.35813884  0.          0.          0.          0.35813884
   0.35813884]
 [-0.21424971 -0.61227392 -0.37038341 -0.52681452  0.7417394   0.74293848
  -0.52681452 -0.52681452  0.          0.          0.         -0.52681452
  -0.52681452]
 [-0.93826599  0.20773579 -0.71615273  0.38189598  0.66374652  0.66521846
   0.38189598  0.38189598  0.          0.          0.          0.38189598
   0.38189598]
 [ 0.06156601 -0.27212174 -0.60480328 -0.88911086 -0.48818413 -0.48908838
  -0.88911086 -0.88911086  0.          0.          0.         -0.88911086
  -0.88911086]
 [-1.27318508 -0.490791   -1.12052701 -1.04353225  2.5216118   2.52129377
  -1.04353225 -1.04353225  0.          0.          0.         -1.04353225
  -1.04353225]
 [-1.18453003 -1.74206508 -1.16155049 -1.08510724 -0.03376065 -0.03715331
  -1.08510724 -1.08510724  0.          0.          0.         -1.08510724
  -1.08510724]
 [-0.82005925 -1.09213146 -0.65168726 -0.97820013 -0.53625051 -0.53849692
  -0.97820013 -0.97820013  0.          0.          0.         -0.97820013
  -0.97820013]]
2024-09-20 06:56:47 - INFO - y 샘플:
[-0.97820013]
2024-09-20 06:56:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 06:56:47 - INFO - 모델 출력 (스케일링된 예측): [0.4600964]
2024-09-20 06:56:47 - INFO - 스케일러 역변환 후 예측 가격: 84153166.63820936
2024-09-20 06:56:47 - INFO - TransformerPredictor 최종 예측 가격: 84153166.63820936
2024-09-20 06:56:47 - INFO - TRANSFORMER prediction: 84153166.63820936
2024-09-20 06:56:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 06:56:47 - INFO - BITCOIN_FORECAST prediction: 83054090.61532699
2024-09-20 06:56:47 - INFO - BitcoinForecast prediction: 83054090.61532699
2024-09-20 06:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 06:56:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 06:56:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0051126891664634265, 'ml': 0.09461073525976478, 'xgboost': 0.0408075724303587, 'rl': 0.11069357681163086, 'lstm': 0.11226735125371139, 'arima': 0.01960577994622233, 'prophet': 0.2855434782807403, 'transformer': 0.14675244386395903, 'bitcoin_forecast': 0.1846063729871492}
2024-09-20 06:56:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0051126891664634265, 'ml': 0.09461073525976478, 'xgboost': 0.0408075724303587, 'rl': 0.11069357681163086, 'lstm': 0.11226735125371139, 'arima': 0.01960577994622233, 'prophet': 0.2855434782807403, 'transformer': 0.14675244386395903, 'bitcoin_forecast': 0.1846063729871492}
2024-09-20 06:56:59 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83879936.29475808, 'current_price': 83911000.0, 'predictions': {'gpt': 83911000.0, 'ml': 83944564.39999999, 'xgboost': 83911000.0, 'lstm': 84099024.54993644, 'rl': 84750110.0, 'arima': 84140000.0, 'prophet': 83805693.09710711, 'transformer': 84153166.63820936, 'bitcoin_forecast': 83054090.61532699}, 'weights': {'gpt': 0.0051126891664634265, 'ml': 0.09461073525976478, 'xgboost': 0.0408075724303587, 'rl': 0.11069357681163086, 'lstm': 0.11226735125371139, 'arima': 0.01960577994622233, 'prophet': 0.2855434782807403, 'transformer': 0.14675244386395903, 'bitcoin_forecast': 0.1846063729871492}}
2024-09-20 06:56:59 - INFO - 모델별 가중치:
2024-09-20 06:56:59 - INFO -   - GPT: 0.0051
2024-09-20 06:56:59 - INFO -   - ML: 0.0946
2024-09-20 06:56:59 - INFO -   - XGBOOST: 0.0408
2024-09-20 06:56:59 - INFO -   - RL: 0.1107
2024-09-20 06:56:59 - INFO -   - LSTM: 0.1123
2024-09-20 06:56:59 - INFO -   - ARIMA: 0.0196
2024-09-20 06:56:59 - INFO -   - PROPHET: 0.2855
2024-09-20 06:56:59 - INFO -   - TRANSFORMER: 0.1468
2024-09-20 06:56:59 - INFO -   - BITCOIN_FORECAST: 0.1846
2024-09-20 06:56:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 06:56:59 - INFO - 6. 거래 실행
2024-09-20 06:56:59 - INFO - Cancelling existing orders.
2024-09-20 06:56:59 - INFO - Cancelled 0 orders.
2024-09-20 06:56:59 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83879936.29475808, 'current_price': 83911000.0, 'predictions': {'gpt': 83911000.0, 'ml': 83944564.39999999, 'xgboost': 83911000.0, 'lstm': 84099024.54993644, 'rl': 84750110.0, 'arima': 84140000.0, 'prophet': 83805693.09710711, 'transformer': 84153166.63820936, 'bitcoin_forecast': 83054090.61532699}, 'weights': {'gpt': 0.0051126891664634265, 'ml': 0.09461073525976478, 'xgboost': 0.0408075724303587, 'rl': 0.11069357681163086, 'lstm': 0.11226735125371139, 'arima': 0.01960577994622233, 'prophet': 0.2855434782807403, 'transformer': 0.14675244386395903, 'bitcoin_forecast': 0.1846063729871492}}, 현재 가격=83911000.0
2024-09-20 06:56:59 - INFO - 현재 잔고: KRW=37827.79709921, BTC=0.0052159, 총 자산가치=475499.18199921004
2024-09-20 06:56:59 - INFO - 매도 시도: 0.00052159 BTC (약 43767.138490000005 KRW)
2024-09-20 06:56:59 - INFO - 주문 결과: {'uuid': '2976f066-f9b2-475e-ab33-fdae7f474fd9', 'side': 'ask', 'ord_type': 'limit', 'price': '83911000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T06:57:00+09:00', 'volume': '0.00052159', 'remaining_volume': '0.00052159', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00052159', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 06:56:59 - INFO - sell 주문 성공: UUID=2976f066-f9b2-475e-ab33-fdae7f474fd9
2024-09-20 06:56:59 - INFO - Trade executed successfully.
2024-09-20 06:56:59 - INFO - 7. summary 리포트 보내기
2024-09-20 06:57:00 - INFO - Message sent to Discord successfully.
2024-09-20 06:57:00 - INFO - Trading cycle completed.
2024-09-20 06:57:00 - INFO - Performing periodic update.
2024-09-20 06:57:00 - INFO - 계산된 시장 변동성: 0.027137534431379444
2024-09-20 07:05:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/0ca58f8e-c296-4e21-8d45-fc1bf4d00da6 "HTTP/1.1 200 OK"
2024-09-20 07:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:05:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:05:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811c-b743-cf2c20f4d274 "HTTP/1.1 200 OK"
2024-09-20 07:05:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:05:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8104-ba2c-e66004d8bde3 "HTTP/1.1 200 OK"
2024-09-20 07:05:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:05:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:05:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8172-af6b-f06f1cb41e0d "HTTP/1.1 200 OK"
2024-09-20 07:05:58 - INFO - Updated actual price for lstm prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:06:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f3-94dd-cdd41f410c18 "HTTP/1.1 200 OK"
2024-09-20 07:06:03 - INFO - Updated actual price for rl prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:06:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c1-a04c-ca47aae4c55d "HTTP/1.1 200 OK"
2024-09-20 07:06:10 - INFO - Updated actual price for arima prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:06:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/aa6cc266-e6de-4259-b7e2-04d8c5684a75 "HTTP/1.1 200 OK"
2024-09-20 07:06:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:06:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8146-9210-cbc481605789 "HTTP/1.1 200 OK"
2024-09-20 07:06:29 - INFO - Updated actual price for transformer prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:06:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816b-a8e3-e3a843134d70 "HTTP/1.1 200 OK"
2024-09-20 07:06:35 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 06:55:34.964823
2024-09-20 07:06:35 - INFO - Starting trading cycle.
2024-09-20 07:06:35 - INFO - ##################################################
2024-09-20 07:06:35 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-20 07:06:35 - INFO - ##################################################
2024-09-20 07:06:35 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:06:35 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:06:35 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 06:50:00
2024-09-20 07:06:35 - INFO - 새로운 데이터 범위: 2024-09-18 21:50:00 ~ 2024-09-20 07:00:00
2024-09-20 07:06:35 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:06:35 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:06:35 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:06:35 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:06:35 - INFO - Sample date values: [Timestamp('2024-09-20 07:00:00')]
2024-09-20 07:06:35 - INFO - Successfully added 1 new data points
2024-09-20 07:06:35 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:06:35 - INFO - Final date range: 2024-09-20 07:00:00 to 2024-09-20 07:00:00
2024-09-20 07:06:35 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:06:35 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:00:00
2024-09-20 07:06:35 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:06:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:06:35 - INFO - GPT | 이전예측가격: 83911000 | 당시BTC가격: 83911000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:06:35 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-20 07:06:35 - INFO - ML | 이전예측가격: 83944564 | 당시BTC가격: 83911000 | 예측: 상승 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1555 | 반영가중치값: -0.0200 | 새 가중치: 0.1355 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-20 07:06:35 - INFO - XGBOOST | 이전예측가격: 83911000 | 당시BTC가격: 83911000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:06:35 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 2/6
2024-09-20 07:06:35 - INFO - LSTM | 이전예측가격: 84099025 | 당시BTC가격: 83911000 | 예측: 상승 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0781 | 반영가중치값: -0.0200 | 새 가중치: 0.0581 | 예측 총 횟수: 6 | 예측 성공 수: 2 | 예측 성공률: 33.33%
2024-09-20 07:06:35 - INFO - RL 모델 예측 업데이트: 정확도 54.65%, 적중/전체: 47/86
2024-09-20 07:06:35 - INFO - RL | 이전예측가격: 84750110 | 당시BTC가격: 83911000 | 예측: 상승 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2781 | 반영가중치값: -0.0200 | 새 가중치: 0.2581 | 예측 총 횟수: 86 | 예측 성공 수: 47 | 예측 성공률: 54.65%
2024-09-20 07:06:35 - INFO - ARIMA 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 07:06:35 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83911000 | 예측: 상승 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 07:06:35 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.29%, 적중/전체: 50/79
2024-09-20 07:06:35 - INFO - PROPHET | 이전예측가격: 83805693 | 당시BTC가격: 83911000 | 예측: 하락 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2503 | 반영가중치값: 0.0200 | 새 가중치: 0.2703 | 예측 총 횟수: 79 | 예측 성공 수: 50 | 예측 성공률: 63.29%
2024-09-20 07:06:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 46.67%, 적중/전체: 21/45
2024-09-20 07:06:35 - INFO - TRANSFORMER | 이전예측가격: 84153167 | 당시BTC가격: 83911000 | 예측: 상승 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 45 | 예측 성공 수: 21 | 예측 성공률: 46.67%
2024-09-20 07:06:35 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 73.08%, 적중/전체: 19/26
2024-09-20 07:06:35 - INFO - BITCOIN_FORECAST | 이전예측가격: 83054091 | 당시BTC가격: 83911000 | 예측: 하락 | 지금 BTC가격: 83728000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1911 | 반영가중치값: 0.0200 | 새 가중치: 0.2111 | 예측 총 횟수: 26 | 예측 성공 수: 19 | 예측 성공률: 73.08%
2024-09-20 07:06:35 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:06:35 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:06:35 - INFO - 새로운 가중치: {'gpt': 0.005221949766838096, 'ml': 0.1384290434156728, 'xgboost': 0.0416796496715922, 'rl': 0.26362299385473476, 'lstm': 0.059306013545393686, 'arima': 0.0, 'prophet': 0.2761194722595723, 'transformer': 0.0, 'bitcoin_forecast': 0.2156208774861961}
2024-09-20 07:06:35 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 07:06:35 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:06:35 - INFO - Current BTC price: 83728000.0
2024-09-20 07:06:35 - INFO - Analyzing market conditions.
2024-09-20 07:06:35 - INFO - Market analysis: {'current_price': 83728000.0, 'sma_20': 84314050.0, 'rsi_14': 30.03057473642324, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 07:06:35 - INFO - Starting predictions for all models
2024-09-20 07:06:35 - INFO - Attempting prediction for gpt
2024-09-20 07:06:36 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:06:36 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:06:36 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:06:36 - INFO - GPT prediction: 83728000.0
2024-09-20 07:06:36 - INFO - Attempting prediction for ml
2024-09-20 07:06:36 - INFO - ML prediction: 83610780.8
2024-09-20 07:06:36 - INFO - Attempting prediction for xgboost
2024-09-20 07:06:36 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:06:36 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:06:36 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:06:36 - INFO - XGBOOST prediction: 83728000.0
2024-09-20 07:06:36 - INFO - Attempting prediction for lstm
2024-09-20 07:06:36 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:06:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:06:36 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:06:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:06:36 - INFO - X 샘플:
[[ 1.91545338  1.83311093  1.65026724  1.42731446 -0.78694222 -0.78506795
   1.42731446]
 [ 1.27696892  1.09451611  1.46202383  1.37712318 -0.87392889 -0.87366115
   1.37712318]
 [ 0.80941731  0.56528675  1.08553701  0.79992349 -0.8201562  -0.82006307
   0.79992349]
 [ 0.03016462 -0.2721751  -0.02509912 -0.13488906  0.32537626  0.32740592
  -0.13488906]
 [-0.70886857  0.51294538 -0.39531116  0.82501913  0.26062178  0.2628087
   0.82501913]
 [ 0.31170107  0.05350451 -0.27609034 -0.51759755 -0.69578174 -0.6965968
  -0.51759755]
 [-1.05073427 -0.15586095 -0.82827101 -0.6807192   1.80313557  1.80549111
  -0.6807192 ]
 [-0.96024041 -1.35389665 -0.87219447 -0.72463657 -0.31849148 -0.32096965
  -0.72463657]
 [-0.58821009 -0.73161597 -0.32628858 -0.6117062  -0.73568941 -0.73766285
  -0.6117062 ]
 [-1.03565196 -1.54581499 -1.47457339 -1.75983167  1.84185633  1.83831575
  -1.75983167]]
2024-09-20 07:06:36 - INFO - y 샘플:
[-1.75983167]
2024-09-20 07:06:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:06:36 - INFO - 모델 출력 (스케일링된 예측): [[0.15154587]]
2024-09-20 07:06:36 - INFO - 스케일러 역변환 후 예측 가격: 84032654.93282586
2024-09-20 07:06:36 - INFO - LSTMPredictor 최종 예측 가격: 84032654.93282586
2024-09-20 07:06:36 - INFO - LSTM prediction: 84032654.93282586
2024-09-20 07:06:36 - INFO - Attempting prediction for rl
2024-09-20 07:06:36 - INFO - Preparing state for RL agent.
2024-09-20 07:06:36 - INFO - Prepared state: [[ 8.37280000e+07  3.04879068e+01 -2.18088213e-03  8.43140500e+07
   3.00305747e+01]]
2024-09-20 07:06:36 - INFO - RL prediction: 84565280.0
2024-09-20 07:06:36 - INFO - Attempting prediction for arima
2024-09-20 07:06:36 - INFO - ARIMA 예측 시작
2024-09-20 07:06:36 - INFO - 입력 데이터: {'open': 83854000.0, 'high': 83860000.0, 'low': 83728000.0, 'close': 83728000.0, 'volume': 30.48790677, 'value': 2553892921.90003, 'decision': 'sell', 'sma': 84314050.0, 'ema': 84210933.58457603, 'rsi': 30.03057473642324, 'macd': -205812.78163148463, 'signal_line': -137988.3821767628, 'BB_Upper': 85010092.37658466, 'BB_Lower': 83618007.62341534}
2024-09-20 07:06:36 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:06:36 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84314050.0         0         0
2024-09-20 07:06:36 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84314050.0         0         0
2024-09-20 07:06:36 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:06:36 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:06:36 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:06:36 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:06:36 - INFO - Attempting prediction for prophet
2024-09-20 07:06:36 - INFO - PROPHET prediction: 83613051.23724243
2024-09-20 07:06:36 - INFO - Attempting prediction for transformer
2024-09-20 07:06:36 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:06:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:06:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:06:36 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:06:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:06:36 - INFO - X 샘플:
[[ 1.91545338  1.83311093  1.65026724  1.42731446 -0.78694222 -0.78506795
   1.42731446  1.42731446  0.          0.          0.          1.42731446
   1.42731446]
 [ 1.27696892  1.09451611  1.46202383  1.37712318 -0.87392889 -0.87366115
   1.37712318  1.37712318  0.          0.          0.          1.37712318
   1.37712318]
 [ 0.80941731  0.56528675  1.08553701  0.79992349 -0.8201562  -0.82006307
   0.79992349  0.79992349  0.          0.          0.          0.79992349
   0.79992349]
 [ 0.03016462 -0.2721751  -0.02509912 -0.13488906  0.32537626  0.32740592
  -0.13488906 -0.13488906  0.          0.          0.         -0.13488906
  -0.13488906]
 [-0.70886857  0.51294538 -0.39531116  0.82501913  0.26062178  0.2628087
   0.82501913  0.82501913  0.          0.          0.          0.82501913
   0.82501913]
 [ 0.31170107  0.05350451 -0.27609034 -0.51759755 -0.69578174 -0.6965968
  -0.51759755 -0.51759755  0.          0.          0.         -0.51759755
  -0.51759755]
 [-1.05073427 -0.15586095 -0.82827101 -0.6807192   1.80313557  1.80549111
  -0.6807192  -0.6807192   0.          0.          0.         -0.6807192
  -0.6807192 ]
 [-0.96024041 -1.35389665 -0.87219447 -0.72463657 -0.31849148 -0.32096965
  -0.72463657 -0.72463657  0.          0.          0.         -0.72463657
  -0.72463657]
 [-0.58821009 -0.73161597 -0.32628858 -0.6117062  -0.73568941 -0.73766285
  -0.6117062  -0.6117062   0.          0.          0.         -0.6117062
  -0.6117062 ]
 [-1.03565196 -1.54581499 -1.47457339 -1.75983167  1.84185633  1.83831575
  -1.75983167 -1.75983167  0.          0.          0.         -1.75983167
  -1.75983167]]
2024-09-20 07:06:36 - INFO - y 샘플:
[-1.75983167]
2024-09-20 07:06:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:06:36 - INFO - 모델 출력 (스케일링된 예측): [0.45767704]
2024-09-20 07:06:36 - INFO - 스케일러 역변환 후 예측 가격: 84081449.2546936
2024-09-20 07:06:36 - INFO - TransformerPredictor 최종 예측 가격: 84081449.2546936
2024-09-20 07:06:36 - INFO - TRANSFORMER prediction: 84081449.2546936
2024-09-20 07:06:36 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:06:36 - INFO - BITCOIN_FORECAST prediction: 83336678.20434532
2024-09-20 07:06:36 - INFO - BitcoinForecast prediction: 83336678.20434532
2024-09-20 07:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:06:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.005221949766838096, 'ml': 0.1384290434156728, 'xgboost': 0.0416796496715922, 'rl': 0.26362299385473476, 'lstm': 0.059306013545393686, 'arima': 0.0, 'prophet': 0.2761194722595723, 'transformer': 0.0, 'bitcoin_forecast': 0.2156208774861961}
2024-09-20 07:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.005221949766838096, 'ml': 0.1384290434156728, 'xgboost': 0.0416796496715922, 'rl': 0.26362299385473476, 'lstm': 0.059306013545393686, 'arima': 0.0, 'prophet': 0.2761194722595723, 'transformer': 0.0, 'bitcoin_forecast': 0.2156208774861961}
2024-09-20 07:06:41 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83834450.84747353, 'current_price': 83728000.0, 'predictions': {'gpt': 83728000.0, 'ml': 83610780.8, 'xgboost': 83728000.0, 'lstm': 84032654.93282586, 'rl': 84565280.0, 'arima': 84140000.0, 'prophet': 83613051.23724243, 'transformer': 84081449.2546936, 'bitcoin_forecast': 83336678.20434532}, 'weights': {'gpt': 0.005221949766838096, 'ml': 0.1384290434156728, 'xgboost': 0.0416796496715922, 'rl': 0.26362299385473476, 'lstm': 0.059306013545393686, 'arima': 0.0, 'prophet': 0.2761194722595723, 'transformer': 0.0, 'bitcoin_forecast': 0.2156208774861961}}
2024-09-20 07:06:41 - INFO - 모델별 가중치:
2024-09-20 07:06:41 - INFO -   - GPT: 0.0052
2024-09-20 07:06:41 - INFO -   - ML: 0.1384
2024-09-20 07:06:41 - INFO -   - XGBOOST: 0.0417
2024-09-20 07:06:41 - INFO -   - RL: 0.2636
2024-09-20 07:06:41 - INFO -   - LSTM: 0.0593
2024-09-20 07:06:41 - INFO -   - ARIMA: 0.0000
2024-09-20 07:06:41 - INFO -   - PROPHET: 0.2761
2024-09-20 07:06:41 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 07:06:41 - INFO -   - BITCOIN_FORECAST: 0.2156
2024-09-20 07:06:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:06:41 - INFO - 6. 거래 실행
2024-09-20 07:06:41 - INFO - Cancelling existing orders.
2024-09-20 07:06:41 - INFO - Cancelled 0 orders.
2024-09-20 07:06:41 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83834450.84747353, 'current_price': 83728000.0, 'predictions': {'gpt': 83728000.0, 'ml': 83610780.8, 'xgboost': 83728000.0, 'lstm': 84032654.93282586, 'rl': 84565280.0, 'arima': 84140000.0, 'prophet': 83613051.23724243, 'transformer': 84081449.2546936, 'bitcoin_forecast': 83336678.20434532}, 'weights': {'gpt': 0.005221949766838096, 'ml': 0.1384290434156728, 'xgboost': 0.0416796496715922, 'rl': 0.26362299385473476, 'lstm': 0.059306013545393686, 'arima': 0.0, 'prophet': 0.2761194722595723, 'transformer': 0.0, 'bitcoin_forecast': 0.2156208774861961}}, 현재 가격=83728000.0
2024-09-20 07:06:41 - INFO - 현재 잔고: KRW=81577.22265361, BTC=0.00469431, 총 자산가치=474622.41033361
2024-09-20 07:06:41 - INFO - 매수 시도: 0.0005668622328654811 BTC (약 47462.241033361 KRW)
2024-09-20 07:06:41 - INFO - 주문 결과: {'uuid': 'd9cef5fe-b057-497b-85c0-fae13c985956', 'side': 'bid', 'ord_type': 'limit', 'price': '83728000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T07:06:42+09:00', 'volume': '0.00056686', 'remaining_volume': '0.00056686', 'reserved_fee': '23.73102704', 'remaining_fee': '23.73102704', 'paid_fee': '0', 'locked': '47485.78510704', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 07:06:41 - INFO - buy 주문 성공: UUID=d9cef5fe-b057-497b-85c0-fae13c985956
2024-09-20 07:06:41 - INFO - Trade executed successfully.
2024-09-20 07:06:41 - INFO - 7. summary 리포트 보내기
2024-09-20 07:06:41 - INFO - Message sent to Discord successfully.
2024-09-20 07:06:41 - INFO - Trading cycle completed.
2024-09-20 07:06:41 - INFO - Performing periodic update.
2024-09-20 07:06:41 - INFO - 계산된 시장 변동성: 0.027247196848231712
2024-09-20 07:15:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:15:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-a133-e0252edd15be "HTTP/1.1 200 OK"
2024-09-20 07:15:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:15:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:15:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c4-9d7b-d70a4a9a2b86 "HTTP/1.1 200 OK"
2024-09-20 07:15:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:15:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:15:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-a29e-c26faf93ed76 "HTTP/1.1 200 OK"
2024-09-20 07:15:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:15:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814a-8106-f5d2af503cdd "HTTP/1.1 200 OK"
2024-09-20 07:16:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d6-85d3-fb924003dd3b "HTTP/1.1 200 OK"
2024-09-20 07:16:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e7-9ebe-f3b77887f8ee "HTTP/1.1 200 OK"
2024-09-20 07:16:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8108-8059-e3a198eba6d9 "HTTP/1.1 200 OK"
2024-09-20 07:16:21 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8117-9f9a-c14347bff266 "HTTP/1.1 200 OK"
2024-09-20 07:16:28 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:16:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8103-8ae1-df5a200e2f7d "HTTP/1.1 200 OK"
2024-09-20 07:16:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:05:34.965257
2024-09-20 07:16:38 - INFO - Starting trading cycle.
2024-09-20 07:16:38 - INFO - ##################################################
2024-09-20 07:16:38 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-20 07:16:38 - INFO - ##################################################
2024-09-20 07:16:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:16:38 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:16:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:00:00
2024-09-20 07:16:38 - INFO - 새로운 데이터 범위: 2024-09-18 22:00:00 ~ 2024-09-20 07:10:00
2024-09-20 07:16:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:16:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:16:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:16:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:16:38 - INFO - Sample date values: [Timestamp('2024-09-20 07:10:00')]
2024-09-20 07:16:38 - INFO - Successfully added 1 new data points
2024-09-20 07:16:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:16:38 - INFO - Final date range: 2024-09-20 07:10:00 to 2024-09-20 07:10:00
2024-09-20 07:16:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:16:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:10:00
2024-09-20 07:16:38 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:16:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:16:38 - INFO - GPT | 이전예측가격: 83728000 | 당시BTC가격: 83728000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:16:38 - INFO - ML 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-20 07:16:38 - INFO - ML | 이전예측가격: 83610781 | 당시BTC가격: 83728000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0946 | 반영가중치값: 0.0200 | 새 가중치: 0.1146 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-20 07:16:38 - INFO - XGBOOST | 이전예측가격: 83728000 | 당시BTC가격: 83728000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:16:38 - INFO - LSTM 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 2/7
2024-09-20 07:16:38 - INFO - LSTM | 이전예측가격: 84032655 | 당시BTC가격: 83728000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1123 | 반영가중치값: -0.0200 | 새 가중치: 0.0923 | 예측 총 횟수: 7 | 예측 성공 수: 2 | 예측 성공률: 28.57%
2024-09-20 07:16:38 - INFO - RL 모델 예측 업데이트: 정확도 54.02%, 적중/전체: 47/87
2024-09-20 07:16:38 - INFO - RL | 이전예측가격: 84565280 | 당시BTC가격: 83728000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1107 | 반영가중치값: -0.0200 | 새 가중치: 0.0907 | 예측 총 횟수: 87 | 예측 성공 수: 47 | 예측 성공률: 54.02%
2024-09-20 07:16:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 2/6
2024-09-20 07:16:38 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83728000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0196 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 6 | 예측 성공 수: 2 | 예측 성공률: 33.33%
2024-09-20 07:16:38 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.75%, 적중/전체: 51/80
2024-09-20 07:16:38 - INFO - PROPHET | 이전예측가격: 83613051 | 당시BTC가격: 83728000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2855 | 반영가중치값: 0.0200 | 새 가중치: 0.3055 | 예측 총 횟수: 80 | 예측 성공 수: 51 | 예측 성공률: 63.75%
2024-09-20 07:16:38 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 45.65%, 적중/전체: 21/46
2024-09-20 07:16:38 - INFO - TRANSFORMER | 이전예측가격: 84081449 | 당시BTC가격: 83728000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1468 | 반영가중치값: -0.0200 | 새 가중치: 0.1268 | 예측 총 횟수: 46 | 예측 성공 수: 21 | 예측 성공률: 45.65%
2024-09-20 07:16:38 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 74.07%, 적중/전체: 20/27
2024-09-20 07:16:38 - INFO - BITCOIN_FORECAST | 이전예측가격: 83336678 | 당시BTC가격: 83728000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1846 | 반영가중치값: 0.0200 | 새 가중치: 0.2046 | 예측 총 횟수: 27 | 예측 성공 수: 20 | 예측 성공률: 74.07%
2024-09-20 07:16:38 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:16:38 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:16:38 - INFO - 새로운 가중치: {'gpt': 0.00532105138020439, 'ml': 0.11678580573736098, 'xgboost': 0.04247064167868264, 'rl': 0.0924147499720986, 'lstm': 0.09401839133999203, 'arima': 0.0, 'prophet': 0.3113420502707396, 'transformer': 0.12915793841023174, 'bitcoin_forecast': 0.2084893712106901}
2024-09-20 07:16:38 - INFO - XGBoost 모델 성능: 정확도 61.16%, 적중/전체: 74/121
2024-09-20 07:16:38 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:16:39 - INFO - Current BTC price: 83650000.0
2024-09-20 07:16:39 - INFO - Analyzing market conditions.
2024-09-20 07:16:39 - INFO - Market analysis: {'current_price': 83661000.0, 'sma_20': 84253450.0, 'rsi_14': 28.63641227503453, 'trend': 'Bearish', 'overbought_oversold': 'Oversold'}
2024-09-20 07:16:39 - INFO - Starting predictions for all models
2024-09-20 07:16:39 - INFO - Attempting prediction for gpt
2024-09-20 07:16:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:16:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:16:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:16:39 - INFO - GPT prediction: 83650000.0
2024-09-20 07:16:39 - INFO - Attempting prediction for ml
2024-09-20 07:16:39 - INFO - ML prediction: 83644267.8
2024-09-20 07:16:39 - INFO - Attempting prediction for xgboost
2024-09-20 07:16:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:16:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:16:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:16:39 - INFO - XGBOOST prediction: 83661000.0
2024-09-20 07:16:39 - INFO - Attempting prediction for lstm
2024-09-20 07:16:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:16:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:16:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:16:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:16:39 - INFO - X 샘플:
[[ 1.68632509  1.45496216  1.64179064  1.62662805 -1.00209373 -1.00242854
   1.62662805]
 [ 1.22520121  0.95115106  1.31944954  1.08637614 -0.95699344 -0.95739169
   1.08637614]
 [ 0.4566614   0.15391152  0.36854332  0.21140292  0.00378887  0.00679205
   0.21140292]
 [-0.27221184  0.90132359  0.05157457  1.10986535 -0.05052207 -0.04748705
   1.10986535]
 [ 0.73432739  0.46394912  0.15364925 -0.14680759 -0.85267795 -0.85364668
  -0.14680759]
 [-0.6093777   0.26463924 -0.31911768 -0.29948748  1.24321688  1.24878266
  -0.29948748]
 [-0.52012791 -0.87585622 -0.35672414 -0.3405936  -0.53623662 -0.53801846
  -0.3405936 ]
 [-0.15321213 -0.28346295  0.11067044 -0.23489214 -0.88614935 -0.88815326
  -0.23489214]
 [-0.59450273 -1.05855694 -0.87246989 -1.30952367  1.2756928   1.27636422
  -1.30952367]
 [-1.95308278 -1.97206058 -2.09736605 -1.702968    1.76197459  1.75518676
  -1.702968  ]]
2024-09-20 07:16:39 - INFO - y 샘플:
[-1.702968]
2024-09-20 07:16:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:16:39 - INFO - 모델 출력 (스케일링된 예측): [[0.1672435]]
2024-09-20 07:16:39 - INFO - 스케일러 역변환 후 예측 가격: 83979480.04998675
2024-09-20 07:16:39 - INFO - LSTMPredictor 최종 예측 가격: 83979480.04998675
2024-09-20 07:16:39 - INFO - LSTM prediction: 83979480.04998675
2024-09-20 07:16:39 - INFO - Attempting prediction for rl
2024-09-20 07:16:39 - INFO - Preparing state for RL agent.
2024-09-20 07:16:39 - INFO - Prepared state: [[ 8.36610000e+07  3.55078595e+01 -8.00210204e-04  8.42534500e+07
   2.86364123e+01]]
2024-09-20 07:16:39 - INFO - RL prediction: 84486500.0
2024-09-20 07:16:39 - INFO - Attempting prediction for arima
2024-09-20 07:16:39 - INFO - ARIMA 예측 시작
2024-09-20 07:16:39 - INFO - 입력 데이터: {'open': 83580000.0, 'high': 83695000.0, 'low': 83500000.0, 'close': 83661000.0, 'volume': 35.50785952, 'value': 2967104023.14362, 'decision': 'sell', 'sma': 84253450.0, 'ema': 84158558.95747355, 'rsi': 28.63641227503453, 'macd': -222809.449304834, 'signal_line': -154952.59560237706, 'BB_Upper': 84955301.40165001, 'BB_Lower': 83551598.59834999}
2024-09-20 07:16:39 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:16:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84253450.0         0         0
2024-09-20 07:16:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84253450.0         0         0
2024-09-20 07:16:39 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:16:39 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:16:39 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:16:39 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:16:39 - INFO - Attempting prediction for prophet
2024-09-20 07:16:39 - INFO - PROPHET prediction: 83542053.96753046
2024-09-20 07:16:39 - INFO - Attempting prediction for transformer
2024-09-20 07:16:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:16:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:16:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:16:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:16:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:16:39 - INFO - X 샘플:
[[ 1.68632509  1.45496216  1.64179064  1.62662805 -1.00209373 -1.00242854
   1.62662805  1.62662805  0.          0.          0.          1.62662805
   1.62662805]
 [ 1.22520121  0.95115106  1.31944954  1.08637614 -0.95699344 -0.95739169
   1.08637614  1.08637614  0.          0.          0.          1.08637614
   1.08637614]
 [ 0.4566614   0.15391152  0.36854332  0.21140292  0.00378887  0.00679205
   0.21140292  0.21140292  0.          0.          0.          0.21140292
   0.21140292]
 [-0.27221184  0.90132359  0.05157457  1.10986535 -0.05052207 -0.04748705
   1.10986535  1.10986535  0.          0.          0.          1.10986535
   1.10986535]
 [ 0.73432739  0.46394912  0.15364925 -0.14680759 -0.85267795 -0.85364668
  -0.14680759 -0.14680759  0.          0.          0.         -0.14680759
  -0.14680759]
 [-0.6093777   0.26463924 -0.31911768 -0.29948748  1.24321688  1.24878266
  -0.29948748 -0.29948748  0.          0.          0.         -0.29948748
  -0.29948748]
 [-0.52012791 -0.87585622 -0.35672414 -0.3405936  -0.53623662 -0.53801846
  -0.3405936  -0.3405936   0.          0.          0.         -0.3405936
  -0.3405936 ]
 [-0.15321213 -0.28346295  0.11067044 -0.23489214 -0.88614935 -0.88815326
  -0.23489214 -0.23489214  0.          0.          0.         -0.23489214
  -0.23489214]
 [-0.59450273 -1.05855694 -0.87246989 -1.30952367  1.2756928   1.27636422
  -1.30952367 -1.30952367  0.          0.          0.         -1.30952367
  -1.30952367]
 [-1.95308278 -1.97206058 -2.09736605 -1.702968    1.76197459  1.75518676
  -1.702968   -1.702968    0.          0.          0.         -1.702968
  -1.702968  ]]
2024-09-20 07:16:39 - INFO - y 샘플:
[-1.702968]
2024-09-20 07:16:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:16:39 - INFO - 모델 출력 (스케일링된 예측): [0.45814708]
2024-09-20 07:16:39 - INFO - 스케일러 역변환 후 예측 가격: 84029018.29098724
2024-09-20 07:16:39 - INFO - TransformerPredictor 최종 예측 가격: 84029018.29098724
2024-09-20 07:16:39 - INFO - TRANSFORMER prediction: 84029018.29098724
2024-09-20 07:16:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:16:39 - INFO - BITCOIN_FORECAST prediction: 83402946.26138867
2024-09-20 07:16:39 - INFO - BitcoinForecast prediction: 83402946.26138867
2024-09-20 07:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:16:48 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:16:48 - INFO - 조정된 모델 가중치: {'gpt': 0.00532105138020439, 'ml': 0.11678580573736098, 'xgboost': 0.04247064167868264, 'rl': 0.0924147499720986, 'lstm': 0.09401839133999203, 'arima': 0.0, 'prophet': 0.3113420502707396, 'transformer': 0.12915793841023174, 'bitcoin_forecast': 0.2084893712106901}
2024-09-20 07:16:48 - INFO - 조정된 모델 가중치: {'gpt': 0.00532105138020439, 'ml': 0.11678580573736098, 'xgboost': 0.04247064167868264, 'rl': 0.0924147499720986, 'lstm': 0.09401839133999203, 'arima': 0.0, 'prophet': 0.3113420502707396, 'transformer': 0.12915793841023174, 'bitcoin_forecast': 0.2084893712106901}
2024-09-20 07:16:48 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83721916.86349055, 'current_price': 83650000.0, 'predictions': {'gpt': 83650000.0, 'ml': 83644267.8, 'xgboost': 83661000.0, 'lstm': 83979480.04998675, 'rl': 84486500.0, 'arima': 84140000.0, 'prophet': 83542053.96753046, 'transformer': 84029018.29098724, 'bitcoin_forecast': 83402946.26138867}, 'weights': {'gpt': 0.00532105138020439, 'ml': 0.11678580573736098, 'xgboost': 0.04247064167868264, 'rl': 0.0924147499720986, 'lstm': 0.09401839133999203, 'arima': 0.0, 'prophet': 0.3113420502707396, 'transformer': 0.12915793841023174, 'bitcoin_forecast': 0.2084893712106901}}
2024-09-20 07:16:48 - INFO - 모델별 가중치:
2024-09-20 07:16:48 - INFO -   - GPT: 0.0053
2024-09-20 07:16:48 - INFO -   - ML: 0.1168
2024-09-20 07:16:48 - INFO -   - XGBOOST: 0.0425
2024-09-20 07:16:48 - INFO -   - RL: 0.0924
2024-09-20 07:16:48 - INFO -   - LSTM: 0.0940
2024-09-20 07:16:48 - INFO -   - ARIMA: 0.0000
2024-09-20 07:16:48 - INFO -   - PROPHET: 0.3113
2024-09-20 07:16:48 - INFO -   - TRANSFORMER: 0.1292
2024-09-20 07:16:48 - INFO -   - BITCOIN_FORECAST: 0.2085
2024-09-20 07:16:48 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:16:48 - INFO - 6. 거래 실행
2024-09-20 07:16:48 - INFO - Cancelling existing orders.
2024-09-20 07:16:48 - INFO - Cancelled 0 orders.
2024-09-20 07:16:48 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83721916.86349055, 'current_price': 83650000.0, 'predictions': {'gpt': 83650000.0, 'ml': 83644267.8, 'xgboost': 83661000.0, 'lstm': 83979480.04998675, 'rl': 84486500.0, 'arima': 84140000.0, 'prophet': 83542053.96753046, 'transformer': 84029018.29098724, 'bitcoin_forecast': 83402946.26138867}, 'weights': {'gpt': 0.00532105138020439, 'ml': 0.11678580573736098, 'xgboost': 0.04247064167868264, 'rl': 0.0924147499720986, 'lstm': 0.09401839133999203, 'arima': 0.0, 'prophet': 0.3113420502707396, 'transformer': 0.12915793841023174, 'bitcoin_forecast': 0.2084893712106901}}, 현재 가격=83650000.0
2024-09-20 07:16:49 - INFO - 현재 잔고: KRW=34091.43754657, BTC=0.00526117, 총 자산가치=474188.30804657005
2024-09-20 07:16:49 - INFO - 매수 시도: 0.00040754856600800954 BTC (약 34091.43754657 KRW)
2024-09-20 07:16:49 - INFO - 주문 결과: None
2024-09-20 07:16:49 - ERROR - 주문 실패
2024-09-20 07:16:49 - WARNING - Trade execution failed: Failed to place order
2024-09-20 07:16:49 - INFO - 7. summary 리포트 보내기
2024-09-20 07:16:49 - INFO - Message sent to Discord successfully.
2024-09-20 07:16:49 - INFO - Trading cycle completed.
2024-09-20 07:16:49 - INFO - Performing periodic update.
2024-09-20 07:16:49 - INFO - 계산된 시장 변동성: 0.027285555932158284
2024-09-20 07:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:25:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-811a-a26f-e53f6849f385 "HTTP/1.1 200 OK"
2024-09-20 07:25:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:25:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8182-97da-c253f32084a2 "HTTP/1.1 200 OK"
2024-09-20 07:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-b999-ca32cfbd7bdb "HTTP/1.1 200 OK"
2024-09-20 07:25:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d4-bb4c-d6fe38e9a9c3 "HTTP/1.1 200 OK"
2024-09-20 07:26:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/bc114f53-2497-4e02-8503-3833eac55abb "HTTP/1.1 200 OK"
2024-09-20 07:26:16 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8166-bc77-f4472a291560 "HTTP/1.1 200 OK"
2024-09-20 07:26:22 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8183-92c2-f06ebf9c19e6 "HTTP/1.1 200 OK"
2024-09-20 07:26:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a0-b667-e3db8f575134 "HTTP/1.1 200 OK"
2024-09-20 07:26:37 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:26:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8136-928b-f3902f46e05f "HTTP/1.1 200 OK"
2024-09-20 07:26:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:15:34.965429
2024-09-20 07:26:43 - INFO - Starting trading cycle.
2024-09-20 07:26:43 - INFO - ##################################################
2024-09-20 07:26:43 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-20 07:26:43 - INFO - ##################################################
2024-09-20 07:26:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:26:43 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:26:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:10:00
2024-09-20 07:26:43 - INFO - 새로운 데이터 범위: 2024-09-18 22:10:00 ~ 2024-09-20 07:20:00
2024-09-20 07:26:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:26:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:26:43 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:26:43 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:26:43 - INFO - Sample date values: [Timestamp('2024-09-20 07:20:00')]
2024-09-20 07:26:43 - INFO - Successfully added 1 new data points
2024-09-20 07:26:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:26:43 - INFO - Final date range: 2024-09-20 07:20:00 to 2024-09-20 07:20:00
2024-09-20 07:26:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:26:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:20:00
2024-09-20 07:26:43 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:26:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:26:43 - INFO - GPT | 이전예측가격: 83650000 | 당시BTC가격: 83650000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:26:43 - INFO - ML | 이전예측가격: 83644268 | 당시BTC가격: 83650000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:26:43 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 07:26:43 - INFO - XGBOOST | 이전예측가격: 83661000 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0417 | 반영가중치값: -0.0200 | 새 가중치: 0.0217 | 예측 총 횟수: 122 | 예측 성공 수: 74 | 예측 성공률: 60.66%
2024-09-20 07:26:43 - INFO - LSTM 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 2/8
2024-09-20 07:26:43 - INFO - LSTM | 이전예측가격: 83979480 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0593 | 반영가중치값: -0.0200 | 새 가중치: 0.0393 | 예측 총 횟수: 8 | 예측 성공 수: 2 | 예측 성공률: 25.00%
2024-09-20 07:26:43 - INFO - RL 모델 예측 업데이트: 정확도 53.41%, 적중/전체: 47/88
2024-09-20 07:26:43 - INFO - RL | 이전예측가격: 84486500 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2636 | 반영가중치값: -0.0200 | 새 가중치: 0.2436 | 예측 총 횟수: 88 | 예측 성공 수: 47 | 예측 성공률: 53.41%
2024-09-20 07:26:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 2/7
2024-09-20 07:26:43 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 7 | 예측 성공 수: 2 | 예측 성공률: 28.57%
2024-09-20 07:26:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 64.20%, 적중/전체: 52/81
2024-09-20 07:26:43 - INFO - PROPHET | 이전예측가격: 83542054 | 당시BTC가격: 83650000 | 예측: 하락 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2761 | 반영가중치값: 0.0200 | 새 가중치: 0.2961 | 예측 총 횟수: 81 | 예측 성공 수: 52 | 예측 성공률: 64.20%
2024-09-20 07:26:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.68%, 적중/전체: 21/47
2024-09-20 07:26:44 - INFO - TRANSFORMER | 이전예측가격: 84029018 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 47 | 예측 성공 수: 21 | 예측 성공률: 44.68%
2024-09-20 07:26:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 21/28
2024-09-20 07:26:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83402946 | 당시BTC가격: 83650000 | 예측: 하락 | 지금 BTC가격: 83465000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2156 | 반영가중치값: 0.0200 | 새 가중치: 0.2356 | 예측 총 횟수: 28 | 예측 성공 수: 21 | 예측 성공률: 75.00%
2024-09-20 07:26:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:26:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:26:44 - INFO - 새로운 가중치: {'gpt': 0.0055516916119206375, 'ml': 0.12184787023774155, 'xgboost': 0.022619351070151335, 'rl': 0.2541827986262316, 'lstm': 0.041009727233571484, 'arima': 0.0, 'prophet': 0.3089547295832889, 'transformer': 0.0, 'bitcoin_forecast': 0.24583383163709446}
2024-09-20 07:26:44 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 07:26:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:26:44 - INFO - Current BTC price: 83465000.0
2024-09-20 07:26:44 - INFO - Analyzing market conditions.
2024-09-20 07:26:44 - INFO - Market analysis: {'current_price': 83465000.0, 'sma_20': 84187550.0, 'rsi_14': 24.982547909616468, 'trend': 'Bearish', 'overbought_oversold': 'Oversold'}
2024-09-20 07:26:44 - INFO - Starting predictions for all models
2024-09-20 07:26:44 - INFO - Attempting prediction for gpt
2024-09-20 07:26:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:26:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:26:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:26:44 - INFO - GPT prediction: 83465000.0
2024-09-20 07:26:44 - INFO - Attempting prediction for ml
2024-09-20 07:26:44 - INFO - ML prediction: 83398228.0
2024-09-20 07:26:44 - INFO - Attempting prediction for xgboost
2024-09-20 07:26:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:26:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:26:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:26:44 - INFO - XGBOOST prediction: 83465000.0
2024-09-20 07:26:44 - INFO - Attempting prediction for lstm
2024-09-20 07:26:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:26:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:26:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:26:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:26:44 - INFO - X 샘플:
[[ 1.55838194  1.15733211  1.50939642  1.32104536 -1.18039513 -1.18103164
   1.32104536]
 [ 0.82082713  0.49124169  0.70225694  0.56775122 -0.21542414 -0.21154843
   0.56775122]
 [ 0.12133966  1.11570146  0.43321045  1.34126802 -0.26997187 -0.26612587
   1.34126802]
 [ 1.08729855  0.75027685  0.51985254  0.25935563 -1.07562487 -1.07671642
   0.25935563]
 [-0.20223277  0.58375425  0.11856286  0.12790833  1.02940734  1.03726856
   0.12790833]
 [-0.11658124 -0.36912511  0.08664209  0.09251868 -0.75780396 -0.7593534
   0.09251868]
 [ 0.2355417   0.12581708  0.48337166  0.18352065 -1.10924219 -1.11141265
   0.18352065]
 [-0.18795752 -0.52177083 -0.35112847 -0.74166611  1.06202485  1.06500171
  -0.74166611]
 [-1.49176409 -1.28499945 -1.39083356 -1.08039569  1.55042665  1.54645602
  -1.08039569]
 [-1.82485336 -2.04822806 -2.11133094 -2.0713061   0.96660332  0.95746211
  -2.0713061 ]]
2024-09-20 07:26:44 - INFO - y 샘플:
[-2.0713061]
2024-09-20 07:26:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:26:44 - INFO - 모델 출력 (스케일링된 예측): [[0.17372009]]
2024-09-20 07:26:44 - INFO - 스케일러 역변환 후 예측 가격: 83909061.4696344
2024-09-20 07:26:44 - INFO - LSTMPredictor 최종 예측 가격: 83909061.4696344
2024-09-20 07:26:44 - INFO - LSTM prediction: 83909061.4696344
2024-09-20 07:26:44 - INFO - Attempting prediction for rl
2024-09-20 07:26:44 - INFO - Preparing state for RL agent.
2024-09-20 07:26:44 - INFO - Prepared state: [[ 8.34650000e+07  2.95071333e+01 -2.34278816e-03  8.41875500e+07
   2.49825479e+01]]
2024-09-20 07:26:44 - INFO - RL prediction: 84299650.0
2024-09-20 07:26:44 - INFO - Attempting prediction for arima
2024-09-20 07:26:44 - INFO - ARIMA 예측 시작
2024-09-20 07:26:44 - INFO - 입력 데이터: {'open': 83510000.0, 'high': 83530000.0, 'low': 83342000.0, 'close': 83465000.0, 'volume': 29.50713327, 'value': 2461596402.64681, 'decision': 'sell', 'sma': 84187550.0, 'ema': 84092505.72342844, 'rsi': 24.982547909616468, 'macd': -249222.11543862522, 'signal_line': -173806.4995696267, 'BB_Upper': 84924754.30682172, 'BB_Lower': 83450345.69317828}
2024-09-20 07:26:44 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:26:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84187550.0         0         0
2024-09-20 07:26:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84187550.0         0         0
2024-09-20 07:26:44 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:26:44 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:26:44 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:26:44 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:26:44 - INFO - Attempting prediction for prophet
2024-09-20 07:26:44 - INFO - PROPHET prediction: 83323878.88999584
2024-09-20 07:26:44 - INFO - Attempting prediction for transformer
2024-09-20 07:26:44 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:26:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:26:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:26:44 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:26:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:26:44 - INFO - X 샘플:
[[ 1.55838194  1.15733211  1.50939642  1.32104536 -1.18039513 -1.18103164
   1.32104536  1.32104536  0.          0.          0.          1.32104536
   1.32104536]
 [ 0.82082713  0.49124169  0.70225694  0.56775122 -0.21542414 -0.21154843
   0.56775122  0.56775122  0.          0.          0.          0.56775122
   0.56775122]
 [ 0.12133966  1.11570146  0.43321045  1.34126802 -0.26997187 -0.26612587
   1.34126802  1.34126802  0.          0.          0.          1.34126802
   1.34126802]
 [ 1.08729855  0.75027685  0.51985254  0.25935563 -1.07562487 -1.07671642
   0.25935563  0.25935563  0.          0.          0.          0.25935563
   0.25935563]
 [-0.20223277  0.58375425  0.11856286  0.12790833  1.02940734  1.03726856
   0.12790833  0.12790833  0.          0.          0.          0.12790833
   0.12790833]
 [-0.11658124 -0.36912511  0.08664209  0.09251868 -0.75780396 -0.7593534
   0.09251868  0.09251868  0.          0.          0.          0.09251868
   0.09251868]
 [ 0.2355417   0.12581708  0.48337166  0.18352065 -1.10924219 -1.11141265
   0.18352065  0.18352065  0.          0.          0.          0.18352065
   0.18352065]
 [-0.18795752 -0.52177083 -0.35112847 -0.74166611  1.06202485  1.06500171
  -0.74166611 -0.74166611  0.          0.          0.         -0.74166611
  -0.74166611]
 [-1.49176409 -1.28499945 -1.39083356 -1.08039569  1.55042665  1.54645602
  -1.08039569 -1.08039569  0.          0.          0.         -1.08039569
  -1.08039569]
 [-1.82485336 -2.04822806 -2.11133094 -2.0713061   0.96660332  0.95746211
  -2.0713061  -2.0713061   0.          0.          0.         -2.0713061
  -2.0713061 ]]
2024-09-20 07:26:44 - INFO - y 샘플:
[-2.0713061]
2024-09-20 07:26:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:26:44 - INFO - 모델 출력 (스케일링된 예측): [0.45721975]
2024-09-20 07:26:44 - INFO - 스케일러 역변환 후 예측 가격: 83965137.10720032
2024-09-20 07:26:44 - INFO - TransformerPredictor 최종 예측 가격: 83965137.10720032
2024-09-20 07:26:44 - INFO - TRANSFORMER prediction: 83965137.10720032
2024-09-20 07:26:44 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:26:44 - INFO - BITCOIN_FORECAST prediction: 83333325.58081885
2024-09-20 07:26:44 - INFO - BitcoinForecast prediction: 83333325.58081885
2024-09-20 07:26:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:26:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:26:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0055516916119206375, 'ml': 0.12184787023774155, 'xgboost': 0.022619351070151335, 'rl': 0.2541827986262316, 'lstm': 0.041009727233571484, 'arima': 0.0, 'prophet': 0.3089547295832889, 'transformer': 0.0, 'bitcoin_forecast': 0.24583383163709446}
2024-09-20 07:26:54 - INFO - 조정된 모델 가중치: {'gpt': 0.0055516916119206375, 'ml': 0.12184787023774155, 'xgboost': 0.022619351070151335, 'rl': 0.2541827986262316, 'lstm': 0.041009727233571484, 'arima': 0.0, 'prophet': 0.3089547295832889, 'transformer': 0.0, 'bitcoin_forecast': 0.24583383163709446}
2024-09-20 07:26:54 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83611258.4252508, 'current_price': 83465000.0, 'predictions': {'gpt': 83465000.0, 'ml': 83398228.0, 'xgboost': 83465000.0, 'lstm': 83909061.4696344, 'rl': 84299650.0, 'arima': 84140000.0, 'prophet': 83323878.88999584, 'transformer': 83965137.10720032, 'bitcoin_forecast': 83333325.58081885}, 'weights': {'gpt': 0.0055516916119206375, 'ml': 0.12184787023774155, 'xgboost': 0.022619351070151335, 'rl': 0.2541827986262316, 'lstm': 0.041009727233571484, 'arima': 0.0, 'prophet': 0.3089547295832889, 'transformer': 0.0, 'bitcoin_forecast': 0.24583383163709446}}
2024-09-20 07:26:54 - INFO - 모델별 가중치:
2024-09-20 07:26:54 - INFO -   - GPT: 0.0056
2024-09-20 07:26:54 - INFO -   - ML: 0.1218
2024-09-20 07:26:54 - INFO -   - XGBOOST: 0.0226
2024-09-20 07:26:54 - INFO -   - RL: 0.2542
2024-09-20 07:26:54 - INFO -   - LSTM: 0.0410
2024-09-20 07:26:54 - INFO -   - ARIMA: 0.0000
2024-09-20 07:26:54 - INFO -   - PROPHET: 0.3090
2024-09-20 07:26:54 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 07:26:54 - INFO -   - BITCOIN_FORECAST: 0.2458
2024-09-20 07:26:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:26:54 - INFO - 6. 거래 실행
2024-09-20 07:26:54 - INFO - Cancelling existing orders.
2024-09-20 07:26:54 - INFO - Cancelled 0 orders.
2024-09-20 07:26:54 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83611258.4252508, 'current_price': 83465000.0, 'predictions': {'gpt': 83465000.0, 'ml': 83398228.0, 'xgboost': 83465000.0, 'lstm': 83909061.4696344, 'rl': 84299650.0, 'arima': 84140000.0, 'prophet': 83323878.88999584, 'transformer': 83965137.10720032, 'bitcoin_forecast': 83333325.58081885}, 'weights': {'gpt': 0.0055516916119206375, 'ml': 0.12184787023774155, 'xgboost': 0.022619351070151335, 'rl': 0.2541827986262316, 'lstm': 0.041009727233571484, 'arima': 0.0, 'prophet': 0.3089547295832889, 'transformer': 0.0, 'bitcoin_forecast': 0.24583383163709446}}, 현재 가격=83465000.0
2024-09-20 07:26:54 - INFO - 현재 잔고: KRW=34091.43754657, BTC=0.00526117, 총 자산가치=473214.99159657
2024-09-20 07:26:54 - INFO - 매수 시도: 0.00040845189656227163 BTC (약 34091.43754657 KRW)
2024-09-20 07:26:54 - INFO - 주문 결과: None
2024-09-20 07:26:54 - ERROR - 주문 실패
2024-09-20 07:26:54 - WARNING - Trade execution failed: Failed to place order
2024-09-20 07:26:54 - INFO - 7. summary 리포트 보내기
2024-09-20 07:26:54 - INFO - Message sent to Discord successfully.
2024-09-20 07:26:54 - INFO - Trading cycle completed.
2024-09-20 07:26:54 - INFO - Performing periodic update.
2024-09-20 07:26:54 - INFO - 계산된 시장 변동성: 0.027523356456609166
2024-09-20 07:35:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8169-b23e-e3e8b876d004 "HTTP/1.1 200 OK"
2024-09-20 07:35:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:35:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:35:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-8fbd-c9e17101b000 "HTTP/1.1 200 OK"
2024-09-20 07:35:53 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:35:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:35:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a6-abe9-e81fd35c6218 "HTTP/1.1 200 OK"
2024-09-20 07:35:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8103-ae78-d7bedbb4f45b "HTTP/1.1 200 OK"
2024-09-20 07:36:07 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c5-8e7d-d9f854b18f08 "HTTP/1.1 200 OK"
2024-09-20 07:36:15 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-814a-9ea2-f9b5d0cf99c6 "HTTP/1.1 200 OK"
2024-09-20 07:36:27 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a68dc06e-2c5f-4b73-a91b-84e54d7ee064 "HTTP/1.1 200 OK"
2024-09-20 07:36:34 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815d-a7dc-f627eec760a7 "HTTP/1.1 200 OK"
2024-09-20 07:36:42 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:36:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d9-a09d-f4bd6c60c11d "HTTP/1.1 200 OK"
2024-09-20 07:36:54 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:25:34.965517
2024-09-20 07:36:54 - INFO - Starting trading cycle.
2024-09-20 07:36:54 - INFO - ##################################################
2024-09-20 07:36:54 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-20 07:36:54 - INFO - ##################################################
2024-09-20 07:36:54 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:36:54 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:36:54 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:20:00
2024-09-20 07:36:54 - INFO - 새로운 데이터 범위: 2024-09-18 22:20:00 ~ 2024-09-20 07:30:00
2024-09-20 07:36:54 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:36:54 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:36:54 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:36:54 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:36:54 - INFO - Sample date values: [Timestamp('2024-09-20 07:30:00')]
2024-09-20 07:36:54 - INFO - Successfully added 1 new data points
2024-09-20 07:36:54 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:36:54 - INFO - Final date range: 2024-09-20 07:30:00 to 2024-09-20 07:30:00
2024-09-20 07:36:54 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:36:54 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:30:00
2024-09-20 07:36:54 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:36:54 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:36:54 - INFO - GPT | 이전예측가격: 83465000 | 당시BTC가격: 83465000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:36:54 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-20 07:36:54 - INFO - ML | 이전예측가격: 83398228 | 당시BTC가격: 83465000 | 예측: 하락 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1168 | 반영가중치값: -0.0200 | 새 가중치: 0.0968 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-20 07:36:54 - INFO - XGBOOST | 이전예측가격: 83465000 | 당시BTC가격: 83465000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:36:54 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 3/9
2024-09-20 07:36:54 - INFO - LSTM | 이전예측가격: 83909061 | 당시BTC가격: 83465000 | 예측: 상승 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0940 | 반영가중치값: 0.0200 | 새 가중치: 0.1140 | 예측 총 횟수: 9 | 예측 성공 수: 3 | 예측 성공률: 33.33%
2024-09-20 07:36:54 - INFO - RL 모델 예측 업데이트: 정확도 53.93%, 적중/전체: 48/89
2024-09-20 07:36:54 - INFO - RL | 이전예측가격: 84299650 | 당시BTC가격: 83465000 | 예측: 상승 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0924 | 반영가중치값: 0.0200 | 새 가중치: 0.1124 | 예측 총 횟수: 89 | 예측 성공 수: 48 | 예측 성공률: 53.93%
2024-09-20 07:36:54 - INFO - ARIMA 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-20 07:36:54 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83465000 | 예측: 상승 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-20 07:36:54 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.41%, 적중/전체: 52/82
2024-09-20 07:36:55 - INFO - PROPHET | 이전예측가격: 83323879 | 당시BTC가격: 83465000 | 예측: 하락 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3113 | 반영가중치값: -0.0200 | 새 가중치: 0.2913 | 예측 총 횟수: 82 | 예측 성공 수: 52 | 예측 성공률: 63.41%
2024-09-20 07:36:55 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 45.83%, 적중/전체: 22/48
2024-09-20 07:36:55 - INFO - TRANSFORMER | 이전예측가격: 83965137 | 당시BTC가격: 83465000 | 예측: 상승 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1292 | 반영가중치값: 0.0200 | 새 가중치: 0.1492 | 예측 총 횟수: 48 | 예측 성공 수: 22 | 예측 성공률: 45.83%
2024-09-20 07:36:55 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 72.41%, 적중/전체: 21/29
2024-09-20 07:36:55 - INFO - BITCOIN_FORECAST | 이전예측가격: 83333326 | 당시BTC가격: 83465000 | 예측: 하락 | 지금 BTC가격: 83849000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2085 | 반영가중치값: -0.0200 | 새 가중치: 0.1885 | 예측 총 횟수: 29 | 예측 성공 수: 21 | 예측 성공률: 72.41%
2024-09-20 07:36:55 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:36:55 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:36:55 - INFO - 새로운 가중치: {'gpt': 0.0055495863784191515, 'ml': 0.09674910400121464, 'xgboost': 0.022610773681675272, 'rl': 0.11237212165009415, 'lstm': 0.11397515490792526, 'arima': 0.019992415884567634, 'prophet': 0.29123157168376174, 'transformer': 0.14910137685910385, 'bitcoin_forecast': 0.1884178949532383}
2024-09-20 07:36:55 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 07:36:55 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:36:55 - INFO - Current BTC price: 83849000.0
2024-09-20 07:36:55 - INFO - Analyzing market conditions.
2024-09-20 07:36:55 - INFO - Market analysis: {'current_price': 83849000.0, 'sma_20': 84141850.0, 'rsi_14': 40.894444722886135, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 07:36:55 - INFO - Starting predictions for all models
2024-09-20 07:36:55 - INFO - Attempting prediction for gpt
2024-09-20 07:36:55 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:36:55 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:36:55 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:36:55 - INFO - GPT prediction: 83849000.0
2024-09-20 07:36:55 - INFO - Attempting prediction for ml
2024-09-20 07:36:55 - INFO - ML prediction: 83815460.4
2024-09-20 07:36:55 - INFO - Attempting prediction for xgboost
2024-09-20 07:36:55 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:36:55 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:36:55 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:36:55 - INFO - XGBOOST prediction: 83849000.0
2024-09-20 07:36:55 - INFO - Attempting prediction for lstm
2024-09-20 07:36:55 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:36:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:36:55 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:36:55 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:36:55 - INFO - X 샘플:
[[ 1.15317468  0.68108802  1.03105431  0.79395869 -0.47447408 -0.47070605
   0.79395869]
 [ 0.47156359  1.35766552  0.76656646  1.65548833 -0.52947811 -0.52574092
   1.65548833]
 [ 1.41283605  0.96174239  0.85174051  0.45047302 -1.3418705  -1.3431252
   0.45047302]
 [ 0.1562605   0.78132172  0.45725017  0.30406929  0.78077058  0.78857754
   0.30406929]
 [ 0.23972308 -0.25108543  0.42587026  0.2646529  -1.02139098 -1.0231023
   0.2646529 ]
 [ 0.58284703  0.28516489  0.81587776  0.36600933 -1.37576904 -1.37811223
   0.36600933]
 [ 0.17017093 -0.41647104 -0.00448284 -0.6644477   0.81366094  0.81654313
  -0.6644477 ]
 [-1.10031505 -1.2433991  -1.02657146 -1.04171885  1.30614829  1.30203261
  -1.04171885]
 [-1.42489176 -2.07032716 -1.73486094 -2.14537774  0.7174412   0.70810222
  -2.14537774]
 [-1.66136907 -0.08569982 -1.58244422  0.01689274  1.1249617   1.12553118
   0.01689274]]
2024-09-20 07:36:55 - INFO - y 샘플:
[0.01689274]
2024-09-20 07:36:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:36:55 - INFO - 모델 출력 (스케일링된 예측): [[0.15094994]]
2024-09-20 07:36:55 - INFO - 스케일러 역변환 후 예측 가격: 83872807.36641502
2024-09-20 07:36:55 - INFO - LSTMPredictor 최종 예측 가격: 83872807.36641502
2024-09-20 07:36:55 - INFO - LSTM prediction: 83872807.36641502
2024-09-20 07:36:55 - INFO - Attempting prediction for rl
2024-09-20 07:36:55 - INFO - Preparing state for RL agent.
2024-09-20 07:36:55 - INFO - Prepared state: [[8.38490000e+07 3.36610138e+01 4.60073085e-03 8.41418500e+07
  4.08944447e+01]]
2024-09-20 07:36:55 - INFO - RL prediction: 84687490.0
2024-09-20 07:36:55 - INFO - Attempting prediction for arima
2024-09-20 07:36:55 - INFO - ARIMA 예측 시작
2024-09-20 07:36:55 - INFO - 입력 데이터: {'open': 83459000.0, 'high': 83926000.0, 'low': 83376000.0, 'close': 83849000.0, 'volume': 33.66101382, 'value': 2816879654.13375, 'decision': 'sell', 'sma': 84141850.0, 'ema': 84069314.70214954, 'rsi': 40.894444722886135, 'macd': -236443.18303130567, 'signal_line': -186333.8362619625, 'BB_Upper': 84843142.31423002, 'BB_Lower': 83440557.68576998}
2024-09-20 07:36:55 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:36:55 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84141850.0         0         0
2024-09-20 07:36:55 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84141850.0         0         0
2024-09-20 07:36:55 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:36:55 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:36:55 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:36:55 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:36:55 - INFO - Attempting prediction for prophet
2024-09-20 07:36:55 - INFO - PROPHET prediction: 83796956.6841158
2024-09-20 07:36:55 - INFO - Attempting prediction for transformer
2024-09-20 07:36:55 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:36:55 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:36:55 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:36:55 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:36:55 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:36:55 - INFO - X 샘플:
[[ 1.15317468  0.68108802  1.03105431  0.79395869 -0.47447408 -0.47070605
   0.79395869  0.79395869  0.          0.          0.          0.79395869
   0.79395869]
 [ 0.47156359  1.35766552  0.76656646  1.65548833 -0.52947811 -0.52574092
   1.65548833  1.65548833  0.          0.          0.          1.65548833
   1.65548833]
 [ 1.41283605  0.96174239  0.85174051  0.45047302 -1.3418705  -1.3431252
   0.45047302  0.45047302  0.          0.          0.          0.45047302
   0.45047302]
 [ 0.1562605   0.78132172  0.45725017  0.30406929  0.78077058  0.78857754
   0.30406929  0.30406929  0.          0.          0.          0.30406929
   0.30406929]
 [ 0.23972308 -0.25108543  0.42587026  0.2646529  -1.02139098 -1.0231023
   0.2646529   0.2646529   0.          0.          0.          0.2646529
   0.2646529 ]
 [ 0.58284703  0.28516489  0.81587776  0.36600933 -1.37576904 -1.37811223
   0.36600933  0.36600933  0.          0.          0.          0.36600933
   0.36600933]
 [ 0.17017093 -0.41647104 -0.00448284 -0.6644477   0.81366094  0.81654313
  -0.6644477  -0.6644477   0.          0.          0.         -0.6644477
  -0.6644477 ]
 [-1.10031505 -1.2433991  -1.02657146 -1.04171885  1.30614829  1.30203261
  -1.04171885 -1.04171885  0.          0.          0.         -1.04171885
  -1.04171885]
 [-1.42489176 -2.07032716 -1.73486094 -2.14537774  0.7174412   0.70810222
  -2.14537774 -2.14537774  0.          0.          0.         -2.14537774
  -2.14537774]
 [-1.66136907 -0.08569982 -1.58244422  0.01689274  1.1249617   1.12553118
   0.01689274  0.01689274  0.          0.          0.          0.01689274
   0.01689274]]
2024-09-20 07:36:55 - INFO - y 샘플:
[0.01689274]
2024-09-20 07:36:55 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:36:55 - INFO - 모델 출력 (스케일링된 예측): [0.46280542]
2024-09-20 07:36:55 - INFO - 스케일러 역변환 후 예측 가격: 83928190.12521687
2024-09-20 07:36:55 - INFO - TransformerPredictor 최종 예측 가격: 83928190.12521687
2024-09-20 07:36:55 - INFO - TRANSFORMER prediction: 83928190.12521687
2024-09-20 07:36:55 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:36:55 - INFO - BITCOIN_FORECAST prediction: 83400593.32158794
2024-09-20 07:36:55 - INFO - BitcoinForecast prediction: 83400593.32158794
2024-09-20 07:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:36:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:36:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0055495863784191515, 'ml': 0.09674910400121464, 'xgboost': 0.022610773681675272, 'rl': 0.11237212165009415, 'lstm': 0.11397515490792526, 'arima': 0.019992415884567634, 'prophet': 0.29123157168376174, 'transformer': 0.14910137685910385, 'bitcoin_forecast': 0.1884178949532383}
2024-09-20 07:36:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0055495863784191515, 'ml': 0.09674910400121464, 'xgboost': 0.022610773681675272, 'rl': 0.11237212165009415, 'lstm': 0.11397515490792526, 'arima': 0.019992415884567634, 'prophet': 0.29123157168376174, 'transformer': 0.14910137685910385, 'bitcoin_forecast': 0.1884178949532383}
2024-09-20 07:36:59 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83860672.07292485, 'current_price': 83849000.0, 'predictions': {'gpt': 83849000.0, 'ml': 83815460.4, 'xgboost': 83849000.0, 'lstm': 83872807.36641502, 'rl': 84687490.0, 'arima': 84140000.0, 'prophet': 83796956.6841158, 'transformer': 83928190.12521687, 'bitcoin_forecast': 83400593.32158794}, 'weights': {'gpt': 0.0055495863784191515, 'ml': 0.09674910400121464, 'xgboost': 0.022610773681675272, 'rl': 0.11237212165009415, 'lstm': 0.11397515490792526, 'arima': 0.019992415884567634, 'prophet': 0.29123157168376174, 'transformer': 0.14910137685910385, 'bitcoin_forecast': 0.1884178949532383}}
2024-09-20 07:36:59 - INFO - 모델별 가중치:
2024-09-20 07:36:59 - INFO -   - GPT: 0.0055
2024-09-20 07:36:59 - INFO -   - ML: 0.0967
2024-09-20 07:36:59 - INFO -   - XGBOOST: 0.0226
2024-09-20 07:36:59 - INFO -   - RL: 0.1124
2024-09-20 07:36:59 - INFO -   - LSTM: 0.1140
2024-09-20 07:36:59 - INFO -   - ARIMA: 0.0200
2024-09-20 07:36:59 - INFO -   - PROPHET: 0.2912
2024-09-20 07:36:59 - INFO -   - TRANSFORMER: 0.1491
2024-09-20 07:36:59 - INFO -   - BITCOIN_FORECAST: 0.1884
2024-09-20 07:36:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:37:00 - INFO - 6. 거래 실행
2024-09-20 07:37:00 - INFO - Cancelling existing orders.
2024-09-20 07:37:00 - INFO - Cancelled 0 orders.
2024-09-20 07:37:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83860672.07292485, 'current_price': 83849000.0, 'predictions': {'gpt': 83849000.0, 'ml': 83815460.4, 'xgboost': 83849000.0, 'lstm': 83872807.36641502, 'rl': 84687490.0, 'arima': 84140000.0, 'prophet': 83796956.6841158, 'transformer': 83928190.12521687, 'bitcoin_forecast': 83400593.32158794}, 'weights': {'gpt': 0.0055495863784191515, 'ml': 0.09674910400121464, 'xgboost': 0.022610773681675272, 'rl': 0.11237212165009415, 'lstm': 0.11397515490792526, 'arima': 0.019992415884567634, 'prophet': 0.29123157168376174, 'transformer': 0.14910137685910385, 'bitcoin_forecast': 0.1884178949532383}}, 현재 가격=83849000.0
2024-09-20 07:37:00 - INFO - 현재 잔고: KRW=34091.43754657, BTC=0.00526117, 총 자산가치=475235.28087657003
2024-09-20 07:37:00 - INFO - 매수 시도: 0.00040658132531777363 BTC (약 34091.43754657 KRW)
2024-09-20 07:37:00 - INFO - 주문 결과: None
2024-09-20 07:37:00 - ERROR - 주문 실패
2024-09-20 07:37:00 - WARNING - Trade execution failed: Failed to place order
2024-09-20 07:37:00 - INFO - 7. summary 리포트 보내기
2024-09-20 07:37:00 - INFO - Message sent to Discord successfully.
2024-09-20 07:37:00 - INFO - Trading cycle completed.
2024-09-20 07:37:00 - INFO - Performing periodic update.
2024-09-20 07:37:00 - INFO - 계산된 시장 변동성: 0.028283018887697728
2024-09-20 07:45:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:45:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-815f-bb8e-df02244e2415 "HTTP/1.1 200 OK"
2024-09-20 07:45:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:45:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:45:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8192-881e-ce4953299a80 "HTTP/1.1 200 OK"
2024-09-20 07:45:52 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:45:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/1de7f5c9-d219-4ac3-8675-d336ffdd5700 "HTTP/1.1 200 OK"
2024-09-20 07:45:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813a-96eb-c95fa71f2919 "HTTP/1.1 200 OK"
2024-09-20 07:46:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81de-a147-f63855a0f5fe "HTTP/1.1 200 OK"
2024-09-20 07:46:11 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816d-a5fb-f42494b14eb3 "HTTP/1.1 200 OK"
2024-09-20 07:46:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8163-aa56-f3ec132b1d04 "HTTP/1.1 200 OK"
2024-09-20 07:46:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e1-8385-ff10103b45d4 "HTTP/1.1 200 OK"
2024-09-20 07:46:34 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819d-90ea-ea237de374f5 "HTTP/1.1 200 OK"
2024-09-20 07:46:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:35:34.965771
2024-09-20 07:46:39 - INFO - Starting trading cycle.
2024-09-20 07:46:39 - INFO - ##################################################
2024-09-20 07:46:39 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-20 07:46:39 - INFO - ##################################################
2024-09-20 07:46:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:46:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:46:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:30:00
2024-09-20 07:46:40 - INFO - 새로운 데이터 범위: 2024-09-18 22:30:00 ~ 2024-09-20 07:40:00
2024-09-20 07:46:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:46:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:46:40 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:46:40 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:46:40 - INFO - Sample date values: [Timestamp('2024-09-20 07:40:00')]
2024-09-20 07:46:40 - INFO - Successfully added 1 new data points
2024-09-20 07:46:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:46:40 - INFO - Final date range: 2024-09-20 07:40:00 to 2024-09-20 07:40:00
2024-09-20 07:46:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:46:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:40:00
2024-09-20 07:46:40 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:46:40 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:46:40 - INFO - GPT | 이전예측가격: 83849000 | 당시BTC가격: 83849000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:46:40 - INFO - ML 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-20 07:46:40 - INFO - ML | 이전예측가격: 83815460 | 당시BTC가격: 83849000 | 예측: 하락 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1218 | 반영가중치값: 0.0200 | 새 가중치: 0.1418 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-20 07:46:40 - INFO - XGBOOST | 이전예측가격: 83849000 | 당시BTC가격: 83849000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:46:40 - INFO - LSTM 모델 예측 업데이트: 정확도 30.00%, 적중/전체: 3/10
2024-09-20 07:46:40 - INFO - LSTM | 이전예측가격: 83872807 | 당시BTC가격: 83849000 | 예측: 상승 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0410 | 반영가중치값: -0.0200 | 새 가중치: 0.0210 | 예측 총 횟수: 10 | 예측 성공 수: 3 | 예측 성공률: 30.00%
2024-09-20 07:46:40 - INFO - RL 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 48/90
2024-09-20 07:46:40 - INFO - RL | 이전예측가격: 84687490 | 당시BTC가격: 83849000 | 예측: 상승 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2542 | 반영가중치값: -0.0200 | 새 가중치: 0.2342 | 예측 총 횟수: 90 | 예측 성공 수: 48 | 예측 성공률: 53.33%
2024-09-20 07:46:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 3/9
2024-09-20 07:46:40 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83849000 | 예측: 상승 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 9 | 예측 성공 수: 3 | 예측 성공률: 33.33%
2024-09-20 07:46:40 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.86%, 적중/전체: 53/83
2024-09-20 07:46:40 - INFO - PROPHET | 이전예측가격: 83796957 | 당시BTC가격: 83849000 | 예측: 하락 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3090 | 반영가중치값: 0.0200 | 새 가중치: 0.3290 | 예측 총 횟수: 83 | 예측 성공 수: 53 | 예측 성공률: 63.86%
2024-09-20 07:46:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.90%, 적중/전체: 22/49
2024-09-20 07:46:40 - INFO - TRANSFORMER | 이전예측가격: 83928190 | 당시BTC가격: 83849000 | 예측: 상승 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 49 | 예측 성공 수: 22 | 예측 성공률: 44.90%
2024-09-20 07:46:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 73.33%, 적중/전체: 22/30
2024-09-20 07:46:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83400593 | 당시BTC가격: 83849000 | 예측: 하락 | 지금 BTC가격: 83791000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2458 | 반영가중치값: 0.0200 | 새 가중치: 0.2658 | 예측 총 횟수: 30 | 예측 성공 수: 22 | 예측 성공률: 73.33%
2024-09-20 07:46:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:46:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:46:40 - INFO - 새로운 가중치: {'gpt': 0.00544082794188951, 'ml': 0.13906799592997182, 'xgboost': 0.02216765734350863, 'rl': 0.2295933836132915, 'lstm': 0.020597987523613432, 'arima': 0.0, 'prophet': 0.32250801452401257, 'transformer': 0.0, 'bitcoin_forecast': 0.26062413312371263}
2024-09-20 07:46:40 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 07:46:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:46:40 - INFO - Current BTC price: 83790000.0
2024-09-20 07:46:40 - INFO - Analyzing market conditions.
2024-09-20 07:46:40 - INFO - Market analysis: {'current_price': 83791000.0, 'sma_20': 84101450.0, 'rsi_14': 39.53057093259926, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 07:46:40 - INFO - Starting predictions for all models
2024-09-20 07:46:40 - INFO - Attempting prediction for gpt
2024-09-20 07:46:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:46:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:46:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:46:40 - INFO - GPT prediction: 83790000.0
2024-09-20 07:46:40 - INFO - Attempting prediction for ml
2024-09-20 07:46:40 - INFO - ML prediction: 83757483.60000001
2024-09-20 07:46:40 - INFO - Attempting prediction for xgboost
2024-09-20 07:46:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:46:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:46:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:46:40 - INFO - XGBOOST prediction: 83791000.0
2024-09-20 07:46:40 - INFO - Attempting prediction for lstm
2024-09-20 07:46:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:46:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:46:40 - INFO - X 샘플:
[[ 0.68045959  1.50175991  0.95558947  1.82681485 -0.46354431 -0.45911319
   1.82681485]
 [ 1.69465413  1.09836299  1.04614408  0.58020012 -1.24893494 -1.2490192
   0.58020012]
 [ 0.3407294   0.91453655  0.62673324  0.42874226  0.80315519  0.81102139
   0.42874226]
 [ 0.43065798 -0.1373592   0.59337101  0.38796514 -0.93910731 -0.93975461
   0.38796514]
 [ 0.80036436  0.40901383  1.00801582  0.49282059 -1.28170678 -1.28283005
   0.49282059]
 [ 0.35571749 -0.30586678  0.13583192 -0.57320976  0.83495235  0.83804685
  -0.57320976]
 [-1.01319534 -1.14840464 -0.95082343 -0.96350503  1.31107074  1.30721547
  -0.96350503]
 [-1.36291759 -1.9909425  -1.70385653 -2.10526431  0.7419307   0.73325143
  -2.10526431]
 [-1.61771524  0.03114837 -1.54181143  0.13165184  1.1359063   1.13664754
   0.13165184]
 [-0.30875479 -0.37224855 -0.16919414 -0.20621571 -0.89372194 -0.89546562
  -0.20621571]]
2024-09-20 07:46:40 - INFO - y 샘플:
[-0.20621571]
2024-09-20 07:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:46:40 - INFO - 모델 출력 (스케일링된 예측): [[0.15008181]]
2024-09-20 07:46:40 - INFO - 스케일러 역변환 후 예측 가격: 83852163.78039952
2024-09-20 07:46:40 - INFO - LSTMPredictor 최종 예측 가격: 83852163.78039952
2024-09-20 07:46:40 - INFO - LSTM prediction: 83852163.78039952
2024-09-20 07:46:40 - INFO - Attempting prediction for rl
2024-09-20 07:46:40 - INFO - Preparing state for RL agent.
2024-09-20 07:46:40 - INFO - Prepared state: [[ 8.37910000e+07  1.22616346e+01 -6.91719639e-04  8.41014500e+07
   3.95305709e+01]]
2024-09-20 07:46:40 - INFO - RL prediction: 84627900.0
2024-09-20 07:46:40 - INFO - Attempting prediction for arima
2024-09-20 07:46:40 - INFO - ARIMA 예측 시작
2024-09-20 07:46:40 - INFO - 입력 데이터: {'open': 83721000.0, 'high': 83847000.0, 'low': 83664000.0, 'close': 83791000.0, 'volume': 12.26163457, 'value': 1027135653.38265, 'decision': 'sell', 'sma': 84101450.0, 'ema': 84042808.54004006, 'rsi': 39.53057093259926, 'macd': -228363.47036994994, 'signal_line': -194739.76308356, 'BB_Upper': 84785631.40138277, 'BB_Lower': 83417268.59861723}
2024-09-20 07:46:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:46:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84101450.0         0         0
2024-09-20 07:46:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84101450.0         0         0
2024-09-20 07:46:40 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:46:40 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:46:40 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:46:40 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:46:40 - INFO - Attempting prediction for prophet
2024-09-20 07:46:41 - INFO - PROPHET prediction: 83720019.0688887
2024-09-20 07:46:41 - INFO - Attempting prediction for transformer
2024-09-20 07:46:41 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:46:41 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:46:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:46:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:46:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:46:41 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:46:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:46:41 - INFO - X 샘플:
[[ 0.68045959  1.50175991  0.95558947  1.82681485 -0.46354431 -0.45911319
   1.82681485  1.82681485  0.          0.          0.          1.82681485
   1.82681485]
 [ 1.69465413  1.09836299  1.04614408  0.58020012 -1.24893494 -1.2490192
   0.58020012  0.58020012  0.          0.          0.          0.58020012
   0.58020012]
 [ 0.3407294   0.91453655  0.62673324  0.42874226  0.80315519  0.81102139
   0.42874226  0.42874226  0.          0.          0.          0.42874226
   0.42874226]
 [ 0.43065798 -0.1373592   0.59337101  0.38796514 -0.93910731 -0.93975461
   0.38796514  0.38796514  0.          0.          0.          0.38796514
   0.38796514]
 [ 0.80036436  0.40901383  1.00801582  0.49282059 -1.28170678 -1.28283005
   0.49282059  0.49282059  0.          0.          0.          0.49282059
   0.49282059]
 [ 0.35571749 -0.30586678  0.13583192 -0.57320976  0.83495235  0.83804685
  -0.57320976 -0.57320976  0.          0.          0.         -0.57320976
  -0.57320976]
 [-1.01319534 -1.14840464 -0.95082343 -0.96350503  1.31107074  1.30721547
  -0.96350503 -0.96350503  0.          0.          0.         -0.96350503
  -0.96350503]
 [-1.36291759 -1.9909425  -1.70385653 -2.10526431  0.7419307   0.73325143
  -2.10526431 -2.10526431  0.          0.          0.         -2.10526431
  -2.10526431]
 [-1.61771524  0.03114837 -1.54181143  0.13165184  1.1359063   1.13664754
   0.13165184  0.13165184  0.          0.          0.          0.13165184
   0.13165184]
 [-0.30875479 -0.37224855 -0.16919414 -0.20621571 -0.89372194 -0.89546562
  -0.20621571 -0.20621571  0.          0.          0.         -0.20621571
  -0.20621571]]
2024-09-20 07:46:41 - INFO - y 샘플:
[-0.20621571]
2024-09-20 07:46:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:46:41 - INFO - 모델 출력 (스케일링된 예측): [0.46464512]
2024-09-20 07:46:41 - INFO - 스케일러 역변환 후 예측 가격: 83906163.26048763
2024-09-20 07:46:41 - INFO - TransformerPredictor 최종 예측 가격: 83906163.26048763
2024-09-20 07:46:41 - INFO - TRANSFORMER prediction: 83906163.26048763
2024-09-20 07:46:41 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:46:41 - INFO - BITCOIN_FORECAST prediction: 83143108.4674001
2024-09-20 07:46:41 - INFO - BitcoinForecast prediction: 83143108.4674001
2024-09-20 07:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:46:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:46:47 - INFO - 조정된 모델 가중치: {'gpt': 0.00544082794188951, 'ml': 0.13906799592997182, 'xgboost': 0.02216765734350863, 'rl': 0.2295933836132915, 'lstm': 0.020597987523613432, 'arima': 0.0, 'prophet': 0.32250801452401257, 'transformer': 0.0, 'bitcoin_forecast': 0.26062413312371263}
2024-09-20 07:46:47 - INFO - 조정된 모델 가중치: {'gpt': 0.00544082794188951, 'ml': 0.13906799592997182, 'xgboost': 0.02216765734350863, 'rl': 0.2295933836132915, 'lstm': 0.020597987523613432, 'arima': 0.0, 'prophet': 0.32250801452401257, 'transformer': 0.0, 'bitcoin_forecast': 0.26062413312371263}
2024-09-20 07:46:47 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83787991.96592098, 'current_price': 83790000.0, 'predictions': {'gpt': 83790000.0, 'ml': 83757483.60000001, 'xgboost': 83791000.0, 'lstm': 83852163.78039952, 'rl': 84627900.0, 'arima': 84140000.0, 'prophet': 83720019.0688887, 'transformer': 83906163.26048763, 'bitcoin_forecast': 83143108.4674001}, 'weights': {'gpt': 0.00544082794188951, 'ml': 0.13906799592997182, 'xgboost': 0.02216765734350863, 'rl': 0.2295933836132915, 'lstm': 0.020597987523613432, 'arima': 0.0, 'prophet': 0.32250801452401257, 'transformer': 0.0, 'bitcoin_forecast': 0.26062413312371263}}
2024-09-20 07:46:47 - INFO - 모델별 가중치:
2024-09-20 07:46:47 - INFO -   - GPT: 0.0054
2024-09-20 07:46:47 - INFO -   - ML: 0.1391
2024-09-20 07:46:47 - INFO -   - XGBOOST: 0.0222
2024-09-20 07:46:47 - INFO -   - RL: 0.2296
2024-09-20 07:46:47 - INFO -   - LSTM: 0.0206
2024-09-20 07:46:47 - INFO -   - ARIMA: 0.0000
2024-09-20 07:46:47 - INFO -   - PROPHET: 0.3225
2024-09-20 07:46:47 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 07:46:47 - INFO -   - BITCOIN_FORECAST: 0.2606
2024-09-20 07:46:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:46:47 - INFO - 6. 거래 실행
2024-09-20 07:46:47 - INFO - Cancelling existing orders.
2024-09-20 07:46:47 - INFO - Cancelled 0 orders.
2024-09-20 07:46:47 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83787991.96592098, 'current_price': 83790000.0, 'predictions': {'gpt': 83790000.0, 'ml': 83757483.60000001, 'xgboost': 83791000.0, 'lstm': 83852163.78039952, 'rl': 84627900.0, 'arima': 84140000.0, 'prophet': 83720019.0688887, 'transformer': 83906163.26048763, 'bitcoin_forecast': 83143108.4674001}, 'weights': {'gpt': 0.00544082794188951, 'ml': 0.13906799592997182, 'xgboost': 0.02216765734350863, 'rl': 0.2295933836132915, 'lstm': 0.020597987523613432, 'arima': 0.0, 'prophet': 0.32250801452401257, 'transformer': 0.0, 'bitcoin_forecast': 0.26062413312371263}}, 현재 가격=83790000.0
2024-09-20 07:46:47 - INFO - 현재 잔고: KRW=34091.43754657, BTC=0.00526117, 총 자산가치=474924.87184656993
2024-09-20 07:46:47 - INFO - 매도 시도: 0.000526117 BTC (약 44083.34343 KRW)
2024-09-20 07:46:47 - INFO - 주문 결과: {'uuid': '8d240cb5-cec9-478d-881b-95aa8dbb9dbf', 'side': 'ask', 'ord_type': 'limit', 'price': '83790000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T07:46:48+09:00', 'volume': '0.00052611', 'remaining_volume': '0.00052611', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00052611', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 07:46:47 - INFO - sell 주문 성공: UUID=8d240cb5-cec9-478d-881b-95aa8dbb9dbf
2024-09-20 07:46:47 - INFO - Trade executed successfully.
2024-09-20 07:46:47 - INFO - 7. summary 리포트 보내기
2024-09-20 07:46:48 - INFO - Message sent to Discord successfully.
2024-09-20 07:46:48 - INFO - Trading cycle completed.
2024-09-20 07:46:48 - INFO - Performing periodic update.
2024-09-20 07:46:48 - INFO - 계산된 시장 변동성: 0.028273154010896008
2024-09-20 07:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:55:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e2-b8de-f52411f820de "HTTP/1.1 200 OK"
2024-09-20 07:55:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:55:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:55:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8158-a8ad-f7063ac37138 "HTTP/1.1 200 OK"
2024-09-20 07:55:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8159-99f5-f16be51e2b6c "HTTP/1.1 200 OK"
2024-09-20 07:55:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8159-9593-c0338fa4db92 "HTTP/1.1 200 OK"
2024-09-20 07:56:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a8-911e-ff8daf8ca13e "HTTP/1.1 200 OK"
2024-09-20 07:56:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c0-a977-c78bc5198075 "HTTP/1.1 200 OK"
2024-09-20 07:56:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8109-9978-ee4799d1ec56 "HTTP/1.1 200 OK"
2024-09-20 07:56:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8171-86b4-f5fb8bdc6a33 "HTTP/1.1 200 OK"
2024-09-20 07:56:33 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 07:56:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8175-818a-fcaa35a4a891 "HTTP/1.1 200 OK"
2024-09-20 07:56:41 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:45:34.965921
2024-09-20 07:56:41 - INFO - Starting trading cycle.
2024-09-20 07:56:41 - INFO - ##################################################
2024-09-20 07:56:41 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-20 07:56:41 - INFO - ##################################################
2024-09-20 07:56:41 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 07:56:41 - INFO - 데이터베이스 업데이트 시작
2024-09-20 07:56:41 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:40:00
2024-09-20 07:56:41 - INFO - 새로운 데이터 범위: 2024-09-18 22:40:00 ~ 2024-09-20 07:50:00
2024-09-20 07:56:41 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 07:56:41 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 07:56:41 - INFO - Index: Index([199], dtype='int64')
2024-09-20 07:56:41 - INFO - Date column data type: datetime64[ns]
2024-09-20 07:56:41 - INFO - Sample date values: [Timestamp('2024-09-20 07:50:00')]
2024-09-20 07:56:41 - INFO - Successfully added 1 new data points
2024-09-20 07:56:41 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 07:56:41 - INFO - Final date range: 2024-09-20 07:50:00 to 2024-09-20 07:50:00
2024-09-20 07:56:41 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 07:56:41 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 07:50:00
2024-09-20 07:56:41 - INFO - 데이터베이스 업데이트 완료
2024-09-20 07:56:41 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 07:56:41 - INFO - GPT | 이전예측가격: 83790000 | 당시BTC가격: 83790000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:56:41 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 5/10
2024-09-20 07:56:41 - INFO - ML | 이전예측가격: 83757484 | 당시BTC가격: 83790000 | 예측: 하락 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0967 | 반영가중치값: -0.0200 | 새 가중치: 0.0767 | 예측 총 횟수: 10 | 예측 성공 수: 5 | 예측 성공률: 50.00%
2024-09-20 07:56:41 - INFO - XGBOOST | 이전예측가격: 83791000 | 당시BTC가격: 83790000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 07:56:41 - INFO - LSTM 모델 예측 업데이트: 정확도 36.36%, 적중/전체: 4/11
2024-09-20 07:56:41 - INFO - LSTM | 이전예측가격: 83852164 | 당시BTC가격: 83790000 | 예측: 상승 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1140 | 반영가중치값: 0.0200 | 새 가중치: 0.1340 | 예측 총 횟수: 11 | 예측 성공 수: 4 | 예측 성공률: 36.36%
2024-09-20 07:56:41 - INFO - RL 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 49/91
2024-09-20 07:56:41 - INFO - RL | 이전예측가격: 84627900 | 당시BTC가격: 83790000 | 예측: 상승 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1124 | 반영가중치값: 0.0200 | 새 가중치: 0.1324 | 예측 총 횟수: 91 | 예측 성공 수: 49 | 예측 성공률: 53.85%
2024-09-20 07:56:41 - INFO - ARIMA 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 4/10
2024-09-20 07:56:41 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83790000 | 예측: 상승 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0200 | 반영가중치값: 0.0200 | 새 가중치: 0.0400 | 예측 총 횟수: 10 | 예측 성공 수: 4 | 예측 성공률: 40.00%
2024-09-20 07:56:41 - INFO - PROPHET 모델 예측 업데이트: 정확도 63.10%, 적중/전체: 53/84
2024-09-20 07:56:41 - INFO - PROPHET | 이전예측가격: 83720019 | 당시BTC가격: 83790000 | 예측: 하락 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2912 | 반영가중치값: -0.0200 | 새 가중치: 0.2712 | 예측 총 횟수: 84 | 예측 성공 수: 53 | 예측 성공률: 63.10%
2024-09-20 07:56:41 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 46.00%, 적중/전체: 23/50
2024-09-20 07:56:41 - INFO - TRANSFORMER | 이전예측가격: 83906163 | 당시BTC가격: 83790000 | 예측: 상승 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1491 | 반영가중치값: 0.0200 | 새 가중치: 0.1691 | 예측 총 횟수: 50 | 예측 성공 수: 23 | 예측 성공률: 46.00%
2024-09-20 07:56:41 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 70.97%, 적중/전체: 22/31
2024-09-20 07:56:41 - INFO - BITCOIN_FORECAST | 이전예측가격: 83143108 | 당시BTC가격: 83790000 | 예측: 하락 | 지금 BTC가격: 83932000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1884 | 반영가중치값: -0.0200 | 새 가중치: 0.1684 | 예측 총 횟수: 31 | 예측 성공 수: 22 | 예측 성공률: 70.97%
2024-09-20 07:56:41 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 07:56:41 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 07:56:41 - INFO - 새로운 가중치: {'gpt': 0.005337032662340771, 'ml': 0.07528495281135827, 'xgboost': 0.021744762479806865, 'rl': 0.12984684396848462, 'lstm': 0.13141929598263374, 'arima': 0.039229476120453986, 'prophet': 0.2660572568357199, 'transformer': 0.16587541109238052, 'bitcoin_forecast': 0.16520496804682144}
2024-09-20 07:56:41 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 07:56:41 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 07:56:41 - INFO - Current BTC price: 83924000.0
2024-09-20 07:56:41 - INFO - Analyzing market conditions.
2024-09-20 07:56:41 - INFO - Market analysis: {'current_price': 83932000.0, 'sma_20': 84069500.0, 'rsi_14': 44.386433819644395, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 07:56:41 - INFO - Starting predictions for all models
2024-09-20 07:56:41 - INFO - Attempting prediction for gpt
2024-09-20 07:56:42 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 07:56:42 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:56:42 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 07:56:42 - INFO - GPT prediction: 83924000.0
2024-09-20 07:56:42 - INFO - Attempting prediction for ml
2024-09-20 07:56:42 - INFO - ML prediction: 83881640.8
2024-09-20 07:56:42 - INFO - Attempting prediction for xgboost
2024-09-20 07:56:42 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 07:56:42 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:56:42 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 07:56:42 - INFO - XGBOOST prediction: 83932000.0
2024-09-20 07:56:42 - INFO - Attempting prediction for lstm
2024-09-20 07:56:42 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:56:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:56:42 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 07:56:42 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:56:42 - INFO - X 샘플:
[[ 1.81797527  1.4306318   1.16425791  0.84469205 -1.15728835 -1.15656046
   0.84469205]
 [ 0.42781924  1.21894768  0.72529177  0.66228347  0.82553179  0.83344256
   0.66228347]
 [ 0.52015433  0.00764415  0.69037401  0.61317346 -0.8579192  -0.8578103
   0.61317346]
 [ 0.89975413  0.63681637  1.1243519   0.73945633 -1.18895395 -1.18922181
   0.73945633]
 [ 0.44320842 -0.18639962  0.21150187 -0.54441946  0.85625561  0.85954921
  -0.54441946]
 [-0.9623368  -1.15661847 -0.92581949 -1.01447235  1.31630223  1.31276697
  -1.01447235]
 [-1.32141769 -2.12683732 -1.71396323 -2.38955243  0.76637399  0.75831664
  -2.38955243]
 [-1.58303377  0.20168792 -1.54436268  0.30448202  1.14705061  1.14799804
   0.30448202]
 [-0.23904528 -0.26284111 -0.10774623 -0.10242943 -0.81406585 -0.81502706
  -0.10242943]
 [-0.00307784  0.2369686   0.37611417  0.88678634 -0.89328688 -0.89345379
   0.88678634]]
2024-09-20 07:56:42 - INFO - y 샘플:
[0.88678634]
2024-09-20 07:56:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 07:56:42 - INFO - 모델 출력 (스케일링된 예측): [[0.19481972]]
2024-09-20 07:56:42 - INFO - 스케일러 역변환 후 예측 가격: 83833369.04804742
2024-09-20 07:56:42 - INFO - LSTMPredictor 최종 예측 가격: 83833369.04804742
2024-09-20 07:56:42 - INFO - LSTM prediction: 83833369.04804742
2024-09-20 07:56:42 - INFO - Attempting prediction for rl
2024-09-20 07:56:42 - INFO - Preparing state for RL agent.
2024-09-20 07:56:42 - INFO - Prepared state: [[8.39320000e+07 1.13971878e+01 1.68275829e-03 8.40695000e+07
  4.43864338e+01]]
2024-09-20 07:56:42 - INFO - RL prediction: 84763240.0
2024-09-20 07:56:42 - INFO - Attempting prediction for arima
2024-09-20 07:56:42 - INFO - ARIMA 예측 시작
2024-09-20 07:56:42 - INFO - 입력 데이터: {'open': 83767000.0, 'high': 83932000.0, 'low': 83761000.0, 'close': 83932000.0, 'volume': 11.39718782, 'value': 955631841.49838, 'decision': 'sell', 'sma': 84069500.0, 'ema': 84032255.34575053, 'rsi': 44.386433819644395, 'macd': -208182.91520367563, 'signal_line': -197428.39350758315, 'BB_Upper': 84721932.52524419, 'BB_Lower': 83417067.47475581}
2024-09-20 07:56:42 - INFO - Exogenous 변수 예측 시작
2024-09-20 07:56:42 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84069500.0         0         0
2024-09-20 07:56:42 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84069500.0         0         0
2024-09-20 07:56:42 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 07:56:42 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 07:56:42 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 07:56:42 - INFO - ARIMA prediction: 84140000.0
2024-09-20 07:56:42 - INFO - Attempting prediction for prophet
2024-09-20 07:56:42 - INFO - PROPHET prediction: 83887318.81148462
2024-09-20 07:56:42 - INFO - Attempting prediction for transformer
2024-09-20 07:56:42 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 07:56:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 07:56:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 07:56:42 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 07:56:42 - INFO - X dtype: float64, y dtype: float64
2024-09-20 07:56:42 - INFO - X 샘플:
[[ 1.81797527  1.4306318   1.16425791  0.84469205 -1.15728835 -1.15656046
   0.84469205  0.84469205  0.          0.          0.          0.84469205
   0.84469205]
 [ 0.42781924  1.21894768  0.72529177  0.66228347  0.82553179  0.83344256
   0.66228347  0.66228347  0.          0.          0.          0.66228347
   0.66228347]
 [ 0.52015433  0.00764415  0.69037401  0.61317346 -0.8579192  -0.8578103
   0.61317346  0.61317346  0.          0.          0.          0.61317346
   0.61317346]
 [ 0.89975413  0.63681637  1.1243519   0.73945633 -1.18895395 -1.18922181
   0.73945633  0.73945633  0.          0.          0.          0.73945633
   0.73945633]
 [ 0.44320842 -0.18639962  0.21150187 -0.54441946  0.85625561  0.85954921
  -0.54441946 -0.54441946  0.          0.          0.         -0.54441946
  -0.54441946]
 [-0.9623368  -1.15661847 -0.92581949 -1.01447235  1.31630223  1.31276697
  -1.01447235 -1.01447235  0.          0.          0.         -1.01447235
  -1.01447235]
 [-1.32141769 -2.12683732 -1.71396323 -2.38955243  0.76637399  0.75831664
  -2.38955243 -2.38955243  0.          0.          0.         -2.38955243
  -2.38955243]
 [-1.58303377  0.20168792 -1.54436268  0.30448202  1.14705061  1.14799804
   0.30448202  0.30448202  0.          0.          0.          0.30448202
   0.30448202]
 [-0.23904528 -0.26284111 -0.10774623 -0.10242943 -0.81406585 -0.81502706
  -0.10242943 -0.10242943  0.          0.          0.         -0.10242943
  -0.10242943]
 [-0.00307784  0.2369686   0.37611417  0.88678634 -0.89328688 -0.89345379
   0.88678634  0.88678634  0.          0.          0.          0.88678634
   0.88678634]]
2024-09-20 07:56:42 - INFO - y 샘플:
[0.88678634]
2024-09-20 07:56:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 07:56:42 - INFO - 모델 출력 (스케일링된 예측): [0.47438392]
2024-09-20 07:56:42 - INFO - 스케일러 역변환 후 예측 가격: 83873217.33347163
2024-09-20 07:56:42 - INFO - TransformerPredictor 최종 예측 가격: 83873217.33347163
2024-09-20 07:56:42 - INFO - TRANSFORMER prediction: 83873217.33347163
2024-09-20 07:56:42 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 07:56:42 - INFO - BITCOIN_FORECAST prediction: 83103471.6841531
2024-09-20 07:56:42 - INFO - BitcoinForecast prediction: 83103471.6841531
2024-09-20 07:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 07:56:48 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 07:56:48 - INFO - 조정된 모델 가중치: {'gpt': 0.005337032662340771, 'ml': 0.07528495281135827, 'xgboost': 0.021744762479806865, 'rl': 0.12984684396848462, 'lstm': 0.13141929598263374, 'arima': 0.039229476120453986, 'prophet': 0.2660572568357199, 'transformer': 0.16587541109238052, 'bitcoin_forecast': 0.16520496804682144}
2024-09-20 07:56:48 - INFO - 조정된 모델 가중치: {'gpt': 0.005337032662340771, 'ml': 0.07528495281135827, 'xgboost': 0.021744762479806865, 'rl': 0.12984684396848462, 'lstm': 0.13141929598263374, 'arima': 0.039229476120453986, 'prophet': 0.2660572568357199, 'transformer': 0.16587541109238052, 'bitcoin_forecast': 0.16520496804682144}
2024-09-20 07:56:48 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83872782.27771936, 'current_price': 83924000.0, 'predictions': {'gpt': 83924000.0, 'ml': 83881640.8, 'xgboost': 83932000.0, 'lstm': 83833369.04804742, 'rl': 84763240.0, 'arima': 84140000.0, 'prophet': 83887318.81148462, 'transformer': 83873217.33347163, 'bitcoin_forecast': 83103471.6841531}, 'weights': {'gpt': 0.005337032662340771, 'ml': 0.07528495281135827, 'xgboost': 0.021744762479806865, 'rl': 0.12984684396848462, 'lstm': 0.13141929598263374, 'arima': 0.039229476120453986, 'prophet': 0.2660572568357199, 'transformer': 0.16587541109238052, 'bitcoin_forecast': 0.16520496804682144}}
2024-09-20 07:56:48 - INFO - 모델별 가중치:
2024-09-20 07:56:48 - INFO -   - GPT: 0.0053
2024-09-20 07:56:48 - INFO -   - ML: 0.0753
2024-09-20 07:56:48 - INFO -   - XGBOOST: 0.0217
2024-09-20 07:56:48 - INFO -   - RL: 0.1298
2024-09-20 07:56:48 - INFO -   - LSTM: 0.1314
2024-09-20 07:56:48 - INFO -   - ARIMA: 0.0392
2024-09-20 07:56:48 - INFO -   - PROPHET: 0.2661
2024-09-20 07:56:48 - INFO -   - TRANSFORMER: 0.1659
2024-09-20 07:56:48 - INFO -   - BITCOIN_FORECAST: 0.1652
2024-09-20 07:56:48 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 07:56:48 - INFO - 6. 거래 실행
2024-09-20 07:56:48 - INFO - Cancelling existing orders.
2024-09-20 07:56:48 - INFO - Cancelled 0 orders.
2024-09-20 07:56:48 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83872782.27771936, 'current_price': 83924000.0, 'predictions': {'gpt': 83924000.0, 'ml': 83881640.8, 'xgboost': 83932000.0, 'lstm': 83833369.04804742, 'rl': 84763240.0, 'arima': 84140000.0, 'prophet': 83887318.81148462, 'transformer': 83873217.33347163, 'bitcoin_forecast': 83103471.6841531}, 'weights': {'gpt': 0.005337032662340771, 'ml': 0.07528495281135827, 'xgboost': 0.021744762479806865, 'rl': 0.12984684396848462, 'lstm': 0.13141929598263374, 'arima': 0.039229476120453986, 'prophet': 0.2660572568357199, 'transformer': 0.16587541109238052, 'bitcoin_forecast': 0.16520496804682144}}, 현재 가격=83924000.0
2024-09-20 07:56:48 - INFO - 현재 잔고: KRW=78152.15306812, BTC=0.00473506, 총 자산가치=475537.32850812003
2024-09-20 07:56:48 - INFO - 매도 시도: 0.000473506 BTC (약 39738.517544 KRW)
2024-09-20 07:56:48 - INFO - 주문 결과: {'uuid': 'c43bf012-843b-4f75-9c6b-bc7be4d2a078', 'side': 'ask', 'ord_type': 'limit', 'price': '83924000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T07:56:49+09:00', 'volume': '0.0004735', 'remaining_volume': '0.0004735', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0004735', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 07:56:48 - INFO - sell 주문 성공: UUID=c43bf012-843b-4f75-9c6b-bc7be4d2a078
2024-09-20 07:56:48 - INFO - Trade executed successfully.
2024-09-20 07:56:48 - INFO - 7. summary 리포트 보내기
2024-09-20 07:56:49 - INFO - Message sent to Discord successfully.
2024-09-20 07:56:49 - INFO - Trading cycle completed.
2024-09-20 07:56:49 - INFO - Performing periodic update.
2024-09-20 07:56:49 - INFO - 계산된 시장 변동성: 0.028071731027435074
2024-09-20 08:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:05:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8150-ab7b-ee1ce628f15d "HTTP/1.1 200 OK"
2024-09-20 08:05:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:05:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:05:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f2-b9a6-e22009868e88 "HTTP/1.1 200 OK"
2024-09-20 08:05:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813f-8f05-f3adb6eddc00 "HTTP/1.1 200 OK"
2024-09-20 08:06:02 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a418ecec-f7a3-4909-b759-2fa71ef7b157 "HTTP/1.1 200 OK"
2024-09-20 08:06:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a3-9361-f2d317fa76ca "HTTP/1.1 200 OK"
2024-09-20 08:06:25 - INFO - Updated actual price for rl prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b5-b125-d5de114e6314 "HTTP/1.1 200 OK"
2024-09-20 08:06:34 - INFO - Updated actual price for arima prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-819b-b1b8-e46afd90d32b "HTTP/1.1 200 OK"
2024-09-20 08:06:42 - INFO - Updated actual price for prophet prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f4-9283-c80cb6be9d62 "HTTP/1.1 200 OK"
2024-09-20 08:06:51 - INFO - Updated actual price for transformer prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:06:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e2-b80f-c4643421dff3 "HTTP/1.1 200 OK"
2024-09-20 08:06:59 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 07:55:34.966466
2024-09-20 08:06:59 - INFO - Starting trading cycle.
2024-09-20 08:06:59 - INFO - ##################################################
2024-09-20 08:06:59 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-20 08:06:59 - INFO - ##################################################
2024-09-20 08:06:59 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:06:59 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:06:59 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 07:50:00
2024-09-20 08:06:59 - INFO - 새로운 데이터 범위: 2024-09-18 22:50:00 ~ 2024-09-20 08:00:00
2024-09-20 08:06:59 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:06:59 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:06:59 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:06:59 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:06:59 - INFO - Sample date values: [Timestamp('2024-09-20 08:00:00')]
2024-09-20 08:07:00 - INFO - Successfully added 1 new data points
2024-09-20 08:07:00 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:07:00 - INFO - Final date range: 2024-09-20 08:00:00 to 2024-09-20 08:00:00
2024-09-20 08:07:00 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:07:00 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:00:00
2024-09-20 08:07:00 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:07:00 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:07:00 - INFO - GPT | 이전예측가격: 83924000 | 당시BTC가격: 83924000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:07:00 - INFO - ML 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 08:07:00 - INFO - ML | 이전예측가격: 83881641 | 당시BTC가격: 83924000 | 예측: 하락 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1391 | 반영가중치값: -0.0200 | 새 가중치: 0.1191 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 08:07:00 - INFO - XGBOOST | 이전예측가격: 83932000 | 당시BTC가격: 83924000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:07:00 - INFO - LSTM 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 4/12
2024-09-20 08:07:00 - INFO - LSTM | 이전예측가격: 83833369 | 당시BTC가격: 83924000 | 예측: 하락 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0206 | 반영가중치값: -0.0200 | 새 가중치: 0.0006 | 예측 총 횟수: 12 | 예측 성공 수: 4 | 예측 성공률: 33.33%
2024-09-20 08:07:00 - INFO - RL 모델 예측 업데이트: 정확도 54.35%, 적중/전체: 50/92
2024-09-20 08:07:00 - INFO - RL | 이전예측가격: 84763240 | 당시BTC가격: 83924000 | 예측: 상승 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2296 | 반영가중치값: 0.0200 | 새 가중치: 0.2496 | 예측 총 횟수: 92 | 예측 성공 수: 50 | 예측 성공률: 54.35%
2024-09-20 08:07:00 - INFO - ARIMA 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 08:07:00 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83924000 | 예측: 상승 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 08:07:00 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.35%, 적중/전체: 53/85
2024-09-20 08:07:00 - INFO - PROPHET | 이전예측가격: 83887319 | 당시BTC가격: 83924000 | 예측: 하락 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3225 | 반영가중치값: -0.0200 | 새 가중치: 0.3025 | 예측 총 횟수: 85 | 예측 성공 수: 53 | 예측 성공률: 62.35%
2024-09-20 08:07:00 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 45.10%, 적중/전체: 23/51
2024-09-20 08:07:00 - INFO - TRANSFORMER | 이전예측가격: 83873217 | 당시BTC가격: 83924000 | 예측: 하락 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 51 | 예측 성공 수: 23 | 예측 성공률: 45.10%
2024-09-20 08:07:00 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 68.75%, 적중/전체: 22/32
2024-09-20 08:07:00 - INFO - BITCOIN_FORECAST | 이전예측가격: 83103472 | 당시BTC가격: 83924000 | 예측: 하락 | 지금 BTC가격: 83930000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2606 | 반영가중치값: -0.0200 | 새 가중치: 0.2406 | 예측 총 횟수: 32 | 예측 성공 수: 22 | 예측 성공률: 68.75%
2024-09-20 08:07:00 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:07:00 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:07:00 - INFO - 새로운 가중치: {'gpt': 0.005562460787093281, 'ml': 0.12409724659016184, 'xgboost': 0.022663228102773783, 'rl': 0.260135827697548, 'lstm': 0.0006232456051359175, 'arima': 0.020844769515252094, 'prophet': 0.3152854919634787, 'transformer': 0.0, 'bitcoin_forecast': 0.25078772973855634}
2024-09-20 08:07:00 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:07:00 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:07:00 - INFO - Current BTC price: 83930000.0
2024-09-20 08:07:00 - INFO - Analyzing market conditions.
2024-09-20 08:07:00 - INFO - Market analysis: {'current_price': 83930000.0, 'sma_20': 84023950.0, 'rsi_14': 44.33205322409713, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:07:00 - INFO - Starting predictions for all models
2024-09-20 08:07:00 - INFO - Attempting prediction for gpt
2024-09-20 08:07:00 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:07:00 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:07:00 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:07:00 - INFO - GPT prediction: 83930000.0
2024-09-20 08:07:00 - INFO - Attempting prediction for ml
2024-09-20 08:07:00 - INFO - ML prediction: 83913214.0
2024-09-20 08:07:00 - INFO - Attempting prediction for xgboost
2024-09-20 08:07:00 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:07:00 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:07:00 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:07:00 - INFO - XGBOOST prediction: 83930000.0
2024-09-20 08:07:00 - INFO - Attempting prediction for lstm
2024-09-20 08:07:00 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:07:00 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:07:00 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:07:00 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:07:00 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:07:00 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:07:00 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:07:00 - INFO - X 샘플:
[[ 0.65506964  1.48887593  0.7742975   0.65789626  0.81556479  0.8237766
   0.65789626]
 [ 0.76578563  0.13055688  0.73835531  0.60890398 -0.94835414 -0.94841999
   0.60890398]
 [ 1.22095139  0.83609153  1.18506541  0.73488412 -1.29521215 -1.29569294
   0.73488412]
 [ 0.6735223  -0.08703792  0.24543382 -0.54591392  0.8477572   0.85113272
  -0.54591392]
 [-1.01182118 -1.17501192 -0.92525471 -1.01483997  1.32979377  1.32604157
  -1.01483997]
 [-1.44238338 -2.26298591 -1.73652132 -2.38662366  0.75357928  0.74505513
  -2.38662366]
 [-1.7560787   0.34815168 -1.56194496  0.30095254  1.15245202  1.15338677
   0.30095254]
 [-0.14454588 -0.17275708 -0.0831805  -0.10498345 -0.90240463 -0.90358913
  -0.10498345]
 [ 0.13839499  0.38771437  0.41487559  0.88186094 -0.98541237 -0.98576939
   0.88186094]
 [ 0.90110518  0.50640244  0.94887386  0.86786315 -0.76776378 -0.76592134
   0.86786315]]
2024-09-20 08:07:00 - INFO - y 샘플:
[0.86786315]
2024-09-20 08:07:00 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:07:00 - INFO - 모델 출력 (스케일링된 예측): [[0.27323553]]
2024-09-20 08:07:00 - INFO - 스케일러 역변환 후 예측 가격: 83845039.80221531
2024-09-20 08:07:00 - INFO - LSTMPredictor 최종 예측 가격: 83845039.80221531
2024-09-20 08:07:00 - INFO - LSTM prediction: 83845039.80221531
2024-09-20 08:07:00 - INFO - Attempting prediction for rl
2024-09-20 08:07:00 - INFO - Preparing state for RL agent.
2024-09-20 08:07:00 - INFO - Prepared state: [[ 8.39300000e+07  1.36637911e+01 -2.38288138e-05  8.40239500e+07
   4.43320532e+01]]
2024-09-20 08:07:00 - INFO - RL prediction: 84769300.0
2024-09-20 08:07:00 - INFO - Attempting prediction for arima
2024-09-20 08:07:00 - INFO - ARIMA 예측 시작
2024-09-20 08:07:00 - INFO - 입력 데이터: {'open': 83891000.0, 'high': 83950000.0, 'low': 83865000.0, 'close': 83930000.0, 'volume': 13.66379106, 'value': 1146918345.63643, 'decision': 'sell', 'sma': 84023950.0, 'ema': 84022516.74139333, 'rsi': 44.33205322409713, 'macd': -190159.02821925282, 'signal_line': -195974.5204499171, 'BB_Upper': 84573694.11320005, 'BB_Lower': 83474205.88679995}
2024-09-20 08:07:00 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:07:00 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84023950.0         0         0
2024-09-20 08:07:00 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84023950.0         0         0
2024-09-20 08:07:00 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:07:00 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:07:00 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:07:00 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:07:00 - INFO - Attempting prediction for prophet
2024-09-20 08:07:01 - INFO - PROPHET prediction: 83886819.74857126
2024-09-20 08:07:01 - INFO - Attempting prediction for transformer
2024-09-20 08:07:01 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:07:01 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:07:01 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:07:01 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:07:01 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:07:01 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:07:01 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:07:01 - INFO - X 샘플:
[[ 0.65506964  1.48887593  0.7742975   0.65789626  0.81556479  0.8237766
   0.65789626  0.65789626  0.          0.          0.          0.65789626
   0.65789626]
 [ 0.76578563  0.13055688  0.73835531  0.60890398 -0.94835414 -0.94841999
   0.60890398  0.60890398  0.          0.          0.          0.60890398
   0.60890398]
 [ 1.22095139  0.83609153  1.18506541  0.73488412 -1.29521215 -1.29569294
   0.73488412  0.73488412  0.          0.          0.          0.73488412
   0.73488412]
 [ 0.6735223  -0.08703792  0.24543382 -0.54591392  0.8477572   0.85113272
  -0.54591392 -0.54591392  0.          0.          0.         -0.54591392
  -0.54591392]
 [-1.01182118 -1.17501192 -0.92525471 -1.01483997  1.32979377  1.32604157
  -1.01483997 -1.01483997  0.          0.          0.         -1.01483997
  -1.01483997]
 [-1.44238338 -2.26298591 -1.73652132 -2.38662366  0.75357928  0.74505513
  -2.38662366 -2.38662366  0.          0.          0.         -2.38662366
  -2.38662366]
 [-1.7560787   0.34815168 -1.56194496  0.30095254  1.15245202  1.15338677
   0.30095254  0.30095254  0.          0.          0.          0.30095254
   0.30095254]
 [-0.14454588 -0.17275708 -0.0831805  -0.10498345 -0.90240463 -0.90358913
  -0.10498345 -0.10498345  0.          0.          0.         -0.10498345
  -0.10498345]
 [ 0.13839499  0.38771437  0.41487559  0.88186094 -0.98541237 -0.98576939
   0.88186094  0.88186094  0.          0.          0.          0.88186094
   0.88186094]
 [ 0.90110518  0.50640244  0.94887386  0.86786315 -0.76776378 -0.76592134
   0.86786315  0.86786315  0.          0.          0.          0.86786315
   0.86786315]]
2024-09-20 08:07:01 - INFO - y 샘플:
[0.86786315]
2024-09-20 08:07:01 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:07:01 - INFO - 모델 출력 (스케일링된 예측): [0.47785643]
2024-09-20 08:07:01 - INFO - 스케일러 역변환 후 예측 가격: 83874275.96849267
2024-09-20 08:07:01 - INFO - TransformerPredictor 최종 예측 가격: 83874275.96849267
2024-09-20 08:07:01 - INFO - TRANSFORMER prediction: 83874275.96849267
2024-09-20 08:07:01 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:07:01 - INFO - BITCOIN_FORECAST prediction: 83127303.84351745
2024-09-20 08:07:01 - INFO - BitcoinForecast prediction: 83127303.84351745
2024-09-20 08:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:07 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:09 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:10 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:11 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:12 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:07:13 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:07:13 - INFO - 조정된 모델 가중치: {'gpt': 0.005562460787093281, 'ml': 0.12409724659016184, 'xgboost': 0.022663228102773783, 'rl': 0.260135827697548, 'lstm': 0.0006232456051359175, 'arima': 0.020844769515252094, 'prophet': 0.3152854919634787, 'transformer': 0.0, 'bitcoin_forecast': 0.25078772973855634}
2024-09-20 08:07:13 - INFO - 조정된 모델 가중치: {'gpt': 0.005562460787093281, 'ml': 0.12409724659016184, 'xgboost': 0.022663228102773783, 'rl': 0.260135827697548, 'lstm': 0.0006232456051359175, 'arima': 0.020844769515252094, 'prophet': 0.3152854919634787, 'transformer': 0.0, 'bitcoin_forecast': 0.25078772973855634}
2024-09-20 08:07:13 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83935652.90076467, 'current_price': 83930000.0, 'predictions': {'gpt': 83930000.0, 'ml': 83913214.0, 'xgboost': 83930000.0, 'lstm': 83845039.80221531, 'rl': 84769300.0, 'arima': 84140000.0, 'prophet': 83886819.74857126, 'transformer': 83874275.96849267, 'bitcoin_forecast': 83127303.84351745}, 'weights': {'gpt': 0.005562460787093281, 'ml': 0.12409724659016184, 'xgboost': 0.022663228102773783, 'rl': 0.260135827697548, 'lstm': 0.0006232456051359175, 'arima': 0.020844769515252094, 'prophet': 0.3152854919634787, 'transformer': 0.0, 'bitcoin_forecast': 0.25078772973855634}}
2024-09-20 08:07:13 - INFO - 모델별 가중치:
2024-09-20 08:07:13 - INFO -   - GPT: 0.0056
2024-09-20 08:07:13 - INFO -   - ML: 0.1241
2024-09-20 08:07:13 - INFO -   - XGBOOST: 0.0227
2024-09-20 08:07:13 - INFO -   - RL: 0.2601
2024-09-20 08:07:13 - INFO -   - LSTM: 0.0006
2024-09-20 08:07:13 - INFO -   - ARIMA: 0.0208
2024-09-20 08:07:13 - INFO -   - PROPHET: 0.3153
2024-09-20 08:07:13 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 08:07:13 - INFO -   - BITCOIN_FORECAST: 0.2508
2024-09-20 08:07:13 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:07:13 - INFO - 6. 거래 실행
2024-09-20 08:07:13 - INFO - Cancelling existing orders.
2024-09-20 08:07:13 - INFO - Cancelled 0 orders.
2024-09-20 08:07:13 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83935652.90076467, 'current_price': 83930000.0, 'predictions': {'gpt': 83930000.0, 'ml': 83913214.0, 'xgboost': 83930000.0, 'lstm': 83845039.80221531, 'rl': 84769300.0, 'arima': 84140000.0, 'prophet': 83886819.74857126, 'transformer': 83874275.96849267, 'bitcoin_forecast': 83127303.84351745}, 'weights': {'gpt': 0.005562460787093281, 'ml': 0.12409724659016184, 'xgboost': 0.022663228102773783, 'rl': 0.260135827697548, 'lstm': 0.0006232456051359175, 'arima': 0.020844769515252094, 'prophet': 0.3152854919634787, 'transformer': 0.0, 'bitcoin_forecast': 0.25078772973855634}}, 현재 가격=83930000.0
2024-09-20 08:07:13 - INFO - 현재 잔고: KRW=117870.29806112, BTC=0.00426156, 총 자산가치=475543.02886112
2024-09-20 08:07:13 - INFO - 매수 시도: 0.0005665948157525558 BTC (약 47554.30288611201 KRW)
2024-09-20 08:07:13 - INFO - 주문 결과: {'uuid': '6c2e6187-39fb-440c-963a-5fc32513ee97', 'side': 'bid', 'ord_type': 'limit', 'price': '83930000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:07:14+09:00', 'volume': '0.00056659', 'remaining_volume': '0.00056659', 'reserved_fee': '23.77694935', 'remaining_fee': '23.77694935', 'paid_fee': '0', 'locked': '47577.67564935', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:07:13 - INFO - buy 주문 성공: UUID=6c2e6187-39fb-440c-963a-5fc32513ee97
2024-09-20 08:07:13 - INFO - Trade executed successfully.
2024-09-20 08:07:13 - INFO - 7. summary 리포트 보내기
2024-09-20 08:07:13 - INFO - Message sent to Discord successfully.
2024-09-20 08:07:13 - INFO - Trading cycle completed.
2024-09-20 08:07:13 - INFO - Performing periodic update.
2024-09-20 08:07:13 - INFO - 계산된 시장 변동성: 0.027951266144717955
2024-09-20 08:15:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:15:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8110-b211-d0ec5254d365 "HTTP/1.1 200 OK"
2024-09-20 08:15:39 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:15:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:15:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e2-ab09-c33adaf15340 "HTTP/1.1 200 OK"
2024-09-20 08:15:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:15:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:15:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-9d7b-e951fc7b1ea1 "HTTP/1.1 200 OK"
2024-09-20 08:15:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816a-ac09-d2d4cecee6db "HTTP/1.1 200 OK"
2024-09-20 08:16:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81b0-8df5-cb563a1d721b "HTTP/1.1 200 OK"
2024-09-20 08:16:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fe-ac49-fe594ed3f950 "HTTP/1.1 200 OK"
2024-09-20 08:16:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a1-9280-fbf7ce902eda "HTTP/1.1 200 OK"
2024-09-20 08:16:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81a9-9996-fedc0c1992d8 "HTTP/1.1 200 OK"
2024-09-20 08:16:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:16:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f9-b18f-f90b47a3efa6 "HTTP/1.1 200 OK"
2024-09-20 08:16:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:05:34.966577
2024-09-20 08:16:42 - INFO - Starting trading cycle.
2024-09-20 08:16:42 - INFO - ##################################################
2024-09-20 08:16:42 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-20 08:16:42 - INFO - ##################################################
2024-09-20 08:16:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:16:42 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:16:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:00:00
2024-09-20 08:16:42 - INFO - 새로운 데이터 범위: 2024-09-18 23:00:00 ~ 2024-09-20 08:10:00
2024-09-20 08:16:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:16:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:16:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:16:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:16:42 - INFO - Sample date values: [Timestamp('2024-09-20 08:10:00')]
2024-09-20 08:16:43 - INFO - Successfully added 1 new data points
2024-09-20 08:16:43 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:16:43 - INFO - Final date range: 2024-09-20 08:10:00 to 2024-09-20 08:10:00
2024-09-20 08:16:43 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:16:43 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:10:00
2024-09-20 08:16:43 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:16:43 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:16:43 - INFO - GPT | 이전예측가격: 83930000 | 당시BTC가격: 83930000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:16:43 - INFO - ML 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 08:16:43 - INFO - ML | 이전예측가격: 83913214 | 당시BTC가격: 83930000 | 예측: 하락 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0753 | 반영가중치값: -0.0200 | 새 가중치: 0.0553 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 08:16:43 - INFO - XGBOOST | 이전예측가격: 83930000 | 당시BTC가격: 83930000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:16:43 - INFO - LSTM 모델 예측 업데이트: 정확도 30.77%, 적중/전체: 4/13
2024-09-20 08:16:43 - INFO - LSTM | 이전예측가격: 83845040 | 당시BTC가격: 83930000 | 예측: 하락 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1314 | 반영가중치값: -0.0200 | 새 가중치: 0.1114 | 예측 총 횟수: 13 | 예측 성공 수: 4 | 예측 성공률: 30.77%
2024-09-20 08:16:43 - INFO - RL 모델 예측 업데이트: 정확도 54.84%, 적중/전체: 51/93
2024-09-20 08:16:43 - INFO - RL | 이전예측가격: 84769300 | 당시BTC가격: 83930000 | 예측: 상승 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1298 | 반영가중치값: 0.0200 | 새 가중치: 0.1498 | 예측 총 횟수: 93 | 예측 성공 수: 51 | 예측 성공률: 54.84%
2024-09-20 08:16:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 6/12
2024-09-20 08:16:43 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83930000 | 예측: 상승 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0392 | 반영가중치값: 0.0200 | 새 가중치: 0.0592 | 예측 총 횟수: 12 | 예측 성공 수: 6 | 예측 성공률: 50.00%
2024-09-20 08:16:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.63%, 적중/전체: 53/86
2024-09-20 08:16:43 - INFO - PROPHET | 이전예측가격: 83886820 | 당시BTC가격: 83930000 | 예측: 하락 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2661 | 반영가중치값: -0.0200 | 새 가중치: 0.2461 | 예측 총 횟수: 86 | 예측 성공 수: 53 | 예측 성공률: 61.63%
2024-09-20 08:16:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.23%, 적중/전체: 23/52
2024-09-20 08:16:43 - INFO - TRANSFORMER | 이전예측가격: 83874276 | 당시BTC가격: 83930000 | 예측: 하락 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1659 | 반영가중치값: -0.0200 | 새 가중치: 0.1459 | 예측 총 횟수: 52 | 예측 성공 수: 23 | 예측 성공률: 44.23%
2024-09-20 08:16:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 22/33
2024-09-20 08:16:43 - INFO - BITCOIN_FORECAST | 이전예측가격: 83127304 | 당시BTC가격: 83930000 | 예측: 하락 | 지금 BTC가격: 83937000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1652 | 반영가중치값: -0.0200 | 새 가중치: 0.1452 | 예측 총 횟수: 33 | 예측 성공 수: 22 | 예측 성공률: 66.67%
2024-09-20 08:16:43 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:16:43 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:16:43 - INFO - 새로운 가중치: {'gpt': 0.00591031915953156, 'ml': 0.05874229560286326, 'xgboost': 0.024080513355430457, 'rl': 0.159217782704599, 'lstm': 0.11838709970156858, 'arima': 0.06293349668837236, 'prophet': 0.26144488475178623, 'transformer': 0.15499798921447763, 'bitcoin_forecast': 0.1542856188213709}
2024-09-20 08:16:43 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:16:43 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:16:43 - INFO - Current BTC price: 83937000.0
2024-09-20 08:16:43 - INFO - Analyzing market conditions.
2024-09-20 08:16:43 - INFO - Market analysis: {'current_price': 83937000.0, 'sma_20': 83995500.0, 'rsi_14': 44.58794169327311, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:16:43 - INFO - Starting predictions for all models
2024-09-20 08:16:43 - INFO - Attempting prediction for gpt
2024-09-20 08:16:43 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:16:43 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:16:43 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:16:43 - INFO - GPT prediction: 83937000.0
2024-09-20 08:16:43 - INFO - Attempting prediction for ml
2024-09-20 08:16:43 - INFO - ML prediction: 83920212.60000001
2024-09-20 08:16:43 - INFO - Attempting prediction for xgboost
2024-09-20 08:16:43 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:16:43 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:16:43 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:16:43 - INFO - XGBOOST prediction: 83937000.0
2024-09-20 08:16:43 - INFO - Attempting prediction for lstm
2024-09-20 08:16:43 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:16:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:16:43 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:16:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:16:43 - INFO - X 샘플:
[[ 0.73541615  0.25672444  0.69609246  0.57165648 -0.70785554 -0.70752541
   0.57165648]
 [ 1.18406244  1.04835311  1.1327186   0.69518369 -1.04336122 -1.04366639
   0.69518369]
 [ 0.64447433  0.01257728  0.21429811 -0.56067628  1.02947082  1.03434194
  -0.56067628]
 [-1.0167295  -1.20815853 -0.92996347 -1.02047201  1.4957308   1.49402741
  -1.02047201]
 [-1.44112464 -2.42889433 -1.72291668 -2.36554607  0.93837526  0.93166472
  -2.36554607]
 [-1.75032681  0.5008716  -1.55228118  0.26970108  1.32419328  1.32690712
   0.26970108]
 [-0.16187643 -0.08360191 -0.10689812 -0.12833105 -0.6634099  -0.66413162
  -0.12833105]
 [ 0.1170118   0.54526199  0.37991492  0.83929877 -0.74370088 -0.74367756
   0.83929877]
 [ 0.86879748  0.67843317  0.9018588   0.82557352 -0.53317572 -0.53087682
   0.82557352]
 [ 0.82029518  0.67843317  0.98717655  0.87361188 -1.0962669  -1.0970634
   0.87361188]]
2024-09-20 08:16:43 - INFO - y 샘플:
[0.87361188]
2024-09-20 08:16:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:16:43 - INFO - 모델 출력 (스케일링된 예측): [[0.3486631]]
2024-09-20 08:16:43 - INFO - 스케일러 역변환 후 예측 가격: 83860506.09894426
2024-09-20 08:16:43 - INFO - LSTMPredictor 최종 예측 가격: 83860506.09894426
2024-09-20 08:16:43 - INFO - LSTM prediction: 83860506.09894426
2024-09-20 08:16:43 - INFO - Attempting prediction for rl
2024-09-20 08:16:43 - INFO - Preparing state for RL agent.
2024-09-20 08:16:43 - INFO - Prepared state: [[8.39370000e+07 7.60131249e+00 8.34028357e-05 8.39955000e+07
  4.45879417e+01]]
2024-09-20 08:16:43 - INFO - RL prediction: 84776370.0
2024-09-20 08:16:43 - INFO - Attempting prediction for arima
2024-09-20 08:16:43 - INFO - ARIMA 예측 시작
2024-09-20 08:16:43 - INFO - 입력 데이터: {'open': 83883000.0, 'high': 83950000.0, 'low': 83882000.0, 'close': 83937000.0, 'volume': 7.60131249, 'value': 637973435.95621, 'decision': 'sell', 'sma': 83995500.0, 'ema': 84014372.28983206, 'rsi': 44.58794169327311, 'macd': -173312.29023180902, 'signal_line': -191442.0744062955, 'BB_Upper': 84499502.57935661, 'BB_Lower': 83491497.42064339}
2024-09-20 08:16:43 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:16:43 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83995500.0         0         0
2024-09-20 08:16:43 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83995500.0         0         0
2024-09-20 08:16:43 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:16:43 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:16:43 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:16:43 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:16:43 - INFO - Attempting prediction for prophet
2024-09-20 08:16:43 - INFO - PROPHET prediction: 83892137.44773091
2024-09-20 08:16:43 - INFO - Attempting prediction for transformer
2024-09-20 08:16:43 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:16:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:16:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:16:43 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:16:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:16:43 - INFO - X 샘플:
[[ 0.73541615  0.25672444  0.69609246  0.57165648 -0.70785554 -0.70752541
   0.57165648  0.57165648  0.          0.          0.          0.57165648
   0.57165648]
 [ 1.18406244  1.04835311  1.1327186   0.69518369 -1.04336122 -1.04366639
   0.69518369  0.69518369  0.          0.          0.          0.69518369
   0.69518369]
 [ 0.64447433  0.01257728  0.21429811 -0.56067628  1.02947082  1.03434194
  -0.56067628 -0.56067628  0.          0.          0.         -0.56067628
  -0.56067628]
 [-1.0167295  -1.20815853 -0.92996347 -1.02047201  1.4957308   1.49402741
  -1.02047201 -1.02047201  0.          0.          0.         -1.02047201
  -1.02047201]
 [-1.44112464 -2.42889433 -1.72291668 -2.36554607  0.93837526  0.93166472
  -2.36554607 -2.36554607  0.          0.          0.         -2.36554607
  -2.36554607]
 [-1.75032681  0.5008716  -1.55228118  0.26970108  1.32419328  1.32690712
   0.26970108  0.26970108  0.          0.          0.          0.26970108
   0.26970108]
 [-0.16187643 -0.08360191 -0.10689812 -0.12833105 -0.6634099  -0.66413162
  -0.12833105 -0.12833105  0.          0.          0.         -0.12833105
  -0.12833105]
 [ 0.1170118   0.54526199  0.37991492  0.83929877 -0.74370088 -0.74367756
   0.83929877  0.83929877  0.          0.          0.          0.83929877
   0.83929877]
 [ 0.86879748  0.67843317  0.9018588   0.82557352 -0.53317572 -0.53087682
   0.82557352  0.82557352  0.          0.          0.          0.82557352
   0.82557352]
 [ 0.82029518  0.67843317  0.98717655  0.87361188 -1.0962669  -1.0970634
   0.87361188  0.87361188  0.          0.          0.          0.87361188
   0.87361188]]
2024-09-20 08:16:43 - INFO - y 샘플:
[0.87361188]
2024-09-20 08:16:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:16:43 - INFO - 모델 출력 (스케일링된 예측): [0.47375944]
2024-09-20 08:16:43 - INFO - 스케일러 역변환 후 예측 가격: 83878734.74927706
2024-09-20 08:16:43 - INFO - TransformerPredictor 최종 예측 가격: 83878734.74927706
2024-09-20 08:16:43 - INFO - TRANSFORMER prediction: 83878734.74927706
2024-09-20 08:16:43 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:16:43 - INFO - BITCOIN_FORECAST prediction: 83027915.43783496
2024-09-20 08:16:43 - INFO - BitcoinForecast prediction: 83027915.43783496
2024-09-20 08:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:16:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:16:51 - INFO - 조정된 모델 가중치: {'gpt': 0.00591031915953156, 'ml': 0.05874229560286326, 'xgboost': 0.024080513355430457, 'rl': 0.159217782704599, 'lstm': 0.11838709970156858, 'arima': 0.06293349668837236, 'prophet': 0.26144488475178623, 'transformer': 0.15499798921447763, 'bitcoin_forecast': 0.1542856188213709}
2024-09-20 08:16:51 - INFO - 조정된 모델 가중치: {'gpt': 0.00591031915953156, 'ml': 0.05874229560286326, 'xgboost': 0.024080513355430457, 'rl': 0.159217782704599, 'lstm': 0.11838709970156858, 'arima': 0.06293349668837236, 'prophet': 0.26144488475178623, 'transformer': 0.15499798921447763, 'bitcoin_forecast': 0.1542856188213709}
2024-09-20 08:16:51 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83912357.35284707, 'current_price': 83937000.0, 'predictions': {'gpt': 83937000.0, 'ml': 83920212.60000001, 'xgboost': 83937000.0, 'lstm': 83860506.09894426, 'rl': 84776370.0, 'arima': 84140000.0, 'prophet': 83892137.44773091, 'transformer': 83878734.74927706, 'bitcoin_forecast': 83027915.43783496}, 'weights': {'gpt': 0.00591031915953156, 'ml': 0.05874229560286326, 'xgboost': 0.024080513355430457, 'rl': 0.159217782704599, 'lstm': 0.11838709970156858, 'arima': 0.06293349668837236, 'prophet': 0.26144488475178623, 'transformer': 0.15499798921447763, 'bitcoin_forecast': 0.1542856188213709}}
2024-09-20 08:16:51 - INFO - 모델별 가중치:
2024-09-20 08:16:51 - INFO -   - GPT: 0.0059
2024-09-20 08:16:51 - INFO -   - ML: 0.0587
2024-09-20 08:16:51 - INFO -   - XGBOOST: 0.0241
2024-09-20 08:16:51 - INFO -   - RL: 0.1592
2024-09-20 08:16:51 - INFO -   - LSTM: 0.1184
2024-09-20 08:16:51 - INFO -   - ARIMA: 0.0629
2024-09-20 08:16:51 - INFO -   - PROPHET: 0.2614
2024-09-20 08:16:51 - INFO -   - TRANSFORMER: 0.1550
2024-09-20 08:16:51 - INFO -   - BITCOIN_FORECAST: 0.1543
2024-09-20 08:16:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:16:51 - INFO - 6. 거래 실행
2024-09-20 08:16:51 - INFO - Cancelling existing orders.
2024-09-20 08:16:51 - INFO - Cancelled 0 orders.
2024-09-20 08:16:51 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83912357.35284707, 'current_price': 83937000.0, 'predictions': {'gpt': 83937000.0, 'ml': 83920212.60000001, 'xgboost': 83937000.0, 'lstm': 83860506.09894426, 'rl': 84776370.0, 'arima': 84140000.0, 'prophet': 83892137.44773091, 'transformer': 83878734.74927706, 'bitcoin_forecast': 83027915.43783496}, 'weights': {'gpt': 0.00591031915953156, 'ml': 0.05874229560286326, 'xgboost': 0.024080513355430457, 'rl': 0.159217782704599, 'lstm': 0.11838709970156858, 'arima': 0.06293349668837236, 'prophet': 0.26144488475178623, 'transformer': 0.15499798921447763, 'bitcoin_forecast': 0.1542856188213709}}, 현재 가격=83937000.0
2024-09-20 08:16:51 - INFO - 현재 잔고: KRW=70292.62241177, BTC=0.00482815, 총 자산가치=475553.04896176996
2024-09-20 08:16:51 - INFO - 매도 시도: 0.000482815 BTC (약 40526.042655 KRW)
2024-09-20 08:16:51 - INFO - 주문 결과: {'uuid': 'f4f4e305-9caa-4059-b6b3-1abcc3da24ad', 'side': 'ask', 'ord_type': 'limit', 'price': '83937000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:16:52+09:00', 'volume': '0.00048281', 'remaining_volume': '0.00048281', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00048281', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:16:51 - INFO - sell 주문 성공: UUID=f4f4e305-9caa-4059-b6b3-1abcc3da24ad
2024-09-20 08:16:51 - INFO - Trade executed successfully.
2024-09-20 08:16:51 - INFO - 7. summary 리포트 보내기
2024-09-20 08:16:52 - INFO - Message sent to Discord successfully.
2024-09-20 08:16:52 - INFO - Trading cycle completed.
2024-09-20 08:16:52 - INFO - Performing periodic update.
2024-09-20 08:16:52 - INFO - 계산된 시장 변동성: 0.027947284935502085
2024-09-20 08:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:25:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816a-92db-d47dd04fe10f "HTTP/1.1 200 OK"
2024-09-20 08:25:46 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:25:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:25:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f6-944d-e6f18001ce07 "HTTP/1.1 200 OK"
2024-09-20 08:25:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:25:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81df-aab2-e491bee5f33e "HTTP/1.1 200 OK"
2024-09-20 08:26:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/9d19303a-94ce-4863-b409-bc2a10da5c1a "HTTP/1.1 200 OK"
2024-09-20 08:26:08 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8122-8ced-eaa133ae3e8c "HTTP/1.1 200 OK"
2024-09-20 08:26:15 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8167-9199-ca379df85e31 "HTTP/1.1 200 OK"
2024-09-20 08:26:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8119-b7af-c196e2950c1a "HTTP/1.1 200 OK"
2024-09-20 08:26:34 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81e0-9a25-f1c43399eb11 "HTTP/1.1 200 OK"
2024-09-20 08:26:40 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:26:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/61049985-9619-4d6f-a485-174d3a98970b "HTTP/1.1 200 OK"
2024-09-20 08:26:49 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:15:34.966793
2024-09-20 08:26:49 - INFO - Starting trading cycle.
2024-09-20 08:26:49 - INFO - ##################################################
2024-09-20 08:26:49 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-20 08:26:49 - INFO - ##################################################
2024-09-20 08:26:49 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:26:49 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:26:49 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:10:00
2024-09-20 08:26:49 - INFO - 새로운 데이터 범위: 2024-09-18 23:10:00 ~ 2024-09-20 08:20:00
2024-09-20 08:26:49 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:26:49 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:26:49 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:26:49 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:26:49 - INFO - Sample date values: [Timestamp('2024-09-20 08:20:00')]
2024-09-20 08:26:49 - INFO - Successfully added 1 new data points
2024-09-20 08:26:49 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:26:49 - INFO - Final date range: 2024-09-20 08:20:00 to 2024-09-20 08:20:00
2024-09-20 08:26:49 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:26:49 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:20:00
2024-09-20 08:26:49 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:26:49 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:26:49 - INFO - GPT | 이전예측가격: 83937000 | 당시BTC가격: 83937000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:26:49 - INFO - ML 모델 예측 업데이트: 정확도 38.46%, 적중/전체: 5/13
2024-09-20 08:26:49 - INFO - ML | 이전예측가격: 83920213 | 당시BTC가격: 83937000 | 예측: 하락 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1241 | 반영가중치값: -0.0200 | 새 가중치: 0.1041 | 예측 총 횟수: 13 | 예측 성공 수: 5 | 예측 성공률: 38.46%
2024-09-20 08:26:49 - INFO - XGBOOST | 이전예측가격: 83937000 | 당시BTC가격: 83937000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:26:49 - INFO - LSTM 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 4/14
2024-09-20 08:26:49 - INFO - LSTM | 이전예측가격: 83860506 | 당시BTC가격: 83937000 | 예측: 하락 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0006 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 14 | 예측 성공 수: 4 | 예측 성공률: 28.57%
2024-09-20 08:26:49 - INFO - RL 모델 예측 업데이트: 정확도 55.32%, 적중/전체: 52/94
2024-09-20 08:26:50 - INFO - RL | 이전예측가격: 84776370 | 당시BTC가격: 83937000 | 예측: 상승 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2601 | 반영가중치값: 0.0200 | 새 가중치: 0.2801 | 예측 총 횟수: 94 | 예측 성공 수: 52 | 예측 성공률: 55.32%
2024-09-20 08:26:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 7/13
2024-09-20 08:26:50 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83937000 | 예측: 상승 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0208 | 반영가중치값: 0.0200 | 새 가중치: 0.0408 | 예측 총 횟수: 13 | 예측 성공 수: 7 | 예측 성공률: 53.85%
2024-09-20 08:26:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.92%, 적중/전체: 53/87
2024-09-20 08:26:50 - INFO - PROPHET | 이전예측가격: 83892137 | 당시BTC가격: 83937000 | 예측: 하락 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3153 | 반영가중치값: -0.0200 | 새 가중치: 0.2953 | 예측 총 횟수: 87 | 예측 성공 수: 53 | 예측 성공률: 60.92%
2024-09-20 08:26:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 43.40%, 적중/전체: 23/53
2024-09-20 08:26:50 - INFO - TRANSFORMER | 이전예측가격: 83878735 | 당시BTC가격: 83937000 | 예측: 하락 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0000 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 53 | 예측 성공 수: 23 | 예측 성공률: 43.40%
2024-09-20 08:26:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 64.71%, 적중/전체: 22/34
2024-09-20 08:26:50 - INFO - BITCOIN_FORECAST | 이전예측가격: 83027915 | 당시BTC가격: 83937000 | 예측: 하락 | 지금 BTC가격: 84100000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2508 | 반영가중치값: -0.0200 | 새 가중치: 0.2308 | 예측 총 횟수: 34 | 예측 성공 수: 22 | 예측 성공률: 64.71%
2024-09-20 08:26:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:26:50 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:26:50 - INFO - 새로운 가중치: {'gpt': 0.006023918835246121, 'ml': 0.10609805452222593, 'xgboost': 0.024543354436322926, 'rl': 0.2855201966839758, 'lstm': 0.0, 'arima': 0.041629829077405485, 'prophet': 0.3009610460621383, 'transformer': 0.0, 'bitcoin_forecast': 0.23522360038268544}
2024-09-20 08:26:50 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:26:50 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:26:50 - INFO - Current BTC price: 84100000.0
2024-09-20 08:26:50 - INFO - Analyzing market conditions.
2024-09-20 08:26:50 - INFO - Market analysis: {'current_price': 84100000.0, 'sma_20': 83976550.0, 'rsi_14': 50.31515903751961, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:26:50 - INFO - Starting predictions for all models
2024-09-20 08:26:50 - INFO - Attempting prediction for gpt
2024-09-20 08:26:50 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:26:50 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:26:50 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:26:50 - INFO - GPT prediction: 84100000.0
2024-09-20 08:26:50 - INFO - Attempting prediction for ml
2024-09-20 08:26:50 - INFO - ML prediction: 83948620.0
2024-09-20 08:26:50 - INFO - Attempting prediction for xgboost
2024-09-20 08:26:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:26:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:26:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:26:50 - INFO - XGBOOST prediction: 84100000.0
2024-09-20 08:26:50 - INFO - Attempting prediction for lstm
2024-09-20 08:26:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:26:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:26:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:26:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:26:50 - INFO - X 샘플:
[[ 1.01967738  0.73305048  0.95716945  0.47711155 -1.18145951 -1.18243867
   0.47711155]
 [ 0.52159129 -0.14410394  0.11585336 -0.60615661  0.94158052  0.94513363
  -0.60615661]
 [-1.01184232 -1.17789307 -0.93234373 -1.00276298  1.41913421  1.41578336
  -1.00276298]
 [-1.40359543 -2.2116822  -1.65872593 -2.1629846   0.84827844  0.84000738
  -2.1629846 ]
 [-1.68901556  0.26941171 -1.50241584  0.11010266  1.24344172  1.24467697
   0.11010266]
 [-0.22273963 -0.22555399 -0.1783774  -0.23322822 -0.79230505 -0.79385137
  -0.23322822]
 [ 0.03469813  0.30700405  0.2675661   0.60142101 -0.87454083 -0.87529461
   0.60142101]
 [ 0.72866079  0.41978104  0.74569109  0.58958201 -0.65891634 -0.65741822
   0.58958201]
 [ 0.683889    0.41978104  0.82384614  0.6310185  -1.23564667 -1.23710929
   0.6310185 ]
 [ 1.33867635  1.61020489  1.36173675  1.59589669  0.2904335   0.30051082
   1.59589669]]
2024-09-20 08:26:50 - INFO - y 샘플:
[1.59589669]
2024-09-20 08:26:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:26:50 - INFO - 모델 출력 (스케일링된 예측): [[0.40841433]]
2024-09-20 08:26:50 - INFO - 스케일러 역변환 후 예측 가격: 83899394.75722644
2024-09-20 08:26:50 - INFO - LSTMPredictor 최종 예측 가격: 83899394.75722644
2024-09-20 08:26:50 - INFO - LSTM prediction: 83899394.75722644
2024-09-20 08:26:50 - INFO - Attempting prediction for rl
2024-09-20 08:26:50 - INFO - Preparing state for RL agent.
2024-09-20 08:26:50 - INFO - Prepared state: [[8.41000000e+07 2.36431743e+01 1.94193264e-03 8.39765500e+07
  5.03151590e+01]]
2024-09-20 08:26:50 - INFO - RL prediction: 84941000.0
2024-09-20 08:26:50 - INFO - Attempting prediction for arima
2024-09-20 08:26:50 - INFO - ARIMA 예측 시작
2024-09-20 08:26:50 - INFO - 입력 데이터: {'open': 84000000.0, 'high': 84140000.0, 'low': 83999000.0, 'close': 84100000.0, 'volume': 23.64317431, 'value': 1987940626.16624, 'decision': 'sell', 'sma': 83976550.0, 'ema': 84022527.30984804, 'rsi': 50.31515903751961, 'macd': -145135.36115068197, 'signal_line': -182180.7317551728, 'BB_Upper': 84432633.09549698, 'BB_Lower': 83520466.90450302}
2024-09-20 08:26:50 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:26:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83976550.0         0         0
2024-09-20 08:26:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83976550.0         0         0
2024-09-20 08:26:50 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:26:50 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:26:50 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:26:50 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:26:50 - INFO - Attempting prediction for prophet
2024-09-20 08:26:50 - INFO - PROPHET prediction: 84095656.81933595
2024-09-20 08:26:50 - INFO - Attempting prediction for transformer
2024-09-20 08:26:50 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:26:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:26:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:26:50 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:26:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:26:50 - INFO - X 샘플:
[[ 1.01967738  0.73305048  0.95716945  0.47711155 -1.18145951 -1.18243867
   0.47711155  0.47711155  0.          0.          0.          0.47711155
   0.47711155]
 [ 0.52159129 -0.14410394  0.11585336 -0.60615661  0.94158052  0.94513363
  -0.60615661 -0.60615661  0.          0.          0.         -0.60615661
  -0.60615661]
 [-1.01184232 -1.17789307 -0.93234373 -1.00276298  1.41913421  1.41578336
  -1.00276298 -1.00276298  0.          0.          0.         -1.00276298
  -1.00276298]
 [-1.40359543 -2.2116822  -1.65872593 -2.1629846   0.84827844  0.84000738
  -2.1629846  -2.1629846   0.          0.          0.         -2.1629846
  -2.1629846 ]
 [-1.68901556  0.26941171 -1.50241584  0.11010266  1.24344172  1.24467697
   0.11010266  0.11010266  0.          0.          0.          0.11010266
   0.11010266]
 [-0.22273963 -0.22555399 -0.1783774  -0.23322822 -0.79230505 -0.79385137
  -0.23322822 -0.23322822  0.          0.          0.         -0.23322822
  -0.23322822]
 [ 0.03469813  0.30700405  0.2675661   0.60142101 -0.87454083 -0.87529461
   0.60142101  0.60142101  0.          0.          0.          0.60142101
   0.60142101]
 [ 0.72866079  0.41978104  0.74569109  0.58958201 -0.65891634 -0.65741822
   0.58958201  0.58958201  0.          0.          0.          0.58958201
   0.58958201]
 [ 0.683889    0.41978104  0.82384614  0.6310185  -1.23564667 -1.23710929
   0.6310185   0.6310185   0.          0.          0.          0.6310185
   0.6310185 ]
 [ 1.33867635  1.61020489  1.36173675  1.59589669  0.2904335   0.30051082
   1.59589669  1.59589669  0.          0.          0.          1.59589669
   1.59589669]]
2024-09-20 08:26:50 - INFO - y 샘플:
[1.59589669]
2024-09-20 08:26:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:26:50 - INFO - 모델 출력 (스케일링된 예측): [0.47196332]
2024-09-20 08:26:50 - INFO - 스케일러 역변환 후 예측 가격: 83910130.29275821
2024-09-20 08:26:50 - INFO - TransformerPredictor 최종 예측 가격: 83910130.29275821
2024-09-20 08:26:50 - INFO - TRANSFORMER prediction: 83910130.29275821
2024-09-20 08:26:50 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:26:50 - INFO - BITCOIN_FORECAST prediction: 83272531.28074102
2024-09-20 08:26:50 - INFO - BitcoinForecast prediction: 83272531.28074102
2024-09-20 08:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:26:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:26:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:27:02 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:27:03 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:27:04 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:27:08 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:27:08 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:27:08 - INFO - 조정된 모델 가중치: {'gpt': 0.006023918835246121, 'ml': 0.10609805452222593, 'xgboost': 0.024543354436322926, 'rl': 0.2855201966839758, 'lstm': 0.0, 'arima': 0.041629829077405485, 'prophet': 0.3009610460621383, 'transformer': 0.0, 'bitcoin_forecast': 0.23522360038268544}
2024-09-20 08:27:08 - INFO - 조정된 모델 가중치: {'gpt': 0.006023918835246121, 'ml': 0.10609805452222593, 'xgboost': 0.024543354436322926, 'rl': 0.2855201966839758, 'lstm': 0.0, 'arima': 0.041629829077405485, 'prophet': 0.3009610460621383, 'transformer': 0.0, 'bitcoin_forecast': 0.23522360038268544}
2024-09-20 08:27:08 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84129779.2555367, 'current_price': 84100000.0, 'predictions': {'gpt': 84100000.0, 'ml': 83948620.0, 'xgboost': 84100000.0, 'lstm': 83899394.75722644, 'rl': 84941000.0, 'arima': 84140000.0, 'prophet': 84095656.81933595, 'transformer': 83910130.29275821, 'bitcoin_forecast': 83272531.28074102}, 'weights': {'gpt': 0.006023918835246121, 'ml': 0.10609805452222593, 'xgboost': 0.024543354436322926, 'rl': 0.2855201966839758, 'lstm': 0.0, 'arima': 0.041629829077405485, 'prophet': 0.3009610460621383, 'transformer': 0.0, 'bitcoin_forecast': 0.23522360038268544}}
2024-09-20 08:27:08 - INFO - 모델별 가중치:
2024-09-20 08:27:08 - INFO -   - GPT: 0.0060
2024-09-20 08:27:08 - INFO -   - ML: 0.1061
2024-09-20 08:27:08 - INFO -   - XGBOOST: 0.0245
2024-09-20 08:27:08 - INFO -   - RL: 0.2855
2024-09-20 08:27:08 - INFO -   - LSTM: 0.0000
2024-09-20 08:27:08 - INFO -   - ARIMA: 0.0416
2024-09-20 08:27:08 - INFO -   - PROPHET: 0.3010
2024-09-20 08:27:08 - INFO -   - TRANSFORMER: 0.0000
2024-09-20 08:27:08 - INFO -   - BITCOIN_FORECAST: 0.2352
2024-09-20 08:27:08 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:27:08 - INFO - 6. 거래 실행
2024-09-20 08:27:08 - INFO - Cancelling existing orders.
2024-09-20 08:27:08 - INFO - Cancelled 0 orders.
2024-09-20 08:27:08 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84129779.2555367, 'current_price': 84100000.0, 'predictions': {'gpt': 84100000.0, 'ml': 83948620.0, 'xgboost': 84100000.0, 'lstm': 83899394.75722644, 'rl': 84941000.0, 'arima': 84140000.0, 'prophet': 84095656.81933595, 'transformer': 83910130.29275821, 'bitcoin_forecast': 83272531.28074102}, 'weights': {'gpt': 0.006023918835246121, 'ml': 0.10609805452222593, 'xgboost': 0.024543354436322926, 'rl': 0.2855201966839758, 'lstm': 0.0, 'arima': 0.041629829077405485, 'prophet': 0.3009610460621383, 'transformer': 0.0, 'bitcoin_forecast': 0.23522360038268544}}, 현재 가격=84100000.0
2024-09-20 08:27:08 - INFO - 현재 잔고: KRW=110799.43027607, BTC=0.00434534, 총 자산가치=476242.52427606995
2024-09-20 08:27:08 - INFO - 매수 시도: 0.0005662812417075743 BTC (약 47624.252427606996 KRW)
2024-09-20 08:27:08 - INFO - 주문 결과: {'uuid': 'aa434132-4a8b-43d7-a6fc-1329761bafbd', 'side': 'bid', 'ord_type': 'limit', 'price': '84100000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:27:09+09:00', 'volume': '0.00056628', 'remaining_volume': '0.00056628', 'reserved_fee': '23.812074', 'remaining_fee': '23.812074', 'paid_fee': '0', 'locked': '47647.960074', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:27:08 - INFO - buy 주문 성공: UUID=aa434132-4a8b-43d7-a6fc-1329761bafbd
2024-09-20 08:27:08 - INFO - Trade executed successfully.
2024-09-20 08:27:08 - INFO - 7. summary 리포트 보내기
2024-09-20 08:27:09 - INFO - Message sent to Discord successfully.
2024-09-20 08:27:09 - INFO - Trading cycle completed.
2024-09-20 08:27:09 - INFO - Performing periodic update.
2024-09-20 08:27:09 - INFO - 계산된 시장 변동성: 0.02786190944960705
2024-09-20 08:35:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ec-ba7a-ca7bed928a75 "HTTP/1.1 200 OK"
2024-09-20 08:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:35:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ce-9aef-f8bd284c397e "HTTP/1.1 200 OK"
2024-09-20 08:35:54 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:35:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81cb-8475-e1a90cadb7a9 "HTTP/1.1 200 OK"
2024-09-20 08:36:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7d58de23-1ae8-4dc4-88c9-c614ab41dc3d "HTTP/1.1 200 OK"
2024-09-20 08:36:06 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81db-a965-e04a31589301 "HTTP/1.1 200 OK"
2024-09-20 08:36:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8184-bd2f-e52587b1e53d "HTTP/1.1 200 OK"
2024-09-20 08:36:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-818e-81d8-cfae29d2f54d "HTTP/1.1 200 OK"
2024-09-20 08:36:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81fe-98e3-df7ba053fe55 "HTTP/1.1 200 OK"
2024-09-20 08:36:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8141-8cbd-fd2297fb0cc6 "HTTP/1.1 200 OK"
2024-09-20 08:36:40 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:25:34.966955
2024-09-20 08:36:40 - INFO - Starting trading cycle.
2024-09-20 08:36:40 - INFO - ##################################################
2024-09-20 08:36:40 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-20 08:36:40 - INFO - ##################################################
2024-09-20 08:36:40 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:36:40 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:36:40 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:20:00
2024-09-20 08:36:40 - INFO - 새로운 데이터 범위: 2024-09-18 23:20:00 ~ 2024-09-20 08:30:00
2024-09-20 08:36:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:36:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:36:40 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:36:40 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:36:40 - INFO - Sample date values: [Timestamp('2024-09-20 08:30:00')]
2024-09-20 08:36:40 - INFO - Successfully added 1 new data points
2024-09-20 08:36:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:36:40 - INFO - Final date range: 2024-09-20 08:30:00 to 2024-09-20 08:30:00
2024-09-20 08:36:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:36:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:30:00
2024-09-20 08:36:40 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:36:40 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:36:40 - INFO - GPT | 이전예측가격: 84100000 | 당시BTC가격: 84100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:36:40 - INFO - ML 모델 예측 업데이트: 정확도 35.71%, 적중/전체: 5/14
2024-09-20 08:36:40 - INFO - ML | 이전예측가격: 83948620 | 당시BTC가격: 84100000 | 예측: 하락 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0587 | 반영가중치값: -0.0200 | 새 가중치: 0.0387 | 예측 총 횟수: 14 | 예측 성공 수: 5 | 예측 성공률: 35.71%
2024-09-20 08:36:40 - INFO - XGBOOST | 이전예측가격: 84100000 | 당시BTC가격: 84100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:36:40 - INFO - LSTM 모델 예측 업데이트: 정확도 26.67%, 적중/전체: 4/15
2024-09-20 08:36:40 - INFO - LSTM | 이전예측가격: 83899395 | 당시BTC가격: 84100000 | 예측: 하락 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1184 | 반영가중치값: -0.0200 | 새 가중치: 0.0984 | 예측 총 횟수: 15 | 예측 성공 수: 4 | 예측 성공률: 26.67%
2024-09-20 08:36:40 - INFO - RL 모델 예측 업데이트: 정확도 55.79%, 적중/전체: 53/95
2024-09-20 08:36:40 - INFO - RL | 이전예측가격: 84941000 | 당시BTC가격: 84100000 | 예측: 상승 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1592 | 반영가중치값: 0.0200 | 새 가중치: 0.1792 | 예측 총 횟수: 95 | 예측 성공 수: 53 | 예측 성공률: 55.79%
2024-09-20 08:36:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 8/14
2024-09-20 08:36:40 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84100000 | 예측: 상승 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0629 | 반영가중치값: 0.0200 | 새 가중치: 0.0829 | 예측 총 횟수: 14 | 예측 성공 수: 8 | 예측 성공률: 57.14%
2024-09-20 08:36:40 - INFO - PROPHET | 이전예측가격: 84095657 | 당시BTC가격: 84100000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:36:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 42.59%, 적중/전체: 23/54
2024-09-20 08:36:40 - INFO - TRANSFORMER | 이전예측가격: 83910130 | 당시BTC가격: 84100000 | 예측: 하락 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1550 | 반영가중치값: -0.0200 | 새 가중치: 0.1350 | 예측 총 횟수: 54 | 예측 성공 수: 23 | 예측 성공률: 42.59%
2024-09-20 08:36:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 62.86%, 적중/전체: 22/35
2024-09-20 08:36:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83272531 | 당시BTC가격: 84100000 | 예측: 하락 | 지금 BTC가격: 84106000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1543 | 반영가중치값: -0.0200 | 새 가중치: 0.1343 | 예측 총 횟수: 35 | 예측 성공 수: 22 | 예측 성공률: 62.86%
2024-09-20 08:36:41 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:36:41 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:36:41 - INFO - 새로운 가중치: {'gpt': 0.006023361059561964, 'ml': 0.03873870831840164, 'xgboost': 0.024541081881415294, 'rl': 0.17920118830416049, 'lstm': 0.0983779896963794, 'arima': 0.08292581758625961, 'prophet': 0.30093317902774375, 'transformer': 0.1349854892791609, 'bitcoin_forecast': 0.1342731848469169}
2024-09-20 08:36:41 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:36:41 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:36:41 - INFO - Current BTC price: 84106000.0
2024-09-20 08:36:41 - INFO - Analyzing market conditions.
2024-09-20 08:36:41 - INFO - Market analysis: {'current_price': 84106000.0, 'sma_20': 83962800.0, 'rsi_14': 50.51789736397843, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:36:41 - INFO - Starting predictions for all models
2024-09-20 08:36:41 - INFO - Attempting prediction for gpt
2024-09-20 08:36:41 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:36:41 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:36:41 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:36:41 - INFO - GPT prediction: 84106000.0
2024-09-20 08:36:41 - INFO - Attempting prediction for ml
2024-09-20 08:36:41 - INFO - ML prediction: 84106000.0
2024-09-20 08:36:41 - INFO - Attempting prediction for xgboost
2024-09-20 08:36:41 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:36:41 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:36:41 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:36:41 - INFO - XGBOOST prediction: 84106000.0
2024-09-20 08:36:41 - INFO - Attempting prediction for lstm
2024-09-20 08:36:41 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:36:41 - INFO - X 샘플:
[[ 0.38651348 -0.21500552  0.02650095 -0.65061616  0.94216074  0.94576157
  -0.65061616]
 [-0.9835343  -1.15352166 -0.91759528 -1.00821487  1.42331023  1.42007156
  -1.00821487]
 [-1.33354651 -2.09203781 -1.57183739 -2.05432453  0.84815613  0.83981776
  -2.05432453]
 [-1.5885554   0.16040094 -1.43105112 -0.00480356  1.24629484  1.24763447
  -0.00480356]
 [-0.27850971 -0.28894921 -0.23850852 -0.31436663 -0.80478033 -0.80674753
  -0.31436663]
 [-0.04850169  0.1945288   0.16314645  0.43819185 -0.88763531 -0.88882416
   0.43819185]
 [ 0.57151993  0.29691238  0.59378683  0.42751726 -0.67038725 -0.66925334
   0.42751726]
 [ 0.53151854  0.29691238  0.66417997  0.46487832 -1.25146015 -1.25345268
   0.46487832]
 [ 1.11653894  1.37762794  1.1486504   1.33485727  0.28611083  0.29612553
   1.33485727]
 [ 1.62655673  1.42313175  1.56272769  1.36688104 -1.13176972 -1.13113317
   1.36688104]]
2024-09-20 08:36:41 - INFO - y 샘플:
[1.36688104]
2024-09-20 08:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:36:41 - INFO - 모델 출력 (스케일링된 예측): [[0.4648742]]
2024-09-20 08:36:41 - INFO - 스케일러 역변환 후 예측 가격: 83936999.22909032
2024-09-20 08:36:41 - INFO - LSTMPredictor 최종 예측 가격: 83936999.22909032
2024-09-20 08:36:41 - INFO - LSTM prediction: 83936999.22909032
2024-09-20 08:36:41 - INFO - Attempting prediction for rl
2024-09-20 08:36:41 - INFO - Preparing state for RL agent.
2024-09-20 08:36:41 - INFO - Prepared state: [[8.41060000e+07 8.85007263e+00 7.13436385e-05 8.39628000e+07
  5.05178974e+01]]
2024-09-20 08:36:41 - INFO - RL prediction: 84947060.0
2024-09-20 08:36:41 - INFO - Attempting prediction for arima
2024-09-20 08:36:41 - INFO - ARIMA 예측 시작
2024-09-20 08:36:41 - INFO - 입력 데이터: {'open': 84102000.0, 'high': 84148000.0, 'low': 84099000.0, 'close': 84106000.0, 'volume': 8.85007263, 'value': 744536187.56513, 'decision': 'sell', 'sma': 83962800.0, 'ema': 84030477.08986251, 'rsi': 50.51789736397843, 'macd': -120926.8228546381, 'signal_line': -169929.9499750659, 'BB_Upper': 84384571.31244506, 'BB_Lower': 83541028.68755494}
2024-09-20 08:36:41 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:36:41 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83962800.0         0         0
2024-09-20 08:36:41 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83962800.0         0         0
2024-09-20 08:36:41 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:36:41 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:36:41 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:36:41 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:36:41 - INFO - Attempting prediction for prophet
2024-09-20 08:36:41 - INFO - PROPHET prediction: 84094600.88160829
2024-09-20 08:36:41 - INFO - Attempting prediction for transformer
2024-09-20 08:36:41 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:36:41 - INFO - X 샘플:
[[ 0.38651348 -0.21500552  0.02650095 -0.65061616  0.94216074  0.94576157
  -0.65061616 -0.65061616  0.          0.          0.         -0.65061616
  -0.65061616]
 [-0.9835343  -1.15352166 -0.91759528 -1.00821487  1.42331023  1.42007156
  -1.00821487 -1.00821487  0.          0.          0.         -1.00821487
  -1.00821487]
 [-1.33354651 -2.09203781 -1.57183739 -2.05432453  0.84815613  0.83981776
  -2.05432453 -2.05432453  0.          0.          0.         -2.05432453
  -2.05432453]
 [-1.5885554   0.16040094 -1.43105112 -0.00480356  1.24629484  1.24763447
  -0.00480356 -0.00480356  0.          0.          0.         -0.00480356
  -0.00480356]
 [-0.27850971 -0.28894921 -0.23850852 -0.31436663 -0.80478033 -0.80674753
  -0.31436663 -0.31436663  0.          0.          0.         -0.31436663
  -0.31436663]
 [-0.04850169  0.1945288   0.16314645  0.43819185 -0.88763531 -0.88882416
   0.43819185  0.43819185  0.          0.          0.          0.43819185
   0.43819185]
 [ 0.57151993  0.29691238  0.59378683  0.42751726 -0.67038725 -0.66925334
   0.42751726  0.42751726  0.          0.          0.          0.42751726
   0.42751726]
 [ 0.53151854  0.29691238  0.66417997  0.46487832 -1.25146015 -1.25345268
   0.46487832  0.46487832  0.          0.          0.          0.46487832
   0.46487832]
 [ 1.11653894  1.37762794  1.1486504   1.33485727  0.28611083  0.29612553
   1.33485727  1.33485727  0.          0.          0.          1.33485727
   1.33485727]
 [ 1.62655673  1.42313175  1.56272769  1.36688104 -1.13176972 -1.13113317
   1.36688104  1.36688104  0.          0.          0.          1.36688104
   1.36688104]]
2024-09-20 08:36:41 - INFO - y 샘플:
[1.36688104]
2024-09-20 08:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:36:41 - INFO - 모델 출력 (스케일링된 예측): [0.4707177]
2024-09-20 08:36:41 - INFO - 스케일러 역변환 후 예측 가격: 83938094.07044096
2024-09-20 08:36:41 - INFO - TransformerPredictor 최종 예측 가격: 83938094.07044096
2024-09-20 08:36:41 - INFO - TRANSFORMER prediction: 83938094.07044096
2024-09-20 08:36:41 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:36:41 - INFO - BITCOIN_FORECAST prediction: 83085198.96893077
2024-09-20 08:36:41 - INFO - BitcoinForecast prediction: 83085198.96893077
2024-09-20 08:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:36:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:36:51 - INFO - 조정된 모델 가중치: {'gpt': 0.006023361059561964, 'ml': 0.03873870831840164, 'xgboost': 0.024541081881415294, 'rl': 0.17920118830416049, 'lstm': 0.0983779896963794, 'arima': 0.08292581758625961, 'prophet': 0.30093317902774375, 'transformer': 0.1349854892791609, 'bitcoin_forecast': 0.1342731848469169}
2024-09-20 08:36:51 - INFO - 조정된 모델 가중치: {'gpt': 0.006023361059561964, 'ml': 0.03873870831840164, 'xgboost': 0.024541081881415294, 'rl': 0.17920118830416049, 'lstm': 0.0983779896963794, 'arima': 0.08292581758625961, 'prophet': 0.30093317902774375, 'transformer': 0.1349854892791609, 'bitcoin_forecast': 0.1342731848469169}
2024-09-20 08:36:51 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84079751.03060699, 'current_price': 84106000.0, 'predictions': {'gpt': 84106000.0, 'ml': 84106000.0, 'xgboost': 84106000.0, 'lstm': 83936999.22909032, 'rl': 84947060.0, 'arima': 84140000.0, 'prophet': 84094600.88160829, 'transformer': 83938094.07044096, 'bitcoin_forecast': 83085198.96893077}, 'weights': {'gpt': 0.006023361059561964, 'ml': 0.03873870831840164, 'xgboost': 0.024541081881415294, 'rl': 0.17920118830416049, 'lstm': 0.0983779896963794, 'arima': 0.08292581758625961, 'prophet': 0.30093317902774375, 'transformer': 0.1349854892791609, 'bitcoin_forecast': 0.1342731848469169}}
2024-09-20 08:36:51 - INFO - 모델별 가중치:
2024-09-20 08:36:51 - INFO -   - GPT: 0.0060
2024-09-20 08:36:51 - INFO -   - ML: 0.0387
2024-09-20 08:36:51 - INFO -   - XGBOOST: 0.0245
2024-09-20 08:36:51 - INFO -   - RL: 0.1792
2024-09-20 08:36:51 - INFO -   - LSTM: 0.0984
2024-09-20 08:36:51 - INFO -   - ARIMA: 0.0829
2024-09-20 08:36:51 - INFO -   - PROPHET: 0.3009
2024-09-20 08:36:51 - INFO -   - TRANSFORMER: 0.1350
2024-09-20 08:36:51 - INFO -   - BITCOIN_FORECAST: 0.1343
2024-09-20 08:36:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:36:51 - INFO - 6. 거래 실행
2024-09-20 08:36:51 - INFO - Cancelling existing orders.
2024-09-20 08:36:51 - INFO - Cancelled 0 orders.
2024-09-20 08:36:51 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84079751.03060699, 'current_price': 84106000.0, 'predictions': {'gpt': 84106000.0, 'ml': 84106000.0, 'xgboost': 84106000.0, 'lstm': 83936999.22909032, 'rl': 84947060.0, 'arima': 84140000.0, 'prophet': 84094600.88160829, 'transformer': 83938094.07044096, 'bitcoin_forecast': 83085198.96893077}, 'weights': {'gpt': 0.006023361059561964, 'ml': 0.03873870831840164, 'xgboost': 0.024541081881415294, 'rl': 0.17920118830416049, 'lstm': 0.0983779896963794, 'arima': 0.08292581758625961, 'prophet': 0.30093317902774375, 'transformer': 0.1349854892791609, 'bitcoin_forecast': 0.1342731848469169}}, 현재 가격=84106000.0
2024-09-20 08:36:51 - INFO - 현재 잔고: KRW=63151.47020207, BTC=0.00491162, 총 자산가치=476248.18192207004
2024-09-20 08:36:51 - INFO - 매도 시도: 0.0004911620000000001 BTC (약 41309.671172 KRW)
2024-09-20 08:36:51 - INFO - 주문 결과: {'uuid': '9262c64e-5fac-4c43-9eaf-efd131bdade6', 'side': 'ask', 'ord_type': 'limit', 'price': '84106000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:36:52+09:00', 'volume': '0.00049116', 'remaining_volume': '0.00049116', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00049116', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:36:51 - INFO - sell 주문 성공: UUID=9262c64e-5fac-4c43-9eaf-efd131bdade6
2024-09-20 08:36:51 - INFO - Trade executed successfully.
2024-09-20 08:36:51 - INFO - 7. summary 리포트 보내기
2024-09-20 08:36:52 - INFO - Message sent to Discord successfully.
2024-09-20 08:36:52 - INFO - Trading cycle completed.
2024-09-20 08:36:52 - INFO - Performing periodic update.
2024-09-20 08:36:52 - INFO - 계산된 시장 변동성: 0.027754040700869353
2024-09-20 08:45:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:45:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8162-9392-f6e836555db7 "HTTP/1.1 200 OK"
2024-09-20 08:45:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:45:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8136-8996-c24fd82fae1b "HTTP/1.1 200 OK"
2024-09-20 08:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:46:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:46:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-813d-8a54-cf0f527c7935 "HTTP/1.1 200 OK"
2024-09-20 08:46:01 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:46:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:46:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/1430d353-fbeb-4131-9bcb-a67f948f0397 "HTTP/1.1 200 OK"
2024-09-20 08:46:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:46:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:46:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8189-b493-d0e48c410e65 "HTTP/1.1 200 OK"
2024-09-20 08:46:19 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:46:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:46:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81f5-8f32-e2c720fed34d "HTTP/1.1 200 OK"
2024-09-20 08:46:26 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:46:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-9a44-e5a2768be14c "HTTP/1.1 200 OK"
2024-09-20 08:46:42 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:47:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:47:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81dc-ba14-e22d3c5f22ee "HTTP/1.1 200 OK"
2024-09-20 08:47:10 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:47:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:47:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81c1-85f4-ef9ceda09606 "HTTP/1.1 200 OK"
2024-09-20 08:47:18 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:35:34.967471
2024-09-20 08:47:18 - INFO - Starting trading cycle.
2024-09-20 08:47:18 - INFO - ##################################################
2024-09-20 08:47:18 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-20 08:47:18 - INFO - ##################################################
2024-09-20 08:47:18 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:47:18 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:47:18 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:30:00
2024-09-20 08:47:18 - INFO - 새로운 데이터 범위: 2024-09-18 23:30:00 ~ 2024-09-20 08:40:00
2024-09-20 08:47:18 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:47:18 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:47:18 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:47:18 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:47:18 - INFO - Sample date values: [Timestamp('2024-09-20 08:40:00')]
2024-09-20 08:47:18 - INFO - Successfully added 1 new data points
2024-09-20 08:47:18 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:47:18 - INFO - Final date range: 2024-09-20 08:40:00 to 2024-09-20 08:40:00
2024-09-20 08:47:18 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:47:18 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:40:00
2024-09-20 08:47:18 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:47:18 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:47:18 - INFO - GPT | 이전예측가격: 84106000 | 당시BTC가격: 84106000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:47:18 - INFO - ML | 이전예측가격: 84106000 | 당시BTC가격: 84106000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:47:18 - INFO - XGBOOST | 이전예측가격: 84106000 | 당시BTC가격: 84106000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:47:18 - INFO - LSTM 모델 예측 업데이트: 정확도 31.25%, 적중/전체: 5/16
2024-09-20 08:47:18 - INFO - LSTM | 이전예측가격: 83936999 | 당시BTC가격: 84106000 | 예측: 하락 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 16 | 예측 성공 수: 5 | 예측 성공률: 31.25%
2024-09-20 08:47:18 - INFO - RL 모델 예측 업데이트: 정확도 55.21%, 적중/전체: 53/96
2024-09-20 08:47:18 - INFO - RL | 이전예측가격: 84947060 | 당시BTC가격: 84106000 | 예측: 상승 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2855 | 반영가중치값: -0.0200 | 새 가중치: 0.2655 | 예측 총 횟수: 96 | 예측 성공 수: 53 | 예측 성공률: 55.21%
2024-09-20 08:47:18 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-20 08:47:18 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84106000 | 예측: 상승 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0416 | 반영가중치값: -0.0200 | 새 가중치: 0.0216 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-20 08:47:18 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.36%, 적중/전체: 54/88
2024-09-20 08:47:18 - INFO - PROPHET | 이전예측가격: 84094601 | 당시BTC가격: 84106000 | 예측: 하락 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3010 | 반영가중치값: 0.0200 | 새 가중치: 0.3210 | 예측 총 횟수: 88 | 예측 성공 수: 54 | 예측 성공률: 61.36%
2024-09-20 08:47:18 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 43.64%, 적중/전체: 24/55
2024-09-20 08:47:18 - INFO - TRANSFORMER | 이전예측가격: 83938094 | 당시BTC가격: 84106000 | 예측: 하락 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 55 | 예측 성공 수: 24 | 예측 성공률: 43.64%
2024-09-20 08:47:18 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 63.89%, 적중/전체: 23/36
2024-09-20 08:47:18 - INFO - BITCOIN_FORECAST | 이전예측가격: 83085199 | 당시BTC가격: 84106000 | 예측: 하락 | 지금 BTC가격: 84010000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2352 | 반영가중치값: 0.0200 | 새 가중치: 0.2552 | 예측 총 횟수: 36 | 예측 성공 수: 23 | 예측 성공률: 63.89%
2024-09-20 08:47:18 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:47:18 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:47:18 - INFO - 새로운 가중치: {'gpt': 0.006192809814963048, 'ml': 0.039828502844329684, 'xgboost': 0.025231469812651865, 'rl': 0.27298979155252956, 'lstm': 0.02056263854590648, 'arima': 0.022238317856421344, 'prophet': 0.3299902988745896, 'transformer': 0.02056263854590648, 'bitcoin_forecast': 0.262403532152702}
2024-09-20 08:47:18 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:47:18 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:47:18 - INFO - Current BTC price: 84010000.0
2024-09-20 08:47:18 - INFO - Analyzing market conditions.
2024-09-20 08:47:18 - INFO - Market analysis: {'current_price': 84010000.0, 'sma_20': 83943300.0, 'rsi_14': 47.19931704083427, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:47:18 - INFO - Starting predictions for all models
2024-09-20 08:47:18 - INFO - Attempting prediction for gpt
2024-09-20 08:47:19 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:47:19 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:47:19 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:47:19 - INFO - GPT prediction: 84010000.0
2024-09-20 08:47:19 - INFO - Attempting prediction for ml
2024-09-20 08:47:19 - INFO - ML prediction: 84010000.0
2024-09-20 08:47:19 - INFO - Attempting prediction for xgboost
2024-09-20 08:47:19 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:47:19 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:47:19 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:47:19 - INFO - XGBOOST prediction: 84010000.0
2024-09-20 08:47:19 - INFO - Attempting prediction for lstm
2024-09-20 08:47:19 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:47:19 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:47:19 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:47:19 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:47:19 - INFO - X 샘플:
[[-1.00398974 -1.22457882 -0.97099607 -1.15410025  1.63112201  1.62888459
  -1.15410025]
 [-1.33041465 -2.11390763 -1.60027161 -2.19603322  1.05750181  1.04997877
  -2.19603322]
 [-1.56823851  0.02048151 -1.46485789 -0.15469515  1.45457871  1.45684809
  -0.15469515]
 [-0.34647672 -0.40531834 -0.31782398 -0.46302226 -0.59102638 -0.59276139
  -0.46302226]
 [-0.13196893  0.05282074  0.06850341  0.28653157 -0.6736604  -0.67464735
   0.28653157]
 [ 0.44626948  0.14983843  0.4827101   0.2758996  -0.45699172 -0.45558661
   0.2758996 ]
 [ 0.40896377  0.14983843  0.55041697  0.31311149 -1.03651494 -1.0384288
   0.31311149]
 [ 0.95455969  1.17391403  1.01639949  1.17961697  0.49695544  0.50754959
   1.17961697]
 [ 1.43020741  1.217033    1.41467515  1.21151288 -0.91714371 -0.91639346
   1.21151288]
 [ 1.1410882   0.97987865  0.82124442  0.70117836 -0.96482083 -0.96544342
   0.70117836]]
2024-09-20 08:47:19 - INFO - y 샘플:
[0.70117836]
2024-09-20 08:47:19 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:47:19 - INFO - 모델 출력 (스케일링된 예측): [[0.4823078]]
2024-09-20 08:47:19 - INFO - 스케일러 역변환 후 예측 가격: 83968827.83902976
2024-09-20 08:47:19 - INFO - LSTMPredictor 최종 예측 가격: 83968827.83902976
2024-09-20 08:47:19 - INFO - LSTM prediction: 83968827.83902976
2024-09-20 08:47:19 - INFO - Attempting prediction for rl
2024-09-20 08:47:19 - INFO - Preparing state for RL agent.
2024-09-20 08:47:19 - INFO - Prepared state: [[ 8.40100000e+07  8.35131525e+00 -1.14141678e-03  8.39433000e+07
   4.71993170e+01]]
2024-09-20 08:47:19 - INFO - RL prediction: 84850100.0
2024-09-20 08:47:19 - INFO - Attempting prediction for arima
2024-09-20 08:47:19 - INFO - ARIMA 예측 시작
2024-09-20 08:47:19 - INFO - 입력 데이터: {'open': 84040000.0, 'high': 84104000.0, 'low': 83950000.0, 'close': 84010000.0, 'volume': 8.35131525, 'value': 701705159.59015, 'decision': 'sell', 'sma': 83943300.0, 'ema': 84028526.89082798, 'rsi': 47.19931704083427, 'macd': -108240.05555312335, 'signal_line': -157591.9710906774, 'BB_Upper': 84315572.53458081, 'BB_Lower': 83571027.46541919}
2024-09-20 08:47:19 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:47:19 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83943300.0         0         0
2024-09-20 08:47:19 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83943300.0         0         0
2024-09-20 08:47:19 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:47:19 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:47:19 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:47:19 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:47:19 - INFO - Attempting prediction for prophet
2024-09-20 08:47:19 - INFO - PROPHET prediction: 83980405.56560223
2024-09-20 08:47:19 - INFO - Attempting prediction for transformer
2024-09-20 08:47:19 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:47:19 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:47:19 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:47:19 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:47:19 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:47:19 - INFO - X 샘플:
[[-1.00398974 -1.22457882 -0.97099607 -1.15410025  1.63112201  1.62888459
  -1.15410025 -1.15410025  0.          0.          0.         -1.15410025
  -1.15410025]
 [-1.33041465 -2.11390763 -1.60027161 -2.19603322  1.05750181  1.04997877
  -2.19603322 -2.19603322  0.          0.          0.         -2.19603322
  -2.19603322]
 [-1.56823851  0.02048151 -1.46485789 -0.15469515  1.45457871  1.45684809
  -0.15469515 -0.15469515  0.          0.          0.         -0.15469515
  -0.15469515]
 [-0.34647672 -0.40531834 -0.31782398 -0.46302226 -0.59102638 -0.59276139
  -0.46302226 -0.46302226  0.          0.          0.         -0.46302226
  -0.46302226]
 [-0.13196893  0.05282074  0.06850341  0.28653157 -0.6736604  -0.67464735
   0.28653157  0.28653157  0.          0.          0.          0.28653157
   0.28653157]
 [ 0.44626948  0.14983843  0.4827101   0.2758996  -0.45699172 -0.45558661
   0.2758996   0.2758996   0.          0.          0.          0.2758996
   0.2758996 ]
 [ 0.40896377  0.14983843  0.55041697  0.31311149 -1.03651494 -1.0384288
   0.31311149  0.31311149  0.          0.          0.          0.31311149
   0.31311149]
 [ 0.95455969  1.17391403  1.01639949  1.17961697  0.49695544  0.50754959
   1.17961697  1.17961697  0.          0.          0.          1.17961697
   1.17961697]
 [ 1.43020741  1.217033    1.41467515  1.21151288 -0.91714371 -0.91639346
   1.21151288  1.21151288  0.          0.          0.          1.21151288
   1.21151288]
 [ 1.1410882   0.97987865  0.82124442  0.70117836 -0.96482083 -0.96544342
   0.70117836  0.70117836  0.          0.          0.          0.70117836
   0.70117836]]
2024-09-20 08:47:19 - INFO - y 샘플:
[0.70117836]
2024-09-20 08:47:19 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:47:19 - INFO - 모델 출력 (스케일링된 예측): [0.47131386]
2024-09-20 08:47:19 - INFO - 스케일러 역변환 후 예측 가격: 83966759.75030845
2024-09-20 08:47:19 - INFO - TransformerPredictor 최종 예측 가격: 83966759.75030845
2024-09-20 08:47:19 - INFO - TRANSFORMER prediction: 83966759.75030845
2024-09-20 08:47:19 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:47:19 - INFO - BITCOIN_FORECAST prediction: 83049624.96047644
2024-09-20 08:47:19 - INFO - BitcoinForecast prediction: 83049624.96047644
2024-09-20 08:47:20 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:21 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:23 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:24 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:30 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:30 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:47:30 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:47:30 - INFO - 조정된 모델 가중치: {'gpt': 0.006192809814963048, 'ml': 0.039828502844329684, 'xgboost': 0.025231469812651865, 'rl': 0.27298979155252956, 'lstm': 0.02056263854590648, 'arima': 0.022238317856421344, 'prophet': 0.3299902988745896, 'transformer': 0.02056263854590648, 'bitcoin_forecast': 0.262403532152702}
2024-09-20 08:47:30 - INFO - 조정된 모델 가중치: {'gpt': 0.006192809814963048, 'ml': 0.039828502844329684, 'xgboost': 0.025231469812651865, 'rl': 0.27298979155252956, 'lstm': 0.02056263854590648, 'arima': 0.022238317856421344, 'prophet': 0.3299902988745896, 'transformer': 0.02056263854590648, 'bitcoin_forecast': 0.262403532152702}
2024-09-20 08:47:30 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83978722.28450117, 'current_price': 84010000.0, 'predictions': {'gpt': 84010000.0, 'ml': 84010000.0, 'xgboost': 84010000.0, 'lstm': 83968827.83902976, 'rl': 84850100.0, 'arima': 84140000.0, 'prophet': 83980405.56560223, 'transformer': 83966759.75030845, 'bitcoin_forecast': 83049624.96047644}, 'weights': {'gpt': 0.006192809814963048, 'ml': 0.039828502844329684, 'xgboost': 0.025231469812651865, 'rl': 0.27298979155252956, 'lstm': 0.02056263854590648, 'arima': 0.022238317856421344, 'prophet': 0.3299902988745896, 'transformer': 0.02056263854590648, 'bitcoin_forecast': 0.262403532152702}}
2024-09-20 08:47:30 - INFO - 모델별 가중치:
2024-09-20 08:47:30 - INFO -   - GPT: 0.0062
2024-09-20 08:47:30 - INFO -   - ML: 0.0398
2024-09-20 08:47:30 - INFO -   - XGBOOST: 0.0252
2024-09-20 08:47:30 - INFO -   - RL: 0.2730
2024-09-20 08:47:30 - INFO -   - LSTM: 0.0206
2024-09-20 08:47:30 - INFO -   - ARIMA: 0.0222
2024-09-20 08:47:30 - INFO -   - PROPHET: 0.3300
2024-09-20 08:47:30 - INFO -   - TRANSFORMER: 0.0206
2024-09-20 08:47:30 - INFO -   - BITCOIN_FORECAST: 0.2624
2024-09-20 08:47:30 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:47:30 - INFO - 6. 거래 실행
2024-09-20 08:47:30 - INFO - Cancelling existing orders.
2024-09-20 08:47:30 - INFO - Cancelled 1 orders.
2024-09-20 08:47:30 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83978722.28450117, 'current_price': 84010000.0, 'predictions': {'gpt': 84010000.0, 'ml': 84010000.0, 'xgboost': 84010000.0, 'lstm': 83968827.83902976, 'rl': 84850100.0, 'arima': 84140000.0, 'prophet': 83980405.56560223, 'transformer': 83966759.75030845, 'bitcoin_forecast': 83049624.96047644}, 'weights': {'gpt': 0.006192809814963048, 'ml': 0.039828502844329684, 'xgboost': 0.025231469812651865, 'rl': 0.27298979155252956, 'lstm': 0.02056263854590648, 'arima': 0.022238317856421344, 'prophet': 0.3299902988745896, 'transformer': 0.02056263854590648, 'bitcoin_forecast': 0.262403532152702}}, 현재 가격=84010000.0
2024-09-20 08:47:30 - INFO - 현재 잔고: KRW=63151.47020207, BTC=0.00491162, 총 자산가치=475776.66640207
2024-09-20 08:47:30 - INFO - 매도 시도: 0.0004911620000000001 BTC (약 41262.51962000001 KRW)
2024-09-20 08:47:30 - INFO - 주문 결과: {'uuid': '9981daec-74f7-4458-9fab-63f24ec5b11f', 'side': 'ask', 'ord_type': 'limit', 'price': '84010000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:47:31+09:00', 'volume': '0.00049116', 'remaining_volume': '0.00049116', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00049116', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:47:30 - INFO - sell 주문 성공: UUID=9981daec-74f7-4458-9fab-63f24ec5b11f
2024-09-20 08:47:30 - INFO - Trade executed successfully.
2024-09-20 08:47:30 - INFO - 7. summary 리포트 보내기
2024-09-20 08:47:31 - INFO - Message sent to Discord successfully.
2024-09-20 08:47:31 - INFO - Trading cycle completed.
2024-09-20 08:47:31 - INFO - Performing periodic update.
2024-09-20 08:47:31 - INFO - 계산된 시장 변동성: 0.027753397662923184
2024-09-20 08:55:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:55:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-816d-915c-f5a2abf95231 "HTTP/1.1 200 OK"
2024-09-20 08:55:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:55:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:55:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/6b0bd662-2266-443d-8ec0-8ba71a10a376 "HTTP/1.1 200 OK"
2024-09-20 08:55:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:55:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:55:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/03685945-667a-400b-a2b9-edcb62f8aac2 "HTTP/1.1 200 OK"
2024-09-20 08:55:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8118-85bf-d95ff273d8b0 "HTTP/1.1 200 OK"
2024-09-20 08:56:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8158-a538-cc65344ef422 "HTTP/1.1 200 OK"
2024-09-20 08:56:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812d-9b88-e25bc247efc9 "HTTP/1.1 200 OK"
2024-09-20 08:56:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8ec41dcf-3e5c-48c0-814b-991e4b62b53d "HTTP/1.1 200 OK"
2024-09-20 08:56:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81ba-9f86-e22722681baf "HTTP/1.1 200 OK"
2024-09-20 08:56:35 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 08:56:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8198-a63c-e76ce94952e8 "HTTP/1.1 200 OK"
2024-09-20 08:56:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:45:34.967871
2024-09-20 08:56:42 - INFO - Starting trading cycle.
2024-09-20 08:56:42 - INFO - ##################################################
2024-09-20 08:56:42 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-20 08:56:42 - INFO - ##################################################
2024-09-20 08:56:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 08:56:42 - INFO - 데이터베이스 업데이트 시작
2024-09-20 08:56:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:40:00
2024-09-20 08:56:42 - INFO - 새로운 데이터 범위: 2024-09-18 23:40:00 ~ 2024-09-20 08:50:00
2024-09-20 08:56:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 08:56:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 08:56:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 08:56:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 08:56:42 - INFO - Sample date values: [Timestamp('2024-09-20 08:50:00')]
2024-09-20 08:56:42 - INFO - Successfully added 1 new data points
2024-09-20 08:56:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 08:56:42 - INFO - Final date range: 2024-09-20 08:50:00 to 2024-09-20 08:50:00
2024-09-20 08:56:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 08:56:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 08:50:00
2024-09-20 08:56:42 - INFO - 데이터베이스 업데이트 완료
2024-09-20 08:56:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 08:56:42 - INFO - GPT | 이전예측가격: 84010000 | 당시BTC가격: 84010000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:56:42 - INFO - ML | 이전예측가격: 84010000 | 당시BTC가격: 84010000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:56:42 - INFO - XGBOOST | 이전예측가격: 84010000 | 당시BTC가격: 84010000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 08:56:42 - INFO - LSTM 모델 예측 업데이트: 정확도 35.29%, 적중/전체: 6/17
2024-09-20 08:56:42 - INFO - LSTM | 이전예측가격: 83968828 | 당시BTC가격: 84010000 | 예측: 하락 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0984 | 반영가중치값: 0.0200 | 새 가중치: 0.1184 | 예측 총 횟수: 17 | 예측 성공 수: 6 | 예측 성공률: 35.29%
2024-09-20 08:56:42 - INFO - RL 모델 예측 업데이트: 정확도 54.64%, 적중/전체: 53/97
2024-09-20 08:56:43 - INFO - RL | 이전예측가격: 84850100 | 당시BTC가격: 84010000 | 예측: 상승 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1792 | 반영가중치값: -0.0200 | 새 가중치: 0.1592 | 예측 총 횟수: 97 | 예측 성공 수: 53 | 예측 성공률: 54.64%
2024-09-20 08:56:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 8/16
2024-09-20 08:56:43 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84010000 | 예측: 상승 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0829 | 반영가중치값: -0.0200 | 새 가중치: 0.0629 | 예측 총 횟수: 16 | 예측 성공 수: 8 | 예측 성공률: 50.00%
2024-09-20 08:56:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.80%, 적중/전체: 55/89
2024-09-20 08:56:43 - INFO - PROPHET | 이전예측가격: 83980406 | 당시BTC가격: 84010000 | 예측: 하락 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3009 | 반영가중치값: 0.0200 | 새 가중치: 0.3209 | 예측 총 횟수: 89 | 예측 성공 수: 55 | 예측 성공률: 61.80%
2024-09-20 08:56:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.64%, 적중/전체: 25/56
2024-09-20 08:56:43 - INFO - TRANSFORMER | 이전예측가격: 83966760 | 당시BTC가격: 84010000 | 예측: 하락 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1350 | 반영가중치값: 0.0200 | 새 가중치: 0.1550 | 예측 총 횟수: 56 | 예측 성공 수: 25 | 예측 성공률: 44.64%
2024-09-20 08:56:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 64.86%, 적중/전체: 24/37
2024-09-20 08:56:43 - INFO - BITCOIN_FORECAST | 이전예측가격: 83049625 | 당시BTC가격: 84010000 | 예측: 하락 | 지금 BTC가격: 83890000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1343 | 반영가중치값: 0.0200 | 새 가중치: 0.1543 | 예측 총 횟수: 37 | 예측 성공 수: 24 | 예측 성공률: 64.86%
2024-09-20 08:56:43 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 08:56:43 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 08:56:43 - INFO - 새로운 가중치: {'gpt': 0.005943482899222475, 'ml': 0.03822497906926594, 'xgboost': 0.02421563294119009, 'rl': 0.1527916355408568, 'lstm': 0.11361200786511857, 'arima': 0.06039237953664793, 'prophet': 0.30801218160062, 'transformer': 0.14874566354881955, 'bitcoin_forecast': 0.14806203699825868}
2024-09-20 08:56:43 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 08:56:43 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 08:56:43 - INFO - Current BTC price: 83890000.0
2024-09-20 08:56:43 - INFO - Analyzing market conditions.
2024-09-20 08:56:43 - INFO - Market analysis: {'current_price': 83890000.0, 'sma_20': 83926000.0, 'rsi_14': 43.364569291936675, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 08:56:43 - INFO - Starting predictions for all models
2024-09-20 08:56:43 - INFO - Attempting prediction for gpt
2024-09-20 08:56:43 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 08:56:43 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:56:43 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 08:56:43 - INFO - GPT prediction: 83890000.0
2024-09-20 08:56:43 - INFO - Attempting prediction for ml
2024-09-20 08:56:43 - INFO - ML prediction: 83873222.0
2024-09-20 08:56:43 - INFO - Attempting prediction for xgboost
2024-09-20 08:56:43 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 08:56:43 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:56:43 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 08:56:43 - INFO - XGBOOST prediction: 83890000.0
2024-09-20 08:56:43 - INFO - Attempting prediction for lstm
2024-09-20 08:56:43 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:56:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:56:43 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 08:56:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:56:43 - INFO - X 샘플:
[[-1.56578029 -2.4672633  -1.83414232 -2.51045304  1.50609015  1.49604226
  -2.51045304]
 [-1.81339206 -0.12929664 -1.69241314 -0.29941183  1.9754829   1.97674445
  -0.29941183]
 [-0.54134729 -0.59570918 -0.49188362 -0.63337118 -0.44266887 -0.44479911
  -0.63337118]
 [-0.31801119 -0.0938729  -0.08753861  0.17849551 -0.54035224 -0.54154457
   0.17849551]
 [ 0.28402526  0.01239831  0.34598594  0.16697967 -0.28422375 -0.2827318
   0.16697967]
 [ 0.2451842   0.01239831  0.41685053  0.20728511 -0.96929004 -0.97133993
   0.20728511]
 [ 0.81323472  1.13414999  0.90456564  1.14582604  0.84345678  0.85518072
   1.14582604]
 [ 1.30845826  1.18138164  1.32141617  1.18037356 -0.82817887 -0.82715934
   1.18037356]
 [ 1.00744003  0.92160756  0.70030888  0.62761326 -0.88453896 -0.8851102
   0.62761326]
 [ 0.58018836  0.02420622  0.41685053 -0.06333712 -0.3757771  -0.37528248
  -0.06333712]]
2024-09-20 08:56:43 - INFO - y 샘플:
[-0.06333712]
2024-09-20 08:56:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 08:56:43 - INFO - 모델 출력 (스케일링된 예측): [[0.46243182]]
2024-09-20 08:56:43 - INFO - 스케일러 역변환 후 예측 가격: 83981312.30601808
2024-09-20 08:56:43 - INFO - LSTMPredictor 최종 예측 가격: 83981312.30601808
2024-09-20 08:56:43 - INFO - LSTM prediction: 83981312.30601808
2024-09-20 08:56:43 - INFO - Attempting prediction for rl
2024-09-20 08:56:43 - INFO - Preparing state for RL agent.
2024-09-20 08:56:43 - INFO - Prepared state: [[ 8.38900000e+07  1.28535918e+01 -1.42840138e-03  8.39260000e+07
   4.33645693e+01]]
2024-09-20 08:56:43 - INFO - RL prediction: 84728900.0
2024-09-20 08:56:43 - INFO - Attempting prediction for arima
2024-09-20 08:56:43 - INFO - ARIMA 예측 시작
2024-09-20 08:56:43 - INFO - 입력 데이터: {'open': 83952000.0, 'high': 83952000.0, 'low': 83882000.0, 'close': 83890000.0, 'volume': 12.85359179, 'value': 1078514860.18618, 'decision': 'sell', 'sma': 83926000.0, 'ema': 84015333.85360627, 'rsi': 43.364569291936675, 'macd': -106639.4252678752, 'signal_line': -147401.46192611696, 'BB_Upper': 84273596.31759158, 'BB_Lower': 83578403.68240842}
2024-09-20 08:56:43 - INFO - Exogenous 변수 예측 시작
2024-09-20 08:56:43 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83926000.0         0         0
2024-09-20 08:56:43 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83926000.0         0         0
2024-09-20 08:56:43 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 08:56:43 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 08:56:43 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 08:56:43 - INFO - ARIMA prediction: 84140000.0
2024-09-20 08:56:43 - INFO - Attempting prediction for prophet
2024-09-20 08:56:43 - INFO - PROPHET prediction: 83842227.79237036
2024-09-20 08:56:43 - INFO - Attempting prediction for transformer
2024-09-20 08:56:43 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 08:56:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 08:56:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 08:56:43 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 08:56:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 08:56:43 - INFO - X 샘플:
[[-1.56578029 -2.4672633  -1.83414232 -2.51045304  1.50609015  1.49604226
  -2.51045304 -2.51045304  0.          0.          0.         -2.51045304
  -2.51045304]
 [-1.81339206 -0.12929664 -1.69241314 -0.29941183  1.9754829   1.97674445
  -0.29941183 -0.29941183  0.          0.          0.         -0.29941183
  -0.29941183]
 [-0.54134729 -0.59570918 -0.49188362 -0.63337118 -0.44266887 -0.44479911
  -0.63337118 -0.63337118  0.          0.          0.         -0.63337118
  -0.63337118]
 [-0.31801119 -0.0938729  -0.08753861  0.17849551 -0.54035224 -0.54154457
   0.17849551  0.17849551  0.          0.          0.          0.17849551
   0.17849551]
 [ 0.28402526  0.01239831  0.34598594  0.16697967 -0.28422375 -0.2827318
   0.16697967  0.16697967  0.          0.          0.          0.16697967
   0.16697967]
 [ 0.2451842   0.01239831  0.41685053  0.20728511 -0.96929004 -0.97133993
   0.20728511  0.20728511  0.          0.          0.          0.20728511
   0.20728511]
 [ 0.81323472  1.13414999  0.90456564  1.14582604  0.84345678  0.85518072
   1.14582604  1.14582604  0.          0.          0.          1.14582604
   1.14582604]
 [ 1.30845826  1.18138164  1.32141617  1.18037356 -0.82817887 -0.82715934
   1.18037356  1.18037356  0.          0.          0.          1.18037356
   1.18037356]
 [ 1.00744003  0.92160756  0.70030888  0.62761326 -0.88453896 -0.8851102
   0.62761326  0.62761326  0.          0.          0.          0.62761326
   0.62761326]
 [ 0.58018836  0.02420622  0.41685053 -0.06333712 -0.3757771  -0.37528248
  -0.06333712 -0.06333712  0.          0.          0.         -0.06333712
  -0.06333712]]
2024-09-20 08:56:43 - INFO - y 샘플:
[-0.06333712]
2024-09-20 08:56:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 08:56:43 - INFO - 모델 출력 (스케일링된 예측): [0.47436222]
2024-09-20 08:56:43 - INFO - 스케일러 역변환 후 예측 가격: 83983384.30536437
2024-09-20 08:56:43 - INFO - TransformerPredictor 최종 예측 가격: 83983384.30536437
2024-09-20 08:56:43 - INFO - TRANSFORMER prediction: 83983384.30536437
2024-09-20 08:56:43 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 08:56:43 - INFO - BITCOIN_FORECAST prediction: 83103996.63085538
2024-09-20 08:56:43 - INFO - BitcoinForecast prediction: 83103996.63085538
2024-09-20 08:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 08:56:48 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 08:56:48 - INFO - 조정된 모델 가중치: {'gpt': 0.005943482899222475, 'ml': 0.03822497906926594, 'xgboost': 0.02421563294119009, 'rl': 0.1527916355408568, 'lstm': 0.11361200786511857, 'arima': 0.06039237953664793, 'prophet': 0.30801218160062, 'transformer': 0.14874566354881955, 'bitcoin_forecast': 0.14806203699825868}
2024-09-20 08:56:48 - INFO - 조정된 모델 가중치: {'gpt': 0.005943482899222475, 'ml': 0.03822497906926594, 'xgboost': 0.02421563294119009, 'rl': 0.1527916355408568, 'lstm': 0.11361200786511857, 'arima': 0.06039237953664793, 'prophet': 0.30801218160062, 'transformer': 0.14874566354881955, 'bitcoin_forecast': 0.14806203699825868}
2024-09-20 08:56:48 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83925806.66232161, 'current_price': 83890000.0, 'predictions': {'gpt': 83890000.0, 'ml': 83873222.0, 'xgboost': 83890000.0, 'lstm': 83981312.30601808, 'rl': 84728900.0, 'arima': 84140000.0, 'prophet': 83842227.79237036, 'transformer': 83983384.30536437, 'bitcoin_forecast': 83103996.63085538}, 'weights': {'gpt': 0.005943482899222475, 'ml': 0.03822497906926594, 'xgboost': 0.02421563294119009, 'rl': 0.1527916355408568, 'lstm': 0.11361200786511857, 'arima': 0.06039237953664793, 'prophet': 0.30801218160062, 'transformer': 0.14874566354881955, 'bitcoin_forecast': 0.14806203699825868}}
2024-09-20 08:56:48 - INFO - 모델별 가중치:
2024-09-20 08:56:48 - INFO -   - GPT: 0.0059
2024-09-20 08:56:48 - INFO -   - ML: 0.0382
2024-09-20 08:56:48 - INFO -   - XGBOOST: 0.0242
2024-09-20 08:56:48 - INFO -   - RL: 0.1528
2024-09-20 08:56:48 - INFO -   - LSTM: 0.1136
2024-09-20 08:56:48 - INFO -   - ARIMA: 0.0604
2024-09-20 08:56:48 - INFO -   - PROPHET: 0.3080
2024-09-20 08:56:48 - INFO -   - TRANSFORMER: 0.1487
2024-09-20 08:56:48 - INFO -   - BITCOIN_FORECAST: 0.1481
2024-09-20 08:56:48 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 08:56:48 - INFO - 6. 거래 실행
2024-09-20 08:56:48 - INFO - Cancelling existing orders.
2024-09-20 08:56:48 - INFO - Cancelled 0 orders.
2024-09-20 08:56:48 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83925806.66232161, 'current_price': 83890000.0, 'predictions': {'gpt': 83890000.0, 'ml': 83873222.0, 'xgboost': 83890000.0, 'lstm': 83981312.30601808, 'rl': 84728900.0, 'arima': 84140000.0, 'prophet': 83842227.79237036, 'transformer': 83983384.30536437, 'bitcoin_forecast': 83103996.63085538}, 'weights': {'gpt': 0.005943482899222475, 'ml': 0.03822497906926594, 'xgboost': 0.02421563294119009, 'rl': 0.1527916355408568, 'lstm': 0.11361200786511857, 'arima': 0.06039237953664793, 'prophet': 0.30801218160062, 'transformer': 0.14874566354881955, 'bitcoin_forecast': 0.14806203699825868}}, 현재 가격=83890000.0
2024-09-20 08:56:49 - INFO - 현재 잔고: KRW=104393.19062627, BTC=0.00442046, 총 자산가치=475225.58002627006
2024-09-20 08:56:49 - INFO - 매수 시도: 0.000566486565772166 BTC (약 47522.55800262701 KRW)
2024-09-20 08:56:49 - INFO - 주문 결과: {'uuid': '1796f374-9174-4211-a9fc-85c42bb45aa5', 'side': 'bid', 'ord_type': 'limit', 'price': '83890000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T08:56:50+09:00', 'volume': '0.00056648', 'remaining_volume': '0.00056648', 'reserved_fee': '23.7610036', 'remaining_fee': '23.7610036', 'paid_fee': '0', 'locked': '47545.7682036', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 08:56:49 - INFO - buy 주문 성공: UUID=1796f374-9174-4211-a9fc-85c42bb45aa5
2024-09-20 08:56:49 - INFO - Trade executed successfully.
2024-09-20 08:56:49 - INFO - 7. summary 리포트 보내기
2024-09-20 08:56:49 - INFO - Message sent to Discord successfully.
2024-09-20 08:56:49 - INFO - Trading cycle completed.
2024-09-20 08:56:49 - INFO - Performing periodic update.
2024-09-20 08:56:49 - INFO - 계산된 시장 변동성: 0.027772305713872177
2024-09-20 09:05:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:05:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81da-b483-f8b3d74205fa "HTTP/1.1 200 OK"
2024-09-20 09:05:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:05:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:05:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81d5-871d-c7c7464b5310 "HTTP/1.1 200 OK"
2024-09-20 09:05:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:05:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:05:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/46e9e7e4-34f5-4e34-a176-4fa3f15b7fd4 "HTTP/1.1 200 OK"
2024-09-20 09:05:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-812e-be0b-fd689ac2d873 "HTTP/1.1 200 OK"
2024-09-20 09:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8169-a8e2-feb3b5892f35 "HTTP/1.1 200 OK"
2024-09-20 09:06:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8146-b609-f82bb4d31f60 "HTTP/1.1 200 OK"
2024-09-20 09:06:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8101-8206-c97b241e5434 "HTTP/1.1 200 OK"
2024-09-20 09:06:20 - INFO - Updated actual price for prophet prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-81bc-a10d-f08faf74b9b8 "HTTP/1.1 200 OK"
2024-09-20 09:06:26 - INFO - Updated actual price for transformer prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:06:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10601818-9b19-8146-9c80-c542e0899bfd "HTTP/1.1 200 OK"
2024-09-20 09:06:34 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 08:55:34.968364
2024-09-20 09:06:34 - INFO - Starting trading cycle.
2024-09-20 09:06:34 - INFO - ##################################################
2024-09-20 09:06:34 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-20 09:06:34 - INFO - ##################################################
2024-09-20 09:06:34 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:06:34 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:06:34 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 08:50:00
2024-09-20 09:06:34 - INFO - 새로운 데이터 범위: 2024-09-18 23:50:00 ~ 2024-09-20 09:00:00
2024-09-20 09:06:34 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:06:34 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:06:34 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:06:34 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:06:34 - INFO - Sample date values: [Timestamp('2024-09-20 09:00:00')]
2024-09-20 09:06:34 - INFO - Successfully added 1 new data points
2024-09-20 09:06:34 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:06:34 - INFO - Final date range: 2024-09-20 09:00:00 to 2024-09-20 09:00:00
2024-09-20 09:06:34 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:06:34 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:00:00
2024-09-20 09:06:34 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:06:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:06:35 - INFO - GPT | 이전예측가격: 83890000 | 당시BTC가격: 83890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:06:35 - INFO - ML 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 5/15
2024-09-20 09:06:35 - INFO - ML | 이전예측가격: 83873222 | 당시BTC가격: 83890000 | 예측: 하락 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0398 | 반영가중치값: -0.0200 | 새 가중치: 0.0198 | 예측 총 횟수: 15 | 예측 성공 수: 5 | 예측 성공률: 33.33%
2024-09-20 09:06:35 - INFO - XGBOOST | 이전예측가격: 83890000 | 당시BTC가격: 83890000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:06:35 - INFO - LSTM 모델 예측 업데이트: 정확도 38.89%, 적중/전체: 7/18
2024-09-20 09:06:35 - INFO - LSTM | 이전예측가격: 83981312 | 당시BTC가격: 83890000 | 예측: 상승 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0206 | 반영가중치값: 0.0200 | 새 가중치: 0.0406 | 예측 총 횟수: 18 | 예측 성공 수: 7 | 예측 성공률: 38.89%
2024-09-20 09:06:35 - INFO - RL 모델 예측 업데이트: 정확도 55.10%, 적중/전체: 54/98
2024-09-20 09:06:35 - INFO - RL | 이전예측가격: 84728900 | 당시BTC가격: 83890000 | 예측: 상승 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2730 | 반영가중치값: 0.0200 | 새 가중치: 0.2930 | 예측 총 횟수: 98 | 예측 성공 수: 54 | 예측 성공률: 55.10%
2024-09-20 09:06:35 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.94%, 적중/전체: 9/17
2024-09-20 09:06:35 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83890000 | 예측: 상승 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0222 | 반영가중치값: 0.0200 | 새 가중치: 0.0422 | 예측 총 횟수: 17 | 예측 성공 수: 9 | 예측 성공률: 52.94%
2024-09-20 09:06:35 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 55/90
2024-09-20 09:06:35 - INFO - PROPHET | 이전예측가격: 83842228 | 당시BTC가격: 83890000 | 예측: 하락 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3300 | 반영가중치값: -0.0200 | 새 가중치: 0.3100 | 예측 총 횟수: 90 | 예측 성공 수: 55 | 예측 성공률: 61.11%
2024-09-20 09:06:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 45.61%, 적중/전체: 26/57
2024-09-20 09:06:35 - INFO - TRANSFORMER | 이전예측가격: 83983384 | 당시BTC가격: 83890000 | 예측: 상승 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0206 | 반영가중치값: 0.0200 | 새 가중치: 0.0406 | 예측 총 횟수: 57 | 예측 성공 수: 26 | 예측 성공률: 45.61%
2024-09-20 09:06:35 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 63.16%, 적중/전체: 24/38
2024-09-20 09:06:35 - INFO - BITCOIN_FORECAST | 이전예측가격: 83103997 | 당시BTC가격: 83890000 | 예측: 하락 | 지금 BTC가격: 83943000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2624 | 반영가중치값: -0.0200 | 새 가중치: 0.2424 | 예측 총 횟수: 38 | 예측 성공 수: 24 | 예측 성공률: 63.16%
2024-09-20 09:06:35 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:06:35 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:06:35 - INFO - 새로운 가중치: {'gpt': 0.005834180483429522, 'ml': 0.019463850787750838, 'xgboost': 0.023770300259106703, 'rl': 0.28760162226486247, 'lstm': 0.03981667957552164, 'arima': 0.04146154264582195, 'prophet': 0.30428948520794225, 'transformer': 0.03981667957552164, 'bitcoin_forecast': 0.23794565920004304}
2024-09-20 09:06:35 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 09:06:35 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:06:35 - INFO - Current BTC price: 83943000.0
2024-09-20 09:06:35 - INFO - Analyzing market conditions.
2024-09-20 09:06:35 - INFO - Market analysis: {'current_price': 83943000.0, 'sma_20': 83911750.0, 'rsi_14': 45.47175080300885, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:06:35 - INFO - Starting predictions for all models
2024-09-20 09:06:35 - INFO - Attempting prediction for gpt
2024-09-20 09:06:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:06:35 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:06:35 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:06:35 - INFO - GPT prediction: 83943000.0
2024-09-20 09:06:35 - INFO - Attempting prediction for ml
2024-09-20 09:06:35 - INFO - ML prediction: 83825479.8
2024-09-20 09:06:35 - INFO - Attempting prediction for xgboost
2024-09-20 09:06:35 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:06:35 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:06:35 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:06:35 - INFO - XGBOOST prediction: 83943000.0
2024-09-20 09:06:35 - INFO - Attempting prediction for lstm
2024-09-20 09:06:35 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:06:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:06:35 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:06:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:06:35 - INFO - X 샘플:
[[-2.34103183 -0.76045711 -2.38892272 -1.04938975  2.25760097  2.25085315
  -1.04938975]
 [-0.85087065 -1.56468885 -0.87214639 -1.65925554 -0.40492272 -0.40814669
  -1.65925554]
 [-0.5892393  -0.69937621 -0.3612877  -0.17665078 -0.51247771 -0.514379
  -0.17665078]
 [ 0.11602782 -0.51613354  0.18643709 -0.19768063 -0.23046556 -0.23018708
  -0.19768063]
 [ 0.07052671 -0.51613354  0.27596903 -0.12407614 -0.98476281 -0.98632004
  -0.12407614]
 [ 0.73598037  1.41809471  0.89215941  1.58985702  1.01117533  1.019309
   1.58985702]
 [ 1.31611945  1.4995359   1.41881786  1.65294659 -0.82939131 -0.82800112
   1.65294659]
 [ 0.96348589  1.05160936  0.63409677  0.64351356 -0.89144701 -0.89163463
   0.64351356]
 [ 0.46297374 -0.49577324  0.27596903 -0.61827773 -0.33127104 -0.33181326
  -0.61827773]
 [ 0.11602782  0.58332252 -0.06109238 -0.06098658  0.91596187  0.92031966
  -0.06098658]]
2024-09-20 09:06:35 - INFO - y 샘플:
[-0.06098658]
2024-09-20 09:06:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:06:35 - INFO - 모델 출력 (스케일링된 예측): [[0.4156794]]
2024-09-20 09:06:35 - INFO - 스케일러 역변환 후 예측 가격: 83988332.31248231
2024-09-20 09:06:35 - INFO - LSTMPredictor 최종 예측 가격: 83988332.31248231
2024-09-20 09:06:35 - INFO - LSTM prediction: 83988332.31248231
2024-09-20 09:06:35 - INFO - Attempting prediction for rl
2024-09-20 09:06:35 - INFO - Preparing state for RL agent.
2024-09-20 09:06:35 - INFO - Prepared state: [[8.39430000e+07 2.28779195e+01 6.31779712e-04 8.39117500e+07
  4.54717508e+01]]
2024-09-20 09:06:35 - INFO - RL prediction: 84782430.0
2024-09-20 09:06:35 - INFO - Attempting prediction for arima
2024-09-20 09:06:35 - INFO - ARIMA 예측 시작
2024-09-20 09:06:35 - INFO - 입력 데이터: {'open': 83891000.0, 'high': 84058000.0, 'low': 83818000.0, 'close': 83943000.0, 'volume': 22.87791954, 'value': 1921311970.73489, 'decision': 'sell', 'sma': 83911750.0, 'ema': 84008444.91516759, 'rsi': 45.47175080300885, 'macd': -99942.18586753309, 'signal_line': -137909.6067144002, 'BB_Upper': 84230854.92005236, 'BB_Lower': 83592645.07994764}
2024-09-20 09:06:35 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:06:35 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83911750.0         0         0
2024-09-20 09:06:35 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83911750.0         0         0
2024-09-20 09:06:35 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:06:35 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:06:35 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:06:35 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:06:35 - INFO - Attempting prediction for prophet
2024-09-20 09:06:35 - INFO - PROPHET prediction: 83912508.74173467
2024-09-20 09:06:35 - INFO - Attempting prediction for transformer
2024-09-20 09:06:35 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:06:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:06:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:06:35 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:06:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:06:35 - INFO - X 샘플:
[[-2.34103183 -0.76045711 -2.38892272 -1.04938975  2.25760097  2.25085315
  -1.04938975 -1.04938975  0.          0.          0.         -1.04938975
  -1.04938975]
 [-0.85087065 -1.56468885 -0.87214639 -1.65925554 -0.40492272 -0.40814669
  -1.65925554 -1.65925554  0.          0.          0.         -1.65925554
  -1.65925554]
 [-0.5892393  -0.69937621 -0.3612877  -0.17665078 -0.51247771 -0.514379
  -0.17665078 -0.17665078  0.          0.          0.         -0.17665078
  -0.17665078]
 [ 0.11602782 -0.51613354  0.18643709 -0.19768063 -0.23046556 -0.23018708
  -0.19768063 -0.19768063  0.          0.          0.         -0.19768063
  -0.19768063]
 [ 0.07052671 -0.51613354  0.27596903 -0.12407614 -0.98476281 -0.98632004
  -0.12407614 -0.12407614  0.          0.          0.         -0.12407614
  -0.12407614]
 [ 0.73598037  1.41809471  0.89215941  1.58985702  1.01117533  1.019309
   1.58985702  1.58985702  0.          0.          0.          1.58985702
   1.58985702]
 [ 1.31611945  1.4995359   1.41881786  1.65294659 -0.82939131 -0.82800112
   1.65294659  1.65294659  0.          0.          0.          1.65294659
   1.65294659]
 [ 0.96348589  1.05160936  0.63409677  0.64351356 -0.89144701 -0.89163463
   0.64351356  0.64351356  0.          0.          0.          0.64351356
   0.64351356]
 [ 0.46297374 -0.49577324  0.27596903 -0.61827773 -0.33127104 -0.33181326
  -0.61827773 -0.61827773  0.          0.          0.         -0.61827773
  -0.61827773]
 [ 0.11602782  0.58332252 -0.06109238 -0.06098658  0.91596187  0.92031966
  -0.06098658 -0.06098658  0.          0.          0.         -0.06098658
  -0.06098658]]
2024-09-20 09:06:35 - INFO - y 샘플:
[-0.06098658]
2024-09-20 09:06:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:06:35 - INFO - 모델 출력 (스케일링된 예측): [0.47395822]
2024-09-20 09:06:35 - INFO - 스케일러 역변환 후 예측 가격: 83993874.79762875
2024-09-20 09:06:35 - INFO - TransformerPredictor 최종 예측 가격: 83993874.79762875
2024-09-20 09:06:35 - INFO - TRANSFORMER prediction: 83993874.79762875
2024-09-20 09:06:35 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:06:35 - INFO - BITCOIN_FORECAST prediction: 83261482.74613872
2024-09-20 09:06:35 - INFO - BitcoinForecast prediction: 83261482.74613872
2024-09-20 09:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:06:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.005834180483429522, 'ml': 0.019463850787750838, 'xgboost': 0.023770300259106703, 'rl': 0.28760162226486247, 'lstm': 0.03981667957552164, 'arima': 0.04146154264582195, 'prophet': 0.30428948520794225, 'transformer': 0.03981667957552164, 'bitcoin_forecast': 0.23794565920004304}
2024-09-20 09:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.005834180483429522, 'ml': 0.019463850787750838, 'xgboost': 0.023770300259106703, 'rl': 0.28760162226486247, 'lstm': 0.03981667957552164, 'arima': 0.04146154264582195, 'prophet': 0.30428948520794225, 'transformer': 0.03981667957552164, 'bitcoin_forecast': 0.23794565920004304}
2024-09-20 09:06:41 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84022690.36421072, 'current_price': 83943000.0, 'predictions': {'gpt': 83943000.0, 'ml': 83825479.8, 'xgboost': 83943000.0, 'lstm': 83988332.31248231, 'rl': 84782430.0, 'arima': 84140000.0, 'prophet': 83912508.74173467, 'transformer': 83993874.79762875, 'bitcoin_forecast': 83261482.74613872}, 'weights': {'gpt': 0.005834180483429522, 'ml': 0.019463850787750838, 'xgboost': 0.023770300259106703, 'rl': 0.28760162226486247, 'lstm': 0.03981667957552164, 'arima': 0.04146154264582195, 'prophet': 0.30428948520794225, 'transformer': 0.03981667957552164, 'bitcoin_forecast': 0.23794565920004304}}
2024-09-20 09:06:41 - INFO - 모델별 가중치:
2024-09-20 09:06:41 - INFO -   - GPT: 0.0058
2024-09-20 09:06:41 - INFO -   - ML: 0.0195
2024-09-20 09:06:41 - INFO -   - XGBOOST: 0.0238
2024-09-20 09:06:41 - INFO -   - RL: 0.2876
2024-09-20 09:06:41 - INFO -   - LSTM: 0.0398
2024-09-20 09:06:41 - INFO -   - ARIMA: 0.0415
2024-09-20 09:06:41 - INFO -   - PROPHET: 0.3043
2024-09-20 09:06:41 - INFO -   - TRANSFORMER: 0.0398
2024-09-20 09:06:41 - INFO -   - BITCOIN_FORECAST: 0.2379
2024-09-20 09:06:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:06:41 - INFO - 6. 거래 실행
2024-09-20 09:06:41 - INFO - Cancelling existing orders.
2024-09-20 09:06:41 - INFO - Cancelled 0 orders.
2024-09-20 09:06:41 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84022690.36421072, 'current_price': 83943000.0, 'predictions': {'gpt': 83943000.0, 'ml': 83825479.8, 'xgboost': 83943000.0, 'lstm': 83988332.31248231, 'rl': 84782430.0, 'arima': 84140000.0, 'prophet': 83912508.74173467, 'transformer': 83993874.79762875, 'bitcoin_forecast': 83261482.74613872}, 'weights': {'gpt': 0.005834180483429522, 'ml': 0.019463850787750838, 'xgboost': 0.023770300259106703, 'rl': 0.28760162226486247, 'lstm': 0.03981667957552164, 'arima': 0.04146154264582195, 'prophet': 0.30428948520794225, 'transformer': 0.03981667957552164, 'bitcoin_forecast': 0.23794565920004304}}, 현재 가격=83943000.0
2024-09-20 09:06:41 - INFO - 현재 잔고: KRW=56847.98918591, BTC=0.00498694, 총 자산가치=475466.69360590994
2024-09-20 09:06:41 - INFO - 매수 시도: 0.0005664161319060672 BTC (약 47546.669360591 KRW)
2024-09-20 09:06:41 - INFO - 주문 결과: {'uuid': '20f82fa3-97f9-4563-ad67-cac1d69c77d5', 'side': 'bid', 'ord_type': 'limit', 'price': '83943000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T09:06:42+09:00', 'volume': '0.00056641', 'remaining_volume': '0.00056641', 'reserved_fee': '23.773077315', 'remaining_fee': '23.773077315', 'paid_fee': '0', 'locked': '47569.927707315', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 09:06:41 - INFO - buy 주문 성공: UUID=20f82fa3-97f9-4563-ad67-cac1d69c77d5
2024-09-20 09:06:41 - INFO - Trade executed successfully.
2024-09-20 09:06:41 - INFO - 7. summary 리포트 보내기
2024-09-20 09:06:42 - INFO - Message sent to Discord successfully.
2024-09-20 09:06:42 - INFO - Trading cycle completed.
2024-09-20 09:06:42 - INFO - Performing periodic update.
2024-09-20 09:06:42 - INFO - 계산된 시장 변동성: 0.027720378607888153
2024-09-20 09:15:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:15:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8135-9aaf-de30ce92a2b5 "HTTP/1.1 200 OK"
2024-09-20 09:15:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:15:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:15:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8118-a6d9-f9f792535d77 "HTTP/1.1 200 OK"
2024-09-20 09:15:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8182-aaed-d6f8195243ab "HTTP/1.1 200 OK"
2024-09-20 09:15:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:15:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8182-b736-cab67226021a "HTTP/1.1 200 OK"
2024-09-20 09:16:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-819a-9402-e0d0e731c17c "HTTP/1.1 200 OK"
2024-09-20 09:16:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8114-8bb4-c137012776d0 "HTTP/1.1 200 OK"
2024-09-20 09:16:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ea-a212-c7901926a597 "HTTP/1.1 200 OK"
2024-09-20 09:16:21 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814f-9cc1-dd726b9edefb "HTTP/1.1 200 OK"
2024-09-20 09:16:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:16:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815b-a6e4-e43bc3289029 "HTTP/1.1 200 OK"
2024-09-20 09:16:36 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:05:34.968600
2024-09-20 09:16:36 - INFO - Starting trading cycle.
2024-09-20 09:16:36 - INFO - ##################################################
2024-09-20 09:16:36 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-20 09:16:36 - INFO - ##################################################
2024-09-20 09:16:36 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:16:36 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:16:36 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:00:00
2024-09-20 09:16:36 - INFO - 새로운 데이터 범위: 2024-09-19 00:00:00 ~ 2024-09-20 09:10:00
2024-09-20 09:16:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:16:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:16:36 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:16:36 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:16:36 - INFO - Sample date values: [Timestamp('2024-09-20 09:10:00')]
2024-09-20 09:16:36 - INFO - Successfully added 1 new data points
2024-09-20 09:16:36 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:16:36 - INFO - Final date range: 2024-09-20 09:10:00 to 2024-09-20 09:10:00
2024-09-20 09:16:36 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:16:36 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:10:00
2024-09-20 09:16:36 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:16:36 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:16:36 - INFO - GPT | 이전예측가격: 83943000 | 당시BTC가격: 83943000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:16:36 - INFO - ML 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 6/16
2024-09-20 09:16:36 - INFO - ML | 이전예측가격: 83825480 | 당시BTC가격: 83943000 | 예측: 하락 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0382 | 반영가중치값: 0.0200 | 새 가중치: 0.0582 | 예측 총 횟수: 16 | 예측 성공 수: 6 | 예측 성공률: 37.50%
2024-09-20 09:16:36 - INFO - XGBOOST | 이전예측가격: 83943000 | 당시BTC가격: 83943000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:16:36 - INFO - LSTM 모델 예측 업데이트: 정확도 36.84%, 적중/전체: 7/19
2024-09-20 09:16:36 - INFO - LSTM | 이전예측가격: 83988332 | 당시BTC가격: 83943000 | 예측: 상승 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1136 | 반영가중치값: -0.0200 | 새 가중치: 0.0936 | 예측 총 횟수: 19 | 예측 성공 수: 7 | 예측 성공률: 36.84%
2024-09-20 09:16:36 - INFO - RL 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 54/99
2024-09-20 09:16:36 - INFO - RL | 이전예측가격: 84782430 | 당시BTC가격: 83943000 | 예측: 상승 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1528 | 반영가중치값: -0.0200 | 새 가중치: 0.1328 | 예측 총 횟수: 99 | 예측 성공 수: 54 | 예측 성공률: 54.55%
2024-09-20 09:16:36 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 9/18
2024-09-20 09:16:36 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83943000 | 예측: 상승 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0604 | 반영가중치값: -0.0200 | 새 가중치: 0.0404 | 예측 총 횟수: 18 | 예측 성공 수: 9 | 예측 성공률: 50.00%
2024-09-20 09:16:36 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 56/91
2024-09-20 09:16:36 - INFO - PROPHET | 이전예측가격: 83912509 | 당시BTC가격: 83943000 | 예측: 하락 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3080 | 반영가중치값: 0.0200 | 새 가중치: 0.3280 | 예측 총 횟수: 91 | 예측 성공 수: 56 | 예측 성공률: 61.54%
2024-09-20 09:16:36 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.83%, 적중/전체: 26/58
2024-09-20 09:16:36 - INFO - TRANSFORMER | 이전예측가격: 83993875 | 당시BTC가격: 83943000 | 예측: 상승 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1487 | 반영가중치값: -0.0200 | 새 가중치: 0.1287 | 예측 총 횟수: 58 | 예측 성공 수: 26 | 예측 성공률: 44.83%
2024-09-20 09:16:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 64.10%, 적중/전체: 25/39
2024-09-20 09:16:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83261483 | 당시BTC가격: 83943000 | 예측: 하락 | 지금 BTC가격: 83882000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1481 | 반영가중치값: 0.0200 | 새 가중치: 0.1681 | 예측 총 횟수: 39 | 예측 성공 수: 25 | 예측 성공률: 64.10%
2024-09-20 09:16:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:16:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:16:36 - INFO - 새로운 가중치: {'gpt': 0.005956616563306248, 'ml': 0.059446888163164034, 'xgboost': 0.024269143650990758, 'rl': 0.13557840008168984, 'lstm': 0.09557654895275679, 'arima': 0.041240053793796194, 'prophet': 0.33489584345870926, 'transformer': 0.1314475193434451, 'bitcoin_forecast': 0.17158898599214173}
2024-09-20 09:16:36 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 09:16:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:16:36 - INFO - Current BTC price: 83882000.0
2024-09-20 09:16:36 - INFO - Analyzing market conditions.
2024-09-20 09:16:36 - INFO - Market analysis: {'current_price': 83882000.0, 'sma_20': 83899050.0, 'rsi_14': 43.46721329750393, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:16:36 - INFO - Starting predictions for all models
2024-09-20 09:16:36 - INFO - Attempting prediction for gpt
2024-09-20 09:16:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:16:37 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:16:37 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:16:37 - INFO - GPT prediction: 83882000.0
2024-09-20 09:16:37 - INFO - Attempting prediction for ml
2024-09-20 09:16:37 - INFO - ML prediction: 83764565.2
2024-09-20 09:16:37 - INFO - Attempting prediction for xgboost
2024-09-20 09:16:37 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:16:37 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:16:37 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:16:37 - INFO - XGBOOST prediction: 83882000.0
2024-09-20 09:16:37 - INFO - Attempting prediction for lstm
2024-09-20 09:16:37 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:16:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:16:37 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:16:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:16:37 - INFO - X 샘플:
[[-1.79123569 -1.59276654 -1.75631563 -1.74903309 -0.37000943 -0.37407235
  -1.74903309]
 [-1.37340181 -0.71931392 -0.93370522 -0.21822201 -0.51110167 -0.51305626
  -0.21822201]
 [-0.24706699 -0.53434748 -0.05173117 -0.23993564 -0.14115392 -0.14124745
  -0.23993564]
 [-0.31973375 -0.53434748  0.09243766 -0.16393792 -1.13065232 -1.13049759
  -0.16393792]
 [ 0.74301764  1.41807601  1.08465847  1.60572312  1.48764916  1.49347056
   1.60572312]
 [ 1.66951886  1.50028332  1.93271044  1.67086401 -0.92683368 -0.92336866
   1.67086401]
 [ 1.10635146  1.04814314  0.66911301  0.62860966 -1.00823926 -1.0066205
   0.62860966]
 [ 0.30701707 -0.51379566  0.09243766 -0.67420829 -0.27339206 -0.27420518
  -0.67420829]
 [-0.24706699  0.57545114 -0.4503156  -0.09879703  1.36274671  1.36396262
  -0.09879703]
 [ 0.1526002  -0.64738253 -0.67928963 -0.76106282  1.51098647  1.50563481
  -0.76106282]]
2024-09-20 09:16:37 - INFO - y 샘플:
[-0.76106282]
2024-09-20 09:16:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:16:37 - INFO - 모델 출력 (스케일링된 예측): [[0.34163153]]
2024-09-20 09:16:37 - INFO - 스케일러 역변환 후 예측 가격: 83983567.00887345
2024-09-20 09:16:37 - INFO - LSTMPredictor 최종 예측 가격: 83983567.00887345
2024-09-20 09:16:37 - INFO - LSTM prediction: 83983567.00887345
2024-09-20 09:16:37 - INFO - Attempting prediction for rl
2024-09-20 09:16:37 - INFO - Preparing state for RL agent.
2024-09-20 09:16:37 - INFO - Prepared state: [[ 8.38820000e+07  2.37861578e+01 -7.26683583e-04  8.38990500e+07
   4.34672133e+01]]
2024-09-20 09:16:37 - INFO - RL prediction: 84720820.0
2024-09-20 09:16:37 - INFO - Attempting prediction for arima
2024-09-20 09:16:37 - INFO - ARIMA 예측 시작
2024-09-20 09:16:37 - INFO - 입력 데이터: {'open': 83935000.0, 'high': 83939000.0, 'low': 83791000.0, 'close': 83882000.0, 'volume': 23.78615781, 'value': 1994198836.62489, 'decision': 'sell', 'sma': 83899050.0, 'ema': 83996402.54229449, 'rsi': 43.46721329750393, 'macd': -98422.21555823088, 'signal_line': -130012.12848316635, 'BB_Upper': 84201212.522491, 'BB_Lower': 83596887.477509}
2024-09-20 09:16:37 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:16:37 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83899050.0         0         0
2024-09-20 09:16:37 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83899050.0         0         0
2024-09-20 09:16:37 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:16:37 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:16:37 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:16:37 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:16:37 - INFO - Attempting prediction for prophet
2024-09-20 09:16:37 - INFO - PROPHET prediction: 83841238.60062931
2024-09-20 09:16:37 - INFO - Attempting prediction for transformer
2024-09-20 09:16:37 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:16:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:16:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:16:37 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:16:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:16:37 - INFO - X 샘플:
[[-1.79123569 -1.59276654 -1.75631563 -1.74903309 -0.37000943 -0.37407235
  -1.74903309 -1.74903309  0.          0.          0.         -1.74903309
  -1.74903309]
 [-1.37340181 -0.71931392 -0.93370522 -0.21822201 -0.51110167 -0.51305626
  -0.21822201 -0.21822201  0.          0.          0.         -0.21822201
  -0.21822201]
 [-0.24706699 -0.53434748 -0.05173117 -0.23993564 -0.14115392 -0.14124745
  -0.23993564 -0.23993564  0.          0.          0.         -0.23993564
  -0.23993564]
 [-0.31973375 -0.53434748  0.09243766 -0.16393792 -1.13065232 -1.13049759
  -0.16393792 -0.16393792  0.          0.          0.         -0.16393792
  -0.16393792]
 [ 0.74301764  1.41807601  1.08465847  1.60572312  1.48764916  1.49347056
   1.60572312  1.60572312  0.          0.          0.          1.60572312
   1.60572312]
 [ 1.66951886  1.50028332  1.93271044  1.67086401 -0.92683368 -0.92336866
   1.67086401  1.67086401  0.          0.          0.          1.67086401
   1.67086401]
 [ 1.10635146  1.04814314  0.66911301  0.62860966 -1.00823926 -1.0066205
   0.62860966  0.62860966  0.          0.          0.          0.62860966
   0.62860966]
 [ 0.30701707 -0.51379566  0.09243766 -0.67420829 -0.27339206 -0.27420518
  -0.67420829 -0.67420829  0.          0.          0.         -0.67420829
  -0.67420829]
 [-0.24706699  0.57545114 -0.4503156  -0.09879703  1.36274671  1.36396262
  -0.09879703 -0.09879703  0.          0.          0.         -0.09879703
  -0.09879703]
 [ 0.1526002  -0.64738253 -0.67928963 -0.76106282  1.51098647  1.50563481
  -0.76106282 -0.76106282  0.          0.          0.         -0.76106282
  -0.76106282]]
2024-09-20 09:16:37 - INFO - y 샘플:
[-0.76106282]
2024-09-20 09:16:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:16:37 - INFO - 모델 출력 (스케일링된 예측): [0.47181204]
2024-09-20 09:16:37 - INFO - 스케일러 역변환 후 예측 가격: 83995557.67957243
2024-09-20 09:16:37 - INFO - TransformerPredictor 최종 예측 가격: 83995557.67957243
2024-09-20 09:16:37 - INFO - TRANSFORMER prediction: 83995557.67957243
2024-09-20 09:16:37 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:16:37 - INFO - BITCOIN_FORECAST prediction: 83292426.03918147
2024-09-20 09:16:37 - INFO - BitcoinForecast prediction: 83292426.03918147
2024-09-20 09:16:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:16:42 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:16:42 - INFO - 조정된 모델 가중치: {'gpt': 0.005956616563306248, 'ml': 0.059446888163164034, 'xgboost': 0.024269143650990758, 'rl': 0.13557840008168984, 'lstm': 0.09557654895275679, 'arima': 0.041240053793796194, 'prophet': 0.33489584345870926, 'transformer': 0.1314475193434451, 'bitcoin_forecast': 0.17158898599214173}
2024-09-20 09:16:42 - INFO - 조정된 모델 가중치: {'gpt': 0.005956616563306248, 'ml': 0.059446888163164034, 'xgboost': 0.024269143650990758, 'rl': 0.13557840008168984, 'lstm': 0.09557654895275679, 'arima': 0.041240053793796194, 'prophet': 0.33489584345870926, 'transformer': 0.1314475193434451, 'bitcoin_forecast': 0.17158898599214173}
2024-09-20 09:16:42 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83909203.752164, 'current_price': 83882000.0, 'predictions': {'gpt': 83882000.0, 'ml': 83764565.2, 'xgboost': 83882000.0, 'lstm': 83983567.00887345, 'rl': 84720820.0, 'arima': 84140000.0, 'prophet': 83841238.60062931, 'transformer': 83995557.67957243, 'bitcoin_forecast': 83292426.03918147}, 'weights': {'gpt': 0.005956616563306248, 'ml': 0.059446888163164034, 'xgboost': 0.024269143650990758, 'rl': 0.13557840008168984, 'lstm': 0.09557654895275679, 'arima': 0.041240053793796194, 'prophet': 0.33489584345870926, 'transformer': 0.1314475193434451, 'bitcoin_forecast': 0.17158898599214173}}
2024-09-20 09:16:42 - INFO - 모델별 가중치:
2024-09-20 09:16:42 - INFO -   - GPT: 0.0060
2024-09-20 09:16:42 - INFO -   - ML: 0.0594
2024-09-20 09:16:42 - INFO -   - XGBOOST: 0.0243
2024-09-20 09:16:42 - INFO -   - RL: 0.1356
2024-09-20 09:16:42 - INFO -   - LSTM: 0.0956
2024-09-20 09:16:42 - INFO -   - ARIMA: 0.0412
2024-09-20 09:16:42 - INFO -   - PROPHET: 0.3349
2024-09-20 09:16:42 - INFO -   - TRANSFORMER: 0.1314
2024-09-20 09:16:42 - INFO -   - BITCOIN_FORECAST: 0.1716
2024-09-20 09:16:42 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:16:42 - INFO - 6. 거래 실행
2024-09-20 09:16:42 - INFO - Cancelling existing orders.
2024-09-20 09:16:42 - INFO - Cancelled 0 orders.
2024-09-20 09:16:42 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83909203.752164, 'current_price': 83882000.0, 'predictions': {'gpt': 83882000.0, 'ml': 83764565.2, 'xgboost': 83882000.0, 'lstm': 83983567.00887345, 'rl': 84720820.0, 'arima': 84140000.0, 'prophet': 83841238.60062931, 'transformer': 83995557.67957243, 'bitcoin_forecast': 83292426.03918147}, 'weights': {'gpt': 0.005956616563306248, 'ml': 0.059446888163164034, 'xgboost': 0.024269143650990758, 'rl': 0.13557840008168984, 'lstm': 0.09557654895275679, 'arima': 0.041240053793796194, 'prophet': 0.33489584345870926, 'transformer': 0.1314475193434451, 'bitcoin_forecast': 0.17158898599214173}}, 현재 가격=83882000.0
2024-09-20 09:16:42 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=475104.16617859004
2024-09-20 09:16:42 - INFO - 매수 시도: 0.00011060849143546887 BTC (약 9278.06147859 KRW)
2024-09-20 09:16:42 - INFO - 주문 결과: None
2024-09-20 09:16:42 - ERROR - 주문 실패
2024-09-20 09:16:42 - WARNING - Trade execution failed: Failed to place order
2024-09-20 09:16:42 - INFO - 7. summary 리포트 보내기
2024-09-20 09:16:43 - INFO - Message sent to Discord successfully.
2024-09-20 09:16:43 - INFO - Trading cycle completed.
2024-09-20 09:16:43 - INFO - Performing periodic update.
2024-09-20 09:16:43 - INFO - 계산된 시장 변동성: 0.027648001836866002
2024-09-20 09:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:25:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8117-8997-c1c988e12fd0 "HTTP/1.1 200 OK"
2024-09-20 09:25:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:25:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:25:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818d-9fe0-ff4aab60b215 "HTTP/1.1 200 OK"
2024-09-20 09:25:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:25:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8144-b938-fc7abf86859a "HTTP/1.1 200 OK"
2024-09-20 09:25:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8167-a717-e5b1f3f77f80 "HTTP/1.1 200 OK"
2024-09-20 09:26:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ae-8ace-cf8207b7f006 "HTTP/1.1 200 OK"
2024-09-20 09:26:11 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815e-a8ef-cdf854ac6912 "HTTP/1.1 200 OK"
2024-09-20 09:26:21 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81cd-8898-df15d8a4cf41 "HTTP/1.1 200 OK"
2024-09-20 09:26:31 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/e71c9b69-7226-4dd5-83c4-3b609a9a6770 "HTTP/1.1 200 OK"
2024-09-20 09:26:38 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:26:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8156-a85c-ee5f3b32894e "HTTP/1.1 200 OK"
2024-09-20 09:26:46 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:15:34.969105
2024-09-20 09:26:46 - INFO - Starting trading cycle.
2024-09-20 09:26:46 - INFO - ##################################################
2024-09-20 09:26:46 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-20 09:26:46 - INFO - ##################################################
2024-09-20 09:26:46 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:26:46 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:26:46 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:10:00
2024-09-20 09:26:46 - INFO - 새로운 데이터 범위: 2024-09-19 00:10:00 ~ 2024-09-20 09:20:00
2024-09-20 09:26:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:26:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:26:46 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:26:46 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:26:46 - INFO - Sample date values: [Timestamp('2024-09-20 09:20:00')]
2024-09-20 09:26:46 - INFO - Successfully added 1 new data points
2024-09-20 09:26:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:26:46 - INFO - Final date range: 2024-09-20 09:20:00 to 2024-09-20 09:20:00
2024-09-20 09:26:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:26:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:20:00
2024-09-20 09:26:46 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:26:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:26:46 - INFO - GPT | 이전예측가격: 83882000 | 당시BTC가격: 83882000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:26:46 - INFO - ML 모델 예측 업데이트: 정확도 41.18%, 적중/전체: 7/17
2024-09-20 09:26:46 - INFO - ML | 이전예측가격: 83764565 | 당시BTC가격: 83882000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0195 | 반영가중치값: 0.0200 | 새 가중치: 0.0395 | 예측 총 횟수: 17 | 예측 성공 수: 7 | 예측 성공률: 41.18%
2024-09-20 09:26:46 - INFO - XGBOOST | 이전예측가격: 83882000 | 당시BTC가격: 83882000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:26:46 - INFO - LSTM 모델 예측 업데이트: 정확도 35.00%, 적중/전체: 7/20
2024-09-20 09:26:46 - INFO - LSTM | 이전예측가격: 83983567 | 당시BTC가격: 83882000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0398 | 반영가중치값: -0.0200 | 새 가중치: 0.0198 | 예측 총 횟수: 20 | 예측 성공 수: 7 | 예측 성공률: 35.00%
2024-09-20 09:26:46 - INFO - RL 모델 예측 업데이트: 정확도 54.00%, 적중/전체: 54/100
2024-09-20 09:26:46 - INFO - RL | 이전예측가격: 84720820 | 당시BTC가격: 83882000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2876 | 반영가중치값: -0.0200 | 새 가중치: 0.2676 | 예측 총 횟수: 100 | 예측 성공 수: 54 | 예측 성공률: 54.00%
2024-09-20 09:26:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 47.37%, 적중/전체: 9/19
2024-09-20 09:26:46 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83882000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0415 | 반영가중치값: -0.0200 | 새 가중치: 0.0215 | 예측 총 횟수: 19 | 예측 성공 수: 9 | 예측 성공률: 47.37%
2024-09-20 09:26:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.96%, 적중/전체: 57/92
2024-09-20 09:26:46 - INFO - PROPHET | 이전예측가격: 83841239 | 당시BTC가격: 83882000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3043 | 반영가중치값: 0.0200 | 새 가중치: 0.3243 | 예측 총 횟수: 92 | 예측 성공 수: 57 | 예측 성공률: 61.96%
2024-09-20 09:26:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 44.07%, 적중/전체: 26/59
2024-09-20 09:26:46 - INFO - TRANSFORMER | 이전예측가격: 83995558 | 당시BTC가격: 83882000 | 예측: 상승 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0398 | 반영가중치값: -0.0200 | 새 가중치: 0.0198 | 예측 총 횟수: 59 | 예측 성공 수: 26 | 예측 성공률: 44.07%
2024-09-20 09:26:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 65.00%, 적중/전체: 26/40
2024-09-20 09:26:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 83292426 | 당시BTC가격: 83882000 | 예측: 하락 | 지금 BTC가격: 83650000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2379 | 반영가중치값: 0.0200 | 새 가중치: 0.2579 | 예측 총 횟수: 40 | 예측 성공 수: 26 | 예측 성공률: 65.00%
2024-09-20 09:26:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:26:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:26:46 - INFO - 새로운 가중치: {'gpt': 0.0060743292930732105, 'ml': 0.04024372264184309, 'xgboost': 0.0247487426176026, 'rl': 0.27288987896429656, 'lstm': 0.020208290387290443, 'arima': 0.02188565870953036, 'prophet': 0.3306979891183168, 'transformer': 0.020208290387290443, 'bitcoin_forecast': 0.26304309788075647}
2024-09-20 09:26:46 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 09:26:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:26:46 - INFO - Current BTC price: 83650000.0
2024-09-20 09:26:46 - INFO - Analyzing market conditions.
2024-09-20 09:26:46 - INFO - Market analysis: {'current_price': 83650000.0, 'sma_20': 83882200.0, 'rsi_14': 36.819228370023836, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:26:46 - INFO - Starting predictions for all models
2024-09-20 09:26:46 - INFO - Attempting prediction for gpt
2024-09-20 09:26:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:26:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:26:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:26:47 - INFO - GPT prediction: 83650000.0
2024-09-20 09:26:47 - INFO - Attempting prediction for ml
2024-09-20 09:26:47 - INFO - ML prediction: 83549620.0
2024-09-20 09:26:47 - INFO - Attempting prediction for xgboost
2024-09-20 09:26:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:26:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:26:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:26:47 - INFO - XGBOOST prediction: 83650000.0
2024-09-20 09:26:47 - INFO - Attempting prediction for lstm
2024-09-20 09:26:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:26:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:26:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:26:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:26:47 - INFO - X 샘플:
[[-1.4980865  -0.54079888 -0.82988    -0.04929273 -0.64664025 -0.64885095
  -0.04929273]
 [-0.30039001 -0.38199986 -0.01024543 -0.06572363 -0.3429416  -0.34290944
  -0.06572363]
 [-0.37766075 -0.38199986  0.1237333  -0.00821545 -1.15524369 -1.15691028
  -0.00821545]
 [ 0.75242385  1.29421199  1.04582218  1.3309036   0.99418047  1.00221226
   1.3309036 ]
 [ 1.7376258   1.36478934  1.83393235  1.38019632 -0.98792426 -0.986475
   1.38019632]
 [ 1.13877755  0.97661396  0.65964821  0.59151271 -1.05475199 -1.05497847
   0.59151271]
 [ 0.2887994  -0.36435552  0.1237333  -0.39434181 -0.45149894 -0.45231322
  -0.39434181]
 [-0.30039001  0.57079425 -0.38065721  0.04107727  0.89164517  0.89564713
   0.04107727]
 [ 0.12459907 -0.4790437  -0.59344695 -0.46006544  1.01333861  1.01222158
  -0.46006544]
 [-1.5656984  -2.05821171 -1.97263973 -2.36605084  1.73983649  1.73235639
  -2.36605084]]
2024-09-20 09:26:47 - INFO - y 샘플:
[-2.36605084]
2024-09-20 09:26:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:26:47 - INFO - 모델 출력 (스케일링된 예측): [[0.26049203]]
2024-09-20 09:26:47 - INFO - 스케일러 역변환 후 예측 가격: 83969707.56203166
2024-09-20 09:26:47 - INFO - LSTMPredictor 최종 예측 가격: 83969707.56203166
2024-09-20 09:26:47 - INFO - LSTM prediction: 83969707.56203166
2024-09-20 09:26:47 - INFO - Attempting prediction for rl
2024-09-20 09:26:47 - INFO - Preparing state for RL agent.
2024-09-20 09:26:47 - INFO - Prepared state: [[ 8.36500000e+07  2.92082513e+01 -2.76579004e-03  8.38822000e+07
   3.68192284e+01]]
2024-09-20 09:26:47 - INFO - RL prediction: 84486500.0
2024-09-20 09:26:47 - INFO - Attempting prediction for arima
2024-09-20 09:26:47 - INFO - ARIMA 예측 시작
2024-09-20 09:26:47 - INFO - 입력 데이터: {'open': 83760000.0, 'high': 83760000.0, 'low': 83616000.0, 'close': 83650000.0, 'volume': 29.20825126, 'value': 2444455066.43227, 'decision': 'sell', 'sma': 83882200.0, 'ema': 83963411.82398073, 'rsi': 36.819228370023836, 'macd': -114616.857446298, 'signal_line': -126933.0742757927, 'BB_Upper': 84200043.7351933, 'BB_Lower': 83564356.2648067}
2024-09-20 09:26:47 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:26:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83882200.0         0         0
2024-09-20 09:26:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83882200.0         0         0
2024-09-20 09:26:47 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:26:47 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:26:47 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:26:47 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:26:47 - INFO - Attempting prediction for prophet
2024-09-20 09:26:47 - INFO - PROPHET prediction: 83576370.59499413
2024-09-20 09:26:47 - INFO - Attempting prediction for transformer
2024-09-20 09:26:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:26:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:26:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:26:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:26:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:26:47 - INFO - X 샘플:
[[-1.4980865  -0.54079888 -0.82988    -0.04929273 -0.64664025 -0.64885095
  -0.04929273 -0.04929273  0.          0.          0.         -0.04929273
  -0.04929273]
 [-0.30039001 -0.38199986 -0.01024543 -0.06572363 -0.3429416  -0.34290944
  -0.06572363 -0.06572363  0.          0.          0.         -0.06572363
  -0.06572363]
 [-0.37766075 -0.38199986  0.1237333  -0.00821545 -1.15524369 -1.15691028
  -0.00821545 -0.00821545  0.          0.          0.         -0.00821545
  -0.00821545]
 [ 0.75242385  1.29421199  1.04582218  1.3309036   0.99418047  1.00221226
   1.3309036   1.3309036   0.          0.          0.          1.3309036
   1.3309036 ]
 [ 1.7376258   1.36478934  1.83393235  1.38019632 -0.98792426 -0.986475
   1.38019632  1.38019632  0.          0.          0.          1.38019632
   1.38019632]
 [ 1.13877755  0.97661396  0.65964821  0.59151271 -1.05475199 -1.05497847
   0.59151271  0.59151271  0.          0.          0.          0.59151271
   0.59151271]
 [ 0.2887994  -0.36435552  0.1237333  -0.39434181 -0.45149894 -0.45231322
  -0.39434181 -0.39434181  0.          0.          0.         -0.39434181
  -0.39434181]
 [-0.30039001  0.57079425 -0.38065721  0.04107727  0.89164517  0.89564713
   0.04107727  0.04107727  0.          0.          0.          0.04107727
   0.04107727]
 [ 0.12459907 -0.4790437  -0.59344695 -0.46006544  1.01333861  1.01222158
  -0.46006544 -0.46006544  0.          0.          0.         -0.46006544
  -0.46006544]
 [-1.5656984  -2.05821171 -1.97263973 -2.36605084  1.73983649  1.73235639
  -2.36605084 -2.36605084  0.          0.          0.         -2.36605084
  -2.36605084]]
2024-09-20 09:26:47 - INFO - y 샘플:
[-2.36605084]
2024-09-20 09:26:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:26:47 - INFO - 모델 출력 (스케일링된 예측): [0.4650549]
2024-09-20 09:26:47 - INFO - 스케일러 역변환 후 예측 가격: 83994607.32596456
2024-09-20 09:26:47 - INFO - TransformerPredictor 최종 예측 가격: 83994607.32596456
2024-09-20 09:26:47 - INFO - TRANSFORMER prediction: 83994607.32596456
2024-09-20 09:26:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:26:47 - INFO - BITCOIN_FORECAST prediction: 83346172.04284365
2024-09-20 09:26:47 - INFO - BitcoinForecast prediction: 83346172.04284365
2024-09-20 09:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:26:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:27:00 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:27:00 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:27:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0060743292930732105, 'ml': 0.04024372264184309, 'xgboost': 0.0247487426176026, 'rl': 0.27288987896429656, 'lstm': 0.020208290387290443, 'arima': 0.02188565870953036, 'prophet': 0.3306979891183168, 'transformer': 0.020208290387290443, 'bitcoin_forecast': 0.26304309788075647}
2024-09-20 09:27:00 - INFO - 조정된 모델 가중치: {'gpt': 0.0060743292930732105, 'ml': 0.04024372264184309, 'xgboost': 0.0247487426176026, 'rl': 0.27288987896429656, 'lstm': 0.020208290387290443, 'arima': 0.02188565870953036, 'prophet': 0.3306979891183168, 'transformer': 0.020208290387290443, 'bitcoin_forecast': 0.26304309788075647}
2024-09-20 09:27:00 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83794112.41655913, 'current_price': 83650000.0, 'predictions': {'gpt': 83650000.0, 'ml': 83549620.0, 'xgboost': 83650000.0, 'lstm': 83969707.56203166, 'rl': 84486500.0, 'arima': 84140000.0, 'prophet': 83576370.59499413, 'transformer': 83994607.32596456, 'bitcoin_forecast': 83346172.04284365}, 'weights': {'gpt': 0.0060743292930732105, 'ml': 0.04024372264184309, 'xgboost': 0.0247487426176026, 'rl': 0.27288987896429656, 'lstm': 0.020208290387290443, 'arima': 0.02188565870953036, 'prophet': 0.3306979891183168, 'transformer': 0.020208290387290443, 'bitcoin_forecast': 0.26304309788075647}}
2024-09-20 09:27:00 - INFO - 모델별 가중치:
2024-09-20 09:27:00 - INFO -   - GPT: 0.0061
2024-09-20 09:27:00 - INFO -   - ML: 0.0402
2024-09-20 09:27:00 - INFO -   - XGBOOST: 0.0247
2024-09-20 09:27:00 - INFO -   - RL: 0.2729
2024-09-20 09:27:00 - INFO -   - LSTM: 0.0202
2024-09-20 09:27:00 - INFO -   - ARIMA: 0.0219
2024-09-20 09:27:00 - INFO -   - PROPHET: 0.3307
2024-09-20 09:27:00 - INFO -   - TRANSFORMER: 0.0202
2024-09-20 09:27:00 - INFO -   - BITCOIN_FORECAST: 0.2630
2024-09-20 09:27:00 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:27:00 - INFO - 6. 거래 실행
2024-09-20 09:27:00 - INFO - Cancelling existing orders.
2024-09-20 09:27:00 - INFO - Cancelled 0 orders.
2024-09-20 09:27:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83794112.41655913, 'current_price': 83650000.0, 'predictions': {'gpt': 83650000.0, 'ml': 83549620.0, 'xgboost': 83650000.0, 'lstm': 83969707.56203166, 'rl': 84486500.0, 'arima': 84140000.0, 'prophet': 83576370.59499413, 'transformer': 83994607.32596456, 'bitcoin_forecast': 83346172.04284365}, 'weights': {'gpt': 0.0060743292930732105, 'ml': 0.04024372264184309, 'xgboost': 0.0247487426176026, 'rl': 0.27288987896429656, 'lstm': 0.020208290387290443, 'arima': 0.02188565870953036, 'prophet': 0.3306979891183168, 'transformer': 0.020208290387290443, 'bitcoin_forecast': 0.26304309788075647}}, 현재 가격=83650000.0
2024-09-20 09:27:00 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=473815.78897859005
2024-09-20 09:27:00 - INFO - 매수 시도: 0.00011091525975600717 BTC (약 9278.06147859 KRW)
2024-09-20 09:27:00 - INFO - 주문 결과: None
2024-09-20 09:27:00 - ERROR - 주문 실패
2024-09-20 09:27:00 - WARNING - Trade execution failed: Failed to place order
2024-09-20 09:27:00 - INFO - 7. summary 리포트 보내기
2024-09-20 09:27:01 - INFO - Message sent to Discord successfully.
2024-09-20 09:27:01 - INFO - Trading cycle completed.
2024-09-20 09:27:01 - INFO - Performing periodic update.
2024-09-20 09:27:01 - INFO - 계산된 시장 변동성: 0.02798232847784243
2024-09-20 09:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81fc-95f3-f5a85a6c172f "HTTP/1.1 200 OK"
2024-09-20 09:35:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:35:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:35:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8148-a788-ce5782c3c07e "HTTP/1.1 200 OK"
2024-09-20 09:35:53 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:35:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:35:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/d2390776-8f75-4e34-92f8-61df537ecd8d "HTTP/1.1 200 OK"
2024-09-20 09:35:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8190-8e55-fced03a379e3 "HTTP/1.1 200 OK"
2024-09-20 09:36:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8100-84ea-c17bb112dd4b "HTTP/1.1 200 OK"
2024-09-20 09:36:11 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814b-a4df-d8eb72af32c6 "HTTP/1.1 200 OK"
2024-09-20 09:36:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ee-a808-e6b48efbd07c "HTTP/1.1 200 OK"
2024-09-20 09:36:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8184-9940-d9b669806e26 "HTTP/1.1 200 OK"
2024-09-20 09:36:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/25858508-c450-45af-a20d-936fe5fdc80c "HTTP/1.1 200 OK"
2024-09-20 09:36:40 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:25:34.969385
2024-09-20 09:36:40 - INFO - Starting trading cycle.
2024-09-20 09:36:40 - INFO - ##################################################
2024-09-20 09:36:40 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-20 09:36:40 - INFO - ##################################################
2024-09-20 09:36:40 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:36:40 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:36:40 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:20:00
2024-09-20 09:36:40 - INFO - 새로운 데이터 범위: 2024-09-19 00:20:00 ~ 2024-09-20 09:30:00
2024-09-20 09:36:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:36:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:36:40 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:36:40 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:36:40 - INFO - Sample date values: [Timestamp('2024-09-20 09:30:00')]
2024-09-20 09:36:40 - INFO - Successfully added 1 new data points
2024-09-20 09:36:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:36:40 - INFO - Final date range: 2024-09-20 09:30:00 to 2024-09-20 09:30:00
2024-09-20 09:36:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:36:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:30:00
2024-09-20 09:36:40 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:36:40 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-20 09:36:40 - INFO - 재학습 대상 모델: ['lstm', 'ml', 'transformer']
2024-09-20 09:36:40 - INFO - lstm 모델 재학습 시작
2024-09-20 09:36:40 - INFO - LSTM 하이퍼파라미터 랜덤 조정: hidden_dim=92, num_layers=1, learning_rate=0.000625318285860949
2024-09-20 09:36:40 - INFO - LSTM 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 09:36:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 09:36:40 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-20 09:36:40 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:36:40 - INFO - NaN 값 개수:
date           0
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:36:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:36:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:36:40 - INFO - X 샘플:
[[ 0.43890352  0.43810167  0.44165719  0.44117035 -0.00646737  0.06643945
   0.45298875]
 [ 0.43842525  0.43810167  0.44267416  0.44158886 -0.13289626 -0.09992457
   0.45126345]
 [ 0.44541984  0.44945297  0.44967335  0.45133404  0.20164591  0.341353
   0.45011426]
 [ 0.45151769  0.44993092  0.45565557  0.45169276 -0.10685421 -0.06509132
   0.44928042]
 [ 0.44781116  0.4473022   0.44674207  0.44595327 -0.11725546 -0.07909193
   0.44809787]
 [ 0.44255027  0.43822116  0.44267416  0.43877889 -0.02336353  0.04407971
   0.44704875]
 [ 0.43890352  0.44455399  0.43884555  0.44194758  0.18568704  0.31957341
   0.44618458]
 [ 0.44153396  0.43744449  0.43723035  0.4383006   0.20462774  0.34339868
   0.44541441]
 [ 0.43107197  0.42675036  0.42676147  0.42443015  0.31770183  0.49057854
   0.44439257]
 [ 0.41552843  0.41211315  0.41246398  0.40960312  0.59304261  0.84845856
   0.44215484]]
2024-09-20 09:36:40 - INFO - y 샘플:
[0.40960312]
2024-09-20 09:36:40 - INFO - Epoch [10/50], Loss: 0.0342
2024-09-20 09:36:40 - INFO - Epoch [20/50], Loss: 0.0047
2024-09-20 09:36:40 - INFO - Epoch [30/50], Loss: 0.0001
2024-09-20 09:36:40 - INFO - Epoch [40/50], Loss: 0.0012
2024-09-20 09:36:40 - INFO - Epoch [50/50], Loss: 0.0000
2024-09-20 09:36:40 - INFO - LSTM 훈련 완료. MSE: 1.882907235994935e-05
2024-09-20 09:36:40 - INFO - lstm 모델의 예측 통계가 초기화되었습니다.
2024-09-20 09:36:40 - INFO - lstm 모델 재학습 완료
2024-09-20 09:36:40 - INFO - ml 모델 재학습 시작
2024-09-20 09:36:41 - INFO - prepare_data_for_ml 메서드 시작. 데이터 shape: (5000, 15)
2024-09-20 09:36:41 - INFO - 최종 X shape: (4999, 12), y shape: (4999,)
2024-09-20 09:36:41 - INFO - ML 모델 훈련 시작
2024-09-20 09:36:44 - INFO - ML 모델 학습 완료. MSE: 0.2726, RMSE: 0.5221, MAE: 0.4973, R2: -0.0904
2024-09-20 09:36:45 - INFO - ml 모델의 예측 통계가 초기화되었습니다.
2024-09-20 09:36:45 - INFO - ml 모델 재학습 완료
2024-09-20 09:36:45 - INFO - transformer 모델 재학습 시작
2024-09-20 09:36:45 - INFO - Transformer 학습률 조정: learning_rate=0.00028242953648100003
2024-09-20 09:36:45 - INFO - Transformer 훈련 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 09:36:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (5000, 15)
2024-09-20 09:36:45 - INFO - 기술적 지표 계산 후 데이터 shape: (5000, 15)
2024-09-20 09:36:45 - INFO - 데이터 컬럼: ['date', 'open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:36:45 - INFO - NaN 값 개수:
date            0
open            0
high            0
low             0
close           0
volume          0
value           0
decision        0
sma            19
ema            19
rsi            14
macd           25
signal_line    33
BB_Upper       19
BB_Lower       19
dtype: int64
2024-09-20 09:36:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:36:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:36:45 - INFO - X 샘플:
[[ 0.43890352  0.43810167  0.44165719  0.44117035 -0.00646737  0.06643945
   0.45298875  0.456354   -0.43686375 -0.1053102  -0.115039    0.43632314
   0.42587105]
 [ 0.43842525  0.43810167  0.44267416  0.44158886 -0.13289626 -0.09992457
   0.45126345  0.45585634 -0.4172321  -0.09584994 -0.11234114  0.43169707
   0.42679829]
 [ 0.44541984  0.44945297  0.44967335  0.45133404  0.20164591  0.341353
   0.45011426  0.45635465  0.02215739 -0.08002725 -0.10682847  0.42752755
   0.42835174]
 [ 0.45151769  0.44993092  0.45565557  0.45169276 -0.10685421 -0.06509132
   0.44928042  0.45684041  0.03771138 -0.06643299 -0.0995364   0.42453075
   0.42945433]
 [ 0.44781116  0.4473022   0.44674207  0.44595327 -0.11725546 -0.07909193
   0.44809787  0.45672125 -0.21688858 -0.05930877 -0.09219242  0.42022846
   0.43106298]
 [ 0.44255027  0.43822116  0.44267416  0.43877889 -0.02336353  0.04407971
   0.44704875  0.4559151  -0.51108867 -0.05840993 -0.08612668  0.41761111
   0.43145852]
 [ 0.43890352  0.44455399  0.43884555  0.44194758  0.18568704  0.31957341
   0.44618458  0.45549415 -0.34942667 -0.05464911 -0.08047681  0.41494605
   0.43222219]
 [ 0.44153396  0.43744449  0.43723035  0.4383006   0.20462774  0.34339868
   0.44541441  0.45475831 -0.50321387 -0.05379558 -0.07577597  0.41309775
   0.43244968]
 [ 0.43107197  0.42675036  0.42676147  0.42443015  0.31770183  0.49057854
   0.44439257  0.45274243 -1.01324423 -0.06288965 -0.07394321  0.41302488
   0.43070524]
 [ 0.41552843  0.41211315  0.41246398  0.40960312  0.59304261  0.84845856
   0.44215484  0.44947532 -1.4361323  -0.08039052 -0.07618714  0.41324884
   0.42655521]]
2024-09-20 09:36:45 - INFO - y 샘플:
[0.40960312]
2024-09-20 09:36:45 - INFO - Epoch [1/50], Loss: 0.0142
2024-09-20 09:36:45 - INFO - Epoch [2/50], Loss: 0.0083
2024-09-20 09:36:45 - INFO - Epoch [3/50], Loss: 0.0166
2024-09-20 09:36:45 - INFO - Epoch [4/50], Loss: 0.0215
2024-09-20 09:36:45 - INFO - Epoch [5/50], Loss: 0.0010
2024-09-20 09:36:45 - INFO - Epoch [6/50], Loss: 0.0005
2024-09-20 09:36:45 - INFO - Epoch [7/50], Loss: 0.0010
2024-09-20 09:36:45 - INFO - Epoch [8/50], Loss: 0.0001
2024-09-20 09:36:45 - INFO - Epoch [9/50], Loss: 0.0252
2024-09-20 09:36:45 - INFO - Epoch [10/50], Loss: 0.0011
2024-09-20 09:36:45 - INFO - Epoch [11/50], Loss: 0.0030
2024-09-20 09:36:45 - INFO - 조기 종료: 3 에폭 동안 개선 없음
2024-09-20 09:36:45 - INFO - Transformer 훈련 완료. MSE: 0.004604712128639221
2024-09-20 09:36:45 - INFO - transformer 모델의 예측 통계가 초기화되었습니다.
2024-09-20 09:36:45 - INFO - transformer 모델 재학습 완료
2024-09-20 09:36:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:36:45 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:36:45 - INFO - GPT | 이전예측가격: 83650000 | 당시BTC가격: 83650000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:36:45 - INFO - ML 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 09:36:45 - INFO - ML | 이전예측가격: 83549620 | 당시BTC가격: 83650000 | 예측: 하락 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0594 | 반영가중치값: 0.0200 | 새 가중치: 0.0794 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 09:36:45 - INFO - XGBOOST | 이전예측가격: 83650000 | 당시BTC가격: 83650000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:36:45 - INFO - LSTM 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-20 09:36:45 - INFO - LSTM | 이전예측가격: 83969708 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0956 | 반영가중치값: -0.0200 | 새 가중치: 0.0756 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 09:36:45 - INFO - RL 모델 예측 업데이트: 정확도 53.47%, 적중/전체: 54/101
2024-09-20 09:36:45 - INFO - RL | 이전예측가격: 84486500 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1356 | 반영가중치값: -0.0200 | 새 가중치: 0.1156 | 예측 총 횟수: 101 | 예측 성공 수: 54 | 예측 성공률: 53.47%
2024-09-20 09:36:45 - INFO - ARIMA 모델 예측 업데이트: 정확도 45.00%, 적중/전체: 9/20
2024-09-20 09:36:45 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0412 | 반영가중치값: -0.0200 | 새 가중치: 0.0212 | 예측 총 횟수: 20 | 예측 성공 수: 9 | 예측 성공률: 45.00%
2024-09-20 09:36:45 - INFO - PROPHET 모델 예측 업데이트: 정확도 62.37%, 적중/전체: 58/93
2024-09-20 09:36:45 - INFO - PROPHET | 이전예측가격: 83576371 | 당시BTC가격: 83650000 | 예측: 하락 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.3349 | 반영가중치값: 0.0200 | 새 가중치: 0.3549 | 예측 총 횟수: 93 | 예측 성공 수: 58 | 예측 성공률: 62.37%
2024-09-20 09:36:45 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-20 09:36:45 - INFO - TRANSFORMER | 이전예측가격: 83994607 | 당시BTC가격: 83650000 | 예측: 상승 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1314 | 반영가중치값: -0.0200 | 새 가중치: 0.1114 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 09:36:45 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 65.85%, 적중/전체: 27/41
2024-09-20 09:36:45 - INFO - BITCOIN_FORECAST | 이전예측가격: 83346172 | 당시BTC가격: 83650000 | 예측: 하락 | 지금 BTC가격: 83418000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1716 | 반영가중치값: 0.0200 | 새 가중치: 0.1916 | 예측 총 횟수: 41 | 예측 성공 수: 27 | 예측 성공률: 65.85%
2024-09-20 09:36:45 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:36:45 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:36:45 - INFO - 새로운 가중치: {'gpt': 0.006194519626578375, 'ml': 0.08101887208493906, 'xgboost': 0.02523843612704654, 'rl': 0.11786530383378845, 'lstm': 0.07707195201464867, 'arima': 0.021660322275462985, 'prophet': 0.361918026110799, 'transformer': 0.11365268700425772, 'bitcoin_forecast': 0.1953798809224792}
2024-09-20 09:36:45 - INFO - XGBoost 모델 성능: 정확도 60.66%, 적중/전체: 74/122
2024-09-20 09:36:45 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:36:45 - INFO - Current BTC price: 83418000.0
2024-09-20 09:36:45 - INFO - Analyzing market conditions.
2024-09-20 09:36:45 - INFO - Market analysis: {'current_price': 83402000.0, 'sma_20': 83845300.0, 'rsi_14': 31.307098656634963, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:36:45 - INFO - Starting predictions for all models
2024-09-20 09:36:45 - INFO - Attempting prediction for gpt
2024-09-20 09:36:45 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:36:45 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:36:45 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:36:45 - INFO - GPT prediction: 83418000.0
2024-09-20 09:36:45 - INFO - Attempting prediction for ml
2024-09-20 09:36:45 - INFO - ML prediction: 83351958.8
2024-09-20 09:36:45 - INFO - Attempting prediction for xgboost
2024-09-20 09:36:45 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:36:45 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:36:45 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:36:45 - INFO - XGBOOST prediction: 83402000.0
2024-09-20 09:36:45 - INFO - Attempting prediction for lstm
2024-09-20 09:36:45 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:36:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:36:45 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:36:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:36:45 - INFO - X 샘플:
[[-2.75986908e-02 -8.72730793e-03  1.91690723e-01  2.22965798e-01
  -5.34107108e-01 -5.34593842e-01  2.22965798e-01]
 [-7.77781287e-02 -8.72730793e-03  2.79527442e-01  2.57649366e-01
  -1.10610342e+00 -1.11009786e+00  2.57649366e-01]
 [ 6.56096151e-01  1.02764051e+00  8.84050746e-01  1.06528103e+00
   4.07450099e-01  4.16416159e-01  1.06528103e+00]
 [ 1.29588398e+00  1.07127705e+00  1.40073733e+00  1.09500981e+00
  -9.88282597e-01 -9.89598977e-01  1.09500981e+00]
 [ 9.06993340e-01  8.31276080e-01  6.30874320e-01  6.19349439e-01
  -1.03534048e+00 -1.03803139e+00  6.19349439e-01]
 [ 3.55019523e-01  2.18182698e-03  2.79527442e-01  2.47739775e-02
  -6.10549603e-01 -6.11943040e-01  2.47739775e-02]
 [-2.75986908e-02  5.80365977e-01 -5.11519719e-02  2.87378139e-01
   3.35248127e-01  3.41073901e-01  2.87378139e-01]
 [ 2.48388218e-01 -6.87275499e-02 -1.90657350e-01 -1.48643865e-02
   4.20940626e-01  4.23492809e-01 -1.48643865e-02]
 [-8.49286986e-01 -1.04509512e+00 -1.09485887e+00 -1.16437694e+00
   9.32516445e-01  9.32632920e-01 -1.16437694e+00]
 [-2.48011872e+00 -2.38146415e+00 -2.32973981e+00 -2.39316623e+00
   2.17822790e+00  2.17064931e+00 -2.39316623e+00]]
2024-09-20 09:36:45 - INFO - y 샘플:
[-2.39316623]
2024-09-20 09:36:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:36:45 - INFO - 모델 출력 (스케일링된 예측): [[0.06499337]]
2024-09-20 09:36:45 - INFO - 스케일러 역변환 후 예측 가격: 83898117.26518136
2024-09-20 09:36:45 - INFO - LSTMPredictor 최종 예측 가격: 83898117.26518136
2024-09-20 09:36:45 - INFO - LSTM prediction: 83898117.26518136
2024-09-20 09:36:45 - INFO - Attempting prediction for rl
2024-09-20 09:36:45 - INFO - Preparing state for RL agent.
2024-09-20 09:36:45 - INFO - Prepared state: [[ 8.34020000e+07  4.24113068e+01 -2.96473401e-03  8.38453000e+07
   3.13070987e+01]]
2024-09-20 09:36:45 - INFO - RL prediction: 84252180.0
2024-09-20 09:36:45 - INFO - Attempting prediction for arima
2024-09-20 09:36:45 - INFO - ARIMA 예측 시작
2024-09-20 09:36:45 - INFO - 입력 데이터: {'open': 83500000.0, 'high': 83515000.0, 'low': 83377000.0, 'close': 83402000.0, 'volume': 42.41130676, 'value': 3539290420.36867, 'decision': 'sell', 'sma': 83845300.0, 'ema': 83909944.03122066, 'rsi': 31.307098656634963, 'macd': -145782.26795749366, 'signal_line': -130702.91301213289, 'BB_Upper': 84203635.65271017, 'BB_Lower': 83486964.34728983}
2024-09-20 09:36:45 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:36:45 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83845300.0         0         0
2024-09-20 09:36:45 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83845300.0         0         0
2024-09-20 09:36:45 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:36:45 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:36:45 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:36:45 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:36:45 - INFO - Attempting prediction for prophet
2024-09-20 09:36:45 - INFO - PROPHET prediction: 83306445.28653826
2024-09-20 09:36:45 - INFO - Attempting prediction for transformer
2024-09-20 09:36:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:36:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:36:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:36:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:36:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:36:45 - INFO - X 샘플:
[[-2.75986908e-02 -8.72730793e-03  1.91690723e-01  2.22965798e-01
  -5.34107108e-01 -5.34593842e-01  2.22965798e-01  2.22965798e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.22965798e-01
   2.22965798e-01]
 [-7.77781287e-02 -8.72730793e-03  2.79527442e-01  2.57649366e-01
  -1.10610342e+00 -1.11009786e+00  2.57649366e-01  2.57649366e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.57649366e-01
   2.57649366e-01]
 [ 6.56096151e-01  1.02764051e+00  8.84050746e-01  1.06528103e+00
   4.07450099e-01  4.16416159e-01  1.06528103e+00  1.06528103e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.06528103e+00
   1.06528103e+00]
 [ 1.29588398e+00  1.07127705e+00  1.40073733e+00  1.09500981e+00
  -9.88282597e-01 -9.89598977e-01  1.09500981e+00  1.09500981e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.09500981e+00
   1.09500981e+00]
 [ 9.06993340e-01  8.31276080e-01  6.30874320e-01  6.19349439e-01
  -1.03534048e+00 -1.03803139e+00  6.19349439e-01  6.19349439e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  6.19349439e-01
   6.19349439e-01]
 [ 3.55019523e-01  2.18182698e-03  2.79527442e-01  2.47739775e-02
  -6.10549603e-01 -6.11943040e-01  2.47739775e-02  2.47739775e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.47739775e-02
   2.47739775e-02]
 [-2.75986908e-02  5.80365977e-01 -5.11519719e-02  2.87378139e-01
   3.35248127e-01  3.41073901e-01  2.87378139e-01  2.87378139e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  2.87378139e-01
   2.87378139e-01]
 [ 2.48388218e-01 -6.87275499e-02 -1.90657350e-01 -1.48643865e-02
   4.20940626e-01  4.23492809e-01 -1.48643865e-02 -1.48643865e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.48643865e-02
  -1.48643865e-02]
 [-8.49286986e-01 -1.04509512e+00 -1.09485887e+00 -1.16437694e+00
   9.32516445e-01  9.32632920e-01 -1.16437694e+00 -1.16437694e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.16437694e+00
  -1.16437694e+00]
 [-2.48011872e+00 -2.38146415e+00 -2.32973981e+00 -2.39316623e+00
   2.17822790e+00  2.17064931e+00 -2.39316623e+00 -2.39316623e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.39316623e+00
  -2.39316623e+00]]
2024-09-20 09:36:45 - INFO - y 샘플:
[-2.39316623]
2024-09-20 09:36:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:36:45 - INFO - 모델 출력 (스케일링된 예측): [0.2960993]
2024-09-20 09:36:45 - INFO - 스케일러 역변환 후 예측 가격: 83944760.14644183
2024-09-20 09:36:45 - INFO - TransformerPredictor 최종 예측 가격: 83944760.14644183
2024-09-20 09:36:45 - INFO - TRANSFORMER prediction: 83944760.14644183
2024-09-20 09:36:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:36:45 - INFO - BITCOIN_FORECAST prediction: 83437361.2380347
2024-09-20 09:36:45 - INFO - BitcoinForecast prediction: 83437361.2380347
2024-09-20 09:36:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:36:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:36:59 - INFO - 조정된 모델 가중치: {'gpt': 0.006194519626578375, 'ml': 0.08101887208493906, 'xgboost': 0.02523843612704654, 'rl': 0.11786530383378845, 'lstm': 0.07707195201464867, 'arima': 0.021660322275462985, 'prophet': 0.361918026110799, 'transformer': 0.11365268700425772, 'bitcoin_forecast': 0.1953798809224792}
2024-09-20 09:36:59 - INFO - 조정된 모델 가중치: {'gpt': 0.006194519626578375, 'ml': 0.08101887208493906, 'xgboost': 0.02523843612704654, 'rl': 0.11786530383378845, 'lstm': 0.07707195201464867, 'arima': 0.021660322275462985, 'prophet': 0.361918026110799, 'transformer': 0.11365268700425772, 'bitcoin_forecast': 0.1953798809224792}
2024-09-20 09:36:59 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83586485.64887741, 'current_price': 83418000.0, 'predictions': {'gpt': 83418000.0, 'ml': 83351958.8, 'xgboost': 83402000.0, 'lstm': 83898117.26518136, 'rl': 84252180.0, 'arima': 84140000.0, 'prophet': 83306445.28653826, 'transformer': 83944760.14644183, 'bitcoin_forecast': 83437361.2380347}, 'weights': {'gpt': 0.006194519626578375, 'ml': 0.08101887208493906, 'xgboost': 0.02523843612704654, 'rl': 0.11786530383378845, 'lstm': 0.07707195201464867, 'arima': 0.021660322275462985, 'prophet': 0.361918026110799, 'transformer': 0.11365268700425772, 'bitcoin_forecast': 0.1953798809224792}}
2024-09-20 09:36:59 - INFO - 모델별 가중치:
2024-09-20 09:36:59 - INFO -   - GPT: 0.0062
2024-09-20 09:36:59 - INFO -   - ML: 0.0810
2024-09-20 09:36:59 - INFO -   - XGBOOST: 0.0252
2024-09-20 09:36:59 - INFO -   - RL: 0.1179
2024-09-20 09:36:59 - INFO -   - LSTM: 0.0771
2024-09-20 09:36:59 - INFO -   - ARIMA: 0.0217
2024-09-20 09:36:59 - INFO -   - PROPHET: 0.3619
2024-09-20 09:36:59 - INFO -   - TRANSFORMER: 0.1137
2024-09-20 09:36:59 - INFO -   - BITCOIN_FORECAST: 0.1954
2024-09-20 09:36:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:36:59 - INFO - 6. 거래 실행
2024-09-20 09:36:59 - INFO - Cancelling existing orders.
2024-09-20 09:36:59 - INFO - Cancelled 0 orders.
2024-09-20 09:36:59 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83586485.64887741, 'current_price': 83418000.0, 'predictions': {'gpt': 83418000.0, 'ml': 83351958.8, 'xgboost': 83402000.0, 'lstm': 83898117.26518136, 'rl': 84252180.0, 'arima': 84140000.0, 'prophet': 83306445.28653826, 'transformer': 83944760.14644183, 'bitcoin_forecast': 83437361.2380347}, 'weights': {'gpt': 0.006194519626578375, 'ml': 0.08101887208493906, 'xgboost': 0.02523843612704654, 'rl': 0.11786530383378845, 'lstm': 0.07707195201464867, 'arima': 0.021660322275462985, 'prophet': 0.361918026110799, 'transformer': 0.11365268700425772, 'bitcoin_forecast': 0.1953798809224792}}, 현재 가격=83418000.0
2024-09-20 09:36:59 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=472527.41177859006
2024-09-20 09:36:59 - INFO - 매수 시도: 0.00011122373442890024 BTC (약 9278.06147859 KRW)
2024-09-20 09:36:59 - INFO - 주문 결과: None
2024-09-20 09:36:59 - ERROR - 주문 실패
2024-09-20 09:36:59 - WARNING - Trade execution failed: Failed to place order
2024-09-20 09:36:59 - INFO - 7. summary 리포트 보내기
2024-09-20 09:36:59 - INFO - Message sent to Discord successfully.
2024-09-20 09:36:59 - INFO - Trading cycle completed.
2024-09-20 09:36:59 - INFO - Performing periodic update.
2024-09-20 09:36:59 - INFO - 계산된 시장 변동성: 0.0283839728955806
2024-09-20 09:45:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:45:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/ebc1b9dd-9e1d-4a9e-8d29-6ca891b53141 "HTTP/1.1 200 OK"
2024-09-20 09:45:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:45:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:45:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818a-8380-cd8eec99b635 "HTTP/1.1 200 OK"
2024-09-20 09:45:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:45:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8135-8f63-d90523c7059b "HTTP/1.1 200 OK"
2024-09-20 09:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813a-916c-c72d038d45cb "HTTP/1.1 200 OK"
2024-09-20 09:46:06 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815d-bc86-f85c6ccc0ff3 "HTTP/1.1 200 OK"
2024-09-20 09:46:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8173-9133-f6fd4c7b3c85 "HTTP/1.1 200 OK"
2024-09-20 09:46:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8114-b6a0-cec98d465f03 "HTTP/1.1 200 OK"
2024-09-20 09:46:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b5-a3fe-c2dd9d6fe6c8 "HTTP/1.1 200 OK"
2024-09-20 09:46:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:46:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/faa65777-cf87-4d72-b523-9093f0c3bc56 "HTTP/1.1 200 OK"
2024-09-20 09:46:35 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:35:34.969772
2024-09-20 09:46:35 - INFO - Starting trading cycle.
2024-09-20 09:46:35 - INFO - ##################################################
2024-09-20 09:46:35 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-20 09:46:35 - INFO - ##################################################
2024-09-20 09:46:35 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:46:35 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:46:35 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:30:00
2024-09-20 09:46:35 - INFO - 새로운 데이터 범위: 2024-09-19 00:30:00 ~ 2024-09-20 09:40:00
2024-09-20 09:46:35 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:46:35 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:46:35 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:46:35 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:46:35 - INFO - Sample date values: [Timestamp('2024-09-20 09:40:00')]
2024-09-20 09:46:36 - INFO - Successfully added 1 new data points
2024-09-20 09:46:36 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:46:36 - INFO - Final date range: 2024-09-20 09:40:00 to 2024-09-20 09:40:00
2024-09-20 09:46:36 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:46:36 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:40:00
2024-09-20 09:46:36 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:46:36 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:46:36 - INFO - GPT | 이전예측가격: 83418000 | 당시BTC가격: 83418000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:46:36 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 09:46:36 - INFO - ML | 이전예측가격: 83351959 | 당시BTC가격: 83418000 | 예측: 하락 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1250 | 반영가중치값: -0.0200 | 새 가중치: 0.1050 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 09:46:36 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 09:46:36 - INFO - XGBOOST | 이전예측가격: 83402000 | 당시BTC가격: 83418000 | 예측: 하락 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0247 | 반영가중치값: -0.0200 | 새 가중치: 0.0047 | 예측 총 횟수: 123 | 예측 성공 수: 74 | 예측 성공률: 60.16%
2024-09-20 09:46:36 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 09:46:36 - INFO - LSTM | 이전예측가격: 83898117 | 당시BTC가격: 83418000 | 예측: 상승 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 09:46:36 - INFO - RL 모델 예측 업데이트: 정확도 53.92%, 적중/전체: 55/102
2024-09-20 09:46:36 - INFO - RL | 이전예측가격: 84252180 | 당시BTC가격: 83418000 | 예측: 상승 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2729 | 반영가중치값: 0.0200 | 새 가중치: 0.2929 | 예측 총 횟수: 102 | 예측 성공 수: 55 | 예측 성공률: 53.92%
2024-09-20 09:46:36 - INFO - ARIMA 모델 예측 업데이트: 정확도 47.62%, 적중/전체: 10/21
2024-09-20 09:46:36 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83418000 | 예측: 상승 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0219 | 반영가중치값: 0.0200 | 새 가중치: 0.0419 | 예측 총 횟수: 21 | 예측 성공 수: 10 | 예측 성공률: 47.62%
2024-09-20 09:46:36 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.70%, 적중/전체: 58/94
2024-09-20 09:46:36 - INFO - PROPHET | 이전예측가격: 83306445 | 당시BTC가격: 83418000 | 예측: 하락 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3307 | 반영가중치값: -0.0200 | 새 가중치: 0.3107 | 예측 총 횟수: 94 | 예측 성공 수: 58 | 예측 성공률: 61.70%
2024-09-20 09:46:36 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 09:46:36 - INFO - TRANSFORMER | 이전예측가격: 83944760 | 당시BTC가격: 83418000 | 예측: 상승 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 09:46:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 28/42
2024-09-20 09:46:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83437361 | 당시BTC가격: 83418000 | 예측: 상승 | 지금 BTC가격: 83677000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2630 | 반영가중치값: 0.0200 | 새 가중치: 0.2830 | 예측 총 횟수: 42 | 예측 성공 수: 28 | 예측 성공률: 66.67%
2024-09-20 09:46:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:46:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:46:36 - INFO - 새로운 가중치: {'gpt': 0.004641967650964154, 'ml': 0.07868351909968227, 'xgboost': 0.0035585502900153283, 'rl': 0.2194819655770558, 'lstm': 0.10865819304241836, 'arima': 0.031387724067372426, 'prophet': 0.23282677296213292, 'transformer': 0.10865819304241836, 'bitcoin_forecast': 0.2121031142679404}
2024-09-20 09:46:36 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 09:46:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:46:36 - INFO - Current BTC price: 83677000.0
2024-09-20 09:46:36 - INFO - Analyzing market conditions.
2024-09-20 09:46:36 - INFO - Market analysis: {'current_price': 83677000.0, 'sma_20': 83832850.0, 'rsi_14': 41.725254063903414, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:46:36 - INFO - Starting predictions for all models
2024-09-20 09:46:36 - INFO - Attempting prediction for gpt
2024-09-20 09:46:36 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:46:36 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:46:36 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:46:36 - INFO - GPT prediction: 83677000.0
2024-09-20 09:46:36 - INFO - Attempting prediction for ml
2024-09-20 09:46:36 - INFO - ML prediction: 83509646.0
2024-09-20 09:46:36 - INFO - Attempting prediction for xgboost
2024-09-20 09:46:36 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:46:36 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:46:36 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:46:36 - INFO - XGBOOST prediction: 83677000.0
2024-09-20 09:46:36 - INFO - Attempting prediction for lstm
2024-09-20 09:46:36 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:46:36 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:46:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:46:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:46:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:46:36 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:46:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:46:36 - INFO - X 샘플:
[[ 0.11705016  0.11801361  0.41284597  0.36760788 -1.203777   -1.20770584
   0.36760788]
 [ 0.72842822  1.07624373  0.9636211   1.14277067  0.33100017  0.34034433
   1.14277067]
 [ 1.26142448  1.11659026  1.43436907  1.17130427 -1.08430405 -1.08550696
   1.17130427]
 [ 0.93744636  0.89468434  0.73295459  0.71476667 -1.1320218  -1.13462266
   0.71476667]
 [ 0.47760645  0.12810024  0.41284597  0.14409468 -0.70127434 -0.70252303
   0.14409468]
 [ 0.15885379  0.66269178  0.11156727  0.39614148  0.25778575  0.26393914
   0.39614148]
 [ 0.38877374  0.06253712 -0.01553468  0.10604988  0.34467986  0.34752082
   0.10604988]
 [-0.52568063 -0.84021652 -0.83934363 -0.99724931  0.8634292   0.86384391
  -0.99724931]
 [-1.88429854 -2.07582906 -1.96443128 -2.1766381   2.12660852  2.11932631
  -2.1766381 ]
 [-1.65960404 -1.14281551 -1.24889437 -0.86884811  0.19787368  0.19538398
  -0.86884811]]
2024-09-20 09:46:36 - INFO - y 샘플:
[-0.86884811]
2024-09-20 09:46:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:46:36 - INFO - 모델 출력 (스케일링된 예측): [[0.02948349]]
2024-09-20 09:46:36 - INFO - 스케일러 역변환 후 예측 가격: 83865899.74135391
2024-09-20 09:46:36 - INFO - LSTMPredictor 최종 예측 가격: 83865899.74135391
2024-09-20 09:46:36 - INFO - LSTM prediction: 83865899.74135391
2024-09-20 09:46:36 - INFO - Attempting prediction for rl
2024-09-20 09:46:36 - INFO - Preparing state for RL agent.
2024-09-20 09:46:36 - INFO - Prepared state: [[8.36770000e+07 2.22517041e+01 3.29728304e-03 8.38328500e+07
  4.17252541e+01]]
2024-09-20 09:46:36 - INFO - RL prediction: 84513770.0
2024-09-20 09:46:36 - INFO - Attempting prediction for arima
2024-09-20 09:46:36 - INFO - ARIMA 예측 시작
2024-09-20 09:46:36 - INFO - 입력 데이터: {'open': 83543000.0, 'high': 83700000.0, 'low': 83529000.0, 'close': 83677000.0, 'volume': 22.25170415, 'value': 1861528892.05988, 'decision': 'sell', 'sma': 83832850.0, 'ema': 83887758.88539012, 'rsi': 41.725254063903414, 'macd': -146600.95405079424, 'signal_line': -133882.5212198652, 'BB_Upper': 84196370.16450484, 'BB_Lower': 83469329.83549516}
2024-09-20 09:46:36 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:46:36 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83832850.0         0         0
2024-09-20 09:46:36 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83832850.0         0         0
2024-09-20 09:46:36 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:46:36 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:46:36 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:46:36 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:46:36 - INFO - Attempting prediction for prophet
2024-09-20 09:46:37 - INFO - PROPHET prediction: 83626748.01437874
2024-09-20 09:46:37 - INFO - Attempting prediction for transformer
2024-09-20 09:46:37 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:46:37 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:46:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:46:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:46:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:46:37 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:46:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:46:37 - INFO - X 샘플:
[[ 0.11705016  0.11801361  0.41284597  0.36760788 -1.203777   -1.20770584
   0.36760788  0.36760788  0.          0.          0.          0.36760788
   0.36760788]
 [ 0.72842822  1.07624373  0.9636211   1.14277067  0.33100017  0.34034433
   1.14277067  1.14277067  0.          0.          0.          1.14277067
   1.14277067]
 [ 1.26142448  1.11659026  1.43436907  1.17130427 -1.08430405 -1.08550696
   1.17130427  1.17130427  0.          0.          0.          1.17130427
   1.17130427]
 [ 0.93744636  0.89468434  0.73295459  0.71476667 -1.1320218  -1.13462266
   0.71476667  0.71476667  0.          0.          0.          0.71476667
   0.71476667]
 [ 0.47760645  0.12810024  0.41284597  0.14409468 -0.70127434 -0.70252303
   0.14409468  0.14409468  0.          0.          0.          0.14409468
   0.14409468]
 [ 0.15885379  0.66269178  0.11156727  0.39614148  0.25778575  0.26393914
   0.39614148  0.39614148  0.          0.          0.          0.39614148
   0.39614148]
 [ 0.38877374  0.06253712 -0.01553468  0.10604988  0.34467986  0.34752082
   0.10604988  0.10604988  0.          0.          0.          0.10604988
   0.10604988]
 [-0.52568063 -0.84021652 -0.83934363 -0.99724931  0.8634292   0.86384391
  -0.99724931 -0.99724931  0.          0.          0.         -0.99724931
  -0.99724931]
 [-1.88429854 -2.07582906 -1.96443128 -2.1766381   2.12660852  2.11932631
  -2.1766381  -2.1766381   0.          0.          0.         -2.1766381
  -2.1766381 ]
 [-1.65960404 -1.14281551 -1.24889437 -0.86884811  0.19787368  0.19538398
  -0.86884811 -0.86884811  0.          0.          0.         -0.86884811
  -0.86884811]]
2024-09-20 09:46:37 - INFO - y 샘플:
[-0.86884811]
2024-09-20 09:46:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:46:37 - INFO - 모델 출력 (스케일링된 예측): [0.29269266]
2024-09-20 09:46:37 - INFO - 스케일러 역변환 후 예측 가격: 83921246.94763412
2024-09-20 09:46:37 - INFO - TransformerPredictor 최종 예측 가격: 83921246.94763412
2024-09-20 09:46:37 - INFO - TRANSFORMER prediction: 83921246.94763412
2024-09-20 09:46:37 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:46:37 - INFO - BITCOIN_FORECAST prediction: 83264670.30910414
2024-09-20 09:46:37 - INFO - BitcoinForecast prediction: 83264670.30910414
2024-09-20 09:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:46:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:46:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004641967650964154, 'ml': 0.07868351909968227, 'xgboost': 0.0035585502900153283, 'rl': 0.2194819655770558, 'lstm': 0.10865819304241836, 'arima': 0.031387724067372426, 'prophet': 0.23282677296213292, 'transformer': 0.10865819304241836, 'bitcoin_forecast': 0.2121031142679404}
2024-09-20 09:46:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004641967650964154, 'ml': 0.07868351909968227, 'xgboost': 0.0035585502900153283, 'rl': 0.2194819655770558, 'lstm': 0.10865819304241836, 'arima': 0.031387724067372426, 'prophet': 0.23282677296213292, 'transformer': 0.10865819304241836, 'bitcoin_forecast': 0.2121031142679404}
2024-09-20 09:46:47 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83809928.95628016, 'current_price': 83677000.0, 'predictions': {'gpt': 83677000.0, 'ml': 83509646.0, 'xgboost': 83677000.0, 'lstm': 83865899.74135391, 'rl': 84513770.0, 'arima': 84140000.0, 'prophet': 83626748.01437874, 'transformer': 83921246.94763412, 'bitcoin_forecast': 83264670.30910414}, 'weights': {'gpt': 0.004641967650964154, 'ml': 0.07868351909968227, 'xgboost': 0.0035585502900153283, 'rl': 0.2194819655770558, 'lstm': 0.10865819304241836, 'arima': 0.031387724067372426, 'prophet': 0.23282677296213292, 'transformer': 0.10865819304241836, 'bitcoin_forecast': 0.2121031142679404}}
2024-09-20 09:46:47 - INFO - 모델별 가중치:
2024-09-20 09:46:47 - INFO -   - GPT: 0.0046
2024-09-20 09:46:47 - INFO -   - ML: 0.0787
2024-09-20 09:46:47 - INFO -   - XGBOOST: 0.0036
2024-09-20 09:46:47 - INFO -   - RL: 0.2195
2024-09-20 09:46:47 - INFO -   - LSTM: 0.1087
2024-09-20 09:46:47 - INFO -   - ARIMA: 0.0314
2024-09-20 09:46:47 - INFO -   - PROPHET: 0.2328
2024-09-20 09:46:47 - INFO -   - TRANSFORMER: 0.1087
2024-09-20 09:46:47 - INFO -   - BITCOIN_FORECAST: 0.2121
2024-09-20 09:46:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:46:47 - INFO - 6. 거래 실행
2024-09-20 09:46:47 - INFO - Cancelling existing orders.
2024-09-20 09:46:47 - INFO - Cancelled 0 orders.
2024-09-20 09:46:47 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83809928.95628016, 'current_price': 83677000.0, 'predictions': {'gpt': 83677000.0, 'ml': 83509646.0, 'xgboost': 83677000.0, 'lstm': 83865899.74135391, 'rl': 84513770.0, 'arima': 84140000.0, 'prophet': 83626748.01437874, 'transformer': 83921246.94763412, 'bitcoin_forecast': 83264670.30910414}, 'weights': {'gpt': 0.004641967650964154, 'ml': 0.07868351909968227, 'xgboost': 0.0035585502900153283, 'rl': 0.2194819655770558, 'lstm': 0.10865819304241836, 'arima': 0.031387724067372426, 'prophet': 0.23282677296213292, 'transformer': 0.10865819304241836, 'bitcoin_forecast': 0.2121031142679404}}, 현재 가격=83677000.0
2024-09-20 09:46:47 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=473965.72942859004
2024-09-20 09:46:47 - INFO - 매수 시도: 0.0001108794708054782 BTC (약 9278.06147859 KRW)
2024-09-20 09:46:47 - INFO - 주문 결과: None
2024-09-20 09:46:47 - ERROR - 주문 실패
2024-09-20 09:46:47 - WARNING - Trade execution failed: Failed to place order
2024-09-20 09:46:47 - INFO - 7. summary 리포트 보내기
2024-09-20 09:46:48 - INFO - Message sent to Discord successfully.
2024-09-20 09:46:48 - INFO - Trading cycle completed.
2024-09-20 09:46:48 - INFO - Performing periodic update.
2024-09-20 09:46:48 - INFO - 계산된 시장 변동성: 0.028849781829527386
2024-09-20 09:55:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:55:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81df-8004-dd3abc831b31 "HTTP/1.1 200 OK"
2024-09-20 09:55:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:55:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:55:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8142-9c84-d8eca58ec823 "HTTP/1.1 200 OK"
2024-09-20 09:55:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:55:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81fb-aa4f-d038ced96bd7 "HTTP/1.1 200 OK"
2024-09-20 09:55:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8117-9b7c-d2cb8426a8b6 "HTTP/1.1 200 OK"
2024-09-20 09:56:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8115-aabf-dd9afbe4327c "HTTP/1.1 200 OK"
2024-09-20 09:56:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815a-b8f2-d3638bf4330e "HTTP/1.1 200 OK"
2024-09-20 09:56:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/e5dd7ad9-b77f-4721-895d-879cc6d10215 "HTTP/1.1 200 OK"
2024-09-20 09:56:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81fa-8aba-d25c7aae72ee "HTTP/1.1 200 OK"
2024-09-20 09:56:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 09:56:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810d-8b48-e58edfe967c1 "HTTP/1.1 200 OK"
2024-09-20 09:56:41 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:45:34.969853
2024-09-20 09:56:41 - INFO - Starting trading cycle.
2024-09-20 09:56:41 - INFO - ##################################################
2024-09-20 09:56:41 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-20 09:56:41 - INFO - ##################################################
2024-09-20 09:56:41 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 09:56:41 - INFO - 데이터베이스 업데이트 시작
2024-09-20 09:56:41 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:40:00
2024-09-20 09:56:42 - INFO - 새로운 데이터 범위: 2024-09-19 00:40:00 ~ 2024-09-20 09:50:00
2024-09-20 09:56:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 09:56:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 09:56:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 09:56:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 09:56:42 - INFO - Sample date values: [Timestamp('2024-09-20 09:50:00')]
2024-09-20 09:56:42 - INFO - Successfully added 1 new data points
2024-09-20 09:56:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 09:56:42 - INFO - Final date range: 2024-09-20 09:50:00 to 2024-09-20 09:50:00
2024-09-20 09:56:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 09:56:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 09:50:00
2024-09-20 09:56:42 - INFO - 데이터베이스 업데이트 완료
2024-09-20 09:56:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 09:56:42 - INFO - GPT | 이전예측가격: 83677000 | 당시BTC가격: 83677000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:56:42 - INFO - ML 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 1/3
2024-09-20 09:56:42 - INFO - ML | 이전예측가격: 83509646 | 당시BTC가격: 83677000 | 예측: 하락 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0810 | 반영가중치값: -0.0200 | 새 가중치: 0.0610 | 예측 총 횟수: 3 | 예측 성공 수: 1 | 예측 성공률: 33.33%
2024-09-20 09:56:42 - INFO - XGBOOST | 이전예측가격: 83677000 | 당시BTC가격: 83677000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 09:56:42 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-20 09:56:42 - INFO - LSTM | 이전예측가격: 83865900 | 당시BTC가격: 83677000 | 예측: 상승 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0771 | 반영가중치값: 0.0200 | 새 가중치: 0.0971 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-20 09:56:42 - INFO - RL 모델 예측 업데이트: 정확도 54.37%, 적중/전체: 56/103
2024-09-20 09:56:42 - INFO - RL | 이전예측가격: 84513770 | 당시BTC가격: 83677000 | 예측: 상승 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1179 | 반영가중치값: 0.0200 | 새 가중치: 0.1379 | 예측 총 횟수: 103 | 예측 성공 수: 56 | 예측 성공률: 54.37%
2024-09-20 09:56:42 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 11/22
2024-09-20 09:56:42 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83677000 | 예측: 상승 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0217 | 반영가중치값: 0.0200 | 새 가중치: 0.0417 | 예측 총 횟수: 22 | 예측 성공 수: 11 | 예측 성공률: 50.00%
2024-09-20 09:56:42 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.05%, 적중/전체: 58/95
2024-09-20 09:56:42 - INFO - PROPHET | 이전예측가격: 83626748 | 당시BTC가격: 83677000 | 예측: 하락 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3619 | 반영가중치값: -0.0200 | 새 가중치: 0.3419 | 예측 총 횟수: 95 | 예측 성공 수: 58 | 예측 성공률: 61.05%
2024-09-20 09:56:42 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-20 09:56:42 - INFO - TRANSFORMER | 이전예측가격: 83921247 | 당시BTC가격: 83677000 | 예측: 상승 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1137 | 반영가중치값: 0.0200 | 새 가중치: 0.1337 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-20 09:56:42 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 65.12%, 적중/전체: 28/43
2024-09-20 09:56:42 - INFO - BITCOIN_FORECAST | 이전예측가격: 83264670 | 당시BTC가격: 83677000 | 예측: 하락 | 지금 BTC가격: 83836000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1954 | 반영가중치값: -0.0200 | 새 가중치: 0.1754 | 예측 총 횟수: 43 | 예측 성공 수: 28 | 예측 성공률: 65.12%
2024-09-20 09:56:42 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 09:56:42 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 09:56:42 - INFO - 새로운 가중치: {'gpt': 0.004657021182328203, 'ml': 0.06121675142701907, 'xgboost': 0.003570090385170917, 'rl': 0.13831239003328943, 'lstm': 0.0973867486233494, 'arima': 0.041795423382399784, 'prophet': 0.34302683903605136, 'transformer': 0.1340861120229112, 'bitcoin_forecast': 0.1759486239074807}
2024-09-20 09:56:42 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 09:56:42 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 09:56:42 - INFO - Current BTC price: 83836000.0
2024-09-20 09:56:42 - INFO - Analyzing market conditions.
2024-09-20 09:56:42 - INFO - Market analysis: {'current_price': 83836000.0, 'sma_20': 83829650.0, 'rsi_14': 46.75352793137528, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 09:56:42 - INFO - Starting predictions for all models
2024-09-20 09:56:42 - INFO - Attempting prediction for gpt
2024-09-20 09:56:42 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 09:56:42 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:56:42 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 09:56:42 - INFO - GPT prediction: 83836000.0
2024-09-20 09:56:42 - INFO - Attempting prediction for ml
2024-09-20 09:56:42 - INFO - ML prediction: 83718629.60000001
2024-09-20 09:56:42 - INFO - Attempting prediction for xgboost
2024-09-20 09:56:42 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 09:56:42 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:56:42 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 09:56:42 - INFO - XGBOOST prediction: 83836000.0
2024-09-20 09:56:42 - INFO - Attempting prediction for lstm
2024-09-20 09:56:42 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:56:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:56:42 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 09:56:42 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:56:42 - INFO - X 샘플:
[[ 7.26146135e-01  1.09070368e+00  1.02544073e+00  1.19956118e+00
   1.46848032e-01  1.55798292e-01  1.19956118e+00]
 [ 1.25900157e+00  1.13108142e+00  1.50062179e+00  1.22830466e+00
  -1.36916086e+00 -1.37187150e+00  1.22830466e+00]
 [ 9.35109051e-01  9.09003853e-01  7.92602010e-01  7.68409001e-01
  -1.42027392e+00 -1.42449450e+00  7.68409001e-01]
 [ 4.75390635e-01  1.41826809e-01  4.69478889e-01  1.93539424e-01
  -9.58877017e-01 -9.61539099e-01  1.93539424e-01]
 [ 1.56722187e-01  6.76831853e-01  1.65363009e-01  4.47440154e-01
   6.84241108e-02  7.39370883e-02  4.47440154e-01]
 [ 3.86581395e-01  7.62129827e-02  3.70641228e-02  1.55214786e-01
   1.61501095e-01  1.63487246e-01  1.55214786e-01]
 [-5.27631364e-01 -8.27238931e-01 -7.94502734e-01 -9.56199729e-01
   7.17161570e-01  7.16680414e-01 -9.56199729e-01]
 [-1.88589032e+00 -2.06380719e+00 -1.93018547e+00 -2.14426352e+00
   2.07022126e+00  2.06181547e+00 -2.14426352e+00]
 [-1.66125519e+00 -1.13007198e+00 -1.20791026e+00 -8.26854075e-01
   4.24905668e-03  4.86487169e-04 -8.26854075e-01]
 [ 1.35825896e-01 -4.54249566e-03 -5.79720895e-02 -6.51518854e-02
   5.79906673e-01  5.85700100e-01 -6.51518854e-02]]
2024-09-20 09:56:42 - INFO - y 샘플:
[-0.06515189]
2024-09-20 09:56:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 09:56:42 - INFO - 모델 출력 (스케일링된 예측): [[0.09181949]]
2024-09-20 09:56:42 - INFO - 스케일러 역변환 후 예측 가격: 83868766.67527096
2024-09-20 09:56:42 - INFO - LSTMPredictor 최종 예측 가격: 83868766.67527096
2024-09-20 09:56:42 - INFO - LSTM prediction: 83868766.67527096
2024-09-20 09:56:42 - INFO - Attempting prediction for rl
2024-09-20 09:56:42 - INFO - Preparing state for RL agent.
2024-09-20 09:56:42 - INFO - Prepared state: [[8.38360000e+07 2.78689282e+01 1.90016372e-03 8.38296500e+07
  4.67535279e+01]]
2024-09-20 09:56:42 - INFO - RL prediction: 84674360.0
2024-09-20 09:56:42 - INFO - Attempting prediction for arima
2024-09-20 09:56:42 - INFO - ARIMA 예측 시작
2024-09-20 09:56:42 - INFO - 입력 데이터: {'open': 83887000.0, 'high': 83923000.0, 'low': 83771000.0, 'close': 83836000.0, 'volume': 27.86892822, 'value': 2337847273.5484, 'decision': 'sell', 'sma': 83829650.0, 'ema': 83882829.46773392, 'rsi': 46.75352793137528, 'macd': -132887.94795237482, 'signal_line': -133683.60656636712, 'BB_Upper': 84191873.83963956, 'BB_Lower': 83467426.16036044}
2024-09-20 09:56:42 - INFO - Exogenous 변수 예측 시작
2024-09-20 09:56:42 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83829650.0         0         0
2024-09-20 09:56:42 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83829650.0         0         0
2024-09-20 09:56:42 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 09:56:42 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 09:56:42 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 09:56:42 - INFO - ARIMA prediction: 84140000.0
2024-09-20 09:56:42 - INFO - Attempting prediction for prophet
2024-09-20 09:56:42 - INFO - PROPHET prediction: 83816287.80421592
2024-09-20 09:56:42 - INFO - Attempting prediction for transformer
2024-09-20 09:56:42 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 09:56:42 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 09:56:42 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 09:56:42 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 09:56:42 - INFO - X dtype: float64, y dtype: float64
2024-09-20 09:56:42 - INFO - X 샘플:
[[ 7.26146135e-01  1.09070368e+00  1.02544073e+00  1.19956118e+00
   1.46848032e-01  1.55798292e-01  1.19956118e+00  1.19956118e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.19956118e+00
   1.19956118e+00]
 [ 1.25900157e+00  1.13108142e+00  1.50062179e+00  1.22830466e+00
  -1.36916086e+00 -1.37187150e+00  1.22830466e+00  1.22830466e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.22830466e+00
   1.22830466e+00]
 [ 9.35109051e-01  9.09003853e-01  7.92602010e-01  7.68409001e-01
  -1.42027392e+00 -1.42449450e+00  7.68409001e-01  7.68409001e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  7.68409001e-01
   7.68409001e-01]
 [ 4.75390635e-01  1.41826809e-01  4.69478889e-01  1.93539424e-01
  -9.58877017e-01 -9.61539099e-01  1.93539424e-01  1.93539424e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.93539424e-01
   1.93539424e-01]
 [ 1.56722187e-01  6.76831853e-01  1.65363009e-01  4.47440154e-01
   6.84241108e-02  7.39370883e-02  4.47440154e-01  4.47440154e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  4.47440154e-01
   4.47440154e-01]
 [ 3.86581395e-01  7.62129827e-02  3.70641228e-02  1.55214786e-01
   1.61501095e-01  1.63487246e-01  1.55214786e-01  1.55214786e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.55214786e-01
   1.55214786e-01]
 [-5.27631364e-01 -8.27238931e-01 -7.94502734e-01 -9.56199729e-01
   7.17161570e-01  7.16680414e-01 -9.56199729e-01 -9.56199729e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -9.56199729e-01
  -9.56199729e-01]
 [-1.88589032e+00 -2.06380719e+00 -1.93018547e+00 -2.14426352e+00
   2.07022126e+00  2.06181547e+00 -2.14426352e+00 -2.14426352e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.14426352e+00
  -2.14426352e+00]
 [-1.66125519e+00 -1.13007198e+00 -1.20791026e+00 -8.26854075e-01
   4.24905668e-03  4.86487169e-04 -8.26854075e-01 -8.26854075e-01
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -8.26854075e-01
  -8.26854075e-01]
 [ 1.35825896e-01 -4.54249566e-03 -5.79720895e-02 -6.51518854e-02
   5.79906673e-01  5.85700100e-01 -6.51518854e-02 -6.51518854e-02
   0.00000000e+00  0.00000000e+00  0.00000000e+00 -6.51518854e-02
  -6.51518854e-02]]
2024-09-20 09:56:42 - INFO - y 샘플:
[-0.06515189]
2024-09-20 09:56:42 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 09:56:42 - INFO - 모델 출력 (스케일링된 예측): [0.29414934]
2024-09-20 09:56:42 - INFO - 스케일러 역변환 후 예측 가격: 83911001.6154779
2024-09-20 09:56:42 - INFO - TransformerPredictor 최종 예측 가격: 83911001.6154779
2024-09-20 09:56:42 - INFO - TRANSFORMER prediction: 83911001.6154779
2024-09-20 09:56:42 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 09:56:42 - INFO - BITCOIN_FORECAST prediction: 83332375.50545847
2024-09-20 09:56:42 - INFO - BitcoinForecast prediction: 83332375.50545847
2024-09-20 09:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 09:56:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 09:56:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004657021182328203, 'ml': 0.06121675142701907, 'xgboost': 0.003570090385170917, 'rl': 0.13831239003328943, 'lstm': 0.0973867486233494, 'arima': 0.041795423382399784, 'prophet': 0.34302683903605136, 'transformer': 0.1340861120229112, 'bitcoin_forecast': 0.1759486239074807}
2024-09-20 09:56:50 - INFO - 조정된 모델 가중치: {'gpt': 0.004657021182328203, 'ml': 0.06121675142701907, 'xgboost': 0.003570090385170917, 'rl': 0.13831239003328943, 'lstm': 0.0973867486233494, 'arima': 0.041795423382399784, 'prophet': 0.34302683903605136, 'transformer': 0.1340861120229112, 'bitcoin_forecast': 0.1759486239074807}
2024-09-20 09:56:50 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83875350.21540663, 'current_price': 83836000.0, 'predictions': {'gpt': 83836000.0, 'ml': 83718629.60000001, 'xgboost': 83836000.0, 'lstm': 83868766.67527096, 'rl': 84674360.0, 'arima': 84140000.0, 'prophet': 83816287.80421592, 'transformer': 83911001.6154779, 'bitcoin_forecast': 83332375.50545847}, 'weights': {'gpt': 0.004657021182328203, 'ml': 0.06121675142701907, 'xgboost': 0.003570090385170917, 'rl': 0.13831239003328943, 'lstm': 0.0973867486233494, 'arima': 0.041795423382399784, 'prophet': 0.34302683903605136, 'transformer': 0.1340861120229112, 'bitcoin_forecast': 0.1759486239074807}}
2024-09-20 09:56:50 - INFO - 모델별 가중치:
2024-09-20 09:56:50 - INFO -   - GPT: 0.0047
2024-09-20 09:56:50 - INFO -   - ML: 0.0612
2024-09-20 09:56:50 - INFO -   - XGBOOST: 0.0036
2024-09-20 09:56:50 - INFO -   - RL: 0.1383
2024-09-20 09:56:50 - INFO -   - LSTM: 0.0974
2024-09-20 09:56:50 - INFO -   - ARIMA: 0.0418
2024-09-20 09:56:50 - INFO -   - PROPHET: 0.3430
2024-09-20 09:56:50 - INFO -   - TRANSFORMER: 0.1341
2024-09-20 09:56:50 - INFO -   - BITCOIN_FORECAST: 0.1759
2024-09-20 09:56:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 09:56:50 - INFO - 6. 거래 실행
2024-09-20 09:56:50 - INFO - Cancelling existing orders.
2024-09-20 09:56:50 - INFO - Cancelled 0 orders.
2024-09-20 09:56:50 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83875350.21540663, 'current_price': 83836000.0, 'predictions': {'gpt': 83836000.0, 'ml': 83718629.60000001, 'xgboost': 83836000.0, 'lstm': 83868766.67527096, 'rl': 84674360.0, 'arima': 84140000.0, 'prophet': 83816287.80421592, 'transformer': 83911001.6154779, 'bitcoin_forecast': 83332375.50545847}, 'weights': {'gpt': 0.004657021182328203, 'ml': 0.06121675142701907, 'xgboost': 0.003570090385170917, 'rl': 0.13831239003328943, 'lstm': 0.0973867486233494, 'arima': 0.041795423382399784, 'prophet': 0.34302683903605136, 'transformer': 0.1340861120229112, 'bitcoin_forecast': 0.1759486239074807}}, 현재 가격=83836000.0
2024-09-20 09:56:50 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=474848.71207859006
2024-09-20 09:56:50 - INFO - 매수 시도: 0.00011066918124182928 BTC (약 9278.06147859 KRW)
2024-09-20 09:56:50 - INFO - 주문 결과: None
2024-09-20 09:56:50 - ERROR - 주문 실패
2024-09-20 09:56:50 - WARNING - Trade execution failed: Failed to place order
2024-09-20 09:56:50 - INFO - 7. summary 리포트 보내기
2024-09-20 09:56:50 - INFO - Message sent to Discord successfully.
2024-09-20 09:56:50 - INFO - Trading cycle completed.
2024-09-20 09:56:50 - INFO - Performing periodic update.
2024-09-20 09:56:50 - INFO - 계산된 시장 변동성: 0.028992950892280652
2024-09-20 10:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:05:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8133-b6c1-c81369f3f56b "HTTP/1.1 200 OK"
2024-09-20 10:05:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:05:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:05:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8124-a5bb-f1246d40c698 "HTTP/1.1 200 OK"
2024-09-20 10:05:52 - INFO - Updated actual price for ml prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:06:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:06:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c8-b354-c62bd46b437c "HTTP/1.1 200 OK"
2024-09-20 10:06:08 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:06:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:06:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8113-a365-c62b884e28f3 "HTTP/1.1 200 OK"
2024-09-20 10:06:28 - INFO - Updated actual price for lstm prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:06:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:06:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812e-b071-ffbfa9fab833 "HTTP/1.1 200 OK"
2024-09-20 10:06:48 - INFO - Updated actual price for rl prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:06:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8194-b52f-e331978fa851 "HTTP/1.1 200 OK"
2024-09-20 10:06:58 - INFO - Updated actual price for arima prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:07:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:07:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a4-9466-c8e400c9eef0 "HTTP/1.1 200 OK"
2024-09-20 10:07:06 - INFO - Updated actual price for prophet prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:07:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:07:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8135-9cae-d494c6b6ef98 "HTTP/1.1 200 OK"
2024-09-20 10:07:12 - INFO - Updated actual price for transformer prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:07:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:07:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8147-9825-c4f064978f17 "HTTP/1.1 200 OK"
2024-09-20 10:07:19 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 09:55:34.970075
2024-09-20 10:07:19 - INFO - Starting trading cycle.
2024-09-20 10:07:19 - INFO - ##################################################
2024-09-20 10:07:19 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-20 10:07:19 - INFO - ##################################################
2024-09-20 10:07:19 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:07:19 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:07:19 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 09:50:00
2024-09-20 10:07:19 - INFO - 새로운 데이터 범위: 2024-09-19 00:50:00 ~ 2024-09-20 10:00:00
2024-09-20 10:07:19 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:07:19 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:07:19 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:07:19 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:07:19 - INFO - Sample date values: [Timestamp('2024-09-20 10:00:00')]
2024-09-20 10:07:19 - INFO - Successfully added 1 new data points
2024-09-20 10:07:19 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:07:19 - INFO - Final date range: 2024-09-20 10:00:00 to 2024-09-20 10:00:00
2024-09-20 10:07:19 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:07:19 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:00:00
2024-09-20 10:07:19 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:07:19 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:07:19 - INFO - GPT | 이전예측가격: 83836000 | 당시BTC가격: 83836000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:07:19 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 10:07:19 - INFO - ML | 이전예측가격: 83718630 | 당시BTC가격: 83836000 | 예측: 하락 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0787 | 반영가중치값: 0.0200 | 새 가중치: 0.0987 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 10:07:19 - INFO - XGBOOST | 이전예측가격: 83836000 | 당시BTC가격: 83836000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:07:19 - INFO - LSTM 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 10:07:19 - INFO - LSTM | 이전예측가격: 83868767 | 당시BTC가격: 83836000 | 예측: 상승 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1087 | 반영가중치값: -0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 10:07:19 - INFO - RL 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 56/104
2024-09-20 10:07:19 - INFO - RL | 이전예측가격: 84674360 | 당시BTC가격: 83836000 | 예측: 상승 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2195 | 반영가중치값: -0.0200 | 새 가중치: 0.1995 | 예측 총 횟수: 104 | 예측 성공 수: 56 | 예측 성공률: 53.85%
2024-09-20 10:07:19 - INFO - ARIMA 모델 예측 업데이트: 정확도 47.83%, 적중/전체: 11/23
2024-09-20 10:07:19 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83836000 | 예측: 상승 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0314 | 반영가중치값: -0.0200 | 새 가중치: 0.0114 | 예측 총 횟수: 23 | 예측 성공 수: 11 | 예측 성공률: 47.83%
2024-09-20 10:07:19 - INFO - PROPHET 모델 예측 업데이트: 정확도 61.46%, 적중/전체: 59/96
2024-09-20 10:07:19 - INFO - PROPHET | 이전예측가격: 83816288 | 당시BTC가격: 83836000 | 예측: 하락 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2328 | 반영가중치값: 0.0200 | 새 가중치: 0.2528 | 예측 총 횟수: 96 | 예측 성공 수: 59 | 예측 성공률: 61.46%
2024-09-20 10:07:19 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 10:07:19 - INFO - TRANSFORMER | 이전예측가격: 83911002 | 당시BTC가격: 83836000 | 예측: 상승 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1087 | 반영가중치값: -0.0200 | 새 가중치: 0.0887 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 10:07:19 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 65.91%, 적중/전체: 29/44
2024-09-20 10:07:19 - INFO - BITCOIN_FORECAST | 이전예측가격: 83332376 | 당시BTC가격: 83836000 | 예측: 하락 | 지금 BTC가격: 83579000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2121 | 반영가중치값: 0.0200 | 새 가중치: 0.2321 | 예측 총 횟수: 44 | 예측 성공 수: 29 | 예측 성공률: 65.91%
2024-09-20 10:07:19 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:07:19 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:07:19 - INFO - 새로운 가중치: {'gpt': 0.004751933480799967, 'ml': 0.10069473598110316, 'xgboost': 0.0036428505189436216, 'rl': 0.20354750256203435, 'lstm': 0.0904650890281915, 'arima': 0.011619811280052055, 'prophet': 0.2579795023995881, 'transformer': 0.0904650890281915, 'bitcoin_forecast': 0.2368334857210957}
2024-09-20 10:07:19 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:07:19 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:07:19 - INFO - Current BTC price: 83579000.0
2024-09-20 10:07:19 - INFO - Analyzing market conditions.
2024-09-20 10:07:19 - INFO - Market analysis: {'current_price': 83579000.0, 'sma_20': 83813950.0, 'rsi_14': 40.648303397049, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:07:19 - INFO - Starting predictions for all models
2024-09-20 10:07:19 - INFO - Attempting prediction for gpt
2024-09-20 10:07:20 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:07:20 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:07:20 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:07:20 - INFO - GPT prediction: 83579000.0
2024-09-20 10:07:20 - INFO - Attempting prediction for ml
2024-09-20 10:07:20 - INFO - ML prediction: 83528852.6
2024-09-20 10:07:20 - INFO - Attempting prediction for xgboost
2024-09-20 10:07:20 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:07:20 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:07:20 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:07:20 - INFO - XGBOOST prediction: 83579000.0
2024-09-20 10:07:20 - INFO - Attempting prediction for lstm
2024-09-20 10:07:20 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:07:20 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:07:20 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:07:20 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:07:20 - INFO - X 샘플:
[[ 1.4126868   1.3845698   1.74513     1.50691165 -1.20624727 -1.20690908
   1.50691165]
 [ 1.0817968   1.151869    1.01839895  1.03798614 -1.25536016 -1.25745542
   1.03798614]
 [ 0.61214649  0.34799348  0.68673646  0.45182926 -0.81201874 -0.8127696
   0.45182926]
 [ 0.28659343  0.90859088  0.37458352  0.71071522  0.17508182  0.18184365
   0.71071522]
 [ 0.52141859  0.27924097  0.242894    0.41275214  0.26451649  0.26785989
   0.41275214]
 [-0.41254511 -0.66742822 -0.61064918 -0.7204845   0.79843274  0.79922243
  -0.7204845 ]
 [-1.80014831 -1.96314863 -1.7763453  -1.93187538  2.09854421  2.09127449
  -1.93187538]
 [-1.57066009 -0.98474751 -1.03498207 -0.5885992   0.11341808  0.11129162
  -0.5885992 ]
 [ 0.26524569  0.19462249  0.14534621  0.18805867  0.66654893  0.67341098
   0.18805867]
 [-0.3965343  -0.65156226 -0.79111259 -1.06729399 -0.84291611 -0.84776897
  -1.06729399]]
2024-09-20 10:07:20 - INFO - y 샘플:
[-1.06729399]
2024-09-20 10:07:20 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:07:20 - INFO - 모델 출력 (스케일링된 예측): [[0.06351127]]
2024-09-20 10:07:20 - INFO - 스케일러 역변환 후 예측 가격: 83810502.23939984
2024-09-20 10:07:20 - INFO - LSTMPredictor 최종 예측 가격: 83810502.23939984
2024-09-20 10:07:20 - INFO - LSTM prediction: 83810502.23939984
2024-09-20 10:07:20 - INFO - Attempting prediction for rl
2024-09-20 10:07:20 - INFO - Preparing state for RL agent.
2024-09-20 10:07:20 - INFO - Prepared state: [[ 8.35790000e+07  1.25398189e+01 -3.06550885e-03  8.38139500e+07
   4.06483034e+01]]
2024-09-20 10:07:20 - INFO - RL prediction: 84414790.0
2024-09-20 10:07:20 - INFO - Attempting prediction for arima
2024-09-20 10:07:20 - INFO - ARIMA 예측 시작
2024-09-20 10:07:20 - INFO - 입력 데이터: {'open': 83763000.0, 'high': 83763000.0, 'low': 83579000.0, 'close': 83579000.0, 'volume': 12.53981888, 'value': 1048857734.92273, 'decision': 'sell', 'sma': 83813950.0, 'ema': 83853893.32794973, 'rsi': 40.648303397049, 'macd': -141131.1716877669, 'signal_line': -135173.11959064708, 'BB_Upper': 84190755.7722463, 'BB_Lower': 83437144.2277537}
2024-09-20 10:07:20 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:07:20 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83813950.0         0         0
2024-09-20 10:07:20 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83813950.0         0         0
2024-09-20 10:07:20 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:07:20 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:07:20 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:07:20 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:07:20 - INFO - Attempting prediction for prophet
2024-09-20 10:07:20 - INFO - PROPHET prediction: 83517731.90447016
2024-09-20 10:07:20 - INFO - Attempting prediction for transformer
2024-09-20 10:07:20 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:07:20 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:07:20 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:07:20 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:07:20 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:07:20 - INFO - X 샘플:
[[ 1.4126868   1.3845698   1.74513     1.50691165 -1.20624727 -1.20690908
   1.50691165  1.50691165  0.          0.          0.          1.50691165
   1.50691165]
 [ 1.0817968   1.151869    1.01839895  1.03798614 -1.25536016 -1.25745542
   1.03798614  1.03798614  0.          0.          0.          1.03798614
   1.03798614]
 [ 0.61214649  0.34799348  0.68673646  0.45182926 -0.81201874 -0.8127696
   0.45182926  0.45182926  0.          0.          0.          0.45182926
   0.45182926]
 [ 0.28659343  0.90859088  0.37458352  0.71071522  0.17508182  0.18184365
   0.71071522  0.71071522  0.          0.          0.          0.71071522
   0.71071522]
 [ 0.52141859  0.27924097  0.242894    0.41275214  0.26451649  0.26785989
   0.41275214  0.41275214  0.          0.          0.          0.41275214
   0.41275214]
 [-0.41254511 -0.66742822 -0.61064918 -0.7204845   0.79843274  0.79922243
  -0.7204845  -0.7204845   0.          0.          0.         -0.7204845
  -0.7204845 ]
 [-1.80014831 -1.96314863 -1.7763453  -1.93187538  2.09854421  2.09127449
  -1.93187538 -1.93187538  0.          0.          0.         -1.93187538
  -1.93187538]
 [-1.57066009 -0.98474751 -1.03498207 -0.5885992   0.11341808  0.11129162
  -0.5885992  -0.5885992   0.          0.          0.         -0.5885992
  -0.5885992 ]
 [ 0.26524569  0.19462249  0.14534621  0.18805867  0.66654893  0.67341098
   0.18805867  0.18805867  0.          0.          0.          0.18805867
   0.18805867]
 [-0.3965343  -0.65156226 -0.79111259 -1.06729399 -0.84291611 -0.84776897
  -1.06729399 -1.06729399  0.          0.          0.         -1.06729399
  -1.06729399]]
2024-09-20 10:07:20 - INFO - y 샘플:
[-1.06729399]
2024-09-20 10:07:20 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:07:20 - INFO - 모델 출력 (스케일링된 예측): [0.29326558]
2024-09-20 10:07:20 - INFO - 스케일러 역변환 후 예측 가격: 83857538.3121836
2024-09-20 10:07:20 - INFO - TransformerPredictor 최종 예측 가격: 83857538.3121836
2024-09-20 10:07:20 - INFO - TRANSFORMER prediction: 83857538.3121836
2024-09-20 10:07:20 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:07:20 - INFO - BITCOIN_FORECAST prediction: 83118334.35040787
2024-09-20 10:07:20 - INFO - BitcoinForecast prediction: 83118334.35040787
2024-09-20 10:07:20 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:22 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:23 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:24 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:25 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:26 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:27 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:29 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:07:29 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:07:29 - INFO - 조정된 모델 가중치: {'gpt': 0.004751933480799967, 'ml': 0.10069473598110316, 'xgboost': 0.0036428505189436216, 'rl': 0.20354750256203435, 'lstm': 0.0904650890281915, 'arima': 0.011619811280052055, 'prophet': 0.2579795023995881, 'transformer': 0.0904650890281915, 'bitcoin_forecast': 0.2368334857210957}
2024-09-20 10:07:29 - INFO - 조정된 모델 가중치: {'gpt': 0.004751933480799967, 'ml': 0.10069473598110316, 'xgboost': 0.0036428505189436216, 'rl': 0.20354750256203435, 'lstm': 0.0904650890281915, 'arima': 0.011619811280052055, 'prophet': 0.2579795023995881, 'transformer': 0.0904650890281915, 'bitcoin_forecast': 0.2368334857210957}
2024-09-20 10:07:29 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83671826.00165564, 'current_price': 83579000.0, 'predictions': {'gpt': 83579000.0, 'ml': 83528852.6, 'xgboost': 83579000.0, 'lstm': 83810502.23939984, 'rl': 84414790.0, 'arima': 84140000.0, 'prophet': 83517731.90447016, 'transformer': 83857538.3121836, 'bitcoin_forecast': 83118334.35040787}, 'weights': {'gpt': 0.004751933480799967, 'ml': 0.10069473598110316, 'xgboost': 0.0036428505189436216, 'rl': 0.20354750256203435, 'lstm': 0.0904650890281915, 'arima': 0.011619811280052055, 'prophet': 0.2579795023995881, 'transformer': 0.0904650890281915, 'bitcoin_forecast': 0.2368334857210957}}
2024-09-20 10:07:29 - INFO - 모델별 가중치:
2024-09-20 10:07:29 - INFO -   - GPT: 0.0048
2024-09-20 10:07:29 - INFO -   - ML: 0.1007
2024-09-20 10:07:29 - INFO -   - XGBOOST: 0.0036
2024-09-20 10:07:29 - INFO -   - RL: 0.2035
2024-09-20 10:07:29 - INFO -   - LSTM: 0.0905
2024-09-20 10:07:29 - INFO -   - ARIMA: 0.0116
2024-09-20 10:07:29 - INFO -   - PROPHET: 0.2580
2024-09-20 10:07:29 - INFO -   - TRANSFORMER: 0.0905
2024-09-20 10:07:29 - INFO -   - BITCOIN_FORECAST: 0.2368
2024-09-20 10:07:29 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:07:29 - INFO - 6. 거래 실행
2024-09-20 10:07:29 - INFO - Cancelling existing orders.
2024-09-20 10:07:29 - INFO - Cancelled 0 orders.
2024-09-20 10:07:29 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83671826.00165564, 'current_price': 83579000.0, 'predictions': {'gpt': 83579000.0, 'ml': 83528852.6, 'xgboost': 83579000.0, 'lstm': 83810502.23939984, 'rl': 84414790.0, 'arima': 84140000.0, 'prophet': 83517731.90447016, 'transformer': 83857538.3121836, 'bitcoin_forecast': 83118334.35040787}, 'weights': {'gpt': 0.004751933480799967, 'ml': 0.10069473598110316, 'xgboost': 0.0036428505189436216, 'rl': 0.20354750256203435, 'lstm': 0.0904650890281915, 'arima': 0.011619811280052055, 'prophet': 0.2579795023995881, 'transformer': 0.0904650890281915, 'bitcoin_forecast': 0.2368334857210957}}, 현재 가격=83579000.0
2024-09-20 10:07:29 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=473421.50112859
2024-09-20 10:07:29 - INFO - 매수 시도: 0.00011100948179076083 BTC (약 9278.06147859 KRW)
2024-09-20 10:07:29 - INFO - 주문 결과: None
2024-09-20 10:07:29 - ERROR - 주문 실패
2024-09-20 10:07:29 - WARNING - Trade execution failed: Failed to place order
2024-09-20 10:07:29 - INFO - 7. summary 리포트 보내기
2024-09-20 10:07:30 - INFO - Message sent to Discord successfully.
2024-09-20 10:07:30 - INFO - Trading cycle completed.
2024-09-20 10:07:30 - INFO - Performing periodic update.
2024-09-20 10:07:30 - INFO - 계산된 시장 변동성: 0.029372460414847177
2024-09-20 10:15:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:15:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8169-a5be-fedbc2a12c43 "HTTP/1.1 200 OK"
2024-09-20 10:15:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:15:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:15:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8157-9674-f94b81e76dee "HTTP/1.1 200 OK"
2024-09-20 10:15:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8186-b2ab-dc8624c9a1a8 "HTTP/1.1 200 OK"
2024-09-20 10:15:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d6-a707-db446ce38461 "HTTP/1.1 200 OK"
2024-09-20 10:16:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c9-ba82-e9f6a9be50d4 "HTTP/1.1 200 OK"
2024-09-20 10:16:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8111-b9b5-cf137c4c1997 "HTTP/1.1 200 OK"
2024-09-20 10:16:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b9-bfac-c251dde0f964 "HTTP/1.1 200 OK"
2024-09-20 10:16:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d7-8084-ce66c97d998d "HTTP/1.1 200 OK"
2024-09-20 10:16:31 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:16:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810e-a2b6-d31cac572012 "HTTP/1.1 200 OK"
2024-09-20 10:16:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:05:34.970269
2024-09-20 10:16:38 - INFO - Starting trading cycle.
2024-09-20 10:16:38 - INFO - ##################################################
2024-09-20 10:16:38 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-20 10:16:38 - INFO - ##################################################
2024-09-20 10:16:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:16:38 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:16:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:00:00
2024-09-20 10:16:38 - INFO - 새로운 데이터 범위: 2024-09-19 01:00:00 ~ 2024-09-20 10:10:00
2024-09-20 10:16:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:16:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:16:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:16:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:16:38 - INFO - Sample date values: [Timestamp('2024-09-20 10:10:00')]
2024-09-20 10:16:39 - INFO - Successfully added 1 new data points
2024-09-20 10:16:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:16:39 - INFO - Final date range: 2024-09-20 10:10:00 to 2024-09-20 10:10:00
2024-09-20 10:16:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:16:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:10:00
2024-09-20 10:16:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:16:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:16:39 - INFO - GPT | 이전예측가격: 83579000 | 당시BTC가격: 83579000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:16:39 - INFO - ML 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 10:16:39 - INFO - ML | 이전예측가격: 83528853 | 당시BTC가격: 83579000 | 예측: 하락 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0612 | 반영가중치값: -0.0200 | 새 가중치: 0.0412 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 10:16:39 - INFO - XGBOOST | 이전예측가격: 83579000 | 당시BTC가격: 83579000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:16:39 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 10:16:39 - INFO - LSTM | 이전예측가격: 83810502 | 당시BTC가격: 83579000 | 예측: 상승 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0974 | 반영가중치값: 0.0200 | 새 가중치: 0.1174 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 10:16:39 - INFO - RL 모델 예측 업데이트: 정확도 54.29%, 적중/전체: 57/105
2024-09-20 10:16:39 - INFO - RL | 이전예측가격: 84414790 | 당시BTC가격: 83579000 | 예측: 상승 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1383 | 반영가중치값: 0.0200 | 새 가중치: 0.1583 | 예측 총 횟수: 105 | 예측 성공 수: 57 | 예측 성공률: 54.29%
2024-09-20 10:16:39 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 12/24
2024-09-20 10:16:39 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83579000 | 예측: 상승 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0418 | 반영가중치값: 0.0200 | 새 가중치: 0.0618 | 예측 총 횟수: 24 | 예측 성공 수: 12 | 예측 성공률: 50.00%
2024-09-20 10:16:39 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.82%, 적중/전체: 59/97
2024-09-20 10:16:39 - INFO - PROPHET | 이전예측가격: 83517732 | 당시BTC가격: 83579000 | 예측: 하락 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3430 | 반영가중치값: -0.0200 | 새 가중치: 0.3230 | 예측 총 횟수: 97 | 예측 성공 수: 59 | 예측 성공률: 60.82%
2024-09-20 10:16:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 10:16:39 - INFO - TRANSFORMER | 이전예측가격: 83857538 | 당시BTC가격: 83579000 | 예측: 상승 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1341 | 반영가중치값: 0.0200 | 새 가중치: 0.1541 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 10:16:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 64.44%, 적중/전체: 29/45
2024-09-20 10:16:39 - INFO - BITCOIN_FORECAST | 이전예측가격: 83118334 | 당시BTC가격: 83579000 | 예측: 하락 | 지금 BTC가격: 83636000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1759 | 반영가중치값: -0.0200 | 새 가중치: 0.1559 | 예측 총 횟수: 45 | 예측 성공 수: 29 | 예측 성공률: 64.44%
2024-09-20 10:16:39 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:16:39 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:16:39 - INFO - 새로운 가중치: {'gpt': 0.004657992611617059, 'ml': 0.04040193836837789, 'xgboost': 0.0035708350866073585, 'rl': 0.1551827158528236, 'lstm': 0.11506613255395598, 'arima': 0.06057379100738362, 'prophet': 0.31664092851119574, 'transformer': 0.15103998704011568, 'bitcoin_forecast': 0.15286567896792297}
2024-09-20 10:16:39 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:16:39 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:16:39 - INFO - Current BTC price: 83636000.0
2024-09-20 10:16:39 - INFO - Analyzing market conditions.
2024-09-20 10:16:39 - INFO - Market analysis: {'current_price': 83636000.0, 'sma_20': 83800200.0, 'rsi_14': 42.44348407796548, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:16:39 - INFO - Starting predictions for all models
2024-09-20 10:16:39 - INFO - Attempting prediction for gpt
2024-09-20 10:16:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:16:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:16:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:16:39 - INFO - GPT prediction: 83636000.0
2024-09-20 10:16:39 - INFO - Attempting prediction for ml
2024-09-20 10:16:39 - INFO - ML prediction: 83401819.2
2024-09-20 10:16:39 - INFO - Attempting prediction for xgboost
2024-09-20 10:16:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:16:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:16:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:16:39 - INFO - XGBOOST prediction: 83636000.0
2024-09-20 10:16:39 - INFO - Attempting prediction for lstm
2024-09-20 10:16:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:16:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:16:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:16:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:16:39 - INFO - X 샘플:
[[ 1.42052405  1.50895707  1.49940002  1.43298777 -1.46182584 -1.46350046
   1.43298777]
 [ 0.93240957  0.62815263  1.12564928  0.77033447 -0.98165896 -0.98192609
   0.77033447]
 [ 0.5940575   1.24239783  0.77388388  1.06300634  0.08743356  0.09519452
   1.06300634]
 [ 0.83811473  0.55282068  0.62548285  0.72615758  0.18429699  0.18834617
   0.72615758]
 [-0.13256745 -0.48444244 -0.33637566 -0.55497214  0.76256215  0.76378747
  -0.55497214]
 [-1.57472384 -1.90416011 -1.64999958 -1.92445564  2.17066535  2.1630207
  -1.92445564]
 [-1.33621336 -0.8321284  -0.81455675 -0.40587515  0.02064782  0.01878991
  -0.40587515]
 [ 0.57187048  0.46010442  0.51555616  0.47214048  0.61972362  0.62753944
   0.47214048]
 [-0.11592719 -0.46705814 -0.53974004 -0.94704201 -1.01512278 -1.0198288
  -0.94704201]
 [-1.19754448 -0.70464355 -1.19930016 -0.63228169 -0.38672191 -0.39142285
  -0.63228169]]
2024-09-20 10:16:39 - INFO - y 샘플:
[-0.63228169]
2024-09-20 10:16:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:16:39 - INFO - 모델 출력 (스케일링된 예측): [[0.04374949]]
2024-09-20 10:16:39 - INFO - 스케일러 역변환 후 예측 가격: 83758422.60174571
2024-09-20 10:16:39 - INFO - LSTMPredictor 최종 예측 가격: 83758422.60174571
2024-09-20 10:16:39 - INFO - LSTM prediction: 83758422.60174571
2024-09-20 10:16:39 - INFO - Attempting prediction for rl
2024-09-20 10:16:39 - INFO - Preparing state for RL agent.
2024-09-20 10:16:39 - INFO - Prepared state: [[8.36360000e+07 1.84320089e+01 6.81989495e-04 8.38002000e+07
  4.24434841e+01]]
2024-09-20 10:16:39 - INFO - RL prediction: 84472360.0
2024-09-20 10:16:39 - INFO - Attempting prediction for arima
2024-09-20 10:16:39 - INFO - ARIMA 예측 시작
2024-09-20 10:16:39 - INFO - 입력 데이터: {'open': 83568000.0, 'high': 83722000.0, 'low': 83459000.0, 'close': 83636000.0, 'volume': 18.4320089, 'value': 1540556361.45133, 'decision': 'sell', 'sma': 83800200.0, 'ema': 83833141.5824307, 'rsi': 42.44348407796548, 'macd': -141434.1968743205, 'signal_line': -136425.33504738178, 'BB_Upper': 84181875.04503389, 'BB_Lower': 83418524.95496611}
2024-09-20 10:16:39 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:16:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83800200.0         0         0
2024-09-20 10:16:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83800200.0         0         0
2024-09-20 10:16:39 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:16:39 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:16:39 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:16:39 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:16:39 - INFO - Attempting prediction for prophet
2024-09-20 10:16:39 - INFO - PROPHET prediction: 83587920.89389232
2024-09-20 10:16:39 - INFO - Attempting prediction for transformer
2024-09-20 10:16:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:16:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:16:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:16:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:16:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:16:39 - INFO - X 샘플:
[[ 1.42052405  1.50895707  1.49940002  1.43298777 -1.46182584 -1.46350046
   1.43298777  1.43298777  0.          0.          0.          1.43298777
   1.43298777]
 [ 0.93240957  0.62815263  1.12564928  0.77033447 -0.98165896 -0.98192609
   0.77033447  0.77033447  0.          0.          0.          0.77033447
   0.77033447]
 [ 0.5940575   1.24239783  0.77388388  1.06300634  0.08743356  0.09519452
   1.06300634  1.06300634  0.          0.          0.          1.06300634
   1.06300634]
 [ 0.83811473  0.55282068  0.62548285  0.72615758  0.18429699  0.18834617
   0.72615758  0.72615758  0.          0.          0.          0.72615758
   0.72615758]
 [-0.13256745 -0.48444244 -0.33637566 -0.55497214  0.76256215  0.76378747
  -0.55497214 -0.55497214  0.          0.          0.         -0.55497214
  -0.55497214]
 [-1.57472384 -1.90416011 -1.64999958 -1.92445564  2.17066535  2.1630207
  -1.92445564 -1.92445564  0.          0.          0.         -1.92445564
  -1.92445564]
 [-1.33621336 -0.8321284  -0.81455675 -0.40587515  0.02064782  0.01878991
  -0.40587515 -0.40587515  0.          0.          0.         -0.40587515
  -0.40587515]
 [ 0.57187048  0.46010442  0.51555616  0.47214048  0.61972362  0.62753944
   0.47214048  0.47214048  0.          0.          0.          0.47214048
   0.47214048]
 [-0.11592719 -0.46705814 -0.53974004 -0.94704201 -1.01512278 -1.0198288
  -0.94704201 -0.94704201  0.          0.          0.         -0.94704201
  -0.94704201]
 [-1.19754448 -0.70464355 -1.19930016 -0.63228169 -0.38672191 -0.39142285
  -0.63228169 -0.63228169  0.          0.          0.         -0.63228169
  -0.63228169]]
2024-09-20 10:16:39 - INFO - y 샘플:
[-0.63228169]
2024-09-20 10:16:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:16:39 - INFO - 모델 출력 (스케일링된 예측): [0.29733157]
2024-09-20 10:16:39 - INFO - 스케일러 역변환 후 예측 가격: 83804343.825114
2024-09-20 10:16:39 - INFO - TransformerPredictor 최종 예측 가격: 83804343.825114
2024-09-20 10:16:39 - INFO - TRANSFORMER prediction: 83804343.825114
2024-09-20 10:16:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:16:39 - INFO - BITCOIN_FORECAST prediction: 83171125.46820152
2024-09-20 10:16:39 - INFO - BitcoinForecast prediction: 83171125.46820152
2024-09-20 10:16:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:16:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:16:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004657992611617059, 'ml': 0.04040193836837789, 'xgboost': 0.0035708350866073585, 'rl': 0.1551827158528236, 'lstm': 0.11506613255395598, 'arima': 0.06057379100738362, 'prophet': 0.31664092851119574, 'transformer': 0.15103998704011568, 'bitcoin_forecast': 0.15286567896792297}
2024-09-20 10:16:47 - INFO - 조정된 모델 가중치: {'gpt': 0.004657992611617059, 'ml': 0.04040193836837789, 'xgboost': 0.0035708350866073585, 'rl': 0.1551827158528236, 'lstm': 0.11506613255395598, 'arima': 0.06057379100738362, 'prophet': 0.31664092851119574, 'transformer': 0.15103998704011568, 'bitcoin_forecast': 0.15286567896792297}
2024-09-20 10:16:47 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83740082.6193951, 'current_price': 83636000.0, 'predictions': {'gpt': 83636000.0, 'ml': 83401819.2, 'xgboost': 83636000.0, 'lstm': 83758422.60174571, 'rl': 84472360.0, 'arima': 84140000.0, 'prophet': 83587920.89389232, 'transformer': 83804343.825114, 'bitcoin_forecast': 83171125.46820152}, 'weights': {'gpt': 0.004657992611617059, 'ml': 0.04040193836837789, 'xgboost': 0.0035708350866073585, 'rl': 0.1551827158528236, 'lstm': 0.11506613255395598, 'arima': 0.06057379100738362, 'prophet': 0.31664092851119574, 'transformer': 0.15103998704011568, 'bitcoin_forecast': 0.15286567896792297}}
2024-09-20 10:16:47 - INFO - 모델별 가중치:
2024-09-20 10:16:47 - INFO -   - GPT: 0.0047
2024-09-20 10:16:47 - INFO -   - ML: 0.0404
2024-09-20 10:16:47 - INFO -   - XGBOOST: 0.0036
2024-09-20 10:16:47 - INFO -   - RL: 0.1552
2024-09-20 10:16:47 - INFO -   - LSTM: 0.1151
2024-09-20 10:16:47 - INFO -   - ARIMA: 0.0606
2024-09-20 10:16:47 - INFO -   - PROPHET: 0.3166
2024-09-20 10:16:47 - INFO -   - TRANSFORMER: 0.1510
2024-09-20 10:16:47 - INFO -   - BITCOIN_FORECAST: 0.1529
2024-09-20 10:16:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:16:47 - INFO - 6. 거래 실행
2024-09-20 10:16:47 - INFO - Cancelling existing orders.
2024-09-20 10:16:47 - INFO - Cancelled 0 orders.
2024-09-20 10:16:47 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83740082.6193951, 'current_price': 83636000.0, 'predictions': {'gpt': 83636000.0, 'ml': 83401819.2, 'xgboost': 83636000.0, 'lstm': 83758422.60174571, 'rl': 84472360.0, 'arima': 84140000.0, 'prophet': 83587920.89389232, 'transformer': 83804343.825114, 'bitcoin_forecast': 83171125.46820152}, 'weights': {'gpt': 0.004657992611617059, 'ml': 0.04040193836837789, 'xgboost': 0.0035708350866073585, 'rl': 0.1551827158528236, 'lstm': 0.11506613255395598, 'arima': 0.06057379100738362, 'prophet': 0.31664092851119574, 'transformer': 0.15103998704011568, 'bitcoin_forecast': 0.15286567896792297}}, 현재 가격=83636000.0
2024-09-20 10:16:47 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=473738.04207859
2024-09-20 10:16:47 - INFO - 매수 시도: 0.00011093382608673298 BTC (약 9278.06147859 KRW)
2024-09-20 10:16:47 - INFO - 주문 결과: None
2024-09-20 10:16:47 - ERROR - 주문 실패
2024-09-20 10:16:47 - WARNING - Trade execution failed: Failed to place order
2024-09-20 10:16:47 - INFO - 7. summary 리포트 보내기
2024-09-20 10:16:47 - INFO - Message sent to Discord successfully.
2024-09-20 10:16:47 - INFO - Trading cycle completed.
2024-09-20 10:16:47 - INFO - Performing periodic update.
2024-09-20 10:16:47 - INFO - 계산된 시장 변동성: 0.029334430158849296
2024-09-20 10:25:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:25:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d7-a1b1-e30cf6fca630 "HTTP/1.1 200 OK"
2024-09-20 10:25:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:25:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:25:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8168-9a65-f6ac399c4ec2 "HTTP/1.1 200 OK"
2024-09-20 10:25:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:25:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8121-9feb-fc9d210d388f "HTTP/1.1 200 OK"
2024-09-20 10:25:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e0-915a-ca99766b6832 "HTTP/1.1 200 OK"
2024-09-20 10:26:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8101-aaa5-ee733c9687c6 "HTTP/1.1 200 OK"
2024-09-20 10:26:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c0-990b-eb2009acb79a "HTTP/1.1 200 OK"
2024-09-20 10:26:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/7ca0d5a8-4dd5-497e-a215-bd87bc75e17e "HTTP/1.1 200 OK"
2024-09-20 10:26:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e3-bc82-cc9994af0e08 "HTTP/1.1 200 OK"
2024-09-20 10:26:33 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:26:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8105-955a-ed03c104c201 "HTTP/1.1 200 OK"
2024-09-20 10:26:43 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:15:34.970438
2024-09-20 10:26:43 - INFO - Starting trading cycle.
2024-09-20 10:26:43 - INFO - ##################################################
2024-09-20 10:26:43 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-20 10:26:43 - INFO - ##################################################
2024-09-20 10:26:43 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:26:43 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:26:43 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:10:00
2024-09-20 10:26:43 - INFO - 새로운 데이터 범위: 2024-09-19 01:10:00 ~ 2024-09-20 10:20:00
2024-09-20 10:26:43 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:26:43 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:26:43 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:26:43 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:26:43 - INFO - Sample date values: [Timestamp('2024-09-20 10:20:00')]
2024-09-20 10:26:44 - INFO - Successfully added 1 new data points
2024-09-20 10:26:44 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:26:44 - INFO - Final date range: 2024-09-20 10:20:00 to 2024-09-20 10:20:00
2024-09-20 10:26:44 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:26:44 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:20:00
2024-09-20 10:26:44 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:26:44 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:26:44 - INFO - GPT | 이전예측가격: 83636000 | 당시BTC가격: 83636000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:26:44 - INFO - ML 모델 예측 업데이트: 정확도 33.33%, 적중/전체: 2/6
2024-09-20 10:26:44 - INFO - ML | 이전예측가격: 83401819 | 당시BTC가격: 83636000 | 예측: 하락 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1007 | 반영가중치값: -0.0200 | 새 가중치: 0.0807 | 예측 총 횟수: 6 | 예측 성공 수: 2 | 예측 성공률: 33.33%
2024-09-20 10:26:44 - INFO - XGBOOST | 이전예측가격: 83636000 | 당시BTC가격: 83636000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:26:44 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 10:26:44 - INFO - LSTM | 이전예측가격: 83758423 | 당시BTC가격: 83636000 | 예측: 상승 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0905 | 반영가중치값: 0.0200 | 새 가중치: 0.1105 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 10:26:44 - INFO - RL 모델 예측 업데이트: 정확도 54.72%, 적중/전체: 58/106
2024-09-20 10:26:44 - INFO - RL | 이전예측가격: 84472360 | 당시BTC가격: 83636000 | 예측: 상승 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2035 | 반영가중치값: 0.0200 | 새 가중치: 0.2235 | 예측 총 횟수: 106 | 예측 성공 수: 58 | 예측 성공률: 54.72%
2024-09-20 10:26:44 - INFO - ARIMA 모델 예측 업데이트: 정확도 52.00%, 적중/전체: 13/25
2024-09-20 10:26:44 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83636000 | 예측: 상승 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0116 | 반영가중치값: 0.0200 | 새 가중치: 0.0316 | 예측 총 횟수: 25 | 예측 성공 수: 13 | 예측 성공률: 52.00%
2024-09-20 10:26:44 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.20%, 적중/전체: 59/98
2024-09-20 10:26:44 - INFO - PROPHET | 이전예측가격: 83587921 | 당시BTC가격: 83636000 | 예측: 하락 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2580 | 반영가중치값: -0.0200 | 새 가중치: 0.2380 | 예측 총 횟수: 98 | 예측 성공 수: 59 | 예측 성공률: 60.20%
2024-09-20 10:26:44 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 10:26:44 - INFO - TRANSFORMER | 이전예측가격: 83804344 | 당시BTC가격: 83636000 | 예측: 상승 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0905 | 반영가중치값: 0.0200 | 새 가중치: 0.1105 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 10:26:44 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 63.04%, 적중/전체: 29/46
2024-09-20 10:26:44 - INFO - BITCOIN_FORECAST | 이전예측가격: 83171125 | 당시BTC가격: 83636000 | 예측: 하락 | 지금 BTC가격: 83689000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2368 | 반영가중치값: -0.0200 | 새 가중치: 0.2168 | 예측 총 횟수: 46 | 예측 성공 수: 29 | 예측 성공률: 63.04%
2024-09-20 10:26:44 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:26:44 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:26:44 - INFO - 새로운 가중치: {'gpt': 0.004567402549854689, 'ml': 0.07912536013061452, 'xgboost': 0.003501388396152712, 'rl': 0.21919988251355857, 'lstm': 0.10831673026680318, 'arima': 0.03100485954104962, 'prophet': 0.23335120441414486, 'transformer': 0.10831673026680318, 'bitcoin_forecast': 0.21261644192101872}
2024-09-20 10:26:44 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:26:44 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:26:44 - INFO - Current BTC price: 83698000.0
2024-09-20 10:26:44 - INFO - Analyzing market conditions.
2024-09-20 10:26:44 - INFO - Market analysis: {'current_price': 83698000.0, 'sma_20': 83798700.0, 'rsi_14': 44.41295745065573, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:26:44 - INFO - Starting predictions for all models
2024-09-20 10:26:44 - INFO - Attempting prediction for gpt
2024-09-20 10:26:44 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:26:44 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:26:44 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:26:44 - INFO - GPT prediction: 83698000.0
2024-09-20 10:26:44 - INFO - Attempting prediction for ml
2024-09-20 10:26:44 - INFO - ML prediction: 83564083.2
2024-09-20 10:26:44 - INFO - Attempting prediction for xgboost
2024-09-20 10:26:44 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:26:44 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:26:44 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:26:44 - INFO - XGBOOST prediction: 83698000.0
2024-09-20 10:26:44 - INFO - Attempting prediction for lstm
2024-09-20 10:26:44 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:26:44 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:26:44 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:26:44 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:26:44 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:26:44 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:26:44 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:26:44 - INFO - X 샘플:
[[ 1.2486624   0.96118244  1.4899617   1.07187317 -1.00435161 -1.00382986
   1.07187317]
 [ 0.86474906  1.66335568  1.08383926  1.40467503  0.07917102  0.08733327
   1.40467503]
 [ 1.14167016  0.87506685  0.91250635  1.02163892  0.17734187  0.18169935
   1.02163892]
 [ 0.04027943 -0.31067854 -0.19798469 -0.43515413  0.76341219  0.76464273
  -0.43515413]
 [-1.59607251 -1.93362614 -1.71459817 -1.99241567  2.19052129  2.18211788
  -1.99241567]
 [-1.32544507 -0.7081351  -0.75005738 -0.26561356  0.01148384  0.00993256
  -0.26561356]
 [ 0.83957442  0.76907843  0.78559309  0.73279202  0.61864569  0.62661841
   0.73279202]
 [ 0.05916042 -0.29080571 -0.43277422 -0.88098304 -1.03826711 -1.04222672
  -0.88098304]
 [-1.16810354 -0.56240103 -1.1942538  -0.52306406 -0.40138437 -0.40562818
  -0.52306406]
 [-0.10447478 -0.46303689  0.01776786 -0.13374867 -1.3965728  -1.40065945
  -0.13374867]]
2024-09-20 10:26:44 - INFO - y 샘플:
[-0.13374867]
2024-09-20 10:26:44 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:26:44 - INFO - 모델 출력 (스케일링된 예측): [[0.03768791]]
2024-09-20 10:26:44 - INFO - 스케일러 역변환 후 예측 가격: 83725301.94650647
2024-09-20 10:26:44 - INFO - LSTMPredictor 최종 예측 가격: 83725301.94650647
2024-09-20 10:26:44 - INFO - LSTM prediction: 83725301.94650647
2024-09-20 10:26:44 - INFO - Attempting prediction for rl
2024-09-20 10:26:44 - INFO - Preparing state for RL agent.
2024-09-20 10:26:44 - INFO - Prepared state: [[8.36980000e+07 9.22491466e+00 7.41307571e-04 8.37987000e+07
  4.44129575e+01]]
2024-09-20 10:26:44 - INFO - RL prediction: 84534980.0
2024-09-20 10:26:44 - INFO - Attempting prediction for arima
2024-09-20 10:26:44 - INFO - ARIMA 예측 시작
2024-09-20 10:26:44 - INFO - 입력 데이터: {'open': 83737000.0, 'high': 83737000.0, 'low': 83650000.0, 'close': 83698000.0, 'volume': 9.22491466, 'value': 772009972.45657, 'decision': 'sell', 'sma': 83798700.0, 'ema': 83820270.95553254, 'rsi': 44.41295745065573, 'macd': -135113.95510452986, 'signal_line': -136163.0590588114, 'BB_Upper': 84181731.64360562, 'BB_Lower': 83415668.35639438}
2024-09-20 10:26:44 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:26:44 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83798700.0         0         0
2024-09-20 10:26:44 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83798700.0         0         0
2024-09-20 10:26:44 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:26:44 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:26:44 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:26:44 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:26:44 - INFO - Attempting prediction for prophet
2024-09-20 10:26:45 - INFO - PROPHET prediction: 83655479.54048462
2024-09-20 10:26:45 - INFO - Attempting prediction for transformer
2024-09-20 10:26:45 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:26:45 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:26:45 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:26:45 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:26:45 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:26:45 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:26:45 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:26:45 - INFO - X 샘플:
[[ 1.2486624   0.96118244  1.4899617   1.07187317 -1.00435161 -1.00382986
   1.07187317  1.07187317  0.          0.          0.          1.07187317
   1.07187317]
 [ 0.86474906  1.66335568  1.08383926  1.40467503  0.07917102  0.08733327
   1.40467503  1.40467503  0.          0.          0.          1.40467503
   1.40467503]
 [ 1.14167016  0.87506685  0.91250635  1.02163892  0.17734187  0.18169935
   1.02163892  1.02163892  0.          0.          0.          1.02163892
   1.02163892]
 [ 0.04027943 -0.31067854 -0.19798469 -0.43515413  0.76341219  0.76464273
  -0.43515413 -0.43515413  0.          0.          0.         -0.43515413
  -0.43515413]
 [-1.59607251 -1.93362614 -1.71459817 -1.99241567  2.19052129  2.18211788
  -1.99241567 -1.99241567  0.          0.          0.         -1.99241567
  -1.99241567]
 [-1.32544507 -0.7081351  -0.75005738 -0.26561356  0.01148384  0.00993256
  -0.26561356 -0.26561356  0.          0.          0.         -0.26561356
  -0.26561356]
 [ 0.83957442  0.76907843  0.78559309  0.73279202  0.61864569  0.62661841
   0.73279202  0.73279202  0.          0.          0.          0.73279202
   0.73279202]
 [ 0.05916042 -0.29080571 -0.43277422 -0.88098304 -1.03826711 -1.04222672
  -0.88098304 -0.88098304  0.          0.          0.         -0.88098304
  -0.88098304]
 [-1.16810354 -0.56240103 -1.1942538  -0.52306406 -0.40138437 -0.40562818
  -0.52306406 -0.52306406  0.          0.          0.         -0.52306406
  -0.52306406]
 [-0.10447478 -0.46303689  0.01776786 -0.13374867 -1.3965728  -1.40065945
  -0.13374867 -0.13374867  0.          0.          0.         -0.13374867
  -0.13374867]]
2024-09-20 10:26:45 - INFO - y 샘플:
[-0.13374867]
2024-09-20 10:26:45 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:26:45 - INFO - 모델 출력 (스케일링된 예측): [0.30121732]
2024-09-20 10:26:45 - INFO - 스케일러 역변환 후 예측 가격: 83767270.03761752
2024-09-20 10:26:45 - INFO - TransformerPredictor 최종 예측 가격: 83767270.03761752
2024-09-20 10:26:45 - INFO - TRANSFORMER prediction: 83767270.03761752
2024-09-20 10:26:45 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:26:45 - INFO - BITCOIN_FORECAST prediction: 83031905.15303504
2024-09-20 10:26:45 - INFO - BitcoinForecast prediction: 83031905.15303504
2024-09-20 10:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:26:51 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:26:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004567402549854689, 'ml': 0.07912536013061452, 'xgboost': 0.003501388396152712, 'rl': 0.21919988251355857, 'lstm': 0.10831673026680318, 'arima': 0.03100485954104962, 'prophet': 0.23335120441414486, 'transformer': 0.10831673026680318, 'bitcoin_forecast': 0.21261644192101872}
2024-09-20 10:26:51 - INFO - 조정된 모델 가중치: {'gpt': 0.004567402549854689, 'ml': 0.07912536013061452, 'xgboost': 0.003501388396152712, 'rl': 0.21919988251355857, 'lstm': 0.10831673026680318, 'arima': 0.03100485954104962, 'prophet': 0.23335120441414486, 'transformer': 0.10831673026680318, 'bitcoin_forecast': 0.21261644192101872}
2024-09-20 10:26:51 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83743489.29532772, 'current_price': 83698000.0, 'predictions': {'gpt': 83698000.0, 'ml': 83564083.2, 'xgboost': 83698000.0, 'lstm': 83725301.94650647, 'rl': 84534980.0, 'arima': 84140000.0, 'prophet': 83655479.54048462, 'transformer': 83767270.03761752, 'bitcoin_forecast': 83031905.15303504}, 'weights': {'gpt': 0.004567402549854689, 'ml': 0.07912536013061452, 'xgboost': 0.003501388396152712, 'rl': 0.21919988251355857, 'lstm': 0.10831673026680318, 'arima': 0.03100485954104962, 'prophet': 0.23335120441414486, 'transformer': 0.10831673026680318, 'bitcoin_forecast': 0.21261644192101872}}
2024-09-20 10:26:51 - INFO - 모델별 가중치:
2024-09-20 10:26:51 - INFO -   - GPT: 0.0046
2024-09-20 10:26:51 - INFO -   - ML: 0.0791
2024-09-20 10:26:51 - INFO -   - XGBOOST: 0.0035
2024-09-20 10:26:51 - INFO -   - RL: 0.2192
2024-09-20 10:26:51 - INFO -   - LSTM: 0.1083
2024-09-20 10:26:51 - INFO -   - ARIMA: 0.0310
2024-09-20 10:26:51 - INFO -   - PROPHET: 0.2334
2024-09-20 10:26:51 - INFO -   - TRANSFORMER: 0.1083
2024-09-20 10:26:51 - INFO -   - BITCOIN_FORECAST: 0.2126
2024-09-20 10:26:51 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:26:51 - INFO - 6. 거래 실행
2024-09-20 10:26:51 - INFO - Cancelling existing orders.
2024-09-20 10:26:51 - INFO - Cancelled 0 orders.
2024-09-20 10:26:51 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83743489.29532772, 'current_price': 83698000.0, 'predictions': {'gpt': 83698000.0, 'ml': 83564083.2, 'xgboost': 83698000.0, 'lstm': 83725301.94650647, 'rl': 84534980.0, 'arima': 84140000.0, 'prophet': 83655479.54048462, 'transformer': 83767270.03761752, 'bitcoin_forecast': 83031905.15303504}, 'weights': {'gpt': 0.004567402549854689, 'ml': 0.07912536013061452, 'xgboost': 0.003501388396152712, 'rl': 0.21919988251355857, 'lstm': 0.10831673026680318, 'arima': 0.03100485954104962, 'prophet': 0.23335120441414486, 'transformer': 0.10831673026680318, 'bitcoin_forecast': 0.21261644192101872}}, 현재 가격=83698000.0
2024-09-20 10:26:51 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=474082.34977859
2024-09-20 10:26:51 - INFO - 매수 시도: 0.00011085165091865994 BTC (약 9278.06147859 KRW)
2024-09-20 10:26:51 - INFO - 주문 결과: None
2024-09-20 10:26:51 - ERROR - 주문 실패
2024-09-20 10:26:51 - WARNING - Trade execution failed: Failed to place order
2024-09-20 10:26:51 - INFO - 7. summary 리포트 보내기
2024-09-20 10:26:52 - INFO - Message sent to Discord successfully.
2024-09-20 10:26:52 - INFO - Trading cycle completed.
2024-09-20 10:26:52 - INFO - Performing periodic update.
2024-09-20 10:26:52 - INFO - 계산된 시장 변동성: 0.02935039345298433
2024-09-20 10:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:35:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8143-9dc2-d6a0f0e2cd4a "HTTP/1.1 200 OK"
2024-09-20 10:35:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:35:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:35:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b3-94c0-dab4c83ffe37 "HTTP/1.1 200 OK"
2024-09-20 10:35:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812c-8769-c63c00910cb8 "HTTP/1.1 200 OK"
2024-09-20 10:36:02 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/65b38181-c56c-4ca8-94d2-1f88c52e6473 "HTTP/1.1 200 OK"
2024-09-20 10:36:08 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81af-b128-c27e55d4c2be "HTTP/1.1 200 OK"
2024-09-20 10:36:14 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a7-8480-dafa32f036cd "HTTP/1.1 200 OK"
2024-09-20 10:36:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81aa-87ef-f34a523de775 "HTTP/1.1 200 OK"
2024-09-20 10:36:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8199-a54f-c1eac5cffa82 "HTTP/1.1 200 OK"
2024-09-20 10:36:34 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:36:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8145-9b55-d00d38c2474e "HTTP/1.1 200 OK"
2024-09-20 10:36:40 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:25:34.970992
2024-09-20 10:36:40 - INFO - Starting trading cycle.
2024-09-20 10:36:40 - INFO - ##################################################
2024-09-20 10:36:40 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-20 10:36:40 - INFO - ##################################################
2024-09-20 10:36:40 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:36:40 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:36:40 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:20:00
2024-09-20 10:36:40 - INFO - 새로운 데이터 범위: 2024-09-19 01:20:00 ~ 2024-09-20 10:30:00
2024-09-20 10:36:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:36:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:36:40 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:36:40 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:36:40 - INFO - Sample date values: [Timestamp('2024-09-20 10:30:00')]
2024-09-20 10:36:40 - INFO - Successfully added 1 new data points
2024-09-20 10:36:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:36:40 - INFO - Final date range: 2024-09-20 10:30:00 to 2024-09-20 10:30:00
2024-09-20 10:36:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:36:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:30:00
2024-09-20 10:36:40 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:36:40 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:36:40 - INFO - GPT | 이전예측가격: 83698000 | 당시BTC가격: 83698000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:36:40 - INFO - ML 모델 예측 업데이트: 정확도 28.57%, 적중/전체: 2/7
2024-09-20 10:36:40 - INFO - ML | 이전예측가격: 83564083 | 당시BTC가격: 83698000 | 예측: 하락 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0404 | 반영가중치값: -0.0200 | 새 가중치: 0.0204 | 예측 총 횟수: 7 | 예측 성공 수: 2 | 예측 성공률: 28.57%
2024-09-20 10:36:40 - INFO - XGBOOST | 이전예측가격: 83698000 | 당시BTC가격: 83698000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:36:40 - INFO - LSTM 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 5/7
2024-09-20 10:36:40 - INFO - LSTM | 이전예측가격: 83725302 | 당시BTC가격: 83698000 | 예측: 상승 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1151 | 반영가중치값: 0.0200 | 새 가중치: 0.1351 | 예측 총 횟수: 7 | 예측 성공 수: 5 | 예측 성공률: 71.43%
2024-09-20 10:36:40 - INFO - RL 모델 예측 업데이트: 정확도 55.14%, 적중/전체: 59/107
2024-09-20 10:36:40 - INFO - RL | 이전예측가격: 84534980 | 당시BTC가격: 83698000 | 예측: 상승 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1552 | 반영가중치값: 0.0200 | 새 가중치: 0.1752 | 예측 총 횟수: 107 | 예측 성공 수: 59 | 예측 성공률: 55.14%
2024-09-20 10:36:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 14/26
2024-09-20 10:36:40 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83698000 | 예측: 상승 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0606 | 반영가중치값: 0.0200 | 새 가중치: 0.0806 | 예측 총 횟수: 26 | 예측 성공 수: 14 | 예측 성공률: 53.85%
2024-09-20 10:36:40 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.60%, 적중/전체: 59/99
2024-09-20 10:36:40 - INFO - PROPHET | 이전예측가격: 83655480 | 당시BTC가격: 83698000 | 예측: 하락 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.3166 | 반영가중치값: -0.0200 | 새 가중치: 0.2966 | 예측 총 횟수: 99 | 예측 성공 수: 59 | 예측 성공률: 59.60%
2024-09-20 10:36:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 5/7
2024-09-20 10:36:40 - INFO - TRANSFORMER | 이전예측가격: 83767270 | 당시BTC가격: 83698000 | 예측: 상승 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1510 | 반영가중치값: 0.0200 | 새 가중치: 0.1710 | 예측 총 횟수: 7 | 예측 성공 수: 5 | 예측 성공률: 71.43%
2024-09-20 10:36:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 61.70%, 적중/전체: 29/47
2024-09-20 10:36:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83031905 | 당시BTC가격: 83698000 | 예측: 하락 | 지금 BTC가격: 83984000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1529 | 반영가중치값: -0.0200 | 새 가중치: 0.1329 | 예측 총 횟수: 47 | 예측 성공 수: 29 | 예측 성공률: 61.70%
2024-09-20 10:36:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:36:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:36:40 - INFO - 새로운 가중치: {'gpt': 0.0044785483158645166, 'ml': 0.020005039127321374, 'xgboost': 0.003433272397957606, 'rl': 0.1717747118821826, 'lstm': 0.1324385564611768, 'arima': 0.07900630874552934, 'prophet': 0.29087007687609423, 'transformer': 0.16771257570199705, 'bitcoin_forecast': 0.13028091049187646}
2024-09-20 10:36:40 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:36:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:36:40 - INFO - Current BTC price: 83984000.0
2024-09-20 10:36:40 - INFO - Analyzing market conditions.
2024-09-20 10:36:40 - INFO - Market analysis: {'current_price': 83984000.0, 'sma_20': 83814850.0, 'rsi_14': 52.48916238655281, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:36:40 - INFO - Starting predictions for all models
2024-09-20 10:36:40 - INFO - Attempting prediction for gpt
2024-09-20 10:36:41 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:36:41 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:36:41 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:36:41 - INFO - GPT prediction: 83984000.0
2024-09-20 10:36:41 - INFO - Attempting prediction for ml
2024-09-20 10:36:41 - INFO - ML prediction: 83900016.0
2024-09-20 10:36:41 - INFO - Attempting prediction for xgboost
2024-09-20 10:36:41 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:36:41 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:36:41 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:36:41 - INFO - XGBOOST prediction: 83984000.0
2024-09-20 10:36:41 - INFO - Attempting prediction for lstm
2024-09-20 10:36:41 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:36:41 - INFO - X 샘플:
[[ 1.07010157  1.60474727  1.27241361  1.25054182  0.04628501  0.05445013
   1.25054182]
 [ 1.37348088  0.83410593  1.08416612  0.89457798  0.14744619  0.15170653
   0.89457798]
 [ 0.16685862 -0.32509408 -0.13595652 -0.45925171  0.7513685   0.75250473
  -0.45925171]
 [-1.62583731 -1.91170861 -1.80229544 -1.90644897  2.22194807  2.21339538
  -1.90644897]
 [-1.32935298 -0.71365274 -0.74253178 -0.30169394 -0.02346396 -0.02532126
  -0.30169394]
 [ 1.04252163  0.73049028  0.94472353  0.62614623  0.60219234  0.61025291
   0.62614623]
 [ 0.18754357 -0.30566615 -0.39392531 -0.87357028 -1.10519084 -1.10970686
  -0.87357028]
 [-1.15697837 -0.57118123 -1.23058083 -0.54094833 -0.44890835 -0.4536101
  -0.54094833]
 [ 0.00827398 -0.47404157  0.10109588 -0.17914902 -1.47441071 -1.47911794
  -0.17914902]
 [ 0.2633884   1.1320009   0.90289075  1.48979621 -0.71726624 -0.71455352
   1.48979621]]
2024-09-20 10:36:41 - INFO - y 샘플:
[1.48979621]
2024-09-20 10:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:36:41 - INFO - 모델 출력 (스케일링된 예측): [[0.15630293]]
2024-09-20 10:36:41 - INFO - 스케일러 역변환 후 예측 가격: 83755484.96395731
2024-09-20 10:36:41 - INFO - LSTMPredictor 최종 예측 가격: 83755484.96395731
2024-09-20 10:36:41 - INFO - LSTM prediction: 83755484.96395731
2024-09-20 10:36:41 - INFO - Attempting prediction for rl
2024-09-20 10:36:41 - INFO - Preparing state for RL agent.
2024-09-20 10:36:41 - INFO - Prepared state: [[8.39840000e+07 1.60226567e+01 3.41704700e-03 8.38148500e+07
  5.24891624e+01]]
2024-09-20 10:36:41 - INFO - RL prediction: 84823840.0
2024-09-20 10:36:41 - INFO - Attempting prediction for arima
2024-09-20 10:36:41 - INFO - ARIMA 예측 시작
2024-09-20 10:36:41 - INFO - 입력 데이터: {'open': 83774000.0, 'high': 83985000.0, 'low': 83765000.0, 'close': 83984000.0, 'volume': 16.02265669, 'value': 1344997525.70425, 'decision': 'sell', 'sma': 83814850.0, 'ema': 83835864.19786277, 'rsi': 52.48916238655281, 'macd': -105807.62374523282, 'signal_line': -130091.9719960957, 'BB_Upper': 84200524.6167453, 'BB_Lower': 83429175.3832547}
2024-09-20 10:36:41 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:36:41 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83814850.0         0         0
2024-09-20 10:36:41 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83814850.0         0         0
2024-09-20 10:36:41 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:36:41 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:36:41 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:36:41 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:36:41 - INFO - Attempting prediction for prophet
2024-09-20 10:36:41 - INFO - PROPHET prediction: 83989131.11929542
2024-09-20 10:36:41 - INFO - Attempting prediction for transformer
2024-09-20 10:36:41 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:36:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:36:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:36:41 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:36:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:36:41 - INFO - X 샘플:
[[ 1.07010157  1.60474727  1.27241361  1.25054182  0.04628501  0.05445013
   1.25054182  1.25054182  0.          0.          0.          1.25054182
   1.25054182]
 [ 1.37348088  0.83410593  1.08416612  0.89457798  0.14744619  0.15170653
   0.89457798  0.89457798  0.          0.          0.          0.89457798
   0.89457798]
 [ 0.16685862 -0.32509408 -0.13595652 -0.45925171  0.7513685   0.75250473
  -0.45925171 -0.45925171  0.          0.          0.         -0.45925171
  -0.45925171]
 [-1.62583731 -1.91170861 -1.80229544 -1.90644897  2.22194807  2.21339538
  -1.90644897 -1.90644897  0.          0.          0.         -1.90644897
  -1.90644897]
 [-1.32935298 -0.71365274 -0.74253178 -0.30169394 -0.02346396 -0.02532126
  -0.30169394 -0.30169394  0.          0.          0.         -0.30169394
  -0.30169394]
 [ 1.04252163  0.73049028  0.94472353  0.62614623  0.60219234  0.61025291
   0.62614623  0.62614623  0.          0.          0.          0.62614623
   0.62614623]
 [ 0.18754357 -0.30566615 -0.39392531 -0.87357028 -1.10519084 -1.10970686
  -0.87357028 -0.87357028  0.          0.          0.         -0.87357028
  -0.87357028]
 [-1.15697837 -0.57118123 -1.23058083 -0.54094833 -0.44890835 -0.4536101
  -0.54094833 -0.54094833  0.          0.          0.         -0.54094833
  -0.54094833]
 [ 0.00827398 -0.47404157  0.10109588 -0.17914902 -1.47441071 -1.47911794
  -0.17914902 -0.17914902  0.          0.          0.         -0.17914902
  -0.17914902]
 [ 0.2633884   1.1320009   0.90289075  1.48979621 -0.71726624 -0.71455352
   1.48979621  1.48979621  0.          0.          0.          1.48979621
   1.48979621]]
2024-09-20 10:36:41 - INFO - y 샘플:
[1.48979621]
2024-09-20 10:36:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:36:41 - INFO - 모델 출력 (스케일링된 예측): [0.30476856]
2024-09-20 10:36:41 - INFO - 스케일러 역변환 후 예측 가격: 83780926.8841227
2024-09-20 10:36:41 - INFO - TransformerPredictor 최종 예측 가격: 83780926.8841227
2024-09-20 10:36:41 - INFO - TRANSFORMER prediction: 83780926.8841227
2024-09-20 10:36:41 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:36:41 - INFO - BITCOIN_FORECAST prediction: 83136806.40106182
2024-09-20 10:36:41 - INFO - BitcoinForecast prediction: 83136806.40106182
2024-09-20 10:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:36:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:36:47 - INFO - 조정된 모델 가중치: {'gpt': 0.0044785483158645166, 'ml': 0.020005039127321374, 'xgboost': 0.003433272397957606, 'rl': 0.1717747118821826, 'lstm': 0.1324385564611768, 'arima': 0.07900630874552934, 'prophet': 0.29087007687609423, 'transformer': 0.16771257570199705, 'bitcoin_forecast': 0.13028091049187646}
2024-09-20 10:36:47 - INFO - 조정된 모델 가중치: {'gpt': 0.0044785483158645166, 'ml': 0.020005039127321374, 'xgboost': 0.003433272397957606, 'rl': 0.1717747118821826, 'lstm': 0.1324385564611768, 'arima': 0.07900630874552934, 'prophet': 0.29087007687609423, 'transformer': 0.16771257570199705, 'bitcoin_forecast': 0.13028091049187646}
2024-09-20 10:36:47 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83965705.37379394, 'current_price': 83984000.0, 'predictions': {'gpt': 83984000.0, 'ml': 83900016.0, 'xgboost': 83984000.0, 'lstm': 83755484.96395731, 'rl': 84823840.0, 'arima': 84140000.0, 'prophet': 83989131.11929542, 'transformer': 83780926.8841227, 'bitcoin_forecast': 83136806.40106182}, 'weights': {'gpt': 0.0044785483158645166, 'ml': 0.020005039127321374, 'xgboost': 0.003433272397957606, 'rl': 0.1717747118821826, 'lstm': 0.1324385564611768, 'arima': 0.07900630874552934, 'prophet': 0.29087007687609423, 'transformer': 0.16771257570199705, 'bitcoin_forecast': 0.13028091049187646}}
2024-09-20 10:36:47 - INFO - 모델별 가중치:
2024-09-20 10:36:47 - INFO -   - GPT: 0.0045
2024-09-20 10:36:47 - INFO -   - ML: 0.0200
2024-09-20 10:36:47 - INFO -   - XGBOOST: 0.0034
2024-09-20 10:36:47 - INFO -   - RL: 0.1718
2024-09-20 10:36:47 - INFO -   - LSTM: 0.1324
2024-09-20 10:36:47 - INFO -   - ARIMA: 0.0790
2024-09-20 10:36:47 - INFO -   - PROPHET: 0.2909
2024-09-20 10:36:47 - INFO -   - TRANSFORMER: 0.1677
2024-09-20 10:36:47 - INFO -   - BITCOIN_FORECAST: 0.1303
2024-09-20 10:36:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:36:47 - INFO - 6. 거래 실행
2024-09-20 10:36:47 - INFO - Cancelling existing orders.
2024-09-20 10:36:47 - INFO - Cancelled 0 orders.
2024-09-20 10:36:47 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83965705.37379394, 'current_price': 83984000.0, 'predictions': {'gpt': 83984000.0, 'ml': 83900016.0, 'xgboost': 83984000.0, 'lstm': 83755484.96395731, 'rl': 84823840.0, 'arima': 84140000.0, 'prophet': 83989131.11929542, 'transformer': 83780926.8841227, 'bitcoin_forecast': 83136806.40106182}, 'weights': {'gpt': 0.0044785483158645166, 'ml': 0.020005039127321374, 'xgboost': 0.003433272397957606, 'rl': 0.1717747118821826, 'lstm': 0.1324385564611768, 'arima': 0.07900630874552934, 'prophet': 0.29087007687609423, 'transformer': 0.16771257570199705, 'bitcoin_forecast': 0.13028091049187646}}, 현재 가격=83984000.0
2024-09-20 10:36:48 - INFO - 현재 잔고: KRW=9278.06147859, BTC=0.00555335, 총 자산가치=475670.60787859006
2024-09-20 10:36:48 - INFO - 매도 시도: 0.0005553350000000001 BTC (약 46639.25464000001 KRW)
2024-09-20 10:36:48 - INFO - 주문 결과: {'uuid': 'd185337b-f99a-461c-837c-b45b32bdfa5a', 'side': 'ask', 'ord_type': 'limit', 'price': '83984000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T10:36:49+09:00', 'volume': '0.00055533', 'remaining_volume': '0.00055533', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00055533', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 10:36:48 - INFO - sell 주문 성공: UUID=d185337b-f99a-461c-837c-b45b32bdfa5a
2024-09-20 10:36:48 - INFO - Trade executed successfully.
2024-09-20 10:36:48 - INFO - 7. summary 리포트 보내기
2024-09-20 10:36:48 - INFO - Message sent to Discord successfully.
2024-09-20 10:36:48 - INFO - Trading cycle completed.
2024-09-20 10:36:48 - INFO - Performing periodic update.
2024-09-20 10:36:48 - INFO - 계산된 시장 변동성: 0.029797622897881387
2024-09-20 10:45:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:45:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-819a-b9b4-e85a41a2af19 "HTTP/1.1 200 OK"
2024-09-20 10:45:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:45:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:45:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8116-9b75-f0511b161f8d "HTTP/1.1 200 OK"
2024-09-20 10:45:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-811a-82f5-ddc3cc757e1b "HTTP/1.1 200 OK"
2024-09-20 10:46:00 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81cd-bb0a-d92689cae868 "HTTP/1.1 200 OK"
2024-09-20 10:46:07 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8136-ab2e-c431e7da9259 "HTTP/1.1 200 OK"
2024-09-20 10:46:24 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b9-9232-d51e02c67057 "HTTP/1.1 200 OK"
2024-09-20 10:46:31 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e5-8f21-d46966eb5beb "HTTP/1.1 200 OK"
2024-09-20 10:46:36 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817d-8b03-c31e2c236992 "HTTP/1.1 200 OK"
2024-09-20 10:46:43 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:46:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-811f-9ba5-db7fd1644260 "HTTP/1.1 200 OK"
2024-09-20 10:46:50 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:35:34.971254
2024-09-20 10:46:50 - INFO - Starting trading cycle.
2024-09-20 10:46:50 - INFO - ##################################################
2024-09-20 10:46:50 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-20 10:46:50 - INFO - ##################################################
2024-09-20 10:46:50 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:46:50 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:46:50 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:30:00
2024-09-20 10:46:50 - INFO - 새로운 데이터 범위: 2024-09-19 01:30:00 ~ 2024-09-20 10:40:00
2024-09-20 10:46:50 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:46:50 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:46:50 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:46:50 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:46:50 - INFO - Sample date values: [Timestamp('2024-09-20 10:40:00')]
2024-09-20 10:46:50 - INFO - Successfully added 1 new data points
2024-09-20 10:46:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:46:50 - INFO - Final date range: 2024-09-20 10:40:00 to 2024-09-20 10:40:00
2024-09-20 10:46:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:46:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:40:00
2024-09-20 10:46:50 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:46:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:46:50 - INFO - GPT | 이전예측가격: 83984000 | 당시BTC가격: 83984000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:46:50 - INFO - ML 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 2/8
2024-09-20 10:46:50 - INFO - ML | 이전예측가격: 83900016 | 당시BTC가격: 83984000 | 예측: 하락 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0791 | 반영가중치값: -0.0200 | 새 가중치: 0.0591 | 예측 총 횟수: 8 | 예측 성공 수: 2 | 예측 성공률: 25.00%
2024-09-20 10:46:50 - INFO - XGBOOST | 이전예측가격: 83984000 | 당시BTC가격: 83984000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:46:50 - INFO - LSTM 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-20 10:46:50 - INFO - LSTM | 이전예측가격: 83755485 | 당시BTC가격: 83984000 | 예측: 하락 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1083 | 반영가중치값: -0.0200 | 새 가중치: 0.0883 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-20 10:46:50 - INFO - RL 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 60/108
2024-09-20 10:46:50 - INFO - RL | 이전예측가격: 84823840 | 당시BTC가격: 83984000 | 예측: 상승 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2192 | 반영가중치값: 0.0200 | 새 가중치: 0.2392 | 예측 총 횟수: 108 | 예측 성공 수: 60 | 예측 성공률: 55.56%
2024-09-20 10:46:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 15/27
2024-09-20 10:46:50 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83984000 | 예측: 상승 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0310 | 반영가중치값: 0.0200 | 새 가중치: 0.0510 | 예측 총 횟수: 27 | 예측 성공 수: 15 | 예측 성공률: 55.56%
2024-09-20 10:46:50 - INFO - PROPHET | 이전예측가격: 83989131 | 당시BTC가격: 83984000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:46:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-20 10:46:50 - INFO - TRANSFORMER | 이전예측가격: 83780927 | 당시BTC가격: 83984000 | 예측: 하락 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1083 | 반영가중치값: -0.0200 | 새 가중치: 0.0883 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-20 10:46:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.42%, 적중/전체: 29/48
2024-09-20 10:46:50 - INFO - BITCOIN_FORECAST | 이전예측가격: 83136806 | 당시BTC가격: 83984000 | 예측: 하락 | 지금 BTC가격: 84000000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2126 | 반영가중치값: -0.0200 | 새 가중치: 0.1926 | 예측 총 횟수: 48 | 예측 성공 수: 29 | 예측 성공률: 60.42%
2024-09-20 10:46:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:46:50 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:46:50 - INFO - 새로운 가중치: {'gpt': 0.004402119153517375, 'ml': 0.05811634974833318, 'xgboost': 0.0033746815075666407, 'rl': 0.23511779042374334, 'lstm': 0.08680955132410438, 'arima': 0.05013443046104013, 'prophet': 0.28590620136117817, 'transformer': 0.08680955132410438, 'bitcoin_forecast': 0.18932932469641234}
2024-09-20 10:46:50 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:46:50 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:46:50 - INFO - Current BTC price: 84000000.0
2024-09-20 10:46:50 - INFO - Analyzing market conditions.
2024-09-20 10:46:50 - INFO - Market analysis: {'current_price': 84000000.0, 'sma_20': 83841600.0, 'rsi_14': 52.90143084440294, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:46:50 - INFO - Starting predictions for all models
2024-09-20 10:46:50 - INFO - Attempting prediction for gpt
2024-09-20 10:46:50 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:46:50 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:46:50 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:46:50 - INFO - GPT prediction: 84000000.0
2024-09-20 10:46:50 - INFO - Attempting prediction for ml
2024-09-20 10:46:50 - INFO - ML prediction: 83798400.0
2024-09-20 10:46:50 - INFO - Attempting prediction for xgboost
2024-09-20 10:46:50 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:46:50 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:46:50 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:46:50 - INFO - XGBOOST prediction: 84000000.0
2024-09-20 10:46:50 - INFO - Attempting prediction for lstm
2024-09-20 10:46:50 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:46:50 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:46:50 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:46:50 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:46:50 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:46:50 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:46:50 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:46:50 - INFO - X 샘플:
[[ 1.2137282   0.92285256  0.87936348  0.82380182  0.19249572  0.1970734
   0.82380182]
 [ 0.09699615 -0.30441793 -0.19602862 -0.47106283  0.79189231  0.79352821
  -0.47106283]
 [-1.5621486  -1.98420157 -1.66470696 -1.85522849  2.25145151  2.24385753
  -1.85522849]
 [-1.28775158 -0.71579352 -0.73065212 -0.32036737  0.02286635  0.02132541
  -0.32036737]
 [ 0.90742455  0.81315241  0.75646153  0.56706142  0.64383406  0.65230477
   0.56706142]
 [ 0.11614013 -0.28384915 -0.42339723 -0.86733606 -1.05075419 -1.05522076
  -0.86733606]
 [-1.12821843 -0.5649558  -1.16080895 -0.54920121 -0.3993898  -0.40386717
  -0.54920121]
 [-0.04977434 -0.46211191  0.01290471 -0.2031598  -1.41720717 -1.42196123
  -0.2031598 ]
 [ 0.18633472  1.23824051  0.71959094  1.39309576 -0.66573665 -0.66292413
   1.39309576]
 [ 1.5072692   1.34108441  1.80727323  1.48239677 -0.36945214 -0.36411602
   1.48239677]]
2024-09-20 10:46:50 - INFO - y 샘플:
[1.48239677]
2024-09-20 10:46:50 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:46:50 - INFO - 모델 출력 (스케일링된 예측): [[0.3140741]]
2024-09-20 10:46:50 - INFO - 스케일러 역변환 후 예측 가격: 83790672.43817557
2024-09-20 10:46:50 - INFO - LSTMPredictor 최종 예측 가격: 83790672.43817557
2024-09-20 10:46:50 - INFO - LSTM prediction: 83790672.43817557
2024-09-20 10:46:50 - INFO - Attempting prediction for rl
2024-09-20 10:46:50 - INFO - Preparing state for RL agent.
2024-09-20 10:46:50 - INFO - Prepared state: [[8.40000000e+07 1.87028226e+01 1.90512479e-04 8.38416000e+07
  5.29014308e+01]]
2024-09-20 10:46:50 - INFO - RL prediction: 84840000.0
2024-09-20 10:46:50 - INFO - Attempting prediction for arima
2024-09-20 10:46:50 - INFO - ARIMA 예측 시작
2024-09-20 10:46:50 - INFO - 입력 데이터: {'open': 83981000.0, 'high': 84000000.0, 'low': 83942000.0, 'close': 84000000.0, 'volume': 18.70282257, 'value': 1570564006.04323, 'decision': 'sell', 'sma': 83841600.0, 'ema': 83851496.1790187, 'rsi': 52.90143084440294, 'macd': -80364.68466039002, 'signal_line': -120146.51452895458, 'BB_Upper': 84199733.71804847, 'BB_Lower': 83483466.28195153}
2024-09-20 10:46:50 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:46:50 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83841600.0         0         0
2024-09-20 10:46:50 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83841600.0         0         0
2024-09-20 10:46:50 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:46:50 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:46:50 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:46:50 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:46:50 - INFO - Attempting prediction for prophet
2024-09-20 10:46:51 - INFO - PROPHET prediction: 84008585.10509385
2024-09-20 10:46:51 - INFO - Attempting prediction for transformer
2024-09-20 10:46:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:46:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:46:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:46:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:46:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:46:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:46:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:46:51 - INFO - X 샘플:
[[ 1.2137282   0.92285256  0.87936348  0.82380182  0.19249572  0.1970734
   0.82380182  0.82380182  0.          0.          0.          0.82380182
   0.82380182]
 [ 0.09699615 -0.30441793 -0.19602862 -0.47106283  0.79189231  0.79352821
  -0.47106283 -0.47106283  0.          0.          0.         -0.47106283
  -0.47106283]
 [-1.5621486  -1.98420157 -1.66470696 -1.85522849  2.25145151  2.24385753
  -1.85522849 -1.85522849  0.          0.          0.         -1.85522849
  -1.85522849]
 [-1.28775158 -0.71579352 -0.73065212 -0.32036737  0.02286635  0.02132541
  -0.32036737 -0.32036737  0.          0.          0.         -0.32036737
  -0.32036737]
 [ 0.90742455  0.81315241  0.75646153  0.56706142  0.64383406  0.65230477
   0.56706142  0.56706142  0.          0.          0.          0.56706142
   0.56706142]
 [ 0.11614013 -0.28384915 -0.42339723 -0.86733606 -1.05075419 -1.05522076
  -0.86733606 -0.86733606  0.          0.          0.         -0.86733606
  -0.86733606]
 [-1.12821843 -0.5649558  -1.16080895 -0.54920121 -0.3993898  -0.40386717
  -0.54920121 -0.54920121  0.          0.          0.         -0.54920121
  -0.54920121]
 [-0.04977434 -0.46211191  0.01290471 -0.2031598  -1.41720717 -1.42196123
  -0.2031598  -0.2031598   0.          0.          0.         -0.2031598
  -0.2031598 ]
 [ 0.18633472  1.23824051  0.71959094  1.39309576 -0.66573665 -0.66292413
   1.39309576  1.39309576  0.          0.          0.          1.39309576
   1.39309576]
 [ 1.5072692   1.34108441  1.80727323  1.48239677 -0.36945214 -0.36411602
   1.48239677  1.48239677  0.          0.          0.          1.48239677
   1.48239677]]
2024-09-20 10:46:51 - INFO - y 샘플:
[1.48239677]
2024-09-20 10:46:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:46:51 - INFO - 모델 출력 (스케일링된 예측): [0.3049628]
2024-09-20 10:46:51 - INFO - 스케일러 역변환 후 예측 가격: 83789039.9755332
2024-09-20 10:46:51 - INFO - TransformerPredictor 최종 예측 가격: 83789039.9755332
2024-09-20 10:46:51 - INFO - TRANSFORMER prediction: 83789039.9755332
2024-09-20 10:46:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:46:51 - INFO - BITCOIN_FORECAST prediction: 83197983.13653788
2024-09-20 10:46:51 - INFO - BitcoinForecast prediction: 83197983.13653788
2024-09-20 10:46:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:46:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:46:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004402119153517375, 'ml': 0.05811634974833318, 'xgboost': 0.0033746815075666407, 'rl': 0.23511779042374334, 'lstm': 0.08680955132410438, 'arima': 0.05013443046104013, 'prophet': 0.28590620136117817, 'transformer': 0.08680955132410438, 'bitcoin_forecast': 0.18932932469641234}
2024-09-20 10:46:59 - INFO - 조정된 모델 가중치: {'gpt': 0.004402119153517375, 'ml': 0.05811634974833318, 'xgboost': 0.0033746815075666407, 'rl': 0.23511779042374334, 'lstm': 0.08680955132410438, 'arima': 0.05013443046104013, 'prophet': 0.28590620136117817, 'transformer': 0.08680955132410438, 'bitcoin_forecast': 0.18932932469641234}
2024-09-20 10:46:59 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84006925.75494945, 'current_price': 84000000.0, 'predictions': {'gpt': 84000000.0, 'ml': 83798400.0, 'xgboost': 84000000.0, 'lstm': 83790672.43817557, 'rl': 84840000.0, 'arima': 84140000.0, 'prophet': 84008585.10509385, 'transformer': 83789039.9755332, 'bitcoin_forecast': 83197983.13653788}, 'weights': {'gpt': 0.004402119153517375, 'ml': 0.05811634974833318, 'xgboost': 0.0033746815075666407, 'rl': 0.23511779042374334, 'lstm': 0.08680955132410438, 'arima': 0.05013443046104013, 'prophet': 0.28590620136117817, 'transformer': 0.08680955132410438, 'bitcoin_forecast': 0.18932932469641234}}
2024-09-20 10:46:59 - INFO - 모델별 가중치:
2024-09-20 10:46:59 - INFO -   - GPT: 0.0044
2024-09-20 10:46:59 - INFO -   - ML: 0.0581
2024-09-20 10:46:59 - INFO -   - XGBOOST: 0.0034
2024-09-20 10:46:59 - INFO -   - RL: 0.2351
2024-09-20 10:46:59 - INFO -   - LSTM: 0.0868
2024-09-20 10:46:59 - INFO -   - ARIMA: 0.0501
2024-09-20 10:46:59 - INFO -   - PROPHET: 0.2859
2024-09-20 10:46:59 - INFO -   - TRANSFORMER: 0.0868
2024-09-20 10:46:59 - INFO -   - BITCOIN_FORECAST: 0.1893
2024-09-20 10:46:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:46:59 - INFO - 6. 거래 실행
2024-09-20 10:46:59 - INFO - Cancelling existing orders.
2024-09-20 10:47:00 - INFO - Cancelled 0 orders.
2024-09-20 10:47:00 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84006925.75494945, 'current_price': 84000000.0, 'predictions': {'gpt': 84000000.0, 'ml': 83798400.0, 'xgboost': 84000000.0, 'lstm': 83790672.43817557, 'rl': 84840000.0, 'arima': 84140000.0, 'prophet': 84008585.10509385, 'transformer': 83789039.9755332, 'bitcoin_forecast': 83197983.13653788}, 'weights': {'gpt': 0.004402119153517375, 'ml': 0.05811634974833318, 'xgboost': 0.0033746815075666407, 'rl': 0.23511779042374334, 'lstm': 0.08680955132410438, 'arima': 0.05013443046104013, 'prophet': 0.28590620136117817, 'transformer': 0.08680955132410438, 'bitcoin_forecast': 0.18932932469641234}}, 현재 가격=84000000.0
2024-09-20 10:47:00 - INFO - 현재 잔고: KRW=55893.57678123, BTC=0.00499802, 총 자산가치=475727.25678123
2024-09-20 10:47:00 - INFO - 매수 시도: 0.0005663419723586072 BTC (약 47572.725678123 KRW)
2024-09-20 10:47:00 - INFO - 주문 결과: {'uuid': '5e858993-9957-46ff-ad46-d7f635fa38a8', 'side': 'bid', 'ord_type': 'limit', 'price': '84000000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T10:47:01+09:00', 'volume': '0.00056634', 'remaining_volume': '0.00056634', 'reserved_fee': '23.78628', 'remaining_fee': '23.78628', 'paid_fee': '0', 'locked': '47596.34628', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 10:47:00 - INFO - buy 주문 성공: UUID=5e858993-9957-46ff-ad46-d7f635fa38a8
2024-09-20 10:47:00 - INFO - Trade executed successfully.
2024-09-20 10:47:00 - INFO - 7. summary 리포트 보내기
2024-09-20 10:47:00 - INFO - Message sent to Discord successfully.
2024-09-20 10:47:00 - INFO - Trading cycle completed.
2024-09-20 10:47:00 - INFO - Performing periodic update.
2024-09-20 10:47:00 - INFO - 계산된 시장 변동성: 0.029721732686522548
2024-09-20 10:55:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:55:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813d-98f1-cc34bd55e826 "HTTP/1.1 200 OK"
2024-09-20 10:55:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:55:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:55:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b5-bf49-c79c9bc979c2 "HTTP/1.1 200 OK"
2024-09-20 10:55:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:55:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f5-a12b-f5d9804482be "HTTP/1.1 200 OK"
2024-09-20 10:55:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8179-81f9-d3c5ceebf102 "HTTP/1.1 200 OK"
2024-09-20 10:56:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817a-95d2-f1922b20b396 "HTTP/1.1 200 OK"
2024-09-20 10:56:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816f-8bd2-d0777c7415ff "HTTP/1.1 200 OK"
2024-09-20 10:56:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8187-8b81-e0f1d7564c44 "HTTP/1.1 200 OK"
2024-09-20 10:56:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8141-889d-ff006fe36c77 "HTTP/1.1 200 OK"
2024-09-20 10:56:31 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 10:56:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d3-a8e3-e37373752de5 "HTTP/1.1 200 OK"
2024-09-20 10:56:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:45:34.971314
2024-09-20 10:56:39 - INFO - Starting trading cycle.
2024-09-20 10:56:39 - INFO - ##################################################
2024-09-20 10:56:39 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-20 10:56:39 - INFO - ##################################################
2024-09-20 10:56:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 10:56:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 10:56:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:40:00
2024-09-20 10:56:39 - INFO - 새로운 데이터 범위: 2024-09-19 01:40:00 ~ 2024-09-20 10:50:00
2024-09-20 10:56:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 10:56:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 10:56:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 10:56:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 10:56:39 - INFO - Sample date values: [Timestamp('2024-09-20 10:50:00')]
2024-09-20 10:56:39 - INFO - Successfully added 1 new data points
2024-09-20 10:56:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 10:56:39 - INFO - Final date range: 2024-09-20 10:50:00 to 2024-09-20 10:50:00
2024-09-20 10:56:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 10:56:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 10:50:00
2024-09-20 10:56:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 10:56:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 10:56:39 - INFO - GPT | 이전예측가격: 84000000 | 당시BTC가격: 84000000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:56:39 - INFO - ML 모델 예측 업데이트: 정확도 22.22%, 적중/전체: 2/9
2024-09-20 10:56:39 - INFO - ML | 이전예측가격: 83798400 | 당시BTC가격: 84000000 | 예측: 하락 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0200 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 9 | 예측 성공 수: 2 | 예측 성공률: 22.22%
2024-09-20 10:56:39 - INFO - XGBOOST | 이전예측가격: 84000000 | 당시BTC가격: 84000000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 10:56:39 - INFO - LSTM 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-20 10:56:39 - INFO - LSTM | 이전예측가격: 83790672 | 당시BTC가격: 84000000 | 예측: 하락 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1324 | 반영가중치값: -0.0200 | 새 가중치: 0.1124 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-20 10:56:39 - INFO - RL 모델 예측 업데이트: 정확도 55.96%, 적중/전체: 61/109
2024-09-20 10:56:40 - INFO - RL | 이전예측가격: 84840000 | 당시BTC가격: 84000000 | 예측: 상승 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1718 | 반영가중치값: 0.0200 | 새 가중치: 0.1918 | 예측 총 횟수: 109 | 예측 성공 수: 61 | 예측 성공률: 55.96%
2024-09-20 10:56:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 16/28
2024-09-20 10:56:40 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84000000 | 예측: 상승 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0790 | 반영가중치값: 0.0200 | 새 가중치: 0.0990 | 예측 총 횟수: 28 | 예측 성공 수: 16 | 예측 성공률: 57.14%
2024-09-20 10:56:40 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 60/100
2024-09-20 10:56:40 - INFO - PROPHET | 이전예측가격: 84008585 | 당시BTC가격: 84000000 | 예측: 상승 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2909 | 반영가중치값: 0.0200 | 새 가중치: 0.3109 | 예측 총 횟수: 100 | 예측 성공 수: 60 | 예측 성공률: 60.00%
2024-09-20 10:56:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-20 10:56:40 - INFO - TRANSFORMER | 이전예측가격: 83789040 | 당시BTC가격: 84000000 | 예측: 하락 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1677 | 반영가중치값: -0.0200 | 새 가중치: 0.1477 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-20 10:56:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 59.18%, 적중/전체: 29/49
2024-09-20 10:56:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83197983 | 당시BTC가격: 84000000 | 예측: 하락 | 지금 BTC가격: 84176000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1303 | 반영가중치값: -0.0200 | 새 가중치: 0.1103 | 예측 총 횟수: 49 | 예측 성공 수: 29 | 예측 성공률: 59.18%
2024-09-20 10:56:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 10:56:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 10:56:40 - INFO - 새로운 가중치: {'gpt': 0.0044925772872853416, 'ml': 5.14267518943807e-06, 'xgboost': 0.003444027061512365, 'rl': 0.19571544631843488, 'lstm': 0.11474903049114833, 'arima': 0.10104076660731161, 'prophet': 0.3172580745694431, 'transformer': 0.15074788743847875, 'bitcoin_forecast': 0.11254704755119627}
2024-09-20 10:56:40 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 10:56:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 10:56:40 - INFO - Current BTC price: 84176000.0
2024-09-20 10:56:40 - INFO - Analyzing market conditions.
2024-09-20 10:56:40 - INFO - Market analysis: {'current_price': 84176000.0, 'sma_20': 83857950.0, 'rsi_14': 57.2915710122912, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 10:56:40 - INFO - Starting predictions for all models
2024-09-20 10:56:40 - INFO - Attempting prediction for gpt
2024-09-20 10:56:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 10:56:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:56:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 10:56:40 - INFO - GPT prediction: 84176000.0
2024-09-20 10:56:40 - INFO - Attempting prediction for ml
2024-09-20 10:56:40 - INFO - ML prediction: 83973977.60000001
2024-09-20 10:56:40 - INFO - Attempting prediction for xgboost
2024-09-20 10:56:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 10:56:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:56:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 10:56:40 - INFO - XGBOOST prediction: 84176000.0
2024-09-20 10:56:40 - INFO - Attempting prediction for lstm
2024-09-20 10:56:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:56:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:56:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 10:56:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:56:40 - INFO - X 샘플:
[[-0.00331223 -0.38240689 -0.27676864 -0.51642112  0.84607105  0.84759382
  -0.51642112]
 [-1.43861053 -1.67467845 -1.52956608 -1.64183798  2.30016857  2.29307734
  -1.64183798]
 [-1.20123428 -0.69888156 -0.73280788 -0.3938959   0.0799228   0.07797109
  -0.3938959 ]
 [ 0.69777579  0.47734929  0.53571506  0.32764152  0.69856684  0.70684224
   0.32764152]
 [ 0.01324891 -0.36658316 -0.47071636 -0.83861708 -0.98968023 -0.99497815
  -0.83861708]
 [-1.06322482 -0.58284085 -1.099736   -0.57995272 -0.34075326 -0.34580085
  -0.57995272]
 [-0.13028092 -0.50372218 -0.09854641 -0.2985985  -1.35476193 -1.36049327
  -0.2985985 ]
 [ 0.07397307  0.80437312  0.50426407  0.99926126 -0.60610343 -0.60399225
   0.99926126]
 [ 1.21669133  0.88349178  1.43206804  1.07186879 -0.31092762 -0.30618252
   1.07186879]
 [ 1.83497368  2.0438989   1.73609419  1.87055172 -0.32250279 -0.31403744
   1.87055172]]
2024-09-20 10:56:40 - INFO - y 샘플:
[1.87055172]
2024-09-20 10:56:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 10:56:40 - INFO - 모델 출력 (스케일링된 예측): [[0.42330247]]
2024-09-20 10:56:40 - INFO - 스케일러 역변환 후 예측 가격: 83857080.11441644
2024-09-20 10:56:40 - INFO - LSTMPredictor 최종 예측 가격: 83857080.11441644
2024-09-20 10:56:40 - INFO - LSTM prediction: 83857080.11441644
2024-09-20 10:56:40 - INFO - Attempting prediction for rl
2024-09-20 10:56:40 - INFO - Preparing state for RL agent.
2024-09-20 10:56:40 - INFO - Prepared state: [[8.41760000e+07 1.85977213e+01 2.09523810e-03 8.38579500e+07
  5.72915710e+01]]
2024-09-20 10:56:40 - INFO - RL prediction: 85017760.0
2024-09-20 10:56:40 - INFO - Attempting prediction for arima
2024-09-20 10:56:40 - INFO - ARIMA 예측 시작
2024-09-20 10:56:40 - INFO - 입력 데이터: {'open': 84093000.0, 'high': 84220000.0, 'low': 84000000.0, 'close': 84176000.0, 'volume': 18.59772126, 'value': 1564614541.87368, 'decision': 'sell', 'sma': 83857950.0, 'ema': 83882401.30482645, 'rsi': 57.2915710122912, 'macd': -45475.03512485325, 'signal_line': -105212.21864813431, 'BB_Upper': 84244659.43872839, 'BB_Lower': 83471240.56127161}
2024-09-20 10:56:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 10:56:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83857950.0         0         0
2024-09-20 10:56:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83857950.0         0         0
2024-09-20 10:56:40 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 10:56:40 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 10:56:40 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 10:56:40 - INFO - ARIMA prediction: 84140000.0
2024-09-20 10:56:40 - INFO - Attempting prediction for prophet
2024-09-20 10:56:40 - INFO - PROPHET prediction: 84208416.68165328
2024-09-20 10:56:40 - INFO - Attempting prediction for transformer
2024-09-20 10:56:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 10:56:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 10:56:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 10:56:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 10:56:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 10:56:40 - INFO - X 샘플:
[[-0.00331223 -0.38240689 -0.27676864 -0.51642112  0.84607105  0.84759382
  -0.51642112 -0.51642112  0.          0.          0.         -0.51642112
  -0.51642112]
 [-1.43861053 -1.67467845 -1.52956608 -1.64183798  2.30016857  2.29307734
  -1.64183798 -1.64183798  0.          0.          0.         -1.64183798
  -1.64183798]
 [-1.20123428 -0.69888156 -0.73280788 -0.3938959   0.0799228   0.07797109
  -0.3938959  -0.3938959   0.          0.          0.         -0.3938959
  -0.3938959 ]
 [ 0.69777579  0.47734929  0.53571506  0.32764152  0.69856684  0.70684224
   0.32764152  0.32764152  0.          0.          0.          0.32764152
   0.32764152]
 [ 0.01324891 -0.36658316 -0.47071636 -0.83861708 -0.98968023 -0.99497815
  -0.83861708 -0.83861708  0.          0.          0.         -0.83861708
  -0.83861708]
 [-1.06322482 -0.58284085 -1.099736   -0.57995272 -0.34075326 -0.34580085
  -0.57995272 -0.57995272  0.          0.          0.         -0.57995272
  -0.57995272]
 [-0.13028092 -0.50372218 -0.09854641 -0.2985985  -1.35476193 -1.36049327
  -0.2985985  -0.2985985   0.          0.          0.         -0.2985985
  -0.2985985 ]
 [ 0.07397307  0.80437312  0.50426407  0.99926126 -0.60610343 -0.60399225
   0.99926126  0.99926126  0.          0.          0.          0.99926126
   0.99926126]
 [ 1.21669133  0.88349178  1.43206804  1.07186879 -0.31092762 -0.30618252
   1.07186879  1.07186879  0.          0.          0.          1.07186879
   1.07186879]
 [ 1.83497368  2.0438989   1.73609419  1.87055172 -0.32250279 -0.31403744
   1.87055172  1.87055172  0.          0.          0.          1.87055172
   1.87055172]]
2024-09-20 10:56:40 - INFO - y 샘플:
[1.87055172]
2024-09-20 10:56:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 10:56:40 - INFO - 모델 출력 (스케일링된 예측): [0.3064711]
2024-09-20 10:56:40 - INFO - 스케일러 역변환 후 예측 가격: 83831334.8292644
2024-09-20 10:56:40 - INFO - TransformerPredictor 최종 예측 가격: 83831334.8292644
2024-09-20 10:56:40 - INFO - TRANSFORMER prediction: 83831334.8292644
2024-09-20 10:56:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 10:56:40 - INFO - BITCOIN_FORECAST prediction: 83228767.68281156
2024-09-20 10:56:40 - INFO - BitcoinForecast prediction: 83228767.68281156
2024-09-20 10:56:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 10:56:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 10:56:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0044925772872853416, 'ml': 5.14267518943807e-06, 'xgboost': 0.003444027061512365, 'rl': 0.19571544631843488, 'lstm': 0.11474903049114833, 'arima': 0.10104076660731161, 'prophet': 0.3172580745694431, 'transformer': 0.15074788743847875, 'bitcoin_forecast': 0.11254704755119627}
2024-09-20 10:56:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0044925772872853416, 'ml': 5.14267518943807e-06, 'xgboost': 0.003444027061512365, 'rl': 0.19571544631843488, 'lstm': 0.11474903049114833, 'arima': 0.10104076660731161, 'prophet': 0.3172580745694431, 'transformer': 0.15074788743847875, 'bitcoin_forecast': 0.11254704755119627}
2024-09-20 10:56:50 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84152229.8868831, 'current_price': 84176000.0, 'predictions': {'gpt': 84176000.0, 'ml': 83973977.60000001, 'xgboost': 84176000.0, 'lstm': 83857080.11441644, 'rl': 85017760.0, 'arima': 84140000.0, 'prophet': 84208416.68165328, 'transformer': 83831334.8292644, 'bitcoin_forecast': 83228767.68281156}, 'weights': {'gpt': 0.0044925772872853416, 'ml': 5.14267518943807e-06, 'xgboost': 0.003444027061512365, 'rl': 0.19571544631843488, 'lstm': 0.11474903049114833, 'arima': 0.10104076660731161, 'prophet': 0.3172580745694431, 'transformer': 0.15074788743847875, 'bitcoin_forecast': 0.11254704755119627}}
2024-09-20 10:56:50 - INFO - 모델별 가중치:
2024-09-20 10:56:50 - INFO -   - GPT: 0.0045
2024-09-20 10:56:50 - INFO -   - ML: 0.0000
2024-09-20 10:56:50 - INFO -   - XGBOOST: 0.0034
2024-09-20 10:56:50 - INFO -   - RL: 0.1957
2024-09-20 10:56:50 - INFO -   - LSTM: 0.1147
2024-09-20 10:56:50 - INFO -   - ARIMA: 0.1010
2024-09-20 10:56:50 - INFO -   - PROPHET: 0.3173
2024-09-20 10:56:50 - INFO -   - TRANSFORMER: 0.1507
2024-09-20 10:56:50 - INFO -   - BITCOIN_FORECAST: 0.1125
2024-09-20 10:56:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 10:56:50 - INFO - 6. 거래 실행
2024-09-20 10:56:50 - INFO - Cancelling existing orders.
2024-09-20 10:56:50 - INFO - Cancelled 0 orders.
2024-09-20 10:56:50 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84152229.8868831, 'current_price': 84176000.0, 'predictions': {'gpt': 84176000.0, 'ml': 83973977.60000001, 'xgboost': 84176000.0, 'lstm': 83857080.11441644, 'rl': 85017760.0, 'arima': 84140000.0, 'prophet': 84208416.68165328, 'transformer': 83831334.8292644, 'bitcoin_forecast': 83228767.68281156}, 'weights': {'gpt': 0.0044925772872853416, 'ml': 5.14267518943807e-06, 'xgboost': 0.003444027061512365, 'rl': 0.19571544631843488, 'lstm': 0.11474903049114833, 'arima': 0.10104076660731161, 'prophet': 0.3172580745694431, 'transformer': 0.15074788743847875, 'bitcoin_forecast': 0.11254704755119627}}, 현재 가격=84176000.0
2024-09-20 10:56:50 - INFO - 현재 잔고: KRW=8297.23050123, BTC=0.00556436, 총 자산가치=476682.79786123
2024-09-20 10:56:50 - INFO - 매도 시도: 0.000556436 BTC (약 46838.556736 KRW)
2024-09-20 10:56:50 - INFO - 주문 결과: {'uuid': '9fd023b1-aef6-4750-94da-28cdde61f212', 'side': 'ask', 'ord_type': 'limit', 'price': '84176000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T10:56:52+09:00', 'volume': '0.00055643', 'remaining_volume': '0.00055643', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00055643', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 10:56:50 - INFO - sell 주문 성공: UUID=9fd023b1-aef6-4750-94da-28cdde61f212
2024-09-20 10:56:50 - INFO - Trade executed successfully.
2024-09-20 10:56:50 - INFO - 7. summary 리포트 보내기
2024-09-20 10:56:51 - INFO - Message sent to Discord successfully.
2024-09-20 10:56:51 - INFO - Trading cycle completed.
2024-09-20 10:56:51 - INFO - Performing periodic update.
2024-09-20 10:56:51 - INFO - 계산된 시장 변동성: 0.02988528302079937
2024-09-20 11:05:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:05:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8155-9dd7-d325b9a8470a "HTTP/1.1 200 OK"
2024-09-20 11:05:54 - INFO - Updated actual price for gpt prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8189-b290-efb24b7ef68f "HTTP/1.1 200 OK"
2024-09-20 11:06:03 - INFO - Updated actual price for ml prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/038af9a6-0a68-4e65-9c66-42b338366053 "HTTP/1.1 200 OK"
2024-09-20 11:06:09 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b7-8d43-ece11b5bcc7e "HTTP/1.1 200 OK"
2024-09-20 11:06:15 - INFO - Updated actual price for lstm prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ac-bcb4-c7466dc4fe48 "HTTP/1.1 200 OK"
2024-09-20 11:06:21 - INFO - Updated actual price for rl prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ab-ac71-d3456f79d12f "HTTP/1.1 200 OK"
2024-09-20 11:06:28 - INFO - Updated actual price for arima prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81cd-97d0-ed3012ebee98 "HTTP/1.1 200 OK"
2024-09-20 11:06:37 - INFO - Updated actual price for prophet prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/ca8a4c1e-53d7-4a05-bd1d-e704034c9616 "HTTP/1.1 200 OK"
2024-09-20 11:06:43 - INFO - Updated actual price for transformer prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:06:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8191-ac83-db339e8f1c7e "HTTP/1.1 200 OK"
2024-09-20 11:06:50 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 10:55:34.971661
2024-09-20 11:06:50 - INFO - Starting trading cycle.
2024-09-20 11:06:50 - INFO - ##################################################
2024-09-20 11:06:50 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-20 11:06:50 - INFO - ##################################################
2024-09-20 11:06:50 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:06:50 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:06:50 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 10:50:00
2024-09-20 11:06:50 - INFO - 새로운 데이터 범위: 2024-09-19 01:50:00 ~ 2024-09-20 11:00:00
2024-09-20 11:06:50 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:06:50 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:06:50 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:06:50 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:06:50 - INFO - Sample date values: [Timestamp('2024-09-20 11:00:00')]
2024-09-20 11:06:50 - INFO - Successfully added 1 new data points
2024-09-20 11:06:50 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:06:50 - INFO - Final date range: 2024-09-20 11:00:00 to 2024-09-20 11:00:00
2024-09-20 11:06:50 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:06:50 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:00:00
2024-09-20 11:06:50 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:06:50 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:06:50 - INFO - GPT | 이전예측가격: 84176000 | 당시BTC가격: 84176000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:06:50 - INFO - ML 모델 예측 업데이트: 정확도 30.00%, 적중/전체: 3/10
2024-09-20 11:06:50 - INFO - ML | 이전예측가격: 83973978 | 당시BTC가격: 84176000 | 예측: 하락 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0581 | 반영가중치값: 0.0200 | 새 가중치: 0.0781 | 예측 총 횟수: 10 | 예측 성공 수: 3 | 예측 성공률: 30.00%
2024-09-20 11:06:50 - INFO - XGBOOST | 이전예측가격: 84176000 | 당시BTC가격: 84176000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:06:50 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-20 11:06:50 - INFO - LSTM | 이전예측가격: 83857080 | 당시BTC가격: 84176000 | 예측: 하락 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0868 | 반영가중치값: 0.0200 | 새 가중치: 0.1068 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-20 11:06:50 - INFO - RL 모델 예측 업데이트: 정확도 55.45%, 적중/전체: 61/110
2024-09-20 11:06:50 - INFO - RL | 이전예측가격: 85017760 | 당시BTC가격: 84176000 | 예측: 상승 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2351 | 반영가중치값: -0.0200 | 새 가중치: 0.2151 | 예측 총 횟수: 110 | 예측 성공 수: 61 | 예측 성공률: 55.45%
2024-09-20 11:06:50 - INFO - ARIMA 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 17/29
2024-09-20 11:06:50 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84176000 | 예측: 하락 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0501 | 반영가중치값: 0.0200 | 새 가중치: 0.0701 | 예측 총 횟수: 29 | 예측 성공 수: 17 | 예측 성공률: 58.62%
2024-09-20 11:06:50 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.41%, 적중/전체: 60/101
2024-09-20 11:06:50 - INFO - PROPHET | 이전예측가격: 84208417 | 당시BTC가격: 84176000 | 예측: 상승 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2859 | 반영가중치값: -0.0200 | 새 가중치: 0.2659 | 예측 총 횟수: 101 | 예측 성공 수: 60 | 예측 성공률: 59.41%
2024-09-20 11:06:50 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-20 11:06:50 - INFO - TRANSFORMER | 이전예측가격: 83831335 | 당시BTC가격: 84176000 | 예측: 하락 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0868 | 반영가중치값: 0.0200 | 새 가중치: 0.1068 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-20 11:06:50 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 30/50
2024-09-20 11:06:50 - INFO - BITCOIN_FORECAST | 이전예측가격: 83228768 | 당시BTC가격: 84176000 | 예측: 하락 | 지금 BTC가격: 84080000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1893 | 반영가중치값: 0.0200 | 새 가중치: 0.2093 | 예측 총 횟수: 50 | 예측 성공 수: 30 | 예측 성공률: 60.00%
2024-09-20 11:06:50 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:06:50 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:06:50 - INFO - 새로운 가중치: {'gpt': 0.004237641600500352, 'ml': 0.07368356117314513, 'xgboost': 0.003248592381575388, 'rl': 0.20291072126623433, 'lstm': 0.10074853899626512, 'arima': 0.06615458369302532, 'prophet': 0.2508170942118693, 'transformer': 0.10074853899626512, 'bitcoin_forecast': 0.19745072768111996}
2024-09-20 11:06:50 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 11:06:50 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:06:50 - INFO - Current BTC price: 84080000.0
2024-09-20 11:06:50 - INFO - Analyzing market conditions.
2024-09-20 11:06:50 - INFO - Market analysis: {'current_price': 84080000.0, 'sma_20': 83872400.0, 'rsi_14': 54.31748467347001, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:06:50 - INFO - Starting predictions for all models
2024-09-20 11:06:50 - INFO - Attempting prediction for gpt
2024-09-20 11:06:51 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:06:51 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:06:51 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:06:51 - INFO - GPT prediction: 84080000.0
2024-09-20 11:06:51 - INFO - Attempting prediction for ml
2024-09-20 11:06:51 - INFO - ML prediction: 83945472.0
2024-09-20 11:06:51 - INFO - Attempting prediction for xgboost
2024-09-20 11:06:51 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:06:51 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:06:51 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:06:51 - INFO - XGBOOST prediction: 84080000.0
2024-09-20 11:06:51 - INFO - Attempting prediction for lstm
2024-09-20 11:06:51 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:06:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:06:51 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:06:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:06:51 - INFO - X 샘플:
[[-1.40316717 -1.66906148 -1.51129034 -1.71961376  2.47460666  2.46834567
  -1.71961376]
 [-1.20022002 -0.81443548 -0.82822126 -0.55139789  0.27640796  0.27454282
  -0.55139789]
 [ 0.4233572   0.21573532  0.25929662  0.12404328  0.88890886  0.89736591
   0.12404328]
 [-0.16188575 -0.52340068 -0.60352748 -0.96770754 -0.7825739  -0.78808753
  -0.96770754]
 [-1.08222749 -0.71280428 -1.14279255 -0.72556825 -0.14009078 -0.14515357
  -0.72556825]
 [-0.28459798 -0.64351028 -0.28446232 -0.46218868 -1.14403034 -1.15008737
  -0.46218868]
 [-0.10996904  0.50215052  0.23233337  0.75275582 -0.40280602 -0.40086186
   0.75275582]
 [ 0.86700912  0.57144452  1.02774933  0.82072475 -0.11056132 -0.10591626
   0.82072475]
 [ 1.39561565  1.58775652  1.28839412  1.5683829  -0.12202154 -0.11369564
   1.5683829 ]
 [ 1.55608549  1.48612532  1.56252052  1.16056936 -0.93783956 -0.93645216
   1.16056936]]
2024-09-20 11:06:51 - INFO - y 샘플:
[1.16056936]
2024-09-20 11:06:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:06:51 - INFO - 모델 출력 (스케일링된 예측): [[0.4214398]]
2024-09-20 11:06:51 - INFO - 스케일러 역변환 후 예측 가격: 83906007.64426273
2024-09-20 11:06:51 - INFO - LSTMPredictor 최종 예측 가격: 83906007.64426273
2024-09-20 11:06:51 - INFO - LSTM prediction: 83906007.64426273
2024-09-20 11:06:51 - INFO - Attempting prediction for rl
2024-09-20 11:06:51 - INFO - Preparing state for RL agent.
2024-09-20 11:06:51 - INFO - Prepared state: [[ 8.40800000e+07  1.11158830e+01 -1.14046759e-03  8.38724000e+07
   5.43174847e+01]]
2024-09-20 11:06:51 - INFO - RL prediction: 84920800.0
2024-09-20 11:06:51 - INFO - Attempting prediction for arima
2024-09-20 11:06:51 - INFO - ARIMA 예측 시작
2024-09-20 11:06:51 - INFO - 입력 데이터: {'open': 84127000.0, 'high': 84198000.0, 'low': 84061000.0, 'close': 84080000.0, 'volume': 11.11588302, 'value': 935392450.4306, 'decision': 'sell', 'sma': 83872400.0, 'ema': 83901220.22817631, 'rsi': 54.31748467347001, 'macd': -25279.725259408355, 'signal_line': -89225.71997038912, 'BB_Upper': 84269481.55333838, 'BB_Lower': 83475318.44666162}
2024-09-20 11:06:51 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:06:51 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83872400.0         0         0
2024-09-20 11:06:51 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83872400.0         0         0
2024-09-20 11:06:51 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:06:51 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:06:51 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:06:51 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:06:51 - INFO - Attempting prediction for prophet
2024-09-20 11:06:51 - INFO - PROPHET prediction: 84091722.38469811
2024-09-20 11:06:51 - INFO - Attempting prediction for transformer
2024-09-20 11:06:51 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:06:51 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:06:51 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:06:51 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:06:51 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:06:51 - INFO - X 샘플:
[[-1.40316717 -1.66906148 -1.51129034 -1.71961376  2.47460666  2.46834567
  -1.71961376 -1.71961376  0.          0.          0.         -1.71961376
  -1.71961376]
 [-1.20022002 -0.81443548 -0.82822126 -0.55139789  0.27640796  0.27454282
  -0.55139789 -0.55139789  0.          0.          0.         -0.55139789
  -0.55139789]
 [ 0.4233572   0.21573532  0.25929662  0.12404328  0.88890886  0.89736591
   0.12404328  0.12404328  0.          0.          0.          0.12404328
   0.12404328]
 [-0.16188575 -0.52340068 -0.60352748 -0.96770754 -0.7825739  -0.78808753
  -0.96770754 -0.96770754  0.          0.          0.         -0.96770754
  -0.96770754]
 [-1.08222749 -0.71280428 -1.14279255 -0.72556825 -0.14009078 -0.14515357
  -0.72556825 -0.72556825  0.          0.          0.         -0.72556825
  -0.72556825]
 [-0.28459798 -0.64351028 -0.28446232 -0.46218868 -1.14403034 -1.15008737
  -0.46218868 -0.46218868  0.          0.          0.         -0.46218868
  -0.46218868]
 [-0.10996904  0.50215052  0.23233337  0.75275582 -0.40280602 -0.40086186
   0.75275582  0.75275582  0.          0.          0.          0.75275582
   0.75275582]
 [ 0.86700912  0.57144452  1.02774933  0.82072475 -0.11056132 -0.10591626
   0.82072475  0.82072475  0.          0.          0.          0.82072475
   0.82072475]
 [ 1.39561565  1.58775652  1.28839412  1.5683829  -0.12202154 -0.11369564
   1.5683829   1.5683829   0.          0.          0.          1.5683829
   1.5683829 ]
 [ 1.55608549  1.48612532  1.56252052  1.16056936 -0.93783956 -0.93645216
   1.16056936  1.16056936  0.          0.          0.          1.16056936
   1.16056936]]
2024-09-20 11:06:51 - INFO - y 샘플:
[1.16056936]
2024-09-20 11:06:51 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:06:51 - INFO - 모델 출력 (스케일링된 예측): [0.3053034]
2024-09-20 11:06:51 - INFO - 스케일러 역변환 후 예측 가격: 83878668.93791506
2024-09-20 11:06:51 - INFO - TransformerPredictor 최종 예측 가격: 83878668.93791506
2024-09-20 11:06:51 - INFO - TRANSFORMER prediction: 83878668.93791506
2024-09-20 11:06:51 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:06:51 - INFO - BITCOIN_FORECAST prediction: 83123215.81355697
2024-09-20 11:06:51 - INFO - BitcoinForecast prediction: 83123215.81355697
2024-09-20 11:06:53 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:06:58 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:06:58 - INFO - 조정된 모델 가중치: {'gpt': 0.004237641600500352, 'ml': 0.07368356117314513, 'xgboost': 0.003248592381575388, 'rl': 0.20291072126623433, 'lstm': 0.10074853899626512, 'arima': 0.06615458369302532, 'prophet': 0.2508170942118693, 'transformer': 0.10074853899626512, 'bitcoin_forecast': 0.19745072768111996}
2024-09-20 11:06:58 - INFO - 조정된 모델 가중치: {'gpt': 0.004237641600500352, 'ml': 0.07368356117314513, 'xgboost': 0.003248592381575388, 'rl': 0.20291072126623433, 'lstm': 0.10074853899626512, 'arima': 0.06615458369302532, 'prophet': 0.2508170942118693, 'transformer': 0.10074853899626512, 'bitcoin_forecast': 0.19745072768111996}
2024-09-20 11:06:58 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84020873.2619683, 'current_price': 84080000.0, 'predictions': {'gpt': 84080000.0, 'ml': 83945472.0, 'xgboost': 84080000.0, 'lstm': 83906007.64426273, 'rl': 84920800.0, 'arima': 84140000.0, 'prophet': 84091722.38469811, 'transformer': 83878668.93791506, 'bitcoin_forecast': 83123215.81355697}, 'weights': {'gpt': 0.004237641600500352, 'ml': 0.07368356117314513, 'xgboost': 0.003248592381575388, 'rl': 0.20291072126623433, 'lstm': 0.10074853899626512, 'arima': 0.06615458369302532, 'prophet': 0.2508170942118693, 'transformer': 0.10074853899626512, 'bitcoin_forecast': 0.19745072768111996}}
2024-09-20 11:06:58 - INFO - 모델별 가중치:
2024-09-20 11:06:58 - INFO -   - GPT: 0.0042
2024-09-20 11:06:58 - INFO -   - ML: 0.0737
2024-09-20 11:06:58 - INFO -   - XGBOOST: 0.0032
2024-09-20 11:06:58 - INFO -   - RL: 0.2029
2024-09-20 11:06:58 - INFO -   - LSTM: 0.1007
2024-09-20 11:06:58 - INFO -   - ARIMA: 0.0662
2024-09-20 11:06:58 - INFO -   - PROPHET: 0.2508
2024-09-20 11:06:58 - INFO -   - TRANSFORMER: 0.1007
2024-09-20 11:06:58 - INFO -   - BITCOIN_FORECAST: 0.1975
2024-09-20 11:06:58 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:06:58 - INFO - 6. 거래 실행
2024-09-20 11:06:58 - INFO - Cancelling existing orders.
2024-09-20 11:06:58 - INFO - Cancelled 0 orders.
2024-09-20 11:06:58 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84020873.2619683, 'current_price': 84080000.0, 'predictions': {'gpt': 84080000.0, 'ml': 83945472.0, 'xgboost': 84080000.0, 'lstm': 83906007.64426273, 'rl': 84920800.0, 'arima': 84140000.0, 'prophet': 84091722.38469811, 'transformer': 83878668.93791506, 'bitcoin_forecast': 83123215.81355697}, 'weights': {'gpt': 0.004237641600500352, 'ml': 0.07368356117314513, 'xgboost': 0.003248592381575388, 'rl': 0.20291072126623433, 'lstm': 0.10074853899626512, 'arima': 0.06615458369302532, 'prophet': 0.2508170942118693, 'transformer': 0.10074853899626512, 'bitcoin_forecast': 0.19745072768111996}}, 현재 가격=84080000.0
2024-09-20 11:06:58 - INFO - 현재 잔고: KRW=55111.86315539, BTC=0.00500793, 총 자산가치=476178.61755539
2024-09-20 11:06:58 - INFO - 매도 시도: 0.000500793 BTC (약 42106.67544 KRW)
2024-09-20 11:06:58 - INFO - 주문 결과: {'uuid': '278edce8-c6c1-466e-9952-6ac36c78e70c', 'side': 'ask', 'ord_type': 'limit', 'price': '84080000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:07:00+09:00', 'volume': '0.00050079', 'remaining_volume': '0.00050079', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00050079', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:06:58 - INFO - sell 주문 성공: UUID=278edce8-c6c1-466e-9952-6ac36c78e70c
2024-09-20 11:06:58 - INFO - Trade executed successfully.
2024-09-20 11:06:58 - INFO - 7. summary 리포트 보내기
2024-09-20 11:06:59 - INFO - Message sent to Discord successfully.
2024-09-20 11:06:59 - INFO - Trading cycle completed.
2024-09-20 11:06:59 - INFO - Performing periodic update.
2024-09-20 11:06:59 - INFO - 계산된 시장 변동성: 0.02994956415007456
2024-09-20 11:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:15:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8177-80cc-c76849390ac0 "HTTP/1.1 200 OK"
2024-09-20 11:15:39 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:15:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:15:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812c-9f1f-f97cf402a184 "HTTP/1.1 200 OK"
2024-09-20 11:15:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:15:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:15:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8108-85da-f809480b05ac "HTTP/1.1 200 OK"
2024-09-20 11:15:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8137-baf8-f4041a9f7f47 "HTTP/1.1 200 OK"
2024-09-20 11:16:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a9d1eeb3-947d-4dbf-98f8-05f5d5cf1d6c "HTTP/1.1 200 OK"
2024-09-20 11:16:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-819e-aed3-c39f6bc0c444 "HTTP/1.1 200 OK"
2024-09-20 11:16:13 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c6-812d-ff5bf69cb71d "HTTP/1.1 200 OK"
2024-09-20 11:16:19 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812c-ab46-f8761c7a3cef "HTTP/1.1 200 OK"
2024-09-20 11:16:25 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:16:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8102-a084-cdf68963b7be "HTTP/1.1 200 OK"
2024-09-20 11:16:31 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:05:34.971887
2024-09-20 11:16:31 - INFO - Starting trading cycle.
2024-09-20 11:16:31 - INFO - ##################################################
2024-09-20 11:16:31 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-20 11:16:31 - INFO - ##################################################
2024-09-20 11:16:31 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:16:31 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:16:31 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:00:00
2024-09-20 11:16:31 - INFO - 새로운 데이터 범위: 2024-09-19 02:00:00 ~ 2024-09-20 11:10:00
2024-09-20 11:16:31 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:16:31 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:16:31 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:16:31 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:16:31 - INFO - Sample date values: [Timestamp('2024-09-20 11:10:00')]
2024-09-20 11:16:31 - INFO - Successfully added 1 new data points
2024-09-20 11:16:31 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:16:31 - INFO - Final date range: 2024-09-20 11:10:00 to 2024-09-20 11:10:00
2024-09-20 11:16:31 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:16:31 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:10:00
2024-09-20 11:16:31 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:16:31 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:16:31 - INFO - GPT | 이전예측가격: 84080000 | 당시BTC가격: 84080000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:16:31 - INFO - ML 모델 예측 업데이트: 정확도 36.36%, 적중/전체: 4/11
2024-09-20 11:16:31 - INFO - ML | 이전예측가격: 83945472 | 당시BTC가격: 84080000 | 예측: 하락 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 11 | 예측 성공 수: 4 | 예측 성공률: 36.36%
2024-09-20 11:16:31 - INFO - XGBOOST | 이전예측가격: 84080000 | 당시BTC가격: 84080000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:16:31 - INFO - LSTM 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 7/11
2024-09-20 11:16:31 - INFO - LSTM | 이전예측가격: 83906008 | 당시BTC가격: 84080000 | 예측: 하락 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1147 | 반영가중치값: 0.0200 | 새 가중치: 0.1347 | 예측 총 횟수: 11 | 예측 성공 수: 7 | 예측 성공률: 63.64%
2024-09-20 11:16:31 - INFO - RL 모델 예측 업데이트: 정확도 54.95%, 적중/전체: 61/111
2024-09-20 11:16:31 - INFO - RL | 이전예측가격: 84920800 | 당시BTC가격: 84080000 | 예측: 상승 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1957 | 반영가중치값: -0.0200 | 새 가중치: 0.1757 | 예측 총 횟수: 111 | 예측 성공 수: 61 | 예측 성공률: 54.95%
2024-09-20 11:16:31 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.67%, 적중/전체: 17/30
2024-09-20 11:16:31 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84080000 | 예측: 상승 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1010 | 반영가중치값: -0.0200 | 새 가중치: 0.0810 | 예측 총 횟수: 30 | 예측 성공 수: 17 | 예측 성공률: 56.67%
2024-09-20 11:16:31 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 60/102
2024-09-20 11:16:31 - INFO - PROPHET | 이전예측가격: 84091722 | 당시BTC가격: 84080000 | 예측: 상승 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3173 | 반영가중치값: -0.0200 | 새 가중치: 0.2973 | 예측 총 횟수: 102 | 예측 성공 수: 60 | 예측 성공률: 58.82%
2024-09-20 11:16:31 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 63.64%, 적중/전체: 7/11
2024-09-20 11:16:31 - INFO - TRANSFORMER | 이전예측가격: 83878669 | 당시BTC가격: 84080000 | 예측: 하락 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1507 | 반영가중치값: 0.0200 | 새 가중치: 0.1707 | 예측 총 횟수: 11 | 예측 성공 수: 7 | 예측 성공률: 63.64%
2024-09-20 11:16:31 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.78%, 적중/전체: 31/51
2024-09-20 11:16:31 - INFO - BITCOIN_FORECAST | 이전예측가격: 83123216 | 당시BTC가격: 84080000 | 예측: 하락 | 지금 BTC가격: 84003000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1125 | 반영가중치값: 0.0200 | 새 가중치: 0.1325 | 예측 총 횟수: 51 | 예측 성공 수: 31 | 예측 성공률: 60.78%
2024-09-20 11:16:31 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:16:31 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:16:31 - INFO - 새로운 가중치: {'gpt': 0.004156385797545324, 'ml': 0.01962154866593899, 'xgboost': 0.0031863013698939548, 'rl': 0.17234614305302431, 'lstm': 0.13216524882620598, 'arima': 0.07948682854846524, 'prophet': 0.29155821936433235, 'transformer': 0.16747383597196253, 'bitcoin_forecast': 0.1300054884026314}
2024-09-20 11:16:31 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 11:16:31 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:16:31 - INFO - Current BTC price: 84003000.0
2024-09-20 11:16:31 - INFO - Analyzing market conditions.
2024-09-20 11:16:31 - INFO - Market analysis: {'current_price': 84003000.0, 'sma_20': 83875950.0, 'rsi_14': 51.98640661998231, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:16:31 - INFO - Starting predictions for all models
2024-09-20 11:16:31 - INFO - Attempting prediction for gpt
2024-09-20 11:16:32 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:16:32 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:16:32 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:16:32 - INFO - GPT prediction: 84003000.0
2024-09-20 11:16:32 - INFO - Attempting prediction for ml
2024-09-20 11:16:32 - INFO - ML prediction: 83885395.8
2024-09-20 11:16:32 - INFO - Attempting prediction for xgboost
2024-09-20 11:16:32 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:16:32 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:16:32 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:16:32 - INFO - XGBOOST prediction: 84003000.0
2024-09-20 11:16:32 - INFO - Attempting prediction for lstm
2024-09-20 11:16:32 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:16:32 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:16:32 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:16:32 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:16:32 - INFO - X 샘플:
[[-1.56867219 -1.24595735 -1.20036304 -0.95834453  1.02790016  1.01902584
  -0.95834453]
 [ 0.20815769 -0.03211511  0.00849196 -0.15593916  2.02455564  2.02741865
  -0.15593916]
 [-0.4323275  -0.90303331 -0.95059961 -1.45290884 -0.6952648  -0.7014447
  -1.45290884]
 [-1.43954211 -1.1262061  -1.55003185 -1.16525409  0.35017747  0.33950894
  -1.16525409]
 [-0.56662278 -1.04455752 -0.59593554 -0.85236646 -1.28342319 -1.28754699
  -0.85236646]
 [-0.37551027  0.30536569 -0.02147965  0.59095389 -0.07731021 -0.07450011
   0.59095389]
 [ 0.69368678  0.38701428  0.86268289  0.67169909  0.39822752  0.40303682
   0.67169909]
 [ 1.27218953  1.58452681  1.15240847  1.55989622  0.37957956  0.39044147
   1.55989622]
 [ 1.44780644  1.46477555  1.45711985  1.07542506 -0.94791156 -0.94165709
   1.07542506]
 [ 0.76083442  0.61018707  0.83770654  0.68683881 -1.17653059 -1.17428282
   0.68683881]]
2024-09-20 11:16:32 - INFO - y 샘플:
[0.68683881]
2024-09-20 11:16:32 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:16:32 - INFO - 모델 출력 (스케일링된 예측): [[0.37240747]]
2024-09-20 11:16:32 - INFO - 스케일러 역변환 후 예측 가격: 83940694.10637365
2024-09-20 11:16:32 - INFO - LSTMPredictor 최종 예측 가격: 83940694.10637365
2024-09-20 11:16:32 - INFO - LSTM prediction: 83940694.10637365
2024-09-20 11:16:32 - INFO - Attempting prediction for rl
2024-09-20 11:16:32 - INFO - Preparing state for RL agent.
2024-09-20 11:16:32 - INFO - Prepared state: [[ 8.40030000e+07  9.82736926e+00 -9.15794481e-04  8.38759500e+07
   5.19864066e+01]]
2024-09-20 11:16:32 - INFO - RL prediction: 84843030.0
2024-09-20 11:16:32 - INFO - Attempting prediction for arima
2024-09-20 11:16:32 - INFO - ARIMA 예측 시작
2024-09-20 11:16:32 - INFO - 입력 데이터: {'open': 83994000.0, 'high': 84041000.0, 'low': 83937000.0, 'close': 84003000.0, 'volume': 9.82736926, 'value': 825510755.34592, 'decision': 'sell', 'sma': 83875950.0, 'ema': 83910913.53977858, 'rsi': 51.98640661998231, 'macd': -15311.551145344973, 'signal_line': -74442.8862053803, 'BB_Upper': 84276355.03243794, 'BB_Lower': 83475544.96756206}
2024-09-20 11:16:32 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:16:32 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83875950.0         0         0
2024-09-20 11:16:32 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83875950.0         0         0
2024-09-20 11:16:32 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:16:32 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:16:32 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:16:32 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:16:32 - INFO - Attempting prediction for prophet
2024-09-20 11:16:32 - INFO - PROPHET prediction: 84001196.63490199
2024-09-20 11:16:32 - INFO - Attempting prediction for transformer
2024-09-20 11:16:32 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:16:32 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:16:32 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:16:32 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:16:32 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:16:32 - INFO - X 샘플:
[[-1.56867219 -1.24595735 -1.20036304 -0.95834453  1.02790016  1.01902584
  -0.95834453 -0.95834453  0.          0.          0.         -0.95834453
  -0.95834453]
 [ 0.20815769 -0.03211511  0.00849196 -0.15593916  2.02455564  2.02741865
  -0.15593916 -0.15593916  0.          0.          0.         -0.15593916
  -0.15593916]
 [-0.4323275  -0.90303331 -0.95059961 -1.45290884 -0.6952648  -0.7014447
  -1.45290884 -1.45290884  0.          0.          0.         -1.45290884
  -1.45290884]
 [-1.43954211 -1.1262061  -1.55003185 -1.16525409  0.35017747  0.33950894
  -1.16525409 -1.16525409  0.          0.          0.         -1.16525409
  -1.16525409]
 [-0.56662278 -1.04455752 -0.59593554 -0.85236646 -1.28342319 -1.28754699
  -0.85236646 -0.85236646  0.          0.          0.         -0.85236646
  -0.85236646]
 [-0.37551027  0.30536569 -0.02147965  0.59095389 -0.07731021 -0.07450011
   0.59095389  0.59095389  0.          0.          0.          0.59095389
   0.59095389]
 [ 0.69368678  0.38701428  0.86268289  0.67169909  0.39822752  0.40303682
   0.67169909  0.67169909  0.          0.          0.          0.67169909
   0.67169909]
 [ 1.27218953  1.58452681  1.15240847  1.55989622  0.37957956  0.39044147
   1.55989622  1.55989622  0.          0.          0.          1.55989622
   1.55989622]
 [ 1.44780644  1.46477555  1.45711985  1.07542506 -0.94791156 -0.94165709
   1.07542506  1.07542506  0.          0.          0.          1.07542506
   1.07542506]
 [ 0.76083442  0.61018707  0.83770654  0.68683881 -1.17653059 -1.17428282
   0.68683881  0.68683881  0.          0.          0.          0.68683881
   0.68683881]]
2024-09-20 11:16:32 - INFO - y 샘플:
[0.68683881]
2024-09-20 11:16:32 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:16:32 - INFO - 모델 출력 (스케일링된 예측): [0.30590993]
2024-09-20 11:16:32 - INFO - 스케일러 역변환 후 예측 가격: 83927517.34011304
2024-09-20 11:16:32 - INFO - TransformerPredictor 최종 예측 가격: 83927517.34011304
2024-09-20 11:16:32 - INFO - TRANSFORMER prediction: 83927517.34011304
2024-09-20 11:16:32 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:16:32 - INFO - BITCOIN_FORECAST prediction: 83083395.62968661
2024-09-20 11:16:32 - INFO - BitcoinForecast prediction: 83083395.62968661
2024-09-20 11:16:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:16:36 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:16:36 - INFO - 조정된 모델 가중치: {'gpt': 0.004156385797545324, 'ml': 0.01962154866593899, 'xgboost': 0.0031863013698939548, 'rl': 0.17234614305302431, 'lstm': 0.13216524882620598, 'arima': 0.07948682854846524, 'prophet': 0.29155821936433235, 'transformer': 0.16747383597196253, 'bitcoin_forecast': 0.1300054884026314}
2024-09-20 11:16:36 - INFO - 조정된 모델 가중치: {'gpt': 0.004156385797545324, 'ml': 0.01962154866593899, 'xgboost': 0.0031863013698939548, 'rl': 0.17234614305302431, 'lstm': 0.13216524882620598, 'arima': 0.07948682854846524, 'prophet': 0.29155821936433235, 'transformer': 0.16747383597196253, 'bitcoin_forecast': 0.1300054884026314}
2024-09-20 11:16:36 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84015402.60377462, 'current_price': 84003000.0, 'predictions': {'gpt': 84003000.0, 'ml': 83885395.8, 'xgboost': 84003000.0, 'lstm': 83940694.10637365, 'rl': 84843030.0, 'arima': 84140000.0, 'prophet': 84001196.63490199, 'transformer': 83927517.34011304, 'bitcoin_forecast': 83083395.62968661}, 'weights': {'gpt': 0.004156385797545324, 'ml': 0.01962154866593899, 'xgboost': 0.0031863013698939548, 'rl': 0.17234614305302431, 'lstm': 0.13216524882620598, 'arima': 0.07948682854846524, 'prophet': 0.29155821936433235, 'transformer': 0.16747383597196253, 'bitcoin_forecast': 0.1300054884026314}}
2024-09-20 11:16:36 - INFO - 모델별 가중치:
2024-09-20 11:16:36 - INFO -   - GPT: 0.0042
2024-09-20 11:16:36 - INFO -   - ML: 0.0196
2024-09-20 11:16:36 - INFO -   - XGBOOST: 0.0032
2024-09-20 11:16:36 - INFO -   - RL: 0.1723
2024-09-20 11:16:36 - INFO -   - LSTM: 0.1322
2024-09-20 11:16:36 - INFO -   - ARIMA: 0.0795
2024-09-20 11:16:36 - INFO -   - PROPHET: 0.2916
2024-09-20 11:16:36 - INFO -   - TRANSFORMER: 0.1675
2024-09-20 11:16:36 - INFO -   - BITCOIN_FORECAST: 0.1300
2024-09-20 11:16:36 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:16:36 - INFO - 6. 거래 실행
2024-09-20 11:16:36 - INFO - Cancelling existing orders.
2024-09-20 11:16:37 - INFO - Cancelled 0 orders.
2024-09-20 11:16:37 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84015402.60377462, 'current_price': 84003000.0, 'predictions': {'gpt': 84003000.0, 'ml': 83885395.8, 'xgboost': 84003000.0, 'lstm': 83940694.10637365, 'rl': 84843030.0, 'arima': 84140000.0, 'prophet': 84001196.63490199, 'transformer': 83927517.34011304, 'bitcoin_forecast': 83083395.62968661}, 'weights': {'gpt': 0.004156385797545324, 'ml': 0.01962154866593899, 'xgboost': 0.0031863013698939548, 'rl': 0.17234614305302431, 'lstm': 0.13216524882620598, 'arima': 0.07948682854846524, 'prophet': 0.29155821936433235, 'transformer': 0.16747383597196253, 'bitcoin_forecast': 0.1300054884026314}}, 현재 가격=84003000.0
2024-09-20 11:16:37 - INFO - 현재 잔고: KRW=97197.23314379, BTC=0.00450714, 총 자산가치=475810.51456378994
2024-09-20 11:16:37 - INFO - 매수 시도: 0.0005664208594500077 BTC (약 47581.051456379 KRW)
2024-09-20 11:16:37 - INFO - 주문 결과: {'uuid': '258fc566-6f7f-461d-b304-391181d9f15b', 'side': 'bid', 'ord_type': 'limit', 'price': '84003000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:16:38+09:00', 'volume': '0.00056642', 'remaining_volume': '0.00056642', 'reserved_fee': '23.79048963', 'remaining_fee': '23.79048963', 'paid_fee': '0', 'locked': '47604.76974963', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:16:37 - INFO - buy 주문 성공: UUID=258fc566-6f7f-461d-b304-391181d9f15b
2024-09-20 11:16:37 - INFO - Trade executed successfully.
2024-09-20 11:16:37 - INFO - 7. summary 리포트 보내기
2024-09-20 11:16:37 - INFO - Message sent to Discord successfully.
2024-09-20 11:16:37 - INFO - Trading cycle completed.
2024-09-20 11:16:37 - INFO - Performing periodic update.
2024-09-20 11:16:37 - INFO - 계산된 시장 변동성: 0.02965835046241439
2024-09-20 11:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:25:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8148-b301-d3e29645ae7d "HTTP/1.1 200 OK"
2024-09-20 11:25:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:25:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:25:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8171-b9ae-f8788e05222a "HTTP/1.1 200 OK"
2024-09-20 11:25:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:25:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:25:52 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8102-a2f6-ebbd2d83cc5a "HTTP/1.1 200 OK"
2024-09-20 11:25:52 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d3-8c7a-e5fa816f585d "HTTP/1.1 200 OK"
2024-09-20 11:26:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8171-a002-ca5f2bf940bd "HTTP/1.1 200 OK"
2024-09-20 11:26:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816c-8771-f33b9a553111 "HTTP/1.1 200 OK"
2024-09-20 11:26:13 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813d-adb1-cdc44bb60fd9 "HTTP/1.1 200 OK"
2024-09-20 11:26:18 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815e-af33-dd209c855b14 "HTTP/1.1 200 OK"
2024-09-20 11:26:24 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:26:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ac-bd86-ca9b16b2c99a "HTTP/1.1 200 OK"
2024-09-20 11:26:30 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:15:34.972432
2024-09-20 11:26:30 - INFO - Starting trading cycle.
2024-09-20 11:26:30 - INFO - ##################################################
2024-09-20 11:26:30 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-20 11:26:30 - INFO - ##################################################
2024-09-20 11:26:30 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:26:30 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:26:30 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:10:00
2024-09-20 11:26:30 - INFO - 새로운 데이터 범위: 2024-09-19 02:10:00 ~ 2024-09-20 11:20:00
2024-09-20 11:26:30 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:26:30 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:26:30 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:26:30 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:26:30 - INFO - Sample date values: [Timestamp('2024-09-20 11:20:00')]
2024-09-20 11:26:31 - INFO - Successfully added 1 new data points
2024-09-20 11:26:31 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:26:31 - INFO - Final date range: 2024-09-20 11:20:00 to 2024-09-20 11:20:00
2024-09-20 11:26:31 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:26:31 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:20:00
2024-09-20 11:26:31 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:26:31 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:26:31 - INFO - GPT | 이전예측가격: 84003000 | 당시BTC가격: 84003000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:26:31 - INFO - ML 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 11:26:31 - INFO - ML | 이전예측가격: 83885396 | 당시BTC가격: 84003000 | 예측: 하락 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0737 | 반영가중치값: 0.0200 | 새 가중치: 0.0937 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 11:26:31 - INFO - XGBOOST | 이전예측가격: 84003000 | 당시BTC가격: 84003000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:26:31 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-20 11:26:31 - INFO - LSTM | 이전예측가격: 83940694 | 당시BTC가격: 84003000 | 예측: 하락 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1007 | 반영가중치값: 0.0200 | 새 가중치: 0.1207 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-20 11:26:31 - INFO - RL 모델 예측 업데이트: 정확도 54.46%, 적중/전체: 61/112
2024-09-20 11:26:31 - INFO - RL | 이전예측가격: 84843030 | 당시BTC가격: 84003000 | 예측: 상승 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2029 | 반영가중치값: -0.0200 | 새 가중치: 0.1829 | 예측 총 횟수: 112 | 예측 성공 수: 61 | 예측 성공률: 54.46%
2024-09-20 11:26:31 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.84%, 적중/전체: 17/31
2024-09-20 11:26:31 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84003000 | 예측: 상승 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0662 | 반영가중치값: -0.0200 | 새 가중치: 0.0462 | 예측 총 횟수: 31 | 예측 성공 수: 17 | 예측 성공률: 54.84%
2024-09-20 11:26:31 - INFO - PROPHET | 이전예측가격: 84001197 | 당시BTC가격: 84003000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:26:31 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 8/12
2024-09-20 11:26:31 - INFO - TRANSFORMER | 이전예측가격: 83927517 | 당시BTC가격: 84003000 | 예측: 하락 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1007 | 반영가중치값: 0.0200 | 새 가중치: 0.1207 | 예측 총 횟수: 12 | 예측 성공 수: 8 | 예측 성공률: 66.67%
2024-09-20 11:26:31 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 32/52
2024-09-20 11:26:31 - INFO - BITCOIN_FORECAST | 이전예측가격: 83083396 | 당시BTC가격: 84003000 | 예측: 하락 | 지금 BTC가격: 83876000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1975 | 반영가중치값: 0.0200 | 새 가중치: 0.2175 | 예측 총 횟수: 52 | 예측 성공 수: 32 | 예측 성공률: 61.54%
2024-09-20 11:26:31 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:26:31 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:26:31 - INFO - 새로운 가중치: {'gpt': 0.0038463771165753217, 'ml': 0.08669606803788052, 'xgboost': 0.0029486475203795276, 'rl': 0.16926812065189645, 'lstm': 0.11174237423518969, 'arima': 0.04271209247388859, 'prophet': 0.26981202365158613, 'transformer': 0.11174237423518969, 'bitcoin_forecast': 0.20123192207741417}
2024-09-20 11:26:31 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 74/123
2024-09-20 11:26:31 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:26:31 - INFO - Current BTC price: 83876000.0
2024-09-20 11:26:31 - INFO - Analyzing market conditions.
2024-09-20 11:26:31 - INFO - Market analysis: {'current_price': 83903000.0, 'sma_20': 83874600.0, 'rsi_14': 49.04275773609821, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:26:31 - INFO - Starting predictions for all models
2024-09-20 11:26:31 - INFO - Attempting prediction for gpt
2024-09-20 11:26:31 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:26:31 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:26:31 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:26:31 - INFO - GPT prediction: 83876000.0
2024-09-20 11:26:31 - INFO - Attempting prediction for ml
2024-09-20 11:26:31 - INFO - ML prediction: 83802316.4
2024-09-20 11:26:31 - INFO - Attempting prediction for xgboost
2024-09-20 11:26:31 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:26:31 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:26:31 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:26:31 - INFO - XGBOOST prediction: 83903000.0
2024-09-20 11:26:31 - INFO - Attempting prediction for lstm
2024-09-20 11:26:31 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:26:31 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:26:31 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:26:31 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:26:31 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:26:31 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:26:31 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:26:31 - INFO - X 샘플:
[[-0.03197538 -0.21409711 -0.12198323 -0.28483873  2.2941207   2.29353367
  -0.28483873]
 [-0.76622473 -1.16829037 -1.16755373 -1.65312943 -0.59406613 -0.60093169
  -1.65312943]
 [-1.92089106 -1.41280239 -1.8210353  -1.34965639  0.51609267  0.50319259
  -1.34965639]
 [-0.92018024 -1.32334677 -0.78091047 -1.01956292 -1.21863357 -1.22260179
  -1.01956292]
 [-0.70108971  0.15565277 -0.1546573   0.50312635  0.06214201  0.06405925
   0.50312635]
 [ 0.52463301  0.24510839  0.80922801  0.58831176  0.56711719  0.57057567
   0.58831176]
 [ 1.18782597  1.55712412  1.12507743  1.52535131  0.54731485  0.55721596
   1.52535131]
 [ 1.38915241  1.42592254  1.45726389  1.01423883 -0.86235261 -0.85572145
   1.01423883]
 [ 0.60161076  0.48962041  0.78199961  0.60428403 -1.10512395 -1.10246415
   0.60428403]
 [ 0.63713896  0.24510839 -0.12742891  0.07187519 -0.20661116 -0.20685804
   0.07187519]]
2024-09-20 11:26:31 - INFO - y 샘플:
[0.07187519]
2024-09-20 11:26:31 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:26:31 - INFO - 모델 출력 (스케일링된 예측): [[0.32577044]]
2024-09-20 11:26:31 - INFO - 스케일러 역변환 후 예측 가격: 83950688.02270992
2024-09-20 11:26:31 - INFO - LSTMPredictor 최종 예측 가격: 83950688.02270992
2024-09-20 11:26:31 - INFO - LSTM prediction: 83950688.02270992
2024-09-20 11:26:31 - INFO - Attempting prediction for rl
2024-09-20 11:26:31 - INFO - Preparing state for RL agent.
2024-09-20 11:26:31 - INFO - Prepared state: [[ 8.39030000e+07  1.45962439e+01 -1.19043367e-03  8.38746000e+07
   4.90427577e+01]]
2024-09-20 11:26:31 - INFO - RL prediction: 84714760.0
2024-09-20 11:26:31 - INFO - Attempting prediction for arima
2024-09-20 11:26:31 - INFO - ARIMA 예측 시작
2024-09-20 11:26:31 - INFO - 입력 데이터: {'open': 84000000.0, 'high': 84000000.0, 'low': 83770000.0, 'close': 83903000.0, 'volume': 14.59624385, 'value': 1224350181.74703, 'decision': 'sell', 'sma': 83874600.0, 'ema': 83910159.86932348, 'rsi': 49.04275773609821, 'macd': -15304.445487365127, 'signal_line': -62615.19806177727, 'BB_Upper': 84274448.67137659, 'BB_Lower': 83474751.32862341}
2024-09-20 11:26:31 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:26:31 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83874600.0         0         0
2024-09-20 11:26:31 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83874600.0         0         0
2024-09-20 11:26:31 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:26:31 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:26:31 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:26:31 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:26:31 - INFO - Attempting prediction for prophet
2024-09-20 11:26:32 - INFO - PROPHET prediction: 83887810.15965511
2024-09-20 11:26:32 - INFO - Attempting prediction for transformer
2024-09-20 11:26:32 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:26:32 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:26:32 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:26:32 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:26:32 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:26:32 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:26:32 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:26:32 - INFO - X 샘플:
[[-0.03197538 -0.21409711 -0.12198323 -0.28483873  2.2941207   2.29353367
  -0.28483873 -0.28483873  0.          0.          0.         -0.28483873
  -0.28483873]
 [-0.76622473 -1.16829037 -1.16755373 -1.65312943 -0.59406613 -0.60093169
  -1.65312943 -1.65312943  0.          0.          0.         -1.65312943
  -1.65312943]
 [-1.92089106 -1.41280239 -1.8210353  -1.34965639  0.51609267  0.50319259
  -1.34965639 -1.34965639  0.          0.          0.         -1.34965639
  -1.34965639]
 [-0.92018024 -1.32334677 -0.78091047 -1.01956292 -1.21863357 -1.22260179
  -1.01956292 -1.01956292  0.          0.          0.         -1.01956292
  -1.01956292]
 [-0.70108971  0.15565277 -0.1546573   0.50312635  0.06214201  0.06405925
   0.50312635  0.50312635  0.          0.          0.          0.50312635
   0.50312635]
 [ 0.52463301  0.24510839  0.80922801  0.58831176  0.56711719  0.57057567
   0.58831176  0.58831176  0.          0.          0.          0.58831176
   0.58831176]
 [ 1.18782597  1.55712412  1.12507743  1.52535131  0.54731485  0.55721596
   1.52535131  1.52535131  0.          0.          0.          1.52535131
   1.52535131]
 [ 1.38915241  1.42592254  1.45726389  1.01423883 -0.86235261 -0.85572145
   1.01423883  1.01423883  0.          0.          0.          1.01423883
   1.01423883]
 [ 0.60161076  0.48962041  0.78199961  0.60428403 -1.10512395 -1.10246415
   0.60428403  0.60428403  0.          0.          0.          0.60428403
   0.60428403]
 [ 0.63713896  0.24510839 -0.12742891  0.07187519 -0.20661116 -0.20685804
   0.07187519  0.07187519  0.          0.          0.          0.07187519
   0.07187519]]
2024-09-20 11:26:32 - INFO - y 샘플:
[0.07187519]
2024-09-20 11:26:32 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:26:32 - INFO - 모델 출력 (스케일링된 예측): [0.30698872]
2024-09-20 11:26:32 - INFO - 스케일러 역변환 후 예측 가격: 83947160.33488365
2024-09-20 11:26:32 - INFO - TransformerPredictor 최종 예측 가격: 83947160.33488365
2024-09-20 11:26:32 - INFO - TRANSFORMER prediction: 83947160.33488365
2024-09-20 11:26:32 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:26:32 - INFO - BITCOIN_FORECAST prediction: 83143497.51724704
2024-09-20 11:26:32 - INFO - BitcoinForecast prediction: 83143497.51724704
2024-09-20 11:26:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:26:40 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:26:40 - INFO - 조정된 모델 가중치: {'gpt': 0.0038463771165753217, 'ml': 0.08669606803788052, 'xgboost': 0.0029486475203795276, 'rl': 0.16926812065189645, 'lstm': 0.11174237423518969, 'arima': 0.04271209247388859, 'prophet': 0.26981202365158613, 'transformer': 0.11174237423518969, 'bitcoin_forecast': 0.20123192207741417}
2024-09-20 11:26:40 - INFO - 조정된 모델 가중치: {'gpt': 0.0038463771165753217, 'ml': 0.08669606803788052, 'xgboost': 0.0029486475203795276, 'rl': 0.16926812065189645, 'lstm': 0.11174237423518969, 'arima': 0.04271209247388859, 'prophet': 0.26981202365158613, 'transformer': 0.11174237423518969, 'bitcoin_forecast': 0.20123192207741417}
2024-09-20 11:26:40 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 83895023.93867642, 'current_price': 83876000.0, 'predictions': {'gpt': 83876000.0, 'ml': 83802316.4, 'xgboost': 83903000.0, 'lstm': 83950688.02270992, 'rl': 84714760.0, 'arima': 84140000.0, 'prophet': 83887810.15965511, 'transformer': 83947160.33488365, 'bitcoin_forecast': 83143497.51724704}, 'weights': {'gpt': 0.0038463771165753217, 'ml': 0.08669606803788052, 'xgboost': 0.0029486475203795276, 'rl': 0.16926812065189645, 'lstm': 0.11174237423518969, 'arima': 0.04271209247388859, 'prophet': 0.26981202365158613, 'transformer': 0.11174237423518969, 'bitcoin_forecast': 0.20123192207741417}}
2024-09-20 11:26:40 - INFO - 모델별 가중치:
2024-09-20 11:26:40 - INFO -   - GPT: 0.0038
2024-09-20 11:26:40 - INFO -   - ML: 0.0867
2024-09-20 11:26:40 - INFO -   - XGBOOST: 0.0029
2024-09-20 11:26:40 - INFO -   - RL: 0.1693
2024-09-20 11:26:40 - INFO -   - LSTM: 0.1117
2024-09-20 11:26:40 - INFO -   - ARIMA: 0.0427
2024-09-20 11:26:40 - INFO -   - PROPHET: 0.2698
2024-09-20 11:26:40 - INFO -   - TRANSFORMER: 0.1117
2024-09-20 11:26:40 - INFO -   - BITCOIN_FORECAST: 0.2012
2024-09-20 11:26:40 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:26:40 - INFO - 6. 거래 실행
2024-09-20 11:26:40 - INFO - Cancelling existing orders.
2024-09-20 11:26:40 - INFO - Cancelled 0 orders.
2024-09-20 11:26:40 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 83895023.93867642, 'current_price': 83876000.0, 'predictions': {'gpt': 83876000.0, 'ml': 83802316.4, 'xgboost': 83903000.0, 'lstm': 83950688.02270992, 'rl': 84714760.0, 'arima': 84140000.0, 'prophet': 83887810.15965511, 'transformer': 83947160.33488365, 'bitcoin_forecast': 83143497.51724704}, 'weights': {'gpt': 0.0038463771165753217, 'ml': 0.08669606803788052, 'xgboost': 0.0029486475203795276, 'rl': 0.16926812065189645, 'lstm': 0.11174237423518969, 'arima': 0.04271209247388859, 'prophet': 0.26981202365158613, 'transformer': 0.11174237423518969, 'bitcoin_forecast': 0.20123192207741417}}, 현재 가격=83876000.0
2024-09-20 11:26:40 - INFO - 현재 잔고: KRW=49592.46339416, BTC=0.00507356, 총 자산가치=475142.38195416
2024-09-20 11:26:40 - INFO - 매수 시도: 0.0005664819280296629 BTC (약 47514.238195416 KRW)
2024-09-20 11:26:40 - INFO - 주문 결과: {'uuid': 'dce5d284-e782-4f55-abaa-3e29be930127', 'side': 'bid', 'ord_type': 'limit', 'price': '83876000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:26:41+09:00', 'volume': '0.00056648', 'remaining_volume': '0.00056648', 'reserved_fee': '23.75703824', 'remaining_fee': '23.75703824', 'paid_fee': '0', 'locked': '47537.83351824', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:26:40 - INFO - buy 주문 성공: UUID=dce5d284-e782-4f55-abaa-3e29be930127
2024-09-20 11:26:40 - INFO - Trade executed successfully.
2024-09-20 11:26:40 - INFO - 7. summary 리포트 보내기
2024-09-20 11:26:41 - INFO - Message sent to Discord successfully.
2024-09-20 11:26:41 - INFO - Trading cycle completed.
2024-09-20 11:26:41 - INFO - Performing periodic update.
2024-09-20 11:26:41 - INFO - 계산된 시장 변동성: 0.029723549667483296
2024-09-20 11:35:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:35:43 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8151-b037-d0cad4611270 "HTTP/1.1 200 OK"
2024-09-20 11:35:43 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:35:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:35:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8139-a279-cf083b5eef0e "HTTP/1.1 200 OK"
2024-09-20 11:35:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:35:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:35:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814f-9ef0-ca92ab0010b9 "HTTP/1.1 200 OK"
2024-09-20 11:35:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8165-94a9-d95603cee721 "HTTP/1.1 200 OK"
2024-09-20 11:36:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8137-ad70-e1c57ea2c4ea "HTTP/1.1 200 OK"
2024-09-20 11:36:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/85e792fb-e17b-4346-818f-3888f794e42b "HTTP/1.1 200 OK"
2024-09-20 11:36:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816a-91b3-df4e77aadc0f "HTTP/1.1 200 OK"
2024-09-20 11:36:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814d-baa4-e22cc391d2dd "HTTP/1.1 200 OK"
2024-09-20 11:36:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:36:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8133-85f7-f44e13303f36 "HTTP/1.1 200 OK"
2024-09-20 11:36:36 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:25:34.972750
2024-09-20 11:36:36 - INFO - Starting trading cycle.
2024-09-20 11:36:36 - INFO - ##################################################
2024-09-20 11:36:36 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-20 11:36:36 - INFO - ##################################################
2024-09-20 11:36:36 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:36:36 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:36:36 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:20:00
2024-09-20 11:36:36 - INFO - 새로운 데이터 범위: 2024-09-19 02:20:00 ~ 2024-09-20 11:30:00
2024-09-20 11:36:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:36:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:36:36 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:36:36 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:36:36 - INFO - Sample date values: [Timestamp('2024-09-20 11:30:00')]
2024-09-20 11:36:36 - INFO - Successfully added 1 new data points
2024-09-20 11:36:36 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:36:36 - INFO - Final date range: 2024-09-20 11:30:00 to 2024-09-20 11:30:00
2024-09-20 11:36:36 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:36:36 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:30:00
2024-09-20 11:36:36 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:36:36 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:36:36 - INFO - GPT | 이전예측가격: 83876000 | 당시BTC가격: 83876000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:36:36 - INFO - ML 모델 예측 업데이트: 정확도 38.46%, 적중/전체: 5/13
2024-09-20 11:36:36 - INFO - ML | 이전예측가격: 83802316 | 당시BTC가격: 83876000 | 예측: 하락 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0196 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 13 | 예측 성공 수: 5 | 예측 성공률: 38.46%
2024-09-20 11:36:36 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.48%, 적중/전체: 75/124
2024-09-20 11:36:36 - INFO - XGBOOST | 이전예측가격: 83903000 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0032 | 반영가중치값: 0.0200 | 새 가중치: 0.0232 | 예측 총 횟수: 124 | 예측 성공 수: 75 | 예측 성공률: 60.48%
2024-09-20 11:36:36 - INFO - LSTM 모델 예측 업데이트: 정확도 69.23%, 적중/전체: 9/13
2024-09-20 11:36:36 - INFO - LSTM | 이전예측가격: 83950688 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1322 | 반영가중치값: 0.0200 | 새 가중치: 0.1522 | 예측 총 횟수: 13 | 예측 성공 수: 9 | 예측 성공률: 69.23%
2024-09-20 11:36:36 - INFO - RL 모델 예측 업데이트: 정확도 54.87%, 적중/전체: 62/113
2024-09-20 11:36:36 - INFO - RL | 이전예측가격: 84714760 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1723 | 반영가중치값: 0.0200 | 새 가중치: 0.1923 | 예측 총 횟수: 113 | 예측 성공 수: 62 | 예측 성공률: 54.87%
2024-09-20 11:36:36 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 18/32
2024-09-20 11:36:36 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0795 | 반영가중치값: 0.0200 | 새 가중치: 0.0995 | 예측 총 횟수: 32 | 예측 성공 수: 18 | 예측 성공률: 56.25%
2024-09-20 11:36:36 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.22%, 적중/전체: 61/103
2024-09-20 11:36:36 - INFO - PROPHET | 이전예측가격: 83887810 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2916 | 반영가중치값: 0.0200 | 새 가중치: 0.3116 | 예측 총 횟수: 103 | 예측 성공 수: 61 | 예측 성공률: 59.22%
2024-09-20 11:36:36 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 69.23%, 적중/전체: 9/13
2024-09-20 11:36:36 - INFO - TRANSFORMER | 이전예측가격: 83947160 | 당시BTC가격: 83876000 | 예측: 상승 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1675 | 반영가중치값: 0.0200 | 새 가중치: 0.1875 | 예측 총 횟수: 13 | 예측 성공 수: 9 | 예측 성공률: 69.23%
2024-09-20 11:36:36 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.38%, 적중/전체: 32/53
2024-09-20 11:36:36 - INFO - BITCOIN_FORECAST | 이전예측가격: 83143498 | 당시BTC가격: 83876000 | 예측: 하락 | 지금 BTC가격: 84074000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1300 | 반영가중치값: -0.0200 | 새 가중치: 0.1100 | 예측 총 횟수: 53 | 예측 성공 수: 32 | 예측 성공률: 60.38%
2024-09-20 11:36:36 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:36:36 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:36:36 - INFO - 새로운 가중치: {'gpt': 0.00356123460762083, 'ml': 0.0, 'xgboost': 0.02146743711253973, 'rl': 0.17808699472835562, 'lstm': 0.14088482064379707, 'arima': 0.09211159646890968, 'prophet': 0.2884615521207319, 'transformer': 0.17357588516469372, 'bitcoin_forecast': 0.10185047915335144}
2024-09-20 11:36:36 - INFO - XGBoost 모델 성능: 정확도 60.48%, 적중/전체: 75/124
2024-09-20 11:36:36 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:36:36 - INFO - Current BTC price: 84074000.0
2024-09-20 11:36:36 - INFO - Analyzing market conditions.
2024-09-20 11:36:36 - INFO - Market analysis: {'current_price': 84074000.0, 'sma_20': 83881450.0, 'rsi_14': 53.85454013467061, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:36:36 - INFO - Starting predictions for all models
2024-09-20 11:36:36 - INFO - Attempting prediction for gpt
2024-09-20 11:36:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:36:37 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:36:37 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:36:37 - INFO - GPT prediction: 84074000.0
2024-09-20 11:36:37 - INFO - Attempting prediction for ml
2024-09-20 11:36:37 - INFO - ML prediction: 84040370.4
2024-09-20 11:36:37 - INFO - Attempting prediction for xgboost
2024-09-20 11:36:37 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:36:37 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:36:37 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:36:37 - INFO - XGBOOST prediction: 84074000.0
2024-09-20 11:36:37 - INFO - Attempting prediction for lstm
2024-09-20 11:36:37 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:36:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:36:37 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:36:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:36:37 - INFO - X 샘플:
[[-0.81421067 -1.24015048 -1.22770233 -1.71877606 -0.26871229 -0.27827148
  -1.71877606]
 [-1.95317107 -1.47819435 -1.86190069 -1.42571523  1.19068976  1.17365553
  -1.42571523]
 [-0.96607205 -1.39110513 -0.8524683  -1.10694731 -1.0897615  -1.09576969
  -1.10694731]
 [-0.74996162  0.04876996 -0.24469487  0.36349826  0.59393142  0.59619376
   0.36349826]
 [ 0.45908865  0.13585918  0.69074771  0.44576095  1.25776601  1.2622645
   0.44576095]
 [ 1.11326078  1.41316773  0.99727692  1.35065053  1.23173408  1.24469645
   1.35065053]
 [ 1.31184875  1.28543688  1.31966109  0.85707439 -0.62139862 -0.61332085
   0.85707439]
 [ 0.53501935  0.37390305  0.66432278  0.4611852  -0.94054305 -0.9377883
   0.4611852 ]
 [ 0.57006428  0.13585918 -0.21826994 -0.05295661  0.24063157  0.23993664
  -0.05295661]
 [ 0.49413359  0.71645398  0.73302761  0.82622588 -1.59433739 -1.59159656
   0.82622588]]
2024-09-20 11:36:37 - INFO - y 샘플:
[0.82622588]
2024-09-20 11:36:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:36:37 - INFO - 모델 출력 (스케일링된 예측): [[0.29574984]]
2024-09-20 11:36:37 - INFO - 스케일러 역변환 후 예측 가격: 83970823.00996174
2024-09-20 11:36:37 - INFO - LSTMPredictor 최종 예측 가격: 83970823.00996174
2024-09-20 11:36:37 - INFO - LSTM prediction: 83970823.00996174
2024-09-20 11:36:37 - INFO - Attempting prediction for rl
2024-09-20 11:36:37 - INFO - Preparing state for RL agent.
2024-09-20 11:36:37 - INFO - Prepared state: [[8.40740000e+07 7.18773992e+00 2.03806777e-03 8.38814500e+07
  5.38545401e+01]]
2024-09-20 11:36:37 - INFO - RL prediction: 84914740.0
2024-09-20 11:36:37 - INFO - Attempting prediction for arima
2024-09-20 11:36:37 - INFO - ARIMA 예측 시작
2024-09-20 11:36:37 - INFO - 입력 데이터: {'open': 83987000.0, 'high': 84100000.0, 'low': 83950000.0, 'close': 84074000.0, 'volume': 7.18773992, 'value': 604096993.68474, 'decision': 'sell', 'sma': 83881450.0, 'ema': 83925763.69129266, 'rsi': 53.85454013467061, 'macd': -1483.4431002140045, 'signal_line': -50388.84706946462, 'BB_Upper': 84289940.6241294, 'BB_Lower': 83472959.3758706}
2024-09-20 11:36:37 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:36:37 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83881450.0         0         0
2024-09-20 11:36:37 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83881450.0         0         0
2024-09-20 11:36:37 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:36:37 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:36:37 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:36:37 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:36:37 - INFO - Attempting prediction for prophet
2024-09-20 11:36:37 - INFO - PROPHET prediction: 84080873.35077523
2024-09-20 11:36:37 - INFO - Attempting prediction for transformer
2024-09-20 11:36:37 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:36:37 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:36:37 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:36:37 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:36:37 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:36:37 - INFO - X 샘플:
[[-0.81421067 -1.24015048 -1.22770233 -1.71877606 -0.26871229 -0.27827148
  -1.71877606 -1.71877606  0.          0.          0.         -1.71877606
  -1.71877606]
 [-1.95317107 -1.47819435 -1.86190069 -1.42571523  1.19068976  1.17365553
  -1.42571523 -1.42571523  0.          0.          0.         -1.42571523
  -1.42571523]
 [-0.96607205 -1.39110513 -0.8524683  -1.10694731 -1.0897615  -1.09576969
  -1.10694731 -1.10694731  0.          0.          0.         -1.10694731
  -1.10694731]
 [-0.74996162  0.04876996 -0.24469487  0.36349826  0.59393142  0.59619376
   0.36349826  0.36349826  0.          0.          0.          0.36349826
   0.36349826]
 [ 0.45908865  0.13585918  0.69074771  0.44576095  1.25776601  1.2622645
   0.44576095  0.44576095  0.          0.          0.          0.44576095
   0.44576095]
 [ 1.11326078  1.41316773  0.99727692  1.35065053  1.23173408  1.24469645
   1.35065053  1.35065053  0.          0.          0.          1.35065053
   1.35065053]
 [ 1.31184875  1.28543688  1.31966109  0.85707439 -0.62139862 -0.61332085
   0.85707439  0.85707439  0.          0.          0.          0.85707439
   0.85707439]
 [ 0.53501935  0.37390305  0.66432278  0.4611852  -0.94054305 -0.9377883
   0.4611852   0.4611852   0.          0.          0.          0.4611852
   0.4611852 ]
 [ 0.57006428  0.13585918 -0.21826994 -0.05295661  0.24063157  0.23993664
  -0.05295661 -0.05295661  0.          0.          0.         -0.05295661
  -0.05295661]
 [ 0.49413359  0.71645398  0.73302761  0.82622588 -1.59433739 -1.59159656
   0.82622588  0.82622588  0.          0.          0.          0.82622588
   0.82622588]]
2024-09-20 11:36:37 - INFO - y 샘플:
[0.82622588]
2024-09-20 11:36:37 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:36:37 - INFO - 모델 출력 (스케일링된 예측): [0.30775863]
2024-09-20 11:36:37 - INFO - 스케일러 역변환 후 예측 가격: 83973158.70529468
2024-09-20 11:36:37 - INFO - TransformerPredictor 최종 예측 가격: 83973158.70529468
2024-09-20 11:36:37 - INFO - TRANSFORMER prediction: 83973158.70529468
2024-09-20 11:36:37 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:36:37 - INFO - BITCOIN_FORECAST prediction: 83033629.7202082
2024-09-20 11:36:37 - INFO - BitcoinForecast prediction: 83033629.7202082
2024-09-20 11:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:36:42 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:36:42 - INFO - 조정된 모델 가중치: {'gpt': 0.00356123460762083, 'ml': 0.0, 'xgboost': 0.02146743711253973, 'rl': 0.17808699472835562, 'lstm': 0.14088482064379707, 'arima': 0.09211159646890968, 'prophet': 0.2884615521207319, 'transformer': 0.17357588516469372, 'bitcoin_forecast': 0.10185047915335144}
2024-09-20 11:36:42 - INFO - 조정된 모델 가중치: {'gpt': 0.00356123460762083, 'ml': 0.0, 'xgboost': 0.02146743711253973, 'rl': 0.17808699472835562, 'lstm': 0.14088482064379707, 'arima': 0.09211159646890968, 'prophet': 0.2884615521207319, 'transformer': 0.17357588516469372, 'bitcoin_forecast': 0.10185047915335144}
2024-09-20 11:36:42 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84093785.02252832, 'current_price': 84074000.0, 'predictions': {'gpt': 84074000.0, 'ml': 84040370.4, 'xgboost': 84074000.0, 'lstm': 83970823.00996174, 'rl': 84914740.0, 'arima': 84140000.0, 'prophet': 84080873.35077523, 'transformer': 83973158.70529468, 'bitcoin_forecast': 83033629.7202082}, 'weights': {'gpt': 0.00356123460762083, 'ml': 0.0, 'xgboost': 0.02146743711253973, 'rl': 0.17808699472835562, 'lstm': 0.14088482064379707, 'arima': 0.09211159646890968, 'prophet': 0.2884615521207319, 'transformer': 0.17357588516469372, 'bitcoin_forecast': 0.10185047915335144}}
2024-09-20 11:36:42 - INFO - 모델별 가중치:
2024-09-20 11:36:42 - INFO -   - GPT: 0.0036
2024-09-20 11:36:42 - INFO -   - ML: 0.0000
2024-09-20 11:36:42 - INFO -   - XGBOOST: 0.0215
2024-09-20 11:36:42 - INFO -   - RL: 0.1781
2024-09-20 11:36:42 - INFO -   - LSTM: 0.1409
2024-09-20 11:36:42 - INFO -   - ARIMA: 0.0921
2024-09-20 11:36:42 - INFO -   - PROPHET: 0.2885
2024-09-20 11:36:42 - INFO -   - TRANSFORMER: 0.1736
2024-09-20 11:36:42 - INFO -   - BITCOIN_FORECAST: 0.1019
2024-09-20 11:36:42 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:36:43 - INFO - 6. 거래 실행
2024-09-20 11:36:43 - INFO - Cancelling existing orders.
2024-09-20 11:36:43 - INFO - Cancelled 1 orders.
2024-09-20 11:36:43 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84093785.02252832, 'current_price': 84074000.0, 'predictions': {'gpt': 84074000.0, 'ml': 84040370.4, 'xgboost': 84074000.0, 'lstm': 83970823.00996174, 'rl': 84914740.0, 'arima': 84140000.0, 'prophet': 84080873.35077523, 'transformer': 83973158.70529468, 'bitcoin_forecast': 83033629.7202082}, 'weights': {'gpt': 0.00356123460762083, 'ml': 0.0, 'xgboost': 0.02146743711253973, 'rl': 0.17808699472835562, 'lstm': 0.14088482064379707, 'arima': 0.09211159646890968, 'prophet': 0.2884615521207319, 'transformer': 0.17357588516469372, 'bitcoin_forecast': 0.10185047915335144}}, 현재 가격=84074000.0
2024-09-20 11:36:43 - INFO - 현재 잔고: KRW=49592.46339416, BTC=0.00507356, 총 자산가치=476146.94683416
2024-09-20 11:36:43 - INFO - 매수 시도: 0.00056634268243947 BTC (약 47614.694683416004 KRW)
2024-09-20 11:36:43 - INFO - 주문 결과: {'uuid': '2605e727-5495-4b01-825c-d580699775f7', 'side': 'bid', 'ord_type': 'limit', 'price': '84074000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:36:44+09:00', 'volume': '0.00056634', 'remaining_volume': '0.00056634', 'reserved_fee': '23.80723458', 'remaining_fee': '23.80723458', 'paid_fee': '0', 'locked': '47638.27639458', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:36:43 - INFO - buy 주문 성공: UUID=2605e727-5495-4b01-825c-d580699775f7
2024-09-20 11:36:43 - INFO - Trade executed successfully.
2024-09-20 11:36:43 - INFO - 7. summary 리포트 보내기
2024-09-20 11:36:43 - INFO - Message sent to Discord successfully.
2024-09-20 11:36:43 - INFO - Trading cycle completed.
2024-09-20 11:36:43 - INFO - Performing periodic update.
2024-09-20 11:36:43 - INFO - 계산된 시장 변동성: 0.029875748703343124
2024-09-20 11:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:45:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817c-bdd3-f942bd38bf3f "HTTP/1.1 200 OK"
2024-09-20 11:45:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:45:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c2-8dd9-f9cbea526c6a "HTTP/1.1 200 OK"
2024-09-20 11:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:45:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:45:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a8-82c0-d839cf68cfd2 "HTTP/1.1 200 OK"
2024-09-20 11:45:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814b-ad22-f869b392048e "HTTP/1.1 200 OK"
2024-09-20 11:46:06 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81bc-9c4e-fff21298d323 "HTTP/1.1 200 OK"
2024-09-20 11:46:12 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:17 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b8-9a8c-c3f8d68670b6 "HTTP/1.1 200 OK"
2024-09-20 11:46:17 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8139-b7a9-edb79fd0f777 "HTTP/1.1 200 OK"
2024-09-20 11:46:23 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8119-a15d-f28289a5cd09 "HTTP/1.1 200 OK"
2024-09-20 11:46:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e2-b623-f042f21c514a "HTTP/1.1 200 OK"
2024-09-20 11:46:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:35:34.973222
2024-09-20 11:46:39 - INFO - Starting trading cycle.
2024-09-20 11:46:39 - INFO - ##################################################
2024-09-20 11:46:39 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-20 11:46:39 - INFO - ##################################################
2024-09-20 11:46:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:46:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:46:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:30:00
2024-09-20 11:46:39 - INFO - 새로운 데이터 범위: 2024-09-19 02:30:00 ~ 2024-09-20 11:40:00
2024-09-20 11:46:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:46:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:46:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:46:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:46:39 - INFO - Sample date values: [Timestamp('2024-09-20 11:40:00')]
2024-09-20 11:46:39 - INFO - Successfully added 1 new data points
2024-09-20 11:46:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:46:39 - INFO - Final date range: 2024-09-20 11:40:00 to 2024-09-20 11:40:00
2024-09-20 11:46:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:46:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:40:00
2024-09-20 11:46:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:46:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:46:39 - INFO - GPT | 이전예측가격: 84074000 | 당시BTC가격: 84074000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:46:39 - INFO - ML 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 6/14
2024-09-20 11:46:39 - INFO - ML | 이전예측가격: 84040370 | 당시BTC가격: 84074000 | 예측: 하락 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0867 | 반영가중치값: 0.0200 | 새 가중치: 0.1067 | 예측 총 횟수: 14 | 예측 성공 수: 6 | 예측 성공률: 42.86%
2024-09-20 11:46:39 - INFO - XGBOOST | 이전예측가격: 84074000 | 당시BTC가격: 84074000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:46:39 - INFO - LSTM 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 10/14
2024-09-20 11:46:40 - INFO - LSTM | 이전예측가격: 83970823 | 당시BTC가격: 84074000 | 예측: 하락 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1117 | 반영가중치값: 0.0200 | 새 가중치: 0.1317 | 예측 총 횟수: 14 | 예측 성공 수: 10 | 예측 성공률: 71.43%
2024-09-20 11:46:40 - INFO - RL 모델 예측 업데이트: 정확도 54.39%, 적중/전체: 62/114
2024-09-20 11:46:40 - INFO - RL | 이전예측가격: 84914740 | 당시BTC가격: 84074000 | 예측: 상승 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1693 | 반영가중치값: -0.0200 | 새 가중치: 0.1493 | 예측 총 횟수: 114 | 예측 성공 수: 62 | 예측 성공률: 54.39%
2024-09-20 11:46:40 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 18/33
2024-09-20 11:46:40 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84074000 | 예측: 상승 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0427 | 반영가중치값: -0.0200 | 새 가중치: 0.0227 | 예측 총 횟수: 33 | 예측 성공 수: 18 | 예측 성공률: 54.55%
2024-09-20 11:46:40 - INFO - PROPHET | 이전예측가격: 84080873 | 당시BTC가격: 84074000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:46:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 71.43%, 적중/전체: 10/14
2024-09-20 11:46:40 - INFO - TRANSFORMER | 이전예측가격: 83973159 | 당시BTC가격: 84074000 | 예측: 하락 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1117 | 반영가중치값: 0.0200 | 새 가중치: 0.1317 | 예측 총 횟수: 14 | 예측 성공 수: 10 | 예측 성공률: 71.43%
2024-09-20 11:46:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 61.11%, 적중/전체: 33/54
2024-09-20 11:46:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83033630 | 당시BTC가격: 84074000 | 예측: 하락 | 지금 BTC가격: 83951000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2012 | 반영가중치값: 0.0200 | 새 가중치: 0.2212 | 예측 총 횟수: 54 | 예측 성공 수: 33 | 예측 성공률: 61.11%
2024-09-20 11:46:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:46:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:46:40 - INFO - 새로운 가중치: {'gpt': 0.0033069832350145247, 'ml': 0.0990785913088059, 'xgboost': 0.019934787356603208, 'rl': 0.1386112477570599, 'lstm': 0.12233673737879396, 'arima': 0.021090581587217362, 'prophet': 0.26786708035695245, 'transformer': 0.12233673737879396, 'bitcoin_forecast': 0.20543725364075874}
2024-09-20 11:46:40 - INFO - XGBoost 모델 성능: 정확도 60.48%, 적중/전체: 75/124
2024-09-20 11:46:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:46:40 - INFO - Current BTC price: 83951000.0
2024-09-20 11:46:40 - INFO - Analyzing market conditions.
2024-09-20 11:46:40 - INFO - Market analysis: {'current_price': 83954000.0, 'sma_20': 83874150.0, 'rsi_14': 50.267338622363226, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:46:40 - INFO - Starting predictions for all models
2024-09-20 11:46:40 - INFO - Attempting prediction for gpt
2024-09-20 11:46:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:46:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:46:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:46:40 - INFO - GPT prediction: 83951000.0
2024-09-20 11:46:40 - INFO - Attempting prediction for ml
2024-09-20 11:46:40 - INFO - ML prediction: 83987581.6
2024-09-20 11:46:40 - INFO - Attempting prediction for xgboost
2024-09-20 11:46:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:46:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:46:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:46:40 - INFO - XGBOOST prediction: 83954000.0
2024-09-20 11:46:40 - INFO - Attempting prediction for lstm
2024-09-20 11:46:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:46:40 - INFO - X 샘플:
[[-2.13766814 -1.80355342 -2.21330613 -1.97470384  1.18715973  1.17140638
  -1.97470384]
 [-1.1465408  -1.7087958  -1.12768345 -1.58578504 -0.8412548  -0.84799379
  -1.58578504]
 [-0.92954842 -0.14213643 -0.47403629  0.20825974  0.65635545  0.65756421
   0.20825974]
 [ 0.28443595 -0.04737881  0.53201195  0.30862589  1.24682268  1.25025321
   0.30862589]
 [ 0.94127774  1.34239966  0.86167748  1.41265345  1.22366782  1.23462065
   1.41265345]
 [ 1.14067614  1.20342181  1.20839467  0.81045659 -0.42465564 -0.41869686
   0.81045659]
 [ 0.36067652  0.21162536  0.50359251  0.32744454 -0.70852805 -0.70741738
   0.32744454]
 [ 0.39586447 -0.04737881 -0.44561685 -0.29984385  0.3421025   0.34055632
  -0.29984385]
 [ 0.31962391  0.58433867  0.57748306  0.77281929 -1.29006467 -1.28919487
   0.77281929]
 [ 0.77120264  0.40745778  0.57748306  0.02007323 -1.39160502 -1.39109786
   0.02007323]]
2024-09-20 11:46:40 - INFO - y 샘플:
[0.02007323]
2024-09-20 11:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:46:40 - INFO - 모델 출력 (스케일링된 예측): [[0.2275151]]
2024-09-20 11:46:40 - INFO - 스케일러 역변환 후 예측 가격: 83987069.61801532
2024-09-20 11:46:40 - INFO - LSTMPredictor 최종 예측 가격: 83987069.61801532
2024-09-20 11:46:40 - INFO - LSTM prediction: 83987069.61801532
2024-09-20 11:46:40 - INFO - Attempting prediction for rl
2024-09-20 11:46:40 - INFO - Preparing state for RL agent.
2024-09-20 11:46:40 - INFO - Prepared state: [[ 8.39540000e+07  6.72684224e+00 -1.42731403e-03  8.38741500e+07
   5.02673386e+01]]
2024-09-20 11:46:40 - INFO - RL prediction: 84790510.0
2024-09-20 11:46:40 - INFO - Attempting prediction for arima
2024-09-20 11:46:40 - INFO - ARIMA 예측 시작
2024-09-20 11:46:40 - INFO - 입력 데이터: {'open': 84064000.0, 'high': 84072000.0, 'low': 83950000.0, 'close': 83954000.0, 'volume': 6.72684224, 'value': 565314598.3025, 'decision': 'sell', 'sma': 83874150.0, 'ema': 83928452.8635505, 'rsi': 50.267338622363226, 'macd': -210.76666469871998, 'signal_line': -40353.23098851144, 'BB_Upper': 84271832.4235533, 'BB_Lower': 83476467.5764467}
2024-09-20 11:46:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:46:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83874150.0         0         0
2024-09-20 11:46:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83874150.0         0         0
2024-09-20 11:46:40 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:46:40 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:46:40 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:46:40 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:46:40 - INFO - Attempting prediction for prophet
2024-09-20 11:46:40 - INFO - PROPHET prediction: 83941079.78641395
2024-09-20 11:46:40 - INFO - Attempting prediction for transformer
2024-09-20 11:46:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:46:40 - INFO - X 샘플:
[[-2.13766814 -1.80355342 -2.21330613 -1.97470384  1.18715973  1.17140638
  -1.97470384 -1.97470384  0.          0.          0.         -1.97470384
  -1.97470384]
 [-1.1465408  -1.7087958  -1.12768345 -1.58578504 -0.8412548  -0.84799379
  -1.58578504 -1.58578504  0.          0.          0.         -1.58578504
  -1.58578504]
 [-0.92954842 -0.14213643 -0.47403629  0.20825974  0.65635545  0.65756421
   0.20825974  0.20825974  0.          0.          0.          0.20825974
   0.20825974]
 [ 0.28443595 -0.04737881  0.53201195  0.30862589  1.24682268  1.25025321
   0.30862589  0.30862589  0.          0.          0.          0.30862589
   0.30862589]
 [ 0.94127774  1.34239966  0.86167748  1.41265345  1.22366782  1.23462065
   1.41265345  1.41265345  0.          0.          0.          1.41265345
   1.41265345]
 [ 1.14067614  1.20342181  1.20839467  0.81045659 -0.42465564 -0.41869686
   0.81045659  0.81045659  0.          0.          0.          0.81045659
   0.81045659]
 [ 0.36067652  0.21162536  0.50359251  0.32744454 -0.70852805 -0.70741738
   0.32744454  0.32744454  0.          0.          0.          0.32744454
   0.32744454]
 [ 0.39586447 -0.04737881 -0.44561685 -0.29984385  0.3421025   0.34055632
  -0.29984385 -0.29984385  0.          0.          0.         -0.29984385
  -0.29984385]
 [ 0.31962391  0.58433867  0.57748306  0.77281929 -1.29006467 -1.28919487
   0.77281929  0.77281929  0.          0.          0.          0.77281929
   0.77281929]
 [ 0.77120264  0.40745778  0.57748306  0.02007323 -1.39160502 -1.39109786
   0.02007323  0.02007323  0.          0.          0.          0.02007323
   0.02007323]]
2024-09-20 11:46:40 - INFO - y 샘플:
[0.02007323]
2024-09-20 11:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:46:40 - INFO - 모델 출력 (스케일링된 예측): [0.3055783]
2024-09-20 11:46:40 - INFO - 스케일러 역변환 후 예측 가격: 83999514.16373526
2024-09-20 11:46:40 - INFO - TransformerPredictor 최종 예측 가격: 83999514.16373526
2024-09-20 11:46:40 - INFO - TRANSFORMER prediction: 83999514.16373526
2024-09-20 11:46:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:46:40 - INFO - BITCOIN_FORECAST prediction: 82998806.45168261
2024-09-20 11:46:40 - INFO - BitcoinForecast prediction: 82998806.45168261
2024-09-20 11:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:46:45 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:46:45 - INFO - 조정된 모델 가중치: {'gpt': 0.0033069832350145247, 'ml': 0.0990785913088059, 'xgboost': 0.019934787356603208, 'rl': 0.1386112477570599, 'lstm': 0.12233673737879396, 'arima': 0.021090581587217362, 'prophet': 0.26786708035695245, 'transformer': 0.12233673737879396, 'bitcoin_forecast': 0.20543725364075874}
2024-09-20 11:46:45 - INFO - 조정된 모델 가중치: {'gpt': 0.0033069832350145247, 'ml': 0.0990785913088059, 'xgboost': 0.019934787356603208, 'rl': 0.1386112477570599, 'lstm': 0.12233673737879396, 'arima': 0.021090581587217362, 'prophet': 0.26786708035695245, 'transformer': 0.12233673737879396, 'bitcoin_forecast': 0.20543725364075874}
2024-09-20 11:46:45 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 83887110.28402634, 'current_price': 83951000.0, 'predictions': {'gpt': 83951000.0, 'ml': 83987581.6, 'xgboost': 83954000.0, 'lstm': 83987069.61801532, 'rl': 84790510.0, 'arima': 84140000.0, 'prophet': 83941079.78641395, 'transformer': 83999514.16373526, 'bitcoin_forecast': 82998806.45168261}, 'weights': {'gpt': 0.0033069832350145247, 'ml': 0.0990785913088059, 'xgboost': 0.019934787356603208, 'rl': 0.1386112477570599, 'lstm': 0.12233673737879396, 'arima': 0.021090581587217362, 'prophet': 0.26786708035695245, 'transformer': 0.12233673737879396, 'bitcoin_forecast': 0.20543725364075874}}
2024-09-20 11:46:45 - INFO - 모델별 가중치:
2024-09-20 11:46:45 - INFO -   - GPT: 0.0033
2024-09-20 11:46:45 - INFO -   - ML: 0.0991
2024-09-20 11:46:45 - INFO -   - XGBOOST: 0.0199
2024-09-20 11:46:45 - INFO -   - RL: 0.1386
2024-09-20 11:46:45 - INFO -   - LSTM: 0.1223
2024-09-20 11:46:45 - INFO -   - ARIMA: 0.0211
2024-09-20 11:46:45 - INFO -   - PROPHET: 0.2679
2024-09-20 11:46:45 - INFO -   - TRANSFORMER: 0.1223
2024-09-20 11:46:45 - INFO -   - BITCOIN_FORECAST: 0.2054
2024-09-20 11:46:45 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:46:45 - INFO - 6. 거래 실행
2024-09-20 11:46:45 - INFO - Cancelling existing orders.
2024-09-20 11:46:46 - INFO - Cancelled 0 orders.
2024-09-20 11:46:46 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 83887110.28402634, 'current_price': 83951000.0, 'predictions': {'gpt': 83951000.0, 'ml': 83987581.6, 'xgboost': 83954000.0, 'lstm': 83987069.61801532, 'rl': 84790510.0, 'arima': 84140000.0, 'prophet': 83941079.78641395, 'transformer': 83999514.16373526, 'bitcoin_forecast': 82998806.45168261}, 'weights': {'gpt': 0.0033069832350145247, 'ml': 0.0990785913088059, 'xgboost': 0.019934787356603208, 'rl': 0.1386112477570599, 'lstm': 0.12233673737879396, 'arima': 0.021090581587217362, 'prophet': 0.26786708035695245, 'transformer': 0.12233673737879396, 'bitcoin_forecast': 0.20543725364075874}}, 현재 가격=83951000.0
2024-09-20 11:46:46 - INFO - 현재 잔고: KRW=1954.18699958, BTC=0.0056399, 총 자산가치=475429.43189958
2024-09-20 11:46:46 - INFO - 매도 시도: 0.00056399 BTC (약 47347.52449 KRW)
2024-09-20 11:46:46 - INFO - 주문 결과: {'uuid': '42b52445-82d6-4a4d-a860-6866a51d35db', 'side': 'ask', 'ord_type': 'limit', 'price': '83951000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:46:47+09:00', 'volume': '0.00056399', 'remaining_volume': '0.00056399', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00056399', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:46:46 - INFO - sell 주문 성공: UUID=42b52445-82d6-4a4d-a860-6866a51d35db
2024-09-20 11:46:46 - INFO - Trade executed successfully.
2024-09-20 11:46:46 - INFO - 7. summary 리포트 보내기
2024-09-20 11:46:46 - INFO - Message sent to Discord successfully.
2024-09-20 11:46:46 - INFO - Trading cycle completed.
2024-09-20 11:46:46 - INFO - Performing periodic update.
2024-09-20 11:46:46 - INFO - 계산된 시장 변동성: 0.02995851662661092
2024-09-20 11:55:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:55:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8101-b906-d15075d48d05 "HTTP/1.1 200 OK"
2024-09-20 11:55:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:55:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:55:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b9-87d3-db68cca17e92 "HTTP/1.1 200 OK"
2024-09-20 11:55:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:55:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:55:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8128-a9b0-ea4d7cb66ba9 "HTTP/1.1 200 OK"
2024-09-20 11:55:56 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b3-9abb-d0489b9abb5b "HTTP/1.1 200 OK"
2024-09-20 11:56:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8140-b175-d551038ebfc4 "HTTP/1.1 200 OK"
2024-09-20 11:56:11 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8109-8119-f6412c2964ec "HTTP/1.1 200 OK"
2024-09-20 11:56:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8128-a60b-c3214ef98254 "HTTP/1.1 200 OK"
2024-09-20 11:56:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b5-a323-fbfdfc03b293 "HTTP/1.1 200 OK"
2024-09-20 11:56:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 11:56:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-811a-a4c8-c568ed4ff06b "HTTP/1.1 200 OK"
2024-09-20 11:56:37 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:45:34.973735
2024-09-20 11:56:37 - INFO - Starting trading cycle.
2024-09-20 11:56:37 - INFO - ##################################################
2024-09-20 11:56:37 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-20 11:56:37 - INFO - ##################################################
2024-09-20 11:56:37 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 11:56:37 - INFO - 데이터베이스 업데이트 시작
2024-09-20 11:56:37 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:40:00
2024-09-20 11:56:37 - INFO - 새로운 데이터 범위: 2024-09-19 02:40:00 ~ 2024-09-20 11:50:00
2024-09-20 11:56:37 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 11:56:37 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 11:56:37 - INFO - Index: Index([199], dtype='int64')
2024-09-20 11:56:37 - INFO - Date column data type: datetime64[ns]
2024-09-20 11:56:37 - INFO - Sample date values: [Timestamp('2024-09-20 11:50:00')]
2024-09-20 11:56:37 - INFO - Successfully added 1 new data points
2024-09-20 11:56:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 11:56:37 - INFO - Final date range: 2024-09-20 11:50:00 to 2024-09-20 11:50:00
2024-09-20 11:56:37 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 11:56:37 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 11:50:00
2024-09-20 11:56:37 - INFO - 데이터베이스 업데이트 완료
2024-09-20 11:56:37 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 11:56:37 - INFO - GPT | 이전예측가격: 83951000 | 당시BTC가격: 83951000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:56:37 - INFO - ML 모델 예측 업데이트: 정확도 46.67%, 적중/전체: 7/15
2024-09-20 11:56:37 - INFO - ML | 이전예측가격: 83987582 | 당시BTC가격: 83951000 | 예측: 상승 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0000 | 반영가중치값: 0.0200 | 새 가중치: 0.0200 | 예측 총 횟수: 15 | 예측 성공 수: 7 | 예측 성공률: 46.67%
2024-09-20 11:56:37 - INFO - XGBOOST | 이전예측가격: 83954000 | 당시BTC가격: 83951000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 11:56:37 - INFO - LSTM 모델 예측 업데이트: 정확도 73.33%, 적중/전체: 11/15
2024-09-20 11:56:38 - INFO - LSTM | 이전예측가격: 83987070 | 당시BTC가격: 83951000 | 예측: 상승 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1409 | 반영가중치값: 0.0200 | 새 가중치: 0.1609 | 예측 총 횟수: 15 | 예측 성공 수: 11 | 예측 성공률: 73.33%
2024-09-20 11:56:38 - INFO - RL 모델 예측 업데이트: 정확도 54.78%, 적중/전체: 63/115
2024-09-20 11:56:38 - INFO - RL | 이전예측가격: 84790510 | 당시BTC가격: 83951000 | 예측: 상승 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1781 | 반영가중치값: 0.0200 | 새 가중치: 0.1981 | 예측 총 횟수: 115 | 예측 성공 수: 63 | 예측 성공률: 54.78%
2024-09-20 11:56:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 55.88%, 적중/전체: 19/34
2024-09-20 11:56:38 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 83951000 | 예측: 상승 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0921 | 반영가중치값: 0.0200 | 새 가중치: 0.1121 | 예측 총 횟수: 34 | 예측 성공 수: 19 | 예측 성공률: 55.88%
2024-09-20 11:56:38 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.65%, 적중/전체: 61/104
2024-09-20 11:56:38 - INFO - PROPHET | 이전예측가격: 83941080 | 당시BTC가격: 83951000 | 예측: 하락 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2885 | 반영가중치값: -0.0200 | 새 가중치: 0.2685 | 예측 총 횟수: 104 | 예측 성공 수: 61 | 예측 성공률: 58.65%
2024-09-20 11:56:38 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 73.33%, 적중/전체: 11/15
2024-09-20 11:56:38 - INFO - TRANSFORMER | 이전예측가격: 83999514 | 당시BTC가격: 83951000 | 예측: 상승 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1736 | 반영가중치값: 0.0200 | 새 가중치: 0.1936 | 예측 총 횟수: 15 | 예측 성공 수: 11 | 예측 성공률: 73.33%
2024-09-20 11:56:38 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 33/55
2024-09-20 11:56:38 - INFO - BITCOIN_FORECAST | 이전예측가격: 82998806 | 당시BTC가격: 83951000 | 예측: 하락 | 지금 BTC가격: 84089000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1019 | 반영가중치값: -0.0200 | 새 가중치: 0.0819 | 예측 총 횟수: 55 | 예측 성공 수: 33 | 예측 성공률: 60.00%
2024-09-20 11:56:38 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 11:56:38 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 11:56:38 - INFO - 새로운 가중치: {'gpt': 0.0031250635987603, 'ml': 0.01889978495005327, 'xgboost': 0.01883815970324208, 'rl': 0.18719008008841287, 'lstm': 0.15203442559478278, 'arima': 0.10594425318347724, 'prophet': 0.2536932801219675, 'transformer': 0.18292713005644592, 'bitcoin_forecast': 0.07734782270285802}
2024-09-20 11:56:38 - INFO - XGBoost 모델 성능: 정확도 60.48%, 적중/전체: 75/124
2024-09-20 11:56:38 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 11:56:38 - INFO - Current BTC price: 84089000.0
2024-09-20 11:56:38 - INFO - Analyzing market conditions.
2024-09-20 11:56:38 - INFO - Market analysis: {'current_price': 84089000.0, 'sma_20': 83873300.0, 'rsi_14': 53.98104378956187, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 11:56:38 - INFO - Starting predictions for all models
2024-09-20 11:56:38 - INFO - Attempting prediction for gpt
2024-09-20 11:56:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 11:56:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:56:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 11:56:38 - INFO - GPT prediction: 84089000.0
2024-09-20 11:56:38 - INFO - Attempting prediction for ml
2024-09-20 11:56:38 - INFO - ML prediction: 83954457.6
2024-09-20 11:56:38 - INFO - Attempting prediction for xgboost
2024-09-20 11:56:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 11:56:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:56:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 11:56:38 - INFO - XGBOOST prediction: 84089000.0
2024-09-20 11:56:38 - INFO - Attempting prediction for lstm
2024-09-20 11:56:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:56:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:56:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 11:56:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:56:38 - INFO - X 샘플:
[[-1.95668894 -2.4122619  -2.04137525 -2.40516738 -0.82530764 -0.83249107
  -2.40516738]
 [-1.6476941  -0.4718112  -1.07330039 -0.09762672  0.76877438  0.76612067
  -0.09762672]
 [ 0.08100676 -0.35444523  0.41669309  0.03146646  1.39727782  1.39544188
   0.03146646]
 [ 1.01634249  1.36692233  0.90493954  1.45149148  1.37263138  1.37884312
   1.45149148]
 [ 1.30028369  1.19478557  1.41844012  0.67693238 -0.38187235 -0.37666066
   0.67693238]
 [ 0.18957251 -0.03364491  0.37460288  0.05567144 -0.68403101 -0.68322608
   0.05567144]
 [ 0.23967978 -0.35444523 -1.03121018 -0.75116096  0.43427816  0.42951954
  -0.75116096]
 [ 0.13111403  0.42799457  0.48403743  0.62852244 -1.30302856 -1.30096138
   0.62852244]
 [ 0.77415734  0.20891143  0.48403743 -0.33967644 -1.41110985 -1.40916267
  -0.33967644]
 [-0.12777354  0.42799457  0.06313532  0.7495473   0.63238767  0.63257665
   0.7495473 ]]
2024-09-20 11:56:38 - INFO - y 샘플:
[0.7495473]
2024-09-20 11:56:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 11:56:38 - INFO - 모델 출력 (스케일링된 예측): [[0.24978578]]
2024-09-20 11:56:38 - INFO - 스케일러 역변환 후 예측 가격: 84027058.81890038
2024-09-20 11:56:38 - INFO - LSTMPredictor 최종 예측 가격: 84027058.81890038
2024-09-20 11:56:38 - INFO - LSTM prediction: 84027058.81890038
2024-09-20 11:56:38 - INFO - Attempting prediction for rl
2024-09-20 11:56:38 - INFO - Preparing state for RL agent.
2024-09-20 11:56:38 - INFO - Prepared state: [[8.40890000e+07 1.54410544e+01 1.60802344e-03 8.38733000e+07
  5.39810438e+01]]
2024-09-20 11:56:38 - INFO - RL prediction: 84929890.0
2024-09-20 11:56:38 - INFO - Attempting prediction for arima
2024-09-20 11:56:38 - INFO - ARIMA 예측 시작
2024-09-20 11:56:38 - INFO - 입력 데이터: {'open': 83956000.0, 'high': 84100000.0, 'low': 83900000.0, 'close': 84089000.0, 'volume': 15.44105443, 'value': 1297131581.37821, 'decision': 'sell', 'sma': 83873300.0, 'ema': 83943743.06702189, 'rsi': 53.98104378956187, 'macd': 11557.97717127204, 'signal_line': -29970.989356554746, 'BB_Upper': 84269064.6270217, 'BB_Lower': 83477535.3729783}
2024-09-20 11:56:38 - INFO - Exogenous 변수 예측 시작
2024-09-20 11:56:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83873300.0         0         0
2024-09-20 11:56:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83873300.0         0         0
2024-09-20 11:56:38 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 11:56:38 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 11:56:38 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 11:56:38 - INFO - ARIMA prediction: 84140000.0
2024-09-20 11:56:38 - INFO - Attempting prediction for prophet
2024-09-20 11:56:38 - INFO - PROPHET prediction: 84101304.5927074
2024-09-20 11:56:38 - INFO - Attempting prediction for transformer
2024-09-20 11:56:38 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 11:56:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 11:56:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 11:56:38 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 11:56:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 11:56:38 - INFO - X 샘플:
[[-1.95668894 -2.4122619  -2.04137525 -2.40516738 -0.82530764 -0.83249107
  -2.40516738 -2.40516738  0.          0.          0.         -2.40516738
  -2.40516738]
 [-1.6476941  -0.4718112  -1.07330039 -0.09762672  0.76877438  0.76612067
  -0.09762672 -0.09762672  0.          0.          0.         -0.09762672
  -0.09762672]
 [ 0.08100676 -0.35444523  0.41669309  0.03146646  1.39727782  1.39544188
   0.03146646  0.03146646  0.          0.          0.          0.03146646
   0.03146646]
 [ 1.01634249  1.36692233  0.90493954  1.45149148  1.37263138  1.37884312
   1.45149148  1.45149148  0.          0.          0.          1.45149148
   1.45149148]
 [ 1.30028369  1.19478557  1.41844012  0.67693238 -0.38187235 -0.37666066
   0.67693238  0.67693238  0.          0.          0.          0.67693238
   0.67693238]
 [ 0.18957251 -0.03364491  0.37460288  0.05567144 -0.68403101 -0.68322608
   0.05567144  0.05567144  0.          0.          0.          0.05567144
   0.05567144]
 [ 0.23967978 -0.35444523 -1.03121018 -0.75116096  0.43427816  0.42951954
  -0.75116096 -0.75116096  0.          0.          0.         -0.75116096
  -0.75116096]
 [ 0.13111403  0.42799457  0.48403743  0.62852244 -1.30302856 -1.30096138
   0.62852244  0.62852244  0.          0.          0.          0.62852244
   0.62852244]
 [ 0.77415734  0.20891143  0.48403743 -0.33967644 -1.41110985 -1.40916267
  -0.33967644 -0.33967644  0.          0.          0.         -0.33967644
  -0.33967644]
 [-0.12777354  0.42799457  0.06313532  0.7495473   0.63238767  0.63257665
   0.7495473   0.7495473   0.          0.          0.          0.7495473
   0.7495473 ]]
2024-09-20 11:56:38 - INFO - y 샘플:
[0.7495473]
2024-09-20 11:56:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 11:56:38 - INFO - 모델 출력 (스케일링된 예측): [0.3094105]
2024-09-20 11:56:38 - INFO - 스케일러 역변환 후 예측 가격: 84034448.79626037
2024-09-20 11:56:38 - INFO - TransformerPredictor 최종 예측 가격: 84034448.79626037
2024-09-20 11:56:38 - INFO - TRANSFORMER prediction: 84034448.79626037
2024-09-20 11:56:38 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 11:56:38 - INFO - BITCOIN_FORECAST prediction: 83143137.93176255
2024-09-20 11:56:38 - INFO - BitcoinForecast prediction: 83143137.93176255
2024-09-20 11:56:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 11:56:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 11:56:47 - INFO - 조정된 모델 가중치: {'gpt': 0.0031250635987603, 'ml': 0.01889978495005327, 'xgboost': 0.01883815970324208, 'rl': 0.18719008008841287, 'lstm': 0.15203442559478278, 'arima': 0.10594425318347724, 'prophet': 0.2536932801219675, 'transformer': 0.18292713005644592, 'bitcoin_forecast': 0.07734782270285802}
2024-09-20 11:56:47 - INFO - 조정된 모델 가중치: {'gpt': 0.0031250635987603, 'ml': 0.01889978495005327, 'xgboost': 0.01883815970324208, 'rl': 0.18719008008841287, 'lstm': 0.15203442559478278, 'arima': 0.10594425318347724, 'prophet': 0.2536932801219675, 'transformer': 0.18292713005644592, 'bitcoin_forecast': 0.07734782270285802}
2024-09-20 11:56:47 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84159831.73482999, 'current_price': 84089000.0, 'predictions': {'gpt': 84089000.0, 'ml': 83954457.6, 'xgboost': 84089000.0, 'lstm': 84027058.81890038, 'rl': 84929890.0, 'arima': 84140000.0, 'prophet': 84101304.5927074, 'transformer': 84034448.79626037, 'bitcoin_forecast': 83143137.93176255}, 'weights': {'gpt': 0.0031250635987603, 'ml': 0.01889978495005327, 'xgboost': 0.01883815970324208, 'rl': 0.18719008008841287, 'lstm': 0.15203442559478278, 'arima': 0.10594425318347724, 'prophet': 0.2536932801219675, 'transformer': 0.18292713005644592, 'bitcoin_forecast': 0.07734782270285802}}
2024-09-20 11:56:47 - INFO - 모델별 가중치:
2024-09-20 11:56:47 - INFO -   - GPT: 0.0031
2024-09-20 11:56:47 - INFO -   - ML: 0.0189
2024-09-20 11:56:47 - INFO -   - XGBOOST: 0.0188
2024-09-20 11:56:47 - INFO -   - RL: 0.1872
2024-09-20 11:56:47 - INFO -   - LSTM: 0.1520
2024-09-20 11:56:47 - INFO -   - ARIMA: 0.1059
2024-09-20 11:56:47 - INFO -   - PROPHET: 0.2537
2024-09-20 11:56:47 - INFO -   - TRANSFORMER: 0.1829
2024-09-20 11:56:47 - INFO -   - BITCOIN_FORECAST: 0.0773
2024-09-20 11:56:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 11:56:47 - INFO - 6. 거래 실행
2024-09-20 11:56:47 - INFO - Cancelling existing orders.
2024-09-20 11:56:47 - INFO - Cancelled 0 orders.
2024-09-20 11:56:47 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84159831.73482999, 'current_price': 84089000.0, 'predictions': {'gpt': 84089000.0, 'ml': 83954457.6, 'xgboost': 84089000.0, 'lstm': 84027058.81890038, 'rl': 84929890.0, 'arima': 84140000.0, 'prophet': 84101304.5927074, 'transformer': 84034448.79626037, 'bitcoin_forecast': 83143137.93176255}, 'weights': {'gpt': 0.0031250635987603, 'ml': 0.01889978495005327, 'xgboost': 0.01883815970324208, 'rl': 0.18719008008841287, 'lstm': 0.15203442559478278, 'arima': 0.10594425318347724, 'prophet': 0.2536932801219675, 'transformer': 0.18292713005644592, 'bitcoin_forecast': 0.07734782270285802}}, 현재 가격=84089000.0
2024-09-20 11:56:47 - INFO - 현재 잔고: KRW=49278.60143534, BTC=0.00507591, 총 자산가치=476106.79742534005
2024-09-20 11:56:47 - INFO - 매수 시도: 0.0005661939105297245 BTC (약 47610.679742534005 KRW)
2024-09-20 11:56:47 - INFO - 주문 결과: {'uuid': '95d2be64-24ca-4669-a1e8-d7a0c9133c51', 'side': 'bid', 'ord_type': 'limit', 'price': '84089000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T11:56:48+09:00', 'volume': '0.00056619', 'remaining_volume': '0.00056619', 'reserved_fee': '23.805175455', 'remaining_fee': '23.805175455', 'paid_fee': '0', 'locked': '47634.156085455', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 11:56:47 - INFO - buy 주문 성공: UUID=95d2be64-24ca-4669-a1e8-d7a0c9133c51
2024-09-20 11:56:47 - INFO - Trade executed successfully.
2024-09-20 11:56:47 - INFO - 7. summary 리포트 보내기
2024-09-20 11:56:48 - INFO - Message sent to Discord successfully.
2024-09-20 11:56:48 - INFO - Trading cycle completed.
2024-09-20 11:56:48 - INFO - Performing periodic update.
2024-09-20 11:56:48 - INFO - 계산된 시장 변동성: 0.029982241179399873
2024-09-20 12:05:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:05:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b3-a2b4-e44e0d7489cd "HTTP/1.1 200 OK"
2024-09-20 12:05:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:05:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:05:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81aa-8021-f6c47acf88e7 "HTTP/1.1 200 OK"
2024-09-20 12:05:53 - INFO - Updated actual price for ml prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:05:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:05:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8126-b277-f92a713793ad "HTTP/1.1 200 OK"
2024-09-20 12:05:59 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:05 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813e-b428-c828c300f2d7 "HTTP/1.1 200 OK"
2024-09-20 12:06:05 - INFO - Updated actual price for lstm prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8122-a048-e9fd3c8c72fe "HTTP/1.1 200 OK"
2024-09-20 12:06:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815b-b975-c2bce272012a "HTTP/1.1 200 OK"
2024-09-20 12:06:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-819e-96d3-e7d343beb416 "HTTP/1.1 200 OK"
2024-09-20 12:06:27 - INFO - Updated actual price for prophet prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d4-a3c4-e8ee8fcb38f2 "HTTP/1.1 200 OK"
2024-09-20 12:06:33 - INFO - Updated actual price for transformer prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:06:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-819a-802a-ea5b68c7441d "HTTP/1.1 200 OK"
2024-09-20 12:06:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 11:55:34.974283
2024-09-20 12:06:39 - INFO - Starting trading cycle.
2024-09-20 12:06:39 - INFO - ##################################################
2024-09-20 12:06:39 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-20 12:06:39 - INFO - ##################################################
2024-09-20 12:06:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:06:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:06:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 11:50:00
2024-09-20 12:06:39 - INFO - 새로운 데이터 범위: 2024-09-19 02:50:00 ~ 2024-09-20 12:00:00
2024-09-20 12:06:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:06:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:06:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:06:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:06:39 - INFO - Sample date values: [Timestamp('2024-09-20 12:00:00')]
2024-09-20 12:06:39 - INFO - Successfully added 1 new data points
2024-09-20 12:06:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:06:39 - INFO - Final date range: 2024-09-20 12:00:00 to 2024-09-20 12:00:00
2024-09-20 12:06:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:06:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:00:00
2024-09-20 12:06:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:06:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:06:39 - INFO - GPT | 이전예측가격: 84089000 | 당시BTC가격: 84089000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:06:39 - INFO - ML 모델 예측 업데이트: 정확도 43.75%, 적중/전체: 7/16
2024-09-20 12:06:39 - INFO - ML | 이전예측가격: 83954458 | 당시BTC가격: 84089000 | 예측: 하락 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0991 | 반영가중치값: -0.0200 | 새 가중치: 0.0791 | 예측 총 횟수: 16 | 예측 성공 수: 7 | 예측 성공률: 43.75%
2024-09-20 12:06:39 - INFO - XGBOOST | 이전예측가격: 84089000 | 당시BTC가격: 84089000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:06:39 - INFO - LSTM 모델 예측 업데이트: 정확도 68.75%, 적중/전체: 11/16
2024-09-20 12:06:39 - INFO - LSTM | 이전예측가격: 84027059 | 당시BTC가격: 84089000 | 예측: 하락 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1223 | 반영가중치값: -0.0200 | 새 가중치: 0.1023 | 예측 총 횟수: 16 | 예측 성공 수: 11 | 예측 성공률: 68.75%
2024-09-20 12:06:39 - INFO - RL 모델 예측 업데이트: 정확도 55.17%, 적중/전체: 64/116
2024-09-20 12:06:39 - INFO - RL | 이전예측가격: 84929890 | 당시BTC가격: 84089000 | 예측: 상승 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1386 | 반영가중치값: 0.0200 | 새 가중치: 0.1586 | 예측 총 횟수: 116 | 예측 성공 수: 64 | 예측 성공률: 55.17%
2024-09-20 12:06:39 - INFO - ARIMA 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 20/35
2024-09-20 12:06:39 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84089000 | 예측: 상승 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0211 | 반영가중치값: 0.0200 | 새 가중치: 0.0411 | 예측 총 횟수: 35 | 예측 성공 수: 20 | 예측 성공률: 57.14%
2024-09-20 12:06:39 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.05%, 적중/전체: 62/105
2024-09-20 12:06:39 - INFO - PROPHET | 이전예측가격: 84101305 | 당시BTC가격: 84089000 | 예측: 상승 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2679 | 반영가중치값: 0.0200 | 새 가중치: 0.2879 | 예측 총 횟수: 105 | 예측 성공 수: 62 | 예측 성공률: 59.05%
2024-09-20 12:06:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 68.75%, 적중/전체: 11/16
2024-09-20 12:06:39 - INFO - TRANSFORMER | 이전예측가격: 84034449 | 당시BTC가격: 84089000 | 예측: 하락 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1223 | 반영가중치값: -0.0200 | 새 가중치: 0.1023 | 예측 총 횟수: 16 | 예측 성공 수: 11 | 예측 성공률: 68.75%
2024-09-20 12:06:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.93%, 적중/전체: 33/56
2024-09-20 12:06:39 - INFO - BITCOIN_FORECAST | 이전예측가격: 83143138 | 당시BTC가격: 84089000 | 예측: 하락 | 지금 BTC가격: 84343000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.2054 | 반영가중치값: -0.0200 | 새 가중치: 0.1854 | 예측 총 횟수: 56 | 예측 성공 수: 33 | 예측 성공률: 58.93%
2024-09-20 12:06:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:06:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:06:40 - INFO - 새로운 가중치: {'gpt': 0.003193006130708615, 'ml': 0.08079785222834611, 'xgboost': 0.01924772329356156, 'rl': 0.16205964150250915, 'lstm': 0.10456165755373159, 'arima': 0.04198393881469006, 'prophet': 0.2941256468423767, 'transformer': 0.10456165755373159, 'bitcoin_forecast': 0.18946887608034463}
2024-09-20 12:06:40 - INFO - XGBoost 모델 성능: 정확도 60.48%, 적중/전체: 75/124
2024-09-20 12:06:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:06:40 - INFO - Current BTC price: 84433000.0
2024-09-20 12:06:40 - INFO - Analyzing market conditions.
2024-09-20 12:06:40 - INFO - Market analysis: {'current_price': 84343000.0, 'sma_20': 83889950.0, 'rsi_14': 60.028839472762485, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 12:06:40 - INFO - Starting predictions for all models
2024-09-20 12:06:40 - INFO - Attempting prediction for gpt
2024-09-20 12:06:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:06:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:06:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:06:40 - INFO - GPT prediction: 84433000.0
2024-09-20 12:06:40 - INFO - Attempting prediction for ml
2024-09-20 12:06:40 - INFO - ML prediction: 84140576.8
2024-09-20 12:06:40 - INFO - Attempting prediction for xgboost
2024-09-20 12:06:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:06:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:06:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:06:40 - INFO - XGBOOST prediction: 84343000.0
2024-09-20 12:06:40 - INFO - Attempting prediction for lstm
2024-09-20 12:06:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:06:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:06:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:06:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:06:40 - INFO - X 샘플:
[[-2.22226558 -0.9129173  -1.50720194 -0.63947029  0.12834937  0.1239572
  -0.63947029]
 [-0.33620992 -0.81383076 -0.04542252 -0.50589947  0.50154009  0.49605353
  -0.50589947]
 [ 0.68426464  0.63943845  0.43357864  0.96337953  0.48690561  0.48623925
   0.96337953]
 [ 0.99405156  0.49411153  0.93735573  0.16195462 -0.55487788 -0.55173072
   0.16195462]
 [-0.21776198 -0.54299422 -0.08671573 -0.48085495 -0.73429265 -0.73299247
  -0.48085495]
 [-0.1630937  -0.81383076 -1.46590874 -1.31567256 -0.0702667  -0.07506365
  -1.31567256]
 [-0.28154164 -0.15325384  0.0206466   0.11186556 -1.10183899 -1.09823845
   0.11186556]
 [ 0.42003462 -0.33821538  0.0206466  -0.88991558 -1.16601514 -1.16221421
  -0.88991558]
 [-0.56399442 -0.15325384 -0.39228544  0.2370882   0.04736612  0.04499714
   0.2370882 ]
 [ 1.68651643  2.59474612  2.0853068   2.35752494  2.46313019  2.46899237
   2.35752494]]
2024-09-20 12:06:40 - INFO - y 샘플:
[2.35752494]
2024-09-20 12:06:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:06:40 - INFO - 모델 출력 (스케일링된 예측): [[0.45791575]]
2024-09-20 12:06:40 - INFO - 스케일러 역변환 후 예측 가격: 84115452.19114731
2024-09-20 12:06:40 - INFO - LSTMPredictor 최종 예측 가격: 84115452.19114731
2024-09-20 12:06:40 - INFO - LSTM prediction: 84115452.19114731
2024-09-20 12:06:40 - INFO - Attempting prediction for rl
2024-09-20 12:06:40 - INFO - Preparing state for RL agent.
2024-09-20 12:06:40 - INFO - Prepared state: [[8.43430000e+07 3.27904906e+01 3.02060912e-03 8.38899500e+07
  6.00288395e+01]]
2024-09-20 12:06:40 - INFO - RL prediction: 85277330.0
2024-09-20 12:06:40 - INFO - Attempting prediction for arima
2024-09-20 12:06:40 - INFO - ARIMA 예측 시작
2024-09-20 12:06:40 - INFO - 입력 데이터: {'open': 84203000.0, 'high': 84516000.0, 'low': 84200000.0, 'close': 84343000.0, 'volume': 32.79049057, 'value': 2766568454.58978, 'decision': 'sell', 'sma': 83889950.0, 'ema': 83981767.53682934, 'rsi': 60.028839472762485, 'macd': 40908.89639124274, 'signal_line': -15795.012206995249, 'BB_Upper': 84332563.81587297, 'BB_Lower': 83447336.18412703}
2024-09-20 12:06:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:06:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83889950.0         0         0
2024-09-20 12:06:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83889950.0         0         0
2024-09-20 12:06:40 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 12:06:40 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 12:06:40 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 12:06:40 - INFO - ARIMA prediction: 84140000.0
2024-09-20 12:06:40 - INFO - Attempting prediction for prophet
2024-09-20 12:06:40 - INFO - PROPHET prediction: 84398152.22951965
2024-09-20 12:06:40 - INFO - Attempting prediction for transformer
2024-09-20 12:06:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:06:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:06:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:06:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:06:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:06:40 - INFO - X 샘플:
[[-2.22226558 -0.9129173  -1.50720194 -0.63947029  0.12834937  0.1239572
  -0.63947029 -0.63947029  0.          0.          0.         -0.63947029
  -0.63947029]
 [-0.33620992 -0.81383076 -0.04542252 -0.50589947  0.50154009  0.49605353
  -0.50589947 -0.50589947  0.          0.          0.         -0.50589947
  -0.50589947]
 [ 0.68426464  0.63943845  0.43357864  0.96337953  0.48690561  0.48623925
   0.96337953  0.96337953  0.          0.          0.          0.96337953
   0.96337953]
 [ 0.99405156  0.49411153  0.93735573  0.16195462 -0.55487788 -0.55173072
   0.16195462  0.16195462  0.          0.          0.          0.16195462
   0.16195462]
 [-0.21776198 -0.54299422 -0.08671573 -0.48085495 -0.73429265 -0.73299247
  -0.48085495 -0.48085495  0.          0.          0.         -0.48085495
  -0.48085495]
 [-0.1630937  -0.81383076 -1.46590874 -1.31567256 -0.0702667  -0.07506365
  -1.31567256 -1.31567256  0.          0.          0.         -1.31567256
  -1.31567256]
 [-0.28154164 -0.15325384  0.0206466   0.11186556 -1.10183899 -1.09823845
   0.11186556  0.11186556  0.          0.          0.          0.11186556
   0.11186556]
 [ 0.42003462 -0.33821538  0.0206466  -0.88991558 -1.16601514 -1.16221421
  -0.88991558 -0.88991558  0.          0.          0.         -0.88991558
  -0.88991558]
 [-0.56399442 -0.15325384 -0.39228544  0.2370882   0.04736612  0.04499714
   0.2370882   0.2370882   0.          0.          0.          0.2370882
   0.2370882 ]
 [ 1.68651643  2.59474612  2.0853068   2.35752494  2.46313019  2.46899237
   2.35752494  2.35752494  0.          0.          0.          2.35752494
   2.35752494]]
2024-09-20 12:06:40 - INFO - y 샘플:
[2.35752494]
2024-09-20 12:06:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:06:40 - INFO - 모델 출력 (스케일링된 예측): [0.31376112]
2024-09-20 12:06:40 - INFO - 스케일러 역변환 후 예측 가격: 84098184.39088663
2024-09-20 12:06:40 - INFO - TransformerPredictor 최종 예측 가격: 84098184.39088663
2024-09-20 12:06:40 - INFO - TRANSFORMER prediction: 84098184.39088663
2024-09-20 12:06:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:06:40 - INFO - BITCOIN_FORECAST prediction: 83423369.27375576
2024-09-20 12:06:40 - INFO - BitcoinForecast prediction: 83423369.27375576
2024-09-20 12:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:06:45 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:06:45 - INFO - 조정된 모델 가중치: {'gpt': 0.003193006130708615, 'ml': 0.08079785222834611, 'xgboost': 0.01924772329356156, 'rl': 0.16205964150250915, 'lstm': 0.10456165755373159, 'arima': 0.04198393881469006, 'prophet': 0.2941256468423767, 'transformer': 0.10456165755373159, 'bitcoin_forecast': 0.18946887608034463}
2024-09-20 12:06:45 - INFO - 조정된 모델 가중치: {'gpt': 0.003193006130708615, 'ml': 0.08079785222834611, 'xgboost': 0.01924772329356156, 'rl': 0.16205964150250915, 'lstm': 0.10456165755373159, 'arima': 0.04198393881469006, 'prophet': 0.2941256468423767, 'transformer': 0.10456165755373159, 'bitcoin_forecast': 0.18946887608034463}
2024-09-20 12:06:45 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84262415.63913777, 'current_price': 84433000.0, 'predictions': {'gpt': 84433000.0, 'ml': 84140576.8, 'xgboost': 84343000.0, 'lstm': 84115452.19114731, 'rl': 85277330.0, 'arima': 84140000.0, 'prophet': 84398152.22951965, 'transformer': 84098184.39088663, 'bitcoin_forecast': 83423369.27375576}, 'weights': {'gpt': 0.003193006130708615, 'ml': 0.08079785222834611, 'xgboost': 0.01924772329356156, 'rl': 0.16205964150250915, 'lstm': 0.10456165755373159, 'arima': 0.04198393881469006, 'prophet': 0.2941256468423767, 'transformer': 0.10456165755373159, 'bitcoin_forecast': 0.18946887608034463}}
2024-09-20 12:06:45 - INFO - 모델별 가중치:
2024-09-20 12:06:45 - INFO -   - GPT: 0.0032
2024-09-20 12:06:45 - INFO -   - ML: 0.0808
2024-09-20 12:06:45 - INFO -   - XGBOOST: 0.0192
2024-09-20 12:06:45 - INFO -   - RL: 0.1621
2024-09-20 12:06:45 - INFO -   - LSTM: 0.1046
2024-09-20 12:06:45 - INFO -   - ARIMA: 0.0420
2024-09-20 12:06:45 - INFO -   - PROPHET: 0.2941
2024-09-20 12:06:45 - INFO -   - TRANSFORMER: 0.1046
2024-09-20 12:06:45 - INFO -   - BITCOIN_FORECAST: 0.1895
2024-09-20 12:06:45 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:06:45 - INFO - 6. 거래 실행
2024-09-20 12:06:45 - INFO - Cancelling existing orders.
2024-09-20 12:06:45 - INFO - Cancelled 1 orders.
2024-09-20 12:06:45 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84262415.63913777, 'current_price': 84433000.0, 'predictions': {'gpt': 84433000.0, 'ml': 84140576.8, 'xgboost': 84343000.0, 'lstm': 84115452.19114731, 'rl': 85277330.0, 'arima': 84140000.0, 'prophet': 84398152.22951965, 'transformer': 84098184.39088663, 'bitcoin_forecast': 83423369.27375576}, 'weights': {'gpt': 0.003193006130708615, 'ml': 0.08079785222834611, 'xgboost': 0.01924772329356156, 'rl': 0.16205964150250915, 'lstm': 0.10456165755373159, 'arima': 0.04198393881469006, 'prophet': 0.2941256468423767, 'transformer': 0.10456165755373159, 'bitcoin_forecast': 0.18946887608034463}}, 현재 가격=84433000.0
2024-09-20 12:06:45 - INFO - 현재 잔고: KRW=1644.44534989, BTC=0.00507591, 총 자산가치=430218.75437989
2024-09-20 12:06:45 - INFO - 매도 시도: 0.000507591 BTC (약 42857.43090300001 KRW)
2024-09-20 12:06:45 - INFO - 주문 결과: {'uuid': 'c7705bb9-dea9-4988-8d56-854a9bcb4c60', 'side': 'ask', 'ord_type': 'limit', 'price': '84433000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:06:47+09:00', 'volume': '0.00050759', 'remaining_volume': '0.00050759', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00050759', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:06:45 - INFO - sell 주문 성공: UUID=c7705bb9-dea9-4988-8d56-854a9bcb4c60
2024-09-20 12:06:45 - INFO - Trade executed successfully.
2024-09-20 12:06:45 - INFO - 7. summary 리포트 보내기
2024-09-20 12:06:46 - INFO - Message sent to Discord successfully.
2024-09-20 12:06:46 - INFO - Trading cycle completed.
2024-09-20 12:06:46 - INFO - Performing periodic update.
2024-09-20 12:06:46 - INFO - 계산된 시장 변동성: 0.0301809401426474
2024-09-20 12:15:41 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:15:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810c-a5a8-e058934daaa5 "HTTP/1.1 200 OK"
2024-09-20 12:15:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:15:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:15:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813b-8ab4-d7c9f1fe8b73 "HTTP/1.1 200 OK"
2024-09-20 12:15:54 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81cf-90e0-de5d4deee906 "HTTP/1.1 200 OK"
2024-09-20 12:16:09 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f5-8489-f4a141b17b39 "HTTP/1.1 200 OK"
2024-09-20 12:16:15 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8154-8573-f33bb185c72d "HTTP/1.1 200 OK"
2024-09-20 12:16:23 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8186-8ff2-f745aa4cdf90 "HTTP/1.1 200 OK"
2024-09-20 12:16:30 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810b-9de4-fcdfd1a195ad "HTTP/1.1 200 OK"
2024-09-20 12:16:37 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c8-bc73-c11612c7c44b "HTTP/1.1 200 OK"
2024-09-20 12:16:45 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:16:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81aa-b134-cf896143202e "HTTP/1.1 200 OK"
2024-09-20 12:16:51 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:05:34.974383
2024-09-20 12:16:51 - INFO - Starting trading cycle.
2024-09-20 12:16:51 - INFO - ##################################################
2024-09-20 12:16:51 - INFO - 15 회 예측 후 모델 재학습 검토
2024-09-20 12:16:51 - INFO - ##################################################
2024-09-20 12:16:51 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:16:51 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:16:51 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:00:00
2024-09-20 12:16:51 - INFO - 새로운 데이터 범위: 2024-09-19 03:00:00 ~ 2024-09-20 12:10:00
2024-09-20 12:16:51 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:16:51 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:16:51 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:16:51 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:16:51 - INFO - Sample date values: [Timestamp('2024-09-20 12:10:00')]
2024-09-20 12:16:51 - INFO - Successfully added 1 new data points
2024-09-20 12:16:51 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:16:51 - INFO - Final date range: 2024-09-20 12:10:00 to 2024-09-20 12:10:00
2024-09-20 12:16:51 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:16:51 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:10:00
2024-09-20 12:16:51 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:16:51 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:16:51 - INFO - GPT | 이전예측가격: 84433000 | 당시BTC가격: 84433000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:16:51 - INFO - ML 모델 예측 업데이트: 정확도 47.06%, 적중/전체: 8/17
2024-09-20 12:16:51 - INFO - ML | 이전예측가격: 84140577 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0189 | 반영가중치값: 0.0200 | 새 가중치: 0.0389 | 예측 총 횟수: 17 | 예측 성공 수: 8 | 예측 성공률: 47.06%
2024-09-20 12:16:51 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:16:51 - INFO - XGBOOST | 이전예측가격: 84343000 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0188 | 반영가중치값: 0.0200 | 새 가중치: 0.0388 | 예측 총 횟수: 125 | 예측 성공 수: 76 | 예측 성공률: 60.80%
2024-09-20 12:16:51 - INFO - LSTM 모델 예측 업데이트: 정확도 70.59%, 적중/전체: 12/17
2024-09-20 12:16:51 - INFO - LSTM | 이전예측가격: 84115452 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1520 | 반영가중치값: 0.0200 | 새 가중치: 0.1720 | 예측 총 횟수: 17 | 예측 성공 수: 12 | 예측 성공률: 70.59%
2024-09-20 12:16:51 - INFO - RL 모델 예측 업데이트: 정확도 54.70%, 적중/전체: 64/117
2024-09-20 12:16:51 - INFO - RL | 이전예측가격: 85277330 | 당시BTC가격: 84433000 | 예측: 상승 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1872 | 반영가중치값: -0.0200 | 새 가중치: 0.1672 | 예측 총 횟수: 117 | 예측 성공 수: 64 | 예측 성공률: 54.70%
2024-09-20 12:16:51 - INFO - ARIMA 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 21/36
2024-09-20 12:16:51 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1059 | 반영가중치값: 0.0200 | 새 가중치: 0.1259 | 예측 총 횟수: 36 | 예측 성공 수: 21 | 예측 성공률: 58.33%
2024-09-20 12:16:51 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.43%, 적중/전체: 63/106
2024-09-20 12:16:51 - INFO - PROPHET | 이전예측가격: 84398152 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.2537 | 반영가중치값: 0.0200 | 새 가중치: 0.2737 | 예측 총 횟수: 106 | 예측 성공 수: 63 | 예측 성공률: 59.43%
2024-09-20 12:16:51 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 70.59%, 적중/전체: 12/17
2024-09-20 12:16:51 - INFO - TRANSFORMER | 이전예측가격: 84098184 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1829 | 반영가중치값: 0.0200 | 새 가중치: 0.2029 | 예측 총 횟수: 17 | 예측 성공 수: 12 | 예측 성공률: 70.59%
2024-09-20 12:16:51 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 59.65%, 적중/전체: 34/57
2024-09-20 12:16:51 - INFO - BITCOIN_FORECAST | 이전예측가격: 83423369 | 당시BTC가격: 84433000 | 예측: 하락 | 지금 BTC가격: 84397000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0773 | 반영가중치값: 0.0200 | 새 가중치: 0.0973 | 예측 총 횟수: 57 | 예측 성공 수: 34 | 예측 성공률: 59.65%
2024-09-20 12:16:51 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:16:51 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:16:51 - INFO - 새로운 가중치: {'gpt': 0.0028507253975064454, 'ml': 0.034729844032603145, 'xgboost': 0.03467482482843604, 'rl': 0.14926780219285135, 'lstm': 0.1535928483105173, 'arima': 0.1124434049052206, 'prophet': 0.24435417685758898, 'transformer': 0.18117394699978898, 'bitcoin_forecast': 0.08691242647548705}
2024-09-20 12:16:51 - INFO - XGBoost 모델 성능: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:16:51 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:16:51 - INFO - Current BTC price: 84397000.0
2024-09-20 12:16:51 - INFO - Analyzing market conditions.
2024-09-20 12:16:51 - INFO - Market analysis: {'current_price': 84397000.0, 'sma_20': 83915300.0, 'rsi_14': 61.19639396718131, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 12:16:51 - INFO - Starting predictions for all models
2024-09-20 12:16:51 - INFO - Attempting prediction for gpt
2024-09-20 12:16:52 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:16:52 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:16:52 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:16:52 - INFO - GPT prediction: 84397000.0
2024-09-20 12:16:52 - INFO - Attempting prediction for ml
2024-09-20 12:16:52 - INFO - ML prediction: 84228206.0
2024-09-20 12:16:52 - INFO - Attempting prediction for xgboost
2024-09-20 12:16:52 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:16:52 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:16:52 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:16:52 - INFO - XGBOOST prediction: 84397000.0
2024-09-20 12:16:52 - INFO - Attempting prediction for lstm
2024-09-20 12:16:52 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:16:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:16:52 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:16:52 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:16:52 - INFO - X 샘플:
[[-0.73342758 -0.97635762 -0.41234379 -0.66652735  0.5284379   0.52170477
  -0.66652735]
 [ 0.05038815  0.26741005 -0.04040071  0.4846877   0.51380036  0.51188821
   0.4846877 ]
 [ 0.28833222  0.14303328  0.3507808  -0.14324778 -0.52820104 -0.5263222
  -0.14324778]
 [-0.64244897 -0.74456455 -0.44440785 -0.64690437 -0.70765335 -0.70762595
  -0.64690437]
 [-0.60045884 -0.97635762 -1.5153474  -1.30100383 -0.04348849 -0.04954472
  -1.30100383]
 [-0.69143745 -0.41100868 -0.3610413  -0.18249375 -1.07527657 -1.07295653
  -0.18249375]
 [-0.15256413 -0.56930638 -0.3610413  -0.96741311 -1.13946615 -1.13694711
  -0.96741311]
 [-0.90838645 -0.41100868 -0.68168188 -0.08437883  0.07416893  0.07054389
  -0.08437883]
 [ 0.82020718  1.94084291  1.24216162  1.5770338   2.49043833  2.49510063
   1.5770338 ]
 [ 2.56979586  1.73731729  2.2233218   1.93024751 -0.11275993 -0.10584099
   1.93024751]]
2024-09-20 12:16:52 - INFO - y 샘플:
[1.93024751]
2024-09-20 12:16:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:16:52 - INFO - 모델 출력 (스케일링된 예측): [[0.50764287]]
2024-09-20 12:16:52 - INFO - 스케일러 역변환 후 예측 가격: 84179509.43007687
2024-09-20 12:16:52 - INFO - LSTMPredictor 최종 예측 가격: 84179509.43007687
2024-09-20 12:16:52 - INFO - LSTM prediction: 84179509.43007687
2024-09-20 12:16:52 - INFO - Attempting prediction for rl
2024-09-20 12:16:52 - INFO - Preparing state for RL agent.
2024-09-20 12:16:52 - INFO - Prepared state: [[8.43970000e+07 1.40988571e+01 6.40242818e-04 8.39153000e+07
  6.11963940e+01]]
2024-09-20 12:16:52 - INFO - RL prediction: 85240970.0
2024-09-20 12:16:52 - INFO - Attempting prediction for arima
2024-09-20 12:16:52 - INFO - ARIMA 예측 시작
2024-09-20 12:16:52 - INFO - 입력 데이터: {'open': 84453000.0, 'high': 84480000.0, 'low': 84353000.0, 'close': 84397000.0, 'volume': 14.09885713, 'value': 1190231032.06001, 'decision': 'sell', 'sma': 83915300.0, 'ema': 84021313.48570274, 'rsi': 61.19639396718131, 'macd': 67746.12488105893, 'signal_line': 913.2152106155863, 'BB_Upper': 84410028.65289785, 'BB_Lower': 83420571.34710215}
2024-09-20 12:16:52 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:16:52 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83915300.0         0         0
2024-09-20 12:16:52 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83915300.0         0         0
2024-09-20 12:16:52 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 12:16:52 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 12:16:52 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 12:16:52 - INFO - ARIMA prediction: 84140000.0
2024-09-20 12:16:52 - INFO - Attempting prediction for prophet
2024-09-20 12:16:52 - INFO - PROPHET prediction: 84447755.44668157
2024-09-20 12:16:52 - INFO - Attempting prediction for transformer
2024-09-20 12:16:52 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:16:52 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:16:52 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:16:52 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:16:52 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:16:52 - INFO - X 샘플:
[[-0.73342758 -0.97635762 -0.41234379 -0.66652735  0.5284379   0.52170477
  -0.66652735 -0.66652735  0.          0.          0.         -0.66652735
  -0.66652735]
 [ 0.05038815  0.26741005 -0.04040071  0.4846877   0.51380036  0.51188821
   0.4846877   0.4846877   0.          0.          0.          0.4846877
   0.4846877 ]
 [ 0.28833222  0.14303328  0.3507808  -0.14324778 -0.52820104 -0.5263222
  -0.14324778 -0.14324778  0.          0.          0.         -0.14324778
  -0.14324778]
 [-0.64244897 -0.74456455 -0.44440785 -0.64690437 -0.70765335 -0.70762595
  -0.64690437 -0.64690437  0.          0.          0.         -0.64690437
  -0.64690437]
 [-0.60045884 -0.97635762 -1.5153474  -1.30100383 -0.04348849 -0.04954472
  -1.30100383 -1.30100383  0.          0.          0.         -1.30100383
  -1.30100383]
 [-0.69143745 -0.41100868 -0.3610413  -0.18249375 -1.07527657 -1.07295653
  -0.18249375 -0.18249375  0.          0.          0.         -0.18249375
  -0.18249375]
 [-0.15256413 -0.56930638 -0.3610413  -0.96741311 -1.13946615 -1.13694711
  -0.96741311 -0.96741311  0.          0.          0.         -0.96741311
  -0.96741311]
 [-0.90838645 -0.41100868 -0.68168188 -0.08437883  0.07416893  0.07054389
  -0.08437883 -0.08437883  0.          0.          0.         -0.08437883
  -0.08437883]
 [ 0.82020718  1.94084291  1.24216162  1.5770338   2.49043833  2.49510063
   1.5770338   1.5770338   0.          0.          0.          1.5770338
   1.5770338 ]
 [ 2.56979586  1.73731729  2.2233218   1.93024751 -0.11275993 -0.10584099
   1.93024751  1.93024751  0.          0.          0.          1.93024751
   1.93024751]]
2024-09-20 12:16:52 - INFO - y 샘플:
[1.93024751]
2024-09-20 12:16:52 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:16:52 - INFO - 모델 출력 (스케일링된 예측): [0.31213105]
2024-09-20 12:16:52 - INFO - 스케일러 역변환 후 예측 가격: 84149619.20250991
2024-09-20 12:16:52 - INFO - TransformerPredictor 최종 예측 가격: 84149619.20250991
2024-09-20 12:16:52 - INFO - TRANSFORMER prediction: 84149619.20250991
2024-09-20 12:16:52 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:16:52 - INFO - BITCOIN_FORECAST prediction: 83226836.56444456
2024-09-20 12:16:52 - INFO - BitcoinForecast prediction: 83226836.56444456
2024-09-20 12:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:58 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:59 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:16:59 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:16:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0028507253975064454, 'ml': 0.034729844032603145, 'xgboost': 0.03467482482843604, 'rl': 0.14926780219285135, 'lstm': 0.1535928483105173, 'arima': 0.1124434049052206, 'prophet': 0.24435417685758898, 'transformer': 0.18117394699978898, 'bitcoin_forecast': 0.08691242647548705}
2024-09-20 12:16:59 - INFO - 조정된 모델 가중치: {'gpt': 0.0028507253975064454, 'ml': 0.034729844032603145, 'xgboost': 0.03467482482843604, 'rl': 0.14926780219285135, 'lstm': 0.1535928483105173, 'arima': 0.1124434049052206, 'prophet': 0.24435417685758898, 'transformer': 0.18117394699978898, 'bitcoin_forecast': 0.08691242647548705}
2024-09-20 12:16:59 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84320694.01289192, 'current_price': 84397000.0, 'predictions': {'gpt': 84397000.0, 'ml': 84228206.0, 'xgboost': 84397000.0, 'lstm': 84179509.43007687, 'rl': 85240970.0, 'arima': 84140000.0, 'prophet': 84447755.44668157, 'transformer': 84149619.20250991, 'bitcoin_forecast': 83226836.56444456}, 'weights': {'gpt': 0.0028507253975064454, 'ml': 0.034729844032603145, 'xgboost': 0.03467482482843604, 'rl': 0.14926780219285135, 'lstm': 0.1535928483105173, 'arima': 0.1124434049052206, 'prophet': 0.24435417685758898, 'transformer': 0.18117394699978898, 'bitcoin_forecast': 0.08691242647548705}}
2024-09-20 12:16:59 - INFO - 모델별 가중치:
2024-09-20 12:16:59 - INFO -   - GPT: 0.0029
2024-09-20 12:16:59 - INFO -   - ML: 0.0347
2024-09-20 12:16:59 - INFO -   - XGBOOST: 0.0347
2024-09-20 12:16:59 - INFO -   - RL: 0.1493
2024-09-20 12:16:59 - INFO -   - LSTM: 0.1536
2024-09-20 12:16:59 - INFO -   - ARIMA: 0.1124
2024-09-20 12:16:59 - INFO -   - PROPHET: 0.2444
2024-09-20 12:16:59 - INFO -   - TRANSFORMER: 0.1812
2024-09-20 12:16:59 - INFO -   - BITCOIN_FORECAST: 0.0869
2024-09-20 12:16:59 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:16:59 - INFO - 6. 거래 실행
2024-09-20 12:16:59 - INFO - Cancelling existing orders.
2024-09-20 12:16:59 - INFO - Cancelled 0 orders.
2024-09-20 12:16:59 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84320694.01289192, 'current_price': 84397000.0, 'predictions': {'gpt': 84397000.0, 'ml': 84228206.0, 'xgboost': 84397000.0, 'lstm': 84179509.43007687, 'rl': 85240970.0, 'arima': 84140000.0, 'prophet': 84447755.44668157, 'transformer': 84149619.20250991, 'bitcoin_forecast': 83226836.56444456}, 'weights': {'gpt': 0.0028507253975064454, 'ml': 0.034729844032603145, 'xgboost': 0.03467482482843604, 'rl': 0.14926780219285135, 'lstm': 0.1535928483105173, 'arima': 0.1124434049052206, 'prophet': 0.24435417685758898, 'transformer': 0.18117394699978898, 'bitcoin_forecast': 0.08691242647548705}}, 현재 가격=84397000.0
2024-09-20 12:16:59 - INFO - 현재 잔고: KRW=92114.51923211, BTC=0.00456832, 총 자산가치=477667.02227211
2024-09-20 12:16:59 - INFO - 매도 시도: 0.000456832 BTC (약 38555.250304 KRW)
2024-09-20 12:16:59 - INFO - 주문 결과: {'uuid': 'ce2b1e67-e6ba-43a6-b37d-c7e0bdc62761', 'side': 'ask', 'ord_type': 'limit', 'price': '84397000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:17:00+09:00', 'volume': '0.00045683', 'remaining_volume': '0.00045683', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00045683', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:16:59 - INFO - sell 주문 성공: UUID=ce2b1e67-e6ba-43a6-b37d-c7e0bdc62761
2024-09-20 12:16:59 - INFO - Trade executed successfully.
2024-09-20 12:16:59 - INFO - 7. summary 리포트 보내기
2024-09-20 12:16:59 - INFO - Message sent to Discord successfully.
2024-09-20 12:16:59 - INFO - Trading cycle completed.
2024-09-20 12:16:59 - INFO - Performing periodic update.
2024-09-20 12:16:59 - INFO - 계산된 시장 변동성: 0.030191489148128768
2024-09-20 12:25:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:25:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815d-ac2a-f282be40e4ac "HTTP/1.1 200 OK"
2024-09-20 12:25:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:25:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8161-a3ca-dcdbb43820d3 "HTTP/1.1 200 OK"
2024-09-20 12:25:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:25:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8126-9beb-c506a0157fad "HTTP/1.1 200 OK"
2024-09-20 12:25:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:01 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814f-9a9e-cc8e7a944ed2 "HTTP/1.1 200 OK"
2024-09-20 12:26:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815a-8b6e-dc7e31628663 "HTTP/1.1 200 OK"
2024-09-20 12:26:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b6-8f87-f0debe51b2c3 "HTTP/1.1 200 OK"
2024-09-20 12:26:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8130-8c46-edc80e356dfc "HTTP/1.1 200 OK"
2024-09-20 12:26:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8163-998c-eb73ae879d2b "HTTP/1.1 200 OK"
2024-09-20 12:26:31 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:26:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8148-926c-e0581d135fbc "HTTP/1.1 200 OK"
2024-09-20 12:26:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:15:34.974767
2024-09-20 12:26:38 - INFO - Starting trading cycle.
2024-09-20 12:26:38 - INFO - ##################################################
2024-09-20 12:26:38 - INFO - 16 회 예측 후 모델 재학습 검토
2024-09-20 12:26:38 - INFO - ##################################################
2024-09-20 12:26:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:26:38 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:26:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:10:00
2024-09-20 12:26:38 - INFO - 새로운 데이터 범위: 2024-09-19 03:10:00 ~ 2024-09-20 12:20:00
2024-09-20 12:26:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:26:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:26:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:26:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:26:38 - INFO - Sample date values: [Timestamp('2024-09-20 12:20:00')]
2024-09-20 12:26:38 - INFO - Successfully added 1 new data points
2024-09-20 12:26:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:26:38 - INFO - Final date range: 2024-09-20 12:20:00 to 2024-09-20 12:20:00
2024-09-20 12:26:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:26:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:20:00
2024-09-20 12:26:38 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:26:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:26:39 - INFO - GPT | 이전예측가격: 84397000 | 당시BTC가격: 84397000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:26:39 - INFO - ML 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 8/18
2024-09-20 12:26:39 - INFO - ML | 이전예측가격: 84228206 | 당시BTC가격: 84397000 | 예측: 하락 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0808 | 반영가중치값: -0.0200 | 새 가중치: 0.0608 | 예측 총 횟수: 18 | 예측 성공 수: 8 | 예측 성공률: 44.44%
2024-09-20 12:26:39 - INFO - XGBOOST | 이전예측가격: 84397000 | 당시BTC가격: 84397000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:26:39 - INFO - LSTM 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 12/18
2024-09-20 12:26:39 - INFO - LSTM | 이전예측가격: 84179509 | 당시BTC가격: 84397000 | 예측: 하락 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1046 | 반영가중치값: -0.0200 | 새 가중치: 0.0846 | 예측 총 횟수: 18 | 예측 성공 수: 12 | 예측 성공률: 66.67%
2024-09-20 12:26:39 - INFO - RL 모델 예측 업데이트: 정확도 55.08%, 적중/전체: 65/118
2024-09-20 12:26:39 - INFO - RL | 이전예측가격: 85240970 | 당시BTC가격: 84397000 | 예측: 상승 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1621 | 반영가중치값: 0.0200 | 새 가중치: 0.1821 | 예측 총 횟수: 118 | 예측 성공 수: 65 | 예측 성공률: 55.08%
2024-09-20 12:26:39 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.76%, 적중/전체: 21/37
2024-09-20 12:26:39 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84397000 | 예측: 하락 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0420 | 반영가중치값: -0.0200 | 새 가중치: 0.0220 | 예측 총 횟수: 37 | 예측 성공 수: 21 | 예측 성공률: 56.76%
2024-09-20 12:26:39 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.81%, 적중/전체: 64/107
2024-09-20 12:26:39 - INFO - PROPHET | 이전예측가격: 84447755 | 당시BTC가격: 84397000 | 예측: 상승 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2941 | 반영가중치값: 0.0200 | 새 가중치: 0.3141 | 예측 총 횟수: 107 | 예측 성공 수: 64 | 예측 성공률: 59.81%
2024-09-20 12:26:39 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 12/18
2024-09-20 12:26:39 - INFO - TRANSFORMER | 이전예측가격: 84149619 | 당시BTC가격: 84397000 | 예측: 하락 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1046 | 반영가중치값: -0.0200 | 새 가중치: 0.0846 | 예측 총 횟수: 18 | 예측 성공 수: 12 | 예측 성공률: 66.67%
2024-09-20 12:26:39 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 34/58
2024-09-20 12:26:39 - INFO - BITCOIN_FORECAST | 이전예측가격: 83226837 | 당시BTC가격: 84397000 | 예측: 하락 | 지금 BTC가격: 84510000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1895 | 반영가중치값: -0.0200 | 새 가중치: 0.1695 | 예측 총 횟수: 58 | 예측 성공 수: 34 | 예측 성공률: 58.62%
2024-09-20 12:26:39 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:26:39 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:26:39 - INFO - 새로운 가중치: {'gpt': 0.0029847876706004224, 'ml': 0.06365701862721893, 'xgboost': 0.03630549253136589, 'rl': 0.19062143752812782, 'lstm': 0.08853837451081342, 'arima': 0.023017786835139244, 'prophet': 0.32889816694888746, 'transformer': 0.08853837451081342, 'bitcoin_forecast': 0.17743856083703335}
2024-09-20 12:26:39 - INFO - XGBoost 모델 성능: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:26:39 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:26:39 - INFO - Current BTC price: 84510000.0
2024-09-20 12:26:39 - INFO - Analyzing market conditions.
2024-09-20 12:26:39 - INFO - Market analysis: {'current_price': 84510000.0, 'sma_20': 83943650.0, 'rsi_14': 63.59293794657171, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 12:26:39 - INFO - Starting predictions for all models
2024-09-20 12:26:39 - INFO - Attempting prediction for gpt
2024-09-20 12:26:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:26:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:26:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:26:39 - INFO - GPT prediction: 84510000.0
2024-09-20 12:26:39 - INFO - Attempting prediction for ml
2024-09-20 12:26:39 - INFO - ML prediction: 84290274.0
2024-09-20 12:26:39 - INFO - Attempting prediction for xgboost
2024-09-20 12:26:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:26:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:26:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:26:39 - INFO - XGBOOST prediction: 84510000.0
2024-09-20 12:26:39 - INFO - Attempting prediction for lstm
2024-09-20 12:26:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:26:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:26:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:26:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:26:39 - INFO - X 샘플:
[[-0.24571077 -0.04845281 -0.28752006  0.12109671  0.39561305  0.39153576
   0.12109671]
 [-0.06250537 -0.15722443  0.00626091 -0.38216235 -0.5713157  -0.57037466
  -0.38216235]
 [-0.77916178 -0.93345824 -0.59093318 -0.78581805 -0.73783908 -0.73835406
  -0.78581805]
 [-0.74683142 -1.13616898 -1.39521876 -1.31004624 -0.12152504 -0.12863643
  -1.31004624]
 [-0.81688054 -0.64175254 -0.52832412 -0.41361604 -1.0789763  -1.07683583
  -0.41361604]
 [-0.4019742  -0.78018914 -0.52832412 -1.04268987 -1.13854124 -1.13612362
  -1.04268987]
 [-0.98392076 -0.64175254 -0.76912819 -0.33498181 -0.01234443 -0.01737336
  -0.33498181]
 [ 0.34701258  1.41501985  0.67569621  0.99655779  2.22984099  2.22899825
   0.99655779]
 [ 1.6941111   1.23702993  1.41255666  1.27964101 -0.1858057  -0.18079539
   1.27964101]
 [ 1.99586116  1.6869489   2.00493466  1.87201886  1.22089346  1.22795934
   1.87201886]]
2024-09-20 12:26:39 - INFO - y 샘플:
[1.87201886]
2024-09-20 12:26:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:26:39 - INFO - 모델 출력 (스케일링된 예측): [[0.57885385]]
2024-09-20 12:26:39 - INFO - 스케일러 역변환 후 예측 가격: 84263320.20598246
2024-09-20 12:26:39 - INFO - LSTMPredictor 최종 예측 가격: 84263320.20598246
2024-09-20 12:26:39 - INFO - LSTM prediction: 84263320.20598246
2024-09-20 12:26:39 - INFO - Attempting prediction for rl
2024-09-20 12:26:39 - INFO - Preparing state for RL agent.
2024-09-20 12:26:39 - INFO - Prepared state: [[8.45100000e+07 2.49835221e+01 1.33891015e-03 8.39436500e+07
  6.35929379e+01]]
2024-09-20 12:26:39 - INFO - RL prediction: 85355100.0
2024-09-20 12:26:39 - INFO - Attempting prediction for arima
2024-09-20 12:26:39 - INFO - ARIMA 예측 시작
2024-09-20 12:26:39 - INFO - 입력 데이터: {'open': 84509000.0, 'high': 84571000.0, 'low': 84476000.0, 'close': 84510000.0, 'volume': 24.98352215, 'value': 2111750930.25561, 'decision': 'sell', 'sma': 83943650.0, 'ema': 84067855.05849296, 'rsi': 63.59293794657171, 'macd': 97014.65290151536, 'signal_line': 20133.50274879554, 'BB_Upper': 84502328.53905733, 'BB_Lower': 83384971.46094267}
2024-09-20 12:26:39 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:26:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83943650.0         0         0
2024-09-20 12:26:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83943650.0         0         0
2024-09-20 12:26:39 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 12:26:39 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 12:26:39 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 12:26:39 - INFO - ARIMA prediction: 84140000.0
2024-09-20 12:26:39 - INFO - Attempting prediction for prophet
2024-09-20 12:26:39 - INFO - PROPHET prediction: 84579836.47548729
2024-09-20 12:26:39 - INFO - Attempting prediction for transformer
2024-09-20 12:26:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:26:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:26:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:26:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:26:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:26:39 - INFO - X 샘플:
[[-0.24571077 -0.04845281 -0.28752006  0.12109671  0.39561305  0.39153576
   0.12109671  0.12109671  0.          0.          0.          0.12109671
   0.12109671]
 [-0.06250537 -0.15722443  0.00626091 -0.38216235 -0.5713157  -0.57037466
  -0.38216235 -0.38216235  0.          0.          0.         -0.38216235
  -0.38216235]
 [-0.77916178 -0.93345824 -0.59093318 -0.78581805 -0.73783908 -0.73835406
  -0.78581805 -0.78581805  0.          0.          0.         -0.78581805
  -0.78581805]
 [-0.74683142 -1.13616898 -1.39521876 -1.31004624 -0.12152504 -0.12863643
  -1.31004624 -1.31004624  0.          0.          0.         -1.31004624
  -1.31004624]
 [-0.81688054 -0.64175254 -0.52832412 -0.41361604 -1.0789763  -1.07683583
  -0.41361604 -0.41361604  0.          0.          0.         -0.41361604
  -0.41361604]
 [-0.4019742  -0.78018914 -0.52832412 -1.04268987 -1.13854124 -1.13612362
  -1.04268987 -1.04268987  0.          0.          0.         -1.04268987
  -1.04268987]
 [-0.98392076 -0.64175254 -0.76912819 -0.33498181 -0.01234443 -0.01737336
  -0.33498181 -0.33498181  0.          0.          0.         -0.33498181
  -0.33498181]
 [ 0.34701258  1.41501985  0.67569621  0.99655779  2.22984099  2.22899825
   0.99655779  0.99655779  0.          0.          0.          0.99655779
   0.99655779]
 [ 1.6941111   1.23702993  1.41255666  1.27964101 -0.1858057  -0.18079539
   1.27964101  1.27964101  0.          0.          0.          1.27964101
   1.27964101]
 [ 1.99586116  1.6869489   2.00493466  1.87201886  1.22089346  1.22795934
   1.87201886  1.87201886  0.          0.          0.          1.87201886
   1.87201886]]
2024-09-20 12:26:39 - INFO - y 샘플:
[1.87201886]
2024-09-20 12:26:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:26:39 - INFO - 모델 출력 (스케일링된 예측): [0.3129186]
2024-09-20 12:26:39 - INFO - 스케일러 역변환 후 예측 가격: 84212591.29670343
2024-09-20 12:26:39 - INFO - TransformerPredictor 최종 예측 가격: 84212591.29670343
2024-09-20 12:26:39 - INFO - TRANSFORMER prediction: 84212591.29670343
2024-09-20 12:26:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:26:39 - INFO - BITCOIN_FORECAST prediction: 83389971.71958429
2024-09-20 12:26:39 - INFO - BitcoinForecast prediction: 83389971.71958429
2024-09-20 12:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:26:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:26:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0029847876706004224, 'ml': 0.06365701862721893, 'xgboost': 0.03630549253136589, 'rl': 0.19062143752812782, 'lstm': 0.08853837451081342, 'arima': 0.023017786835139244, 'prophet': 0.32889816694888746, 'transformer': 0.08853837451081342, 'bitcoin_forecast': 0.17743856083703335}
2024-09-20 12:26:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0029847876706004224, 'ml': 0.06365701862721893, 'xgboost': 0.03630549253136589, 'rl': 0.19062143752812782, 'lstm': 0.08853837451081342, 'arima': 0.023017786835139244, 'prophet': 0.32889816694888746, 'transformer': 0.08853837451081342, 'bitcoin_forecast': 0.17743856083703335}
2024-09-20 12:26:50 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84424650.66510911, 'current_price': 84510000.0, 'predictions': {'gpt': 84510000.0, 'ml': 84290274.0, 'xgboost': 84510000.0, 'lstm': 84263320.20598246, 'rl': 85355100.0, 'arima': 84140000.0, 'prophet': 84579836.47548729, 'transformer': 84212591.29670343, 'bitcoin_forecast': 83389971.71958429}, 'weights': {'gpt': 0.0029847876706004224, 'ml': 0.06365701862721893, 'xgboost': 0.03630549253136589, 'rl': 0.19062143752812782, 'lstm': 0.08853837451081342, 'arima': 0.023017786835139244, 'prophet': 0.32889816694888746, 'transformer': 0.08853837451081342, 'bitcoin_forecast': 0.17743856083703335}}
2024-09-20 12:26:50 - INFO - 모델별 가중치:
2024-09-20 12:26:50 - INFO -   - GPT: 0.0030
2024-09-20 12:26:50 - INFO -   - ML: 0.0637
2024-09-20 12:26:50 - INFO -   - XGBOOST: 0.0363
2024-09-20 12:26:50 - INFO -   - RL: 0.1906
2024-09-20 12:26:50 - INFO -   - LSTM: 0.0885
2024-09-20 12:26:50 - INFO -   - ARIMA: 0.0230
2024-09-20 12:26:50 - INFO -   - PROPHET: 0.3289
2024-09-20 12:26:50 - INFO -   - TRANSFORMER: 0.0885
2024-09-20 12:26:50 - INFO -   - BITCOIN_FORECAST: 0.1774
2024-09-20 12:26:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:26:50 - INFO - 6. 거래 실행
2024-09-20 12:26:50 - INFO - Cancelling existing orders.
2024-09-20 12:26:50 - INFO - Cancelled 0 orders.
2024-09-20 12:26:50 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84424650.66510911, 'current_price': 84510000.0, 'predictions': {'gpt': 84510000.0, 'ml': 84290274.0, 'xgboost': 84510000.0, 'lstm': 84263320.20598246, 'rl': 85355100.0, 'arima': 84140000.0, 'prophet': 84579836.47548729, 'transformer': 84212591.29670343, 'bitcoin_forecast': 83389971.71958429}, 'weights': {'gpt': 0.0029847876706004224, 'ml': 0.06365701862721893, 'xgboost': 0.03630549253136589, 'rl': 0.19062143752812782, 'lstm': 0.08853837451081342, 'arima': 0.023017786835139244, 'prophet': 0.32889816694888746, 'transformer': 0.08853837451081342, 'bitcoin_forecast': 0.17743856083703335}}, 현재 가격=84510000.0
2024-09-20 12:26:50 - INFO - 현재 잔고: KRW=130650.32320135, BTC=0.00411149, 총 자산가치=478112.34310134995
2024-09-20 12:26:50 - INFO - 매도 시도: 0.0004111489999999999 BTC (약 34746.201989999994 KRW)
2024-09-20 12:26:50 - INFO - 주문 결과: {'uuid': '4b4e71ee-3c0e-4118-acdc-07b27fc419a6', 'side': 'ask', 'ord_type': 'limit', 'price': '84510000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:26:52+09:00', 'volume': '0.00041114', 'remaining_volume': '0.00041114', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00041114', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:26:50 - INFO - sell 주문 성공: UUID=4b4e71ee-3c0e-4118-acdc-07b27fc419a6
2024-09-20 12:26:50 - INFO - Trade executed successfully.
2024-09-20 12:26:50 - INFO - 7. summary 리포트 보내기
2024-09-20 12:26:51 - INFO - Message sent to Discord successfully.
2024-09-20 12:26:51 - INFO - Trading cycle completed.
2024-09-20 12:26:51 - INFO - Performing periodic update.
2024-09-20 12:26:51 - INFO - 계산된 시장 변동성: 0.030252124606789863
2024-09-20 12:35:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:35:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8120-9c00-c292ca5d2081 "HTTP/1.1 200 OK"
2024-09-20 12:35:45 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:35:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:35:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d3-b20f-c21ffadcde92 "HTTP/1.1 200 OK"
2024-09-20 12:35:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:35:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:35:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c6-8e0e-d697a969c500 "HTTP/1.1 200 OK"
2024-09-20 12:35:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a6-a7bd-c0b4d5c34e8d "HTTP/1.1 200 OK"
2024-09-20 12:36:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8151-aa03-d561dcca2792 "HTTP/1.1 200 OK"
2024-09-20 12:36:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8152-ab1c-cb1e78161a54 "HTTP/1.1 200 OK"
2024-09-20 12:36:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8127-8b9c-ef163cc26a35 "HTTP/1.1 200 OK"
2024-09-20 12:36:19 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ba-bdf9-e1fe84d60953 "HTTP/1.1 200 OK"
2024-09-20 12:36:27 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:36:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814c-a525-c803c374bb2c "HTTP/1.1 200 OK"
2024-09-20 12:36:34 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:25:34.975204
2024-09-20 12:36:34 - INFO - Starting trading cycle.
2024-09-20 12:36:34 - INFO - ##################################################
2024-09-20 12:36:34 - INFO - 17 회 예측 후 모델 재학습 검토
2024-09-20 12:36:34 - INFO - ##################################################
2024-09-20 12:36:34 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:36:34 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:36:34 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:20:00
2024-09-20 12:36:35 - INFO - 새로운 데이터 범위: 2024-09-19 03:20:00 ~ 2024-09-20 12:30:00
2024-09-20 12:36:35 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:36:35 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:36:35 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:36:35 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:36:35 - INFO - Sample date values: [Timestamp('2024-09-20 12:30:00')]
2024-09-20 12:36:35 - INFO - Successfully added 1 new data points
2024-09-20 12:36:35 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:36:35 - INFO - Final date range: 2024-09-20 12:30:00 to 2024-09-20 12:30:00
2024-09-20 12:36:35 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:36:35 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:30:00
2024-09-20 12:36:35 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:36:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:36:35 - INFO - GPT | 이전예측가격: 84510000 | 당시BTC가격: 84510000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:36:35 - INFO - ML 모델 예측 업데이트: 정확도 47.37%, 적중/전체: 9/19
2024-09-20 12:36:35 - INFO - ML | 이전예측가격: 84290274 | 당시BTC가격: 84510000 | 예측: 하락 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0347 | 반영가중치값: 0.0200 | 새 가중치: 0.0547 | 예측 총 횟수: 19 | 예측 성공 수: 9 | 예측 성공률: 47.37%
2024-09-20 12:36:35 - INFO - XGBOOST | 이전예측가격: 84510000 | 당시BTC가격: 84510000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:36:35 - INFO - LSTM 모델 예측 업데이트: 정확도 68.42%, 적중/전체: 13/19
2024-09-20 12:36:35 - INFO - LSTM | 이전예측가격: 84263320 | 당시BTC가격: 84510000 | 예측: 하락 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1536 | 반영가중치값: 0.0200 | 새 가중치: 0.1736 | 예측 총 횟수: 19 | 예측 성공 수: 13 | 예측 성공률: 68.42%
2024-09-20 12:36:35 - INFO - RL 모델 예측 업데이트: 정확도 54.62%, 적중/전체: 65/119
2024-09-20 12:36:35 - INFO - RL | 이전예측가격: 85355100 | 당시BTC가격: 84510000 | 예측: 상승 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1493 | 반영가중치값: -0.0200 | 새 가중치: 0.1293 | 예측 총 횟수: 119 | 예측 성공 수: 65 | 예측 성공률: 54.62%
2024-09-20 12:36:35 - INFO - ARIMA 모델 예측 업데이트: 정확도 57.89%, 적중/전체: 22/38
2024-09-20 12:36:35 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84510000 | 예측: 하락 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1124 | 반영가중치값: 0.0200 | 새 가중치: 0.1324 | 예측 총 횟수: 38 | 예측 성공 수: 22 | 예측 성공률: 57.89%
2024-09-20 12:36:35 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.26%, 적중/전체: 64/108
2024-09-20 12:36:35 - INFO - PROPHET | 이전예측가격: 84579836 | 당시BTC가격: 84510000 | 예측: 상승 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2444 | 반영가중치값: -0.0200 | 새 가중치: 0.2244 | 예측 총 횟수: 108 | 예측 성공 수: 64 | 예측 성공률: 59.26%
2024-09-20 12:36:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 68.42%, 적중/전체: 13/19
2024-09-20 12:36:35 - INFO - TRANSFORMER | 이전예측가격: 84212591 | 당시BTC가격: 84510000 | 예측: 하락 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1812 | 반영가중치값: 0.0200 | 새 가중치: 0.2012 | 예측 총 횟수: 19 | 예측 성공 수: 13 | 예측 성공률: 68.42%
2024-09-20 12:36:35 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 59.32%, 적중/전체: 35/59
2024-09-20 12:36:35 - INFO - BITCOIN_FORECAST | 이전예측가격: 83389972 | 당시BTC가격: 84510000 | 예측: 하락 | 지금 BTC가격: 84498000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0869 | 반영가중치값: 0.0200 | 새 가중치: 0.1069 | 예측 총 횟수: 59 | 예측 성공 수: 35 | 예측 성공률: 59.32%
2024-09-20 12:36:35 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:36:35 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:36:35 - INFO - 새로운 가중치: {'gpt': 0.002811157299101302, 'ml': 0.051546112323620906, 'xgboost': 0.03419353789627738, 'rl': 0.12174806578456455, 'lstm': 0.1634946456682897, 'arima': 0.12473893807737556, 'prophet': 0.21130309806265202, 'transformer': 0.18947130312412222, 'bitcoin_forecast': 0.10069314176399634}
2024-09-20 12:36:35 - INFO - XGBoost 모델 성능: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:36:35 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:36:35 - INFO - Current BTC price: 84498000.0
2024-09-20 12:36:35 - INFO - Analyzing market conditions.
2024-09-20 12:36:35 - INFO - Market analysis: {'current_price': 84498000.0, 'sma_20': 83974450.0, 'rsi_14': 63.146919346049906, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 12:36:35 - INFO - Starting predictions for all models
2024-09-20 12:36:35 - INFO - Attempting prediction for gpt
2024-09-20 12:36:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:36:35 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:36:35 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:36:35 - INFO - GPT prediction: 84498000.0
2024-09-20 12:36:35 - INFO - Attempting prediction for ml
2024-09-20 12:36:35 - INFO - ML prediction: 84362803.2
2024-09-20 12:36:35 - INFO - Attempting prediction for xgboost
2024-09-20 12:36:35 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:36:35 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:36:35 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:36:35 - INFO - XGBOOST prediction: 84498000.0
2024-09-20 12:36:35 - INFO - Attempting prediction for lstm
2024-09-20 12:36:35 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:36:35 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:36:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:36:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:36:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:36:35 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:36:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:36:35 - INFO - X 샘플:
[[-0.24362468 -0.28560807 -0.19659148 -0.48372461 -0.4971698  -0.49735566
  -0.48372461]
 [-0.86794226 -0.99287096 -0.70764689 -0.83811847 -0.66436839 -0.66601835
  -0.83811847]
 [-0.83977756 -1.17757019 -1.39592313 -1.29837024 -0.04555537 -0.05382055
  -1.29837024]
 [-0.90080108 -0.72708427 -0.6540685  -0.51133971 -1.00688882 -1.00587698
  -0.51133971]
 [-0.53935406 -0.85322033 -0.6540685  -1.06364183 -1.06669528 -1.06540594
  -1.06364183]
 [-1.04631872 -0.72708427 -0.86013923 -0.44230195  0.06406793  0.05789512
  -0.44230195]
 [ 0.11312822  1.14693715  0.37628515  0.72673754  2.31534476  2.3134044
   0.72673754]
 [ 1.28665752  0.98476222  1.00686159  0.9752735  -0.11009668 -0.10619167
   0.9752735 ]
 [ 1.54952808  1.3947044   1.51379558  1.49535799  1.30230624  1.30829351
   1.49535799]
 [ 1.48850455  1.23703433  1.57149539  1.44012778 -0.29094458 -0.28492387
   1.44012778]]
2024-09-20 12:36:35 - INFO - y 샘플:
[1.44012778]
2024-09-20 12:36:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:36:35 - INFO - 모델 출력 (스케일링된 예측): [[0.55160856]]
2024-09-20 12:36:35 - INFO - 스케일러 역변환 후 예측 가격: 84304949.30886358
2024-09-20 12:36:35 - INFO - LSTMPredictor 최종 예측 가격: 84304949.30886358
2024-09-20 12:36:35 - INFO - LSTM prediction: 84304949.30886358
2024-09-20 12:36:35 - INFO - Attempting prediction for rl
2024-09-20 12:36:35 - INFO - Preparing state for RL agent.
2024-09-20 12:36:35 - INFO - Prepared state: [[ 8.44980000e+07  1.27051551e+01 -1.41995030e-04  8.39744500e+07
   6.31469193e+01]]
2024-09-20 12:36:35 - INFO - RL prediction: 85342980.0
2024-09-20 12:36:35 - INFO - Attempting prediction for arima
2024-09-20 12:36:35 - INFO - ARIMA 예측 시작
2024-09-20 12:36:35 - INFO - 입력 데이터: {'open': 84496000.0, 'high': 84536000.0, 'low': 84490000.0, 'close': 84498000.0, 'volume': 12.70515505, 'value': 1073789181.6481, 'decision': 'sell', 'sma': 83974450.0, 'ema': 84108821.24339838, 'rsi': 63.146919346049906, 'macd': 117882.99077619612, 'signal_line': 39683.40035427566, 'BB_Upper': 84581926.57568273, 'BB_Lower': 83366973.42431727}
2024-09-20 12:36:35 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:36:35 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  83974450.0         0         0
2024-09-20 12:36:35 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  83974450.0         0         0
2024-09-20 12:36:35 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 12:36:35 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 12:36:35 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 12:36:35 - INFO - ARIMA prediction: 84140000.0
2024-09-20 12:36:35 - INFO - Attempting prediction for prophet
2024-09-20 12:36:36 - INFO - PROPHET prediction: 84558074.2295332
2024-09-20 12:36:36 - INFO - Attempting prediction for transformer
2024-09-20 12:36:36 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:36:36 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:36:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:36:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:36:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:36:36 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:36:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:36:36 - INFO - X 샘플:
[[-0.24362468 -0.28560807 -0.19659148 -0.48372461 -0.4971698  -0.49735566
  -0.48372461 -0.48372461  0.          0.          0.         -0.48372461
  -0.48372461]
 [-0.86794226 -0.99287096 -0.70764689 -0.83811847 -0.66436839 -0.66601835
  -0.83811847 -0.83811847  0.          0.          0.         -0.83811847
  -0.83811847]
 [-0.83977756 -1.17757019 -1.39592313 -1.29837024 -0.04555537 -0.05382055
  -1.29837024 -1.29837024  0.          0.          0.         -1.29837024
  -1.29837024]
 [-0.90080108 -0.72708427 -0.6540685  -0.51133971 -1.00688882 -1.00587698
  -0.51133971 -0.51133971  0.          0.          0.         -0.51133971
  -0.51133971]
 [-0.53935406 -0.85322033 -0.6540685  -1.06364183 -1.06669528 -1.06540594
  -1.06364183 -1.06364183  0.          0.          0.         -1.06364183
  -1.06364183]
 [-1.04631872 -0.72708427 -0.86013923 -0.44230195  0.06406793  0.05789512
  -0.44230195 -0.44230195  0.          0.          0.         -0.44230195
  -0.44230195]
 [ 0.11312822  1.14693715  0.37628515  0.72673754  2.31534476  2.3134044
   0.72673754  0.72673754  0.          0.          0.          0.72673754
   0.72673754]
 [ 1.28665752  0.98476222  1.00686159  0.9752735  -0.11009668 -0.10619167
   0.9752735   0.9752735   0.          0.          0.          0.9752735
   0.9752735 ]
 [ 1.54952808  1.3947044   1.51379558  1.49535799  1.30230624  1.30829351
   1.49535799  1.49535799  0.          0.          0.          1.49535799
   1.49535799]
 [ 1.48850455  1.23703433  1.57149539  1.44012778 -0.29094458 -0.28492387
   1.44012778  1.44012778  0.          0.          0.          1.44012778
   1.44012778]]
2024-09-20 12:36:36 - INFO - y 샘플:
[1.44012778]
2024-09-20 12:36:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:36:36 - INFO - 모델 출력 (스케일링된 예측): [0.3122576]
2024-09-20 12:36:36 - INFO - 스케일러 역변환 후 예측 가격: 84252944.95137429
2024-09-20 12:36:36 - INFO - TransformerPredictor 최종 예측 가격: 84252944.95137429
2024-09-20 12:36:36 - INFO - TRANSFORMER prediction: 84252944.95137429
2024-09-20 12:36:36 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:36:36 - INFO - BITCOIN_FORECAST prediction: 83235352.06584711
2024-09-20 12:36:36 - INFO - BitcoinForecast prediction: 83235352.06584711
2024-09-20 12:36:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:36:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:36:41 - INFO - 조정된 모델 가중치: {'gpt': 0.002811157299101302, 'ml': 0.051546112323620906, 'xgboost': 0.03419353789627738, 'rl': 0.12174806578456455, 'lstm': 0.1634946456682897, 'arima': 0.12473893807737556, 'prophet': 0.21130309806265202, 'transformer': 0.18947130312412222, 'bitcoin_forecast': 0.10069314176399634}
2024-09-20 12:36:41 - INFO - 조정된 모델 가중치: {'gpt': 0.002811157299101302, 'ml': 0.051546112323620906, 'xgboost': 0.03419353789627738, 'rl': 0.12174806578456455, 'lstm': 0.1634946456682897, 'arima': 0.12473893807737556, 'prophet': 0.21130309806265202, 'transformer': 0.18947130312412222, 'bitcoin_forecast': 0.10069314176399634}
2024-09-20 12:36:41 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84356809.50099514, 'current_price': 84498000.0, 'predictions': {'gpt': 84498000.0, 'ml': 84362803.2, 'xgboost': 84498000.0, 'lstm': 84304949.30886358, 'rl': 85342980.0, 'arima': 84140000.0, 'prophet': 84558074.2295332, 'transformer': 84252944.95137429, 'bitcoin_forecast': 83235352.06584711}, 'weights': {'gpt': 0.002811157299101302, 'ml': 0.051546112323620906, 'xgboost': 0.03419353789627738, 'rl': 0.12174806578456455, 'lstm': 0.1634946456682897, 'arima': 0.12473893807737556, 'prophet': 0.21130309806265202, 'transformer': 0.18947130312412222, 'bitcoin_forecast': 0.10069314176399634}}
2024-09-20 12:36:41 - INFO - 모델별 가중치:
2024-09-20 12:36:41 - INFO -   - GPT: 0.0028
2024-09-20 12:36:41 - INFO -   - ML: 0.0515
2024-09-20 12:36:41 - INFO -   - XGBOOST: 0.0342
2024-09-20 12:36:41 - INFO -   - RL: 0.1217
2024-09-20 12:36:41 - INFO -   - LSTM: 0.1635
2024-09-20 12:36:41 - INFO -   - ARIMA: 0.1247
2024-09-20 12:36:41 - INFO -   - PROPHET: 0.2113
2024-09-20 12:36:41 - INFO -   - TRANSFORMER: 0.1895
2024-09-20 12:36:41 - INFO -   - BITCOIN_FORECAST: 0.1007
2024-09-20 12:36:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:36:42 - INFO - 6. 거래 실행
2024-09-20 12:36:42 - INFO - Cancelling existing orders.
2024-09-20 12:36:42 - INFO - Cancelled 0 orders.
2024-09-20 12:36:42 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84356809.50099514, 'current_price': 84498000.0, 'predictions': {'gpt': 84498000.0, 'ml': 84362803.2, 'xgboost': 84498000.0, 'lstm': 84304949.30886358, 'rl': 85342980.0, 'arima': 84140000.0, 'prophet': 84558074.2295332, 'transformer': 84252944.95137429, 'bitcoin_forecast': 83235352.06584711}, 'weights': {'gpt': 0.002811157299101302, 'ml': 0.051546112323620906, 'xgboost': 0.03419353789627738, 'rl': 0.12174806578456455, 'lstm': 0.1634946456682897, 'arima': 0.12473893807737556, 'prophet': 0.21130309806265202, 'transformer': 0.18947130312412222, 'bitcoin_forecast': 0.10069314176399634}}, 현재 가격=84498000.0
2024-09-20 12:36:42 - INFO - 현재 잔고: KRW=165378.39188065, BTC=0.00370035, 총 자산가치=478050.56618065
2024-09-20 12:36:42 - INFO - 매도 시도: 0.00037003500000000006 BTC (약 31267.217430000004 KRW)
2024-09-20 12:36:42 - INFO - 주문 결과: {'uuid': '948b4d89-42c1-4967-863e-1241ab583b0d', 'side': 'ask', 'ord_type': 'limit', 'price': '84498000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:36:43+09:00', 'volume': '0.00037003', 'remaining_volume': '0.00037003', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00037003', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:36:42 - INFO - sell 주문 성공: UUID=948b4d89-42c1-4967-863e-1241ab583b0d
2024-09-20 12:36:42 - INFO - Trade executed successfully.
2024-09-20 12:36:42 - INFO - 7. summary 리포트 보내기
2024-09-20 12:36:42 - INFO - Message sent to Discord successfully.
2024-09-20 12:36:42 - INFO - Trading cycle completed.
2024-09-20 12:36:42 - INFO - Performing periodic update.
2024-09-20 12:36:42 - INFO - 계산된 시장 변동성: 0.02995310347286064
2024-09-20 12:45:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:45:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8195-82dd-d7bed0163d57 "HTTP/1.1 200 OK"
2024-09-20 12:45:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:45:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:45:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81fa-b678-c25c2fa1619b "HTTP/1.1 200 OK"
2024-09-20 12:45:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:45:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:45:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ef-93f2-d8e008167812 "HTTP/1.1 200 OK"
2024-09-20 12:45:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8186-bb3a-fa2c80440de1 "HTTP/1.1 200 OK"
2024-09-20 12:46:04 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:11 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81df-9849-c36e6e88c25b "HTTP/1.1 200 OK"
2024-09-20 12:46:11 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a0-a58f-c086df2d3f46 "HTTP/1.1 200 OK"
2024-09-20 12:46:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8111-a3ac-cae9200e62c8 "HTTP/1.1 200 OK"
2024-09-20 12:46:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e1-86c7-f598b7c5e18e "HTTP/1.1 200 OK"
2024-09-20 12:46:27 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:46:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8193-b301-db2816706c23 "HTTP/1.1 200 OK"
2024-09-20 12:46:33 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:35:34.975405
2024-09-20 12:46:33 - INFO - Starting trading cycle.
2024-09-20 12:46:33 - INFO - ##################################################
2024-09-20 12:46:33 - INFO - 18 회 예측 후 모델 재학습 검토
2024-09-20 12:46:33 - INFO - ##################################################
2024-09-20 12:46:33 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:46:33 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:46:33 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:30:00
2024-09-20 12:46:34 - INFO - 새로운 데이터 범위: 2024-09-19 03:30:00 ~ 2024-09-20 12:40:00
2024-09-20 12:46:34 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:46:34 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:46:34 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:46:34 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:46:34 - INFO - Sample date values: [Timestamp('2024-09-20 12:40:00')]
2024-09-20 12:46:34 - INFO - Successfully added 1 new data points
2024-09-20 12:46:34 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:46:34 - INFO - Final date range: 2024-09-20 12:40:00 to 2024-09-20 12:40:00
2024-09-20 12:46:34 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:46:34 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:40:00
2024-09-20 12:46:34 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:46:34 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:46:34 - INFO - GPT | 이전예측가격: 84498000 | 당시BTC가격: 84498000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:46:34 - INFO - ML 모델 예측 업데이트: 정확도 45.00%, 적중/전체: 9/20
2024-09-20 12:46:34 - INFO - ML | 이전예측가격: 84362803 | 당시BTC가격: 84498000 | 예측: 하락 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0637 | 반영가중치값: -0.0200 | 새 가중치: 0.0437 | 예측 총 횟수: 20 | 예측 성공 수: 9 | 예측 성공률: 45.00%
2024-09-20 12:46:34 - INFO - XGBOOST | 이전예측가격: 84498000 | 당시BTC가격: 84498000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:46:34 - INFO - LSTM 모델 예측 업데이트: 정확도 65.00%, 적중/전체: 13/20
2024-09-20 12:46:34 - INFO - LSTM | 이전예측가격: 84304949 | 당시BTC가격: 84498000 | 예측: 하락 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0885 | 반영가중치값: -0.0200 | 새 가중치: 0.0685 | 예측 총 횟수: 20 | 예측 성공 수: 13 | 예측 성공률: 65.00%
2024-09-20 12:46:34 - INFO - RL 모델 예측 업데이트: 정확도 55.00%, 적중/전체: 66/120
2024-09-20 12:46:34 - INFO - RL | 이전예측가격: 85342980 | 당시BTC가격: 84498000 | 예측: 상승 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1906 | 반영가중치값: 0.0200 | 새 가중치: 0.2106 | 예측 총 횟수: 120 | 예측 성공 수: 66 | 예측 성공률: 55.00%
2024-09-20 12:46:34 - INFO - ARIMA 모델 예측 업데이트: 정확도 56.41%, 적중/전체: 22/39
2024-09-20 12:46:34 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84498000 | 예측: 하락 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0230 | 반영가중치값: -0.0200 | 새 가중치: 0.0030 | 예측 총 횟수: 39 | 예측 성공 수: 22 | 예측 성공률: 56.41%
2024-09-20 12:46:34 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.63%, 적중/전체: 65/109
2024-09-20 12:46:34 - INFO - PROPHET | 이전예측가격: 84558074 | 당시BTC가격: 84498000 | 예측: 상승 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3289 | 반영가중치값: 0.0200 | 새 가중치: 0.3489 | 예측 총 횟수: 109 | 예측 성공 수: 65 | 예측 성공률: 59.63%
2024-09-20 12:46:34 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 65.00%, 적중/전체: 13/20
2024-09-20 12:46:34 - INFO - TRANSFORMER | 이전예측가격: 84252945 | 당시BTC가격: 84498000 | 예측: 하락 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0885 | 반영가중치값: -0.0200 | 새 가중치: 0.0685 | 예측 총 횟수: 20 | 예측 성공 수: 13 | 예측 성공률: 65.00%
2024-09-20 12:46:34 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 35/60
2024-09-20 12:46:34 - INFO - BITCOIN_FORECAST | 이전예측가격: 83235352 | 당시BTC가격: 84498000 | 예측: 하락 | 지금 BTC가격: 84696000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1774 | 반영가중치값: -0.0200 | 새 가중치: 0.1574 | 예측 총 횟수: 60 | 예측 성공 수: 35 | 예측 성공률: 58.33%
2024-09-20 12:46:34 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:46:34 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:46:34 - INFO - 새로운 가중치: {'gpt': 0.002997882142102989, 'ml': 0.04655683855251987, 'xgboost': 0.03646476725700926, 'rl': 0.22461149595274962, 'lstm': 0.07309088291161112, 'arima': 0.0032182365834276363, 'prophet': 0.3720729481921621, 'transformer': 0.07309088291161112, 'bitcoin_forecast': 0.1678960654968063}
2024-09-20 12:46:34 - INFO - XGBoost 모델 성능: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:46:34 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:46:34 - INFO - Current BTC price: 84696000.0
2024-09-20 12:46:34 - INFO - Analyzing market conditions.
2024-09-20 12:46:34 - INFO - Market analysis: {'current_price': 84696000.0, 'sma_20': 84026750.0, 'rsi_14': 67.23084603680817, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 12:46:34 - INFO - Starting predictions for all models
2024-09-20 12:46:34 - INFO - Attempting prediction for gpt
2024-09-20 12:46:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:46:34 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:46:34 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:46:34 - INFO - GPT prediction: 84696000.0
2024-09-20 12:46:34 - INFO - Attempting prediction for ml
2024-09-20 12:46:34 - INFO - ML prediction: 84492729.60000001
2024-09-20 12:46:34 - INFO - Attempting prediction for xgboost
2024-09-20 12:46:34 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:46:34 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:46:34 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:46:34 - INFO - XGBOOST prediction: 84696000.0
2024-09-20 12:46:34 - INFO - Attempting prediction for lstm
2024-09-20 12:46:34 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:46:34 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:46:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:46:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:46:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:46:34 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:46:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:46:34 - INFO - X 샘플:
[[-0.95083771 -1.05658605 -0.80339817 -0.93174206 -0.80002785 -0.80177903
  -0.93174206]
 [-0.92572756 -1.21667484 -1.42714292 -1.31407364 -0.21153229 -0.22014962
  -1.31407364]
 [-0.98013289 -0.82621437 -0.75484319 -0.66028664 -1.1257672  -1.12466777
  -0.66028664]
 [-0.65788595 -0.9355433  -0.75484319 -1.11908454 -1.18264356 -1.18122432
  -1.11908454]
 [-1.10986867 -0.82621437 -0.94159312 -0.6029369  -0.10727975 -0.11401216
  -0.6029369 ]
 [-0.07616746  0.79810121  0.17890643  0.36818531  2.03370045  2.02887456
   0.36818531]
 [ 0.97008883  0.65753544  0.75036119  0.57464437 -0.27291152 -0.26990574
   0.57464437]
 [ 1.20445023  1.01285447  1.20976601  1.00667905  1.07029365  1.07395107
   1.00667905]
 [ 1.15004491  0.87619331  1.26205599  0.96079926 -0.44489916 -0.43971343
   0.96079926]
 [ 1.37603627  1.51654849  1.28073098  1.71781579  1.04106725  1.04862643
   1.71781579]]
2024-09-20 12:46:34 - INFO - y 샘플:
[1.71781579]
2024-09-20 12:46:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:46:34 - INFO - 모델 출력 (스케일링된 예측): [[0.571959]]
2024-09-20 12:46:34 - INFO - 스케일러 역변환 후 예측 가격: 84396297.6389776
2024-09-20 12:46:34 - INFO - LSTMPredictor 최종 예측 가격: 84396297.6389776
2024-09-20 12:46:34 - INFO - LSTM prediction: 84396297.6389776
2024-09-20 12:46:34 - INFO - Attempting prediction for rl
2024-09-20 12:46:34 - INFO - Preparing state for RL agent.
2024-09-20 12:46:34 - INFO - Prepared state: [[8.46960000e+07 2.47466860e+01 2.34325073e-03 8.40267500e+07
  6.72308460e+01]]
2024-09-20 12:46:34 - INFO - RL prediction: 85542960.0
2024-09-20 12:46:34 - INFO - Attempting prediction for arima
2024-09-20 12:46:34 - INFO - ARIMA 예측 시작
2024-09-20 12:46:34 - INFO - 입력 데이터: {'open': 84550000.0, 'high': 84700000.0, 'low': 84495000.0, 'close': 84696000.0, 'volume': 24.74668598, 'value': 2094385122.20439, 'decision': 'sell', 'sma': 84026750.0, 'ema': 84164743.02974139, 'rsi': 67.23084603680817, 'macd': 148684.30403098464, 'signal_line': 61483.58108961746, 'BB_Upper': 84690948.72779284, 'BB_Lower': 83362551.27220716}
2024-09-20 12:46:34 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:46:34 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84026750.0         0         0
2024-09-20 12:46:34 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84026750.0         0         0
2024-09-20 12:46:34 - INFO - ARIMA 예측 결과: 4980    8.414000e+09
dtype: float64
2024-09-20 12:46:34 - INFO - 신뢰 구간: [[8.12470178e+09 8.70329822e+09]]
2024-09-20 12:46:34 - INFO - 최종 ARIMA 예측값: 84140000.0
2024-09-20 12:46:34 - INFO - ARIMA prediction: 84140000.0
2024-09-20 12:46:34 - INFO - Attempting prediction for prophet
2024-09-20 12:46:35 - INFO - PROPHET prediction: 84784952.66930684
2024-09-20 12:46:35 - INFO - Attempting prediction for transformer
2024-09-20 12:46:35 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:46:35 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:46:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:46:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:46:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:46:35 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:46:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:46:35 - INFO - X 샘플:
[[-0.95083771 -1.05658605 -0.80339817 -0.93174206 -0.80002785 -0.80177903
  -0.93174206 -0.93174206  0.          0.          0.         -0.93174206
  -0.93174206]
 [-0.92572756 -1.21667484 -1.42714292 -1.31407364 -0.21153229 -0.22014962
  -1.31407364 -1.31407364  0.          0.          0.         -1.31407364
  -1.31407364]
 [-0.98013289 -0.82621437 -0.75484319 -0.66028664 -1.1257672  -1.12466777
  -0.66028664 -0.66028664  0.          0.          0.         -0.66028664
  -0.66028664]
 [-0.65788595 -0.9355433  -0.75484319 -1.11908454 -1.18264356 -1.18122432
  -1.11908454 -1.11908454  0.          0.          0.         -1.11908454
  -1.11908454]
 [-1.10986867 -0.82621437 -0.94159312 -0.6029369  -0.10727975 -0.11401216
  -0.6029369  -0.6029369   0.          0.          0.         -0.6029369
  -0.6029369 ]
 [-0.07616746  0.79810121  0.17890643  0.36818531  2.03370045  2.02887456
   0.36818531  0.36818531  0.          0.          0.          0.36818531
   0.36818531]
 [ 0.97008883  0.65753544  0.75036119  0.57464437 -0.27291152 -0.26990574
   0.57464437  0.57464437  0.          0.          0.          0.57464437
   0.57464437]
 [ 1.20445023  1.01285447  1.20976601  1.00667905  1.07029365  1.07395107
   1.00667905  1.00667905  0.          0.          0.          1.00667905
   1.00667905]
 [ 1.15004491  0.87619331  1.26205599  0.96079926 -0.44489916 -0.43971343
   0.96079926  0.96079926  0.          0.          0.          0.96079926
   0.96079926]
 [ 1.37603627  1.51654849  1.28073098  1.71781579  1.04106725  1.04862643
   1.71781579  1.71781579  0.          0.          0.          1.71781579
   1.71781579]]
2024-09-20 12:46:35 - INFO - y 샘플:
[1.71781579]
2024-09-20 12:46:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:46:35 - INFO - 모델 출력 (스케일링된 예측): [0.31313306]
2024-09-20 12:46:35 - INFO - 스케일러 역변환 후 예측 가격: 84328600.91434725
2024-09-20 12:46:35 - INFO - TransformerPredictor 최종 예측 가격: 84328600.91434725
2024-09-20 12:46:35 - INFO - TRANSFORMER prediction: 84328600.91434725
2024-09-20 12:46:35 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:46:35 - INFO - BITCOIN_FORECAST prediction: 83420402.69350865
2024-09-20 12:46:35 - INFO - BitcoinForecast prediction: 83420402.69350865
2024-09-20 12:46:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:46:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:46:41 - INFO - 조정된 모델 가중치: {'gpt': 0.002997882142102989, 'ml': 0.04655683855251987, 'xgboost': 0.03646476725700926, 'rl': 0.22461149595274962, 'lstm': 0.07309088291161112, 'arima': 0.0032182365834276363, 'prophet': 0.3720729481921621, 'transformer': 0.07309088291161112, 'bitcoin_forecast': 0.1678960654968063}
2024-09-20 12:46:41 - INFO - 조정된 모델 가중치: {'gpt': 0.002997882142102989, 'ml': 0.04655683855251987, 'xgboost': 0.03646476725700926, 'rl': 0.22461149595274962, 'lstm': 0.07309088291161112, 'arima': 0.0032182365834276363, 'prophet': 0.3720729481921621, 'transformer': 0.07309088291161112, 'bitcoin_forecast': 0.1678960654968063}
2024-09-20 12:46:41 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84645154.06514768, 'current_price': 84696000.0, 'predictions': {'gpt': 84696000.0, 'ml': 84492729.60000001, 'xgboost': 84696000.0, 'lstm': 84396297.6389776, 'rl': 85542960.0, 'arima': 84140000.0, 'prophet': 84784952.66930684, 'transformer': 84328600.91434725, 'bitcoin_forecast': 83420402.69350865}, 'weights': {'gpt': 0.002997882142102989, 'ml': 0.04655683855251987, 'xgboost': 0.03646476725700926, 'rl': 0.22461149595274962, 'lstm': 0.07309088291161112, 'arima': 0.0032182365834276363, 'prophet': 0.3720729481921621, 'transformer': 0.07309088291161112, 'bitcoin_forecast': 0.1678960654968063}}
2024-09-20 12:46:41 - INFO - 모델별 가중치:
2024-09-20 12:46:41 - INFO -   - GPT: 0.0030
2024-09-20 12:46:41 - INFO -   - ML: 0.0466
2024-09-20 12:46:41 - INFO -   - XGBOOST: 0.0365
2024-09-20 12:46:41 - INFO -   - RL: 0.2246
2024-09-20 12:46:41 - INFO -   - LSTM: 0.0731
2024-09-20 12:46:41 - INFO -   - ARIMA: 0.0032
2024-09-20 12:46:41 - INFO -   - PROPHET: 0.3721
2024-09-20 12:46:41 - INFO -   - TRANSFORMER: 0.0731
2024-09-20 12:46:41 - INFO -   - BITCOIN_FORECAST: 0.1679
2024-09-20 12:46:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:46:41 - INFO - 6. 거래 실행
2024-09-20 12:46:41 - INFO - Cancelling existing orders.
2024-09-20 12:46:41 - INFO - Cancelled 0 orders.
2024-09-20 12:46:41 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84645154.06514768, 'current_price': 84696000.0, 'predictions': {'gpt': 84696000.0, 'ml': 84492729.60000001, 'xgboost': 84696000.0, 'lstm': 84396297.6389776, 'rl': 85542960.0, 'arima': 84140000.0, 'prophet': 84784952.66930684, 'transformer': 84328600.91434725, 'bitcoin_forecast': 83420402.69350865}, 'weights': {'gpt': 0.002997882142102989, 'ml': 0.04655683855251987, 'xgboost': 0.03646476725700926, 'rl': 0.22461149595274962, 'lstm': 0.07309088291161112, 'arima': 0.0032182365834276363, 'prophet': 0.3720729481921621, 'transformer': 0.07309088291161112, 'bitcoin_forecast': 0.1678960654968063}}, 현재 가격=84696000.0
2024-09-20 12:46:41 - INFO - 현재 잔고: KRW=196641.01861772, BTC=0.00333032, 총 자산가치=478705.80133772
2024-09-20 12:46:41 - INFO - 매도 시도: 0.00033303200000000003 BTC (약 28206.478272000004 KRW)
2024-09-20 12:46:42 - INFO - 주문 결과: {'uuid': 'afaec85e-9a4d-4a30-a753-ea59e75b0a82', 'side': 'ask', 'ord_type': 'limit', 'price': '84696000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:46:43+09:00', 'volume': '0.00033303', 'remaining_volume': '0.00033303', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00033303', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:46:42 - INFO - sell 주문 성공: UUID=afaec85e-9a4d-4a30-a753-ea59e75b0a82
2024-09-20 12:46:42 - INFO - Trade executed successfully.
2024-09-20 12:46:42 - INFO - 7. summary 리포트 보내기
2024-09-20 12:46:42 - INFO - Message sent to Discord successfully.
2024-09-20 12:46:42 - INFO - Trading cycle completed.
2024-09-20 12:46:42 - INFO - Performing periodic update.
2024-09-20 12:46:42 - INFO - 계산된 시장 변동성: 0.02973817007552165
2024-09-20 12:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:55:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5e6ae8d1-12e7-4678-a4a8-c6dbec4e3991 "HTTP/1.1 200 OK"
2024-09-20 12:55:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:55:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:55:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8192-ab95-f7e8535d6031 "HTTP/1.1 200 OK"
2024-09-20 12:55:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:55:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:55:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a5-9bcd-c0148b32fc0c "HTTP/1.1 200 OK"
2024-09-20 12:55:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d5-98f5-f08bdffc6335 "HTTP/1.1 200 OK"
2024-09-20 12:56:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:08 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ee-8218-c0d75d6e84d7 "HTTP/1.1 200 OK"
2024-09-20 12:56:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8102-ac33-ddb476a66856 "HTTP/1.1 200 OK"
2024-09-20 12:56:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a8-8daa-de9427f93aa4 "HTTP/1.1 200 OK"
2024-09-20 12:56:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810a-ab33-f1e6d9124137 "HTTP/1.1 200 OK"
2024-09-20 12:56:29 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 12:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8175-be7c-edd4313fa9e0 "HTTP/1.1 200 OK"
2024-09-20 12:56:36 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:45:34.975709
2024-09-20 12:56:36 - INFO - Starting trading cycle.
2024-09-20 12:56:36 - INFO - ##################################################
2024-09-20 12:56:36 - INFO - 19 회 예측 후 모델 재학습 검토
2024-09-20 12:56:36 - INFO - ##################################################
2024-09-20 12:56:36 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 12:56:36 - INFO - 데이터베이스 업데이트 시작
2024-09-20 12:56:36 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:40:00
2024-09-20 12:56:36 - INFO - 새로운 데이터 범위: 2024-09-19 03:40:00 ~ 2024-09-20 12:50:00
2024-09-20 12:56:36 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 12:56:36 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 12:56:36 - INFO - Index: Index([199], dtype='int64')
2024-09-20 12:56:36 - INFO - Date column data type: datetime64[ns]
2024-09-20 12:56:36 - INFO - Sample date values: [Timestamp('2024-09-20 12:50:00')]
2024-09-20 12:56:37 - INFO - Successfully added 1 new data points
2024-09-20 12:56:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 12:56:37 - INFO - Final date range: 2024-09-20 12:50:00 to 2024-09-20 12:50:00
2024-09-20 12:56:37 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 12:56:37 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 12:50:00
2024-09-20 12:56:37 - INFO - 데이터베이스 업데이트 완료
2024-09-20 12:56:37 - INFO - 총 20회 예측 완료. 모델 재학습 검토 시작.
2024-09-20 12:56:37 - INFO - 재학습 대상 모델: ['ml', 'rl', 'arima']
2024-09-20 12:56:37 - INFO - ml 모델 재학습 시작
2024-09-20 12:56:37 - INFO - prepare_data_for_ml 메서드 시작. 데이터 shape: (5000, 15)
2024-09-20 12:56:37 - INFO - 최종 X shape: (4999, 12), y shape: (4999,)
2024-09-20 12:56:37 - INFO - ML 모델 훈련 시작
2024-09-20 12:56:41 - INFO - ML 모델 학습 완료. MSE: 0.2634, RMSE: 0.5133, MAE: 0.4877, R2: -0.0538
2024-09-20 12:56:41 - INFO - ml 모델의 예측 통계가 초기화되었습니다.
2024-09-20 12:56:41 - INFO - ml 모델 재학습 완료
2024-09-20 12:56:41 - INFO - rl 모델 재학습 시작
2024-09-20 12:56:41 - INFO - RL 에이전트 탐험 비율 조정: epsilon=0.1
2024-09-20 12:58:10 - INFO - rl 모델의 예측 통계가 초기화되었습니다.
2024-09-20 12:58:10 - INFO - rl 모델 재학습 완료
2024-09-20 12:58:10 - INFO - arima 모델 재학습 시작
2024-09-20 12:58:10 - INFO - ARIMA 훈련 시작. 입력 데이터 타입: <class 'pandas.core.frame.DataFrame'>
2024-09-20 12:58:10 - INFO - 데이터 샘플:
                    date        open  ...      BB_Upper      BB_Lower
4999 2024-08-10 21:10:00  85560000.0  ...  8.551745e+07  8.508115e+07
4998 2024-08-10 21:20:00  85502000.0  ...  8.551745e+07  8.508115e+07
4997 2024-08-10 21:30:00  85526000.0  ...  8.551745e+07  8.508115e+07
4996 2024-08-10 21:40:00  85456000.0  ...  8.551745e+07  8.508115e+07
4995 2024-08-10 21:50:00  85410000.0  ...  8.551745e+07  8.508115e+07

[5 rows x 15 columns]
2024-09-20 12:58:10 - INFO - 전처리 후 데이터 shape: (4980, 6)
2024-09-20 12:58:10 - INFO - 전처리 후 데이터 컬럼: ['close', 'returns', 'volatility', 'sma', 'upper_bb', 'lower_bb']
2024-09-20 12:58:10 - INFO - ARIMA 모델 훈련 완료
2024-09-20 12:58:10 - INFO - arima 모델의 예측 통계가 초기화되었습니다.
2024-09-20 12:58:10 - INFO - arima 모델 재학습 완료
2024-09-20 12:58:10 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:58:10 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 12:58:10 - INFO - GPT | 이전예측가격: 84696000 | 당시BTC가격: 84696000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:58:10 - INFO - ML 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-20 12:58:10 - INFO - ML | 이전예측가격: 84492730 | 당시BTC가격: 84696000 | 예측: 하락 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0515 | 반영가중치값: -0.0200 | 새 가중치: 0.0315 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 12:58:10 - INFO - XGBOOST | 이전예측가격: 84696000 | 당시BTC가격: 84696000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 12:58:10 - INFO - LSTM 모델 예측 업데이트: 정확도 61.90%, 적중/전체: 13/21
2024-09-20 12:58:10 - INFO - LSTM | 이전예측가격: 84396298 | 당시BTC가격: 84696000 | 예측: 하락 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1635 | 반영가중치값: -0.0200 | 새 가중치: 0.1435 | 예측 총 횟수: 21 | 예측 성공 수: 13 | 예측 성공률: 61.90%
2024-09-20 12:58:10 - INFO - RL 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 1/1
2024-09-20 12:58:10 - INFO - RL | 이전예측가격: 85542960 | 당시BTC가격: 84696000 | 예측: 상승 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1217 | 반영가중치값: 0.0200 | 새 가중치: 0.1417 | 예측 총 횟수: 1 | 예측 성공 수: 1 | 예측 성공률: 100.00%
2024-09-20 12:58:10 - INFO - ARIMA 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/1
2024-09-20 12:58:10 - INFO - ARIMA | 이전예측가격: 84140000 | 당시BTC가격: 84696000 | 예측: 하락 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1247 | 반영가중치값: -0.0200 | 새 가중치: 0.1047 | 예측 총 횟수: 1 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 12:58:10 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 66/110
2024-09-20 12:58:10 - INFO - PROPHET | 이전예측가격: 84784953 | 당시BTC가격: 84696000 | 예측: 상승 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2113 | 반영가중치값: 0.0200 | 새 가중치: 0.2313 | 예측 총 횟수: 110 | 예측 성공 수: 66 | 예측 성공률: 60.00%
2024-09-20 12:58:10 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 61.90%, 적중/전체: 13/21
2024-09-20 12:58:10 - INFO - TRANSFORMER | 이전예측가격: 84328601 | 당시BTC가격: 84696000 | 예측: 하락 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1895 | 반영가중치값: -0.0200 | 새 가중치: 0.1695 | 예측 총 횟수: 21 | 예측 성공 수: 13 | 예측 성공률: 61.90%
2024-09-20 12:58:10 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 57.38%, 적중/전체: 35/61
2024-09-20 12:58:11 - INFO - BITCOIN_FORECAST | 이전예측가격: 83420403 | 당시BTC가격: 84696000 | 예측: 하락 | 지금 BTC가격: 84940000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1007 | 반영가중치값: -0.0200 | 새 가중치: 0.0807 | 예측 총 횟수: 61 | 예측 성공 수: 35 | 예측 성공률: 57.38%
2024-09-20 12:58:11 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 12:58:11 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 12:58:11 - INFO - 새로운 가중치: {'gpt': 0.0031809187123215993, 'ml': 0.033472169429853954, 'xgboost': 0.038691134277515554, 'rl': 0.15040253536225395, 'lstm': 0.1522557531911605, 'arima': 0.11113380454820149, 'prophet': 0.24542537630559444, 'transformer': 0.17981842305878315, 'bitcoin_forecast': 0.08561988511431534}
2024-09-20 12:58:11 - INFO - XGBoost 모델 성능: 정확도 60.80%, 적중/전체: 76/125
2024-09-20 12:58:11 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 12:58:11 - INFO - Current BTC price: 84940000.0
2024-09-20 12:58:11 - INFO - Analyzing market conditions.
2024-09-20 12:58:11 - INFO - Market analysis: {'current_price': 84893000.0, 'sma_20': 84101300.0, 'rsi_14': 70.70882286654704, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-20 12:58:11 - INFO - Starting predictions for all models
2024-09-20 12:58:11 - INFO - Attempting prediction for gpt
2024-09-20 12:58:11 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 12:58:11 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:58:11 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 12:58:11 - INFO - GPT prediction: 84940000.0
2024-09-20 12:58:11 - INFO - Attempting prediction for ml
2024-09-20 12:58:11 - INFO - ML prediction: 85113721.8
2024-09-20 12:58:11 - INFO - Attempting prediction for xgboost
2024-09-20 12:58:11 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 12:58:11 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:58:11 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 12:58:11 - INFO - XGBOOST prediction: 84893000.0
2024-09-20 12:58:11 - INFO - Attempting prediction for lstm
2024-09-20 12:58:11 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:58:11 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:58:11 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 12:58:11 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:58:11 - INFO - X 샘플:
[[-1.08178436 -1.34169474 -1.48441178 -1.39420852 -0.45608769 -0.46263207
  -1.39420852]
 [-1.12875563 -1.00735765 -0.91029463 -0.84322711 -1.12806144 -1.12537515
  -0.84322711]
 [-0.85054121 -1.10097204 -0.91029463 -1.22988073 -1.16986626 -1.1668143
  -1.22988073]
 [-1.24076403 -1.00735765 -1.06977162 -0.79489541 -0.37946081 -0.38486485
  -0.79489541]
 [-0.34831     0.38348464 -0.11290971  0.02352143  1.19418561  1.18523448
   0.02352143]
 [ 0.55498356  0.26312329  0.37508987  0.19751556 -0.50120218 -0.49908853
   0.19751556]
 [ 0.75732132  0.56737004  0.76740325  0.56161439  0.48606992  0.48555927
   0.56161439]
 [ 0.71035005  0.45035206  0.81205681  0.52294903 -0.62761518 -0.62350712
   0.52294903]
 [ 0.90546146  0.99866489  0.82800451  1.16092751  0.46458816  0.46700383
   1.16092751]
 [ 1.72203884  1.79438716  1.70512793  1.79568387  2.11744988  2.12448444
   1.79568387]]
2024-09-20 12:58:11 - INFO - y 샘플:
[1.79568387]
2024-09-20 12:58:11 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 12:58:11 - INFO - 모델 출력 (스케일링된 예측): [[0.6165941]]
2024-09-20 12:58:11 - INFO - 스케일러 역변환 후 예측 가격: 84527063.23726057
2024-09-20 12:58:11 - INFO - LSTMPredictor 최종 예측 가격: 84527063.23726057
2024-09-20 12:58:11 - INFO - LSTM prediction: 84527063.23726057
2024-09-20 12:58:11 - INFO - Attempting prediction for rl
2024-09-20 12:58:11 - INFO - Preparing state for RL agent.
2024-09-20 12:58:11 - INFO - Prepared state: [[8.48930000e+07 4.29694700e+01 2.32596581e-03 8.41013000e+07
  7.07088229e+01]]
2024-09-20 12:58:11 - INFO - RL prediction: 85789400.0
2024-09-20 12:58:11 - INFO - Attempting prediction for arima
2024-09-20 12:58:11 - INFO - ARIMA 예측 시작
2024-09-20 12:58:11 - INFO - 입력 데이터: {'open': 84776000.0, 'high': 84938000.0, 'low': 84770000.0, 'close': 84893000.0, 'volume': 42.96947004, 'value': 3645601062.81516, 'decision': 'sell', 'sma': 84101300.0, 'ema': 84234100.83643268, 'rsi': 70.70882286654704, 'macd': 186837.07875731587, 'signal_line': 86554.28062315714, 'BB_Upper': 84801974.27525435, 'BB_Lower': 83400625.72474565}
2024-09-20 12:58:11 - INFO - Exogenous 변수 예측 시작
2024-09-20 12:58:11 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84101300.0         0         0
2024-09-20 12:58:11 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84101300.0         0         0
2024-09-20 12:58:11 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 12:58:11 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 12:58:11 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 12:58:11 - INFO - ARIMA prediction: 84893000.0
2024-09-20 12:58:11 - INFO - Attempting prediction for prophet
2024-09-20 12:58:11 - INFO - PROPHET prediction: 85010866.58029352
2024-09-20 12:58:11 - INFO - Attempting prediction for transformer
2024-09-20 12:58:11 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 12:58:11 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 12:58:11 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 12:58:11 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 12:58:11 - INFO - X dtype: float64, y dtype: float64
2024-09-20 12:58:11 - INFO - X 샘플:
[[-1.08178436 -1.34169474 -1.48441178 -1.39420852 -0.45608769 -0.46263207
  -1.39420852 -1.39420852  0.          0.          0.         -1.39420852
  -1.39420852]
 [-1.12875563 -1.00735765 -0.91029463 -0.84322711 -1.12806144 -1.12537515
  -0.84322711 -0.84322711  0.          0.          0.         -0.84322711
  -0.84322711]
 [-0.85054121 -1.10097204 -0.91029463 -1.22988073 -1.16986626 -1.1668143
  -1.22988073 -1.22988073  0.          0.          0.         -1.22988073
  -1.22988073]
 [-1.24076403 -1.00735765 -1.06977162 -0.79489541 -0.37946081 -0.38486485
  -0.79489541 -0.79489541  0.          0.          0.         -0.79489541
  -0.79489541]
 [-0.34831     0.38348464 -0.11290971  0.02352143  1.19418561  1.18523448
   0.02352143  0.02352143  0.          0.          0.          0.02352143
   0.02352143]
 [ 0.55498356  0.26312329  0.37508987  0.19751556 -0.50120218 -0.49908853
   0.19751556  0.19751556  0.          0.          0.          0.19751556
   0.19751556]
 [ 0.75732132  0.56737004  0.76740325  0.56161439  0.48606992  0.48555927
   0.56161439  0.56161439  0.          0.          0.          0.56161439
   0.56161439]
 [ 0.71035005  0.45035206  0.81205681  0.52294903 -0.62761518 -0.62350712
   0.52294903  0.52294903  0.          0.          0.          0.52294903
   0.52294903]
 [ 0.90546146  0.99866489  0.82800451  1.16092751  0.46458816  0.46700383
   1.16092751  1.16092751  0.          0.          0.          1.16092751
   1.16092751]
 [ 1.72203884  1.79438716  1.70512793  1.79568387  2.11744988  2.12448444
   1.79568387  1.79568387  0.          0.          0.          1.79568387
   1.79568387]]
2024-09-20 12:58:11 - INFO - y 샘플:
[1.79568387]
2024-09-20 12:58:11 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 12:58:11 - INFO - 모델 출력 (스케일링된 예측): [0.3133555]
2024-09-20 12:58:11 - INFO - 스케일러 역변환 후 예측 가격: 84432951.54077584
2024-09-20 12:58:11 - INFO - TransformerPredictor 최종 예측 가격: 84432951.54077584
2024-09-20 12:58:11 - INFO - TRANSFORMER prediction: 84432951.54077584
2024-09-20 12:58:11 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 12:58:11 - INFO - BITCOIN_FORECAST prediction: 83666347.13863546
2024-09-20 12:58:11 - INFO - BitcoinForecast prediction: 83666347.13863546
2024-09-20 12:58:13 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:14 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:15 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:16 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:17 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:18 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 12:58:18 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 12:58:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0031809187123215993, 'ml': 0.033472169429853954, 'xgboost': 0.038691134277515554, 'rl': 0.15040253536225395, 'lstm': 0.1522557531911605, 'arima': 0.11113380454820149, 'prophet': 0.24542537630559444, 'transformer': 0.17981842305878315, 'bitcoin_forecast': 0.08561988511431534}
2024-09-20 12:58:18 - INFO - 조정된 모델 가중치: {'gpt': 0.0031809187123215993, 'ml': 0.033472169429853954, 'xgboost': 0.038691134277515554, 'rl': 0.15040253536225395, 'lstm': 0.1522557531911605, 'arima': 0.11113380454820149, 'prophet': 0.24542537630559444, 'transformer': 0.17981842305878315, 'bitcoin_forecast': 0.08561988511431534}
2024-09-20 12:58:18 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84820818.78022234, 'current_price': 84940000.0, 'predictions': {'gpt': 84940000.0, 'ml': 85113721.8, 'xgboost': 84893000.0, 'lstm': 84527063.23726057, 'rl': 85789400.0, 'arima': 84893000.0, 'prophet': 85010866.58029352, 'transformer': 84432951.54077584, 'bitcoin_forecast': 83666347.13863546}, 'weights': {'gpt': 0.0031809187123215993, 'ml': 0.033472169429853954, 'xgboost': 0.038691134277515554, 'rl': 0.15040253536225395, 'lstm': 0.1522557531911605, 'arima': 0.11113380454820149, 'prophet': 0.24542537630559444, 'transformer': 0.17981842305878315, 'bitcoin_forecast': 0.08561988511431534}}
2024-09-20 12:58:18 - INFO - 모델별 가중치:
2024-09-20 12:58:18 - INFO -   - GPT: 0.0032
2024-09-20 12:58:18 - INFO -   - ML: 0.0335
2024-09-20 12:58:18 - INFO -   - XGBOOST: 0.0387
2024-09-20 12:58:18 - INFO -   - RL: 0.1504
2024-09-20 12:58:18 - INFO -   - LSTM: 0.1523
2024-09-20 12:58:18 - INFO -   - ARIMA: 0.1111
2024-09-20 12:58:18 - INFO -   - PROPHET: 0.2454
2024-09-20 12:58:18 - INFO -   - TRANSFORMER: 0.1798
2024-09-20 12:58:18 - INFO -   - BITCOIN_FORECAST: 0.0856
2024-09-20 12:58:18 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 12:58:18 - INFO - 6. 거래 실행
2024-09-20 12:58:18 - INFO - Cancelling existing orders.
2024-09-20 12:58:18 - INFO - Cancelled 0 orders.
2024-09-20 12:58:18 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84820818.78022234, 'current_price': 84940000.0, 'predictions': {'gpt': 84940000.0, 'ml': 85113721.8, 'xgboost': 84893000.0, 'lstm': 84527063.23726057, 'rl': 85789400.0, 'arima': 84893000.0, 'prophet': 85010866.58029352, 'transformer': 84432951.54077584, 'bitcoin_forecast': 83666347.13863546}, 'weights': {'gpt': 0.0031809187123215993, 'ml': 0.033472169429853954, 'xgboost': 0.038691134277515554, 'rl': 0.15040253536225395, 'lstm': 0.1522557531911605, 'arima': 0.11113380454820149, 'prophet': 0.24542537630559444, 'transformer': 0.17981842305878315, 'bitcoin_forecast': 0.08561988511431534}}, 현재 가격=84940000.0
2024-09-20 12:58:18 - INFO - 현재 잔고: KRW=224833.22434328, BTC=0.00299729, 총 자산가치=479423.03694328
2024-09-20 12:58:18 - INFO - 매도 시도: 0.000299729 BTC (약 25458.98126 KRW)
2024-09-20 12:58:18 - INFO - 주문 결과: {'uuid': '3edb76b3-4190-4149-a4b7-4a92972569bb', 'side': 'ask', 'ord_type': 'limit', 'price': '84940000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T12:58:20+09:00', 'volume': '0.00029972', 'remaining_volume': '0.00029972', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00029972', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 12:58:18 - INFO - sell 주문 성공: UUID=3edb76b3-4190-4149-a4b7-4a92972569bb
2024-09-20 12:58:18 - INFO - Trade executed successfully.
2024-09-20 12:58:18 - INFO - 7. summary 리포트 보내기
2024-09-20 12:58:19 - INFO - Message sent to Discord successfully.
2024-09-20 12:58:19 - INFO - Trading cycle completed.
2024-09-20 12:58:19 - INFO - Performing periodic update.
2024-09-20 12:58:19 - INFO - 계산된 시장 변동성: 0.029934307418446802
2024-09-20 13:05:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:05:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81bf-baf7-d685fd1e8881 "HTTP/1.1 200 OK"
2024-09-20 13:05:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:05:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:05:49 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8160-9601-eacf8540d752 "HTTP/1.1 200 OK"
2024-09-20 13:05:49 - INFO - Updated actual price for ml prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:05:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:05:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817d-959e-cfb15b9087be "HTTP/1.1 200 OK"
2024-09-20 13:05:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f9-9d6e-c89abff99f4d "HTTP/1.1 200 OK"
2024-09-20 13:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810b-a86d-fa434c0ce5f0 "HTTP/1.1 200 OK"
2024-09-20 13:06:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:13 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ef-9796-e736490206a3 "HTTP/1.1 200 OK"
2024-09-20 13:06:14 - INFO - Updated actual price for arima prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81bf-a363-f37aef615ad4 "HTTP/1.1 200 OK"
2024-09-20 13:06:20 - INFO - Updated actual price for prophet prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818a-8057-dc6352656d2f "HTTP/1.1 200 OK"
2024-09-20 13:06:24 - INFO - Updated actual price for transformer prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:06:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8162-b08c-fff8070b553d "HTTP/1.1 200 OK"
2024-09-20 13:06:30 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 12:55:34.976006
2024-09-20 13:06:30 - INFO - Starting trading cycle.
2024-09-20 13:06:30 - INFO - ##################################################
2024-09-20 13:06:30 - INFO - 0 회 예측 후 모델 재학습 검토
2024-09-20 13:06:30 - INFO - ##################################################
2024-09-20 13:06:30 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:06:30 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:06:30 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 12:50:00
2024-09-20 13:06:30 - INFO - 새로운 데이터 범위: 2024-09-19 03:50:00 ~ 2024-09-20 13:00:00
2024-09-20 13:06:30 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:06:30 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:06:30 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:06:30 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:06:30 - INFO - Sample date values: [Timestamp('2024-09-20 13:00:00')]
2024-09-20 13:06:30 - INFO - Successfully added 1 new data points
2024-09-20 13:06:30 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:06:30 - INFO - Final date range: 2024-09-20 13:00:00 to 2024-09-20 13:00:00
2024-09-20 13:06:30 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:06:30 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:00:00
2024-09-20 13:06:30 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:06:30 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:06:30 - INFO - GPT | 이전예측가격: 84940000 | 당시BTC가격: 84940000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:06:30 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 1/2
2024-09-20 13:06:30 - INFO - ML | 이전예측가격: 85113722 | 당시BTC가격: 84940000 | 예측: 상승 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 1 | 예측 성공률: 50.00%
2024-09-20 13:06:30 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.32%, 적중/전체: 76/126
2024-09-20 13:06:30 - INFO - XGBOOST | 이전예측가격: 84893000 | 당시BTC가격: 84940000 | 예측: 하락 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0365 | 반영가중치값: -0.0200 | 새 가중치: 0.0165 | 예측 총 횟수: 126 | 예측 성공 수: 76 | 예측 성공률: 60.32%
2024-09-20 13:06:30 - INFO - LSTM 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-20 13:06:30 - INFO - LSTM | 이전예측가격: 84527063 | 당시BTC가격: 84940000 | 예측: 하락 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0731 | 반영가중치값: -0.0200 | 새 가중치: 0.0531 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-20 13:06:30 - INFO - RL 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 2/2
2024-09-20 13:06:30 - INFO - RL | 이전예측가격: 85789400 | 당시BTC가격: 84940000 | 예측: 상승 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1250 | 반영가중치값: 0.0200 | 새 가중치: 0.1450 | 예측 총 횟수: 2 | 예측 성공 수: 2 | 예측 성공률: 100.00%
2024-09-20 13:06:30 - INFO - ARIMA 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/2
2024-09-20 13:06:30 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84940000 | 예측: 하락 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1250 | 반영가중치값: -0.0200 | 새 가중치: 0.1050 | 예측 총 횟수: 2 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 13:06:30 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.36%, 적중/전체: 67/111
2024-09-20 13:06:30 - INFO - PROPHET | 이전예측가격: 85010867 | 당시BTC가격: 84940000 | 예측: 상승 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3721 | 반영가중치값: 0.0200 | 새 가중치: 0.3921 | 예측 총 횟수: 111 | 예측 성공 수: 67 | 예측 성공률: 60.36%
2024-09-20 13:06:30 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.09%, 적중/전체: 13/22
2024-09-20 13:06:30 - INFO - TRANSFORMER | 이전예측가격: 84432952 | 당시BTC가격: 84940000 | 예측: 하락 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0731 | 반영가중치값: -0.0200 | 새 가중치: 0.0531 | 예측 총 횟수: 22 | 예측 성공 수: 13 | 예측 성공률: 59.09%
2024-09-20 13:06:30 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.45%, 적중/전체: 35/62
2024-09-20 13:06:30 - INFO - BITCOIN_FORECAST | 이전예측가격: 83666347 | 당시BTC가격: 84940000 | 예측: 하락 | 지금 BTC가격: 85188000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1679 | 반영가중치값: -0.0200 | 새 가중치: 0.1479 | 예측 총 횟수: 62 | 예측 성공 수: 35 | 예측 성공률: 56.45%
2024-09-20 13:06:30 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:06:30 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:06:30 - INFO - 새로운 가중치: {'gpt': 0.0029986136038619837, 'ml': 0.13668974654264232, 'xgboost': 0.015521136987890984, 'rl': 0.13668974654264232, 'lstm': 0.05004813330284982, 'arima': 0.09898223025501686, 'prophet': 0.36960242699733226, 'transformer': 0.05004813330284982, 'bitcoin_forecast': 0.13941983246491368}
2024-09-20 13:06:30 - INFO - XGBoost 모델 성능: 정확도 60.32%, 적중/전체: 76/126
2024-09-20 13:06:30 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:06:30 - INFO - Current BTC price: 85190000.0
2024-09-20 13:06:30 - INFO - Analyzing market conditions.
2024-09-20 13:06:30 - INFO - Market analysis: {'current_price': 85190000.0, 'sma_20': 84176950.0, 'rsi_14': 75.01435578115955, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-20 13:06:30 - INFO - Starting predictions for all models
2024-09-20 13:06:30 - INFO - Attempting prediction for gpt
2024-09-20 13:06:31 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:06:31 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:06:31 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:06:31 - INFO - GPT prediction: 85190000.0
2024-09-20 13:06:31 - INFO - Attempting prediction for ml
2024-09-20 13:06:31 - INFO - ML prediction: 85445569.99999999
2024-09-20 13:06:31 - INFO - Attempting prediction for xgboost
2024-09-20 13:06:31 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:06:31 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:06:31 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:06:31 - INFO - XGBOOST prediction: 85190000.0
2024-09-20 13:06:31 - INFO - Attempting prediction for lstm
2024-09-20 13:06:31 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:06:31 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:06:31 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:06:31 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:06:31 - INFO - X 샘플:
[[-1.27283925 -1.20249567 -1.18926118 -1.06642532 -0.76068849 -0.75878317
  -1.06642532]
 [-1.03367716 -1.28241468 -1.18926118 -1.39421998 -0.77672795 -0.77463575
  -1.39421998]
 [-1.36912528 -1.20249567 -1.33593868 -1.02545098 -0.47346909 -0.4755002
  -1.02545098]
 [-0.60194301 -0.01512753 -0.45587367 -0.33161894  0.1302998   0.12514289
  -0.33161894]
 [ 0.17455726 -0.11788054 -0.00704052 -0.18411134 -0.52017822 -0.51919658
  -0.18411134]
 [ 0.34849332  0.14185624  0.35378613  0.12456197 -0.14138653 -0.14251857
   0.12456197]
 [ 0.30811531  0.04195748  0.39485583  0.09178251 -0.56867973 -0.56679304
   0.09178251]
 [ 0.47583937  0.51005454  0.40952358  0.63264371 -0.14962855 -0.14961697
   0.63264371]
 [ 1.17779561  1.18936612  1.21624984  1.17077329  0.48453328  0.48445391
   1.17077329]
 [ 1.79278383  1.93717971  1.80295984  1.98206509  2.77592549  2.77744749
   1.98206509]]
2024-09-20 13:06:31 - INFO - y 샘플:
[1.98206509]
2024-09-20 13:06:31 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:06:31 - INFO - 모델 출력 (스케일링된 예측): [[0.6454458]]
2024-09-20 13:06:31 - INFO - 스케일러 역변환 후 예측 가격: 84700686.63513273
2024-09-20 13:06:31 - INFO - LSTMPredictor 최종 예측 가격: 84700686.63513273
2024-09-20 13:06:31 - INFO - LSTM prediction: 84700686.63513273
2024-09-20 13:06:31 - INFO - Attempting prediction for rl
2024-09-20 13:06:31 - INFO - Preparing state for RL agent.
2024-09-20 13:06:31 - INFO - Prepared state: [[8.51900000e+07 1.08813146e+02 3.49852167e-03 8.41769500e+07
  7.50143558e+01]]
2024-09-20 13:06:31 - INFO - RL prediction: 86041900.0
2024-09-20 13:06:31 - INFO - Attempting prediction for arima
2024-09-20 13:06:31 - INFO - ARIMA 예측 시작
2024-09-20 13:06:31 - INFO - 입력 데이터: {'open': 84974000.0, 'high': 85200000.0, 'low': 84970000.0, 'close': 85190000.0, 'volume': 108.81314571, 'value': 9255270717.57804, 'decision': 'sell', 'sma': 84176950.0, 'ema': 84325138.85201052, 'rsi': 75.01435578115955, 'macd': 238291.96404139698, 'signal_line': 116901.81730680513, 'BB_Upper': 84994935.44608179, 'BB_Lower': 83358964.55391821}
2024-09-20 13:06:31 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:06:31 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84176950.0         0         0
2024-09-20 13:06:31 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84176950.0         0         0
2024-09-20 13:06:31 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:06:31 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:06:31 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:06:31 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:06:31 - INFO - Attempting prediction for prophet
2024-09-20 13:06:31 - INFO - PROPHET prediction: 85368806.71678941
2024-09-20 13:06:31 - INFO - Attempting prediction for transformer
2024-09-20 13:06:31 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:06:31 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:06:31 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:06:31 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:06:31 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:06:31 - INFO - X 샘플:
[[-1.27283925 -1.20249567 -1.18926118 -1.06642532 -0.76068849 -0.75878317
  -1.06642532 -1.06642532  0.          0.          0.         -1.06642532
  -1.06642532]
 [-1.03367716 -1.28241468 -1.18926118 -1.39421998 -0.77672795 -0.77463575
  -1.39421998 -1.39421998  0.          0.          0.         -1.39421998
  -1.39421998]
 [-1.36912528 -1.20249567 -1.33593868 -1.02545098 -0.47346909 -0.4755002
  -1.02545098 -1.02545098  0.          0.          0.         -1.02545098
  -1.02545098]
 [-0.60194301 -0.01512753 -0.45587367 -0.33161894  0.1302998   0.12514289
  -0.33161894 -0.33161894  0.          0.          0.         -0.33161894
  -0.33161894]
 [ 0.17455726 -0.11788054 -0.00704052 -0.18411134 -0.52017822 -0.51919658
  -0.18411134 -0.18411134  0.          0.          0.         -0.18411134
  -0.18411134]
 [ 0.34849332  0.14185624  0.35378613  0.12456197 -0.14138653 -0.14251857
   0.12456197  0.12456197  0.          0.          0.          0.12456197
   0.12456197]
 [ 0.30811531  0.04195748  0.39485583  0.09178251 -0.56867973 -0.56679304
   0.09178251  0.09178251  0.          0.          0.          0.09178251
   0.09178251]
 [ 0.47583937  0.51005454  0.40952358  0.63264371 -0.14962855 -0.14961697
   0.63264371  0.63264371  0.          0.          0.          0.63264371
   0.63264371]
 [ 1.17779561  1.18936612  1.21624984  1.17077329  0.48453328  0.48445391
   1.17077329  1.17077329  0.          0.          0.          1.17077329
   1.17077329]
 [ 1.79278383  1.93717971  1.80295984  1.98206509  2.77592549  2.77744749
   1.98206509  1.98206509  0.          0.          0.          1.98206509
   1.98206509]]
2024-09-20 13:06:31 - INFO - y 샘플:
[1.98206509]
2024-09-20 13:06:31 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:06:31 - INFO - 모델 출력 (스케일링된 예측): [0.31404155]
2024-09-20 13:06:31 - INFO - 스케일러 역변환 후 예측 가격: 84579365.22184293
2024-09-20 13:06:31 - INFO - TransformerPredictor 최종 예측 가격: 84579365.22184293
2024-09-20 13:06:31 - INFO - TRANSFORMER prediction: 84579365.22184293
2024-09-20 13:06:31 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:06:31 - INFO - BITCOIN_FORECAST prediction: 83922103.2164555
2024-09-20 13:06:31 - INFO - BitcoinForecast prediction: 83922103.2164555
2024-09-20 13:06:31 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:06:36 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:06:36 - INFO - 조정된 모델 가중치: {'gpt': 0.0029986136038619837, 'ml': 0.13668974654264232, 'xgboost': 0.015521136987890984, 'rl': 0.13668974654264232, 'lstm': 0.05004813330284982, 'arima': 0.09898223025501686, 'prophet': 0.36960242699733226, 'transformer': 0.05004813330284982, 'bitcoin_forecast': 0.13941983246491368}
2024-09-20 13:06:36 - INFO - 조정된 모델 가중치: {'gpt': 0.0029986136038619837, 'ml': 0.13668974654264232, 'xgboost': 0.015521136987890984, 'rl': 0.13668974654264232, 'lstm': 0.05004813330284982, 'arima': 0.09898223025501686, 'prophet': 0.36960242699733226, 'transformer': 0.05004813330284982, 'bitcoin_forecast': 0.13941983246491368}
2024-09-20 13:06:36 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85146249.15927374, 'current_price': 85190000.0, 'predictions': {'gpt': 85190000.0, 'ml': 85445569.99999999, 'xgboost': 85190000.0, 'lstm': 84700686.63513273, 'rl': 86041900.0, 'arima': 84893000.0, 'prophet': 85368806.71678941, 'transformer': 84579365.22184293, 'bitcoin_forecast': 83922103.2164555}, 'weights': {'gpt': 0.0029986136038619837, 'ml': 0.13668974654264232, 'xgboost': 0.015521136987890984, 'rl': 0.13668974654264232, 'lstm': 0.05004813330284982, 'arima': 0.09898223025501686, 'prophet': 0.36960242699733226, 'transformer': 0.05004813330284982, 'bitcoin_forecast': 0.13941983246491368}}
2024-09-20 13:06:36 - INFO - 모델별 가중치:
2024-09-20 13:06:36 - INFO -   - GPT: 0.0030
2024-09-20 13:06:36 - INFO -   - ML: 0.1367
2024-09-20 13:06:36 - INFO -   - XGBOOST: 0.0155
2024-09-20 13:06:36 - INFO -   - RL: 0.1367
2024-09-20 13:06:36 - INFO -   - LSTM: 0.0500
2024-09-20 13:06:36 - INFO -   - ARIMA: 0.0990
2024-09-20 13:06:36 - INFO -   - PROPHET: 0.3696
2024-09-20 13:06:36 - INFO -   - TRANSFORMER: 0.0500
2024-09-20 13:06:36 - INFO -   - BITCOIN_FORECAST: 0.1394
2024-09-20 13:06:36 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:06:36 - INFO - 6. 거래 실행
2024-09-20 13:06:36 - INFO - Cancelling existing orders.
2024-09-20 13:06:36 - INFO - Cancelled 0 orders.
2024-09-20 13:06:36 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85146249.15927374, 'current_price': 85190000.0, 'predictions': {'gpt': 85190000.0, 'ml': 85445569.99999999, 'xgboost': 85190000.0, 'lstm': 84700686.63513273, 'rl': 86041900.0, 'arima': 84893000.0, 'prophet': 85368806.71678941, 'transformer': 84579365.22184293, 'bitcoin_forecast': 83922103.2164555}, 'weights': {'gpt': 0.0029986136038619837, 'ml': 0.13668974654264232, 'xgboost': 0.015521136987890984, 'rl': 0.13668974654264232, 'lstm': 0.05004813330284982, 'arima': 0.09898223025501686, 'prophet': 0.36960242699733226, 'transformer': 0.05004813330284982, 'bitcoin_forecast': 0.13941983246491368}}, 현재 가격=85190000.0
2024-09-20 13:06:36 - INFO - 현재 잔고: KRW=250278.71203488, BTC=0.00269757, 총 자산가치=480084.70033488004
2024-09-20 13:06:36 - INFO - 매도 시도: 0.000269757 BTC (약 22980.598830000003 KRW)
2024-09-20 13:06:36 - INFO - 주문 결과: {'uuid': '35b61629-c74f-4e59-9d6b-837b7b106e3a', 'side': 'ask', 'ord_type': 'limit', 'price': '85190000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:06:38+09:00', 'volume': '0.00026975', 'remaining_volume': '0.00026975', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00026975', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:06:36 - INFO - sell 주문 성공: UUID=35b61629-c74f-4e59-9d6b-837b7b106e3a
2024-09-20 13:06:36 - INFO - Trade executed successfully.
2024-09-20 13:06:36 - INFO - 7. summary 리포트 보내기
2024-09-20 13:06:37 - INFO - Message sent to Discord successfully.
2024-09-20 13:06:37 - INFO - Trading cycle completed.
2024-09-20 13:06:37 - INFO - Performing periodic update.
2024-09-20 13:06:37 - INFO - 계산된 시장 변동성: 0.03028613753574843
2024-09-20 13:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:15:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8160-8290-f010381d107f "HTTP/1.1 200 OK"
2024-09-20 13:15:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:15:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:15:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8196-aa0a-fb0ea1197f85 "HTTP/1.1 200 OK"
2024-09-20 13:15:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:15:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8173-8567-dabf916862f7 "HTTP/1.1 200 OK"
2024-09-20 13:15:58 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812a-adef-c59232372cec "HTTP/1.1 200 OK"
2024-09-20 13:16:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-810d-afe8-f32dea18e52e "HTTP/1.1 200 OK"
2024-09-20 13:16:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8126-bfdb-f640bf80bd70 "HTTP/1.1 200 OK"
2024-09-20 13:16:25 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8119-a450-f54261bb3c7b "HTTP/1.1 200 OK"
2024-09-20 13:16:30 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815e-bfa9-e7f94ee4a007 "HTTP/1.1 200 OK"
2024-09-20 13:16:36 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:16:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8157-a77b-f251ce069c5f "HTTP/1.1 200 OK"
2024-09-20 13:16:42 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:05:34.976138
2024-09-20 13:16:42 - INFO - Starting trading cycle.
2024-09-20 13:16:42 - INFO - ##################################################
2024-09-20 13:16:42 - INFO - 1 회 예측 후 모델 재학습 검토
2024-09-20 13:16:42 - INFO - ##################################################
2024-09-20 13:16:42 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:16:42 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:16:42 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:00:00
2024-09-20 13:16:42 - INFO - 새로운 데이터 범위: 2024-09-19 04:00:00 ~ 2024-09-20 13:10:00
2024-09-20 13:16:42 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:16:42 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:16:42 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:16:42 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:16:42 - INFO - Sample date values: [Timestamp('2024-09-20 13:10:00')]
2024-09-20 13:16:42 - INFO - Successfully added 1 new data points
2024-09-20 13:16:42 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:16:42 - INFO - Final date range: 2024-09-20 13:10:00 to 2024-09-20 13:10:00
2024-09-20 13:16:42 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:16:42 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:10:00
2024-09-20 13:16:42 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:16:42 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:16:42 - INFO - GPT | 이전예측가격: 85190000 | 당시BTC가격: 85190000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:16:42 - INFO - ML 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 2/3
2024-09-20 13:16:42 - INFO - ML | 이전예측가격: 85445570 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0335 | 반영가중치값: 0.0200 | 새 가중치: 0.0535 | 예측 총 횟수: 3 | 예측 성공 수: 2 | 예측 성공률: 66.67%
2024-09-20 13:16:42 - INFO - XGBOOST | 이전예측가격: 85190000 | 당시BTC가격: 85190000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:16:42 - INFO - LSTM 모델 예측 업데이트: 정확도 56.52%, 적중/전체: 13/23
2024-09-20 13:16:43 - INFO - LSTM | 이전예측가격: 84700687 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1523 | 반영가중치값: -0.0200 | 새 가중치: 0.1323 | 예측 총 횟수: 23 | 예측 성공 수: 13 | 예측 성공률: 56.52%
2024-09-20 13:16:43 - INFO - RL 모델 예측 업데이트: 정확도 100.00%, 적중/전체: 3/3
2024-09-20 13:16:43 - INFO - RL | 이전예측가격: 86041900 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1504 | 반영가중치값: 0.0200 | 새 가중치: 0.1704 | 예측 총 횟수: 3 | 예측 성공 수: 3 | 예측 성공률: 100.00%
2024-09-20 13:16:43 - INFO - ARIMA 모델 예측 업데이트: 정확도 0.00%, 적중/전체: 0/3
2024-09-20 13:16:43 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1111 | 반영가중치값: -0.0200 | 새 가중치: 0.0911 | 예측 총 횟수: 3 | 예측 성공 수: 0 | 예측 성공률: 0.00%
2024-09-20 13:16:43 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.71%, 적중/전체: 68/112
2024-09-20 13:16:43 - INFO - PROPHET | 이전예측가격: 85368807 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2454 | 반영가중치값: 0.0200 | 새 가중치: 0.2654 | 예측 총 횟수: 112 | 예측 성공 수: 68 | 예측 성공률: 60.71%
2024-09-20 13:16:43 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.52%, 적중/전체: 13/23
2024-09-20 13:16:43 - INFO - TRANSFORMER | 이전예측가격: 84579365 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1798 | 반영가중치값: -0.0200 | 새 가중치: 0.1598 | 예측 총 횟수: 23 | 예측 성공 수: 13 | 예측 성공률: 56.52%
2024-09-20 13:16:43 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 35/63
2024-09-20 13:16:43 - INFO - BITCOIN_FORECAST | 이전예측가격: 83922103 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85290000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0856 | 반영가중치값: -0.0200 | 새 가중치: 0.0656 | 예측 총 횟수: 63 | 예측 성공 수: 35 | 예측 성공률: 55.56%
2024-09-20 13:16:43 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:16:43 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:16:43 - INFO - 새로운 가중치: {'gpt': 0.003134501458978872, 'ml': 0.05589536206891601, 'xgboost': 0.016224506708999265, 'rl': 0.17812464901071925, 'lstm': 0.138249173151928, 'arima': 0.09526370551735176, 'prophet': 0.27745362997365863, 'transformer': 0.16706089761090656, 'bitcoin_forecast': 0.06859357449854163}
2024-09-20 13:16:43 - INFO - XGBoost 모델 성능: 정확도 60.32%, 적중/전체: 76/126
2024-09-20 13:16:43 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:16:43 - INFO - Current BTC price: 85290000.0
2024-09-20 13:16:43 - INFO - Analyzing market conditions.
2024-09-20 13:16:43 - INFO - Market analysis: {'current_price': 85290000.0, 'sma_20': 84249650.0, 'rsi_14': 76.27867645542455, 'trend': 'Bullish', 'overbought_oversold': 'Overbought'}
2024-09-20 13:16:43 - INFO - Starting predictions for all models
2024-09-20 13:16:43 - INFO - Attempting prediction for gpt
2024-09-20 13:16:43 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:16:43 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:16:43 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:16:43 - INFO - GPT prediction: 85290000.0
2024-09-20 13:16:43 - INFO - Attempting prediction for ml
2024-09-20 13:16:43 - INFO - ML prediction: 85426464.0
2024-09-20 13:16:43 - INFO - Attempting prediction for xgboost
2024-09-20 13:16:43 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:16:43 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:16:43 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:16:43 - INFO - XGBOOST prediction: 85290000.0
2024-09-20 13:16:43 - INFO - Attempting prediction for lstm
2024-09-20 13:16:43 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:16:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:16:43 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:16:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:16:43 - INFO - X 샘플:
[[-1.14495827 -1.40106545 -1.37793697 -1.5232215  -0.94020784 -0.93808543
  -1.5232215 ]
 [-1.4037059  -1.33402883 -1.5101005  -1.19784982 -0.63356051 -0.63582399
  -1.19784982]
 [-0.81194049 -0.33805612 -0.71711932 -0.58566902 -0.0230454  -0.02890434
  -0.58566902]
 [-0.21298763 -0.42424607 -0.31269891 -0.45552035 -0.68079154 -0.67997699
  -0.45552035]
 [-0.0788222  -0.20637704  0.01242337 -0.18317221 -0.29776743 -0.29936279
  -0.18317221]
 [-0.10996774 -0.29017282  0.04942916 -0.21209413 -0.72983499 -0.72807082
  -0.21209413]
 [ 0.01940607  0.10247027  0.06264551  0.26511767 -0.30610153 -0.30653537
   0.26511767]
 [ 0.56085945  0.67228158  0.78954493  0.7399193   0.33514611  0.33416138
   0.7399193 ]
 [ 1.03523011  1.29955285  1.31819906  1.455737    2.65214123  2.65111612
   1.455737  ]
 [ 2.1468866   1.91964163  1.68561367  1.69675306  0.62402192  0.63148222
   1.69675306]]
2024-09-20 13:16:43 - INFO - y 샘플:
[1.69675306]
2024-09-20 13:16:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:16:43 - INFO - 모델 출력 (스케일링된 예측): [[0.6256585]]
2024-09-20 13:16:43 - INFO - 스케일러 역변환 후 예측 가격: 84845592.04255158
2024-09-20 13:16:43 - INFO - LSTMPredictor 최종 예측 가격: 84845592.04255158
2024-09-20 13:16:43 - INFO - LSTM prediction: 84845592.04255158
2024-09-20 13:16:43 - INFO - Attempting prediction for rl
2024-09-20 13:16:43 - INFO - Preparing state for RL agent.
2024-09-20 13:16:43 - INFO - Prepared state: [[8.52900000e+07 5.11786567e+01 1.17384670e-03 8.42496500e+07
  7.62786765e+01]]
2024-09-20 13:16:43 - INFO - RL prediction: 86142900.0
2024-09-20 13:16:43 - INFO - Attempting prediction for arima
2024-09-20 13:16:43 - INFO - ARIMA 예측 시작
2024-09-20 13:16:43 - INFO - 입력 데이터: {'open': 85438000.0, 'high': 85459000.0, 'low': 85109000.0, 'close': 85290000.0, 'volume': 51.17865671, 'value': 4365456170.11827, 'decision': 'sell', 'sma': 84249650.0, 'ema': 84417030.38991429, 'rsi': 76.27867645542455, 'macd': 283867.25064241886, 'signal_line': 150294.9039739279, 'BB_Upper': 85183719.4353195, 'BB_Lower': 83315580.5646805}
2024-09-20 13:16:43 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:16:43 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84249650.0         0         0
2024-09-20 13:16:43 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84249650.0         0         0
2024-09-20 13:16:43 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:16:43 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:16:43 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:16:43 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:16:43 - INFO - Attempting prediction for prophet
2024-09-20 13:16:43 - INFO - PROPHET prediction: 85442298.56636393
2024-09-20 13:16:43 - INFO - Attempting prediction for transformer
2024-09-20 13:16:43 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:16:43 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:16:43 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:16:43 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:16:43 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:16:43 - INFO - X 샘플:
[[-1.14495827 -1.40106545 -1.37793697 -1.5232215  -0.94020784 -0.93808543
  -1.5232215  -1.5232215   0.          0.          0.         -1.5232215
  -1.5232215 ]
 [-1.4037059  -1.33402883 -1.5101005  -1.19784982 -0.63356051 -0.63582399
  -1.19784982 -1.19784982  0.          0.          0.         -1.19784982
  -1.19784982]
 [-0.81194049 -0.33805612 -0.71711932 -0.58566902 -0.0230454  -0.02890434
  -0.58566902 -0.58566902  0.          0.          0.         -0.58566902
  -0.58566902]
 [-0.21298763 -0.42424607 -0.31269891 -0.45552035 -0.68079154 -0.67997699
  -0.45552035 -0.45552035  0.          0.          0.         -0.45552035
  -0.45552035]
 [-0.0788222  -0.20637704  0.01242337 -0.18317221 -0.29776743 -0.29936279
  -0.18317221 -0.18317221  0.          0.          0.         -0.18317221
  -0.18317221]
 [-0.10996774 -0.29017282  0.04942916 -0.21209413 -0.72983499 -0.72807082
  -0.21209413 -0.21209413  0.          0.          0.         -0.21209413
  -0.21209413]
 [ 0.01940607  0.10247027  0.06264551  0.26511767 -0.30610153 -0.30653537
   0.26511767  0.26511767  0.          0.          0.          0.26511767
   0.26511767]
 [ 0.56085945  0.67228158  0.78954493  0.7399193   0.33514611  0.33416138
   0.7399193   0.7399193   0.          0.          0.          0.7399193
   0.7399193 ]
 [ 1.03523011  1.29955285  1.31819906  1.455737    2.65214123  2.65111612
   1.455737    1.455737    0.          0.          0.          1.455737
   1.455737  ]
 [ 2.1468866   1.91964163  1.68561367  1.69675306  0.62402192  0.63148222
   1.69675306  1.69675306  0.          0.          0.          1.69675306
   1.69675306]]
2024-09-20 13:16:43 - INFO - y 샘플:
[1.69675306]
2024-09-20 13:16:43 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:16:43 - INFO - 모델 출력 (스케일링된 예측): [0.3138255]
2024-09-20 13:16:43 - INFO - 스케일러 역변환 후 예측 가격: 84716209.36801884
2024-09-20 13:16:43 - INFO - TransformerPredictor 최종 예측 가격: 84716209.36801884
2024-09-20 13:16:43 - INFO - TRANSFORMER prediction: 84716209.36801884
2024-09-20 13:16:43 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:16:43 - INFO - BITCOIN_FORECAST prediction: 83794564.01771356
2024-09-20 13:16:43 - INFO - BitcoinForecast prediction: 83794564.01771356
2024-09-20 13:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:16:48 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:16:48 - INFO - 조정된 모델 가중치: {'gpt': 0.003134501458978872, 'ml': 0.05589536206891601, 'xgboost': 0.016224506708999265, 'rl': 0.17812464901071925, 'lstm': 0.138249173151928, 'arima': 0.09526370551735176, 'prophet': 0.27745362997365863, 'transformer': 0.16706089761090656, 'bitcoin_forecast': 0.06859357449854163}
2024-09-20 13:16:48 - INFO - 조정된 모델 가중치: {'gpt': 0.003134501458978872, 'ml': 0.05589536206891601, 'xgboost': 0.016224506708999265, 'rl': 0.17812464901071925, 'lstm': 0.138249173151928, 'arima': 0.09526370551735176, 'prophet': 0.27745362997365863, 'transformer': 0.16706089761090656, 'bitcoin_forecast': 0.06859357449854163}
2024-09-20 13:16:48 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85194112.00668004, 'current_price': 85290000.0, 'predictions': {'gpt': 85290000.0, 'ml': 85426464.0, 'xgboost': 85290000.0, 'lstm': 84845592.04255158, 'rl': 86142900.0, 'arima': 84893000.0, 'prophet': 85442298.56636393, 'transformer': 84716209.36801884, 'bitcoin_forecast': 83794564.01771356}, 'weights': {'gpt': 0.003134501458978872, 'ml': 0.05589536206891601, 'xgboost': 0.016224506708999265, 'rl': 0.17812464901071925, 'lstm': 0.138249173151928, 'arima': 0.09526370551735176, 'prophet': 0.27745362997365863, 'transformer': 0.16706089761090656, 'bitcoin_forecast': 0.06859357449854163}}
2024-09-20 13:16:48 - INFO - 모델별 가중치:
2024-09-20 13:16:48 - INFO -   - GPT: 0.0031
2024-09-20 13:16:48 - INFO -   - ML: 0.0559
2024-09-20 13:16:48 - INFO -   - XGBOOST: 0.0162
2024-09-20 13:16:48 - INFO -   - RL: 0.1781
2024-09-20 13:16:48 - INFO -   - LSTM: 0.1382
2024-09-20 13:16:48 - INFO -   - ARIMA: 0.0953
2024-09-20 13:16:48 - INFO -   - PROPHET: 0.2775
2024-09-20 13:16:48 - INFO -   - TRANSFORMER: 0.1671
2024-09-20 13:16:48 - INFO -   - BITCOIN_FORECAST: 0.0686
2024-09-20 13:16:48 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:16:48 - INFO - 6. 거래 실행
2024-09-20 13:16:48 - INFO - Cancelling existing orders.
2024-09-20 13:16:48 - INFO - Cancelled 0 orders.
2024-09-20 13:16:48 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85194112.00668004, 'current_price': 85290000.0, 'predictions': {'gpt': 85290000.0, 'ml': 85426464.0, 'xgboost': 85290000.0, 'lstm': 84845592.04255158, 'rl': 86142900.0, 'arima': 84893000.0, 'prophet': 85442298.56636393, 'transformer': 84716209.36801884, 'bitcoin_forecast': 83794564.01771356}, 'weights': {'gpt': 0.003134501458978872, 'ml': 0.05589536206891601, 'xgboost': 0.016224506708999265, 'rl': 0.17812464901071925, 'lstm': 0.138249173151928, 'arima': 0.09526370551735176, 'prophet': 0.27745362997365863, 'transformer': 0.16706089761090656, 'bitcoin_forecast': 0.06859357449854163}}, 현재 가격=85290000.0
2024-09-20 13:16:48 - INFO - 현재 잔고: KRW=273247.22453363, BTC=0.00242782, 총 자산가치=480315.99233363
2024-09-20 13:16:48 - INFO - 매도 시도: 0.00024278199999999998 BTC (약 20706.87678 KRW)
2024-09-20 13:16:48 - INFO - 주문 결과: {'uuid': '12802d1a-68d1-4473-83cd-c7fc704e6f3b', 'side': 'ask', 'ord_type': 'limit', 'price': '85290000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:16:49+09:00', 'volume': '0.00024278', 'remaining_volume': '0.00024278', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00024278', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:16:48 - INFO - sell 주문 성공: UUID=12802d1a-68d1-4473-83cd-c7fc704e6f3b
2024-09-20 13:16:48 - INFO - Trade executed successfully.
2024-09-20 13:16:48 - INFO - 7. summary 리포트 보내기
2024-09-20 13:16:48 - INFO - Message sent to Discord successfully.
2024-09-20 13:16:48 - INFO - Trading cycle completed.
2024-09-20 13:16:48 - INFO - Performing periodic update.
2024-09-20 13:16:48 - INFO - 계산된 시장 변동성: 0.030325981491318783
2024-09-20 13:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:25:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818b-ac65-d0b972ff5a69 "HTTP/1.1 200 OK"
2024-09-20 13:25:47 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:25:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:25:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/8d5e89bc-4d78-4118-aca6-6342b292777b "HTTP/1.1 200 OK"
2024-09-20 13:25:55 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8133-95c6-f3b56eaab7f3 "HTTP/1.1 200 OK"
2024-09-20 13:26:07 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815e-ab5d-eda2e4b99fa7 "HTTP/1.1 200 OK"
2024-09-20 13:26:13 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:21 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812e-83a7-e3c44caf0c35 "HTTP/1.1 200 OK"
2024-09-20 13:26:23 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812b-a83c-e3645976e7bb "HTTP/1.1 200 OK"
2024-09-20 13:26:29 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ed-829f-d6ab8f8d300e "HTTP/1.1 200 OK"
2024-09-20 13:26:34 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8188-ae61-d76affc91dbb "HTTP/1.1 200 OK"
2024-09-20 13:26:38 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:26:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8194-bdef-c618adc94890 "HTTP/1.1 200 OK"
2024-09-20 13:26:46 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:15:34.976397
2024-09-20 13:26:46 - INFO - Starting trading cycle.
2024-09-20 13:26:46 - INFO - ##################################################
2024-09-20 13:26:46 - INFO - 2 회 예측 후 모델 재학습 검토
2024-09-20 13:26:46 - INFO - ##################################################
2024-09-20 13:26:46 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:26:46 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:26:46 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:10:00
2024-09-20 13:26:46 - INFO - 새로운 데이터 범위: 2024-09-19 04:10:00 ~ 2024-09-20 13:20:00
2024-09-20 13:26:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:26:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:26:46 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:26:46 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:26:46 - INFO - Sample date values: [Timestamp('2024-09-20 13:20:00')]
2024-09-20 13:26:47 - INFO - Successfully added 1 new data points
2024-09-20 13:26:47 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:26:47 - INFO - Final date range: 2024-09-20 13:20:00 to 2024-09-20 13:20:00
2024-09-20 13:26:47 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:26:47 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:20:00
2024-09-20 13:26:47 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:26:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:26:47 - INFO - GPT | 이전예측가격: 85290000 | 당시BTC가격: 85290000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:26:47 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 2/4
2024-09-20 13:26:47 - INFO - ML | 이전예측가격: 85426464 | 당시BTC가격: 85290000 | 예측: 상승 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1367 | 반영가중치값: -0.0200 | 새 가중치: 0.1167 | 예측 총 횟수: 4 | 예측 성공 수: 2 | 예측 성공률: 50.00%
2024-09-20 13:26:47 - INFO - XGBOOST | 이전예측가격: 85290000 | 당시BTC가격: 85290000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:26:47 - INFO - LSTM 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 14/24
2024-09-20 13:26:47 - INFO - LSTM | 이전예측가격: 84845592 | 당시BTC가격: 85290000 | 예측: 하락 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0500 | 반영가중치값: 0.0200 | 새 가중치: 0.0700 | 예측 총 횟수: 24 | 예측 성공 수: 14 | 예측 성공률: 58.33%
2024-09-20 13:26:47 - INFO - RL 모델 예측 업데이트: 정확도 75.00%, 적중/전체: 3/4
2024-09-20 13:26:47 - INFO - RL | 이전예측가격: 86142900 | 당시BTC가격: 85290000 | 예측: 상승 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1367 | 반영가중치값: -0.0200 | 새 가중치: 0.1167 | 예측 총 횟수: 4 | 예측 성공 수: 3 | 예측 성공률: 75.00%
2024-09-20 13:26:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 25.00%, 적중/전체: 1/4
2024-09-20 13:26:47 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85290000 | 예측: 하락 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0990 | 반영가중치값: 0.0200 | 새 가중치: 0.1190 | 예측 총 횟수: 4 | 예측 성공 수: 1 | 예측 성공률: 25.00%
2024-09-20 13:26:47 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.18%, 적중/전체: 68/113
2024-09-20 13:26:47 - INFO - PROPHET | 이전예측가격: 85442299 | 당시BTC가격: 85290000 | 예측: 상승 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3696 | 반영가중치값: -0.0200 | 새 가중치: 0.3496 | 예측 총 횟수: 113 | 예측 성공 수: 68 | 예측 성공률: 60.18%
2024-09-20 13:26:47 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 14/24
2024-09-20 13:26:47 - INFO - TRANSFORMER | 이전예측가격: 84716209 | 당시BTC가격: 85290000 | 예측: 하락 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0500 | 반영가중치값: 0.0200 | 새 가중치: 0.0700 | 예측 총 횟수: 24 | 예측 성공 수: 14 | 예측 성공률: 58.33%
2024-09-20 13:26:47 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 36/64
2024-09-20 13:26:47 - INFO - BITCOIN_FORECAST | 이전예측가격: 83794564 | 당시BTC가격: 85290000 | 예측: 하락 | 지금 BTC가격: 84984000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1394 | 반영가중치값: 0.0200 | 새 가중치: 0.1594 | 예측 총 횟수: 64 | 예측 성공 수: 36 | 예측 성공률: 56.25%
2024-09-20 13:26:47 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:26:47 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:26:47 - INFO - 새로운 가중치: {'gpt': 0.003070514222210759, 'ml': 0.11430765977760135, 'xgboost': 0.01589330209294757, 'rl': 0.11430765977760135, 'lstm': 0.06861818134734046, 'arima': 0.11655334507561545, 'prophet': 0.3424656961443586, 'transformer': 0.06861818134734046, 'bitcoin_forecast': 0.15616546021498387}
2024-09-20 13:26:47 - INFO - XGBoost 모델 성능: 정확도 60.32%, 적중/전체: 76/126
2024-09-20 13:26:47 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:26:47 - INFO - Current BTC price: 84984000.0
2024-09-20 13:26:47 - INFO - Analyzing market conditions.
2024-09-20 13:26:47 - INFO - Market analysis: {'current_price': 84937000.0, 'sma_20': 84317550.0, 'rsi_14': 63.97258883827259, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 13:26:47 - INFO - Starting predictions for all models
2024-09-20 13:26:47 - INFO - Attempting prediction for gpt
2024-09-20 13:26:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:26:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:26:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:26:47 - INFO - GPT prediction: 84984000.0
2024-09-20 13:26:47 - INFO - Attempting prediction for ml
2024-09-20 13:26:47 - INFO - ML prediction: 85157836.19999999
2024-09-20 13:26:47 - INFO - Attempting prediction for xgboost
2024-09-20 13:26:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:26:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:26:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:26:47 - INFO - XGBOOST prediction: 84937000.0
2024-09-20 13:26:47 - INFO - Attempting prediction for lstm
2024-09-20 13:26:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:26:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:26:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:26:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:26:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:26:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:26:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:26:47 - INFO - X 샘플:
[[-1.59836615 -1.65347733 -1.87746409 -1.62101083 -0.82034923 -0.82254691
  -1.62101083]
 [-1.04550739 -0.64873504 -1.03479619 -0.92936502 -0.18565031 -0.19188003
  -0.92936502]
 [-0.48593375 -0.7356839  -0.60503556 -0.78232221 -0.86945119 -0.8684275
  -0.78232221]
 [-0.36058925 -0.51589652 -0.25954172 -0.47462151 -0.47125466 -0.47292083
  -0.47462151]
 [-0.38968708 -0.60043013 -0.22021721 -0.50729769 -0.92043735 -0.91840312
  -0.50729769]
 [-0.26881918 -0.2043298  -0.20617275  0.03185928 -0.4799189  -0.48037406
   0.03185928]
 [ 0.23703539  0.37049872  0.56627283  0.56829323  0.18672994  0.18539154
   0.56829323]
 [ 0.68021772  1.00329314  1.12805144  1.37702868  2.59550622  2.59300286
   1.37702868]
 [ 1.7187864   1.62884182  1.51848757  1.64933018  0.48704875  0.49434579
   1.64933018]
 [ 1.5128633   1.35591904  0.99041568  0.68810589  0.47777673  0.48181224
   0.68810589]]
2024-09-20 13:26:47 - INFO - y 샘플:
[0.68810589]
2024-09-20 13:26:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:26:47 - INFO - 모델 출력 (스케일링된 예측): [[0.57704353]]
2024-09-20 13:26:47 - INFO - 스케일러 역변환 후 예측 가격: 84896213.4612074
2024-09-20 13:26:47 - INFO - LSTMPredictor 최종 예측 가격: 84896213.4612074
2024-09-20 13:26:47 - INFO - LSTM prediction: 84896213.4612074
2024-09-20 13:26:47 - INFO - Attempting prediction for rl
2024-09-20 13:26:47 - INFO - Preparing state for RL agent.
2024-09-20 13:26:47 - INFO - Prepared state: [[ 8.49370000e+07  5.09252068e+01 -4.13882049e-03  8.43175500e+07
   6.39725888e+01]]
2024-09-20 13:26:47 - INFO - RL prediction: 85833840.0
2024-09-20 13:26:47 - INFO - Attempting prediction for arima
2024-09-20 13:26:47 - INFO - ARIMA 예측 시작
2024-09-20 13:26:47 - INFO - 입력 데이터: {'open': 85346000.0, 'high': 85346000.0, 'low': 84921000.0, 'close': 84937000.0, 'volume': 50.92520681, 'value': 4336253335.40107, 'decision': 'sell', 'sma': 84317550.0, 'ema': 84466551.30516054, 'rsi': 63.97258883827259, 'macd': 288179.8854364753, 'signal_line': 177871.90026643738, 'BB_Upper': 85244145.8072437, 'BB_Lower': 83390954.1927563}
2024-09-20 13:26:47 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:26:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84317550.0         0         0
2024-09-20 13:26:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84317550.0         0         0
2024-09-20 13:26:47 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:26:47 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:26:47 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:26:47 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:26:47 - INFO - Attempting prediction for prophet
2024-09-20 13:26:48 - INFO - PROPHET prediction: 85019676.30073342
2024-09-20 13:26:48 - INFO - Attempting prediction for transformer
2024-09-20 13:26:48 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:26:48 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:26:48 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:26:48 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:26:48 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:26:48 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:26:48 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:26:48 - INFO - X 샘플:
[[-1.59836615 -1.65347733 -1.87746409 -1.62101083 -0.82034923 -0.82254691
  -1.62101083 -1.62101083  0.          0.          0.         -1.62101083
  -1.62101083]
 [-1.04550739 -0.64873504 -1.03479619 -0.92936502 -0.18565031 -0.19188003
  -0.92936502 -0.92936502  0.          0.          0.         -0.92936502
  -0.92936502]
 [-0.48593375 -0.7356839  -0.60503556 -0.78232221 -0.86945119 -0.8684275
  -0.78232221 -0.78232221  0.          0.          0.         -0.78232221
  -0.78232221]
 [-0.36058925 -0.51589652 -0.25954172 -0.47462151 -0.47125466 -0.47292083
  -0.47462151 -0.47462151  0.          0.          0.         -0.47462151
  -0.47462151]
 [-0.38968708 -0.60043013 -0.22021721 -0.50729769 -0.92043735 -0.91840312
  -0.50729769 -0.50729769  0.          0.          0.         -0.50729769
  -0.50729769]
 [-0.26881918 -0.2043298  -0.20617275  0.03185928 -0.4799189  -0.48037406
   0.03185928  0.03185928  0.          0.          0.          0.03185928
   0.03185928]
 [ 0.23703539  0.37049872  0.56627283  0.56829323  0.18672994  0.18539154
   0.56829323  0.56829323  0.          0.          0.          0.56829323
   0.56829323]
 [ 0.68021772  1.00329314  1.12805144  1.37702868  2.59550622  2.59300286
   1.37702868  1.37702868  0.          0.          0.          1.37702868
   1.37702868]
 [ 1.7187864   1.62884182  1.51848757  1.64933018  0.48704875  0.49434579
   1.64933018  1.64933018  0.          0.          0.          1.64933018
   1.64933018]
 [ 1.5128633   1.35591904  0.99041568  0.68810589  0.47777673  0.48181224
   0.68810589  0.68810589  0.          0.          0.          0.68810589
   0.68810589]]
2024-09-20 13:26:48 - INFO - y 샘플:
[0.68810589]
2024-09-20 13:26:48 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:26:48 - INFO - 모델 출력 (스케일링된 예측): [0.31241262]
2024-09-20 13:26:48 - INFO - 스케일러 역변환 후 예측 가격: 84799030.40718584
2024-09-20 13:26:48 - INFO - TransformerPredictor 최종 예측 가격: 84799030.40718584
2024-09-20 13:26:48 - INFO - TRANSFORMER prediction: 84799030.40718584
2024-09-20 13:26:48 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:26:48 - INFO - BITCOIN_FORECAST prediction: 83809515.07705566
2024-09-20 13:26:48 - INFO - BitcoinForecast prediction: 83809515.07705566
2024-09-20 13:26:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:55 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:56 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:57 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:26:57 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:26:57 - INFO - 조정된 모델 가중치: {'gpt': 0.003070514222210759, 'ml': 0.11430765977760135, 'xgboost': 0.01589330209294757, 'rl': 0.11430765977760135, 'lstm': 0.06861818134734046, 'arima': 0.11655334507561545, 'prophet': 0.3424656961443586, 'transformer': 0.06861818134734046, 'bitcoin_forecast': 0.15616546021498387}
2024-09-20 13:26:57 - INFO - 조정된 모델 가중치: {'gpt': 0.003070514222210759, 'ml': 0.11430765977760135, 'xgboost': 0.01589330209294757, 'rl': 0.11430765977760135, 'lstm': 0.06861818134734046, 'arima': 0.11655334507561545, 'prophet': 0.3424656961443586, 'transformer': 0.06861818134734046, 'bitcoin_forecast': 0.15616546021498387}
2024-09-20 13:26:57 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84899748.59214894, 'current_price': 84984000.0, 'predictions': {'gpt': 84984000.0, 'ml': 85157836.19999999, 'xgboost': 84937000.0, 'lstm': 84896213.4612074, 'rl': 85833840.0, 'arima': 84893000.0, 'prophet': 85019676.30073342, 'transformer': 84799030.40718584, 'bitcoin_forecast': 83809515.07705566}, 'weights': {'gpt': 0.003070514222210759, 'ml': 0.11430765977760135, 'xgboost': 0.01589330209294757, 'rl': 0.11430765977760135, 'lstm': 0.06861818134734046, 'arima': 0.11655334507561545, 'prophet': 0.3424656961443586, 'transformer': 0.06861818134734046, 'bitcoin_forecast': 0.15616546021498387}}
2024-09-20 13:26:57 - INFO - 모델별 가중치:
2024-09-20 13:26:57 - INFO -   - GPT: 0.0031
2024-09-20 13:26:57 - INFO -   - ML: 0.1143
2024-09-20 13:26:57 - INFO -   - XGBOOST: 0.0159
2024-09-20 13:26:57 - INFO -   - RL: 0.1143
2024-09-20 13:26:57 - INFO -   - LSTM: 0.0686
2024-09-20 13:26:57 - INFO -   - ARIMA: 0.1166
2024-09-20 13:26:57 - INFO -   - PROPHET: 0.3425
2024-09-20 13:26:57 - INFO -   - TRANSFORMER: 0.0686
2024-09-20 13:26:57 - INFO -   - BITCOIN_FORECAST: 0.1562
2024-09-20 13:26:57 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:26:57 - INFO - 6. 거래 실행
2024-09-20 13:26:57 - INFO - Cancelling existing orders.
2024-09-20 13:26:57 - INFO - Cancelled 0 orders.
2024-09-20 13:26:57 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84899748.59214894, 'current_price': 84984000.0, 'predictions': {'gpt': 84984000.0, 'ml': 85157836.19999999, 'xgboost': 84937000.0, 'lstm': 84896213.4612074, 'rl': 85833840.0, 'arima': 84893000.0, 'prophet': 85019676.30073342, 'transformer': 84799030.40718584, 'bitcoin_forecast': 83809515.07705566}, 'weights': {'gpt': 0.003070514222210759, 'ml': 0.11430765977760135, 'xgboost': 0.01589330209294757, 'rl': 0.11430765977760135, 'lstm': 0.06861818134734046, 'arima': 0.11655334507561545, 'prophet': 0.3424656961443586, 'transformer': 0.06861818134734046, 'bitcoin_forecast': 0.15616546021498387}}, 현재 가격=84984000.0
2024-09-20 13:26:57 - INFO - 현재 잔고: KRW=293943.57738053, BTC=0.00218504, 총 자산가치=479637.01674053003
2024-09-20 13:26:57 - INFO - 매도 시도: 0.000218504 BTC (약 18569.343936 KRW)
2024-09-20 13:26:57 - INFO - 주문 결과: {'uuid': '049b8429-3f25-4313-b3a5-c1a1f3f8ae78', 'side': 'ask', 'ord_type': 'limit', 'price': '84984000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:26:59+09:00', 'volume': '0.0002185', 'remaining_volume': '0.0002185', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.0002185', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:26:57 - INFO - sell 주문 성공: UUID=049b8429-3f25-4313-b3a5-c1a1f3f8ae78
2024-09-20 13:26:57 - INFO - Trade executed successfully.
2024-09-20 13:26:57 - INFO - 7. summary 리포트 보내기
2024-09-20 13:26:58 - INFO - Message sent to Discord successfully.
2024-09-20 13:26:58 - INFO - Trading cycle completed.
2024-09-20 13:26:58 - INFO - Performing periodic update.
2024-09-20 13:26:58 - INFO - 계산된 시장 변동성: 0.030933231489662916
2024-09-20 13:35:43 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:35:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8141-b9f2-f968dbdbf1a1 "HTTP/1.1 200 OK"
2024-09-20 13:35:44 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:35:49 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:35:51 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a8-87e5-c48282f0cbd5 "HTTP/1.1 200 OK"
2024-09-20 13:35:51 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:35:57 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:35:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8163-a640-d70e05f41995 "HTTP/1.1 200 OK"
2024-09-20 13:35:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8176-b8ef-ea565e1a21ed "HTTP/1.1 200 OK"
2024-09-20 13:36:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:10 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/64561af4-d0e5-4a35-9307-87c12f1369d7 "HTTP/1.1 200 OK"
2024-09-20 13:36:10 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c5-9914-fbc4e9a52021 "HTTP/1.1 200 OK"
2024-09-20 13:36:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:21 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-811e-af83-d4146b557273 "HTTP/1.1 200 OK"
2024-09-20 13:36:21 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81de-9256-ff30167bbb9d "HTTP/1.1 200 OK"
2024-09-20 13:36:26 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:36:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a3-a0f0-de8d37bceb25 "HTTP/1.1 200 OK"
2024-09-20 13:36:33 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:25:34.976783
2024-09-20 13:36:33 - INFO - Starting trading cycle.
2024-09-20 13:36:33 - INFO - ##################################################
2024-09-20 13:36:33 - INFO - 3 회 예측 후 모델 재학습 검토
2024-09-20 13:36:33 - INFO - ##################################################
2024-09-20 13:36:33 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:36:33 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:36:33 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:20:00
2024-09-20 13:36:33 - INFO - 새로운 데이터 범위: 2024-09-19 04:20:00 ~ 2024-09-20 13:30:00
2024-09-20 13:36:33 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:36:33 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:36:33 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:36:33 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:36:33 - INFO - Sample date values: [Timestamp('2024-09-20 13:30:00')]
2024-09-20 13:36:34 - INFO - Successfully added 1 new data points
2024-09-20 13:36:34 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:36:34 - INFO - Final date range: 2024-09-20 13:30:00 to 2024-09-20 13:30:00
2024-09-20 13:36:34 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:36:34 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:30:00
2024-09-20 13:36:34 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:36:34 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:36:34 - INFO - GPT | 이전예측가격: 84984000 | 당시BTC가격: 84984000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:36:34 - INFO - ML 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 13:36:34 - INFO - ML | 이전예측가격: 85157836 | 당시BTC가격: 84984000 | 예측: 상승 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0559 | 반영가중치값: -0.0200 | 새 가중치: 0.0359 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 13:36:34 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.63%, 적중/전체: 77/127
2024-09-20 13:36:34 - INFO - XGBOOST | 이전예측가격: 84937000 | 당시BTC가격: 84984000 | 예측: 하락 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0162 | 반영가중치값: 0.0200 | 새 가중치: 0.0362 | 예측 총 횟수: 127 | 예측 성공 수: 77 | 예측 성공률: 60.63%
2024-09-20 13:36:34 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 15/25
2024-09-20 13:36:34 - INFO - LSTM | 이전예측가격: 84896213 | 당시BTC가격: 84984000 | 예측: 하락 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1382 | 반영가중치값: 0.0200 | 새 가중치: 0.1582 | 예측 총 횟수: 25 | 예측 성공 수: 15 | 예측 성공률: 60.00%
2024-09-20 13:36:34 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 3/5
2024-09-20 13:36:34 - INFO - RL | 이전예측가격: 85833840 | 당시BTC가격: 84984000 | 예측: 상승 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1781 | 반영가중치값: -0.0200 | 새 가중치: 0.1581 | 예측 총 횟수: 5 | 예측 성공 수: 3 | 예측 성공률: 60.00%
2024-09-20 13:36:34 - INFO - ARIMA 모델 예측 업데이트: 정확도 40.00%, 적중/전체: 2/5
2024-09-20 13:36:34 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84984000 | 예측: 하락 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0953 | 반영가중치값: 0.0200 | 새 가중치: 0.1153 | 예측 총 횟수: 5 | 예측 성공 수: 2 | 예측 성공률: 40.00%
2024-09-20 13:36:34 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.65%, 적중/전체: 68/114
2024-09-20 13:36:34 - INFO - PROPHET | 이전예측가격: 85019676 | 당시BTC가격: 84984000 | 예측: 상승 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2775 | 반영가중치값: -0.0200 | 새 가중치: 0.2575 | 예측 총 횟수: 114 | 예측 성공 수: 68 | 예측 성공률: 59.65%
2024-09-20 13:36:34 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 15/25
2024-09-20 13:36:34 - INFO - TRANSFORMER | 이전예측가격: 84799030 | 당시BTC가격: 84984000 | 예측: 하락 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1671 | 반영가중치값: 0.0200 | 새 가중치: 0.1871 | 예측 총 횟수: 25 | 예측 성공 수: 15 | 예측 성공률: 60.00%
2024-09-20 13:36:34 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.92%, 적중/전체: 37/65
2024-09-20 13:36:34 - INFO - BITCOIN_FORECAST | 이전예측가격: 83809515 | 당시BTC가격: 84984000 | 예측: 하락 | 지금 BTC가격: 84899000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0686 | 반영가중치값: 0.0200 | 새 가중치: 0.0886 | 예측 총 횟수: 65 | 예측 성공 수: 37 | 예측 성공률: 56.92%
2024-09-20 13:36:34 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:36:34 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:36:34 - INFO - 새로운 가중치: {'gpt': 0.002952599183532497, 'ml': 0.03451689491311858, 'xgboost': 0.034833399617296174, 'rl': 0.15205228693885073, 'lstm': 0.15217202905728922, 'arima': 0.11083730547140358, 'prophet': 0.24756679912408666, 'transformer': 0.1798773148685022, 'bitcoin_forecast': 0.08519137082592046}
2024-09-20 13:36:34 - INFO - XGBoost 모델 성능: 정확도 60.63%, 적중/전체: 77/127
2024-09-20 13:36:34 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:36:34 - INFO - Current BTC price: 84899000.0
2024-09-20 13:36:34 - INFO - Analyzing market conditions.
2024-09-20 13:36:34 - INFO - Market analysis: {'current_price': 84899000.0, 'sma_20': 84380700.0, 'rsi_14': 62.79807865889414, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 13:36:34 - INFO - Starting predictions for all models
2024-09-20 13:36:34 - INFO - Attempting prediction for gpt
2024-09-20 13:36:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:36:34 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:36:34 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:36:34 - INFO - GPT prediction: 84899000.0
2024-09-20 13:36:34 - INFO - Attempting prediction for ml
2024-09-20 13:36:34 - INFO - ML prediction: 85085777.8
2024-09-20 13:36:34 - INFO - Attempting prediction for xgboost
2024-09-20 13:36:34 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:36:34 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:36:34 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:36:34 - INFO - XGBOOST prediction: 84899000.0
2024-09-20 13:36:34 - INFO - Attempting prediction for lstm
2024-09-20 13:36:34 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:36:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:36:34 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:36:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:36:34 - INFO - X 샘플:
[[-1.48219096 -1.02863811 -1.62591182 -1.35261158 -0.29187322 -0.2986861
  -1.35261158]
 [-0.83267696 -1.13219228 -1.09402277 -1.17965154 -1.00271448 -1.00213914
  -1.17965154]
 [-0.68718582 -0.87043035 -0.66642569 -0.81771664 -0.58877157 -0.5909036
  -0.81771664]
 [-0.72096055 -0.97110802 -0.61775611 -0.8561522  -1.05571685 -1.05410223
  -0.8561522 ]
 [-0.58066552 -0.49936123 -0.60037411 -0.22196539 -0.59777843 -0.59865322
  -0.22196539]
 [ 0.00649514  0.18524691  0.35563562  0.40901847  0.09523252  0.09358916
   0.40901847]
 [ 0.52091023  0.93889116  1.05091542  1.36029869  2.59926202  2.5969486
   1.36029869]
 [ 1.72640823  1.6839059   1.53413489  1.68059506  0.40742721  0.41483019
   1.68059506]
 [ 1.48738708  1.35886086  0.88057187  0.54994887  0.39778853  0.4017982
   0.54994887]
 [ 0.56247913  0.33482516  0.7832327   0.42823625  0.03714427  0.03731814
   0.42823625]]
2024-09-20 13:36:34 - INFO - y 샘플:
[0.42823625]
2024-09-20 13:36:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:36:34 - INFO - 모델 출력 (스케일링된 예측): [[0.4927731]]
2024-09-20 13:36:34 - INFO - 스케일러 역변환 후 예측 가격: 84919149.10015136
2024-09-20 13:36:34 - INFO - LSTMPredictor 최종 예측 가격: 84919149.10015136
2024-09-20 13:36:34 - INFO - LSTM prediction: 84919149.10015136
2024-09-20 13:36:34 - INFO - Attempting prediction for rl
2024-09-20 13:36:34 - INFO - Preparing state for RL agent.
2024-09-20 13:36:34 - INFO - Prepared state: [[ 8.48990000e+07  4.14420343e+01 -4.47390419e-04  8.43807000e+07
   6.27980787e+01]]
2024-09-20 13:36:34 - INFO - RL prediction: 85747990.0
2024-09-20 13:36:34 - INFO - Attempting prediction for arima
2024-09-20 13:36:34 - INFO - ARIMA 예측 시작
2024-09-20 13:36:34 - INFO - 입력 데이터: {'open': 84990000.0, 'high': 84990000.0, 'low': 84893000.0, 'close': 84899000.0, 'volume': 41.44203432, 'value': 3519505782.96541, 'decision': 'sell', 'sma': 84380700.0, 'ema': 84507736.89514525, 'rsi': 62.79807865889414, 'macd': 285243.29007071257, 'signal_line': 199346.17822729243, 'BB_Upper': 85284770.15214707, 'BB_Lower': 83476629.84785293}
2024-09-20 13:36:34 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:36:34 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84380700.0         0         0
2024-09-20 13:36:34 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84380700.0         0         0
2024-09-20 13:36:34 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:36:34 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:36:34 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:36:34 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:36:34 - INFO - Attempting prediction for prophet
2024-09-20 13:36:34 - INFO - PROPHET prediction: 84969024.82250078
2024-09-20 13:36:34 - INFO - Attempting prediction for transformer
2024-09-20 13:36:34 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:36:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:36:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:36:34 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:36:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:36:34 - INFO - X 샘플:
[[-1.48219096 -1.02863811 -1.62591182 -1.35261158 -0.29187322 -0.2986861
  -1.35261158 -1.35261158  0.          0.          0.         -1.35261158
  -1.35261158]
 [-0.83267696 -1.13219228 -1.09402277 -1.17965154 -1.00271448 -1.00213914
  -1.17965154 -1.17965154  0.          0.          0.         -1.17965154
  -1.17965154]
 [-0.68718582 -0.87043035 -0.66642569 -0.81771664 -0.58877157 -0.5909036
  -0.81771664 -0.81771664  0.          0.          0.         -0.81771664
  -0.81771664]
 [-0.72096055 -0.97110802 -0.61775611 -0.8561522  -1.05571685 -1.05410223
  -0.8561522  -0.8561522   0.          0.          0.         -0.8561522
  -0.8561522 ]
 [-0.58066552 -0.49936123 -0.60037411 -0.22196539 -0.59777843 -0.59865322
  -0.22196539 -0.22196539  0.          0.          0.         -0.22196539
  -0.22196539]
 [ 0.00649514  0.18524691  0.35563562  0.40901847  0.09523252  0.09358916
   0.40901847  0.40901847  0.          0.          0.          0.40901847
   0.40901847]
 [ 0.52091023  0.93889116  1.05091542  1.36029869  2.59926202  2.5969486
   1.36029869  1.36029869  0.          0.          0.          1.36029869
   1.36029869]
 [ 1.72640823  1.6839059   1.53413489  1.68059506  0.40742721  0.41483019
   1.68059506  1.68059506  0.          0.          0.          1.68059506
   1.68059506]
 [ 1.48738708  1.35886086  0.88057187  0.54994887  0.39778853  0.4017982
   0.54994887  0.54994887  0.          0.          0.          0.54994887
   0.54994887]
 [ 0.56247913  0.33482516  0.7832327   0.42823625  0.03714427  0.03731814
   0.42823625  0.42823625  0.          0.          0.          0.42823625
   0.42823625]]
2024-09-20 13:36:34 - INFO - y 샘플:
[0.42823625]
2024-09-20 13:36:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:36:34 - INFO - 모델 출력 (스케일링된 예측): [0.3116628]
2024-09-20 13:36:34 - INFO - 스케일러 역변환 후 예측 가격: 84862604.5031411
2024-09-20 13:36:34 - INFO - TransformerPredictor 최종 예측 가격: 84862604.5031411
2024-09-20 13:36:34 - INFO - TRANSFORMER prediction: 84862604.5031411
2024-09-20 13:36:34 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:36:34 - INFO - BITCOIN_FORECAST prediction: 83749891.83505654
2024-09-20 13:36:34 - INFO - BitcoinForecast prediction: 83749891.83505654
2024-09-20 13:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:36:40 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:36:40 - INFO - 조정된 모델 가중치: {'gpt': 0.002952599183532497, 'ml': 0.03451689491311858, 'xgboost': 0.034833399617296174, 'rl': 0.15205228693885073, 'lstm': 0.15217202905728922, 'arima': 0.11083730547140358, 'prophet': 0.24756679912408666, 'transformer': 0.1798773148685022, 'bitcoin_forecast': 0.08519137082592046}
2024-09-20 13:36:40 - INFO - 조정된 모델 가중치: {'gpt': 0.002952599183532497, 'ml': 0.03451689491311858, 'xgboost': 0.034833399617296174, 'rl': 0.15205228693885073, 'lstm': 0.15217202905728922, 'arima': 0.11083730547140358, 'prophet': 0.24756679912408666, 'transformer': 0.1798773148685022, 'bitcoin_forecast': 0.08519137082592046}
2024-09-20 13:36:40 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84949833.96352248, 'current_price': 84899000.0, 'predictions': {'gpt': 84899000.0, 'ml': 85085777.8, 'xgboost': 84899000.0, 'lstm': 84919149.10015136, 'rl': 85747990.0, 'arima': 84893000.0, 'prophet': 84969024.82250078, 'transformer': 84862604.5031411, 'bitcoin_forecast': 83749891.83505654}, 'weights': {'gpt': 0.002952599183532497, 'ml': 0.03451689491311858, 'xgboost': 0.034833399617296174, 'rl': 0.15205228693885073, 'lstm': 0.15217202905728922, 'arima': 0.11083730547140358, 'prophet': 0.24756679912408666, 'transformer': 0.1798773148685022, 'bitcoin_forecast': 0.08519137082592046}}
2024-09-20 13:36:40 - INFO - 모델별 가중치:
2024-09-20 13:36:40 - INFO -   - GPT: 0.0030
2024-09-20 13:36:40 - INFO -   - ML: 0.0345
2024-09-20 13:36:40 - INFO -   - XGBOOST: 0.0348
2024-09-20 13:36:40 - INFO -   - RL: 0.1521
2024-09-20 13:36:40 - INFO -   - LSTM: 0.1522
2024-09-20 13:36:40 - INFO -   - ARIMA: 0.1108
2024-09-20 13:36:40 - INFO -   - PROPHET: 0.2476
2024-09-20 13:36:40 - INFO -   - TRANSFORMER: 0.1799
2024-09-20 13:36:40 - INFO -   - BITCOIN_FORECAST: 0.0852
2024-09-20 13:36:40 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:36:41 - INFO - 6. 거래 실행
2024-09-20 13:36:41 - INFO - Cancelling existing orders.
2024-09-20 13:36:41 - INFO - Cancelled 0 orders.
2024-09-20 13:36:41 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84949833.96352248, 'current_price': 84899000.0, 'predictions': {'gpt': 84899000.0, 'ml': 85085777.8, 'xgboost': 84899000.0, 'lstm': 84919149.10015136, 'rl': 85747990.0, 'arima': 84893000.0, 'prophet': 84969024.82250078, 'transformer': 84862604.5031411, 'bitcoin_forecast': 83749891.83505654}, 'weights': {'gpt': 0.002952599183532497, 'ml': 0.03451689491311858, 'xgboost': 0.034833399617296174, 'rl': 0.15205228693885073, 'lstm': 0.15217202905728922, 'arima': 0.11083730547140358, 'prophet': 0.24756679912408666, 'transformer': 0.1798773148685022, 'bitcoin_forecast': 0.08519137082592046}}, 현재 가격=84899000.0
2024-09-20 13:36:41 - INFO - 현재 잔고: KRW=312503.29687853, BTC=0.00196654, 총 자산가치=479460.57633853005
2024-09-20 13:36:41 - INFO - 매수 시도: 0.0005647423130290464 BTC (약 47946.05763385301 KRW)
2024-09-20 13:36:41 - INFO - 주문 결과: {'uuid': 'eac6ec19-56af-4c1e-8660-c3480d8ba6c9', 'side': 'bid', 'ord_type': 'limit', 'price': '84899000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:36:42+09:00', 'volume': '0.00056474', 'remaining_volume': '0.00056474', 'reserved_fee': '23.97293063', 'remaining_fee': '23.97293063', 'paid_fee': '0', 'locked': '47969.83419063', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:36:41 - INFO - buy 주문 성공: UUID=eac6ec19-56af-4c1e-8660-c3480d8ba6c9
2024-09-20 13:36:41 - INFO - Trade executed successfully.
2024-09-20 13:36:41 - INFO - 7. summary 리포트 보내기
2024-09-20 13:36:41 - INFO - Message sent to Discord successfully.
2024-09-20 13:36:41 - INFO - Trading cycle completed.
2024-09-20 13:36:41 - INFO - Performing periodic update.
2024-09-20 13:36:41 - INFO - 계산된 시장 변동성: 0.03025460529130673
2024-09-20 13:45:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:45:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81aa-8bbd-cf4ae3056c46 "HTTP/1.1 200 OK"
2024-09-20 13:45:40 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:45:45 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:45:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a0-84a2-decff18b31c7 "HTTP/1.1 200 OK"
2024-09-20 13:45:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:45:52 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:45:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a7-8bb5-ea17e450529a "HTTP/1.1 200 OK"
2024-09-20 13:45:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8173-bde7-fad36be7da22 "HTTP/1.1 200 OK"
2024-09-20 13:46:09 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:14 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818e-8849-c9316af75dcd "HTTP/1.1 200 OK"
2024-09-20 13:46:14 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8119-a1f9-e5ff17ddc4cc "HTTP/1.1 200 OK"
2024-09-20 13:46:20 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f3-bc37-d7b6bf5fb395 "HTTP/1.1 200 OK"
2024-09-20 13:46:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:33 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817d-9598-f4454c9b6db3 "HTTP/1.1 200 OK"
2024-09-20 13:46:34 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:46:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f1-8f29-db9d6cc1d929 "HTTP/1.1 200 OK"
2024-09-20 13:46:39 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:35:34.977154
2024-09-20 13:46:39 - INFO - Starting trading cycle.
2024-09-20 13:46:39 - INFO - ##################################################
2024-09-20 13:46:39 - INFO - 4 회 예측 후 모델 재학습 검토
2024-09-20 13:46:39 - INFO - ##################################################
2024-09-20 13:46:39 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:46:39 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:46:39 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:30:00
2024-09-20 13:46:39 - INFO - 새로운 데이터 범위: 2024-09-19 04:30:00 ~ 2024-09-20 13:40:00
2024-09-20 13:46:39 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:46:39 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:46:39 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:46:39 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:46:39 - INFO - Sample date values: [Timestamp('2024-09-20 13:40:00')]
2024-09-20 13:46:39 - INFO - Successfully added 1 new data points
2024-09-20 13:46:39 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:46:39 - INFO - Final date range: 2024-09-20 13:40:00 to 2024-09-20 13:40:00
2024-09-20 13:46:39 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:46:39 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:40:00
2024-09-20 13:46:39 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:46:39 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:46:39 - INFO - GPT | 이전예측가격: 84899000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:46:39 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-20 13:46:39 - INFO - ML | 이전예측가격: 85085778 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1143 | 반영가중치값: 0.0200 | 새 가중치: 0.1343 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-20 13:46:39 - INFO - XGBOOST | 이전예측가격: 84899000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:46:39 - INFO - LSTM 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 16/26
2024-09-20 13:46:39 - INFO - LSTM | 이전예측가격: 84919149 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0686 | 반영가중치값: 0.0200 | 새 가중치: 0.0886 | 예측 총 횟수: 26 | 예측 성공 수: 16 | 예측 성공률: 61.54%
2024-09-20 13:46:39 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 4/6
2024-09-20 13:46:40 - INFO - RL | 이전예측가격: 85747990 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1143 | 반영가중치값: 0.0200 | 새 가중치: 0.1343 | 예측 총 횟수: 6 | 예측 성공 수: 4 | 예측 성공률: 66.67%
2024-09-20 13:46:40 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:46:40 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 69/115
2024-09-20 13:46:40 - INFO - PROPHET | 이전예측가격: 84969025 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3425 | 반영가중치값: 0.0200 | 새 가중치: 0.3625 | 예측 총 횟수: 115 | 예측 성공 수: 69 | 예측 성공률: 60.00%
2024-09-20 13:46:40 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.69%, 적중/전체: 15/26
2024-09-20 13:46:40 - INFO - TRANSFORMER | 이전예측가격: 84862605 | 당시BTC가격: 84899000 | 예측: 하락 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0686 | 반영가중치값: -0.0200 | 새 가중치: 0.0486 | 예측 총 횟수: 26 | 예측 성공 수: 15 | 예측 성공률: 57.69%
2024-09-20 13:46:40 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.06%, 적중/전체: 37/66
2024-09-20 13:46:40 - INFO - BITCOIN_FORECAST | 이전예측가격: 83749892 | 당시BTC가격: 84899000 | 예측: 하락 | 지금 BTC가격: 85180000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1562 | 반영가중치값: -0.0200 | 새 가중치: 0.1362 | 예측 총 횟수: 66 | 예측 성공 수: 37 | 예측 성공률: 56.06%
2024-09-20 13:46:40 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:46:40 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:46:40 - INFO - 새로운 가중치: {'gpt': 0.0028037052138483757, 'ml': 0.12753477955233952, 'xgboost': 0.03307681742505718, 'rl': 0.12753477955233952, 'lstm': 0.08414933475258977, 'arima': 0.10524799064236381, 'prophet': 0.344187239429254, 'transformer': 0.04616645879048215, 'bitcoin_forecast': 0.12929889464172575}
2024-09-20 13:46:40 - INFO - XGBoost 모델 성능: 정확도 60.63%, 적중/전체: 77/127
2024-09-20 13:46:40 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:46:40 - INFO - Current BTC price: 85180000.0
2024-09-20 13:46:40 - INFO - Analyzing market conditions.
2024-09-20 13:46:40 - INFO - Market analysis: {'current_price': 85191000.0, 'sma_20': 84455350.0, 'rsi_14': 67.7047350825135, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 13:46:40 - INFO - Starting predictions for all models
2024-09-20 13:46:40 - INFO - Attempting prediction for gpt
2024-09-20 13:46:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:46:40 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:46:40 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:46:40 - INFO - GPT prediction: 85180000.0
2024-09-20 13:46:40 - INFO - Attempting prediction for ml
2024-09-20 13:46:40 - INFO - ML prediction: 85378420.2
2024-09-20 13:46:40 - INFO - Attempting prediction for xgboost
2024-09-20 13:46:40 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:46:40 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:46:40 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:46:40 - INFO - XGBOOST prediction: 85191000.0
2024-09-20 13:46:40 - INFO - Attempting prediction for lstm
2024-09-20 13:46:40 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:46:40 - INFO - X 샘플:
[[-1.17587489 -1.36730037 -1.55096813 -1.50554919 -1.00094833 -1.00182492
  -1.50554919]
 [-1.00946348 -1.09960602 -1.06018069 -1.13007566 -0.58717314 -0.59061916
  -1.13007566]
 [-1.0480947  -1.20256539 -1.0043187  -1.16994895 -1.05392923 -1.05378425
  -1.16994895]
 [-0.88762656 -0.72012722 -0.98436799 -0.51203957 -0.59617635 -0.59836823
  -0.51203957]
 [-0.21603767 -0.02000353  0.11292101  0.14254703  0.09655383  0.09382401
   0.14254703]
 [ 0.37234552  0.75072086  0.91094938  1.1294111   2.59956879  2.59700213
   1.1294111 ]
 [ 1.75118289  1.51262016  1.4655791   1.46168856  0.40862202  0.41504178
   1.46168856]
 [ 1.47779272  1.18020849  0.71543243  0.28874912  0.39898725  0.40201073
   0.28874912]
 [ 0.41989164  0.13296467  0.60370846  0.16248368  0.03848911  0.03755707
   0.16248368]
 [ 0.31588451  0.83308835  0.79124513  1.13273388 -0.30399394 -0.30083917
   1.13273388]]
2024-09-20 13:46:40 - INFO - y 샘플:
[1.13273388]
2024-09-20 13:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:46:40 - INFO - 모델 출력 (스케일링된 예측): [[0.43421254]]
2024-09-20 13:46:40 - INFO - 스케일러 역변환 후 예측 가격: 84980777.6963756
2024-09-20 13:46:40 - INFO - LSTMPredictor 최종 예측 가격: 84980777.6963756
2024-09-20 13:46:40 - INFO - LSTM prediction: 84980777.6963756
2024-09-20 13:46:40 - INFO - Attempting prediction for rl
2024-09-20 13:46:40 - INFO - Preparing state for RL agent.
2024-09-20 13:46:40 - INFO - Prepared state: [[8.51910000e+07 3.24327624e+01 3.43938091e-03 8.44553500e+07
  6.77047351e+01]]
2024-09-20 13:46:40 - INFO - RL prediction: 86031800.0
2024-09-20 13:46:40 - INFO - Attempting prediction for arima
2024-09-20 13:46:40 - INFO - ARIMA 예측 시작
2024-09-20 13:46:40 - INFO - 입력 데이터: {'open': 84955000.0, 'high': 85228000.0, 'low': 84940000.0, 'close': 85191000.0, 'volume': 32.43276239, 'value': 2761153388.07502, 'decision': 'sell', 'sma': 84455350.0, 'ema': 84572809.57179809, 'rsi': 67.7047350825135, 'macd': 302985.35022494197, 'signal_line': 220074.01262682234, 'BB_Upper': 85368122.54012246, 'BB_Lower': 83542577.45987754}
2024-09-20 13:46:40 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:46:40 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84455350.0         0         0
2024-09-20 13:46:40 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84455350.0         0         0
2024-09-20 13:46:40 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:46:40 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:46:40 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:46:40 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:46:40 - INFO - Attempting prediction for prophet
2024-09-20 13:46:40 - INFO - PROPHET prediction: 85282475.1490371
2024-09-20 13:46:40 - INFO - Attempting prediction for transformer
2024-09-20 13:46:40 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:46:40 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:46:40 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:46:40 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:46:40 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:46:40 - INFO - X 샘플:
[[-1.17587489 -1.36730037 -1.55096813 -1.50554919 -1.00094833 -1.00182492
  -1.50554919 -1.50554919  0.          0.          0.         -1.50554919
  -1.50554919]
 [-1.00946348 -1.09960602 -1.06018069 -1.13007566 -0.58717314 -0.59061916
  -1.13007566 -1.13007566  0.          0.          0.         -1.13007566
  -1.13007566]
 [-1.0480947  -1.20256539 -1.0043187  -1.16994895 -1.05392923 -1.05378425
  -1.16994895 -1.16994895  0.          0.          0.         -1.16994895
  -1.16994895]
 [-0.88762656 -0.72012722 -0.98436799 -0.51203957 -0.59617635 -0.59836823
  -0.51203957 -0.51203957  0.          0.          0.         -0.51203957
  -0.51203957]
 [-0.21603767 -0.02000353  0.11292101  0.14254703  0.09655383  0.09382401
   0.14254703  0.14254703  0.          0.          0.          0.14254703
   0.14254703]
 [ 0.37234552  0.75072086  0.91094938  1.1294111   2.59956879  2.59700213
   1.1294111   1.1294111   0.          0.          0.          1.1294111
   1.1294111 ]
 [ 1.75118289  1.51262016  1.4655791   1.46168856  0.40862202  0.41504178
   1.46168856  1.46168856  0.          0.          0.          1.46168856
   1.46168856]
 [ 1.47779272  1.18020849  0.71543243  0.28874912  0.39898725  0.40201073
   0.28874912  0.28874912  0.          0.          0.          0.28874912
   0.28874912]
 [ 0.41989164  0.13296467  0.60370846  0.16248368  0.03848911  0.03755707
   0.16248368  0.16248368  0.          0.          0.          0.16248368
   0.16248368]
 [ 0.31588451  0.83308835  0.79124513  1.13273388 -0.30399394 -0.30083917
   1.13273388  1.13273388  0.          0.          0.          1.13273388
   1.13273388]]
2024-09-20 13:46:40 - INFO - y 샘플:
[1.13273388]
2024-09-20 13:46:40 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:46:40 - INFO - 모델 출력 (스케일링된 예측): [0.31228036]
2024-09-20 13:46:40 - INFO - 스케일러 역변환 후 예측 가격: 84944081.80456191
2024-09-20 13:46:40 - INFO - TransformerPredictor 최종 예측 가격: 84944081.80456191
2024-09-20 13:46:40 - INFO - TRANSFORMER prediction: 84944081.80456191
2024-09-20 13:46:40 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:46:40 - INFO - BITCOIN_FORECAST prediction: 83678701.72620153
2024-09-20 13:46:40 - INFO - BitcoinForecast prediction: 83678701.72620153
2024-09-20 13:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:46:44 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:46:44 - INFO - 조정된 모델 가중치: {'gpt': 0.0028037052138483757, 'ml': 0.12753477955233952, 'xgboost': 0.03307681742505718, 'rl': 0.12753477955233952, 'lstm': 0.08414933475258977, 'arima': 0.10524799064236381, 'prophet': 0.344187239429254, 'transformer': 0.04616645879048215, 'bitcoin_forecast': 0.12929889464172575}
2024-09-20 13:46:44 - INFO - 조정된 모델 가중치: {'gpt': 0.0028037052138483757, 'ml': 0.12753477955233952, 'xgboost': 0.03307681742505718, 'rl': 0.12753477955233952, 'lstm': 0.08414933475258977, 'arima': 0.10524799064236381, 'prophet': 0.344187239429254, 'transformer': 0.04616645879048215, 'bitcoin_forecast': 0.12929889464172575}
2024-09-20 13:46:44 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85097595.77272774, 'current_price': 85180000.0, 'predictions': {'gpt': 85180000.0, 'ml': 85378420.2, 'xgboost': 85191000.0, 'lstm': 84980777.6963756, 'rl': 86031800.0, 'arima': 84893000.0, 'prophet': 85282475.1490371, 'transformer': 84944081.80456191, 'bitcoin_forecast': 83678701.72620153}, 'weights': {'gpt': 0.0028037052138483757, 'ml': 0.12753477955233952, 'xgboost': 0.03307681742505718, 'rl': 0.12753477955233952, 'lstm': 0.08414933475258977, 'arima': 0.10524799064236381, 'prophet': 0.344187239429254, 'transformer': 0.04616645879048215, 'bitcoin_forecast': 0.12929889464172575}}
2024-09-20 13:46:44 - INFO - 모델별 가중치:
2024-09-20 13:46:44 - INFO -   - GPT: 0.0028
2024-09-20 13:46:44 - INFO -   - ML: 0.1275
2024-09-20 13:46:44 - INFO -   - XGBOOST: 0.0331
2024-09-20 13:46:44 - INFO -   - RL: 0.1275
2024-09-20 13:46:44 - INFO -   - LSTM: 0.0841
2024-09-20 13:46:44 - INFO -   - ARIMA: 0.1052
2024-09-20 13:46:44 - INFO -   - PROPHET: 0.3442
2024-09-20 13:46:44 - INFO -   - TRANSFORMER: 0.0462
2024-09-20 13:46:44 - INFO -   - BITCOIN_FORECAST: 0.1293
2024-09-20 13:46:44 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:46:44 - INFO - 6. 거래 실행
2024-09-20 13:46:44 - INFO - Cancelling existing orders.
2024-09-20 13:46:44 - INFO - Cancelled 0 orders.
2024-09-20 13:46:44 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85097595.77272774, 'current_price': 85180000.0, 'predictions': {'gpt': 85180000.0, 'ml': 85378420.2, 'xgboost': 85191000.0, 'lstm': 84980777.6963756, 'rl': 86031800.0, 'arima': 84893000.0, 'prophet': 85282475.1490371, 'transformer': 84944081.80456191, 'bitcoin_forecast': 83678701.72620153}, 'weights': {'gpt': 0.0028037052138483757, 'ml': 0.12753477955233952, 'xgboost': 0.03307681742505718, 'rl': 0.12753477955233952, 'lstm': 0.08414933475258977, 'arima': 0.10524799064236381, 'prophet': 0.344187239429254, 'transformer': 0.04616645879048215, 'bitcoin_forecast': 0.12929889464172575}}, 현재 가격=85180000.0
2024-09-20 13:46:44 - INFO - 현재 잔고: KRW=264533.4626879, BTC=0.00253128, 총 자산가치=480147.8930879
2024-09-20 13:46:44 - INFO - 매도 시도: 0.000253128 BTC (약 21561.44304 KRW)
2024-09-20 13:46:44 - INFO - 주문 결과: {'uuid': '2a515de0-3e00-4857-9047-adc1bb43f10b', 'side': 'ask', 'ord_type': 'limit', 'price': '85180000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:46:46+09:00', 'volume': '0.00025312', 'remaining_volume': '0.00025312', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00025312', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:46:44 - INFO - sell 주문 성공: UUID=2a515de0-3e00-4857-9047-adc1bb43f10b
2024-09-20 13:46:44 - INFO - Trade executed successfully.
2024-09-20 13:46:45 - INFO - 7. summary 리포트 보내기
2024-09-20 13:46:45 - INFO - Message sent to Discord successfully.
2024-09-20 13:46:45 - INFO - Trading cycle completed.
2024-09-20 13:46:45 - INFO - Performing periodic update.
2024-09-20 13:46:45 - INFO - 계산된 시장 변동성: 0.03069407874118387
2024-09-20 13:55:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:55:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815a-8418-ff663a2ff987 "HTTP/1.1 200 OK"
2024-09-20 13:55:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:55:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:55:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f2-80c3-c023fc5cfe3c "HTTP/1.1 200 OK"
2024-09-20 13:55:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:55:54 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:55:55 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8109-b628-ef95d6b41635 "HTTP/1.1 200 OK"
2024-09-20 13:55:55 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:55:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/f8df074b-0c9d-4736-b090-108fe4d57e7e "HTTP/1.1 200 OK"
2024-09-20 13:56:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:06 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815e-8ecc-e4c20401db53 "HTTP/1.1 200 OK"
2024-09-20 13:56:06 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f7-9562-e46c45c67624 "HTTP/1.1 200 OK"
2024-09-20 13:56:13 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:19 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8164-8336-e9aed9ecea83 "HTTP/1.1 200 OK"
2024-09-20 13:56:20 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a6-a21b-dfcfa99bd2ce "HTTP/1.1 200 OK"
2024-09-20 13:56:24 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 13:56:38 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8119-8496-f375a7138205 "HTTP/1.1 200 OK"
2024-09-20 13:56:38 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:45:34.977589
2024-09-20 13:56:38 - INFO - Starting trading cycle.
2024-09-20 13:56:38 - INFO - ##################################################
2024-09-20 13:56:38 - INFO - 5 회 예측 후 모델 재학습 검토
2024-09-20 13:56:38 - INFO - ##################################################
2024-09-20 13:56:38 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 13:56:38 - INFO - 데이터베이스 업데이트 시작
2024-09-20 13:56:38 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:40:00
2024-09-20 13:56:38 - INFO - 새로운 데이터 범위: 2024-09-19 04:40:00 ~ 2024-09-20 13:50:00
2024-09-20 13:56:38 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 13:56:38 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 13:56:38 - INFO - Index: Index([199], dtype='int64')
2024-09-20 13:56:38 - INFO - Date column data type: datetime64[ns]
2024-09-20 13:56:38 - INFO - Sample date values: [Timestamp('2024-09-20 13:50:00')]
2024-09-20 13:56:38 - INFO - Successfully added 1 new data points
2024-09-20 13:56:38 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 13:56:38 - INFO - Final date range: 2024-09-20 13:50:00 to 2024-09-20 13:50:00
2024-09-20 13:56:38 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 13:56:38 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 13:50:00
2024-09-20 13:56:38 - INFO - 데이터베이스 업데이트 완료
2024-09-20 13:56:38 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 13:56:38 - INFO - GPT | 이전예측가격: 85180000 | 당시BTC가격: 85180000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 13:56:38 - INFO - ML 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 3/7
2024-09-20 13:56:38 - INFO - ML | 이전예측가격: 85378420 | 당시BTC가격: 85180000 | 예측: 상승 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0345 | 반영가중치값: -0.0200 | 새 가중치: 0.0145 | 예측 총 횟수: 7 | 예측 성공 수: 3 | 예측 성공률: 42.86%
2024-09-20 13:56:38 - INFO - XGBOOST 모델 예측 업데이트: 정확도 60.16%, 적중/전체: 77/128
2024-09-20 13:56:38 - INFO - XGBOOST | 이전예측가격: 85191000 | 당시BTC가격: 85180000 | 예측: 상승 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0348 | 반영가중치값: -0.0200 | 새 가중치: 0.0148 | 예측 총 횟수: 128 | 예측 성공 수: 77 | 예측 성공률: 60.16%
2024-09-20 13:56:38 - INFO - LSTM 모델 예측 업데이트: 정확도 62.96%, 적중/전체: 17/27
2024-09-20 13:56:38 - INFO - LSTM | 이전예측가격: 84980778 | 당시BTC가격: 85180000 | 예측: 하락 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1522 | 반영가중치값: 0.0200 | 새 가중치: 0.1722 | 예측 총 횟수: 27 | 예측 성공 수: 17 | 예측 성공률: 62.96%
2024-09-20 13:56:38 - INFO - RL 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 4/7
2024-09-20 13:56:38 - INFO - RL | 이전예측가격: 86031800 | 당시BTC가격: 85180000 | 예측: 상승 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1521 | 반영가중치값: -0.0200 | 새 가중치: 0.1321 | 예측 총 횟수: 7 | 예측 성공 수: 4 | 예측 성공률: 57.14%
2024-09-20 13:56:38 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 3/6
2024-09-20 13:56:38 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85180000 | 예측: 하락 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1108 | 반영가중치값: 0.0200 | 새 가중치: 0.1308 | 예측 총 횟수: 6 | 예측 성공 수: 3 | 예측 성공률: 50.00%
2024-09-20 13:56:38 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.48%, 적중/전체: 69/116
2024-09-20 13:56:38 - INFO - PROPHET | 이전예측가격: 85282475 | 당시BTC가격: 85180000 | 예측: 상승 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2476 | 반영가중치값: -0.0200 | 새 가중치: 0.2276 | 예측 총 횟수: 116 | 예측 성공 수: 69 | 예측 성공률: 59.48%
2024-09-20 13:56:38 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 59.26%, 적중/전체: 16/27
2024-09-20 13:56:38 - INFO - TRANSFORMER | 이전예측가격: 84944082 | 당시BTC가격: 85180000 | 예측: 하락 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1799 | 반영가중치값: 0.0200 | 새 가중치: 0.1999 | 예측 총 횟수: 27 | 예측 성공 수: 16 | 예측 성공률: 59.26%
2024-09-20 13:56:38 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.72%, 적중/전체: 38/67
2024-09-20 13:56:38 - INFO - BITCOIN_FORECAST | 이전예측가격: 83678702 | 당시BTC가격: 85180000 | 예측: 하락 | 지금 BTC가격: 85083000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0852 | 반영가중치값: 0.0200 | 새 가중치: 0.1052 | 예측 총 횟수: 67 | 예측 성공 수: 38 | 예측 성공률: 56.72%
2024-09-20 13:56:38 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 13:56:38 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 13:56:38 - INFO - 새로운 가중치: {'gpt': 0.0028041227308132476, 'ml': 0.014519056713108661, 'xgboost': 0.014835608549945853, 'rl': 0.1320719516560167, 'lstm': 0.17219766825168553, 'arima': 0.13085678925821634, 'prophet': 0.22760068749395046, 'transformer': 0.19990707982718559, 'bitcoin_forecast': 0.10520703551907758}
2024-09-20 13:56:38 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 77/128
2024-09-20 13:56:38 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 13:56:38 - INFO - Current BTC price: 85083000.0
2024-09-20 13:56:38 - INFO - Analyzing market conditions.
2024-09-20 13:56:38 - INFO - Market analysis: {'current_price': 85083000.0, 'sma_20': 84510300.0, 'rsi_14': 64.32542140625898, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 13:56:38 - INFO - Starting predictions for all models
2024-09-20 13:56:38 - INFO - Attempting prediction for gpt
2024-09-20 13:56:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 13:56:39 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:56:39 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 13:56:39 - INFO - GPT prediction: 85083000.0
2024-09-20 13:56:39 - INFO - Attempting prediction for ml
2024-09-20 13:56:39 - INFO - ML prediction: 85338248.99999999
2024-09-20 13:56:39 - INFO - Attempting prediction for xgboost
2024-09-20 13:56:39 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 13:56:39 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:56:39 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 13:56:39 - INFO - XGBOOST prediction: 85083000.0
2024-09-20 13:56:39 - INFO - Attempting prediction for lstm
2024-09-20 13:56:39 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:56:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:56:39 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 13:56:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:56:39 - INFO - X 샘플:
[[-1.2828686  -1.44489436 -1.45726276 -1.5364096  -0.61234138 -0.61661429
  -1.5364096 ]
 [-1.32311304 -1.5570756  -1.39702751 -1.58152072 -1.08619307 -1.08703094
  -1.58152072]
 [-1.15594386 -1.03142636 -1.37551492 -0.83718722 -0.62148145 -0.62448468
  -0.83718722]
 [-0.45630992 -0.26859394 -0.19232254 -0.09661298  0.08177957  0.07854489
  -0.09661298]
 [ 0.15664371  0.57116276  0.66818101  1.01988726  2.62284522  2.6209141
   1.01988726]
 [ 1.59306029  1.40130393  1.26623097  1.39581327  0.39859181  0.40479181
   1.39581327]
 [ 1.30825355  1.03911879  0.45735764  0.06879446  0.38881057  0.39155674
   0.06879446]
 [ 0.20617531 -0.10192467  0.33688714 -0.07405742  0.02283215  0.02139701
  -0.07405742]
 [ 0.09782492  0.66090776  0.53910547  1.02364652 -0.3248573  -0.32229735
   1.02364652]
 [ 0.85627765  0.73142168  1.15436551  0.61764643 -0.86998613 -0.8667773
   0.61764643]]
2024-09-20 13:56:39 - INFO - y 샘플:
[0.61764643]
2024-09-20 13:56:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 13:56:39 - INFO - 모델 출력 (스케일링된 예측): [[0.36091384]]
2024-09-20 13:56:39 - INFO - 스케일러 역변환 후 예측 가격: 85014706.61666411
2024-09-20 13:56:39 - INFO - LSTMPredictor 최종 예측 가격: 85014706.61666411
2024-09-20 13:56:39 - INFO - LSTM prediction: 85014706.61666411
2024-09-20 13:56:39 - INFO - Attempting prediction for rl
2024-09-20 13:56:39 - INFO - Preparing state for RL agent.
2024-09-20 13:56:39 - INFO - Prepared state: [[ 8.50830000e+07  1.83074737e+01 -1.26773955e-03  8.45103000e+07
   6.43254214e+01]]
2024-09-20 13:56:39 - INFO - RL prediction: 85933830.0
2024-09-20 13:56:39 - INFO - Attempting prediction for arima
2024-09-20 13:56:39 - INFO - ARIMA 예측 시작
2024-09-20 13:56:39 - INFO - 입력 데이터: {'open': 85200000.0, 'high': 85250000.0, 'low': 85083000.0, 'close': 85083000.0, 'volume': 18.30747373, 'value': 1559772929.74685, 'decision': 'sell', 'sma': 84510300.0, 'ema': 84621399.13638873, 'rsi': 64.32542140625898, 'macd': 304817.61558537185, 'signal_line': 237022.73321853226, 'BB_Upper': 85435194.826455, 'BB_Lower': 83585405.173545}
2024-09-20 13:56:39 - INFO - Exogenous 변수 예측 시작
2024-09-20 13:56:39 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84510300.0         0         0
2024-09-20 13:56:39 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84510300.0         0         0
2024-09-20 13:56:39 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 13:56:39 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 13:56:39 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 13:56:39 - INFO - ARIMA prediction: 84893000.0
2024-09-20 13:56:39 - INFO - Attempting prediction for prophet
2024-09-20 13:56:39 - INFO - PROPHET prediction: 85146956.13576101
2024-09-20 13:56:39 - INFO - Attempting prediction for transformer
2024-09-20 13:56:39 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 13:56:39 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 13:56:39 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 13:56:39 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 13:56:39 - INFO - X dtype: float64, y dtype: float64
2024-09-20 13:56:39 - INFO - X 샘플:
[[-1.2828686  -1.44489436 -1.45726276 -1.5364096  -0.61234138 -0.61661429
  -1.5364096  -1.5364096   0.          0.          0.         -1.5364096
  -1.5364096 ]
 [-1.32311304 -1.5570756  -1.39702751 -1.58152072 -1.08619307 -1.08703094
  -1.58152072 -1.58152072  0.          0.          0.         -1.58152072
  -1.58152072]
 [-1.15594386 -1.03142636 -1.37551492 -0.83718722 -0.62148145 -0.62448468
  -0.83718722 -0.83718722  0.          0.          0.         -0.83718722
  -0.83718722]
 [-0.45630992 -0.26859394 -0.19232254 -0.09661298  0.08177957  0.07854489
  -0.09661298 -0.09661298  0.          0.          0.         -0.09661298
  -0.09661298]
 [ 0.15664371  0.57116276  0.66818101  1.01988726  2.62284522  2.6209141
   1.01988726  1.01988726  0.          0.          0.          1.01988726
   1.01988726]
 [ 1.59306029  1.40130393  1.26623097  1.39581327  0.39859181  0.40479181
   1.39581327  1.39581327  0.          0.          0.          1.39581327
   1.39581327]
 [ 1.30825355  1.03911879  0.45735764  0.06879446  0.38881057  0.39155674
   0.06879446  0.06879446  0.          0.          0.          0.06879446
   0.06879446]
 [ 0.20617531 -0.10192467  0.33688714 -0.07405742  0.02283215  0.02139701
  -0.07405742 -0.07405742  0.          0.          0.         -0.07405742
  -0.07405742]
 [ 0.09782492  0.66090776  0.53910547  1.02364652 -0.3248573  -0.32229735
   1.02364652  1.02364652  0.          0.          0.          1.02364652
   1.02364652]
 [ 0.85627765  0.73142168  1.15436551  0.61764643 -0.86998613 -0.8667773
   0.61764643  0.61764643  0.          0.          0.          0.61764643
   0.61764643]]
2024-09-20 13:56:39 - INFO - y 샘플:
[0.61764643]
2024-09-20 13:56:39 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 13:56:39 - INFO - 모델 출력 (스케일링된 예측): [0.3111319]
2024-09-20 13:56:39 - INFO - 스케일러 역변환 후 예측 가격: 85001464.1308916
2024-09-20 13:56:39 - INFO - TransformerPredictor 최종 예측 가격: 85001464.1308916
2024-09-20 13:56:39 - INFO - TRANSFORMER prediction: 85001464.1308916
2024-09-20 13:56:39 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 13:56:39 - INFO - BITCOIN_FORECAST prediction: 83487277.77654968
2024-09-20 13:56:39 - INFO - BitcoinForecast prediction: 83487277.77654968
2024-09-20 13:56:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 13:56:45 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 13:56:45 - INFO - 조정된 모델 가중치: {'gpt': 0.0028041227308132476, 'ml': 0.014519056713108661, 'xgboost': 0.014835608549945853, 'rl': 0.1320719516560167, 'lstm': 0.17219766825168553, 'arima': 0.13085678925821634, 'prophet': 0.22760068749395046, 'transformer': 0.19990707982718559, 'bitcoin_forecast': 0.10520703551907758}
2024-09-20 13:56:45 - INFO - 조정된 모델 가중치: {'gpt': 0.0028041227308132476, 'ml': 0.014519056713108661, 'xgboost': 0.014835608549945853, 'rl': 0.1320719516560167, 'lstm': 0.17219766825168553, 'arima': 0.13085678925821634, 'prophet': 0.22760068749395046, 'transformer': 0.19990707982718559, 'bitcoin_forecast': 0.10520703551907758}
2024-09-20 13:56:45 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84992829.66034085, 'current_price': 85083000.0, 'predictions': {'gpt': 85083000.0, 'ml': 85338248.99999999, 'xgboost': 85083000.0, 'lstm': 85014706.61666411, 'rl': 85933830.0, 'arima': 84893000.0, 'prophet': 85146956.13576101, 'transformer': 85001464.1308916, 'bitcoin_forecast': 83487277.77654968}, 'weights': {'gpt': 0.0028041227308132476, 'ml': 0.014519056713108661, 'xgboost': 0.014835608549945853, 'rl': 0.1320719516560167, 'lstm': 0.17219766825168553, 'arima': 0.13085678925821634, 'prophet': 0.22760068749395046, 'transformer': 0.19990707982718559, 'bitcoin_forecast': 0.10520703551907758}}
2024-09-20 13:56:45 - INFO - 모델별 가중치:
2024-09-20 13:56:45 - INFO -   - GPT: 0.0028
2024-09-20 13:56:45 - INFO -   - ML: 0.0145
2024-09-20 13:56:45 - INFO -   - XGBOOST: 0.0148
2024-09-20 13:56:45 - INFO -   - RL: 0.1321
2024-09-20 13:56:45 - INFO -   - LSTM: 0.1722
2024-09-20 13:56:45 - INFO -   - ARIMA: 0.1309
2024-09-20 13:56:45 - INFO -   - PROPHET: 0.2276
2024-09-20 13:56:45 - INFO -   - TRANSFORMER: 0.1999
2024-09-20 13:56:45 - INFO -   - BITCOIN_FORECAST: 0.1052
2024-09-20 13:56:45 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 13:56:45 - INFO - 6. 거래 실행
2024-09-20 13:56:45 - INFO - Cancelling existing orders.
2024-09-20 13:56:45 - INFO - Cancelled 0 orders.
2024-09-20 13:56:45 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84992829.66034085, 'current_price': 85083000.0, 'predictions': {'gpt': 85083000.0, 'ml': 85338248.99999999, 'xgboost': 85083000.0, 'lstm': 85014706.61666411, 'rl': 85933830.0, 'arima': 84893000.0, 'prophet': 85146956.13576101, 'transformer': 85001464.1308916, 'bitcoin_forecast': 83487277.77654968}, 'weights': {'gpt': 0.0028041227308132476, 'ml': 0.014519056713108661, 'xgboost': 0.014835608549945853, 'rl': 0.1320719516560167, 'lstm': 0.17219766825168553, 'arima': 0.13085678925821634, 'prophet': 0.22760068749395046, 'transformer': 0.19990707982718559, 'bitcoin_forecast': 0.10520703551907758}}, 현재 가격=85083000.0
2024-09-20 13:56:45 - INFO - 현재 잔고: KRW=286083.4439071, BTC=0.00227816, 총 자산가치=479916.1311871
2024-09-20 13:56:45 - INFO - 매도 시도: 0.00022781600000000004 BTC (약 19383.268728000003 KRW)
2024-09-20 13:56:45 - INFO - 주문 결과: {'uuid': '0cf8b22f-1a2e-47d3-9c51-eba2e55ddda7', 'side': 'ask', 'ord_type': 'limit', 'price': '85083000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T13:56:47+09:00', 'volume': '0.00022781', 'remaining_volume': '0.00022781', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00022781', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 13:56:45 - INFO - sell 주문 성공: UUID=0cf8b22f-1a2e-47d3-9c51-eba2e55ddda7
2024-09-20 13:56:45 - INFO - Trade executed successfully.
2024-09-20 13:56:45 - INFO - 7. summary 리포트 보내기
2024-09-20 13:56:45 - INFO - Message sent to Discord successfully.
2024-09-20 13:56:45 - INFO - Trading cycle completed.
2024-09-20 13:56:45 - INFO - Performing periodic update.
2024-09-20 13:56:45 - INFO - 계산된 시장 변동성: 0.030519978523669153
2024-09-20 14:05:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:05:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8167-8ebe-df6412dedb5e "HTTP/1.1 200 OK"
2024-09-20 14:05:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:05:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:05:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d5-bdfc-c6916d7863b0 "HTTP/1.1 200 OK"
2024-09-20 14:05:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:05:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8134-97c0-ecc9164bd75e "HTTP/1.1 200 OK"
2024-09-20 14:05:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:05:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:00 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8171-b1ab-f8b8f29dd525 "HTTP/1.1 200 OK"
2024-09-20 14:06:00 - INFO - Updated actual price for lstm prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:05 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8100-91a1-f5f6eaf3bdc7 "HTTP/1.1 200 OK"
2024-09-20 14:06:07 - INFO - Updated actual price for rl prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-811b-bc77-ead1913b9d50 "HTTP/1.1 200 OK"
2024-09-20 14:06:15 - INFO - Updated actual price for arima prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:22 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e6-ac0b-f89ad7d6b686 "HTTP/1.1 200 OK"
2024-09-20 14:06:22 - INFO - Updated actual price for prophet prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:29 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8179-8176-cd24dd438fe0 "HTTP/1.1 200 OK"
2024-09-20 14:06:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:06:35 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8198-a57b-d9b28735d1eb "HTTP/1.1 200 OK"
2024-09-20 14:06:35 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 13:55:34.977869
2024-09-20 14:06:35 - INFO - Starting trading cycle.
2024-09-20 14:06:35 - INFO - ##################################################
2024-09-20 14:06:35 - INFO - 6 회 예측 후 모델 재학습 검토
2024-09-20 14:06:35 - INFO - ##################################################
2024-09-20 14:06:35 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:06:35 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:06:35 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 13:50:00
2024-09-20 14:06:35 - INFO - 새로운 데이터 범위: 2024-09-19 04:50:00 ~ 2024-09-20 14:00:00
2024-09-20 14:06:35 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:06:35 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:06:35 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:06:35 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:06:35 - INFO - Sample date values: [Timestamp('2024-09-20 14:00:00')]
2024-09-20 14:06:35 - INFO - Successfully added 1 new data points
2024-09-20 14:06:35 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:06:35 - INFO - Final date range: 2024-09-20 14:00:00 to 2024-09-20 14:00:00
2024-09-20 14:06:35 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:06:35 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:00:00
2024-09-20 14:06:35 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:06:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:06:35 - INFO - GPT | 이전예측가격: 85083000 | 당시BTC가격: 85083000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:06:35 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 4/8
2024-09-20 14:06:35 - INFO - ML | 이전예측가격: 85338249 | 당시BTC가격: 85083000 | 예측: 상승 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1275 | 반영가중치값: 0.0200 | 새 가중치: 0.1475 | 예측 총 횟수: 8 | 예측 성공 수: 4 | 예측 성공률: 50.00%
2024-09-20 14:06:35 - INFO - XGBOOST | 이전예측가격: 85083000 | 당시BTC가격: 85083000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:06:35 - INFO - LSTM 모델 예측 업데이트: 정확도 60.71%, 적중/전체: 17/28
2024-09-20 14:06:35 - INFO - LSTM | 이전예측가격: 85014707 | 당시BTC가격: 85083000 | 예측: 하락 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0841 | 반영가중치값: -0.0200 | 새 가중치: 0.0641 | 예측 총 횟수: 28 | 예측 성공 수: 17 | 예측 성공률: 60.71%
2024-09-20 14:06:35 - INFO - RL 모델 예측 업데이트: 정확도 62.50%, 적중/전체: 5/8
2024-09-20 14:06:35 - INFO - RL | 이전예측가격: 85933830 | 당시BTC가격: 85083000 | 예측: 상승 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1275 | 반영가중치값: 0.0200 | 새 가중치: 0.1475 | 예측 총 횟수: 8 | 예측 성공 수: 5 | 예측 성공률: 62.50%
2024-09-20 14:06:35 - INFO - ARIMA 모델 예측 업데이트: 정확도 42.86%, 적중/전체: 3/7
2024-09-20 14:06:35 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85083000 | 예측: 하락 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1052 | 반영가중치값: -0.0200 | 새 가중치: 0.0852 | 예측 총 횟수: 7 | 예측 성공 수: 3 | 예측 성공률: 42.86%
2024-09-20 14:06:35 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.83%, 적중/전체: 70/117
2024-09-20 14:06:35 - INFO - PROPHET | 이전예측가격: 85146956 | 당시BTC가격: 85083000 | 예측: 상승 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3442 | 반영가중치값: 0.0200 | 새 가중치: 0.3642 | 예측 총 횟수: 117 | 예측 성공 수: 70 | 예측 성공률: 59.83%
2024-09-20 14:06:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 16/28
2024-09-20 14:06:35 - INFO - TRANSFORMER | 이전예측가격: 85001464 | 당시BTC가격: 85083000 | 예측: 하락 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.0462 | 반영가중치값: -0.0200 | 새 가중치: 0.0262 | 예측 총 횟수: 28 | 예측 성공 수: 16 | 예측 성공률: 57.14%
2024-09-20 14:06:35 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.88%, 적중/전체: 38/68
2024-09-20 14:06:35 - INFO - BITCOIN_FORECAST | 이전예측가격: 83487278 | 당시BTC가격: 85083000 | 예측: 하락 | 지금 BTC가격: 85190000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1293 | 반영가중치값: -0.0200 | 새 가중치: 0.1093 | 예측 총 횟수: 68 | 예측 성공 수: 38 | 예측 성공률: 55.88%
2024-09-20 14:06:35 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:06:35 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:06:35 - INFO - 새로운 가중치: {'gpt': 0.0029156182811840023, 'ml': 0.15340095340566634, 'xgboost': 0.01542549155406157, 'rl': 0.15340095340566634, 'lstm': 0.0666999953586908, 'arima': 0.08863756112379376, 'prophet': 0.3786677955946378, 'transformer': 0.027206871070600994, 'bitcoin_forecast': 0.11364476020569844}
2024-09-20 14:06:35 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 77/128
2024-09-20 14:06:35 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:06:35 - INFO - Current BTC price: 85190000.0
2024-09-20 14:06:35 - INFO - Analyzing market conditions.
2024-09-20 14:06:35 - INFO - Market analysis: {'current_price': 85190000.0, 'sma_20': 84569800.0, 'rsi_14': 66.12918578105838, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:06:35 - INFO - Starting predictions for all models
2024-09-20 14:06:35 - INFO - Attempting prediction for gpt
2024-09-20 14:06:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:06:35 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:06:35 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:06:35 - INFO - GPT prediction: 85190000.0
2024-09-20 14:06:35 - INFO - Attempting prediction for ml
2024-09-20 14:06:35 - INFO - ML prediction: 85445569.99999999
2024-09-20 14:06:35 - INFO - Attempting prediction for xgboost
2024-09-20 14:06:35 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:06:35 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:06:35 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:06:35 - INFO - XGBOOST prediction: 85190000.0
2024-09-20 14:06:35 - INFO - Attempting prediction for lstm
2024-09-20 14:06:35 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:06:35 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:06:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:06:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:06:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:06:35 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:06:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:06:36 - INFO - X 샘플:
[[-1.6549755  -1.9880062  -1.79324976 -2.05064778 -1.02577066 -1.02776887
  -2.05064778]
 [-1.47314706 -1.39597239 -1.77002715 -1.21981443 -0.57271334 -0.57660632
  -1.21981443]
 [-0.71216138 -0.53680138 -0.49278373 -0.3931772   0.11291091  0.10912102
  -0.3931772 ]
 [-0.04545711  0.40900872  0.43612057  0.85307283  2.59025033  2.5889201
   0.85307283]
 [ 1.51692057  1.34398894  1.08170906  1.27268564  0.42177796  0.42733869
   1.27268564]
 [ 1.20713879  0.9360632   0.20853902 -0.20854756  0.41224202  0.41442935
  -0.20854756]
 [ 0.00841798 -0.34908335  0.07849241 -0.36800043  0.05544181  0.0533796
  -0.36800043]
 [-0.10943378  0.51008766  0.29678493  0.85726896 -0.28352809 -0.28185611
   0.85726896]
 [ 0.71552857  0.58950683  0.9609515   0.40408713 -0.81498588 -0.81293589
   0.40408713]
 [ 0.54716891  0.48120796  0.99346315  0.85307283 -0.89562506 -0.89402156
   0.85307283]]
2024-09-20 14:06:36 - INFO - y 샘플:
[0.85307283]
2024-09-20 14:06:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:06:36 - INFO - 모델 출력 (스케일링된 예측): [[0.31102544]]
2024-09-20 14:06:36 - INFO - 스케일러 역변환 후 예측 가격: 85060822.00882792
2024-09-20 14:06:36 - INFO - LSTMPredictor 최종 예측 가격: 85060822.00882792
2024-09-20 14:06:36 - INFO - LSTM prediction: 85060822.00882792
2024-09-20 14:06:36 - INFO - Attempting prediction for rl
2024-09-20 14:06:36 - INFO - Preparing state for RL agent.
2024-09-20 14:06:36 - INFO - Prepared state: [[8.51900000e+07 1.61642146e+01 1.25759552e-03 8.45698000e+07
  6.61291858e+01]]
2024-09-20 14:06:36 - INFO - RL prediction: 86041900.0
2024-09-20 14:06:36 - INFO - Attempting prediction for arima
2024-09-20 14:06:36 - INFO - ARIMA 예측 시작
2024-09-20 14:06:36 - INFO - 입력 데이터: {'open': 85150000.0, 'high': 85220000.0, 'low': 85090000.0, 'close': 85190000.0, 'volume': 16.16421462, 'value': 1376345242.43374, 'decision': 'sell', 'sma': 84569800.0, 'ema': 84675551.59958981, 'rsi': 66.12918578105838, 'macd': 311315.0586388707, 'signal_line': 251881.19830259995, 'BB_Upper': 85508728.45307916, 'BB_Lower': 83630871.54692084}
2024-09-20 14:06:36 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:06:36 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84569800.0         0         0
2024-09-20 14:06:36 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84569800.0         0         0
2024-09-20 14:06:36 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:06:36 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:06:36 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:06:36 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:06:36 - INFO - Attempting prediction for prophet
2024-09-20 14:06:36 - INFO - PROPHET prediction: 85262125.05025038
2024-09-20 14:06:36 - INFO - Attempting prediction for transformer
2024-09-20 14:06:36 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:06:36 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:06:36 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:06:36 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:06:36 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:06:36 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:06:36 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:06:36 - INFO - X 샘플:
[[-1.6549755  -1.9880062  -1.79324976 -2.05064778 -1.02577066 -1.02776887
  -2.05064778 -2.05064778  0.          0.          0.         -2.05064778
  -2.05064778]
 [-1.47314706 -1.39597239 -1.77002715 -1.21981443 -0.57271334 -0.57660632
  -1.21981443 -1.21981443  0.          0.          0.         -1.21981443
  -1.21981443]
 [-0.71216138 -0.53680138 -0.49278373 -0.3931772   0.11291091  0.10912102
  -0.3931772  -0.3931772   0.          0.          0.         -0.3931772
  -0.3931772 ]
 [-0.04545711  0.40900872  0.43612057  0.85307283  2.59025033  2.5889201
   0.85307283  0.85307283  0.          0.          0.          0.85307283
   0.85307283]
 [ 1.51692057  1.34398894  1.08170906  1.27268564  0.42177796  0.42733869
   1.27268564  1.27268564  0.          0.          0.          1.27268564
   1.27268564]
 [ 1.20713879  0.9360632   0.20853902 -0.20854756  0.41224202  0.41442935
  -0.20854756 -0.20854756  0.          0.          0.         -0.20854756
  -0.20854756]
 [ 0.00841798 -0.34908335  0.07849241 -0.36800043  0.05544181  0.0533796
  -0.36800043 -0.36800043  0.          0.          0.         -0.36800043
  -0.36800043]
 [-0.10943378  0.51008766  0.29678493  0.85726896 -0.28352809 -0.28185611
   0.85726896  0.85726896  0.          0.          0.          0.85726896
   0.85726896]
 [ 0.71552857  0.58950683  0.9609515   0.40408713 -0.81498588 -0.81293589
   0.40408713  0.40408713  0.          0.          0.          0.40408713
   0.40408713]
 [ 0.54716891  0.48120796  0.99346315  0.85307283 -0.89562506 -0.89402156
   0.85307283  0.85307283  0.          0.          0.          0.85307283
   0.85307283]]
2024-09-20 14:06:36 - INFO - y 샘플:
[0.85307283]
2024-09-20 14:06:36 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:06:36 - INFO - 모델 출력 (스케일링된 예측): [0.31142908]
2024-09-20 14:06:36 - INFO - 스케일러 역변환 후 예측 가격: 85060918.20290236
2024-09-20 14:06:36 - INFO - TransformerPredictor 최종 예측 가격: 85060918.20290236
2024-09-20 14:06:36 - INFO - TRANSFORMER prediction: 85060918.20290236
2024-09-20 14:06:36 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:06:36 - INFO - BITCOIN_FORECAST prediction: 83434928.92484942
2024-09-20 14:06:36 - INFO - BitcoinForecast prediction: 83434928.92484942
2024-09-20 14:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:06:41 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.0029156182811840023, 'ml': 0.15340095340566634, 'xgboost': 0.01542549155406157, 'rl': 0.15340095340566634, 'lstm': 0.0666999953586908, 'arima': 0.08863756112379376, 'prophet': 0.3786677955946378, 'transformer': 0.027206871070600994, 'bitcoin_forecast': 0.11364476020569844}
2024-09-20 14:06:41 - INFO - 조정된 모델 가중치: {'gpt': 0.0029156182811840023, 'ml': 0.15340095340566634, 'xgboost': 0.01542549155406157, 'rl': 0.15340095340566634, 'lstm': 0.0666999953586908, 'arima': 0.08863756112379376, 'prophet': 0.3786677955946378, 'transformer': 0.027206871070600994, 'bitcoin_forecast': 0.11364476020569844}
2024-09-20 14:06:41 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85149290.31729761, 'current_price': 85190000.0, 'predictions': {'gpt': 85190000.0, 'ml': 85445569.99999999, 'xgboost': 85190000.0, 'lstm': 85060822.00882792, 'rl': 86041900.0, 'arima': 84893000.0, 'prophet': 85262125.05025038, 'transformer': 85060918.20290236, 'bitcoin_forecast': 83434928.92484942}, 'weights': {'gpt': 0.0029156182811840023, 'ml': 0.15340095340566634, 'xgboost': 0.01542549155406157, 'rl': 0.15340095340566634, 'lstm': 0.0666999953586908, 'arima': 0.08863756112379376, 'prophet': 0.3786677955946378, 'transformer': 0.027206871070600994, 'bitcoin_forecast': 0.11364476020569844}}
2024-09-20 14:06:41 - INFO - 모델별 가중치:
2024-09-20 14:06:41 - INFO -   - GPT: 0.0029
2024-09-20 14:06:41 - INFO -   - ML: 0.1534
2024-09-20 14:06:41 - INFO -   - XGBOOST: 0.0154
2024-09-20 14:06:41 - INFO -   - RL: 0.1534
2024-09-20 14:06:41 - INFO -   - LSTM: 0.0667
2024-09-20 14:06:41 - INFO -   - ARIMA: 0.0886
2024-09-20 14:06:41 - INFO -   - PROPHET: 0.3787
2024-09-20 14:06:41 - INFO -   - TRANSFORMER: 0.0272
2024-09-20 14:06:41 - INFO -   - BITCOIN_FORECAST: 0.1136
2024-09-20 14:06:41 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:06:41 - INFO - 6. 거래 실행
2024-09-20 14:06:41 - INFO - Cancelling existing orders.
2024-09-20 14:06:41 - INFO - Cancelled 0 orders.
2024-09-20 14:06:41 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85149290.31729761, 'current_price': 85190000.0, 'predictions': {'gpt': 85190000.0, 'ml': 85445569.99999999, 'xgboost': 85190000.0, 'lstm': 85060822.00882792, 'rl': 86041900.0, 'arima': 84893000.0, 'prophet': 85262125.05025038, 'transformer': 85060918.20290236, 'bitcoin_forecast': 83434928.92484942}, 'weights': {'gpt': 0.0029156182811840023, 'ml': 0.15340095340566634, 'xgboost': 0.01542549155406157, 'rl': 0.15340095340566634, 'lstm': 0.0666999953586908, 'arima': 0.08863756112379376, 'prophet': 0.3786677955946378, 'transformer': 0.027206871070600994, 'bitcoin_forecast': 0.11364476020569844}}, 현재 가격=85190000.0
2024-09-20 14:06:41 - INFO - 현재 잔고: KRW=305456.51075798, BTC=0.00205035, 총 자산가치=480125.82725798
2024-09-20 14:06:41 - INFO - 매도 시도: 0.00020503499999999998 BTC (약 17466.93165 KRW)
2024-09-20 14:06:41 - INFO - 주문 결과: {'uuid': 'a608fd37-d084-4b3e-ac4a-e05784a160bd', 'side': 'ask', 'ord_type': 'limit', 'price': '85190000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:06:43+09:00', 'volume': '0.00020503', 'remaining_volume': '0.00020503', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00020503', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:06:41 - INFO - sell 주문 성공: UUID=a608fd37-d084-4b3e-ac4a-e05784a160bd
2024-09-20 14:06:41 - INFO - Trade executed successfully.
2024-09-20 14:06:41 - INFO - 7. summary 리포트 보내기
2024-09-20 14:06:42 - INFO - Message sent to Discord successfully.
2024-09-20 14:06:42 - INFO - Trading cycle completed.
2024-09-20 14:06:42 - INFO - Performing periodic update.
2024-09-20 14:06:42 - INFO - 계산된 시장 변동성: 0.030347817474371895
2024-09-20 14:15:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:15:39 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a9-a6ba-e11bc9ff7b05 "HTTP/1.1 200 OK"
2024-09-20 14:15:39 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:15:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:15:44 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8188-9246-ea62da093134 "HTTP/1.1 200 OK"
2024-09-20 14:15:44 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:15:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:15:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ed-aee5-c48c157d168b "HTTP/1.1 200 OK"
2024-09-20 14:15:50 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:15:55 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:15:56 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8192-a09d-dd73875231a1 "HTTP/1.1 200 OK"
2024-09-20 14:15:56 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:16:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8148-a38f-c16ae1362d06 "HTTP/1.1 200 OK"
2024-09-20 14:16:04 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:09 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:16:10 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c6-9499-cf8a210a7cc5 "HTTP/1.1 200 OK"
2024-09-20 14:16:10 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:14 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:16:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8195-a0ce-e57b4d496377 "HTTP/1.1 200 OK"
2024-09-20 14:16:18 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:16:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8142-a757-cf2eb305a894 "HTTP/1.1 200 OK"
2024-09-20 14:16:24 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:16:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ed-b1c4-c80025c91bee "HTTP/1.1 200 OK"
2024-09-20 14:16:29 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:05:34.978081
2024-09-20 14:16:29 - INFO - Starting trading cycle.
2024-09-20 14:16:29 - INFO - ##################################################
2024-09-20 14:16:29 - INFO - 7 회 예측 후 모델 재학습 검토
2024-09-20 14:16:29 - INFO - ##################################################
2024-09-20 14:16:29 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:16:29 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:16:29 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:00:00
2024-09-20 14:16:29 - INFO - 새로운 데이터 범위: 2024-09-19 05:00:00 ~ 2024-09-20 14:10:00
2024-09-20 14:16:29 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:16:29 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:16:29 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:16:29 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:16:29 - INFO - Sample date values: [Timestamp('2024-09-20 14:10:00')]
2024-09-20 14:16:29 - INFO - Successfully added 1 new data points
2024-09-20 14:16:29 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:16:29 - INFO - Final date range: 2024-09-20 14:10:00 to 2024-09-20 14:10:00
2024-09-20 14:16:29 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:16:29 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:10:00
2024-09-20 14:16:29 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:16:29 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:16:29 - INFO - GPT | 이전예측가격: 85190000 | 당시BTC가격: 85190000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:16:29 - INFO - ML 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 5/9
2024-09-20 14:16:29 - INFO - ML | 이전예측가격: 85445570 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0145 | 반영가중치값: 0.0200 | 새 가중치: 0.0345 | 예측 총 횟수: 9 | 예측 성공 수: 5 | 예측 성공률: 55.56%
2024-09-20 14:16:29 - INFO - XGBOOST | 이전예측가격: 85190000 | 당시BTC가격: 85190000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:16:29 - INFO - LSTM 모델 예측 업데이트: 정확도 58.62%, 적중/전체: 17/29
2024-09-20 14:16:29 - INFO - LSTM | 이전예측가격: 85060822 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1722 | 반영가중치값: -0.0200 | 새 가중치: 0.1522 | 예측 총 횟수: 29 | 예측 성공 수: 17 | 예측 성공률: 58.62%
2024-09-20 14:16:29 - INFO - RL 모델 예측 업데이트: 정확도 66.67%, 적중/전체: 6/9
2024-09-20 14:16:29 - INFO - RL | 이전예측가격: 86041900 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1321 | 반영가중치값: 0.0200 | 새 가중치: 0.1521 | 예측 총 횟수: 9 | 예측 성공 수: 6 | 예측 성공률: 66.67%
2024-09-20 14:16:29 - INFO - ARIMA 모델 예측 업데이트: 정확도 37.50%, 적중/전체: 3/8
2024-09-20 14:16:29 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1309 | 반영가중치값: -0.0200 | 새 가중치: 0.1109 | 예측 총 횟수: 8 | 예측 성공 수: 3 | 예측 성공률: 37.50%
2024-09-20 14:16:29 - INFO - PROPHET 모델 예측 업데이트: 정확도 60.17%, 적중/전체: 71/118
2024-09-20 14:16:30 - INFO - PROPHET | 이전예측가격: 85262125 | 당시BTC가격: 85190000 | 예측: 상승 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.2276 | 반영가중치값: 0.0200 | 새 가중치: 0.2476 | 예측 총 횟수: 118 | 예측 성공 수: 71 | 예측 성공률: 60.17%
2024-09-20 14:16:30 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.17%, 적중/전체: 16/29
2024-09-20 14:16:30 - INFO - TRANSFORMER | 이전예측가격: 85060918 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1999 | 반영가중치값: -0.0200 | 새 가중치: 0.1799 | 예측 총 횟수: 29 | 예측 성공 수: 16 | 예측 성공률: 55.17%
2024-09-20 14:16:30 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.07%, 적중/전체: 38/69
2024-09-20 14:16:30 - INFO - BITCOIN_FORECAST | 이전예측가격: 83434929 | 당시BTC가격: 85190000 | 예측: 하락 | 지금 BTC가격: 85239000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1052 | 반영가중치값: -0.0200 | 새 가중치: 0.0852 | 예측 총 횟수: 69 | 예측 성공 수: 38 | 예측 성공률: 55.07%
2024-09-20 14:16:30 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:16:30 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:16:30 - INFO - 새로운 가중치: {'gpt': 0.002972992946621023, 'ml': 0.0351983360765622, 'xgboost': 0.015729040349467146, 'rl': 0.1550644824015283, 'lstm': 0.15519267289704297, 'arima': 0.1130382720799421, 'prophet': 0.25247306969110583, 'transformer': 0.18344736100234837, 'bitcoin_forecast': 0.08688377255538199}
2024-09-20 14:16:30 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 77/128
2024-09-20 14:16:30 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:16:30 - INFO - Current BTC price: 85239000.0
2024-09-20 14:16:30 - INFO - Analyzing market conditions.
2024-09-20 14:16:30 - INFO - Market analysis: {'current_price': 85239000.0, 'sma_20': 84622950.0, 'rsi_14': 66.95322340959656, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:16:30 - INFO - Starting predictions for all models
2024-09-20 14:16:30 - INFO - Attempting prediction for gpt
2024-09-20 14:16:30 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:16:30 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:16:30 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:16:30 - INFO - GPT prediction: 85239000.0
2024-09-20 14:16:30 - INFO - Attempting prediction for ml
2024-09-20 14:16:30 - INFO - ML prediction: 85511764.80000001
2024-09-20 14:16:30 - INFO - Attempting prediction for xgboost
2024-09-20 14:16:30 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:16:30 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:16:30 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:16:30 - INFO - XGBOOST prediction: 85239000.0
2024-09-20 14:16:30 - INFO - Attempting prediction for lstm
2024-09-20 14:16:30 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:16:30 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:16:30 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:16:30 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:16:30 - INFO - X 샘플:
[[-2.01444353 -2.18398951 -2.43634853 -1.98466266 -0.59161535 -0.59614214
  -1.98466266]
 [-1.11417808 -1.04659453 -0.92428388 -0.9129013   0.10213092  0.09796334
  -0.9129013 ]
 [-0.32544994  0.20549573  0.1753995   0.70290136  2.60881728  2.6080603
   0.70290136]
 [ 1.52288266  1.44324908  0.93967945  1.24694266  0.41465685  0.42006896
   1.24694266]
 [ 1.15640292  0.90322542 -0.09402293 -0.67352313  0.40500795  0.40700189
  -0.67352313]
 [-0.26171434 -0.79808807 -0.2479786  -0.88025882  0.04398103  0.04154087
  -0.88025882]
 [-0.40113598  0.3393069   0.01044699  0.70834177 -0.29900436 -0.2977907
   0.70834177]
 [ 0.57481551  0.44444425  0.79672061  0.12077717 -0.83675788 -0.83535916
   0.12077717]
 [ 0.37564173  0.30107514  0.83520953  0.70290136 -0.91835233 -0.91743552
   0.70290136]
 [ 0.48717905  0.39187558  0.94517786  0.96948159 -0.92886411 -0.92790783
   0.96948159]]
2024-09-20 14:16:30 - INFO - y 샘플:
[0.96948159]
2024-09-20 14:16:30 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:16:30 - INFO - 모델 출력 (스케일링된 예측): [[0.26984167]]
2024-09-20 14:16:30 - INFO - 스케일러 역변환 후 예측 가격: 85110399.48296349
2024-09-20 14:16:30 - INFO - LSTMPredictor 최종 예측 가격: 85110399.48296349
2024-09-20 14:16:30 - INFO - LSTM prediction: 85110399.48296349
2024-09-20 14:16:30 - INFO - Attempting prediction for rl
2024-09-20 14:16:30 - INFO - Preparing state for RL agent.
2024-09-20 14:16:30 - INFO - Prepared state: [[8.52390000e+07 1.58880992e+01 5.75184881e-04 8.46229500e+07
  6.69532234e+01]]
2024-09-20 14:16:30 - INFO - RL prediction: 86091390.0
2024-09-20 14:16:30 - INFO - Attempting prediction for arima
2024-09-20 14:16:30 - INFO - ARIMA 예측 시작
2024-09-20 14:16:30 - INFO - 입력 데이터: {'open': 85178000.0, 'high': 85239000.0, 'low': 85110000.0, 'close': 85239000.0, 'volume': 15.88809924, 'value': 1352941288.84637, 'decision': 'sell', 'sma': 84622950.0, 'ema': 84729213.35200983, 'rsi': 66.95322340959656, 'macd': 316766.7298786342, 'signal_line': 264858.3046178068, 'BB_Upper': 85586711.89486991, 'BB_Lower': 83659188.10513009}
2024-09-20 14:16:30 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:16:30 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84622950.0         0         0
2024-09-20 14:16:30 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84622950.0         0         0
2024-09-20 14:16:30 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:16:30 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:16:30 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:16:30 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:16:30 - INFO - Attempting prediction for prophet
2024-09-20 14:16:30 - INFO - PROPHET prediction: 85314961.23547831
2024-09-20 14:16:30 - INFO - Attempting prediction for transformer
2024-09-20 14:16:30 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:16:30 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:16:30 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:16:30 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:16:30 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:16:30 - INFO - X 샘플:
[[-2.01444353 -2.18398951 -2.43634853 -1.98466266 -0.59161535 -0.59614214
  -1.98466266 -1.98466266  0.          0.          0.         -1.98466266
  -1.98466266]
 [-1.11417808 -1.04659453 -0.92428388 -0.9129013   0.10213092  0.09796334
  -0.9129013  -0.9129013   0.          0.          0.         -0.9129013
  -0.9129013 ]
 [-0.32544994  0.20549573  0.1753995   0.70290136  2.60881728  2.6080603
   0.70290136  0.70290136  0.          0.          0.          0.70290136
   0.70290136]
 [ 1.52288266  1.44324908  0.93967945  1.24694266  0.41465685  0.42006896
   1.24694266  1.24694266  0.          0.          0.          1.24694266
   1.24694266]
 [ 1.15640292  0.90322542 -0.09402293 -0.67352313  0.40500795  0.40700189
  -0.67352313 -0.67352313  0.          0.          0.         -0.67352313
  -0.67352313]
 [-0.26171434 -0.79808807 -0.2479786  -0.88025882  0.04398103  0.04154087
  -0.88025882 -0.88025882  0.          0.          0.         -0.88025882
  -0.88025882]
 [-0.40113598  0.3393069   0.01044699  0.70834177 -0.29900436 -0.2977907
   0.70834177  0.70834177  0.          0.          0.          0.70834177
   0.70834177]
 [ 0.57481551  0.44444425  0.79672061  0.12077717 -0.83675788 -0.83535916
   0.12077717  0.12077717  0.          0.          0.          0.12077717
   0.12077717]
 [ 0.37564173  0.30107514  0.83520953  0.70290136 -0.91835233 -0.91743552
   0.70290136  0.70290136  0.          0.          0.          0.70290136
   0.70290136]
 [ 0.48717905  0.39187558  0.94517786  0.96948159 -0.92886411 -0.92790783
   0.96948159  0.96948159  0.          0.          0.          0.96948159
   0.96948159]]
2024-09-20 14:16:30 - INFO - y 샘플:
[0.96948159]
2024-09-20 14:16:30 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:16:30 - INFO - 모델 출력 (스케일링된 예측): [0.31011945]
2024-09-20 14:16:30 - INFO - 스케일러 역변환 후 예측 가격: 85117802.92443739
2024-09-20 14:16:30 - INFO - TransformerPredictor 최종 예측 가격: 85117802.92443739
2024-09-20 14:16:30 - INFO - TRANSFORMER prediction: 85117802.92443739
2024-09-20 14:16:30 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:16:30 - INFO - BITCOIN_FORECAST prediction: 83420026.87255913
2024-09-20 14:16:30 - INFO - BitcoinForecast prediction: 83420026.87255913
2024-09-20 14:16:31 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:16:36 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:16:36 - INFO - 조정된 모델 가중치: {'gpt': 0.002972992946621023, 'ml': 0.0351983360765622, 'xgboost': 0.015729040349467146, 'rl': 0.1550644824015283, 'lstm': 0.15519267289704297, 'arima': 0.1130382720799421, 'prophet': 0.25247306969110583, 'transformer': 0.18344736100234837, 'bitcoin_forecast': 0.08688377255538199}
2024-09-20 14:16:36 - INFO - 조정된 모델 가중치: {'gpt': 0.002972992946621023, 'ml': 0.0351983360765622, 'xgboost': 0.015729040349467146, 'rl': 0.1550644824015283, 'lstm': 0.15519267289704297, 'arima': 0.1130382720799421, 'prophet': 0.25247306969110583, 'transformer': 0.18344736100234837, 'bitcoin_forecast': 0.08688377255538199}
2024-09-20 14:16:36 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85160612.81627665, 'current_price': 85239000.0, 'predictions': {'gpt': 85239000.0, 'ml': 85511764.80000001, 'xgboost': 85239000.0, 'lstm': 85110399.48296349, 'rl': 86091390.0, 'arima': 84893000.0, 'prophet': 85314961.23547831, 'transformer': 85117802.92443739, 'bitcoin_forecast': 83420026.87255913}, 'weights': {'gpt': 0.002972992946621023, 'ml': 0.0351983360765622, 'xgboost': 0.015729040349467146, 'rl': 0.1550644824015283, 'lstm': 0.15519267289704297, 'arima': 0.1130382720799421, 'prophet': 0.25247306969110583, 'transformer': 0.18344736100234837, 'bitcoin_forecast': 0.08688377255538199}}
2024-09-20 14:16:36 - INFO - 모델별 가중치:
2024-09-20 14:16:36 - INFO -   - GPT: 0.0030
2024-09-20 14:16:36 - INFO -   - ML: 0.0352
2024-09-20 14:16:36 - INFO -   - XGBOOST: 0.0157
2024-09-20 14:16:36 - INFO -   - RL: 0.1551
2024-09-20 14:16:36 - INFO -   - LSTM: 0.1552
2024-09-20 14:16:36 - INFO -   - ARIMA: 0.1130
2024-09-20 14:16:36 - INFO -   - PROPHET: 0.2525
2024-09-20 14:16:36 - INFO -   - TRANSFORMER: 0.1834
2024-09-20 14:16:36 - INFO -   - BITCOIN_FORECAST: 0.0869
2024-09-20 14:16:36 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:16:36 - INFO - 6. 거래 실행
2024-09-20 14:16:36 - INFO - Cancelling existing orders.
2024-09-20 14:16:36 - INFO - Cancelled 0 orders.
2024-09-20 14:16:36 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85160612.81627665, 'current_price': 85239000.0, 'predictions': {'gpt': 85239000.0, 'ml': 85511764.80000001, 'xgboost': 85239000.0, 'lstm': 85110399.48296349, 'rl': 86091390.0, 'arima': 84893000.0, 'prophet': 85314961.23547831, 'transformer': 85117802.92443739, 'bitcoin_forecast': 83420026.87255913}, 'weights': {'gpt': 0.002972992946621023, 'ml': 0.0351983360765622, 'xgboost': 0.015729040349467146, 'rl': 0.1550644824015283, 'lstm': 0.15519267289704297, 'arima': 0.1130382720799421, 'prophet': 0.25247306969110583, 'transformer': 0.18344736100234837, 'bitcoin_forecast': 0.08688377255538199}}, 현재 가격=85239000.0
2024-09-20 14:16:36 - INFO - 현재 잔고: KRW=322914.48813262, BTC=0.00184532, 총 자산가치=480207.71961261996
2024-09-20 14:16:36 - INFO - 매도 시도: 0.000184532 BTC (약 15729.323148 KRW)
2024-09-20 14:16:36 - INFO - 주문 결과: {'uuid': '970a4205-29b4-4262-aa9e-b58eb7fa96a4', 'side': 'ask', 'ord_type': 'limit', 'price': '85239000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:16:38+09:00', 'volume': '0.00018453', 'remaining_volume': '0.00018453', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00018453', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:16:36 - INFO - sell 주문 성공: UUID=970a4205-29b4-4262-aa9e-b58eb7fa96a4
2024-09-20 14:16:36 - INFO - Trade executed successfully.
2024-09-20 14:16:36 - INFO - 7. summary 리포트 보내기
2024-09-20 14:16:37 - INFO - Message sent to Discord successfully.
2024-09-20 14:16:37 - INFO - Trading cycle completed.
2024-09-20 14:16:37 - INFO - Performing periodic update.
2024-09-20 14:16:37 - INFO - 계산된 시장 변동성: 0.03006120989406579
2024-09-20 14:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:25:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817a-b0c9-c33e4b8981b0 "HTTP/1.1 200 OK"
2024-09-20 14:25:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:25:50 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:25:50 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813c-aa2b-f7429ce2b87b "HTTP/1.1 200 OK"
2024-09-20 14:25:50 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:25:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:25:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8109-b2a3-f62493e63a96 "HTTP/1.1 200 OK"
2024-09-20 14:25:57 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:02 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:02 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8184-b964-c38d066787a9 "HTTP/1.1 200 OK"
2024-09-20 14:26:02 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8161-a0d5-ebda7aecd7ee "HTTP/1.1 200 OK"
2024-09-20 14:26:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:18 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f0-9a63-f813f753523a "HTTP/1.1 200 OK"
2024-09-20 14:26:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:25 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:26 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812a-8aae-feb670c90dfa "HTTP/1.1 200 OK"
2024-09-20 14:26:26 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:31 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:32 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a8-ab14-c987164f9b9d "HTTP/1.1 200 OK"
2024-09-20 14:26:32 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:26:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8160-bd23-d70ecbaefd9c "HTTP/1.1 200 OK"
2024-09-20 14:26:37 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:15:34.978621
2024-09-20 14:26:37 - INFO - Starting trading cycle.
2024-09-20 14:26:37 - INFO - ##################################################
2024-09-20 14:26:37 - INFO - 8 회 예측 후 모델 재학습 검토
2024-09-20 14:26:37 - INFO - ##################################################
2024-09-20 14:26:37 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:26:37 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:26:37 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:10:00
2024-09-20 14:26:37 - INFO - 새로운 데이터 범위: 2024-09-19 05:10:00 ~ 2024-09-20 14:20:00
2024-09-20 14:26:37 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:26:37 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:26:37 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:26:37 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:26:37 - INFO - Sample date values: [Timestamp('2024-09-20 14:20:00')]
2024-09-20 14:26:37 - INFO - Successfully added 1 new data points
2024-09-20 14:26:37 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:26:37 - INFO - Final date range: 2024-09-20 14:20:00 to 2024-09-20 14:20:00
2024-09-20 14:26:37 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:26:37 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:20:00
2024-09-20 14:26:37 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:26:37 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:26:37 - INFO - GPT | 이전예측가격: 85239000 | 당시BTC가격: 85239000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:26:37 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 5/10
2024-09-20 14:26:37 - INFO - ML | 이전예측가격: 85511765 | 당시BTC가격: 85239000 | 예측: 상승 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1534 | 반영가중치값: -0.0200 | 새 가중치: 0.1334 | 예측 총 횟수: 10 | 예측 성공 수: 5 | 예측 성공률: 50.00%
2024-09-20 14:26:37 - INFO - XGBOOST | 이전예측가격: 85239000 | 당시BTC가격: 85239000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:26:37 - INFO - LSTM 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 18/30
2024-09-20 14:26:37 - INFO - LSTM | 이전예측가격: 85110399 | 당시BTC가격: 85239000 | 예측: 하락 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0667 | 반영가중치값: 0.0200 | 새 가중치: 0.0867 | 예측 총 횟수: 30 | 예측 성공 수: 18 | 예측 성공률: 60.00%
2024-09-20 14:26:37 - INFO - RL 모델 예측 업데이트: 정확도 60.00%, 적중/전체: 6/10
2024-09-20 14:26:37 - INFO - RL | 이전예측가격: 86091390 | 당시BTC가격: 85239000 | 예측: 상승 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1534 | 반영가중치값: -0.0200 | 새 가중치: 0.1334 | 예측 총 횟수: 10 | 예측 성공 수: 6 | 예측 성공률: 60.00%
2024-09-20 14:26:37 - INFO - ARIMA 모델 예측 업데이트: 정확도 44.44%, 적중/전체: 4/9
2024-09-20 14:26:37 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85239000 | 예측: 하락 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0886 | 반영가중치값: 0.0200 | 새 가중치: 0.1086 | 예측 총 횟수: 9 | 예측 성공 수: 4 | 예측 성공률: 44.44%
2024-09-20 14:26:37 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.66%, 적중/전체: 71/119
2024-09-20 14:26:37 - INFO - PROPHET | 이전예측가격: 85314961 | 당시BTC가격: 85239000 | 예측: 상승 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3787 | 반영가중치값: -0.0200 | 새 가중치: 0.3587 | 예측 총 횟수: 119 | 예측 성공 수: 71 | 예측 성공률: 59.66%
2024-09-20 14:26:37 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 56.67%, 적중/전체: 17/30
2024-09-20 14:26:37 - INFO - TRANSFORMER | 이전예측가격: 85117803 | 당시BTC가격: 85239000 | 예측: 하락 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0272 | 반영가중치값: 0.0200 | 새 가중치: 0.0472 | 예측 총 횟수: 30 | 예측 성공 수: 17 | 예측 성공률: 56.67%
2024-09-20 14:26:37 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.71%, 적중/전체: 39/70
2024-09-20 14:26:37 - INFO - BITCOIN_FORECAST | 이전예측가격: 83420027 | 당시BTC가격: 85239000 | 예측: 하락 | 지금 BTC가격: 85120000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1136 | 반영가중치값: 0.0200 | 새 가중치: 0.1336 | 예측 총 횟수: 70 | 예측 성공 수: 39 | 예측 성공률: 55.71%
2024-09-20 14:26:37 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:26:37 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:26:37 - INFO - 새로운 가중치: {'gpt': 0.00291366797597195, 'ml': 0.1307389869000464, 'xgboost': 0.015415173188049634, 'rl': 0.1307389869000464, 'lstm': 0.08496992913509785, 'arima': 0.10646973891877273, 'prophet': 0.3515107128741412, 'transformer': 0.04626487548198684, 'bitcoin_forecast': 0.13097792862588703}
2024-09-20 14:26:37 - INFO - XGBoost 모델 성능: 정확도 60.16%, 적중/전체: 77/128
2024-09-20 14:26:37 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:26:37 - INFO - Current BTC price: 85120000.0
2024-09-20 14:26:37 - INFO - Analyzing market conditions.
2024-09-20 14:26:37 - INFO - Market analysis: {'current_price': 85149000.0, 'sma_20': 84676400.0, 'rsi_14': 63.87916746465039, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:26:37 - INFO - Starting predictions for all models
2024-09-20 14:26:37 - INFO - Attempting prediction for gpt
2024-09-20 14:26:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:26:38 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:26:38 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:26:38 - INFO - GPT prediction: 85120000.0
2024-09-20 14:26:38 - INFO - Attempting prediction for ml
2024-09-20 14:26:38 - INFO - ML prediction: 85404446.99999999
2024-09-20 14:26:38 - INFO - Attempting prediction for xgboost
2024-09-20 14:26:38 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:26:38 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:26:38 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:26:38 - INFO - XGBOOST prediction: 85149000.0
2024-09-20 14:26:38 - INFO - Attempting prediction for lstm
2024-09-20 14:26:38 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:26:38 - INFO - X 샘플:
[[-1.83573106 -1.89398326 -2.07489802 -1.53776101  0.09623284  0.09151118
  -1.53776101]
 [-0.785226   -0.06963174 -0.21650302  0.60543477  2.61177645  2.61132403
   0.60543477]
 [ 1.67656362  1.73383027  1.07508151  1.32704951  0.40986307  0.41486358
   1.32704951]
 [ 1.18845016  0.94699163 -0.67180979 -1.22025052  0.40018007  0.40174593
  -1.22025052]
 [-0.7003367  -1.53189823 -0.93198509 -1.49446412  0.03787748  0.03487032
  -1.49446412]
 [-0.88603204  0.12533713 -0.49526227  0.61265091 -0.30631983 -0.30577471
   0.61265091]
 [ 0.41383533  0.27852695  0.83349016 -0.166693   -0.84597348 -0.84542394
  -0.166693  ]
 [ 0.14855627  0.06963174  0.89853398  0.60543477 -0.92785623 -0.927818
   0.60543477]
 [ 0.29711254  0.20193204  1.08437348  0.95902599 -0.93840516 -0.93833084
   0.95902599]
 [ 0.48280788  0.13926348  0.49897906  0.30957272 -0.5373752  -0.53696755
   0.30957272]]
2024-09-20 14:26:38 - INFO - y 샘플:
[0.30957272]
2024-09-20 14:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:26:38 - INFO - 모델 출력 (스케일링된 예측): [[0.2348876]]
2024-09-20 14:26:38 - INFO - 스케일러 역변환 후 예측 가격: 85138650.27748378
2024-09-20 14:26:38 - INFO - LSTMPredictor 최종 예측 가격: 85138650.27748378
2024-09-20 14:26:38 - INFO - LSTM prediction: 85138650.27748378
2024-09-20 14:26:38 - INFO - Attempting prediction for rl
2024-09-20 14:26:38 - INFO - Preparing state for RL agent.
2024-09-20 14:26:38 - INFO - Prepared state: [[ 8.51490000e+07  2.63849503e+01 -1.05585471e-03  8.46764000e+07
   6.38791675e+01]]
2024-09-20 14:26:38 - INFO - RL prediction: 85971200.0
2024-09-20 14:26:38 - INFO - Attempting prediction for arima
2024-09-20 14:26:38 - INFO - ARIMA 예측 시작
2024-09-20 14:26:38 - INFO - 입력 데이터: {'open': 85213000.0, 'high': 85230000.0, 'low': 85047000.0, 'close': 85149000.0, 'volume': 26.38495031, 'value': 2246466171.83697, 'decision': 'sell', 'sma': 84676400.0, 'ema': 84769193.0327708, 'rsi': 63.87916746465039, 'macd': 310248.617831409, 'signal_line': 273936.3672605273, 'BB_Upper': 85632326.85912764, 'BB_Lower': 83720473.14087236}
2024-09-20 14:26:38 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:26:38 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84676400.0         0         0
2024-09-20 14:26:38 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84676400.0         0         0
2024-09-20 14:26:38 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:26:38 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:26:38 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:26:38 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:26:38 - INFO - Attempting prediction for prophet
2024-09-20 14:26:38 - INFO - PROPHET prediction: 85213193.97040293
2024-09-20 14:26:38 - INFO - Attempting prediction for transformer
2024-09-20 14:26:38 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:26:38 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:26:38 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:26:38 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:26:38 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:26:38 - INFO - X 샘플:
[[-1.83573106 -1.89398326 -2.07489802 -1.53776101  0.09623284  0.09151118
  -1.53776101 -1.53776101  0.          0.          0.         -1.53776101
  -1.53776101]
 [-0.785226   -0.06963174 -0.21650302  0.60543477  2.61177645  2.61132403
   0.60543477  0.60543477  0.          0.          0.          0.60543477
   0.60543477]
 [ 1.67656362  1.73383027  1.07508151  1.32704951  0.40986307  0.41486358
   1.32704951  1.32704951  0.          0.          0.          1.32704951
   1.32704951]
 [ 1.18845016  0.94699163 -0.67180979 -1.22025052  0.40018007  0.40174593
  -1.22025052 -1.22025052  0.          0.          0.         -1.22025052
  -1.22025052]
 [-0.7003367  -1.53189823 -0.93198509 -1.49446412  0.03787748  0.03487032
  -1.49446412 -1.49446412  0.          0.          0.         -1.49446412
  -1.49446412]
 [-0.88603204  0.12533713 -0.49526227  0.61265091 -0.30631983 -0.30577471
   0.61265091  0.61265091  0.          0.          0.          0.61265091
   0.61265091]
 [ 0.41383533  0.27852695  0.83349016 -0.166693   -0.84597348 -0.84542394
  -0.166693   -0.166693    0.          0.          0.         -0.166693
  -0.166693  ]
 [ 0.14855627  0.06963174  0.89853398  0.60543477 -0.92785623 -0.927818
   0.60543477  0.60543477  0.          0.          0.          0.60543477
   0.60543477]
 [ 0.29711254  0.20193204  1.08437348  0.95902599 -0.93840516 -0.93833084
   0.95902599  0.95902599  0.          0.          0.          0.95902599
   0.95902599]
 [ 0.48280788  0.13926348  0.49897906  0.30957272 -0.5373752  -0.53696755
   0.30957272  0.30957272  0.          0.          0.          0.30957272
   0.30957272]]
2024-09-20 14:26:38 - INFO - y 샘플:
[0.30957272]
2024-09-20 14:26:38 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:26:38 - INFO - 모델 출력 (스케일링된 예측): [0.3074171]
2024-09-20 14:26:38 - INFO - 스케일러 역변환 후 예측 가격: 85148701.27711435
2024-09-20 14:26:38 - INFO - TransformerPredictor 최종 예측 가격: 85148701.27711435
2024-09-20 14:26:38 - INFO - TRANSFORMER prediction: 85148701.27711435
2024-09-20 14:26:38 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:26:38 - INFO - BITCOIN_FORECAST prediction: 83569521.53117192
2024-09-20 14:26:38 - INFO - BitcoinForecast prediction: 83569521.53117192
2024-09-20 14:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:26:47 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:26:47 - INFO - 조정된 모델 가중치: {'gpt': 0.00291366797597195, 'ml': 0.1307389869000464, 'xgboost': 0.015415173188049634, 'rl': 0.1307389869000464, 'lstm': 0.08496992913509785, 'arima': 0.10646973891877273, 'prophet': 0.3515107128741412, 'transformer': 0.04626487548198684, 'bitcoin_forecast': 0.13097792862588703}
2024-09-20 14:26:47 - INFO - 조정된 모델 가중치: {'gpt': 0.00291366797597195, 'ml': 0.1307389869000464, 'xgboost': 0.015415173188049634, 'rl': 0.1307389869000464, 'lstm': 0.08496992913509785, 'arima': 0.10646973891877273, 'prophet': 0.3515107128741412, 'transformer': 0.04626487548198684, 'bitcoin_forecast': 0.13097792862588703}
2024-09-20 14:26:47 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85077344.54205775, 'current_price': 85120000.0, 'predictions': {'gpt': 85120000.0, 'ml': 85404446.99999999, 'xgboost': 85149000.0, 'lstm': 85138650.27748378, 'rl': 85971200.0, 'arima': 84893000.0, 'prophet': 85213193.97040293, 'transformer': 85148701.27711435, 'bitcoin_forecast': 83569521.53117192}, 'weights': {'gpt': 0.00291366797597195, 'ml': 0.1307389869000464, 'xgboost': 0.015415173188049634, 'rl': 0.1307389869000464, 'lstm': 0.08496992913509785, 'arima': 0.10646973891877273, 'prophet': 0.3515107128741412, 'transformer': 0.04626487548198684, 'bitcoin_forecast': 0.13097792862588703}}
2024-09-20 14:26:47 - INFO - 모델별 가중치:
2024-09-20 14:26:47 - INFO -   - GPT: 0.0029
2024-09-20 14:26:47 - INFO -   - ML: 0.1307
2024-09-20 14:26:47 - INFO -   - XGBOOST: 0.0154
2024-09-20 14:26:47 - INFO -   - RL: 0.1307
2024-09-20 14:26:47 - INFO -   - LSTM: 0.0850
2024-09-20 14:26:47 - INFO -   - ARIMA: 0.1065
2024-09-20 14:26:47 - INFO -   - PROPHET: 0.3515
2024-09-20 14:26:47 - INFO -   - TRANSFORMER: 0.0463
2024-09-20 14:26:47 - INFO -   - BITCOIN_FORECAST: 0.1310
2024-09-20 14:26:47 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:26:47 - INFO - 6. 거래 실행
2024-09-20 14:26:47 - INFO - Cancelling existing orders.
2024-09-20 14:26:47 - INFO - Cancelled 0 orders.
2024-09-20 14:26:47 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85077344.54205775, 'current_price': 85120000.0, 'predictions': {'gpt': 85120000.0, 'ml': 85404446.99999999, 'xgboost': 85149000.0, 'lstm': 85138650.27748378, 'rl': 85971200.0, 'arima': 84893000.0, 'prophet': 85213193.97040293, 'transformer': 85148701.27711435, 'bitcoin_forecast': 83569521.53117192}, 'weights': {'gpt': 0.00291366797597195, 'ml': 0.1307389869000464, 'xgboost': 0.015415173188049634, 'rl': 0.1307389869000464, 'lstm': 0.08496992913509785, 'arima': 0.10646973891877273, 'prophet': 0.3515107128741412, 'transformer': 0.04626487548198684, 'bitcoin_forecast': 0.13097792862588703}}, 현재 가격=85120000.0
2024-09-20 14:26:47 - INFO - 현재 잔고: KRW=338635.77622628, BTC=0.00166079, 총 자산가치=480002.22102628
2024-09-20 14:26:47 - INFO - 매도 시도: 0.00016607900000000002 BTC (약 14136.64448 KRW)
2024-09-20 14:26:47 - INFO - 주문 결과: {'uuid': 'c562a487-0c15-4ae9-8a73-e4632a84551e', 'side': 'ask', 'ord_type': 'limit', 'price': '85120000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:26:49+09:00', 'volume': '0.00016607', 'remaining_volume': '0.00016607', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00016607', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:26:47 - INFO - sell 주문 성공: UUID=c562a487-0c15-4ae9-8a73-e4632a84551e
2024-09-20 14:26:47 - INFO - Trade executed successfully.
2024-09-20 14:26:47 - INFO - 7. summary 리포트 보내기
2024-09-20 14:26:47 - INFO - Message sent to Discord successfully.
2024-09-20 14:26:47 - INFO - Trading cycle completed.
2024-09-20 14:26:47 - INFO - Performing periodic update.
2024-09-20 14:26:47 - INFO - 계산된 시장 변동성: 0.029984733196266572
2024-09-20 14:35:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:35:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8160-a349-ceab83afbae8 "HTTP/1.1 200 OK"
2024-09-20 14:35:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:35:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:35:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/b4312225-56ac-496d-ad05-2ef881231c71 "HTTP/1.1 200 OK"
2024-09-20 14:35:46 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:35:51 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:35:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c0-b869-dafcb71940e9 "HTTP/1.1 200 OK"
2024-09-20 14:35:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:35:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:35:59 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8132-867c-f7b0608a2a14 "HTTP/1.1 200 OK"
2024-09-20 14:35:59 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:36:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8157-a637-ce679ad9778b "HTTP/1.1 200 OK"
2024-09-20 14:36:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:36:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/efb98af4-7613-4cd6-8a95-a141ea4a4521 "HTTP/1.1 200 OK"
2024-09-20 14:36:13 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:36:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816b-a661-c33f740c0396 "HTTP/1.1 200 OK"
2024-09-20 14:36:18 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:22 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:36:23 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-812f-85d4-e1dc5c29d416 "HTTP/1.1 200 OK"
2024-09-20 14:36:23 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:36:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8153-be66-c764127a665c "HTTP/1.1 200 OK"
2024-09-20 14:36:29 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:25:34.978746
2024-09-20 14:36:29 - INFO - Starting trading cycle.
2024-09-20 14:36:29 - INFO - ##################################################
2024-09-20 14:36:29 - INFO - 9 회 예측 후 모델 재학습 검토
2024-09-20 14:36:29 - INFO - ##################################################
2024-09-20 14:36:29 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:36:29 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:36:29 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:20:00
2024-09-20 14:36:29 - INFO - 새로운 데이터 범위: 2024-09-19 05:20:00 ~ 2024-09-20 14:30:00
2024-09-20 14:36:29 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:36:29 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:36:29 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:36:29 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:36:29 - INFO - Sample date values: [Timestamp('2024-09-20 14:30:00')]
2024-09-20 14:36:29 - INFO - Successfully added 1 new data points
2024-09-20 14:36:29 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:36:29 - INFO - Final date range: 2024-09-20 14:30:00 to 2024-09-20 14:30:00
2024-09-20 14:36:29 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:36:29 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:30:00
2024-09-20 14:36:29 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:36:29 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:36:29 - INFO - GPT | 이전예측가격: 85120000 | 당시BTC가격: 85120000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:36:29 - INFO - ML 모델 예측 업데이트: 정확도 45.45%, 적중/전체: 5/11
2024-09-20 14:36:29 - INFO - ML | 이전예측가격: 85404447 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0352 | 반영가중치값: -0.0200 | 새 가중치: 0.0152 | 예측 총 횟수: 11 | 예측 성공 수: 5 | 예측 성공률: 45.45%
2024-09-20 14:36:29 - INFO - XGBOOST 모델 예측 업데이트: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 14:36:29 - INFO - XGBOOST | 이전예측가격: 85149000 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0157 | 반영가중치값: -0.0200 | 새 가중치: 0.0000 | 예측 총 횟수: 129 | 예측 성공 수: 77 | 예측 성공률: 59.69%
2024-09-20 14:36:29 - INFO - LSTM 모델 예측 업데이트: 정확도 58.06%, 적중/전체: 18/31
2024-09-20 14:36:29 - INFO - LSTM | 이전예측가격: 85138650 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1552 | 반영가중치값: -0.0200 | 새 가중치: 0.1352 | 예측 총 횟수: 31 | 예측 성공 수: 18 | 예측 성공률: 58.06%
2024-09-20 14:36:29 - INFO - RL 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 6/11
2024-09-20 14:36:29 - INFO - RL | 이전예측가격: 85971200 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1551 | 반영가중치값: -0.0200 | 새 가중치: 0.1351 | 예측 총 횟수: 11 | 예측 성공 수: 6 | 예측 성공률: 54.55%
2024-09-20 14:36:29 - INFO - ARIMA 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 5/10
2024-09-20 14:36:29 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85120000 | 예측: 하락 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1130 | 반영가중치값: 0.0200 | 새 가중치: 0.1330 | 예측 총 횟수: 10 | 예측 성공 수: 5 | 예측 성공률: 50.00%
2024-09-20 14:36:29 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.17%, 적중/전체: 71/120
2024-09-20 14:36:29 - INFO - PROPHET | 이전예측가격: 85213194 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.2525 | 반영가중치값: -0.0200 | 새 가중치: 0.2325 | 예측 총 횟수: 120 | 예측 성공 수: 71 | 예측 성공률: 59.17%
2024-09-20 14:36:29 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.84%, 적중/전체: 17/31
2024-09-20 14:36:29 - INFO - TRANSFORMER | 이전예측가격: 85148701 | 당시BTC가격: 85120000 | 예측: 상승 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1834 | 반영가중치값: -0.0200 | 새 가중치: 0.1634 | 예측 총 횟수: 31 | 예측 성공 수: 17 | 예측 성공률: 54.84%
2024-09-20 14:36:29 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.34%, 적중/전체: 40/71
2024-09-20 14:36:29 - INFO - BITCOIN_FORECAST | 이전예측가격: 83569522 | 당시BTC가격: 85120000 | 예측: 하락 | 지금 BTC가격: 85002000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0869 | 반영가중치값: 0.0200 | 새 가중치: 0.1069 | 예측 총 횟수: 71 | 예측 성공 수: 40 | 예측 성공률: 56.34%
2024-09-20 14:36:29 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:36:29 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:36:29 - INFO - 새로운 가중치: {'gpt': 0.0031525982433462307, 'ml': 0.01644464915422364, 'xgboost': 0.0, 'rl': 0.14614021002701416, 'lstm': 0.1462789125608327, 'arima': 0.14394784385723747, 'prophet': 0.251536618852052, 'transformer': 0.1768505771505042, 'bitcoin_forecast': 0.11564859015478958}
2024-09-20 14:36:29 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 14:36:29 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:36:29 - INFO - Current BTC price: 85002000.0
2024-09-20 14:36:29 - INFO - Analyzing market conditions.
2024-09-20 14:36:29 - INFO - Market analysis: {'current_price': 85002000.0, 'sma_20': 84726350.0, 'rsi_14': 59.10574898473216, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:36:29 - INFO - Starting predictions for all models
2024-09-20 14:36:29 - INFO - Attempting prediction for gpt
2024-09-20 14:36:30 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:36:30 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:36:30 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:36:30 - INFO - GPT prediction: 85002000.0
2024-09-20 14:36:30 - INFO - Attempting prediction for ml
2024-09-20 14:36:30 - INFO - ML prediction: 85325007.60000001
2024-09-20 14:36:30 - INFO - Attempting prediction for xgboost
2024-09-20 14:36:30 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:36:30 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:36:30 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:36:30 - INFO - XGBOOST prediction: 85002000.0
2024-09-20 14:36:30 - INFO - Attempting prediction for lstm
2024-09-20 14:36:30 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:36:30 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:36:30 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:36:30 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:36:30 - INFO - X 샘플:
[[-1.17077373 -0.22110515 -0.58091425  0.58395142  2.63904225  2.63788009
   0.58395142]
 [ 1.89145294  1.9563182   1.1976558   1.38388487  0.47688867  0.48136874
   1.38388487]
 [ 1.28428731  1.00632268 -1.20789218 -1.43988021  0.46738051  0.46848967
  -1.43988021]
 [-1.06517971 -1.98658354 -1.56616528 -1.74385492  0.11162     0.10828677
  -1.74385492]
 [-1.29616663  0.01429197 -0.96477829  0.59195075 -0.22636217 -0.22616263
   0.59195075]
 [ 0.32074185  0.19924685  0.86497363 -0.27197737 -0.75627133 -0.75599675
  -0.27197737]
 [-0.00923948 -0.05296435  0.95454191  0.58395142 -0.83667553 -0.83689223
   0.58395142]
 [ 0.17555006  0.10676941  1.21045127  0.97591881 -0.84703398 -0.84721387
   0.97591881]
 [ 0.40653699  0.03110605  0.40433679  0.2559787  -0.45324539 -0.45315055
   0.2559787 ]
 [-0.53720959 -1.05340211 -0.31220942 -0.91992347 -0.57534303 -0.57660925
  -0.91992347]]
2024-09-20 14:36:30 - INFO - y 샘플:
[-0.91992347]
2024-09-20 14:36:30 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:36:30 - INFO - 모델 출력 (스케일링된 예측): [[0.13064048]]
2024-09-20 14:36:30 - INFO - 스케일러 역변환 후 예측 가격: 85133331.4182222
2024-09-20 14:36:30 - INFO - LSTMPredictor 최종 예측 가격: 85133331.4182222
2024-09-20 14:36:30 - INFO - LSTM prediction: 85133331.4182222
2024-09-20 14:36:30 - INFO - Attempting prediction for rl
2024-09-20 14:36:30 - INFO - Preparing state for RL agent.
2024-09-20 14:36:30 - INFO - Prepared state: [[ 8.50020000e+07  2.31303086e+01 -1.72638551e-03  8.47263500e+07
   5.91057490e+01]]
2024-09-20 14:36:30 - INFO - RL prediction: 85852020.0
2024-09-20 14:36:30 - INFO - Attempting prediction for arima
2024-09-20 14:36:30 - INFO - ARIMA 예측 시작
2024-09-20 14:36:30 - INFO - 입력 데이터: {'open': 85070000.0, 'high': 85101000.0, 'low': 84991000.0, 'close': 85002000.0, 'volume': 23.1303086, 'value': 1966527861.29249, 'decision': 'sell', 'sma': 84726350.0, 'ema': 84791365.12488785, 'rsi': 59.10574898473216, 'macd': 289879.7423775047, 'signal_line': 277125.0422839228, 'BB_Upper': 85639764.31453817, 'BB_Lower': 83812935.68546183}
2024-09-20 14:36:30 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:36:30 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84726350.0         0         0
2024-09-20 14:36:30 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84726350.0         0         0
2024-09-20 14:36:30 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:36:30 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:36:30 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:36:30 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:36:30 - INFO - Attempting prediction for prophet
2024-09-20 14:36:30 - INFO - PROPHET prediction: 85037231.03214136
2024-09-20 14:36:30 - INFO - Attempting prediction for transformer
2024-09-20 14:36:30 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:36:30 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:36:30 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:36:30 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:36:30 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:36:30 - INFO - X 샘플:
[[-1.17077373 -0.22110515 -0.58091425  0.58395142  2.63904225  2.63788009
   0.58395142  0.58395142  0.          0.          0.          0.58395142
   0.58395142]
 [ 1.89145294  1.9563182   1.1976558   1.38388487  0.47688867  0.48136874
   1.38388487  1.38388487  0.          0.          0.          1.38388487
   1.38388487]
 [ 1.28428731  1.00632268 -1.20789218 -1.43988021  0.46738051  0.46848967
  -1.43988021 -1.43988021  0.          0.          0.         -1.43988021
  -1.43988021]
 [-1.06517971 -1.98658354 -1.56616528 -1.74385492  0.11162     0.10828677
  -1.74385492 -1.74385492  0.          0.          0.         -1.74385492
  -1.74385492]
 [-1.29616663  0.01429197 -0.96477829  0.59195075 -0.22636217 -0.22616263
   0.59195075  0.59195075  0.          0.          0.          0.59195075
   0.59195075]
 [ 0.32074185  0.19924685  0.86497363 -0.27197737 -0.75627133 -0.75599675
  -0.27197737 -0.27197737  0.          0.          0.         -0.27197737
  -0.27197737]
 [-0.00923948 -0.05296435  0.95454191  0.58395142 -0.83667553 -0.83689223
   0.58395142  0.58395142  0.          0.          0.          0.58395142
   0.58395142]
 [ 0.17555006  0.10676941  1.21045127  0.97591881 -0.84703398 -0.84721387
   0.97591881  0.97591881  0.          0.          0.          0.97591881
   0.97591881]
 [ 0.40653699  0.03110605  0.40433679  0.2559787  -0.45324539 -0.45315055
   0.2559787   0.2559787   0.          0.          0.          0.2559787
   0.2559787 ]
 [-0.53720959 -1.05340211 -0.31220942 -0.91992347 -0.57534303 -0.57660925
  -0.91992347 -0.91992347  0.          0.          0.         -0.91992347
  -0.91992347]]
2024-09-20 14:36:30 - INFO - y 샘플:
[-0.91992347]
2024-09-20 14:36:30 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:36:30 - INFO - 모델 출력 (스케일링된 예측): [0.30432022]
2024-09-20 14:36:30 - INFO - 스케일러 역변환 후 예측 가격: 85155043.19182096
2024-09-20 14:36:30 - INFO - TransformerPredictor 최종 예측 가격: 85155043.19182096
2024-09-20 14:36:30 - INFO - TRANSFORMER prediction: 85155043.19182096
2024-09-20 14:36:30 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:36:30 - INFO - BITCOIN_FORECAST prediction: 83530780.70506856
2024-09-20 14:36:30 - INFO - BitcoinForecast prediction: 83530780.70506856
2024-09-20 14:36:30 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:31 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:32 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:33 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:36:35 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:36:35 - INFO - 조정된 모델 가중치: {'gpt': 0.0031525982433462307, 'ml': 0.01644464915422364, 'xgboost': 0.0, 'rl': 0.14614021002701416, 'lstm': 0.1462789125608327, 'arima': 0.14394784385723747, 'prophet': 0.251536618852052, 'transformer': 0.1768505771505042, 'bitcoin_forecast': 0.11564859015478958}
2024-09-20 14:36:35 - INFO - 조정된 모델 가중치: {'gpt': 0.0031525982433462307, 'ml': 0.01644464915422364, 'xgboost': 0.0, 'rl': 0.14614021002701416, 'lstm': 0.1462789125608327, 'arima': 0.14394784385723747, 'prophet': 0.251536618852052, 'transformer': 0.1768505771505042, 'bitcoin_forecast': 0.11564859015478958}
2024-09-20 14:36:35 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 85000837.78428414, 'current_price': 85002000.0, 'predictions': {'gpt': 85002000.0, 'ml': 85325007.60000001, 'xgboost': 85002000.0, 'lstm': 85133331.4182222, 'rl': 85852020.0, 'arima': 84893000.0, 'prophet': 85037231.03214136, 'transformer': 85155043.19182096, 'bitcoin_forecast': 83530780.70506856}, 'weights': {'gpt': 0.0031525982433462307, 'ml': 0.01644464915422364, 'xgboost': 0.0, 'rl': 0.14614021002701416, 'lstm': 0.1462789125608327, 'arima': 0.14394784385723747, 'prophet': 0.251536618852052, 'transformer': 0.1768505771505042, 'bitcoin_forecast': 0.11564859015478958}}
2024-09-20 14:36:35 - INFO - 모델별 가중치:
2024-09-20 14:36:35 - INFO -   - GPT: 0.0032
2024-09-20 14:36:35 - INFO -   - ML: 0.0164
2024-09-20 14:36:35 - INFO -   - XGBOOST: 0.0000
2024-09-20 14:36:35 - INFO -   - RL: 0.1461
2024-09-20 14:36:35 - INFO -   - LSTM: 0.1463
2024-09-20 14:36:35 - INFO -   - ARIMA: 0.1439
2024-09-20 14:36:35 - INFO -   - PROPHET: 0.2515
2024-09-20 14:36:35 - INFO -   - TRANSFORMER: 0.1769
2024-09-20 14:36:35 - INFO -   - BITCOIN_FORECAST: 0.1156
2024-09-20 14:36:35 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:36:35 - INFO - 6. 거래 실행
2024-09-20 14:36:35 - INFO - Cancelling existing orders.
2024-09-20 14:36:35 - INFO - Cancelled 0 orders.
2024-09-20 14:36:35 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 85000837.78428414, 'current_price': 85002000.0, 'predictions': {'gpt': 85002000.0, 'ml': 85325007.60000001, 'xgboost': 85002000.0, 'lstm': 85133331.4182222, 'rl': 85852020.0, 'arima': 84893000.0, 'prophet': 85037231.03214136, 'transformer': 85155043.19182096, 'bitcoin_forecast': 83530780.70506856}, 'weights': {'gpt': 0.0031525982433462307, 'ml': 0.01644464915422364, 'xgboost': 0.0, 'rl': 0.14614021002701416, 'lstm': 0.1462789125608327, 'arima': 0.14394784385723747, 'prophet': 0.251536618852052, 'transformer': 0.1768505771505042, 'bitcoin_forecast': 0.11564859015478958}}, 현재 가격=85002000.0
2024-09-20 14:36:35 - INFO - 현재 잔고: KRW=352766.08056977, BTC=0.00149472, 총 자산가치=479820.27000977
2024-09-20 14:36:35 - INFO - 매도 시도: 0.00014947200000000002 BTC (약 12705.418944000003 KRW)
2024-09-20 14:36:35 - INFO - 주문 결과: {'uuid': '1d454880-9fdd-4b3e-be11-c6d79116b8ca', 'side': 'ask', 'ord_type': 'limit', 'price': '85002000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:36:37+09:00', 'volume': '0.00014947', 'remaining_volume': '0.00014947', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00014947', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:36:35 - INFO - sell 주문 성공: UUID=1d454880-9fdd-4b3e-be11-c6d79116b8ca
2024-09-20 14:36:35 - INFO - Trade executed successfully.
2024-09-20 14:36:35 - INFO - 7. summary 리포트 보내기
2024-09-20 14:36:36 - INFO - Message sent to Discord successfully.
2024-09-20 14:36:36 - INFO - Trading cycle completed.
2024-09-20 14:36:36 - INFO - Performing periodic update.
2024-09-20 14:36:36 - INFO - 계산된 시장 변동성: 0.030129117260971998
2024-09-20 14:45:42 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:45:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8118-8e48-ee51b1fdf8e7 "HTTP/1.1 200 OK"
2024-09-20 14:45:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:45:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:45:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d9-9933-d1bd70f5c788 "HTTP/1.1 200 OK"
2024-09-20 14:45:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:45:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:45:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8160-8165-f2042dbc6771 "HTTP/1.1 200 OK"
2024-09-20 14:45:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:45:59 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/81b452a7-7fd5-462a-8a5b-5464f7d93117 "HTTP/1.1 200 OK"
2024-09-20 14:46:03 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:08 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81d9-bb09-e8ff03c0b7ba "HTTP/1.1 200 OK"
2024-09-20 14:46:08 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:15 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8125-a28d-ecc90d16e331 "HTTP/1.1 200 OK"
2024-09-20 14:46:18 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:25 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8178-9216-e70a0c28c4c7 "HTTP/1.1 200 OK"
2024-09-20 14:46:25 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:30 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8171-aeb6-dc0e389faae7 "HTTP/1.1 200 OK"
2024-09-20 14:46:30 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:46:40 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8137-94cc-c64ac47d4c1f "HTTP/1.1 200 OK"
2024-09-20 14:46:40 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:35:34.979254
2024-09-20 14:46:40 - INFO - Starting trading cycle.
2024-09-20 14:46:40 - INFO - ##################################################
2024-09-20 14:46:40 - INFO - 10 회 예측 후 모델 재학습 검토
2024-09-20 14:46:40 - INFO - ##################################################
2024-09-20 14:46:40 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:46:40 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:46:40 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:30:00
2024-09-20 14:46:40 - INFO - 새로운 데이터 범위: 2024-09-19 05:30:00 ~ 2024-09-20 14:40:00
2024-09-20 14:46:40 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:46:40 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:46:40 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:46:40 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:46:40 - INFO - Sample date values: [Timestamp('2024-09-20 14:40:00')]
2024-09-20 14:46:40 - INFO - Successfully added 1 new data points
2024-09-20 14:46:40 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:46:40 - INFO - Final date range: 2024-09-20 14:40:00 to 2024-09-20 14:40:00
2024-09-20 14:46:40 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:46:40 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:40:00
2024-09-20 14:46:40 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:46:41 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:46:41 - INFO - GPT | 이전예측가격: 85002000 | 당시BTC가격: 85002000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:46:41 - INFO - ML 모델 예측 업데이트: 정확도 41.67%, 적중/전체: 5/12
2024-09-20 14:46:41 - INFO - ML | 이전예측가격: 85325008 | 당시BTC가격: 85002000 | 예측: 상승 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1307 | 반영가중치값: -0.0200 | 새 가중치: 0.1107 | 예측 총 횟수: 12 | 예측 성공 수: 5 | 예측 성공률: 41.67%
2024-09-20 14:46:41 - INFO - XGBOOST | 이전예측가격: 85002000 | 당시BTC가격: 85002000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:46:41 - INFO - LSTM 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 18/32
2024-09-20 14:46:41 - INFO - LSTM | 이전예측가격: 85133331 | 당시BTC가격: 85002000 | 예측: 상승 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0850 | 반영가중치값: -0.0200 | 새 가중치: 0.0650 | 예측 총 횟수: 32 | 예측 성공 수: 18 | 예측 성공률: 56.25%
2024-09-20 14:46:41 - INFO - RL 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 6/12
2024-09-20 14:46:41 - INFO - RL | 이전예측가격: 85852020 | 당시BTC가격: 85002000 | 예측: 상승 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1307 | 반영가중치값: -0.0200 | 새 가중치: 0.1107 | 예측 총 횟수: 12 | 예측 성공 수: 6 | 예측 성공률: 50.00%
2024-09-20 14:46:41 - INFO - ARIMA 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 6/11
2024-09-20 14:46:41 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 85002000 | 예측: 하락 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1065 | 반영가중치값: 0.0200 | 새 가중치: 0.1265 | 예측 총 횟수: 11 | 예측 성공 수: 6 | 예측 성공률: 54.55%
2024-09-20 14:46:41 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.68%, 적중/전체: 71/121
2024-09-20 14:46:41 - INFO - PROPHET | 이전예측가격: 85037231 | 당시BTC가격: 85002000 | 예측: 상승 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3515 | 반영가중치값: -0.0200 | 새 가중치: 0.3315 | 예측 총 횟수: 121 | 예측 성공 수: 71 | 예측 성공률: 58.68%
2024-09-20 14:46:41 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 53.12%, 적중/전체: 17/32
2024-09-20 14:46:41 - INFO - TRANSFORMER | 이전예측가격: 85155043 | 당시BTC가격: 85002000 | 예측: 상승 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0463 | 반영가중치값: -0.0200 | 새 가중치: 0.0263 | 예측 총 횟수: 32 | 예측 성공 수: 17 | 예측 성공률: 53.12%
2024-09-20 14:46:41 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.94%, 적중/전체: 41/72
2024-09-20 14:46:41 - INFO - BITCOIN_FORECAST | 이전예측가격: 83530781 | 당시BTC가격: 85002000 | 예측: 하락 | 지금 BTC가격: 84801000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1310 | 반영가중치값: 0.0200 | 새 가중치: 0.1510 | 예측 총 횟수: 72 | 예측 성공 수: 41 | 예측 성공률: 56.94%
2024-09-20 14:46:41 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:46:41 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:46:41 - INFO - 새로운 가중치: {'gpt': 0.0034088638177963934, 'ml': 0.11974063820524024, 'xgboost': 0.0, 'rl': 0.11974063820524024, 'lstm': 0.07025114638088303, 'arima': 0.1367500974652461, 'prophet': 0.3584582579507704, 'transformer': 0.028399871089961667, 'bitcoin_forecast': 0.16325048688486193}
2024-09-20 14:46:41 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 14:46:41 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:46:41 - INFO - Current BTC price: 84801000.0
2024-09-20 14:46:41 - INFO - Analyzing market conditions.
2024-09-20 14:46:41 - INFO - Market analysis: {'current_price': 84800000.0, 'sma_20': 84771200.0, 'rsi_14': 53.22046229427802, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:46:41 - INFO - Starting predictions for all models
2024-09-20 14:46:41 - INFO - Attempting prediction for gpt
2024-09-20 14:46:41 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:46:41 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:46:41 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:46:41 - INFO - GPT prediction: 84801000.0
2024-09-20 14:46:41 - INFO - Attempting prediction for ml
2024-09-20 14:46:41 - INFO - ML prediction: 84935680.0
2024-09-20 14:46:41 - INFO - Attempting prediction for xgboost
2024-09-20 14:46:41 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:46:41 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:46:41 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:46:41 - INFO - XGBOOST prediction: 84800000.0
2024-09-20 14:46:41 - INFO - Attempting prediction for lstm
2024-09-20 14:46:41 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:46:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:46:41 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:46:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:46:41 - INFO - X 샘플:
[[ 1.91243511  1.84683608  1.0889156   1.37934217  1.61573417  1.62320676
   1.37934217]
 [ 1.29225876  1.02000376 -0.75703691 -0.91739267  1.5957419   1.5961668
  -0.91739267]
 [-1.10755407 -1.58488389 -1.031966   -1.16463324  0.84770405  0.83991063
  -1.16463324]
 [-1.34349072  0.15658594 -0.57047788  0.7352154   0.13704774  0.13772466
   0.7352154 ]
 [ 0.30806586  0.31756215  0.8336243   0.03253165 -0.97716279 -0.97467706
   0.03253165]
 [-0.0289865   0.09804914  0.90235657  0.72870907 -1.14622424 -1.14451941
   0.72870907]
 [ 0.15976282  0.23707405  1.0987345   1.04751929 -1.16800437 -1.16618998
   1.04751929]
 [ 0.39569948  0.17122014  0.48014403  0.4619495  -0.340007   -0.3388429
   0.4619495 ]
 [-0.56827029 -0.77268578 -0.06971416 -0.49448115 -0.59673492 -0.59804792
  -0.49448115]
 [-1.01992045 -1.48976159 -1.97458005 -1.80876001  0.03190546  0.02526842
  -1.80876001]]
2024-09-20 14:46:41 - INFO - y 샘플:
[-1.80876001]
2024-09-20 14:46:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:46:41 - INFO - 모델 출력 (스케일링된 예측): [[0.0399423]]
2024-09-20 14:46:41 - INFO - 스케일러 역변환 후 예측 가격: 85084138.99015638
2024-09-20 14:46:41 - INFO - LSTMPredictor 최종 예측 가격: 85084138.99015638
2024-09-20 14:46:41 - INFO - LSTM prediction: 85084138.99015638
2024-09-20 14:46:41 - INFO - Attempting prediction for rl
2024-09-20 14:46:41 - INFO - Preparing state for RL agent.
2024-09-20 14:46:41 - INFO - Prepared state: [[ 8.48000000e+07  3.10998320e+01 -2.37641467e-03  8.47712000e+07
   5.32204623e+01]]
2024-09-20 14:46:41 - INFO - RL prediction: 85649010.0
2024-09-20 14:46:41 - INFO - Attempting prediction for arima
2024-09-20 14:46:41 - INFO - ARIMA 예측 시작
2024-09-20 14:46:41 - INFO - 입력 데이터: {'open': 85003000.0, 'high': 85003000.0, 'low': 84797000.0, 'close': 84800000.0, 'volume': 31.09983198, 'value': 2639702008.8024, 'decision': 'sell', 'sma': 84771200.0, 'ema': 84792187.49394615, 'rsi': 53.22046229427802, 'macd': 254503.78876118362, 'signal_line': 272600.791579375, 'BB_Upper': 85602935.1982462, 'BB_Lower': 83939464.8017538}
2024-09-20 14:46:41 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:46:41 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84771200.0         0         0
2024-09-20 14:46:41 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84771200.0         0         0
2024-09-20 14:46:41 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:46:41 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:46:41 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:46:41 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:46:41 - INFO - Attempting prediction for prophet
2024-09-20 14:46:41 - INFO - PROPHET prediction: 84806652.19720516
2024-09-20 14:46:41 - INFO - Attempting prediction for transformer
2024-09-20 14:46:41 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:46:41 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:46:41 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:46:41 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:46:41 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:46:41 - INFO - X 샘플:
[[ 1.91243511  1.84683608  1.0889156   1.37934217  1.61573417  1.62320676
   1.37934217  1.37934217  0.          0.          0.          1.37934217
   1.37934217]
 [ 1.29225876  1.02000376 -0.75703691 -0.91739267  1.5957419   1.5961668
  -0.91739267 -0.91739267  0.          0.          0.         -0.91739267
  -0.91739267]
 [-1.10755407 -1.58488389 -1.031966   -1.16463324  0.84770405  0.83991063
  -1.16463324 -1.16463324  0.          0.          0.         -1.16463324
  -1.16463324]
 [-1.34349072  0.15658594 -0.57047788  0.7352154   0.13704774  0.13772466
   0.7352154   0.7352154   0.          0.          0.          0.7352154
   0.7352154 ]
 [ 0.30806586  0.31756215  0.8336243   0.03253165 -0.97716279 -0.97467706
   0.03253165  0.03253165  0.          0.          0.          0.03253165
   0.03253165]
 [-0.0289865   0.09804914  0.90235657  0.72870907 -1.14622424 -1.14451941
   0.72870907  0.72870907  0.          0.          0.          0.72870907
   0.72870907]
 [ 0.15976282  0.23707405  1.0987345   1.04751929 -1.16800437 -1.16618998
   1.04751929  1.04751929  0.          0.          0.          1.04751929
   1.04751929]
 [ 0.39569948  0.17122014  0.48014403  0.4619495  -0.340007   -0.3388429
   0.4619495   0.4619495   0.          0.          0.          0.4619495
   0.4619495 ]
 [-0.56827029 -0.77268578 -0.06971416 -0.49448115 -0.59673492 -0.59804792
  -0.49448115 -0.49448115  0.          0.          0.         -0.49448115
  -0.49448115]
 [-1.01992045 -1.48976159 -1.97458005 -1.80876001  0.03190546  0.02526842
  -1.80876001 -1.80876001  0.          0.          0.         -1.80876001
  -1.80876001]]
2024-09-20 14:46:41 - INFO - y 샘플:
[-1.80876001]
2024-09-20 14:46:41 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:46:41 - INFO - 모델 출력 (스케일링된 예측): [0.30138254]
2024-09-20 14:46:41 - INFO - 스케일러 역변환 후 예측 가격: 85124321.4279774
2024-09-20 14:46:41 - INFO - TransformerPredictor 최종 예측 가격: 85124321.4279774
2024-09-20 14:46:41 - INFO - TRANSFORMER prediction: 85124321.4279774
2024-09-20 14:46:41 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:46:41 - INFO - BITCOIN_FORECAST prediction: 83621886.91899395
2024-09-20 14:46:41 - INFO - BitcoinForecast prediction: 83621886.91899395
2024-09-20 14:46:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:45 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:46 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:46:50 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:46:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0034088638177963934, 'ml': 0.11974063820524024, 'xgboost': 0.0, 'rl': 0.11974063820524024, 'lstm': 0.07025114638088303, 'arima': 0.1367500974652461, 'prophet': 0.3584582579507704, 'transformer': 0.028399871089961667, 'bitcoin_forecast': 0.16325048688486193}
2024-09-20 14:46:50 - INFO - 조정된 모델 가중치: {'gpt': 0.0034088638177963934, 'ml': 0.11974063820524024, 'xgboost': 0.0, 'rl': 0.11974063820524024, 'lstm': 0.07025114638088303, 'arima': 0.1367500974652461, 'prophet': 0.3584582579507704, 'transformer': 0.028399871089961667, 'bitcoin_forecast': 0.16325048688486193}
2024-09-20 14:46:50 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84769857.3544407, 'current_price': 84801000.0, 'predictions': {'gpt': 84801000.0, 'ml': 84935680.0, 'xgboost': 84800000.0, 'lstm': 85084138.99015638, 'rl': 85649010.0, 'arima': 84893000.0, 'prophet': 84806652.19720516, 'transformer': 85124321.4279774, 'bitcoin_forecast': 83621886.91899395}, 'weights': {'gpt': 0.0034088638177963934, 'ml': 0.11974063820524024, 'xgboost': 0.0, 'rl': 0.11974063820524024, 'lstm': 0.07025114638088303, 'arima': 0.1367500974652461, 'prophet': 0.3584582579507704, 'transformer': 0.028399871089961667, 'bitcoin_forecast': 0.16325048688486193}}
2024-09-20 14:46:50 - INFO - 모델별 가중치:
2024-09-20 14:46:50 - INFO -   - GPT: 0.0034
2024-09-20 14:46:50 - INFO -   - ML: 0.1197
2024-09-20 14:46:50 - INFO -   - XGBOOST: 0.0000
2024-09-20 14:46:50 - INFO -   - RL: 0.1197
2024-09-20 14:46:50 - INFO -   - LSTM: 0.0703
2024-09-20 14:46:50 - INFO -   - ARIMA: 0.1368
2024-09-20 14:46:50 - INFO -   - PROPHET: 0.3585
2024-09-20 14:46:50 - INFO -   - TRANSFORMER: 0.0284
2024-09-20 14:46:50 - INFO -   - BITCOIN_FORECAST: 0.1633
2024-09-20 14:46:50 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:46:50 - INFO - 6. 거래 실행
2024-09-20 14:46:50 - INFO - Cancelling existing orders.
2024-09-20 14:46:50 - INFO - Cancelled 0 orders.
2024-09-20 14:46:50 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84769857.3544407, 'current_price': 84801000.0, 'predictions': {'gpt': 84801000.0, 'ml': 84935680.0, 'xgboost': 84800000.0, 'lstm': 85084138.99015638, 'rl': 85649010.0, 'arima': 84893000.0, 'prophet': 84806652.19720516, 'transformer': 85124321.4279774, 'bitcoin_forecast': 83621886.91899395}, 'weights': {'gpt': 0.0034088638177963934, 'ml': 0.11974063820524024, 'xgboost': 0.0, 'rl': 0.11974063820524024, 'lstm': 0.07025114638088303, 'arima': 0.1367500974652461, 'prophet': 0.3584582579507704, 'transformer': 0.028399871089961667, 'bitcoin_forecast': 0.16325048688486193}}, 현재 가격=84801000.0
2024-09-20 14:46:50 - INFO - 현재 잔고: KRW=365465.12628056, BTC=0.00134525, 총 자산가치=479543.67153056
2024-09-20 14:46:50 - INFO - 매도 시도: 0.00013452500000000003 BTC (약 11407.854525000002 KRW)
2024-09-20 14:46:50 - INFO - 주문 결과: {'uuid': 'e75d6627-fd6b-4e3f-a71b-72b82d47ec23', 'side': 'ask', 'ord_type': 'limit', 'price': '84801000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:46:52+09:00', 'volume': '0.00013452', 'remaining_volume': '0.00013452', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00013452', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:46:50 - INFO - sell 주문 성공: UUID=e75d6627-fd6b-4e3f-a71b-72b82d47ec23
2024-09-20 14:46:50 - INFO - Trade executed successfully.
2024-09-20 14:46:50 - INFO - 7. summary 리포트 보내기
2024-09-20 14:46:51 - INFO - Message sent to Discord successfully.
2024-09-20 14:46:51 - INFO - Trading cycle completed.
2024-09-20 14:46:51 - INFO - Performing periodic update.
2024-09-20 14:46:51 - INFO - 계산된 시장 변동성: 0.03018019279538773
2024-09-20 14:55:48 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:55:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816f-8656-f3b884527f86 "HTTP/1.1 200 OK"
2024-09-20 14:55:48 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:55:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:55:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/5b61346c-5a63-4214-9c26-26fac665743e "HTTP/1.1 200 OK"
2024-09-20 14:55:54 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/4c5d8c4b-a96b-4d2a-968f-b3035f8135a8 "HTTP/1.1 200 OK"
2024-09-20 14:56:01 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:07 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:07 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81c1-9da1-e1fc6b26518f "HTTP/1.1 200 OK"
2024-09-20 14:56:07 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:12 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:13 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e3-bbdb-d0aa72ed884d "HTTP/1.1 200 OK"
2024-09-20 14:56:13 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:17 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:19 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f7-85f1-d69e248082bb "HTTP/1.1 200 OK"
2024-09-20 14:56:19 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:27 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:28 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ac-91aa-d6d995af5e5e "HTTP/1.1 200 OK"
2024-09-20 14:56:28 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:36 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8129-903e-fe7c98bbcdfa "HTTP/1.1 200 OK"
2024-09-20 14:56:36 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 14:56:46 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f8-be23-f98cee042769 "HTTP/1.1 200 OK"
2024-09-20 14:56:46 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:45:34.979506
2024-09-20 14:56:46 - INFO - Starting trading cycle.
2024-09-20 14:56:46 - INFO - ##################################################
2024-09-20 14:56:46 - INFO - 11 회 예측 후 모델 재학습 검토
2024-09-20 14:56:46 - INFO - ##################################################
2024-09-20 14:56:46 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 14:56:46 - INFO - 데이터베이스 업데이트 시작
2024-09-20 14:56:46 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:40:00
2024-09-20 14:56:46 - INFO - 새로운 데이터 범위: 2024-09-19 05:40:00 ~ 2024-09-20 14:50:00
2024-09-20 14:56:46 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 14:56:46 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 14:56:46 - INFO - Index: Index([199], dtype='int64')
2024-09-20 14:56:46 - INFO - Date column data type: datetime64[ns]
2024-09-20 14:56:46 - INFO - Sample date values: [Timestamp('2024-09-20 14:50:00')]
2024-09-20 14:56:46 - INFO - Successfully added 1 new data points
2024-09-20 14:56:46 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 14:56:46 - INFO - Final date range: 2024-09-20 14:50:00 to 2024-09-20 14:50:00
2024-09-20 14:56:46 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 14:56:46 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 14:50:00
2024-09-20 14:56:46 - INFO - 데이터베이스 업데이트 완료
2024-09-20 14:56:47 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 14:56:47 - INFO - GPT | 이전예측가격: 84801000 | 당시BTC가격: 84801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:56:47 - INFO - ML 모델 예측 업데이트: 정확도 46.15%, 적중/전체: 6/13
2024-09-20 14:56:47 - INFO - ML | 이전예측가격: 84935680 | 당시BTC가격: 84801000 | 예측: 상승 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0164 | 반영가중치값: 0.0200 | 새 가중치: 0.0364 | 예측 총 횟수: 13 | 예측 성공 수: 6 | 예측 성공률: 46.15%
2024-09-20 14:56:47 - INFO - XGBOOST | 이전예측가격: 84800000 | 당시BTC가격: 84801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:56:47 - INFO - LSTM 모델 예측 업데이트: 정확도 57.58%, 적중/전체: 19/33
2024-09-20 14:56:47 - INFO - LSTM | 이전예측가격: 85084139 | 당시BTC가격: 84801000 | 예측: 상승 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1463 | 반영가중치값: 0.0200 | 새 가중치: 0.1663 | 예측 총 횟수: 33 | 예측 성공 수: 19 | 예측 성공률: 57.58%
2024-09-20 14:56:47 - INFO - RL 모델 예측 업데이트: 정확도 53.85%, 적중/전체: 7/13
2024-09-20 14:56:47 - INFO - RL | 이전예측가격: 85649010 | 당시BTC가격: 84801000 | 예측: 상승 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1461 | 반영가중치값: 0.0200 | 새 가중치: 0.1661 | 예측 총 횟수: 13 | 예측 성공 수: 7 | 예측 성공률: 53.85%
2024-09-20 14:56:47 - INFO - ARIMA 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 7/12
2024-09-20 14:56:47 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84801000 | 예측: 상승 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1439 | 반영가중치값: 0.0200 | 새 가중치: 0.1639 | 예측 총 횟수: 12 | 예측 성공 수: 7 | 예측 성공률: 58.33%
2024-09-20 14:56:47 - INFO - PROPHET | 이전예측가격: 84806652 | 당시BTC가격: 84801000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 14:56:47 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.55%, 적중/전체: 18/33
2024-09-20 14:56:47 - INFO - TRANSFORMER | 이전예측가격: 85124321 | 당시BTC가격: 84801000 | 예측: 상승 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1769 | 반영가중치값: 0.0200 | 새 가중치: 0.1969 | 예측 총 횟수: 33 | 예측 성공 수: 18 | 예측 성공률: 54.55%
2024-09-20 14:56:47 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.16%, 적중/전체: 41/73
2024-09-20 14:56:47 - INFO - BITCOIN_FORECAST | 이전예측가격: 83621887 | 당시BTC가격: 84801000 | 예측: 하락 | 지금 BTC가격: 84866000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1156 | 반영가중치값: -0.0200 | 새 가중치: 0.0956 | 예측 총 횟수: 73 | 예측 성공 수: 41 | 예측 성공률: 56.16%
2024-09-20 14:56:47 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 14:56:47 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 14:56:47 - INFO - 새로운 가중치: {'gpt': 0.0028714009959062183, 'ml': 0.03069855748726801, 'xgboost': 0.0, 'rl': 0.13994550384826507, 'lstm': 0.14006233767179946, 'arima': 0.1380987998613169, 'prophet': 0.3019414836982284, 'transformer': 0.16581388212805173, 'bitcoin_forecast': 0.08056803430916426}
2024-09-20 14:56:47 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 14:56:47 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 14:56:47 - INFO - Current BTC price: 84899000.0
2024-09-20 14:56:47 - INFO - Analyzing market conditions.
2024-09-20 14:56:47 - INFO - Market analysis: {'current_price': 84899000.0, 'sma_20': 84812450.0, 'rsi_14': 55.55616688918989, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 14:56:47 - INFO - Starting predictions for all models
2024-09-20 14:56:47 - INFO - Attempting prediction for gpt
2024-09-20 14:56:47 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 14:56:47 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:56:47 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 14:56:47 - INFO - GPT prediction: 84899000.0
2024-09-20 14:56:47 - INFO - Attempting prediction for ml
2024-09-20 14:56:47 - INFO - ML prediction: 85102757.6
2024-09-20 14:56:47 - INFO - Attempting prediction for xgboost
2024-09-20 14:56:47 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 14:56:47 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:56:47 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 14:56:47 - INFO - XGBOOST prediction: 84899000.0
2024-09-20 14:56:47 - INFO - Attempting prediction for lstm
2024-09-20 14:56:47 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:56:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:56:47 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 14:56:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:56:47 - INFO - X 샘플:
[[ 1.9604601   1.57166673 -0.47122748 -0.70649011  2.09511336  2.10002454
  -0.70649011]
 [-1.00186501 -1.51786036 -0.737243   -0.9699506   1.25994424  1.25427092
  -0.9699506 ]
 [-1.29310484  0.54761    -0.29071696  1.05453528  0.46651084  0.4689863
   1.05453528]
 [ 0.74557396  0.73853583  1.06786228  0.30575283 -0.77748266 -0.77506013
   0.30575283]
 [ 0.32951706  0.47818242  1.13436616  1.04760211 -0.96623636 -0.96500209
   1.04760211]
 [ 0.56250892  0.64307291  1.32437724  1.38732748 -0.99055344 -0.98923721
   1.38732748]
 [ 0.85374875  0.56496689  0.72584233  0.76334211 -0.06611112 -0.06397958
   0.76334211]
 [-0.33617397 -0.55455275  0.1938113  -0.255834   -0.35274265 -0.35385965
  -0.255834  ]
 [-0.89369021 -1.40504055 -1.64929619 -1.65633451  0.34912161  0.34322168
  -1.65633451]
 [-0.92697477 -1.06658112 -1.29777569 -0.9699506  -1.01756381 -1.01936478
  -0.9699506 ]]
2024-09-20 14:56:47 - INFO - y 샘플:
[-0.9699506]
2024-09-20 14:56:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 14:56:47 - INFO - 모델 출력 (스케일링된 예측): [[0.01841766]]
2024-09-20 14:56:47 - INFO - 스케일러 역변환 후 예측 가격: 85041556.4550173
2024-09-20 14:56:47 - INFO - LSTMPredictor 최종 예측 가격: 85041556.4550173
2024-09-20 14:56:47 - INFO - LSTM prediction: 85041556.4550173
2024-09-20 14:56:47 - INFO - Attempting prediction for rl
2024-09-20 14:56:47 - INFO - Preparing state for RL agent.
2024-09-20 14:56:47 - INFO - Prepared state: [[8.48990000e+07 1.55814020e+01 1.16745283e-03 8.48124500e+07
  5.55561669e+01]]
2024-09-20 14:56:47 - INFO - RL prediction: 85747990.0
2024-09-20 14:56:47 - INFO - Attempting prediction for arima
2024-09-20 14:56:47 - INFO - ARIMA 예측 시작
2024-09-20 14:56:47 - INFO - 입력 데이터: {'open': 84999000.0, 'high': 85042000.0, 'low': 84834000.0, 'close': 84899000.0, 'volume': 15.58140203, 'value': 1323846978.4059, 'decision': 'sell', 'sma': 84812450.0, 'ema': 84802360.11357032, 'rsi': 55.55616688918989, 'macd': 231784.6936057955, 'signal_line': 264437.5719846591, 'BB_Upper': 85581232.27737223, 'BB_Lower': 84043667.72262777}
2024-09-20 14:56:47 - INFO - Exogenous 변수 예측 시작
2024-09-20 14:56:47 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84812450.0         0         0
2024-09-20 14:56:47 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84812450.0         0         0
2024-09-20 14:56:47 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 14:56:47 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 14:56:47 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 14:56:47 - INFO - ARIMA prediction: 84893000.0
2024-09-20 14:56:47 - INFO - Attempting prediction for prophet
2024-09-20 14:56:47 - INFO - PROPHET prediction: 84909276.27267249
2024-09-20 14:56:47 - INFO - Attempting prediction for transformer
2024-09-20 14:56:47 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 14:56:47 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 14:56:47 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 14:56:47 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 14:56:47 - INFO - X dtype: float64, y dtype: float64
2024-09-20 14:56:47 - INFO - X 샘플:
[[ 1.9604601   1.57166673 -0.47122748 -0.70649011  2.09511336  2.10002454
  -0.70649011 -0.70649011  0.          0.          0.         -0.70649011
  -0.70649011]
 [-1.00186501 -1.51786036 -0.737243   -0.9699506   1.25994424  1.25427092
  -0.9699506  -0.9699506   0.          0.          0.         -0.9699506
  -0.9699506 ]
 [-1.29310484  0.54761    -0.29071696  1.05453528  0.46651084  0.4689863
   1.05453528  1.05453528  0.          0.          0.          1.05453528
   1.05453528]
 [ 0.74557396  0.73853583  1.06786228  0.30575283 -0.77748266 -0.77506013
   0.30575283  0.30575283  0.          0.          0.          0.30575283
   0.30575283]
 [ 0.32951706  0.47818242  1.13436616  1.04760211 -0.96623636 -0.96500209
   1.04760211  1.04760211  0.          0.          0.          1.04760211
   1.04760211]
 [ 0.56250892  0.64307291  1.32437724  1.38732748 -0.99055344 -0.98923721
   1.38732748  1.38732748  0.          0.          0.          1.38732748
   1.38732748]
 [ 0.85374875  0.56496689  0.72584233  0.76334211 -0.06611112 -0.06397958
   0.76334211  0.76334211  0.          0.          0.          0.76334211
   0.76334211]
 [-0.33617397 -0.55455275  0.1938113  -0.255834   -0.35274265 -0.35385965
  -0.255834   -0.255834    0.          0.          0.         -0.255834
  -0.255834  ]
 [-0.89369021 -1.40504055 -1.64929619 -1.65633451  0.34912161  0.34322168
  -1.65633451 -1.65633451  0.          0.          0.         -1.65633451
  -1.65633451]
 [-0.92697477 -1.06658112 -1.29777569 -0.9699506  -1.01756381 -1.01936478
  -0.9699506  -0.9699506   0.          0.          0.         -0.9699506
  -0.9699506 ]]
2024-09-20 14:56:47 - INFO - y 샘플:
[-0.9699506]
2024-09-20 14:56:47 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 14:56:47 - INFO - 모델 출력 (스케일링된 예측): [0.29996336]
2024-09-20 14:56:47 - INFO - 스케일러 역변환 후 예측 가격: 85082164.95952159
2024-09-20 14:56:47 - INFO - TransformerPredictor 최종 예측 가격: 85082164.95952159
2024-09-20 14:56:47 - INFO - TRANSFORMER prediction: 85082164.95952159
2024-09-20 14:56:47 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 14:56:47 - INFO - BITCOIN_FORECAST prediction: 83415582.26368175
2024-09-20 14:56:47 - INFO - BitcoinForecast prediction: 83415582.26368175
2024-09-20 14:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 14:56:52 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 14:56:52 - INFO - 조정된 모델 가중치: {'gpt': 0.0028714009959062183, 'ml': 0.03069855748726801, 'xgboost': 0.0, 'rl': 0.13994550384826507, 'lstm': 0.14006233767179946, 'arima': 0.1380987998613169, 'prophet': 0.3019414836982284, 'transformer': 0.16581388212805173, 'bitcoin_forecast': 0.08056803430916426}
2024-09-20 14:56:52 - INFO - 조정된 모델 가중치: {'gpt': 0.0028714009959062183, 'ml': 0.03069855748726801, 'xgboost': 0.0, 'rl': 0.13994550384826507, 'lstm': 0.14006233767179946, 'arima': 0.1380987998613169, 'prophet': 0.3019414836982284, 'transformer': 0.16581388212805173, 'bitcoin_forecast': 0.08056803430916426}
2024-09-20 14:56:52 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84957163.67020118, 'current_price': 84899000.0, 'predictions': {'gpt': 84899000.0, 'ml': 85102757.6, 'xgboost': 84899000.0, 'lstm': 85041556.4550173, 'rl': 85747990.0, 'arima': 84893000.0, 'prophet': 84909276.27267249, 'transformer': 85082164.95952159, 'bitcoin_forecast': 83415582.26368175}, 'weights': {'gpt': 0.0028714009959062183, 'ml': 0.03069855748726801, 'xgboost': 0.0, 'rl': 0.13994550384826507, 'lstm': 0.14006233767179946, 'arima': 0.1380987998613169, 'prophet': 0.3019414836982284, 'transformer': 0.16581388212805173, 'bitcoin_forecast': 0.08056803430916426}}
2024-09-20 14:56:52 - INFO - 모델별 가중치:
2024-09-20 14:56:52 - INFO -   - GPT: 0.0029
2024-09-20 14:56:52 - INFO -   - ML: 0.0307
2024-09-20 14:56:52 - INFO -   - XGBOOST: 0.0000
2024-09-20 14:56:52 - INFO -   - RL: 0.1399
2024-09-20 14:56:52 - INFO -   - LSTM: 0.1401
2024-09-20 14:56:52 - INFO -   - ARIMA: 0.1381
2024-09-20 14:56:52 - INFO -   - PROPHET: 0.3019
2024-09-20 14:56:52 - INFO -   - TRANSFORMER: 0.1658
2024-09-20 14:56:52 - INFO -   - BITCOIN_FORECAST: 0.0806
2024-09-20 14:56:52 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 14:56:52 - INFO - 6. 거래 실행
2024-09-20 14:56:52 - INFO - Cancelling existing orders.
2024-09-20 14:56:52 - INFO - Cancelled 0 orders.
2024-09-20 14:56:52 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84957163.67020118, 'current_price': 84899000.0, 'predictions': {'gpt': 84899000.0, 'ml': 85102757.6, 'xgboost': 84899000.0, 'lstm': 85041556.4550173, 'rl': 85747990.0, 'arima': 84893000.0, 'prophet': 84909276.27267249, 'transformer': 85082164.95952159, 'bitcoin_forecast': 83415582.26368175}, 'weights': {'gpt': 0.0028714009959062183, 'ml': 0.03069855748726801, 'xgboost': 0.0, 'rl': 0.13994550384826507, 'lstm': 0.14006233767179946, 'arima': 0.1380987998613169, 'prophet': 0.3019414836982284, 'transformer': 0.16581388212805173, 'bitcoin_forecast': 0.08056803430916426}}, 현재 가격=84899000.0
2024-09-20 14:56:52 - INFO - 현재 잔고: KRW=376866.8530853, BTC=0.00121073, 총 자산가치=479656.6193553
2024-09-20 14:56:52 - INFO - 매수 시도: 0.0005649732262515459 BTC (약 47965.66193552999 KRW)
2024-09-20 14:56:52 - INFO - 주문 결과: {'uuid': '670041a4-e684-41c0-a9c3-16a22b14b5e4', 'side': 'bid', 'ord_type': 'limit', 'price': '84899000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T14:56:54+09:00', 'volume': '0.00056497', 'remaining_volume': '0.00056497', 'reserved_fee': '23.982694015', 'remaining_fee': '23.982694015', 'paid_fee': '0', 'locked': '47989.370724015', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 14:56:52 - INFO - buy 주문 성공: UUID=670041a4-e684-41c0-a9c3-16a22b14b5e4
2024-09-20 14:56:52 - INFO - Trade executed successfully.
2024-09-20 14:56:52 - INFO - 7. summary 리포트 보내기
2024-09-20 14:56:53 - INFO - Message sent to Discord successfully.
2024-09-20 14:56:53 - INFO - Trading cycle completed.
2024-09-20 14:56:53 - INFO - Performing periodic update.
2024-09-20 14:56:53 - INFO - 계산된 시장 변동성: 0.030227935620258606
2024-09-20 15:05:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:05:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a9-b110-eb25e9ce2cf0 "HTTP/1.1 200 OK"
2024-09-20 15:05:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:05:46 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:05:47 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815f-8fc7-c6e46ae56f8d "HTTP/1.1 200 OK"
2024-09-20 15:05:47 - INFO - Updated actual price for ml prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:05:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:05:53 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8195-8bea-ea37ea1ed750 "HTTP/1.1 200 OK"
2024-09-20 15:05:53 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:00 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:01 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b3-97b8-c82dcaca930f "HTTP/1.1 200 OK"
2024-09-20 15:06:01 - INFO - Updated actual price for lstm prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:06 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:09 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-818e-9a4b-f38276f4ee5a "HTTP/1.1 200 OK"
2024-09-20 15:06:09 - INFO - Updated actual price for rl prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:16 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81b2-ab4f-e8318d8156bc "HTTP/1.1 200 OK"
2024-09-20 15:06:16 - INFO - Updated actual price for arima prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:23 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814e-8e65-f909a423a43d "HTTP/1.1 200 OK"
2024-09-20 15:06:24 - INFO - Updated actual price for prophet prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:28 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:29 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81a7-ae0d-c11fc353bcbd "HTTP/1.1 200 OK"
2024-09-20 15:06:29 - INFO - Updated actual price for transformer prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:34 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:06:34 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/dae49c6f-2f9e-4e6b-8fc9-496627ba1949 "HTTP/1.1 200 OK"
2024-09-20 15:06:34 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 14:55:34.979658
2024-09-20 15:06:34 - INFO - Starting trading cycle.
2024-09-20 15:06:34 - INFO - ##################################################
2024-09-20 15:06:34 - INFO - 12 회 예측 후 모델 재학습 검토
2024-09-20 15:06:34 - INFO - ##################################################
2024-09-20 15:06:34 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 15:06:34 - INFO - 데이터베이스 업데이트 시작
2024-09-20 15:06:34 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 14:50:00
2024-09-20 15:06:34 - INFO - 새로운 데이터 범위: 2024-09-19 05:50:00 ~ 2024-09-20 15:00:00
2024-09-20 15:06:34 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 15:06:34 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 15:06:34 - INFO - Index: Index([199], dtype='int64')
2024-09-20 15:06:34 - INFO - Date column data type: datetime64[ns]
2024-09-20 15:06:34 - INFO - Sample date values: [Timestamp('2024-09-20 15:00:00')]
2024-09-20 15:06:34 - INFO - Successfully added 1 new data points
2024-09-20 15:06:34 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 15:06:34 - INFO - Final date range: 2024-09-20 15:00:00 to 2024-09-20 15:00:00
2024-09-20 15:06:34 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 15:06:34 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 15:00:00
2024-09-20 15:06:34 - INFO - 데이터베이스 업데이트 완료
2024-09-20 15:06:35 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 15:06:35 - INFO - GPT | 이전예측가격: 84899000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:06:35 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 7/14
2024-09-20 15:06:35 - INFO - ML | 이전예측가격: 85102758 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1197 | 반영가중치값: 0.0200 | 새 가중치: 0.1397 | 예측 총 횟수: 14 | 예측 성공 수: 7 | 예측 성공률: 50.00%
2024-09-20 15:06:35 - INFO - XGBOOST | 이전예측가격: 84899000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:06:35 - INFO - LSTM 모델 예측 업데이트: 정확도 58.82%, 적중/전체: 20/34
2024-09-20 15:06:35 - INFO - LSTM | 이전예측가격: 85041556 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0703 | 반영가중치값: 0.0200 | 새 가중치: 0.0903 | 예측 총 횟수: 34 | 예측 성공 수: 20 | 예측 성공률: 58.82%
2024-09-20 15:06:35 - INFO - RL 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 8/14
2024-09-20 15:06:35 - INFO - RL | 이전예측가격: 85747990 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1197 | 반영가중치값: 0.0200 | 새 가중치: 0.1397 | 예측 총 횟수: 14 | 예측 성공 수: 8 | 예측 성공률: 57.14%
2024-09-20 15:06:35 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84899000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:06:35 - INFO - PROPHET 모델 예측 업데이트: 정확도 59.02%, 적중/전체: 72/122
2024-09-20 15:06:35 - INFO - PROPHET | 이전예측가격: 84909276 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.3585 | 반영가중치값: 0.0200 | 새 가중치: 0.3785 | 예측 총 횟수: 122 | 예측 성공 수: 72 | 예측 성공률: 59.02%
2024-09-20 15:06:35 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.88%, 적중/전체: 19/34
2024-09-20 15:06:35 - INFO - TRANSFORMER | 이전예측가격: 85082165 | 당시BTC가격: 84899000 | 예측: 상승 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0284 | 반영가중치값: 0.0200 | 새 가중치: 0.0484 | 예측 총 횟수: 34 | 예측 성공 수: 19 | 예측 성공률: 55.88%
2024-09-20 15:06:35 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.41%, 적중/전체: 41/74
2024-09-20 15:06:35 - INFO - BITCOIN_FORECAST | 이전예측가격: 83415582 | 당시BTC가격: 84899000 | 예측: 하락 | 지금 BTC가격: 84956000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1633 | 반영가중치값: -0.0200 | 새 가중치: 0.1433 | 예측 총 횟수: 74 | 예측 성공 수: 41 | 예측 성공률: 55.41%
2024-09-20 15:06:35 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 15:06:35 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 15:06:35 - INFO - 새로운 가중치: {'gpt': 0.002656709044807395, 'ml': 0.12929236215224355, 'xgboost': 0.0, 'rl': 0.12929236215224355, 'lstm': 0.08350315307272368, 'arima': 0.12777328251668185, 'prophet': 0.35016129005086577, 'transformer': 0.04478105826233849, 'bitcoin_forecast': 0.13253978274809572}
2024-09-20 15:06:35 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 15:06:35 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 15:06:35 - INFO - Current BTC price: 84956000.0
2024-09-20 15:06:35 - INFO - Analyzing market conditions.
2024-09-20 15:06:35 - INFO - Market analysis: {'current_price': 84956000.0, 'sma_20': 84862550.0, 'rsi_14': 56.89078331465747, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 15:06:35 - INFO - Starting predictions for all models
2024-09-20 15:06:35 - INFO - Attempting prediction for gpt
2024-09-20 15:06:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 15:06:35 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:06:35 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:06:35 - INFO - GPT prediction: 84956000.0
2024-09-20 15:06:35 - INFO - Attempting prediction for ml
2024-09-20 15:06:35 - INFO - ML prediction: 85210867.99999999
2024-09-20 15:06:35 - INFO - Attempting prediction for xgboost
2024-09-20 15:06:35 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 15:06:35 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:06:35 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:06:35 - INFO - XGBOOST prediction: 84956000.0
2024-09-20 15:06:35 - INFO - Attempting prediction for lstm
2024-09-20 15:06:35 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:06:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:06:35 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 15:06:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:06:35 - INFO - X 샘플:
[[-0.86927512 -1.45909206 -0.75829082 -0.99161421  2.07891452  2.07652379
  -0.99161421]
 [-1.23277129  0.90164153 -0.30886246  1.05035581  0.97055674  0.97708358
   1.05035581]
 [ 1.31170188  1.1198606   1.0585472   0.29510663 -0.76719452 -0.76464757
   0.29510663]
 [ 0.79242164  0.82228914  1.12548334  1.04336277 -1.03086709 -1.03057641
   1.04336277]
 [ 1.08321858  1.01075106  1.31672945  1.38602212 -1.06483595 -1.06450688
   1.38602212]
 [ 1.44671474  0.92147962  0.71430421  0.7566478   0.22652996  0.23090301
   0.7566478 ]
 [-0.03842674 -0.35807766  0.17881511 -0.27133026 -0.17386949 -0.17494451
  -0.27133026]
 [-0.73426226 -1.33014443 -1.67627213 -1.68392597  0.80657414  0.80100643
  -1.68392597]
 [-0.77580468 -0.94330153 -1.32246683 -0.99161421 -1.1025671  -1.10668708
  -0.99161421]
 [-0.98351677 -0.68540626 -0.32798707 -0.59301047  0.0567588   0.05584564
  -0.59301047]]
2024-09-20 15:06:35 - INFO - y 샘플:
[-0.59301047]
2024-09-20 15:06:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 15:06:35 - INFO - 모델 출력 (스케일링된 예측): [[0.03219015]]
2024-09-20 15:06:35 - INFO - 스케일러 역변환 후 예측 가격: 85045403.1641208
2024-09-20 15:06:35 - INFO - LSTMPredictor 최종 예측 가격: 85045403.1641208
2024-09-20 15:06:35 - INFO - LSTM prediction: 85045403.1641208
2024-09-20 15:06:35 - INFO - Attempting prediction for rl
2024-09-20 15:06:35 - INFO - Preparing state for RL agent.
2024-09-20 15:06:35 - INFO - Prepared state: [[8.49560000e+07 2.50049676e+01 6.71386000e-04 8.48625500e+07
  5.68907833e+01]]
2024-09-20 15:06:35 - INFO - RL prediction: 85805560.0
2024-09-20 15:06:35 - INFO - Attempting prediction for arima
2024-09-20 15:06:35 - INFO - ARIMA 예측 시작
2024-09-20 15:06:35 - INFO - 입력 데이터: {'open': 84979000.0, 'high': 85068000.0, 'low': 84938000.0, 'close': 84956000.0, 'volume': 25.00496763, 'value': 2125718203.99789, 'decision': 'sell', 'sma': 84862550.0, 'ema': 84816992.48370647, 'rsi': 56.89078331465747, 'macd': 215890.42026634514, 'signal_line': 254728.14164099636, 'BB_Upper': 85524154.25482431, 'BB_Lower': 84200945.74517569}
2024-09-20 15:06:35 - INFO - Exogenous 변수 예측 시작
2024-09-20 15:06:35 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84862550.0         0         0
2024-09-20 15:06:35 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84862550.0         0         0
2024-09-20 15:06:35 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 15:06:35 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 15:06:35 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 15:06:35 - INFO - ARIMA prediction: 84893000.0
2024-09-20 15:06:35 - INFO - Attempting prediction for prophet
2024-09-20 15:06:35 - INFO - PROPHET prediction: 84978438.54108724
2024-09-20 15:06:35 - INFO - Attempting prediction for transformer
2024-09-20 15:06:35 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:06:35 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:06:35 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:06:35 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 15:06:35 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:06:35 - INFO - X 샘플:
[[-0.86927512 -1.45909206 -0.75829082 -0.99161421  2.07891452  2.07652379
  -0.99161421 -0.99161421  0.          0.          0.         -0.99161421
  -0.99161421]
 [-1.23277129  0.90164153 -0.30886246  1.05035581  0.97055674  0.97708358
   1.05035581  1.05035581  0.          0.          0.          1.05035581
   1.05035581]
 [ 1.31170188  1.1198606   1.0585472   0.29510663 -0.76719452 -0.76464757
   0.29510663  0.29510663  0.          0.          0.          0.29510663
   0.29510663]
 [ 0.79242164  0.82228914  1.12548334  1.04336277 -1.03086709 -1.03057641
   1.04336277  1.04336277  0.          0.          0.          1.04336277
   1.04336277]
 [ 1.08321858  1.01075106  1.31672945  1.38602212 -1.06483595 -1.06450688
   1.38602212  1.38602212  0.          0.          0.          1.38602212
   1.38602212]
 [ 1.44671474  0.92147962  0.71430421  0.7566478   0.22652996  0.23090301
   0.7566478   0.7566478   0.          0.          0.          0.7566478
   0.7566478 ]
 [-0.03842674 -0.35807766  0.17881511 -0.27133026 -0.17386949 -0.17494451
  -0.27133026 -0.27133026  0.          0.          0.         -0.27133026
  -0.27133026]
 [-0.73426226 -1.33014443 -1.67627213 -1.68392597  0.80657414  0.80100643
  -1.68392597 -1.68392597  0.          0.          0.         -1.68392597
  -1.68392597]
 [-0.77580468 -0.94330153 -1.32246683 -0.99161421 -1.1025671  -1.10668708
  -0.99161421 -0.99161421  0.          0.          0.         -0.99161421
  -0.99161421]
 [-0.98351677 -0.68540626 -0.32798707 -0.59301047  0.0567588   0.05584564
  -0.59301047 -0.59301047  0.          0.          0.         -0.59301047
  -0.59301047]]
2024-09-20 15:06:35 - INFO - y 샘플:
[-0.59301047]
2024-09-20 15:06:35 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 15:06:35 - INFO - 모델 출력 (스케일링된 예측): [0.29820704]
2024-09-20 15:06:35 - INFO - 스케일러 역변환 후 예측 가격: 85083443.3571336
2024-09-20 15:06:35 - INFO - TransformerPredictor 최종 예측 가격: 85083443.3571336
2024-09-20 15:06:35 - INFO - TRANSFORMER prediction: 85083443.3571336
2024-09-20 15:06:35 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 15:06:35 - INFO - BITCOIN_FORECAST prediction: 83535605.64474685
2024-09-20 15:06:35 - INFO - BitcoinForecast prediction: 83535605.64474685
2024-09-20 15:06:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:40 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:41 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:42 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:43 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:44 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:06:44 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 15:06:44 - INFO - 조정된 모델 가중치: {'gpt': 0.002656709044807395, 'ml': 0.12929236215224355, 'xgboost': 0.0, 'rl': 0.12929236215224355, 'lstm': 0.08350315307272368, 'arima': 0.12777328251668185, 'prophet': 0.35016129005086577, 'transformer': 0.04478105826233849, 'bitcoin_forecast': 0.13253978274809572}
2024-09-20 15:06:44 - INFO - 조정된 모델 가중치: {'gpt': 0.002656709044807395, 'ml': 0.12929236215224355, 'xgboost': 0.0, 'rl': 0.12929236215224355, 'lstm': 0.08350315307272368, 'arima': 0.12777328251668185, 'prophet': 0.35016129005086577, 'transformer': 0.04478105826233849, 'bitcoin_forecast': 0.13253978274809572}
2024-09-20 15:06:44 - INFO - Decision: {'decision': 'sell', 'percentage': 10.0, 'target_price': 84923515.23188034, 'current_price': 84956000.0, 'predictions': {'gpt': 84956000.0, 'ml': 85210867.99999999, 'xgboost': 84956000.0, 'lstm': 85045403.1641208, 'rl': 85805560.0, 'arima': 84893000.0, 'prophet': 84978438.54108724, 'transformer': 85083443.3571336, 'bitcoin_forecast': 83535605.64474685}, 'weights': {'gpt': 0.002656709044807395, 'ml': 0.12929236215224355, 'xgboost': 0.0, 'rl': 0.12929236215224355, 'lstm': 0.08350315307272368, 'arima': 0.12777328251668185, 'prophet': 0.35016129005086577, 'transformer': 0.04478105826233849, 'bitcoin_forecast': 0.13253978274809572}}
2024-09-20 15:06:44 - INFO - 모델별 가중치:
2024-09-20 15:06:44 - INFO -   - GPT: 0.0027
2024-09-20 15:06:44 - INFO -   - ML: 0.1293
2024-09-20 15:06:44 - INFO -   - XGBOOST: 0.0000
2024-09-20 15:06:44 - INFO -   - RL: 0.1293
2024-09-20 15:06:44 - INFO -   - LSTM: 0.0835
2024-09-20 15:06:44 - INFO -   - ARIMA: 0.1278
2024-09-20 15:06:44 - INFO -   - PROPHET: 0.3502
2024-09-20 15:06:44 - INFO -   - TRANSFORMER: 0.0448
2024-09-20 15:06:44 - INFO -   - BITCOIN_FORECAST: 0.1325
2024-09-20 15:06:44 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 15:06:44 - INFO - 6. 거래 실행
2024-09-20 15:06:44 - INFO - Cancelling existing orders.
2024-09-20 15:06:44 - INFO - Cancelled 0 orders.
2024-09-20 15:06:44 - INFO - 거래 실행 시작: 결정={'decision': 'sell', 'percentage': 10.0, 'target_price': 84923515.23188034, 'current_price': 84956000.0, 'predictions': {'gpt': 84956000.0, 'ml': 85210867.99999999, 'xgboost': 84956000.0, 'lstm': 85045403.1641208, 'rl': 85805560.0, 'arima': 84893000.0, 'prophet': 84978438.54108724, 'transformer': 85083443.3571336, 'bitcoin_forecast': 83535605.64474685}, 'weights': {'gpt': 0.002656709044807395, 'ml': 0.12929236215224355, 'xgboost': 0.0, 'rl': 0.12929236215224355, 'lstm': 0.08350315307272368, 'arima': 0.12777328251668185, 'prophet': 0.35016129005086577, 'transformer': 0.04478105826233849, 'bitcoin_forecast': 0.13253978274809572}}, 현재 가격=84956000.0
2024-09-20 15:06:44 - INFO - 현재 잔고: KRW=328896.13569329, BTC=0.0017757, 총 자산가치=479752.50489329
2024-09-20 15:06:44 - INFO - 매도 시도: 0.00017757000000000002 BTC (약 15085.636920000003 KRW)
2024-09-20 15:06:44 - INFO - 주문 결과: {'uuid': '10c981a9-1220-4423-baca-b438707e8bc1', 'side': 'ask', 'ord_type': 'limit', 'price': '84956000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T15:06:46+09:00', 'volume': '0.00017757', 'remaining_volume': '0.00017757', 'reserved_fee': '0', 'remaining_fee': '0', 'paid_fee': '0', 'locked': '0.00017757', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 15:06:44 - INFO - sell 주문 성공: UUID=10c981a9-1220-4423-baca-b438707e8bc1
2024-09-20 15:06:44 - INFO - Trade executed successfully.
2024-09-20 15:06:44 - INFO - 7. summary 리포트 보내기
2024-09-20 15:06:44 - INFO - Message sent to Discord successfully.
2024-09-20 15:06:44 - INFO - Trading cycle completed.
2024-09-20 15:06:44 - INFO - Performing periodic update.
2024-09-20 15:06:44 - INFO - 계산된 시장 변동성: 0.030157727612179018
2024-09-20 15:15:40 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:15:42 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-815a-b602-ebcf973f827d "HTTP/1.1 200 OK"
2024-09-20 15:15:42 - INFO - Updated actual price for gpt prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:15:56 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:15:57 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813a-b1cd-ee62e1e67f50 "HTTP/1.1 200 OK"
2024-09-20 15:15:57 - INFO - Updated actual price for ml prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:03 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:03 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8132-850f-e284c06b8a88 "HTTP/1.1 200 OK"
2024-09-20 15:16:03 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:12 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-814b-a004-ca4e44f0b29f "HTTP/1.1 200 OK"
2024-09-20 15:16:12 - INFO - Updated actual price for lstm prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:16 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:18 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/18505d21-fba3-49ec-b880-88601550e006 "HTTP/1.1 200 OK"
2024-09-20 15:16:18 - INFO - Updated actual price for rl prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:24 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:24 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-813a-9d35-e55977463a6c "HTTP/1.1 200 OK"
2024-09-20 15:16:24 - INFO - Updated actual price for arima prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:30 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:31 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-817f-9465-efba3a03665e "HTTP/1.1 200 OK"
2024-09-20 15:16:31 - INFO - Updated actual price for prophet prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:37 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:37 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-816d-bb13-e3a613986204 "HTTP/1.1 200 OK"
2024-09-20 15:16:37 - INFO - Updated actual price for transformer prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:44 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:16:45 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/a7687f30-8938-438a-b6dc-100a7486b1ca "HTTP/1.1 200 OK"
2024-09-20 15:16:45 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 15:05:34.979975
2024-09-20 15:16:45 - INFO - Starting trading cycle.
2024-09-20 15:16:45 - INFO - ##################################################
2024-09-20 15:16:45 - INFO - 13 회 예측 후 모델 재학습 검토
2024-09-20 15:16:45 - INFO - ##################################################
2024-09-20 15:16:45 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 15:16:45 - INFO - 데이터베이스 업데이트 시작
2024-09-20 15:16:45 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 15:00:00
2024-09-20 15:16:45 - INFO - 새로운 데이터 범위: 2024-09-19 06:00:00 ~ 2024-09-20 15:10:00
2024-09-20 15:16:45 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 15:16:45 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 15:16:45 - INFO - Index: Index([199], dtype='int64')
2024-09-20 15:16:45 - INFO - Date column data type: datetime64[ns]
2024-09-20 15:16:45 - INFO - Sample date values: [Timestamp('2024-09-20 15:10:00')]
2024-09-20 15:16:45 - INFO - Successfully added 1 new data points
2024-09-20 15:16:45 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 15:16:45 - INFO - Final date range: 2024-09-20 15:10:00 to 2024-09-20 15:10:00
2024-09-20 15:16:45 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 15:16:45 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 15:10:00
2024-09-20 15:16:45 - INFO - 데이터베이스 업데이트 완료
2024-09-20 15:16:46 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 15:16:46 - INFO - GPT | 이전예측가격: 84956000 | 당시BTC가격: 84956000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:16:46 - INFO - ML 모델 예측 업데이트: 정확도 46.67%, 적중/전체: 7/15
2024-09-20 15:16:46 - INFO - ML | 이전예측가격: 85210868 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.0307 | 반영가중치값: -0.0200 | 새 가중치: 0.0107 | 예측 총 횟수: 15 | 예측 성공 수: 7 | 예측 성공률: 46.67%
2024-09-20 15:16:46 - INFO - XGBOOST | 이전예측가격: 84956000 | 당시BTC가격: 84956000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:16:46 - INFO - LSTM 모델 예측 업데이트: 정확도 57.14%, 적중/전체: 20/35
2024-09-20 15:16:46 - INFO - LSTM | 이전예측가격: 85045403 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1401 | 반영가중치값: -0.0200 | 새 가중치: 0.1201 | 예측 총 횟수: 35 | 예측 성공 수: 20 | 예측 성공률: 57.14%
2024-09-20 15:16:46 - INFO - RL 모델 예측 업데이트: 정확도 53.33%, 적중/전체: 8/15
2024-09-20 15:16:46 - INFO - RL | 이전예측가격: 85805560 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1399 | 반영가중치값: -0.0200 | 새 가중치: 0.1199 | 예측 총 횟수: 15 | 예측 성공 수: 8 | 예측 성공률: 53.33%
2024-09-20 15:16:46 - INFO - ARIMA 모델 예측 업데이트: 정확도 61.54%, 적중/전체: 8/13
2024-09-20 15:16:46 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84956000 | 예측: 하락 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.1381 | 반영가중치값: 0.0200 | 새 가중치: 0.1581 | 예측 총 횟수: 13 | 예측 성공 수: 8 | 예측 성공률: 61.54%
2024-09-20 15:16:46 - INFO - PROPHET 모델 예측 업데이트: 정확도 58.54%, 적중/전체: 72/123
2024-09-20 15:16:46 - INFO - PROPHET | 이전예측가격: 84978439 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.3019 | 반영가중치값: -0.0200 | 새 가중치: 0.2819 | 예측 총 횟수: 123 | 예측 성공 수: 72 | 예측 성공률: 58.54%
2024-09-20 15:16:46 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 54.29%, 적중/전체: 19/35
2024-09-20 15:16:46 - INFO - TRANSFORMER | 이전예측가격: 85083443 | 당시BTC가격: 84956000 | 예측: 상승 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 실패 | 전 가중치: 0.1658 | 반영가중치값: -0.0200 | 새 가중치: 0.1458 | 예측 총 횟수: 35 | 예측 성공 수: 19 | 예측 성공률: 54.29%
2024-09-20 15:16:46 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 56.00%, 적중/전체: 42/75
2024-09-20 15:16:46 - INFO - BITCOIN_FORECAST | 이전예측가격: 83535606 | 당시BTC가격: 84956000 | 예측: 하락 | 지금 BTC가격: 84830000 | 실결과: 하락 | 예측 결과: 성공 | 전 가중치: 0.0806 | 반영가중치값: 0.0200 | 새 가중치: 0.1006 | 예측 총 횟수: 75 | 예측 성공 수: 42 | 예측 성공률: 56.00%
2024-09-20 15:16:46 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 15:16:46 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 15:16:46 - INFO - 새로운 가중치: {'gpt': 0.00282693187694434, 'ml': 0.011384044202052279, 'xgboost': 0.0, 'rl': 0.12763075015216538, 'lstm': 0.1277550698478807, 'arima': 0.16822863531410975, 'prophet': 0.3000062687546906, 'transformer': 0.15515658829650952, 'bitcoin_forecast': 0.10701171155564741}
2024-09-20 15:16:46 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 15:16:46 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 15:16:46 - INFO - Current BTC price: 84830000.0
2024-09-20 15:16:46 - INFO - Analyzing market conditions.
2024-09-20 15:16:46 - INFO - Market analysis: {'current_price': 84830000.0, 'sma_20': 84899600.0, 'rsi_14': 53.095183177456406, 'trend': 'Bearish', 'overbought_oversold': 'Neutral'}
2024-09-20 15:16:46 - INFO - Starting predictions for all models
2024-09-20 15:16:46 - INFO - Attempting prediction for gpt
2024-09-20 15:16:46 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 15:16:46 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:16:46 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:16:46 - INFO - GPT prediction: 84830000.0
2024-09-20 15:16:46 - INFO - Attempting prediction for ml
2024-09-20 15:16:46 - INFO - ML prediction: 85016626.0
2024-09-20 15:16:46 - INFO - Attempting prediction for xgboost
2024-09-20 15:16:46 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 15:16:46 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:16:46 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:16:46 - INFO - XGBOOST prediction: 84830000.0
2024-09-20 15:16:46 - INFO - Attempting prediction for lstm
2024-09-20 15:16:46 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:16:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:16:46 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 15:16:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:16:46 - INFO - X 샘플:
[[-1.2539147   0.904503   -0.22640231  1.03964323  1.69122831  1.69753733
   1.03964323]
 [ 1.31257737  1.12584968  1.05326293  0.32492987 -0.61381062 -0.60910607
   0.32492987]
 [ 0.78880348  0.8240133   1.11590389  1.03302552 -0.96355892 -0.96128615
   1.03302552]
 [ 1.08211686  1.01517634  1.29487805  1.35729362 -1.00861688 -1.0062216
   1.35729362]
 [ 1.44875858  0.92462543  0.73110944  0.76169915  0.70431451  0.70934091
   0.76169915]
 [-0.04923475 -0.37327098  0.2299818  -0.21110515  0.17320495  0.171861
  -0.21110515]
 [-0.75109176 -1.35926981 -1.50606755 -1.54788384  1.47371371  1.4643514
  -1.54788384]
 [-0.79299367 -0.96688252 -1.17496536 -0.89272993 -1.05866535 -1.0620825
  -0.89272993]
 [-1.00250323 -0.705291   -0.24429973 -0.5155201   0.47912167  0.47750552
  -0.5155201 ]
 [-0.78251819 -1.38945345 -1.27340115 -1.34935236 -0.87693139 -0.88189985
  -1.34935236]]
2024-09-20 15:16:46 - INFO - y 샘플:
[-1.34935236]
2024-09-20 15:16:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 15:16:46 - INFO - 모델 출력 (스케일링된 예측): [[-0.01933327]]
2024-09-20 15:16:46 - INFO - 스케일러 역변환 후 예측 가격: 85030978.5581812
2024-09-20 15:16:46 - INFO - LSTMPredictor 최종 예측 가격: 85030978.5581812
2024-09-20 15:16:46 - INFO - LSTM prediction: 85030978.5581812
2024-09-20 15:16:46 - INFO - Attempting prediction for rl
2024-09-20 15:16:46 - INFO - Preparing state for RL agent.
2024-09-20 15:16:46 - INFO - Prepared state: [[ 8.48300000e+07  1.66950685e+01 -1.48312067e-03  8.48996000e+07
   5.30951832e+01]]
2024-09-20 15:16:46 - INFO - RL prediction: 85678300.0
2024-09-20 15:16:46 - INFO - Attempting prediction for arima
2024-09-20 15:16:46 - INFO - ARIMA 예측 시작
2024-09-20 15:16:46 - INFO - 입력 데이터: {'open': 85000000.0, 'high': 85000000.0, 'low': 84823000.0, 'close': 84830000.0, 'volume': 16.69506853, 'value': 1417692401.22248, 'decision': 'sell', 'sma': 84899600.0, 'ema': 84818231.29478204, 'rsi': 53.095183177456406, 'macd': 190926.07026802003, 'signal_line': 241967.72736640112, 'BB_Upper': 85458854.28920698, 'BB_Lower': 84340345.71079302}
2024-09-20 15:16:46 - INFO - Exogenous 변수 예측 시작
2024-09-20 15:16:46 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84899600.0         0         0
2024-09-20 15:16:46 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84899600.0         0         0
2024-09-20 15:16:46 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 15:16:46 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 15:16:46 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 15:16:46 - INFO - ARIMA prediction: 84893000.0
2024-09-20 15:16:46 - INFO - Attempting prediction for prophet
2024-09-20 15:16:46 - INFO - PROPHET prediction: 84826293.25049599
2024-09-20 15:16:46 - INFO - Attempting prediction for transformer
2024-09-20 15:16:46 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:16:46 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:16:46 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:16:46 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 15:16:46 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:16:46 - INFO - X 샘플:
[[-1.2539147   0.904503   -0.22640231  1.03964323  1.69122831  1.69753733
   1.03964323  1.03964323  0.          0.          0.          1.03964323
   1.03964323]
 [ 1.31257737  1.12584968  1.05326293  0.32492987 -0.61381062 -0.60910607
   0.32492987  0.32492987  0.          0.          0.          0.32492987
   0.32492987]
 [ 0.78880348  0.8240133   1.11590389  1.03302552 -0.96355892 -0.96128615
   1.03302552  1.03302552  0.          0.          0.          1.03302552
   1.03302552]
 [ 1.08211686  1.01517634  1.29487805  1.35729362 -1.00861688 -1.0062216
   1.35729362  1.35729362  0.          0.          0.          1.35729362
   1.35729362]
 [ 1.44875858  0.92462543  0.73110944  0.76169915  0.70431451  0.70934091
   0.76169915  0.76169915  0.          0.          0.          0.76169915
   0.76169915]
 [-0.04923475 -0.37327098  0.2299818  -0.21110515  0.17320495  0.171861
  -0.21110515 -0.21110515  0.          0.          0.         -0.21110515
  -0.21110515]
 [-0.75109176 -1.35926981 -1.50606755 -1.54788384  1.47371371  1.4643514
  -1.54788384 -1.54788384  0.          0.          0.         -1.54788384
  -1.54788384]
 [-0.79299367 -0.96688252 -1.17496536 -0.89272993 -1.05866535 -1.0620825
  -0.89272993 -0.89272993  0.          0.          0.         -0.89272993
  -0.89272993]
 [-1.00250323 -0.705291   -0.24429973 -0.5155201   0.47912167  0.47750552
  -0.5155201  -0.5155201   0.          0.          0.         -0.5155201
  -0.5155201 ]
 [-0.78251819 -1.38945345 -1.27340115 -1.34935236 -0.87693139 -0.88189985
  -1.34935236 -1.34935236  0.          0.          0.         -1.34935236
  -1.34935236]]
2024-09-20 15:16:46 - INFO - y 샘플:
[-1.34935236]
2024-09-20 15:16:46 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 15:16:46 - INFO - 모델 출력 (스케일링된 예측): [0.29758835]
2024-09-20 15:16:46 - INFO - 스케일러 역변환 후 예측 가격: 85078868.43540254
2024-09-20 15:16:46 - INFO - TransformerPredictor 최종 예측 가격: 85078868.43540254
2024-09-20 15:16:46 - INFO - TRANSFORMER prediction: 85078868.43540254
2024-09-20 15:16:46 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 15:16:46 - INFO - BITCOIN_FORECAST prediction: 83415167.35735348
2024-09-20 15:16:46 - INFO - BitcoinForecast prediction: 83415167.35735348
2024-09-20 15:16:47 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:48 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:49 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:50 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:51 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:52 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:54 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:16:54 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 15:16:54 - INFO - 조정된 모델 가중치: {'gpt': 0.00282693187694434, 'ml': 0.011384044202052279, 'xgboost': 0.0, 'rl': 0.12763075015216538, 'lstm': 0.1277550698478807, 'arima': 0.16822863531410975, 'prophet': 0.3000062687546906, 'transformer': 0.15515658829650952, 'bitcoin_forecast': 0.10701171155564741}
2024-09-20 15:16:54 - INFO - 조정된 모델 가중치: {'gpt': 0.00282693187694434, 'ml': 0.011384044202052279, 'xgboost': 0.0, 'rl': 0.12763075015216538, 'lstm': 0.1277550698478807, 'arima': 0.16822863531410975, 'prophet': 0.3000062687546906, 'transformer': 0.15515658829650952, 'bitcoin_forecast': 0.10701171155564741}
2024-09-20 15:16:54 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84862766.02437992, 'current_price': 84830000.0, 'predictions': {'gpt': 84830000.0, 'ml': 85016626.0, 'xgboost': 84830000.0, 'lstm': 85030978.5581812, 'rl': 85678300.0, 'arima': 84893000.0, 'prophet': 84826293.25049599, 'transformer': 85078868.43540254, 'bitcoin_forecast': 83415167.35735348}, 'weights': {'gpt': 0.00282693187694434, 'ml': 0.011384044202052279, 'xgboost': 0.0, 'rl': 0.12763075015216538, 'lstm': 0.1277550698478807, 'arima': 0.16822863531410975, 'prophet': 0.3000062687546906, 'transformer': 0.15515658829650952, 'bitcoin_forecast': 0.10701171155564741}}
2024-09-20 15:16:54 - INFO - 모델별 가중치:
2024-09-20 15:16:54 - INFO -   - GPT: 0.0028
2024-09-20 15:16:54 - INFO -   - ML: 0.0114
2024-09-20 15:16:54 - INFO -   - XGBOOST: 0.0000
2024-09-20 15:16:54 - INFO -   - RL: 0.1276
2024-09-20 15:16:54 - INFO -   - LSTM: 0.1278
2024-09-20 15:16:54 - INFO -   - ARIMA: 0.1682
2024-09-20 15:16:54 - INFO -   - PROPHET: 0.3000
2024-09-20 15:16:54 - INFO -   - TRANSFORMER: 0.1552
2024-09-20 15:16:54 - INFO -   - BITCOIN_FORECAST: 0.1070
2024-09-20 15:16:54 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 15:16:54 - INFO - 6. 거래 실행
2024-09-20 15:16:54 - INFO - Cancelling existing orders.
2024-09-20 15:16:54 - INFO - Cancelled 0 orders.
2024-09-20 15:16:54 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84862766.02437992, 'current_price': 84830000.0, 'predictions': {'gpt': 84830000.0, 'ml': 85016626.0, 'xgboost': 84830000.0, 'lstm': 85030978.5581812, 'rl': 85678300.0, 'arima': 84893000.0, 'prophet': 84826293.25049599, 'transformer': 85078868.43540254, 'bitcoin_forecast': 83415167.35735348}, 'weights': {'gpt': 0.00282693187694434, 'ml': 0.011384044202052279, 'xgboost': 0.0, 'rl': 0.12763075015216538, 'lstm': 0.1277550698478807, 'arima': 0.16822863531410975, 'prophet': 0.3000062687546906, 'transformer': 0.15515658829650952, 'bitcoin_forecast': 0.10701171155564741}}, 현재 가격=84830000.0
2024-09-20 15:16:54 - INFO - 현재 잔고: KRW=343974.22979483, BTC=0.00159813, 총 자산가치=479543.59769483004
2024-09-20 15:16:54 - INFO - 매수 시도: 0.0005652995375395851 BTC (약 47954.359769483 KRW)
2024-09-20 15:16:54 - INFO - 주문 결과: {'uuid': 'fa929527-4549-44f4-a01d-b1bd583497b3', 'side': 'bid', 'ord_type': 'limit', 'price': '84830000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T15:16:56+09:00', 'volume': '0.00056529', 'remaining_volume': '0.00056529', 'reserved_fee': '23.97677535', 'remaining_fee': '23.97677535', 'paid_fee': '0', 'locked': '47977.52747535', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 15:16:54 - INFO - buy 주문 성공: UUID=fa929527-4549-44f4-a01d-b1bd583497b3
2024-09-20 15:16:54 - INFO - Trade executed successfully.
2024-09-20 15:16:54 - INFO - 7. summary 리포트 보내기
2024-09-20 15:16:55 - INFO - Message sent to Discord successfully.
2024-09-20 15:16:55 - INFO - Trading cycle completed.
2024-09-20 15:16:55 - INFO - Performing periodic update.
2024-09-20 15:16:55 - INFO - 계산된 시장 변동성: 0.03019226721448238
2024-09-20 15:25:39 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:25:41 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8175-a4b4-d21faca0d1d7 "HTTP/1.1 200 OK"
2024-09-20 15:25:41 - INFO - Updated actual price for gpt prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:25:47 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:25:48 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81ad-a4a7-cf8baa4b8636 "HTTP/1.1 200 OK"
2024-09-20 15:25:48 - INFO - Updated actual price for ml prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:25:53 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:25:54 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8170-8e5c-e5a33e4e1ce8 "HTTP/1.1 200 OK"
2024-09-20 15:25:54 - INFO - Updated actual price for xgboost prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:25:58 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:25:58 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8186-9834-f9b2af42f864 "HTTP/1.1 200 OK"
2024-09-20 15:25:58 - INFO - Updated actual price for lstm prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:04 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:26:04 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8197-b33a-fe5c9d69d77f "HTTP/1.1 200 OK"
2024-09-20 15:26:04 - INFO - Updated actual price for rl prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:11 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:26:15 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81e9-bada-fba4dd40f41e "HTTP/1.1 200 OK"
2024-09-20 15:26:15 - INFO - Updated actual price for arima prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:20 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:26:20 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81de-9c99-f671c0f29c21 "HTTP/1.1 200 OK"
2024-09-20 15:26:20 - INFO - Updated actual price for prophet prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:26 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:26:27 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-8137-85d9-f48678055976 "HTTP/1.1 200 OK"
2024-09-20 15:26:27 - INFO - Updated actual price for transformer prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:32 - INFO - HTTP Request: POST https://api.notion.com/v1/databases/2eb0445c443d4031b20ffbf880f7a158/query "HTTP/1.1 200 OK"
2024-09-20 15:26:33 - INFO - HTTP Request: PATCH https://api.notion.com/v1/pages/10701818-9b19-81f0-bcee-cfedd307b8d7 "HTTP/1.1 200 OK"
2024-09-20 15:26:33 - INFO - Updated actual price for bitcoin_forecast prediction made at 2024-09-20 15:15:34.980239
2024-09-20 15:26:33 - INFO - Starting trading cycle.
2024-09-20 15:26:33 - INFO - ##################################################
2024-09-20 15:26:33 - INFO - 14 회 예측 후 모델 재학습 검토
2024-09-20 15:26:33 - INFO - ##################################################
2024-09-20 15:26:33 - INFO - 1. 신규 데이터 수집 및 DB 업데이트
2024-09-20 15:26:33 - INFO - 데이터베이스 업데이트 시작
2024-09-20 15:26:33 - INFO - 현재 데이터베이스의 최신 날짜: 2024-09-20 15:10:00
2024-09-20 15:26:33 - INFO - 새로운 데이터 범위: 2024-09-19 06:10:00 ~ 2024-09-20 15:20:00
2024-09-20 15:26:33 - INFO - Adding new data. Shape: (1, 7)
2024-09-20 15:26:33 - INFO - Columns: ['date', 'open', 'high', 'low', 'close', 'volume', 'value']
2024-09-20 15:26:33 - INFO - Index: Index([199], dtype='int64')
2024-09-20 15:26:33 - INFO - Date column data type: datetime64[ns]
2024-09-20 15:26:33 - INFO - Sample date values: [Timestamp('2024-09-20 15:20:00')]
2024-09-20 15:26:33 - INFO - Successfully added 1 new data points
2024-09-20 15:26:33 - INFO - Final new data shape after processing: (1, 7)
2024-09-20 15:26:33 - INFO - Final date range: 2024-09-20 15:20:00 to 2024-09-20 15:20:00
2024-09-20 15:26:33 - INFO - 새로운 데이터 1개 추가됨
2024-09-20 15:26:33 - INFO - 추가된 최신 데이터의 날짜: 2024-09-20 15:20:00
2024-09-20 15:26:33 - INFO - 데이터베이스 업데이트 완료
2024-09-20 15:26:33 - INFO - 2. 기존 예측 평가 및 가중치 반영
2024-09-20 15:26:33 - INFO - GPT | 이전예측가격: 84830000 | 당시BTC가격: 84830000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:26:33 - INFO - ML 모델 예측 업데이트: 정확도 50.00%, 적중/전체: 8/16
2024-09-20 15:26:33 - INFO - ML | 이전예측가격: 85016626 | 당시BTC가격: 84830000 | 예측: 상승 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1293 | 반영가중치값: 0.0200 | 새 가중치: 0.1493 | 예측 총 횟수: 16 | 예측 성공 수: 8 | 예측 성공률: 50.00%
2024-09-20 15:26:33 - INFO - XGBOOST | 이전예측가격: 84830000 | 당시BTC가격: 84830000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:26:33 - INFO - LSTM 모델 예측 업데이트: 정확도 58.33%, 적중/전체: 21/36
2024-09-20 15:26:33 - INFO - LSTM | 이전예측가격: 85030979 | 당시BTC가격: 84830000 | 예측: 상승 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0835 | 반영가중치값: 0.0200 | 새 가중치: 0.1035 | 예측 총 횟수: 36 | 예측 성공 수: 21 | 예측 성공률: 58.33%
2024-09-20 15:26:33 - INFO - RL 모델 예측 업데이트: 정확도 56.25%, 적중/전체: 9/16
2024-09-20 15:26:33 - INFO - RL | 이전예측가격: 85678300 | 당시BTC가격: 84830000 | 예측: 상승 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1293 | 반영가중치값: 0.0200 | 새 가중치: 0.1493 | 예측 총 횟수: 16 | 예측 성공 수: 9 | 예측 성공률: 56.25%
2024-09-20 15:26:33 - INFO - ARIMA 모델 예측 업데이트: 정확도 64.29%, 적중/전체: 9/14
2024-09-20 15:26:33 - INFO - ARIMA | 이전예측가격: 84893000 | 당시BTC가격: 84830000 | 예측: 상승 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.1278 | 반영가중치값: 0.0200 | 새 가중치: 0.1478 | 예측 총 횟수: 14 | 예측 성공 수: 9 | 예측 성공률: 64.29%
2024-09-20 15:26:33 - INFO - PROPHET | 이전예측가격: 84826293 | 당시BTC가격: 84830000 | 예측: 변화 없음 (평가에서 제외)
2024-09-20 15:26:33 - INFO - TRANSFORMER 모델 예측 업데이트: 정확도 55.56%, 적중/전체: 20/36
2024-09-20 15:26:33 - INFO - TRANSFORMER | 이전예측가격: 85078868 | 당시BTC가격: 84830000 | 예측: 상승 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 성공 | 전 가중치: 0.0448 | 반영가중치값: 0.0200 | 새 가중치: 0.0648 | 예측 총 횟수: 36 | 예측 성공 수: 20 | 예측 성공률: 55.56%
2024-09-20 15:26:33 - INFO - BITCOIN_FORECAST 모델 예측 업데이트: 정확도 55.26%, 적중/전체: 42/76
2024-09-20 15:26:33 - INFO - BITCOIN_FORECAST | 이전예측가격: 83415167 | 당시BTC가격: 84830000 | 예측: 하락 | 지금 BTC가격: 84934000 | 실결과: 상승 | 예측 결과: 실패 | 전 가중치: 0.1325 | 반영가중치값: -0.0200 | 새 가중치: 0.1125 | 예측 총 횟수: 76 | 예측 성공 수: 42 | 예측 성공률: 55.26%
2024-09-20 15:26:33 - INFO - 모델 가중치를 model_weights.json에 성공적으로 저장했습니다.
2024-09-20 15:26:33 - INFO - 예측 평가 및 가중치 업데이트 완료
2024-09-20 15:26:33 - INFO - 새로운 가중치: {'gpt': 0.0027445535490435583, 'ml': 0.14494190175991414, 'xgboost': 0.0, 'rl': 0.14494190175991414, 'lstm': 0.10048701506383544, 'arima': 0.14346708892870888, 'prophet': 0.2912639233938687, 'transformer': 0.06289330309468906, 'bitcoin_forecast': 0.10926031245002603}
2024-09-20 15:26:33 - INFO - XGBoost 모델 성능: 정확도 59.69%, 적중/전체: 77/129
2024-09-20 15:26:33 - INFO - 3. 최신 데이터로 각 모델 예측값 받기
2024-09-20 15:26:33 - INFO - Current BTC price: 84934000.0
2024-09-20 15:26:33 - INFO - Analyzing market conditions.
2024-09-20 15:26:33 - INFO - Market analysis: {'current_price': 84934000.0, 'sma_20': 84929150.0, 'rsi_14': 55.72111070599636, 'trend': 'Bullish', 'overbought_oversold': 'Neutral'}
2024-09-20 15:26:33 - INFO - Starting predictions for all models
2024-09-20 15:26:33 - INFO - Attempting prediction for gpt
2024-09-20 15:26:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-09-20 15:26:34 - ERROR - Error in OpenAI API call: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:26:34 - ERROR - Error in GPT prediction: Error code: 400 - {'error': {'message': "Your organization must qualify for at least usage tier 5 to access 'o1-mini'. See https://platform.openai.com/docs/guides/rate-limits/usage-tiers for more details on usage tiers.", 'type': 'invalid_request_error', 'param': 'model', 'code': 'below_usage_tier'}}
2024-09-20 15:26:34 - INFO - GPT prediction: 84934000.0
2024-09-20 15:26:34 - INFO - Attempting prediction for ml
2024-09-20 15:26:34 - INFO - ML prediction: 85171815.19999999
2024-09-20 15:26:34 - INFO - Attempting prediction for xgboost
2024-09-20 15:26:34 - INFO - XGBoost predict 메서드 시작. 입력 데이터 shape: (1, 14)
2024-09-20 15:26:34 - ERROR - XGBoost 예측 중 오류 발생: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:26:34 - ERROR - 상세 오류:
Traceback (most recent call last):
  File "C:\Dev\GPT_BTC\pythonProject\gpt-bitcoin\backtesting_and_ml.py", line 302, in predict
    predicted_price = max(min(predicted_price, sma * (1 + max_deviation)), sma * (1 - max_deviation))
                                               ~~~~^~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'float'
2024-09-20 15:26:34 - INFO - XGBOOST prediction: 84934000.0
2024-09-20 15:26:34 - INFO - Attempting prediction for lstm
2024-09-20 15:26:34 - INFO - LSTMPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - LSTMPredictor prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:26:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:26:34 - INFO - 준비된 데이터 shape - X: (1, 10, 7), y: (1, 1)
2024-09-20 15:26:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:26:34 - INFO - X 샘플:
[[ 1.21585094  1.32148371  1.0813435   0.51985124 -0.41992315 -0.41359488
   0.51985124]
 [ 0.76620192  1.0249653   1.1397494   1.26348871 -0.83084844 -0.82790521
   1.26348871]
 [ 1.01800537  1.21276029  1.3066234   1.60403297 -0.88378782 -0.880768
   1.60403297]
 [ 1.33275968  1.12380477  0.78097031  0.97854351  1.12876474  1.13744743
   0.97854351]
 [ 0.0467635  -0.15122439  0.31372312 -0.04308927  0.50475498  0.50514739
  -0.04308927]
 [-0.55576618 -1.11985119 -1.30495466 -1.44696561  2.03274509  2.02565395
  -1.44696561]
 [-0.5917381  -0.73437726 -0.99623776 -0.75892721 -0.94259062 -0.94648367
  -0.75892721]
 [-0.77159771 -0.47739464 -0.12849298 -0.36278389  0.8641818   0.86471253
  -0.36278389]
 [-0.58274512 -1.14950303 -1.08801846 -1.23846913 -0.72906826 -0.73451388
  -1.23846913]
 [-1.87773429 -1.05066356 -1.10470586 -0.51568131 -0.72422832 -0.72969565
  -0.51568131]]
2024-09-20 15:26:34 - INFO - y 샘플:
[-0.51568131]
2024-09-20 15:26:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 7])
2024-09-20 15:26:34 - INFO - 모델 출력 (스케일링된 예측): [[-0.02874809]]
2024-09-20 15:26:34 - INFO - 스케일러 역변환 후 예측 가격: 85004063.51480787
2024-09-20 15:26:34 - INFO - LSTMPredictor 최종 예측 가격: 85004063.51480787
2024-09-20 15:26:34 - INFO - LSTM prediction: 85004063.51480787
2024-09-20 15:26:34 - INFO - Attempting prediction for rl
2024-09-20 15:26:34 - INFO - Preparing state for RL agent.
2024-09-20 15:26:34 - INFO - Prepared state: [[8.49340000e+07 1.67203122e+01 1.22598137e-03 8.49291500e+07
  5.57211107e+01]]
2024-09-20 15:26:34 - INFO - RL prediction: 85783340.0
2024-09-20 15:26:34 - INFO - Attempting prediction for arima
2024-09-20 15:26:34 - INFO - ARIMA 예측 시작
2024-09-20 15:26:34 - INFO - 입력 데이터: {'open': 84856000.0, 'high': 85010000.0, 'low': 84821000.0, 'close': 84934000.0, 'volume': 16.72031219, 'value': 1419825578.72682, 'decision': 'sell', 'sma': 84929150.0, 'ema': 84829256.88575518, 'rsi': 55.72111070599636, 'macd': 177487.6072178334, 'signal_line': 229071.70333668758, 'BB_Upper': 85426692.47055063, 'BB_Lower': 84431607.52944937}
2024-09-20 15:26:34 - INFO - Exogenous 변수 예측 시작
2024-09-20 15:26:34 - INFO - 예측된 Exogenous 변수:
   volatility         sma  upper_bb  lower_bb
0           0  84929150.0         0         0
2024-09-20 15:26:34 - INFO - Future exogenous variables:    volatility         sma  upper_bb  lower_bb
0           0  84929150.0         0         0
2024-09-20 15:26:34 - INFO - ARIMA 예측 결과: 4980    8.489300e+09
dtype: float64
2024-09-20 15:26:34 - INFO - 신뢰 구간: [[8.199994e+09 8.778606e+09]]
2024-09-20 15:26:34 - INFO - 최종 ARIMA 예측값: 84893000.0
2024-09-20 15:26:34 - INFO - ARIMA prediction: 84893000.0
2024-09-20 15:26:34 - INFO - Attempting prediction for prophet
2024-09-20 15:26:34 - INFO - PROPHET prediction: 84944480.68706869
2024-09-20 15:26:34 - INFO - Attempting prediction for transformer
2024-09-20 15:26:34 - INFO - TransformerPredictor predict 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - Transformer prepare_data 메서드 시작. 입력 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - 기술적 지표 계산 후 데이터 shape: (10, 14)
2024-09-20 15:26:34 - INFO - 데이터 컬럼: ['open', 'high', 'low', 'close', 'volume', 'value', 'decision', 'sma', 'ema', 'rsi', 'macd', 'signal_line', 'BB_Upper', 'BB_Lower']
2024-09-20 15:26:34 - INFO - NaN 값 개수:
open           0
high           0
low            0
close          0
volume         0
value          0
decision       0
sma            0
ema            0
rsi            0
macd           0
signal_line    0
BB_Upper       0
BB_Lower       0
dtype: int64
2024-09-20 15:26:34 - INFO - 준비된 데이터 shape - X: (1, 10, 13), y: (1, 1)
2024-09-20 15:26:34 - INFO - X dtype: float64, y dtype: float64
2024-09-20 15:26:34 - INFO - X 샘플:
[[ 1.21585094  1.32148371  1.0813435   0.51985124 -0.41992315 -0.41359488
   0.51985124  0.51985124  0.          0.          0.          0.51985124
   0.51985124]
 [ 0.76620192  1.0249653   1.1397494   1.26348871 -0.83084844 -0.82790521
   1.26348871  1.26348871  0.          0.          0.          1.26348871
   1.26348871]
 [ 1.01800537  1.21276029  1.3066234   1.60403297 -0.88378782 -0.880768
   1.60403297  1.60403297  0.          0.          0.          1.60403297
   1.60403297]
 [ 1.33275968  1.12380477  0.78097031  0.97854351  1.12876474  1.13744743
   0.97854351  0.97854351  0.          0.          0.          0.97854351
   0.97854351]
 [ 0.0467635  -0.15122439  0.31372312 -0.04308927  0.50475498  0.50514739
  -0.04308927 -0.04308927  0.          0.          0.         -0.04308927
  -0.04308927]
 [-0.55576618 -1.11985119 -1.30495466 -1.44696561  2.03274509  2.02565395
  -1.44696561 -1.44696561  0.          0.          0.         -1.44696561
  -1.44696561]
 [-0.5917381  -0.73437726 -0.99623776 -0.75892721 -0.94259062 -0.94648367
  -0.75892721 -0.75892721  0.          0.          0.         -0.75892721
  -0.75892721]
 [-0.77159771 -0.47739464 -0.12849298 -0.36278389  0.8641818   0.86471253
  -0.36278389 -0.36278389  0.          0.          0.         -0.36278389
  -0.36278389]
 [-0.58274512 -1.14950303 -1.08801846 -1.23846913 -0.72906826 -0.73451388
  -1.23846913 -1.23846913  0.          0.          0.         -1.23846913
  -1.23846913]
 [-1.87773429 -1.05066356 -1.10470586 -0.51568131 -0.72422832 -0.72969565
  -0.51568131 -0.51568131  0.          0.          0.         -0.51568131
  -0.51568131]]
2024-09-20 15:26:34 - INFO - y 샘플:
[-0.51568131]
2024-09-20 15:26:34 - INFO - 모델 입력 텐서 shape: torch.Size([1, 10, 13])
2024-09-20 15:26:34 - INFO - 모델 출력 (스케일링된 예측): [0.2975626]
2024-09-20 15:26:34 - INFO - 스케일러 역변환 후 예측 가격: 85051015.48404263
2024-09-20 15:26:34 - INFO - TransformerPredictor 최종 예측 가격: 85051015.48404263
2024-09-20 15:26:34 - INFO - TRANSFORMER prediction: 85051015.48404263
2024-09-20 15:26:34 - INFO - Attempting prediction for bitcoin_forecast
2024-09-20 15:26:34 - INFO - BITCOIN_FORECAST prediction: 83405616.99538434
2024-09-20 15:26:34 - INFO - BitcoinForecast prediction: 83405616.99538434
2024-09-20 15:26:34 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:35 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:36 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:37 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:38 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:39 - INFO - HTTP Request: POST https://api.notion.com/v1/pages "HTTP/1.1 200 OK"
2024-09-20 15:26:39 - INFO - 4. 가중치와 모델별 예측 정도에 따른 계산 및 최종 결정
2024-09-20 15:26:39 - INFO - 조정된 모델 가중치: {'gpt': 0.0027445535490435583, 'ml': 0.14494190175991414, 'xgboost': 0.0, 'rl': 0.14494190175991414, 'lstm': 0.10048701506383544, 'arima': 0.14346708892870888, 'prophet': 0.2912639233938687, 'transformer': 0.06289330309468906, 'bitcoin_forecast': 0.10926031245002603}
2024-09-20 15:26:39 - INFO - 조정된 모델 가중치: {'gpt': 0.0027445535490435583, 'ml': 0.14494190175991414, 'xgboost': 0.0, 'rl': 0.14494190175991414, 'lstm': 0.10048701506383544, 'arima': 0.14346708892870888, 'prophet': 0.2912639233938687, 'transformer': 0.06289330309468906, 'bitcoin_forecast': 0.10926031245002603}
2024-09-20 15:26:39 - INFO - Decision: {'decision': 'buy', 'percentage': 10.0, 'target_price': 84936153.19673055, 'current_price': 84934000.0, 'predictions': {'gpt': 84934000.0, 'ml': 85171815.19999999, 'xgboost': 84934000.0, 'lstm': 85004063.51480787, 'rl': 85783340.0, 'arima': 84893000.0, 'prophet': 84944480.68706869, 'transformer': 85051015.48404263, 'bitcoin_forecast': 83405616.99538434}, 'weights': {'gpt': 0.0027445535490435583, 'ml': 0.14494190175991414, 'xgboost': 0.0, 'rl': 0.14494190175991414, 'lstm': 0.10048701506383544, 'arima': 0.14346708892870888, 'prophet': 0.2912639233938687, 'transformer': 0.06289330309468906, 'bitcoin_forecast': 0.10926031245002603}}
2024-09-20 15:26:39 - INFO - 모델별 가중치:
2024-09-20 15:26:39 - INFO -   - GPT: 0.0027
2024-09-20 15:26:39 - INFO -   - ML: 0.1449
2024-09-20 15:26:39 - INFO -   - XGBOOST: 0.0000
2024-09-20 15:26:39 - INFO -   - RL: 0.1449
2024-09-20 15:26:39 - INFO -   - LSTM: 0.1005
2024-09-20 15:26:39 - INFO -   - ARIMA: 0.1435
2024-09-20 15:26:39 - INFO -   - PROPHET: 0.2913
2024-09-20 15:26:39 - INFO -   - TRANSFORMER: 0.0629
2024-09-20 15:26:39 - INFO -   - BITCOIN_FORECAST: 0.1093
2024-09-20 15:26:39 - INFO - 5. 모델별 예측값과 최종 예측 등 기록 저장
2024-09-20 15:26:39 - INFO - 6. 거래 실행
2024-09-20 15:26:39 - INFO - Cancelling existing orders.
2024-09-20 15:26:39 - INFO - Cancelled 0 orders.
2024-09-20 15:26:39 - INFO - 거래 실행 시작: 결정={'decision': 'buy', 'percentage': 10.0, 'target_price': 84936153.19673055, 'current_price': 84934000.0, 'predictions': {'gpt': 84934000.0, 'ml': 85171815.19999999, 'xgboost': 84934000.0, 'lstm': 85004063.51480787, 'rl': 85783340.0, 'arima': 84893000.0, 'prophet': 84944480.68706869, 'transformer': 85051015.48404263, 'bitcoin_forecast': 83405616.99538434}, 'weights': {'gpt': 0.0027445535490435583, 'ml': 0.14494190175991414, 'xgboost': 0.0, 'rl': 0.14494190175991414, 'lstm': 0.10048701506383544, 'arima': 0.14346708892870888, 'prophet': 0.2912639233938687, 'transformer': 0.06289330309468906, 'bitcoin_forecast': 0.10926031245002603}}, 현재 가격=84934000.0
2024-09-20 15:26:39 - INFO - 현재 잔고: KRW=295996.70231948, BTC=0.00216342, 총 자산가치=479744.61659948004
2024-09-20 15:26:39 - INFO - 매수 시도: 0.0005648440160589165 BTC (약 47974.461659948014 KRW)
2024-09-20 15:26:39 - INFO - 주문 결과: {'uuid': '9e2422f1-370c-4be3-b6ed-782550d06e47', 'side': 'bid', 'ord_type': 'limit', 'price': '84934000', 'state': 'wait', 'market': 'KRW-BTC', 'created_at': '2024-09-20T15:26:41+09:00', 'volume': '0.00056484', 'remaining_volume': '0.00056484', 'reserved_fee': '23.98706028', 'remaining_fee': '23.98706028', 'paid_fee': '0', 'locked': '47998.10762028', 'executed_volume': '0', 'trades_count': 0}
2024-09-20 15:26:39 - INFO - buy 주문 성공: UUID=9e2422f1-370c-4be3-b6ed-782550d06e47
2024-09-20 15:26:39 - INFO - Trade executed successfully.
2024-09-20 15:26:39 - INFO - 7. summary 리포트 보내기
2024-09-20 15:26:40 - INFO - Message sent to Discord successfully.
2024-09-20 15:26:40 - INFO - Trading cycle completed.
2024-09-20 15:26:40 - INFO - Performing periodic update.
